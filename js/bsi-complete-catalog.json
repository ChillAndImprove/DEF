{
  "metadata": {
    "totalRisks": 691,
    "extractedAt": "2025-11-15T02:23:15.162Z",
    "bsiCodes": [
      "APP.1.1",
      "APP.1.2",
      "APP.1.4",
      "APP.2.1",
      "APP.2.2",
      "APP.2.3",
      "APP.3.1",
      "APP.3.2",
      "APP.3.3",
      "APP.3.4",
      "APP.3.6",
      "APP.4.2",
      "APP.4.3",
      "APP.4.4",
      "APP.4.6",
      "APP.5.2",
      "APP.5.4",
      "APP.6",
      "APP.7",
      "CON.1",
      "CON.10",
      "CON.11.1",
      "CON.2",
      "CON.3",
      "CON.6",
      "CON.7",
      "CON.8",
      "CON.9",
      "DER.1",
      "DER.2.1",
      "DER.2.2",
      "DER.2.3",
      "DER.3.1",
      "DER.3.2",
      "DER.4",
      "IND.1",
      "IND.2.1",
      "IND.2.2",
      "IND.2.3",
      "IND.2.4",
      "IND.2.7",
      "IND.3.2",
      "INF.1",
      "INF.10",
      "INF.11",
      "INF.12",
      "INF.13",
      "INF.14",
      "INF.2",
      "INF.5",
      "INF.6",
      "INF.7",
      "INF.8",
      "INF.9",
      "ISMS.1",
      "NET.1.1",
      "NET.1.2",
      "NET.2.1",
      "NET.2.2",
      "NET.3.1",
      "NET.3.2",
      "NET.3.3",
      "NET.3.4",
      "NET.4.1",
      "NET.4.2",
      "NET.4.3",
      "OPS.1.1.1",
      "OPS.1.1.2",
      "OPS.1.1.3",
      "OPS.1.1.4",
      "OPS.1.1.5",
      "OPS.1.1.6",
      "OPS.1.1.7",
      "OPS.1.2.2",
      "OPS.1.2.4",
      "OPS.1.2.5",
      "OPS.1.2.6",
      "OPS.2.2",
      "OPS.2.3",
      "OPS.3.2",
      "ORP.1",
      "ORP.2",
      "ORP.3",
      "ORP.4",
      "ORP.5",
      "SYS.1.1",
      "SYS.1.2.2",
      "SYS.1.2.3",
      "SYS.1.3",
      "SYS.1.5",
      "SYS.1.6",
      "SYS.1.7",
      "SYS.1.8",
      "SYS.1.9",
      "SYS.2.1",
      "SYS.2.2.3",
      "SYS.2.3",
      "SYS.2.4",
      "SYS.2.5",
      "SYS.2.6",
      "SYS.3.1",
      "SYS.3.2.1",
      "SYS.3.2.2",
      "SYS.3.2.3",
      "SYS.3.2.4",
      "SYS.3.3",
      "SYS.4.1",
      "SYS.4.3",
      "SYS.4.4",
      "SYS.4.5"
    ],
    "bsiCodeCount": 110
  },
  "risks": [
    {
      "file": "100_sec1.ts",
      "bsiCode": "SYS.2.5",
      "id": "inadequate-network-performance-for-virtual-clients",
      "title": "Network Capacity and Latency Risks for Virtualized Clients and Critical Links (BSI SYS.2.5)",
      "description": "Missing or insufficient network capacity and latency planning for connections to and from virtual clients (or other critical components) can break functionality and business flows. In BSI’s context, terminal/remote-desktop-style workloads are especially sensitive to latency and jitter; under-provisioned links to users or backend services (file services, databases, directory services, and conferencing) cause freezes, timeouts, and service disruption.",
      "impact": "Limited or unstable access to services, sluggish UI, increased error rates, and timeouts—ultimately harming availability. For end users, this appears as slow, unresponsive, or unusable applications; for backend systems it can cascade into stuck threads, queue buildups, and partial outages.",
      "action": "Document, provision, and verify bandwidth/latency/QoS for all critical links.",
      "mitigation": "Identify and document bandwidth, latency, jitter, and packet-loss SLOs for end-user and backend paths. Provide adequate capacity and QoS (including DSCP/class-based queuing where applicable). Avoid oversubscription. Test with synthetic load and real user journeys before go-live. Continuously monitor (APM/NPM) and alert on SLO breaches. For links flagged by this rule, explicitly record evidence that the network meets expected peak demand.",
      "check": "Do critical connections have defined bandwidth/latency/jitter SLOs and sizing calculations? Is QoS configured and validated end-to-end (including WAN/Cloud edges)? Are performance dashboards/alerts in place and reviewed, with action runbooks for degradation?",
      "asvs": "Based on BSI IT-Grundschutz SYS.2.5 Client-Virtualisierung and SYS.1.6 Virtualisierung; related to threat \\",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_6_Virtualisierung_Edition_2023.pdf?__blob=publicationFile (German BSI Module on Virtualization)",
      "detectionLogic": "Raised for any non-local communication link that is either (1) explicitly tagged @Latency:Critical or (2) transports at least one data asset with Mission-Critical availability. Local, non-network interactions (in-process calls or local file access) are excluded. Impact is derived from the highest availability of the link or target; if a client technology participates, impact is minimally escalated due to user-facing effects.",
      "riskAssessment": "Likelihood: Likely by default for latency-sensitive or mission-critical flows, as performance regressions are common without explicit capacity planning. Impact: derived from the maximum availability of the target asset and the link; Mission-Critical flows map to High impact. User-facing (client) involvement raises the floor to at least Medium.",
      "falsePositives": "Acceptable if you can point to current capacity plans, QoS configs, load/latency test results, and live monitoring that demonstrate headroom under peak and failure scenarios. In such cases, record the evidence and consider marking the instance as mitigated.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "100_sec2.ts",
      "bsiCode": "SYS.2.5",
      "id": "insufficient-virtual-client-resources",
      "title": "Insufficient Resources for Virtual Clients (BSI SYS.2.5 — Threat 2.2, Requirement A10)",
      "description": "Virtual desktop/client workloads (VDI) require adequate CPU, RAM, storage IOPS, GPU and network throughput. If a virtual client is under-provisioned or competes for shared resources, user-facing applications slow down or fail to start, directly impacting business operations.",
      "impact": "Performance collapse on virtual clients degrades availability of user workflows: longer login times, frozen apps, failed rendering, and timeouts to downstream services. For high-availability roles, this can halt critical processes and productivity across teams.",
      "action": "Right-size and guarantee resources for virtual clients (VDI).",
      "mitigation": "Define per-persona resource profiles; reserve minimum CPU/RAM/IOPS; enable dynamic rightsizing with monitored ceilings; allocate/virtualize GPUs only where required; baseline and alert on CPU, RAM, IOPS, GPU and network saturation; use resource pools, reservations, limits and shares; prevent nested virtualization; keep templates updated and hardened.",
      "check": "Are per-role CPU/RAM/IOPS/GPU/network baselines documented? Are reservations/limits/shares configured on the virtualization platform? Is monitoring with thresholds and alerts active for VDI sessions and hosts? Are users educated about concurrent heavy usage?",
      "asvs": "BSI mapping: SYS.2.5 Client-Virtualisierung — 2.2 Ressourcenknappheit; SYS.2.5.A10 Bedarfsgerechte Zuweisung von Ressourcen.",
      "cheatSheet": "See BSI IT-Grundschutz Kompendium, Baustein SYS.2.5 Client-Virtualisierung (sections 2.2 and A10).",
      "detectionLogic": "Raise a finding for every in-scope technical asset where machine === Virtual AND technology ∈ {ClientSystem, Desktop}. Excludes out-of-scope assets. Impact is scaled by the asset’s availability requirement. Intended for VDI/virtual desktop/client systems that may suffer from resource contention or under-provisioning.",
      "riskAssessment": "Likelihood: Likely — resource contention and mis-sizing are common in virtual desktop estates. Impact: derived from the asset’s availability (MissionCritical → High; Critical/Important → Medium; otherwise Low).",
      "falsePositives": "Low risk where strict reservations and dedicated resource pools guarantee minimum performance (e.g., vCPU/Memory reservations, dedicated GPUs, proven headroom) and continuous performance monitoring shows no saturation under peak load.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "100_sec3.ts",
      "bsiCode": "SYS.2.5",
      "id": "resource-exhaustion-on-virtualization-platform",
      "title": "Resource Exhaustion on Virtualization Platform (BSI CON.5)",
      "description": "Virtualization hosts consolidate many clients on shared CPU, RAM, storage and I/O. Without careful capacity planning and limits, concurrent tenants can contend for resources, causing unpredictable slowdowns or outages of virtual clients, especially with dynamic allocation or bursty workloads.",
      "impact": "Exhausted host resources degrade or halt all VMs on that host/cluster. This results in service slowdown or Denial of Service for dependent applications, primarily affecting availability and, indirectly, integrity (e.g., timeouts, failed writes).",
      "action": "Introduce host capacity planning, per-VM quotas/reservations, and proactive monitoring/alerting.",
      "mitigation": "Size hosts for peak load with headroom; configure per-VM CPU/memory reservations and hard limits; control noisy-neighbor effects (shares/limits); continuously monitor host and VM utilization with alerts; test failover and live-migration; isolate or dedicate hosts for critical tenants; prefer HA clusters for resilience.",
      "check": "Are CPU/memory reservations/limits set per VM? Is cluster/host utilization monitored with alerts and SLOs? Are HA/live migration features enabled and tested? Are critical workloads isolated from general tenants? Is there a documented capacity plan with periodic reviews and stress tests?",
      "asvs": "ASVS V13.2.1: Verify the application is resilient to resource exhaustion attacks.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Virtualization_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "Raised for any Shared Runtime that runs more than one in-scope Technical Asset (out-of-scope assets are ignored). Likelihood scales with tenant count: ≤3 ⇒ Unlikely, 4–7 ⇒ Likely, >7 ⇒ Very-Likely. Impact is the maximum availability requirement among tenants: Important ⇒ Medium, Critical ⇒ High, Mission-Critical ⇒ Very-High. The most critical tenant is highlighted as most relevant. Single-tenant shared runtimes do not raise this risk.",
      "riskAssessment": "More tenants on a host increase the chance of contention; few tenants make it unlikely, many tenants make it very likely. Impact mirrors the highest availability need among the co-tenants, so the presence of a mission-critical VM elevates impact to very high even if others are less critical.",
      "falsePositives": "May be a false positive where hard reservations/limits guarantee capacity, hosts are dedicated to a single critical tenant, or an HA/autoscaling cluster maintains ample headroom validated by stress tests and SLOs. Such assurances typically require operational evidence beyond the model.",
      "cwe": "770",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "100_sec4.ts",
      "bsiCode": "SYS.2.5",
      "id": "improper-virtual-network-segmentation-on-shared-host",
      "title": "Improper Virtual Network Segmentation on a Shared Host (BSI SYS.2.5 §2.4)",
      "description": "Virtual clients with differing protection needs are co-located on the same virtualization host. If virtual network components (vSwitches/port groups/VLANs/uplinks) are misconfigured, client traffic may traverse unintended segments, undermining the intended network separation.",
      "impact": "Breakdowns in virtual network segmentation can expose sensitive server networks to client segments, enabling unauthorized access, data disclosure, tampering, and lateral movement. Co-locating an internet-facing client with high-security internal networks significantly increases the institution’s attack surface.",
      "action": "Enforce, verify, and continuously monitor strict network segmentation at the virtualization layer.",
      "mitigation": "Configure vSwitches/port groups/VLAN tags to enforce the modeled boundaries. For mixed trust zones on one host, use separate virtual switches or strong, verified isolation (e.g., micro-segmentation). Regularly audit the hypervisor networking against the target architecture. In the model, apply '@hardening:hardened-virtual-networking' to Shared Runtimes where robust separation is assured.",
      "check": "Are technical assets from different network trust boundaries running on the same Shared Runtime? If so, is there robust, audited separation at the hypervisor layer (correct vSwitch/VLAN placement, no unintended bridging/uplinks) and—if applicable—documented hardening ('@hardening:hardened-virtual-networking')?",
      "asvs": "Aligned with BSI IT-Grundschutz: SYS.2.5 Client Virtualization (esp. Section 2.4: Network separation), SYS.2.1 General Client, SYS.1.5 Virtualization, and NET.1.1 Network Architecture & Design.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_1_General_client_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "For each Shared Runtime without the tag '@hardening:hardened-virtual-networking', collect all in-scope technical assets running on it. Resolve each asset’s nearest network-level Trust Boundary by walking up parent boundaries until a network boundary is found (using isTrustBoundaryNetworkBoundary). If more than one distinct network boundary is present on the same runtime, flag a risk. The generated title lists the boundary names to aid investigation. Likelihood defaults to 'Likely'; impact is derived from the most sensitive co-located asset and is further elevated if any internet-facing asset is present.",
      "riskAssessment": "Impact scales with the sensitivity and criticality of the mixed assets; mixing internet-facing clients with confidential or critical backends yields a very high impact. Likelihood is 'Likely' by default due to the inherent complexity and error-proneness of hypervisor networking. Runtimes explicitly tagged as hardened are excluded.",
      "falsePositives": "Possible when out-of-band micro-segmentation or dedicated per-zone hosts (SYS.2.5.A4) exist but are not modeled. Mark as mitigated or accepted with justification, or add the '@hardening:hardened-virtual-networking' tag to the runtime.",
      "cwe": "668",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "100_sec5.ts",
      "bsiCode": "SYS.2.5",
      "id": "loss-of-virtual-client-sys3.3",
      "title": "Loss of Virtual Client Due to Misconfiguration or Deletion (BSI SYS.2.5)",
      "description": "In client virtualization environments, virtual client images are centrally stored and managed.",
      "impact": "If a virtual client is lost or damaged, it directly affects the integrity of stored data (because it may be deleted) and the availability of the client and its processing functions.",
      "action": "Implement Redundancy and @Backup:Target/Restore Procedures for Virtual Clients",
      "mitigation": "Ensure that virtual client images are regularly backed up and that a documented and tested restore process is in place.",
      "check": "Are virtual client images and their data regularly backed up? Is there a documented and tested recovery procedure?",
      "asvs": "Based on the BSI IT-Grundschutz module SYS.2.5 Client Virtualization, addressing threats such as incorrect planning/configuration and operator error.",
      "cheatSheet": "See the BSI IT-Grundschutz Compendium, module SYS.2.5 Client Virtualization.",
      "detectionLogic": "Triggers for any technical asset that is a non-redundant virtual client system.",
      "riskAssessment": "The likelihood of operator error or misconfiguration is generally considered 'likely' in complex environments.",
      "falsePositives": "The risk might be overestimated if robust, out-of-model compensating controls exist, such as a separate, highly effective @Backup:Target and recovery system that makes client restoration straightforward.",
      "cwe": "404",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "100_sec6.ts",
      "bsiCode": "SYS.2.5",
      "id": "unavailability-of-virtual-clients-bsi-con-3",
      "title": "Unavailability of Virtual Clients (BSI CON.3)",
      "description": "Virtual clients—unlike physical machines—are often centrally managed by IT operations administering the virtualization infrastructure.",
      "impact": "The unavailability of a virtual client prevents users from performing their tasks, which can lead to business process disruptions and loss of productivity.",
      "action": "Implement High-Availability and Recovery Procedures for the Virtualization Infrastructure",
      "mitigation": "Use high-availability (HA) features of the virtualization platform, such as failover clustering and live migration, to minimize downtime.",
      "check": "Is the virtualization platform configured as a high-availability cluster? Are there automated alerts when a virtual client becomes unresponsive? Are there documented and tested procedures for restarting clients after maintenance or a host failure? Is the 'redundant' flag set for critical virtual assets in the model?",
      "asvs": "BSI IT-Grundschutz CON.3: Virtualisierung (related to threat G 0.14 Ausfall von IT-Komponenten)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/bausteine/con/CON_3_Virtualisierung_Edition_2023.html",
      "detectionLogic": "This risk is raised for any technical asset configured as a virtual machine (`machine: virtual`) that runs on a shared runtime representing the virtualization host. The risk highlights the inherent availability dependency on the underlying shared runtime.",
      "riskAssessment": "The likelihood of this risk materializing depends on the stability, redundancy, and maintenance procedures of the virtualization platform. The impact is determined by the availability requirement (criticality) of the virtual client and the data it handles. A mission-critical virtual client will have a very high impact if it becomes unavailable.",
      "falsePositives": "This risk can be considered a false positive if the virtualization platform is already configured with robust high-availability and automated recovery mechanisms that are not fully represented in the threat model.",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "100_sec7.ts",
      "bsiCode": "SYS.2.5",
      "id": "compromise-of-virtual-client-from-outdated-template",
      "title": "Compromise of Virtual Clients due to Outdated Templates (BSI SYS.2.5 – Threat 2.7, Req. A9)",
      "description": "Virtual clients are typically provisioned from templates (virtual hardware profile and base image). If these templates are not regularly refreshed, newly created clients may ship with software that already contains known vulnerabilities (see SYS.2.5 §2.7). As soon as such clients are reachable by other IT systems, automated exploitation becomes feasible and can result in client compromise.",
      "impact": "Successful exploitation can yield full control over the virtual client, enabling credential theft, lateral movement, and data exfiltration. This threatens the client’s Confidentiality, Integrity, and Availability and may extend to adjacent systems and data processed or stored by the client.",
      "action": "Establish Template Lifecycle & Patch Governance for Virtual Clients",
      "mitigation": "Maintain a formal lifecycle for virtual client templates: version, patch, test, and deprecate on schedule. Automate image rebuilds and security updates; retire superseded templates. If intentionally deploying legacy/vulnerable clients (e.g., for compatibility testing), confine them to isolated segments with strict access controls and continuous monitoring. Use the tag '@Mitigation:TemplatePatching' on assets where an effective, automated update process is in place.",
      "check": "Are templates centrally managed, versioned, and regularly rebuilt? When was the last update? Is there evidence of automated patching and removal of end-of-life (EOL) templates? For test/legacy clients, is isolation enforced and documented? Is the '@Mitigation:TemplatePatching' tag applied where appropriate?",
      "asvs": "Mapped to BSI IT-Grundschutz SYS.2.5 (A9 templates kept up to date; A16/A17 enhanced logging and monitoring) and SYS.1.5 Virtualization, where applicable.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_Virtualization_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Flags any technical asset that (1) runs on a virtual machine (machine type 'virtual'), (2) is a client technology (e.g., desktop/VDI/terminal client), (3) is in scope, and (4) is not tagged with '@Mitigation:TemplatePatching'. This aligns with SYS.2.5 §2.7 and A9: if no explicit mitigation is modeled, templates are assumed to drift out of date.",
      "riskAssessment": "Likelihood defaults to 'Likely' because template drift is a common operational lapse. Impact scales with the asset’s CIA ratings: high or mission-critical confidentiality, integrity, or availability elevates the impact up to Very High, especially when mission-critical data is processed.",
      "falsePositives": "This may be a false positive if automated template rebuilds/patching exist but are not modeled via '@Mitigation:TemplatePatching'. Intentional legacy/test clients can also be flagged; risk may be acceptable if they are tightly isolated and continuously monitored.",
      "cwe": "1191",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "100_sec8.ts",
      "bsiCode": "SYS.2.5",
      "id": "compromised-virtual-client-on-shared-infrastructure-con3",
      "title": "Client Virtualization: Co-tenancy Risk on Shared Infrastructure (BSI CON.3 / SYS.2.5)",
      "description": "Interactive virtual clients that run on shared virtualization hosts can endanger colocated workloads.",
      "impact": "Compromise of a single virtual client can lead to loss of confidentiality/integrity or denial of service for",
      "action": "Avoid co-tenancy of untrusted or easily compromised clients with sensitive/critical workloads; enforce strong separation.",
      "mitigation": "Enforce strict logical separation between VMs on the same host; do not colocate general-purpose user desktops with",
      "check": "Inspect all Shared Runtimes: is there at least one virtual client (desktop/browser/client-type or human-operated VM) running together with",
      "asvs": "BSI IT-Grundschutz-Bausteine: CON.3 Virtualisierung und SYS.2.5 Client-Virtualisierung; insbesondere CON.3.A17 (Trennung virtueller IT-Systeme).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Virtualisierung_Edition_2023.pdf?__blob=publicationFile (German original, PDF)",
      "detectionLogic": "Trigger when a Shared Runtime hosts ≥1 technical asset with machine='virtual' that is a client (client-technology or usedAsClientByHuman)",
      "riskAssessment": "Likelihood is derived from client exposure (internet access increases it) and the weakest client's RAA. Impact is based on the most sensitive co-tenant",
      "falsePositives": "Lower severity or exceptions may apply when the platform provides certified strong isolation that is correctly configured and patched,",
      "cwe": "668",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "101_sec1.ts",
      "bsiCode": "SYS.2.6",
      "id": "resource-overbooking-in-vdi",
      "title": "Resource Overbooking in VDI",
      "description": "A Virtual Desktop Infrastructure (VDI) is commonly used to optimize resources. However, when many virtual clients are consolidated on single virtualization hosts, or when the number of users is underestimated, available resources can be overbooked. This can cause severe resource contention among virtual clients and unpredictable performance degradation.",
      "impact": "Overbooking of resources can lead to the temporary unavailability of virtual clients (denial of service). Performance degradation is often non-transparent to users, which can result in data loss or unintentional data modification, compromising integrity and availability.",
      "action": "Implement VDI capacity planning and performance monitoring",
      "mitigation": "Establish a robust capacity planning and management process for the VDI environment. Continuously monitor resource utilization (CPU, memory, I/O, network) on virtualization hosts. Use load balancing and define clear thresholds for the number of clients per host. Set resource limits and reservations for critical virtual clients to guarantee their performance. Avoid consolidating too many resource-intensive clients on a single physical host.",
      "check": "Is there an established capacity management process for the VDI? Is resource utilization being actively monitored against defined thresholds? Are performance and availability SLAs defined and met for virtual clients?",
      "asvs": "Aligned with BSI IT-Grundschutz for virtualization and client management, in particular SYS.2.6 Virtual Desktop Infrastructure and APP.1.1 Office Products.",
      "cheatSheet": "BSI IT-Grundschutz Compendium: SYS.2.6 Virtual Desktop Infrastructure; APP.1.1 Office Products.",
      "detectionLogic": "This risk is indicated when a shared runtime, representing a VDI host, runs a large number of virtual clients (e.g., assets with 'Desktop' or 'Client-System' technology). A high count of such assets within a single shared runtime suggests potential resource contention and overbooking, leading to performance degradation and unavailability.",
      "riskAssessment": "The likelihood increases with the number of virtual clients per host. The impact is determined by the highest availability and integrity requirements of the virtual clients and the data they process. If clients are used for mission-critical tasks, the impact is high, because performance degradation can halt business processes.",
      "falsePositives": "A high number of clients on a single host may not pose a risk if the underlying hardware is exceptionally powerful and managed by effective resource schedulers. This rule is a heuristic and should be validated against the actual hardware specifications and monitoring data of the VDI environment.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "101_sec2.ts",
      "bsiCode": "SYS.2.6",
      "id": "faulty-vdi-profile-assignment",
      "title": "Incorrect VDI Profile Assignment (BSI SYS.2.6)",
      "description": "In a Virtual Desktop Infrastructure (VDI), virtual clients and their resources are centrally assigned to users via profiles.",
      "impact": "An incorrect VDI profile assignment can directly lead to privilege escalation, where users gain access to data and systems beyond their permissions.",
      "action": "Implement and Enforce Least-Privilege VDI Profiles",
      "mitigation": "Design and implement VDI profiles according to the principle of least privilege, ensuring users have access only to the resources required for their roles.",
      "check": "Are VDI profiles strictly configured according to the principle of least privilege? Are there separate, hardened profiles for users with different security requirements?",
      "asvs": "BSI IT-Grundschutz SYS.2.6 Virtual Desktop Infrastructure, in particular requirements SYS.2.6.A4 (Network segmentation of VDI components) and SYS.2.6.A5 (Standardized access to virtual clients).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Virtual_Desktop_Infrastructure_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies VDI management servers (tagged with `@System:VDI`).",
      "riskAssessment": "The impact is determined by the confidentiality, integrity, and availability rating of the backend system the virtual client can access.",
      "falsePositives": "A detected connection from a virtual client to a backend system might be legitimate for a specific power user or administrative role.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "101_sec3.ts",
      "bsiCode": "SYS.2.6",
      "id": "bypassed-network-segmentation-vdi",
      "title": "VDI: Bypassed Network Segmentation (BSI SYS.2.6)",
      "description": "VDI deployments often operate many virtual clients for different user groups, ideally isolated by network segmentation. When a single VDI management component assigns or controls clients across security zones, a misconfiguration can undermine that separation and enable unintended cross-zone communication.",
      "impact": "Successful bypass of segmentation enables lateral movement from lower- to higher-trust networks, potential privilege escalation, and compromise of sensitive systems or data governed by the most critical client managed by the VDI component.",
      "action": "Harden VDI management & enforce independent network segmentation",
      "mitigation": "Harden and securely configure the VDI management plane. Enforce strict RBAC for client-to-user/group assignments. Implement deny-by-default segmentation in the network (firewalls, VLANs, cloud security groups/microsegmentation) so the VDI cannot override it. Regularly audit group mappings, templates, and network rules; apply change control and peer review for assignment logic.",
      "check": "Does a single VDI manager control clients in multiple network zones? Are DevOps/management links allowed to traverse zones? Are segmentation controls independent of VDI logic and verified (e.g., policy-as-code, firewall baselines, microsegmentation)? Are assignments and templates reviewed and monitored for drift?",
      "asvs": "BSI IT-Grundschutz SYS.2.6 / CON.5.A13 – Secure network configuration for virtualized IT systems",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Virtualization_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "Flags any technical asset tagged @System:VDI that has DevOps/management communication links to ≥2 virtual clients which resolve (via parent trust boundaries) to ≥2 distinct network-type trust boundaries. Group clients by their resolved network boundary; if more than one unique boundary exists, attach one risk to the VDI manager and reference all managed clients.",
      "riskAssessment": "Likelihood is set to Likely because a single control plane spanning zones is a common source of misconfiguration. Impact is derived from the maximum confidentiality/integrity/availability level across the VDI manager and all managed clients: higher levels yield Medium/High/VeryHigh impact. Data breach probability is set to Possible when impact exceeds Medium.",
      "falsePositives": "Strong, independently enforced segmentation (e.g., microsegmentation with deny-by-default and verified policies) may prevent cross-zone traffic even if one VDI component manages multiple zones. Compensating controls (separate admin planes, dedicated infrastructure, immutable assignments with approvals) can reduce risk; verify their effectiveness before suppressing this finding.",
      "cwe": "668",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "101_sec4.ts",
      "bsiCode": "SYS.2.6",
      "id": "@System:VDI-corruption-or-reset",
      "title": "Data Loss on a VDI Client Due to Template Corruption or Reset",
      "description": "A key strength of Virtual Desktop Infrastructure (VDI) is the ease of managing many virtual clients through a few central templates.",
      "impact": "This scenario directly affects the integrity and availability of user data and system configurations.",
      "action": "Implement data-persistence and backup strategies for the VDI environment.",
      "mitigation": "Ensure that user data is not stored exclusively on non-persistent or volatile virtual desktops.",
      "check": "Are VDI clients used in the architecture? If so, is user data stored exclusively on these clients?",
      "asvs": "Derived from the BSI IT-Grundschutz module SYS.2.6 (Virtual Desktop Infrastructure/Virtualisation). This is an architectural and operational risk specific to virtualization environments and does not map directly to OWASP ASVS, which focuses on application-layer security.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_6_Virtualisation_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any technical asset tagged with '@System:VDI' that also has data assets listed in its 'dataAssetsStored' property.",
      "riskAssessment": "The likelihood is assessed as 'Likely' because accidental deletion, misconfiguration, or corruption of central VDI templates is a known operational risk.",
      "falsePositives": "A false positive can occur if the model indicates data is stored on the VDI client, but an unmodeled external persistence mechanism (such as a profile management solution that redirects folders to a network share) is in use.",
      "cwe": "732",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "101_sec5.ts",
      "bsiCode": "SYS.2.6",
      "id": "@System:VDI-failure-con-5",
      "title": "VDI Component Single Point of Failure (BSI SYS.2.6 / CON.5)",
      "description": "A Virtual Desktop Infrastructure (VDI) is built from interdependent core components (Access, Control, Management). If any one of these components lacks high availability and fails—due to hardware/software faults or misconfiguration—the overall VDI availability is endangered. Even a loss of the management tier can halt provisioning, resets, or capacity adjustments and severely slow recovery.",
      "impact": "Unplanned downtime of a core VDI component blocks users from reaching their desktops or administrators from restoring service, degrading productivity and business continuity. Severity scales with the availability requirement of the affected service.",
      "action": "Design VDI core components for high availability and remove single points of failure.",
      "mitigation": "Model critical VDI components (Access/Control/Management) as redundant (e.g., failover clusters, load balancers, active/active pairs). In Threagile, set `redundant: true` on those technical assets. Implement health checks, configuration management, regular failover tests, and consider site-level and network redundancy.",
      "check": "Are all technical assets representing VDI components (tagged `@System:VDI`) modeled with `redundant: true`? Is monitoring in place to detect component loss and cluster degradation?",
      "asvs": "BSI SYS.2.6.A15 Hochverfügbare Bereitstellung der VDI-Komponenten; BSI IT-Grundschutz CON.5.A5 High availability of the virtualization solution",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Virtualization_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Flag every in-scope technical asset tagged `@System:VDI` where `redundant !== true`. Out-of-scope assets are ignored. Such assets are treated as potential single points of failure.",
      "riskAssessment": "Likelihood is Likely when a critical component lacks redundancy. Impact is derived from the asset’s availability requirement (MissionCritical → VeryHigh, Critical → High, Important → Medium).",
      "falsePositives": "High availability may exist but not be modeled (e.g., active/active behind a load balancer, managed cloud HA, or external site-failover). Verify the real architecture and update the model with `redundant: true` where appropriate.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "101_sec6.ts",
      "bsiCode": "SYS.2.6",
      "id": "kompromittierung-vdi-managementkomponente",
      "title": "Compromise of the VDI Management Component (BSI SYS.2.6 / APP.3.2)",
      "description": "A VDI management component administers virtual desktops/clients and the policies that assign users to them. If it is compromised (e.g., via vulnerabilities, misconfiguration, or credential theft), an attacker can pivot into most or all connected virtual clients and related infrastructure, degrading confidentiality, integrity, and availability at scale. Because the manager and its agents orchestrate provisioning and in-session controls, it is both a high-value target and a single point of failure.",
      "impact": "Compromising the central manager enables mass account and session takeover, remote code execution on clients, bulk data exfiltration or destruction, and widespread denial of service, disrupting business processes that depend on the VDI platform.",
      "action": "Harden and isolate the VDI management plane; enforce strong authentication and least privilege; monitor aggressively.",
      "mitigation": "Isolate management interfaces on dedicated admin/VPN networks; require MFA for all administrators (including emergency break-glass accounts) and use RBAC/least privilege; patch OS, manager, and agent software promptly; disable or restrict risky agent features; enable tamper protection and code signing for templates/agents; log all admin actions centrally (SIEM) with alerting; keep offline/immutable backups and tested recovery for manager configuration and golden images; avoid exposing the manager directly to the internet; deploy redundant manager nodes if supported.",
      "check": "• Are management interfaces reachable only from a dedicated admin network/VPN and never directly from the internet? • Is MFA enforced for all admin accounts (including emergency accounts) and are roles least-privileged? • Are the manager software, OS, and VDI agents fully patched and hardened? • Are administrative actions centrally logged and monitored (SIEM) with alerting? • Are templates/golden images signed, updated, and protected; are resets/provisioning controlled? • Is the management component deployed redundantly and regularly backed up/recovered in tests?",
      "asvs": "BSI IT-Grundschutz: SYS.2.6 Virtual Desktop Infrastructure (e.g., A11 Monitoring, A15 High Availability, A16 SIEM); as well as APP.3.2 Virtualisierung and SYS.2.5 Client-Virtualisierung.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_Virtualization_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Flags a likely VDI management plane when a central in-scope technical asset with technology in {ApplicationServer, WebServer, Gateway, Management} has outbound communication links to more than Quantity.Few distinct client endpoints whose technology is {Desktop, ClientSystem}. The more desktop/client links, the stronger the signal. Likelihood is further increased when the asset is internet-facing or has custom-developed parts (single instance, no redundant peers). Excludes out-of-scope assets. Heuristics mirror: count = manager.communicationLinks → unique targets filtered by client tech; threshold = getQuantityFactor(Quantity.Few).",
      "riskAssessment": "Impact scales with the number of governed clients (Many ⇒ High, VeryMany ⇒ VeryHigh) and is elevated to High/VeryHigh when any client handles Confidential/StrictlyConfidential data. Likelihood starts Unlikely, becomes Likely if the manager has custom-developed parts, and VeryLikely if it is internet-reachable. Data breach probability rises from Improbable → Possible (Restricted) → Probable (Confidential+).",
      "falsePositives": "Other central systems with many desktop connections (e.g., software deployment/patching, endpoint management/MDM, monitoring, remote assistance, directory services) can match the pattern. Confirm the role by name/description/tags, network placement (admin network), and presence of VDI agents/templates before triaging. If noise is high, tag true VDI managers accordingly and suppress non-VDI managers via model metadata.",
      "cwe": "732",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "101_sec7.ts",
      "bsiCode": "SYS.2.6",
      "id": "vdi-outdated-template",
      "title": "Outdated VDI Template Enables Known Vulnerabilities (BSI SYS.2.6 §2.7, A9)",
      "description": "In a Virtual Desktop Infrastructure (VDI), virtual clients are provisioned from master images (templates).",
      "impact": "A compromised desktop provisioned from an outdated template can provide initial access, enable lateral movement, and lead to unauthorized data access or service disruption.",
      "action": "Place all VDI master templates under formal patch management with regular, documented recompose cycles.",
      "mitigation": "Maintain a hardened, versioned golden image; scan it routinely for vulnerabilities; apply vendor and OS patches;",
      "check": "Is there a schedule and evidence for rebuilding and patching VDI golden images?",
      "asvs": "BSI IT-Grundschutz: SYS.2.6 Virtual Desktop Infrastructure — Section 2.7 (Use of templates with software vulnerabilities) and Requirement A9 (Patch and Change Management).",
      "cheatSheet": "Ensure golden images are patch-managed, regularly rebuilt/recomposed, and that existing pools are refreshed/reprovisioned after image updates.",
      "detectionLogic": "Marks technical assets of type 'datastore' tagged with @System:VDI that are not also tagged with patch-managed.",
      "riskAssessment": "Likelihood is very likely because outdated images accumulate known, widely exploitable issues.",
      "falsePositives": "Staging or isolated lab templates that cannot be accessed by other systems may be flagged if they lack the mitigation tag.",
      "cwe": "1119",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "102_sec1.ts",
      "bsiCode": "SYS.3.1",
      "id": "mobile-client-in-untrusted-environment",
      "title": "Mobile Clients on Untrusted Networks (aligned with BSI SYS.3.1 Laptops)",
      "description": "Laptops and other mobile clients are used in diverse, often untrusted environments.",
      "impact": "Connecting a mobile client to an untrusted network without proper safeguards can lead to device compromise.",
      "action": "Require a secure tunnel (VPN or ZTNA) and harden endpoints for mobile use",
      "mitigation": "Route all traffic from mobile clients on external networks through a mandatory, system-enforced VPN or ZTNA tunnel.",
      "check": "Is a system-enforced VPN/ZTNA required off-premises? Is there a technical control preventing bypass (no split tunneling for sensitive apps)?",
      "asvs": "BSI IT-Grundschutz SYS.3.1 (Laptops); OWASP MASVS-NETWORK; OWASP ASVS V9 (Communications); CIS Safeguards 12 & 13.",
      "cheatSheet": "",
      "detectionLogic": "Flags any communication link where: (1) the source is a client technology marked as internet-facing (`internet: true`),",
      "riskAssessment": "Likelihood is very high for clients on public networks. Impact scales with the sensitivity of data stored on the client and sent over the link.",
      "falsePositives": "May be a false positive when an always-on, system-level VPN/ZTNA is enforced outside the model; when a secure gateway is modeled elsewhere;",
      "cwe": "319",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "102_sec2.ts",
      "bsiCode": "SYS.3.1",
      "id": "laptop-theft-or-loss-con1",
      "title": "Theft or Loss of Laptops (BSI CON.1)",
      "description": "Employees often use their laptops outside the institution's premises. The devices are transported in private vehicles or on public transport, left unattended in external offices during breaks, or kept in hotel rooms.",
      "impact": "If an unencrypted laptop containing sensitive data is lost or stolen, it can lead to a severe data breach (Confidentiality), permanent data loss if not backed up (Availability), and significant financial and reputational damage.",
      "action": "Enforce Full-Disk Encryption on Laptops",
      "mitigation": "All laptops that may store or process sensitive data must have full-disk encryption (FDE) enabled (e.g., BitLocker for Windows, FileVault for macOS). This should be enforced via technical policy (e.g., MDM, GPO).",
      "check": "Are all laptops, especially those used by mobile workers, confirmed to have full-disk encryption enabled and enforced by policy? Are there regular backups of important data stored on these laptops?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1: Laptops. This risk directly corresponds to the threats CON.1.G1 (Theft of a laptop) and CON.1.G2 (Loss of a laptop). The primary mitigation is covered by requirement CON.1.A5 (Hard disk encryption on laptops).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Laptops_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset identified as a client-type system (e.g., technology 'client-system', 'desktop', 'mobile-app') that stores data but does not have data-at-rest encryption enabled ('encryption: none').",
      "riskAssessment": "The likelihood of theft or loss for a mobile device like a laptop is inherently high. The exploitation of this (i.e., accessing the data) is trivial if the disk is unencrypted. Therefore, the likelihood is considered 'Very Likely'.",
      "falsePositives": "This risk might be considered a false positive for an asset that, while modeled as a 'desktop', is a stationary machine in a physically secure location (e.g., a locked office or data center) that never moves.",
      "cwe": "311",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "102_sec3.ts",
      "bsiCode": "SYS.3.1",
      "id": "uncontrolled-shared-device-handover",
      "title": "Uncontrolled Handover of Shared Laptops (BSI SYS.3.1, Section 2.3)",
      "description": "Sharing laptops as pool devices without a formal process creates a persistent risk of data remanence and cross-user contamination.",
      "impact": "Potential confidentiality breaches (exposure of another user’s data), integrity violations (malware/tampering), and availability impacts (device quarantined or re-imaged).",
      "action": "Define and enforce a check-in/check-out and sanitization process for pool laptops",
      "mitigation": "Enforce an MDM-driven wipe or re-imaging from a golden image between users; require full-disk encryption with pre-boot authentication;",
      "check": "Is there a documented policy for pool devices? Is an MDM policy enforcing wipe/re-image between users? Are custody logs complete and auditable?",
      "asvs": "BSI IT-Grundschutz: SYS.3.1.A7 Geregelte Übergabe und Rücknahme; SYS.3.1.A13 Verschlüsselung von Laptops; CON.3.A13 Reissuing and returning mobile devices",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_devices_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Flags in-scope client assets explicitly tagged 'shared-device'. Impact is derived from the asset’s highest confidentiality or integrity;",
      "riskAssessment": "Likelihood: Likely for any asset tagged as shared. Impact tiers: Medium if confidentiality ≥ Restricted or integrity ≥ Important;",
      "falsePositives": "Possible if a robust, enforced wipe/re-image process (via MDM), ephemeral profiles, and custody logging exist but are not modeled.",
      "cwe": "212",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "103_sec1.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "unsupported-mobile-os",
      "title": "Risk from Outdated or Unsupported Mobile Operating Systems",
      "description": "Mobile operating systems receive frequent updates, but device manufacturers (OEMs) must first integrate and distribute them, often leading to delays.",
      "impact": "Exploiting an unpatched vulnerability in a mobile OS can lead to a full compromise of the device.",
      "action": "Enforce Mobile OS Version and Patch Level Management",
      "mitigation": "Implement a Mobile Device Management (MDM) solution to enforce security policies on all mobile devices accessing corporate data or systems.",
      "check": "Is there a Mobile Device Management (MDM) solution in use? Does it enforce minimum OS and patch-level policies?",
      "asvs": "BSI IT-Grundschutz SYS.3.2.1 Allgemeine Smartphones und Tablets, requirement A5 (Updates von Betriebssystem und Apps), and SYS.3.2.2 Mobile Device Management (MDM).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/sys/SYS_3_2_1_Allgemeines_Mobiltelefon_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Triggers for any technical asset of technology type 'mobile-app' that is not explicitly tagged as being managed by an MDM solution",
      "riskAssessment": "The likelihood is very high for unmanaged mobile fleets, as users often delay or ignore updates, and older devices remain in use.",
      "falsePositives": "This risk can be considered a false positive if an effective MDM or a similar compensating control for OS patch management is in place but has not been documented in the model by applying the 'mobile-os-patch-management-mdm' tag to the asset.",
      "cwe": "937",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "103_sec10.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "privilege-escalation-on-mobile-os-sys3.1.a5",
      "title": "Privilege Escalation on Mobile Devices via OS Vulnerabilities (Jailbreaking/Rooting)",
      "description": "Vulnerabilities are frequently discovered in smartphone and tablet operating systems that allow attackers to bypass established security controls. This enables unauthorized access to system processes and protected memory areas. Attackers can exploit these weaknesses, often using techniques similar to user-initiated 'jailbreaking' or 'rooting', to install malware or execute other malicious actions.",
      "impact": "Successful exploitation allows an application to gain unintended privileges (Elevation of Privilege), enabling it to execute unauthorized actions. This could include accessing sensitive data from the OS or other apps, installing malware, or manipulating the device. This compromises the confidentiality and integrity of data on the device and can lead to a complete takeover of the asset.",
      "action": "Implement Jailbreak/Root Detection and Use Mobile Device Management",
      "mitigation": "For mobile applications handling sensitive data, implement robust jailbreak/root detection mechanisms to prevent the app from running on a compromised device or to operate it in a limited-functionality mode. Keep mobile operating systems and all applications up to date with the latest security patches. Employ Mobile Device Management (MDM) solutions to enforce security policies, such as disallowing rooted/jailbroken devices from accessing corporate resources. The risk can be marked as mitigated by tagging the mobile-app asset with `@root-detection:implemented`.",
      "check": "Does the mobile application implement root/jailbreak detection? Are mobile devices managed by an MDM solution that enforces policies against compromised devices? Is there a process for ensuring mobile OS and app updates are applied promptly?",
      "asvs": "BSI IT-Grundschutz SYS.3.1.A5 (Bypassing security mechanisms through jailbreaking or rooting)",
      "cheatSheet": "https://www.owasp.org/index.php/Mobile_Top_10_2016-M1-Improper_Platform_Usage",
      "detectionLogic": "This risk is generated for all in-scope technical assets of technology 'Mobile App'. The risk is assumed to be present unless explicitly mitigated via the `@root-detection:implemented` tag on the asset.",
      "riskAssessment": "The likelihood is considered 'likely' due to the frequent discovery of OS vulnerabilities and the widespread availability of exploitation tools. The impact is directly proportional to the sensitivity (confidentiality and integrity) of the data processed or stored by the application on the mobile device. An application handling 'Strictly Confidential' data is likely to have a 'High' or 'Very High' impact.",
      "falsePositives": "This risk might be considered a false positive if the application handles only non-sensitive, public data, or if it has exceptionally strong, state-of-the-art anti-tampering and root/jailbreak-detection controls that are not captured by the simple mitigation tag.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "103_sec2.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "@Maintenance:Unmaintained-preinstalled-or-third-party-software",
      "title": "@Maintenance:Unmaintained Preinstalled or Third-Party Software",
      "description": "Preinstalled or third-party applications may contain vulnerabilities exploitable via local or network attacks.",
      "impact": "If vulnerabilities in such components are exploited, it can lead to a full compromise of the technical asset, resulting in unauthorized access to or modification of data (Confidentiality, Integrity), Denial of Service (Availability), or the asset being used as a pivot point for further attacks within the architecture.",
      "action": "Manage Third-Party Component Lifecycle",
      "mitigation": "Maintain a complete inventory of all third-party and preinstalled software components (a 'Software Bill of Materials' or SBOM).",
      "check": "Is there a complete inventory of all third-party software components? Are SCA tools used to scan for vulnerabilities? Is there a defined process for handling vulnerable or @Maintenance:Unmaintained components?",
      "asvs": "OWASP ASVS V14: Software Component Verification Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for technical assets explicitly tagged as `@Maintenance:Unmaintained`.",
      "riskAssessment": "The likelihood is **Very Likely** if an asset is explicitly tagged as @Maintenance:Unmaintained. It is **Likely** for other non-custom components where the maintenance status is unknown.",
      "falsePositives": "This risk might be a false positive if an asset is not tagged but is flagged due to its technology type, yet a robust vulnerability and patch management process is demonstrably in place for all its third-party components.",
      "cwe": "1104",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "103_sec3.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "unauthorized-manipulation-of-mobile-devices",
      "title": "Unauthorized Manipulation of Mobile Devices (Smartphones & Tablets)",
      "description": "Attackers may gain access to smartphones or tablets and manipulate them by changing configurations, starting unauthorized services,",
      "impact": "Manipulation can degrade the integrity and confidentiality of data on the device and in transit; enable credential or session theft;",
      "action": "Harden mobile endpoints and apps: enforce MDM, use a strong lock screen, minimize permissions, encrypt communications, disable sideloading and debugging,",
      "mitigation": "Use an MDM to enforce policies (screen lock, biometric policies, encryption, VPN, app allowlists/denylists).",
      "check": "Is MDM enrollment mandatory and compliant? Are OS and app updates automated and timely? Are developer options and sideloading disabled?",
      "asvs": "OWASP MASVS v2: MASVS-STORAGE, MASVS-NETWORK, MASVS-PLATFORM",
      "cheatSheet": "OWASP MSTG & MASVS: https://owasp.org/www-project-mobile-app-security/ | https://mas.owasp.org/",
      "detectionLogic": "Triggers for every in-scope TechnicalAsset with technology 'MobileApp'. Likelihood is derived from internet exposure:",
      "riskAssessment": "Internet-accessible mobile apps that process sensitive data (e.g., PII/health/location) have higher severity.",
      "falsePositives": "May be less relevant for tightly locked-down, single-purpose devices (e.g., kiosk devices) operating in isolated environments",
      "cwe": "284",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "103_sec4.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "malware-on-mobile-devices",
      "title": "Mobile Malware on Smartphones & Tablets",
      "description": "Mobile devices are attractive targets for malware. While overall infection rates may be lower than on desktop systems, the ubiquity of apps, always-on connectivity (cellular, Wi-Fi, Bluetooth, NFC), and user-driven installation patterns create a meaningful attack surface. Obtaining apps from untrusted sources, lagging OS/app updates, or using rooted/jailbroken devices significantly increases risk.",
      "impact": "Compromise can lead to loss of confidentiality, integrity, and availability of data on the device, credential theft, session hijacking, unauthorized transactions, and lateral movement into backend services. Attackers may impersonate users and exfiltrate sensitive organizational information.",
      "action": "Deploy and enforce MDM/MAM; restrict app sources to official stores; ensure timely OS/app patching; use app vetting for sensitive use cases.",
      "mitigation": "Use MDM/MAM to enforce: store-only app installation, timely OS/app updates, device encryption, screen-lock policies, and disabling unused radios/interfaces; monitor app permissions (camera, mic, location, health data) per data-protection policy; implement strong authN/Z on backends to limit impact of compromised clients; consider app attestation and runtime protections for high-risk apps.",
      "check": "Is MDM/MAM in place and enforced? Are non-store app installs blocked? Are OS/app updates mandated and verifiable? Are sensitive permissions restricted by policy? Do backend systems require strong, device-agnostic authentication and least privilege to withstand a compromised mobile client?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.5 — Schutz vor Schadprogrammen",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Protection_against_malware_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "Automatically flags every in-scope technical asset with technology 'Mobile App'. Impact is raised when the app processes or stores sensitive data (Confidentiality ≥ Confidential, Integrity/Availability ≥ Critical). Impact escalates to High if the app handles Strictly Confidential data, is Mission-Critical, or communicates with in-scope, backend-only systems that have high confidentiality or integrity requirements.",
      "riskAssessment": "Baseline likelihood is set to 'Likely' due to the prevalence of mobile malware. Impact scales with the app’s highest confidentiality/integrity/availability and is further elevated when connecting to sensitive backend services. Data breach probability is 'Probable' if the app handles confidential data; otherwise 'Possible'.",
      "falsePositives": "Risk may be reduced if a mature, enforced MDM/MAM is deployed (store-only installs, rapid patching, encryption, strict permission controls), devices are not rooted/jailbroken, sensitive apps use attestation and runtime protections, and backends strictly enforce authentication/authorization to contain compromised clients.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "103_sec5.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "web-based-attacks-on-mobile-clients",
      "title": "Web-Based Attacks on Mobile Clients",
      "description": "Mobile browsers, as well as many other apps, can display web pages and web content.",
      "impact": "A successful attack can lead to the installation of malware (violating Integrity),",
      "action": "Secure Client-Side Web Content Handling",
      "mitigation": "Ensure that components rendering web content (e.g., WebViews) are kept up-to-date and configured securely,",
      "check": "Are mobile applications and browsers kept up-to-date? Are secure configurations for WebViews enforced?",
      "asvs": "OWASP MASVS v8.1 (MSTG-CODE-1): The app is vulnerable to WebView-related issues.",
      "cheatSheet": "https://mas.owasp.org/MASTG/tests/android/MASTG-TEST-0050/",
      "detectionLogic": "This risk is raised for technical assets identified as internet-facing mobile clients",
      "riskAssessment": "The likelihood is high for any mobile client that browses the general internet.",
      "falsePositives": "This risk can be considered a false positive if the application only renders fully static, trusted,",
      "cwe": "829",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "103_sec6.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "unauthorized-access-to-mobile-health-location-data",
      "title": "Mobile: Exposure of Health, Fitness, and Location Data (BSI SYS.3.2.1 §2.6)",
      "description": "Smartphones and tablets often aggregate highly sensitive health, fitness, and location data.",
      "impact": "Exploitation can disclose special category personal data, causing severe privacy violations, identity-theft risks, potential physical safety issues, and major regulatory and reputational harm to the organization.",
      "action": "Enforce at-rest encryption and TLS-only communication for mobile apps; manage devices via MDM and harden app permissions.",
      "mitigation": "Encrypt sensitive data at rest with strong, user- or device-bound keys (e.g., OS Keychain/Keystore, file-based encryption).",
      "check": "Verify that mobile apps do not store sensitive data unencrypted and that all communication links use TLS (e.g., HTTPS).",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.2.1 §2.6 'Missbrauch von Gesundheits-, Fitness- und Ortungsdaten' and aligned with measures such as A11 (storage encryption), A22 (VPN), A32 (MDM), and A33 (security apps).",
      "cheatSheet": "Prioritize at-rest encryption using platform keystores, TLS-only transport (HTTPS/WSS), strong authentication, least-privilege data access, MDM-enforced policies, and disable sensitive lock screen previews.",
      "detectionLogic": "Detects in-scope technical assets of technology 'MobileApp' that process data assets tagged with @PiiType:Health, @PiiType:Fitness, or @PiiType:Location.",
      "riskAssessment": "Impact is 'Very High' due to strictly confidential personal data (health/location). Likelihood becomes 'Very Likely' when encryption at rest or in transit is missing, producing a critical severity.",
      "falsePositives": "Possible if OS-level storage encryption is active but not modeled, or if compensating controls (e.g., an always-on, enforced enterprise VPN with strict split-tunneling restrictions) are mandated.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "103_sec7.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "lock-screen-information-disclosure-on-mobile-devices",
      "title": "Lock-Screen Information Disclosure on Smartphones and Tablets",
      "description": "Most mobile operating systems can display notifications from widgets and push messages on the lock screen. This may expose confidential information to unauthorized persons who can exploit it. Voice assistants may allow access to phone functions and contact data even when the device is locked, potentially exposing confidential information. Furthermore, interfaces such as Wi-Fi or Bluetooth are often configurable while the device is locked. For example, an attacker with physical access could enable Bluetooth, creating an additional attack vector.",
      "impact": "Unauthorized persons with physical access to the device can view confidential information (e.g., message previews, calendar entries, one-time authentication codes) without unlocking it. This can cause privacy violations, data leakage, and follow-on attacks based on the disclosed information. Enabling interfaces like Bluetooth can also expose the device to additional remote attacks.",
      "action": "Implement Secure Notification Handling and User Guidance",
      "mitigation": "Applications should handle notifications securely by default. Use platform APIs to mark notifications that contain sensitive data as private so their content is not shown on the lock screen (e.g., Android `Notification.VISIBILITY_PRIVATE`). Avoid placing sensitive details in notification titles, which may still be visible. In addition, provide clear guidance to users on configuring lock-screen notification settings for maximum privacy. For any voice-assistant integration, require user authentication for sensitive actions or data retrieval.",
      "check": "Are notifications that may contain sensitive data configured to hide their content on the lock screen? Does the application's security documentation advise users on device settings for privacy? Is any voice-assistant integration designed to prevent unauthenticated access to sensitive functions or data?",
      "asvs": "OWASP MASTG: MSTG-PLATFORM-9 (Remove sensitive data from views when the app moves to the background)",
      "cheatSheet": "https://mas.owasp.org/MASTG/tests/android/MASTG-TEST-0045/",
      "detectionLogic": "This risk applies to all in-scope technical assets with technology 'MobileApp' or 'IoTDevice' that process or store data. It assumes these applications may send notifications related to the data they handle. The impact is determined by the highest confidentiality level of the data assets associated with the mobile component.",
      "riskAssessment": "The likelihood is 'Likely' for interactive mobile or IoT applications, as sending notifications is common. The impact depends on the sensitivity of information that could be exposed. If the application handles 'Strictly Confidential' data, the impact is 'High'; for 'Confidential' data, 'Medium'; otherwise 'Low'. Physical access to the device is a prerequisite for exploitation.",
      "falsePositives": "This risk may be a false positive if the application never sends notifications, or if all notifications are generic and contain no sensitive or user-specific content. The risk may also be mitigated at the OS level, but the application should still implement secure defaults.",
      "cwe": "200",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "103_sec8.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "private-use-of-company-mobile-devices",
      "title": "Private Use of Company-Owned Mobile Devices (BSI CON.3)",
      "description": "When employees use company-owned smartphones and tablets for private purposes, multiple information-security risks can arise.",
      "impact": "Allowing private use of company devices without proper controls can lead to data breaches, malware infections, and compliance violations.",
      "action": "Implement controls for the private use of company mobile devices",
      "mitigation": "The most effective mitigation is to implement a Mobile Device Management (MDM) solution.",
      "check": "Is there a policy for the private use of company mobile devices? Is a Mobile Device Management (MDM) or Mobile Application Management (MAM) solution in place?",
      "asvs": "Derived from the BSI IT-Grundschutz Baustein CON.3 'Mobile Device Management'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_Device_Management_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers on technical assets of technology type 'Mobile App' that are explicitly tagged with `private-use-allowed`.",
      "riskAssessment": "The likelihood of exploitation is very high if private use is allowed without any central management or security controls. The presence of an MDM solution reduces the likelihood but does not eliminate it entirely.",
      "falsePositives": "The model might not capture the full extent of security policies enforced by an MDM. A risk might be flagged even if specific compensating controls (such as a very restrictive app allowlist) exist but are not modeled with a tag.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "103_sec9.ts",
      "bsiCode": "SYS.3.2.1",
      "id": "insecure-private-device-usage-con3",
      "title": "BYOD: Insecure Use of Private Mobile Devices (BSI CON.3)",
      "description": "When privately owned mobile devices are used for business (BYOD), organizations face reduced control over platform hardening and lifecycle, increasing the chance of policy violations, insecure configurations, and data leakage. Repairs, resale, or loss of such devices can expose corporate data to unauthorized parties. Licensing issues, accidental corporate data wipes via MDM, and unclear offboarding procedures further amplify risk.",
      "impact": "Compromise of confidentiality and integrity of corporate data (e.g., @DataType:PII), regulatory non-compliance, legal exposure (licensing, privacy), operational disruption, and reputational damage. Loss, theft, or improper device decommissioning may cause irreversible data exposure or loss.",
      "action": "Define, implement, and enforce a comprehensive BYOD policy with technical enforcement (e.g., MDM/EMM).",
      "mitigation": "Publish a formal BYOD policy that mandates minimum device security (OS version/support window, screen lock, full-disk encryption, anti-malware where feasible), clarifies data ownership and user responsibilities, and restricts app sources. Enforce via MDM/EMM with device compliance checks, containerization/work profiles, remote wipe, and certificate-based network access. Establish strict onboarding/offboarding to ensure corporate data is removed upon role changes or departure.",
      "check": "Is there a documented BYOD policy with minimum device baselines? Are private devices enrolled in MDM/EMM and measured for compliance (encryption, lock, OS patch level)? Are data separation and approved app sources enforced? Are offboarding and remote-wipe procedures tested?",
      "asvs": "Reference: BSI IT-Grundschutz Baustein CON.3 (Mobile device concept), esp. CON.3.A5 (Regulations for the use of private mobile devices/BYOD).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_device_concept_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.3)",
      "detectionLogic": "Raised for each in-scope technical asset that (1) is a client technology (e.g., mobile app, browser, desktop) and (2) carries the tag '@device-owner:private'. Impact scales with the asset’s highest confidentiality/integrity classification. Each qualifying asset yields a synthetic risk id '<categoryId>@<assetId>' and points to the device (and its trust boundary) as the affected element.",
      "riskAssessment": "Likelihood is set to Likely for private devices used in business contexts due to common policy gaps and weaker control. Impact scales with data sensitivity: handling restricted/ confidential or mission-critical information increases impact. Breach probability grows with the same factors.",
      "falsePositives": "May be reduced or inapplicable if a robust, enforced BYOD program exists with device compliance checks, containerization, and continuous monitoring that demonstrably meets organizational requirements—even though the model contains a private device.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "104_sec1.ts",
      "bsiCode": "SYS.3.2.2",
      "id": "mdm-synchronization-gap",
      "title": "MDM Synchronization Gap (BSI SYS.3.2.2)",
      "description": "Mobile devices must regularly check in with the MDM to receive policies, enforce them, and allow remote actions (e.g., remote wipe).",
      "impact": "Missing synchronization leaves devices out of compliance and vulnerable. The inability to trigger a remote wipe on a lost or stolen device can cause severe data exposure, harming confidentiality and integrity and potentially causing financial, legal, and reputational damage.",
      "action": "Model and monitor regular MDM synchronization",
      "mitigation": "Configure all managed devices to synchronize with the MDM server on a defined cadence (e.g., at least daily). Monitor check-in status centrally and alert when devices miss that threshold. Define procedures for long-offline devices (temporary access suspension, user notification, escalation). Explicitly model the communication link between mobile clients and the MDM server.",
      "check": "Does every modeled mobile device have a communication link to at least one asset tagged '@System:MDM'? Is a central MDM server modeled and tagged? In practice, is a sync interval/SLA defined and monitored with alerting for missed check-ins?",
      "asvs": "BSI IT-Grundschutz SYS.3.2.2 Mobile Device Management (MDM), especially threat 2.1 'Keine ausreichende Synchronisation mit dem MDM' and requirements A22 (Remote wipe) and A20 (Regular review).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_3_Mobile_Device_Management_MDM_Edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "For each in-scope mobile client (technology 'mobile-app' or tagged '@System:MDM'), check for a direct communication link to at least one technical asset tagged '@System:MDM' (treated as the MDM server). If no such direct link exists, raise this risk because policy synchronization and remote administration are not modeled as possible.",
      "riskAssessment": "Likelihood is high whenever the model lacks an MDM link, since synchronization cannot occur. Impact scales with the maximum confidentiality and integrity of data on the device—devices handling 'Strictly Confidential' data have a very high impact if they cannot be wiped.",
      "falsePositives": "Possible if the MDM server or its connectivity is not modeled (e.g., managed by an external service) or if synchronization is implicit. Ensure all mobile endpoints and the MDM server are modeled and linked explicitly.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "104_sec2.ts",
      "bsiCode": "SYS.3.2.2",
      "id": "misconfiguration-of-@System:MDM",
      "title": "Misconfiguration of Mobile Device Management (MDM)",
      "description": "MDM platforms orchestrate policies, apps, certificates, and device posture across fleets of smartphones and tablets. Their rule sets are large and interdependent; even small mistakes can ripple through thousands of devices. This risk captures misconfigurations that weaken the protection of managed endpoints and the MDM itself.",
      "impact": "A single faulty policy can propagate instantly to many devices, enabling unauthorized access, disabling essential controls (e.g., screen lock, encryption), breaking compliance, or preventing remote wipe. Consequences include data exfiltration, malware spread, service outages, and regulatory penalties with financial and reputational damage.",
      "action": "Harden the MDM, baseline its configuration, and enforce change control with peer review and automated drift detection.",
      "mitigation": "Define a vendor-aligned hardening baseline and apply least privilege. Gate all rule changes via formal change management with dual control. Continuously audit for drift and unsupported OS versions; automate checks where possible. Ensure administrators are trained and use separate, MFA-protected accounts.",
      "check": "Is there a documented, approved hardening baseline for the MDM? Are policy changes peer-reviewed and tracked? Are configurations automatically audited for drift and unsupported OS versions? Are admin roles least-privileged and protected with MFA?",
      "asvs": "V14.2.1 Secure Configuration; V1.14 Configuration Management",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Mobile_App_Security_Testing_Cheat_Sheet.html",
      "detectionLogic": "Triggers for any in-scope technical asset tagged '@System:MDM' (the MDM server/tenant). Managed endpoints are derived from the MDM’s outgoing communication links: every in-scope client-technology asset and any asset explicitly tagged '@System:MDM' are considered managed. Impact is based on the maximum Confidentiality/Integrity/Availability across the MDM and all managed endpoints. Impact tiers elevate to Medium if Confidentiality ≥ Confidential or Integrity/Availability ≥ Critical; to High if Confidentiality ≥ StrictlyConfidential or Integrity/Availability ≥ MissionCritical; and to VeryHigh when more than five endpoints are managed and sensitive/critical levels apply. Data breach probability is Possible if at least one managed endpoint exists; otherwise, Improbable. The risk lists the MDM and all managed endpoints as affected assets.",
      "riskAssessment": "Likelihood: Likely, given the complexity and change frequency of MDM deployments. Impact scales with the most sensitive data and criticality present on managed devices; environments handling Strictly Confidential data or Mission-Critical services drive High to VeryHigh impact, especially with many endpoints.",
      "falsePositives": "Lower risk where the MDM scope is minimal (few devices, non-sensitive data) and there is strong evidence of mature configuration management, automated compliance checks, continuous auditing, and rapid drift detection. Sandbox or read-only pilots may also reduce relevance.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "104_sec3.ts",
      "bsiCode": "SYS.3.2.2",
      "id": "incorrect-mdm-role-assignment-sys-3-2-2",
      "title": "Incorrect Role Assignment in MDM (BSI SYS.3.2.2)",
      "description": "The permission management of a Mobile Device Management (MDM) system controls which users can change settings on mobile devices and who can access which data (see BSI SYS.3.2.2, section 2.3).",
      "impact": "Incorrectly assigned roles in an MDM can lead to unauthorized access to sensitive data, modification of critical device configurations, installation of malicious or unapproved software, data leakage, and violations of legal or regulatory data-protection requirements. Impact scales with the confidentiality, integrity, and availability (CIA) of the managed devices and the data they process.",
      "action": "Implement and enforce a least-privilege, role-based access control (RBAC) model for the MDM, with change approvals and regular reviews.",
      "mitigation": "Design and implement a detailed RBAC model for the MDM based on the principle of least privilege.",
      "check": "Is there a documented, approved RBAC concept for the MDM? Are user-to-role assignments and admin privileges reviewed at least quarterly (A20)?",
      "asvs": "Based on the BSI IT-Grundschutz module SYS.3.2.2 Mobile Device Management (MDM) (especially section 2.3 and requirement A20) and related to ORP.4 Identity and Access Management.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_2_Mobile_Device_Management_MDM_Edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "Raised for any technical asset tagged '@System:MDM'. The rule inspects outgoing communication links from the MDM to assets with the technology 'MobileApp' and aggregates the highest Confidentiality/Integrity/Availability across those devices to scale impact.",
      "riskAssessment": "Likelihood is 'Likely' by default, reflecting the complexity and error-prone nature of role management without mature processes.",
      "falsePositives": "May be flagged even when robust IAM processes exist (e.g., strong segregation of duties, change approvals, periodic recertification, and automated compliance).",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "104_sec4.ts",
      "bsiCode": "SYS.3.2.2",
      "id": "unauthorized-location-tracking-mdm-sys321",
      "title": "Unauthorized Location Tracking and Misuse via MDM (BSI SYS.3.2.2)",
      "description": "Most Mobile Device Management (MDM) products can determine a device's current location and use it for 'geofencing' to grant or deny access to data and applications.",
      "impact": "If sensitive location data and movement profiles are leaked or misused, it can lead to severe privacy violations, compromise the personal safety of individuals, and result in significant legal and financial penalties for the organization due to non-compliance with data protection laws. Illicit surveillance can also damage employee trust and lead to legal disputes.",
      "action": "Implement Strict Controls, Policies, and Transparency for Location Services",
      "mitigation": "Disable location tracking capabilities within the MDM system by default. Only enable them if there is a compelling, documented, and lawful business purpose.",
      "check": "Is location tracking enabled in the MDM system? If so, is there a documented, legitimate business need? Are users explicitly informed and have they provided consent? Are there strict access controls and a formal policy governing the use of this data?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.2.2 Mobile Device Management (MDM)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Mobile_Device_Management_MDM_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any technical asset identified as a Mobile Device Management (MDM) system via the '@System:MDM' tag.",
      "riskAssessment": "The likelihood is considered 'Likely' because location tracking is a standard feature in most MDM products. The impact is rated as 'High' by default due to the sensitivity of personal location data.",
      "falsePositives": "This risk can be considered a false positive if location tracking features are technically disabled and cannot be re-enabled, or if the system is used exclusively for tracking non-personal assets (e.g., logistics vehicles) where privacy regulations for individuals do not apply.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "105_sec1.ts",
      "bsiCode": "SYS.3.2.3",
      "id": "unauthorized-apple-id-access",
      "title": "Unauthorized Access to an Insufficiently Secured Apple ID (BSI SYS.3.2.3)",
      "description": "An Apple ID is the central account for Apple services (iMessage, FaceTime, iCloud, App Store, Find My, etc.). If attackers gain access to a weakly protected Apple ID used for enterprise purposes, they can disrupt services, locate or remotely erase iOS devices, and access iCloud data and backups—including potentially cloning device data to another device.",
      "impact": "A compromise can breach confidentiality (iCloud data, messages, location), undermine integrity (remote wipe or device control), and harm availability (service disruption). Consequences include data exposure, operational impact, financial loss, and reputational damage.",
      "action": "Secure Apple IDs with strong authentication and management controls",
      "mitigation": "Protect any Apple ID used for business with a strong, unique password and mandatory two-factor authentication (2FA). Prefer Managed Apple IDs via Apple Business Manager for organizational control. Tag the relevant asset with '@AppleID-2FA-Enabled' to indicate 2FA is enforced.",
      "check": "Does the asset require an Apple ID? Is 2FA verifiably enabled for that Apple ID (ideally a Managed Apple ID)? Are passwords unique and strong per policy?",
      "asvs": "Derived from BSI IT-Grundschutz and best practices; aligns with OWASP ASVS (Authentication Verification Requirements).",
      "cheatSheet": "https://support.apple.com/en-us/102652",
      "detectionLogic": "Flags every in-scope technical asset tagged '@AppleIDRequired'. If the same asset is tagged '@AppleID-2FA-Enabled', the likelihood is lowered. Impact is derived from the asset’s highest CIA levels and the most sensitive processed or stored data asset is referenced. Out-of-scope assets are ignored.",
      "riskAssessment": "Likelihood: Likely without 2FA; Unlikely with 2FA. Impact: Medium by default; High if the asset handles ≥ Confidential data or has ≥ Critical integrity/availability; Very High if Strictly Confidential data or Mission-Critical integrity/availability. Data breach probability: Improbable with 2FA; Probable when impact ≥ High without 2FA; otherwise Possible.",
      "falsePositives": "May be overreported if the Apple ID is constrained to non-critical, isolated use (e.g., VPP-only app assignment) without access to sensitive data or device management capabilities.",
      "cwe": "306",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "105_sec2.ts",
      "bsiCode": "SYS.3.2.3",
      "id": "elevated-privileges-of-preinstalled-ios-apps",
      "title": "Elevated Privileges of Preinstalled iOS Apps",
      "description": "Apple ships iOS with preinstalled apps (e.g., Mail, Safari) that often run with higher privileges than apps downloaded from the App Store. This increases the device's attack surface, as vulnerabilities in these apps can have a greater impact.",
      "impact": "If a vulnerability in one of these preinstalled, high-privilege apps is exploited, an attacker could gain elevated access to device resources, data, or functions. This could bypass security controls, enable unauthorized data access, or lead to a full device compromise.",
      "action": "Harden device configurations and limit the use of preinstalled apps for sensitive tasks.",
      "mitigation": "Because these privileges are built-in, direct mitigation is limited. However, risk can be reduced by: 1. Keeping iOS and all apps regularly updated to patch known vulnerabilities. 2. Using a Mobile Device Management (MDM) solution to enforce security policies and restrict app functionality. 3. For highly sensitive operations, consider dedicated, hardened third-party apps with a smaller, more auditable feature set instead of default apps like Mail or Safari. 4. Educate users about the risks of opening suspicious links or attachments in these applications.",
      "check": "Are the devices running iOS? Are default, preinstalled apps such as Safari and Mail used to process or access sensitive data? Is an MDM solution in place to manage and restrict these applications? Are devices and apps kept consistently up to date?",
      "asvs": "Not applicable. This is a platform-level risk inherent to the iOS ecosystem. Related concepts are covered in the OWASP Mobile Security Testing Guide (MSTG), particularly around platform interaction and privilege models (MSTG-PLATFORM-1, MSTG-PLATFORM-2).",
      "cheatSheet": "https://developer.apple.com/support/security/",
      "detectionLogic": "This risk triggers for any technical asset representing an iOS-based client device. It checks for assets with client-side technologies (e.g., 'mobile-app', 'mobile-device') that are tagged to indicate the iOS platform (e.g., '@Platform:iOS').",
      "riskAssessment": "The likelihood of exploitation is generally 'Unlikely' for a fully patched device against unknown vulnerabilities but can increase if patches are not applied promptly. The impact is directly related to the sensitivity of the data processed by the device. A compromise of a device handling 'Strictly Confidential' data can have a 'High' or 'Very High' impact.",
      "falsePositives": "This risk may be treated as a false positive or 'Accepted' if the device is used in a completely isolated, low-sensitivity environment where a compromise would have no significant impact, or if an MDM solution severely restricts preinstalled applications to the point that they cannot access sensitive data.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "105_sec3.ts",
      "bsiCode": "SYS.3.2.3",
      "id": "dependency-on-apple-infrastructure",
      "title": "Reliance on Apple Cloud Services for iOS/iPadOS Features (BSI SYS.3.2.3 §2.3)",
      "description": "A broad set of iOS/iPadOS capabilities routes data through Apple-operated infrastructure: iCloud Keychain and backups, iMessage, FaceTime, Siri, Continuity/Handoff, Spotlight Suggestions, document collaboration, and Apple Push Notification service (APNs). Even when used only for notifications, metadata and payloads may traverse Apple infrastructure. This introduces an inherent dependency and exposure outside the organization’s direct control.",
      "impact": "Compromise, lawful access, misconfiguration, or outage within Apple infrastructure can expose or alter sensitive data synchronized or transported by these features. This primarily threatens confidentiality and integrity and can also affect availability if services are disrupted.",
      "action": "Define and enforce a policy for Apple cloud features via MDM; minimize or disable non-essential iCloud/Continuity/Siri usage; keep push payloads non-sensitive; prefer E2EE apps for confidential communications.",
      "mitigation": "Use MDM to: (1) disable or restrict iCloud backups, iCloud Drive, iCloud Keychain, Continuity/Handoff, Siri, Spotlight Suggestions; (2) require anonymous/managed Apple IDs via Apple Business Manager; (3) enforce 2FA for any permitted Apple ID usage; (4) ensure push notifications contain no sensitive content (server-side redaction); (5) mandate end-to-end encrypted communication channels for sensitive exchanges; (6) document when and why any Apple cloud feature is allowed.",
      "check": "Is MDM deployed and enforcing restrictions on iCloud, Siri, Continuity, Spotlight, and APNs payload content? Are Apple Business Manager and managed Apple IDs used? Is 2FA required where Apple IDs are permitted? Is there a documented policy explicitly approving or prohibiting Apple cloud features by data classification?",
      "asvs": "BSI SYS.3.2.3.A14 (Verwendung der iCloud-Infrastruktur), SYS.3.2.3.A15 (Continuity-Funktionen); APP.4.5 (Smartphones/Tablets unter iOS/iPadOS).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_5_Smartphones_and_tablets_under_iOS_iPadOS_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Flags any in-scope client technology asset tagged 'os:ios'. Severity is then scaled by the asset’s highest confidentiality/integrity needs and by the sensitivity of processed/stored data assets. Non-client or out-of-scope assets are ignored.",
      "riskAssessment": "Devices processing data of higher confidentiality or integrity requirements escalate impact from Low → Medium → High → Very High. Likelihood is set to 'Likely' because these features are integrated by default and commonly used unless centrally restricted.",
      "falsePositives": "Low risk if an effective MDM baseline verifiably disables iCloud/Continuity/Siri and notification payloads are sanitized, or if the device handles only public, non-sensitive data (e.g., kiosk/demo devices).",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "106_sec1.ts",
      "bsiCode": "SYS.3.2.4",
      "id": "unlocked-bootloader-on-android-device",
      "title": "Unlocked Bootloader on an Android Device (per BSI guidance)",
      "description": "The boot process of modern mobile devices (such as Android) is secured by a chain of trust, typically anchored by a manufacturer's certificate. This process, often called 'Verified Boot' or 'Secure Boot', ensures that each stage of the startup sequence is cryptographically verified, guaranteeing that the operating system starts in an unmodified and trusted state.",
      "impact": "An unlocked bootloader compromises the fundamental integrity of the device. This can lead to the installation of malware with root privileges, a complete bypass of application-level security controls, and unauthorized access to sensitive data stored on or processed by the device (e.g., credentials, personal information, corporate data). The compromised device could also be used as a pivot point to attack other systems. The confidentiality, integrity, and availability of all assets on the device are at high risk.",
      "action": "Enforce device integrity and implement runtime tamper detection",
      "mitigation": "For corporate-managed devices, ensure they are provisioned with a locked bootloader using a Mobile Device Management (MDM) solution (see BSI CON.8). For applications handling sensitive data, implement robust runtime checks to detect compromised environments. This includes using platform-specific APIs like Android's Play Integrity API (formerly SafetyNet) to verify device integrity. If a compromised environment (unlocked bootloader, root access) is detected, the application should refuse to run, operate with significantly reduced functionality, or terminate the session after securely notifying the user and/or a backend monitoring system.",
      "check": "Are devices required to have a locked bootloader per policy? Does the application incorporate runtime checks to detect a compromised OS environment and react appropriately? Are these detection events logged for security monitoring?",
      "asvs": "OWASP MASVS V8.1: The app is not running on a rooted or jailbroken device.",
      "cheatSheet": "https://mas.owasp.org/MASVS/8-Resilience/#v81-the-app-is-not-running-on-a-rooted-or-jailbroken-device",
      "detectionLogic": "This risk is identified for any in-scope technical asset of technology type 'Mobile App' or 'IoT Device' that is explicitly tagged as having an unlocked bootloader (e.g., using the '@Bootloader:unlocked' tag). The presence of this tag signifies that the core security promise of the device's operating system cannot be trusted.",
      "riskAssessment": "The likelihood of exploitation is very high, as the primary security barrier (Verified Boot) has been removed. The impact is directly related to the sensitivity of the technical asset and the data it processes or stores. An unlocked bootloader on a device handling 'Strictly Confidential' data will result in a critical risk.",
      "falsePositives": "This risk is generally not a false positive if the asset is correctly tagged. A business decision might be made to accept this risk (e.g., for development or testing devices), but the vulnerability and its potential consequences remain and must be formally acknowledged and accepted.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "106_sec2.ts",
      "bsiCode": "SYS.3.2.4",
      "id": "malware-on-android-devices",
      "title": "Malware on Android Devices (Sideloading and Untrusted Stores)",
      "description": "Android’s popularity and openness make it a prime target for mobile malware. Beyond the official Google Play Store, users can also install apps from alternative stores, direct APK downloads, or enterprise distribution channels. Attackers frequently repackage legitimate apps with malicious code and trick users into installing them from untrusted sources. This risk models the exposure of corporate devices and apps running on Android.",
      "impact": "Compromised Android devices can leak credentials and tokens; exfiltrate data at rest and in use; tamper with app logic; pivot into backend APIs; or disable device protections. Such breaches can affect confidentiality (data theft/spyware), integrity (transaction or configuration tampering), and availability (e.g., ransomware or DoS against MDM/EMM policies) across any data the device or app can access.",
      "action": "Adopt and enforce MDM/EMM with strict app controls; block \\",
      "mitigation": "Enforce device management (MDM/EMM) with: 1) Installation restricted to managed Google Play (allowlist only), 2) \\",
      "check": "Are Android devices enrolled in MDM/EMM with allowlisted apps only? Is installation from \\",
      "asvs": "OWASP MASVS v2.0 – V8: Resilience",
      "cheatSheet": "https://mas.owasp.org/MASVS/0x14-V8-Resiliency_Requirements/",
      "detectionLogic": "Triggered for any in-scope technical asset that is a client-type technology (e.g., MobileApp, ClientSystem) AND is explicitly tagged with '@Platform:Android'. Out-of-scope assets and non-client technologies are ignored.",
      "riskAssessment": "Likelihood is set to 'Likely' given widespread social engineering and the ease of sideloading. Impact scales with the asset’s CIA profile: handling confidential or mission-critical data, or powerful tokens, makes impact High to Very High; strictly confidential data and mission-critical connectivity can drive Very High impact.",
      "falsePositives": "May be a false positive if MDM/EMM fully enforces managed Google Play allowlists, blocks unknown sources and Developer mode, and the device runs in a locked-down kiosk/work-profile-only mode with Play Integrity enforced and no sensitive tokens present.",
      "cwe": "506",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "106_sec3.ts",
      "bsiCode": "SYS.3.2.4",
      "id": "outdated-mobile-os",
      "title": "Use of Outdated Mobile Operating System Components (BSI SYS.3.2.1)",
      "description": "Some manufacturers ship smartphones and tablets with outdated versions of their operating system (such as Android) or do not provide regular, or any, updates.",
      "impact": "Exploitation of known vulnerabilities can lead to a complete compromise of the device, resulting in theft of sensitive data (violating Confidentiality), manipulation of device functions or data (violating Integrity), and rendering the device unusable (violating Availability). This can expose all data assets processed or stored on the device.",
      "action": "Implement a Mobile Device Management (MDM) and patch management policy",
      "mitigation": "Ensure that all mobile devices used to access corporate data are managed by an MDM solution. The MDM policy should enforce minimum OS version requirements and automatically apply security patches. Devices that cannot be updated or fall out of compliance should be blocked from accessing enterprise resources. Procure devices from manufacturers with a proven track record of providing timely and long-term security updates.",
      "check": "Is there an MDM solution in place? Does the MDM enforce OS version and patch level policies? Are there logs to verify that devices are being updated regularly? Is there a list of approved devices from reputable manufacturers?",
      "asvs": "BSI IT-Grundschutz: SYS.3.2.1.A5 Regular updates of mobile devices",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Mobile_devices_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "The risk is raised for any technical asset identified as a mobile client (e.g., technology 'mobile-app' or 'iot-device'). The likelihood and impact are increased if the asset handles sensitive data.",
      "riskAssessment": "The likelihood is 'Very Likely' for unmanaged devices, as public exploits for known vulnerabilities are common. The impact is directly related to the CIA requirements of the data assets processed or stored by the mobile device. A device handling 'Strictly Confidential' data poses a 'Very High' impact risk.",
      "falsePositives": "The risk might be considered a false positive if a robust MDM solution is in place that effectively manages and patches the identified device types, even if not explicitly modeled. The model lacks insight into the organization's specific patch management and MDM policies.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "106_sec4.ts",
      "bsiCode": "SYS.3.2.4",
      "id": "compromise-of-central-identity-provider",
      "title": "Compromise of Central Identity Provider (e.g., Google ID)",
      "description": "Many services use a central identity provider, such as a Google ID, for user authentication. This creates a single point of failure. If an attacker gains control over this central identity, they can access all connected services under the stolen identity.",
      "impact": "A compromised central identity can lead to unauthorized access to a wide range of services, including cloud storage, device management, communication platforms, and third-party applications. Attackers could access or steal stored data (files, bookmarks, passwords), impersonate the user, or even remotely locate and wipe devices linked to the account.",
      "action": "Enforce strong authentication for central identities",
      "mitigation": "Ensure that all communication with central identity providers requires strong, multi-factor authentication (MFA/2FA). Model this requirement explicitly on the communication link. Educate users about phishing and credential theft. Regularly review and revoke access for unused or suspicious third-party applications connected to the central identity.",
      "check": "Is communication with the central identity provider protected by multi-factor authentication? Are assets using the identity provider configured to enforce this? Are there monitoring and alerting mechanisms for suspicious login activities?",
      "asvs": "V2 Authentication Verification Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for technical assets that communicate with an external 'Identity Provider'. The risk is raised if the authentication method on the communication link is weaker than 'Two-Factor' (e.g., None, Credentials, Token, or SessionId), indicating that strong authentication is not enforced for this critical dependency.",
      "riskAssessment": "The likelihood of compromise is high if weak authentication methods (like only passwords) are used. The impact is determined by the sensitivity of the technical asset using the identity and the data it processes or stores. Access to an asset managing 'Strictly Confidential' data via a compromised central identity poses a very high risk.",
      "falsePositives": "The model might already reflect that the identity provider enforces MFA on its end, even if the link in the model is not explicitly marked as 'Two-Factor'. However, the risk highlights a modeling gap where the strong-authentication dependency is not explicitly documented.",
      "cwe": "287",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "106_sec5.ts",
      "bsiCode": "SYS.3.2.4",
      "id": "preinstalled-apps-on-android-devices",
      "title": "Non-removable Preinstalled Apps on Android Devices (Bloatware)",
      "description": "Android device manufacturers often ship devices with preinstalled, non-removable applications and integrations with third-party services (e.g., social media or manufacturer utilities).",
      "impact": "The increased attack surface from bloatware increases the risk of malware infection or unauthorized access to confidential information.",
      "action": "Restrict, control, or remove preinstalled applications",
      "mitigation": "Use a Mobile Device Management (MDM) solution to disable or restrict unnecessary preinstalled applications on all corporate devices.",
      "check": "Is there an inventory of preinstalled applications on corporate Android devices? Is a Mobile Device Management (MDM) system in place to control these applications?",
      "asvs": "Derived from BSI SYS.3.2.1 Mobile Device Management (MDM) and OWASP MASVS-PLATFORM-1: 'The app is not vulnerable to any publicly known vulnerabilities in third-party libraries and components.'",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2022/Bausteine/SYS/SYS_3_2_1_MDM_EN.pdf?__blob=publicationFile (BSI SYS.3.2.1)",
      "detectionLogic": "This risk is raised for any technical asset representing a client device (e.g., technologies such as 'Mobile App' or 'Client System') that is specifically tagged as Android (e.g., using a tag like '@Platform:Android').",
      "riskAssessment": "The likelihood is considered 'Likely' by default for standard consumer-grade Android devices due to common manufacturer practices. The likelihood can be reduced if it is confirmed that devices with minimal bloatware are in use or if an effective MDM disables such apps.",
      "falsePositives": "This risk might be a false positive if the device is confirmed to be running a clean, AOSP-based custom ROM without any third-party bloatware, or if an effective and audited MDM configuration is in place that successfully disables all nonessential preinstalled applications.",
      "cwe": "1049",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "107_sec1.ts",
      "bsiCode": "SYS.3.3",
      "id": "unsuitable-mobile-asset-procurement-sys321-g04",
      "title": "Unsuitable Mobile Phone Procurement (BSI SYS.3.3: Inadequate Planning)",
      "description": "If relevant properties of mobile phones are not properly evaluated during planning and procurement, essential functions may be unavailable. This can occur if the device or its operating system lacks support for required standards (e.g., communication protocols, security features) or is unsuitable for the intended operational environment (e.g., specific countries or particular corporate networks).",
      "impact": "The primary impact is a loss of Availability, as the asset may be partially or completely unusable for its intended purpose, disrupting business processes. Furthermore, unforeseen limitations in security features can lead to Confidentiality or Integrity risks if the asset is used despite its shortcomings.",
      "action": "Establish detailed procurement and onboarding requirements for mobile phones.",
      "mitigation": "Define and document clear technical and security requirements for any mobile phone before procurement. This includes required communication standards, supported security functions (e.g., encryption, SIM lock), and operational constraints. Perform a proof-of-concept or pilot phase to validate that the chosen device meets all requirements in the target environment. Maintain an approved list of device models and firmware versions.",
      "check": "Are there documented requirements for mobile phones? Is there a formal evaluation process before a new type of mobile phone is introduced? Is the device's functionality and security posture validated in a test environment before rollout?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.3 (Mobiltelefon), Section 2.1 'Unzureichende Planung bei der Anschaffung von Mobiltelefonen'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/bausteine/sys/SYS_3_3_Mobiltelefon.html",
      "detectionLogic": "This organizational risk is triggered for any in-scope technical asset representing a mobile client (e.g., technology types 'Mobile App' or 'IoT Device'). The risk is that the selection process for this asset was flawed, resulting in a component that is unfit for its purpose.",
      "riskAssessment": "The likelihood is considered 'Likely' as a baseline, reflecting a common organizational weakness in procurement processes. The impact is derived from the Availability and Confidentiality ratings of the mobile phone itself and the data it processes or stores. An unsuitable mission-critical mobile client has a very high impact.",
      "falsePositives": "This risk can be considered a false positive if a thorough and documented evaluation and procurement process for mobile assets exists within the organization, even if this process is not captured in the threat model.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "107_sec2.ts",
      "bsiCode": "SYS.3.3",
      "id": "lost-or-stolen-mobile-device",
      "title": "Lost or Stolen Mobile Device (BSI)",
      "description": "Mobile devices are generally small and constantly transported, making them easy to lose, forget, or steal.",
      "impact": "If a mobile device is lost or stolen, it can lead to a direct breach of confidentiality and integrity for all data stored on it, and a loss of service availability for the user.",
      "action": "Implement Strong Device Security and Remote Management",
      "mitigation": "Enforce strong device-level authentication (passcode or biometric authentication).",
      "check": "Is there a policy requiring strong passcodes on mobile devices? Are all devices encrypted by default?",
      "asvs": "OWASP MASVS V2.0.0: V8.1 - Users are required to set a device-level passcode.",
      "cheatSheet": "https://mas.owasp.org/MASVS/10-v8-resilience_requirements/",
      "detectionLogic": "This risk is triggered for any in-scope technical asset identified as a mobile application client,",
      "riskAssessment": "The likelihood of a mobile device being lost or stolen during its lifecycle is very high.",
      "falsePositives": "This risk might be considered a false positive if the asset model represents a backend service for a mobile app rather than the client application running on the physical device. The risk only applies to assets on a portable physical device.",
      "cwe": "311 // CWE-311: Missing Encryption of Sensitive Data",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "107_sec3.ts",
      "bsiCode": "SYS.3.3",
      "id": "careless-mobile-usage",
      "title": "Information Disclosure Through Careless Mobile Usage",
      "description": "Careless or negligent use of mobile devices by employees can allow third parties to access sensitive information.",
      "impact": "If sensitive information is compromised due to careless handling of mobile devices, it can lead to a breach of confidentiality.",
      "action": "Implement user awareness training and promote secure usage habits for mobile devices",
      "mitigation": "Establish a security policy for mobile device usage that advises employees on secure practices.",
      "check": "Are users trained on the risks of using mobile devices in public? Are there policies regarding the discussion of sensitive information on mobile phones? Are privacy screens available and used for company devices?",
      "asvs": "BSI IT-Grundschutz SYS.3.2.1.A6 (Unauthorised eavesdropping on mobile phones)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/sys/SYS_3_2_1_Mobile_phone_en.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is relevant for all human-operated mobile clients (e.g., mobile apps, handheld IoT devices) that process or transmit data with any level of confidentiality.",
      "riskAssessment": "The likelihood is considered high due to the commonality of mobile device usage in public areas.",
      "falsePositives": "This risk can be considered a false positive if the mobile device is exclusively operated within a physically secure and controlled environment (e.g., a handheld scanner used only inside a secure warehouse with no external visitors).",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "107_sec4.ts",
      "bsiCode": "SYS.3.3",
      "id": "unauthorized-private-use-of-mobile-devices",
      "title": "Unauthorized Private Use of Company Mobile Devices",
      "description": "Company-owned mobile devices may be used for private purposes without authorization.",
      "impact": "If company mobile devices are used for private purposes, this can lead to a breach of confidentiality of internal data.",
      "action": "Implement and Enforce a Mobile Device Management (MDM) Policy",
      "mitigation": "Enforce a clear policy regarding the private use of company devices.",
      "check": "Is there a documented policy for mobile device usage? Is a Mobile Device Management (MDM) solution in place and configured to separate business and private data?",
      "asvs": "BSI IT-Grundschutz SYS.3.2.2 Mobile Device Management (MDM), specifically referencing requirement SYS.3.2.2.A4 'Separation of private and business data'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_2_Mobile_Device_Management_MDM_edition_2022.html",
      "detectionLogic": "This risk is raised for any in-scope technical assets that are human-operated clients (especially mobile apps or devices) that are not explicitly marked as being managed by an MDM solution.",
      "riskAssessment": "The likelihood of private use is considered 'likely' for unmanaged mobile devices provided to employees.",
      "falsePositives": "This risk can be a false positive if an effective MDM solution is in place but the corresponding technical asset in the model has not been tagged with `@System:MDM`.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "107_sec5.ts",
      "bsiCode": "SYS.3.3",
      "id": "mobile-phone-unavailability",
      "title": "Mobile Phone Unavailability (BSI-based)",
      "description": "The unavailability of a mobile phone can have several causes. Users may have neglected to charge the device's battery, or the battery may have lost its ability to store energy. Users may also forget the device password or PIN and be unable to use the device, as it can lock after multiple incorrect code entries. If the phone is not handled carefully, it can be damaged—for example, by being dropped.",
      "impact": "In all these cases, the user is not reachable and, in turn, cannot reach others via the mobile phone. This results in a denial of service for all business processes and data assets that depend on the availability of the mobile device.",
      "action": "Ensure Mobile Device Availability",
      "mitigation": "To mitigate these risks, users should be trained on proper device care, including regular charging. Organizations should consider providing @Backup:Target power sources (e.g., power banks) for critical roles. The use of protective cases can reduce the risk of physical damage. Clear, efficient procedures must be in place for resetting forgotten PINs or passwords to regain access without prolonged downtime. For mission-critical scenarios, consider providing redundant @Backup:Target devices.",
      "check": "Do users receive guidance and training on mobile device maintenance? Are @Backup:Target power options or redundant devices available for critical users? Is there an efficient, documented process for handling locked devices or forgotten credentials?",
      "asvs": "This risk aligns with the general IT security principle of ensuring availability. It is not tied to a specific ASVS requirement but reflects a fundamental operational threat.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
      "detectionLogic": "This risk applies to all in-scope technical assets with the technology type 'Mobile App' or 'IoT Device', as these often represent mobile phones or other single-user-dependent devices.",
      "riskAssessment": "The likelihood is generally considered 'Likely' due to the high probability of human error (forgetting to charge), hardware degradation (battery aging), or accidents (physical damage). The impact is derived from the availability requirement of the mobile device itself and the data it handles. A mission-critical device failure has a very high impact.",
      "falsePositives": "This risk can be considered a false positive if the model represents a non-critical device or if robust, unmodeled redundancy measures (such as a second company phone per employee) are in place.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "107_sec6.ts",
      "bsiCode": "SYS.3.3",
      "id": "eavesdropping-and-location-tracking-of-mobile-communication",
      "title": "Eavesdropping and Location Tracking of Mobile Communication",
      "description": "By design, mobile communication signals can be intercepted and recorded by attackers with sufficient resources.",
      "impact": "If mobile communication is not properly secured, the confidentiality and integrity of transmitted data can be compromised.",
      "action": "Enforce strong encryption for all mobile communications",
      "mitigation": "All data transmitted from mobile devices must be protected with strong, up-to-date encryption protocols (e.g., HTTPS, WSS, or a VPN tunnel).",
      "check": "Do all communication links originating from mobile clients use encrypted protocols? Is a VPN enforced for mobile access? Are sensitive credentials or data transmitted?",
      "asvs": "BSI IT-Grundschutz: SYS.3.2.2.A11 (Protection of communications for smartphones), NET.3.2.A4 (WLAN encryption).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_2_Smartphones_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This rule is triggered for all communication links originating from technical assets identified as mobile clients (e.g., technologies 'mobile-app' or 'iot-device') that use an unencrypted network protocol.",
      "riskAssessment": "The likelihood of interception is high for unencrypted wireless traffic. The impact depends on the confidentiality and integrity requirements of the transmitted data.",
      "falsePositives": "The risk may be flagged for communication within a physically secured, private wireless network (e.g., a dedicated on-premises Wi-Fi for warehouse scanners) where the eavesdropping risk is considered low.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "107_sec7.ts",
      "bsiCode": "SYS.3.3",
      "id": "covert-eavesdropping-via-mobile-device",
      "title": "Covert Eavesdropping via Mobile Devices",
      "description": "Mobile devices, such as smartphones, can be used to covertly record or transmit conversations without notice. During sensitive meetings or in secure areas, a compromised or maliciously used mobile device can establish a connection to an unauthorized third party, effectively bugging the room. Features like the speakerphone can capture audio from the entire vicinity, and it is often difficult to visually determine if a device is actively recording or transmitting.",
      "impact": "If confidential conversations (e.g., about business strategy, trade secrets, personal data, or system architecture) are eavesdropped upon, it leads to a severe breach of confidentiality. This can result in significant financial loss, reputational damage, loss of competitive advantage, and potential legal or regulatory penalties.",
      "action": "Establish and Enforce a 'Clean Room' Policy for Sensitive Areas",
      "mitigation": "For meetings or work areas where highly sensitive information is discussed, enforce a strict policy prohibiting personal or untrusted mobile devices. Consider providing secure lockers for device storage. Alternatively, use technical countermeasures like RF jammers or detectors (where legally permissible) or hold discussions in specially secured rooms (SCIFs). Raise awareness among all personnel about this specific threat.",
      "check": "Is there a policy regarding mobile devices in sensitive meeting areas? Are employees aware of this policy and the risks of eavesdropping? Are there physical controls in place to enforce the policy?",
      "asvs": "Derived from BSI IT-Grundschutz principles, particularly related to CON.3 (Physical and Environmental Security). This threat highlights risks that bridge the gap between cyber and physical security domains.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Physical_and_environmental_security_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered by the presence of technical assets like mobile apps or IoT devices within a trust boundary that also contains other assets processing or storing confidential data. The model proxy for a 'sensitive meeting room' is a trust boundary containing both the listening device and the source of sensitive information.",
      "riskAssessment": "The likelihood is considered 'Likely' due to the ubiquity of mobile phones. The impact is directly proportional to the maximum confidentiality of data handled by other assets within the same trust boundary. If meetings in the scope of the model discuss 'Strictly Confidential' data, the impact is 'Very High'.",
      "falsePositives": "The model may not accurately represent physical locations. A 'mobile-app' asset might be part of the system but never physically brought into sensitive areas. This risk requires contextual knowledge of physical security procedures, which cannot be fully captured in a data-flow diagram.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "107_sec8.ts",
      "bsiCode": "SYS.3.3",
      "id": "outdated-mobile-devices-bsi",
      "title": "Use of Outdated Mobile Devices (BSI)",
      "description": "The use of outdated mobile phones (n@SystemType:OT modern smartphones) poses a significant risk. These devices often run on unsupported operating systems, meaning security vulnerabilities are no longer patched.",
      "impact": "Exploitation of unpatched vulnerabilities can lead to the compromise of any data stored on or transmitted by the device, impacting its confidentiality and integrity.",
      "action": "Phase Out Unsupported Mobile Devices",
      "mitigation": "Establish and enforce a policy that prohibits the use of unsupported mobile devices for business purposes. Maintain an inventory of all mobile devices and their OS versions to track support lifecycles.",
      "check": "Is there an inventory of all mobile devices used in the organization? Are all devices and their operating systems actively supported by the manufacturer with security updates?",
      "asvs": "V14.2.5: Verify that all components are patched and up-to-date.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/sys/SYS_3_2_1_Allgemeine_Aspekte_bei_mobilen_Endgeraeten_Edition_2023.html",
      "detectionLogic": "This risk is triggered for any technical asset explicitly identified as an outdated mobile device using the '@legacy-mobile-device' tag.",
      "riskAssessment": "The likelihood of exploitation is considered very high for a device with known, unpatched vulnerabilities connected to any network.",
      "falsePositives": "A false positive may occur if the tagged device is used in a completely isolated, offline environment where software vulnerabilities cann@SystemType:OT be remotely exploited, and its potential for hardware failure is an accepted operational risk.",
      "cwe": "937",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "108_sec1.ts",
      "bsiCode": "SYS.4.1",
      "id": "unattended-printouts-at-@AssetType:Printer",
      "title": "Unattended Output at @AssetType:Printer — Sichere Ausgabe (BSI CON.3.A21)",
      "description": "Printed documents, faxes, and transmission reports are frequently left unattended in output trays of central, departmental, or home-office printers and multifunction devices.",
      "impact": "Unattended sensitive printouts can breach confidentiality and expose personal or business secrets.",
      "action": "Enforce secure/pull printing, prompt pickup, and controlled shredding or disposal.",
      "mitigation": "Introduce pull-printing requiring user authentication at the @AssetType:Printer.",
      "check": "Is pull-printing enforced with user authentication? Are printers in controlled areas?",
      "asvs": "BSI IT-Grundschutz CON.3.A21 Sichere Ausgabe auf Druckern (Secure output on printers).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Datentraeger-_und_Daten-Handling.pdf?__blob=publicationFile (BSI CON.3)",
      "detectionLogic": "Trigger for any technical asset tagged '@AssetType:@AssetType:Printer'. For each incoming communication link:",
      "riskAssessment": "Impact derives from the most sensitive property of data sent to the @AssetType:Printer.",
      "falsePositives": "May flag a @AssetType:Printer in a strictly controlled, single-occupant room with enforced pull-printing and monitored disposal.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "108_sec2.ts",
      "bsiCode": "SYS.4.1",
      "id": "data-leakage-from-print-@AssetType:Fax-jobs",
      "title": "Confidential data leakage from print and @AssetType:Fax jobs and output (based on BSI threat G 0.15)",
      "description": "Printers, @AssetType:Fax machines, and multifunction devices (MFDs) often handle sensitive information and metadata, creating multiple pathways for data leakage.",
      "impact": "The exposure of print and @AssetType:Fax metadata and tracking information can lead to severe breaches of confidentiality and privacy. It allows unauthorized parties to gain insights into sensitive business operations, personal data, and internal documents. This can result in non-compliance with data protection regulations when handling @DataType:PII, reputational damage, and the compromise of trade secrets.",
      "action": "Implement secure printing/faxing policies and device hardening",
      "mitigation": "Deploy a secure printing solution that requires user authentication at the device before a job is released (pull printing). Configure printers and print servers to anonymize or suppress print job metadata in queues. Harden devices by disabling unnecessary services, securing the administrative web interface, and restricting access to control panels and logs. Evaluate devices for tracking features such as 'Yellow Dots' and disable them where possible. Ensure @AssetType:Fax logs are access-controlled and regularly purged.",
      "check": "Is pull printing implemented for sensitive data? Are print queues on servers and devices configured to hide sensitive metadata? Are device web interfaces and control panels secured? Are @AssetType:Fax logs protected against unauthorized access? Has the use of tracking watermarks by printers been assessed?",
      "asvs": "BSI IT-Grundschutz, Threat G 0.15 'Offenlegung schützenswerter Informationen durch Peripheriegeräte' (Disclosure of sensitive information by peripheral devices)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/Gefaehrdungen/G_Gefaehrdungen_Edition_2023.pdf?__blob=publicationFile (Search for 'G 0.15')",
      "detectionLogic": "This rule triggers on technical assets tagged as `@AssetType:Printer` or `@AssetType:Fax`. It identifies risks from (1) sensitive data being sent to these devices, indicating metadata leakage, (2) the inherent risk of physical document tracking ('Yellow Dots') for any @AssetType:Printer, and (3) the risk of exposed @AssetType:Fax logs for any device with @AssetType:Fax capabilities.",
      "riskAssessment": "The impact is determined by the confidentiality of the data being processed by the device. The likelihood of metadata leakage is considered high for standard print jobs, as many devices are insecure by default. The likelihood for exploiting 'Yellow Dots' is lower as it requires specific knowledge and tools, but the impact can be high. Exposed @AssetType:Fax logs are a likely risk on unhardened MFDs.",
      "falsePositives": "The risk might be mitigated by organizational policies or specific device configurations not captured in the model. For example, a device might be physically secured in a locked room, or a secure pull-printing solution might be in place that is not modeled explicitly. Verification requires checking the actual device and print server configurations.",
      "cwe": "200 // CWE-200: Exposure of Sensitive Information to an UnauthorizedActor",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "108_sec3.ts",
      "bsiCode": "SYS.4.1",
      "id": "unprotected-data-on-mfd-storage",
      "title": "Unprotected data on @AssetType:Printer/MFD storage",
      "description": "Printers, copiers, and multifunction devices (MFDs) are often equipped with non-volatile storage",
      "impact": "Unauthorized access to sensitive data stored on the device results in a breach of confidentiality.",
      "action": "Harden MFD configuration and implement secure decommissioning",
      "mitigation": "Enable built-in storage encryption on the MFD. Configure the device to use secure data overwriting/wiping for deleted jobs.",
      "check": "Is storage encryption enabled on all MFDs? Are secure deletion methods configured and active?",
      "asvs": "BSI IT-Grundschutz SYS.4.1 Printers, Copiers, and Multifunction Devices",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_General_printers_and_copiers_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "Triggers for technical assets identified as multifunction devices (MFDs) via the '@AssetType:Printer' tag.",
      "riskAssessment": "The impact is determined by the highest confidentiality and integrity rating of the data assets",
      "falsePositives": "This risk might be a false positive if the identified asset, despite the tag, has no persistent storage, or if compensating controls",
      "cwe": "212",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "108_sec4.ts",
      "bsiCode": "SYS.4.1",
      "id": "unencrypted-printing-scanning-data",
      "title": "Unencrypted Transmission of Printing, Scanning, and Administrative Data",
      "description": "Print and scan data are often transmitted without encryption over the network. This allows sent documents to be intercepted and read.",
      "impact": "Interception of unencrypted print or scan data leads to a breach of confidentiality. If administrative interfaces are also unencrypted,",
      "action": "Enforce Encrypted Communication Channels",
      "mitigation": "Use encrypted protocols for all printing, scanning, and administrative traffic (e.g., use IPPS instead of LPR/IPP, HTTPS instead of HTTP, SSH instead of Telnet).",
      "check": "Review all communication links to and from assets handling printing, scanning, or document management. Verify that all protocols used for data transmission and administration are encrypted.",
      "asvs": "Derived from BSI IT-Grundschutz principles. Aligns with OWASP Proactive Controls C8 (Protect Data Everywhere) and ASVS V4.1 (Communication Security Requirements).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This risk is identified by finding communication links that use unencrypted protocols and target technical assets likely to handle printing,",
      "riskAssessment": "The exploitation likelihood is considered higher for traffic crossing trust boundaries. The impact is determined by the confidentiality of the data assets being transferred.",
      "falsePositives": "This risk might be a false positive if the unencrypted communication occurs exclusively within a physically secured, isolated network segment (e.g., a dedicated printer VLAN) where network interception is not considered a credible threat. Such scenarios should be explicitly documented and accepted.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "108_sec5.ts",
      "bsiCode": "SYS.4.1",
      "id": "insecure-multifunction-device-handling-sys-3-2-1",
      "title": "Insecure Handling of Printers, Copiers, and Multifunction Devices (BSI SYS.4.1)",
      "description": "Many multifunction devices (MFDs) can send digitized documents via email and fax. Without specific security measures,",
      "impact": "Misconfigured MFDs can lead to severe data breaches (loss of confidentiality), enable spoofing attacks that damage trust and facilitate fraud (loss of integrity),",
      "action": "Secure Configuration and Usage Policies for Multifunction Devices",
      "mitigation": "Implement strict configuration management for all MFDs. Disable unnecessary functions like printing from the internet via email.",
      "check": "Are MFD configurations hardened and regularly audited? Is printing from the internet disabled? Are email/fax destinations restricted?",
      "asvs": "BSI IT-Grundschutz SYS.3.2.1: Printers, Copiers, and Multifunction Devices",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Printers_copiers_and_multifunction_devices_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset identified as a multifunction device. This can be done by assigning the asset the 'IoT device' technology type",
      "riskAssessment": "The likelihood is considered 'Likely' because MFDs are frequently deployed with default, insecure configurations.",
      "falsePositives": "A device might be correctly identified as an MFD but may have already been hardened and secured according to policy.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "108_sec6.ts",
      "bsiCode": "SYS.4.1",
      "id": "uncontrolled-mfd-storage-interfaces-con3",
      "title": "Uncontrolled Use of MFD Storage Interfaces (BSI CON.3)",
      "description": "Multi-Function Devices (MFDs) often have physical interfaces like USB or SD card slots.",
      "impact": "The uncontrolled use of MFD interfaces can lead to severe breaches of confidentiality (theft of sensitive documents) and integrity (introduction of malware).",
      "action": "Implement Physical and Logical Controls for MFD/Peripheral Interfaces",
      "mitigation": "Physically or logically disable all unused ports (USB, SD card slots) on MFDs and similar peripheral devices.",
      "check": "Are unused physical ports on MFDs disabled? Is user authentication required to use storage interfaces? Are MFDs located on a dedicated, restricted network segment? Is firmware updated regularly?",
      "asvs": "BSI IT-Grundschutz CON.3 Peripheriegeräte (Peripheral Devices). Addresses threats like G 0.22 (Misuse of devices), G 0.29 (Eavesdropping), and G 0.40 (Introduction of malware).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Peripheriegeraete_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Identifies networked IoT devices, which often represent Multi-Function Devices (MFDs) in a model. The risk is that their physical interfaces (like USB/SD ports) can be used to exfiltrate data (e.g., scanning confidential documents to a USB drive) or introduce malware into the connected network.",
      "riskAssessment": "The likelihood is considered high if the device is in a physically accessible area and connected to the network. The impact is determined by the highest confidentiality and integrity of the data handled by the MFD itself or any IT systems it is directly connected to, as the MFD can act as an uncontrolled bridge to the network.",
      "falsePositives": "The rule may flag any networked IoT device. The actual risk depends on physical security and device configuration, which may not be fully captured in the model. Verification of physical and logical controls on the device is required.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "108_sec7.ts",
      "bsiCode": "SYS.4.1",
      "id": "uncontrolled-internet-access-for-peripherals",
      "title": "Uncontrolled Internet Access for Peripheral or Less-Secure Devices in a Shared Network Segment",
      "description": "Peripheral devices (like printers, copiers, IoT devices) or other less-secure systems are often placed in the same network segment as more critical assets like clients and servers.",
      "impact": "A compromised device with internet access can be used as a gateway for attacks. Attackers could use it to exfiltrate sensitive data from other systems on the same network segment, violating Confidentiality.",
      "action": "Implement Strict Network Segmentation and Egress Filtering",
      "mitigation": "Place all peripheral devices (printers, IoT devices, etc.) and other non-critical systems into a separate, isolated network segment (e.g., a dedicated VLAN).",
      "check": "Are peripheral devices like printers and IoT devices located in a different network segment than standard clients and servers?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium threats related to network design and firewalls, such as in Bausteine NET.1.1 (Network architecture and design) and NET.3.2 (Firewall). The described scenario is a classic example of insufficient network segmentation.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_1_Network_architecture_and_design_edition_2023.pdf?__blob=publicationFile (BSI NET.1.1)",
      "detectionLogic": "This rule identifies peripheral or less-secure technical assets (like IoT devices, clients) that have internet access and reside in the same network trust boundary as other assets processing or storing sensitive data.",
      "riskAssessment": "The likelihood is considered high if a typically insecure device has internet access within a mixed-trust network.",
      "falsePositives": "The model might not capture micro-segmentation or host-based firewall rules that could mitigate this risk in reality, even if assets appear in the same network boundary.",
      "cwe": "552",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "108_sec8.ts",
      "bsiCode": "SYS.4.1",
      "id": "insecure-@AssetType:Printer-credential-management",
      "title": "Insecure Credential Management for Networked Printers/MFDs (BSI INF.4)",
      "description": "Networked printers, copiers, and multifunction devices (MFDs) are often delivered with no password or a default password for their management interfaces (e.g., a built-in web server).",
      "impact": "Unauthorized access to a @AssetType:Printer's management interface can lead to configuration changes, interception of print jobs (compromising confidentiality), modification of stored jobs (compromising integrity), and denial of service.",
      "action": "Enforce Strong and Unique Credentials for All Devices",
      "mitigation": "Ensure that every networked @AssetType:Printer and MFD has a strong, unique administrator password. Change default passwords immediately upon deployment.",
      "check": "Are there any communication links for administrative access to @AssetType:Printer/MFD assets that have authentication set to 'none'? Are default passwords changed on all devices during setup?",
      "asvs": "BSI IT-Grundschutz INF.4.A5 (Absicherung der Administrationsoberfläche)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_4_Drucker_Kopierer_und_Multifunktionsgeraete.html",
      "detectionLogic": "This rule checks for technical assets tagged as printers. It then inspects all incoming communication links.",
      "riskAssessment": "The impact is determined by the highest confidentiality of data processed or stored by the @AssetType:Printer. A lack of authentication presents a 'likely' exploitation scenario for internal attackers.",
      "falsePositives": "The model might not distinguish between a print-job submission protocol (which might not require authentication) and a management protocol. The risk should be validated to ensure the unauthenticated link is indeed for administrative purposes.",
      "cwe": "521",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "109_sec1.ts",
      "bsiCode": "SYS.4.3",
      "id": "neglected-security-in-embedded-development",
      "title": "Neglected Security in Embedded System Development",
      "description": "For cost reasons, information security often plays a less important role in the development of embedded systems than, for example, performance or reliability.",
      "impact": "If security requirements are neglected during development, resulting vulnerabilities in embedded systems can be exploited by attackers to tamper with device functionality,",
      "action": "Integrate Security into the Development Lifecycle for Embedded Systems",
      "mitigation": "A secure development lifecycle (SDL) must be implemented and enforced for all custom-developed embedded components. This includes performing threat modeling early in the design phase,",
      "check": "Is there a formal, enforced secure development lifecycle for embedded components? Are threat models created and maintained? Are security tests, including penetration tests, part of the release cycle?",
      "asvs": "V1: Architecture, Design and Threat Modeling Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/IoT_Security_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for custom-developed technical assets representing embedded systems (e.g., embedded devices, libraries) that are part of the model.",
      "riskAssessment": "The likelihood of vulnerabilities is considered high for custom-developed embedded components due to market pressures (time-to-market, cost) often overriding security concerns.",
      "falsePositives": "This risk can be a false positive if a robust secure development lifecycle is followed for the component, but the corresponding `Mitigation:SecureSDLC:Embedded` tag has not been applied to the asset in the model.",
      "cwe": "284",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "109_sec2.ts",
      "bsiCode": "SYS.4.3",
      "id": "unprotected-embedded-system-interfaces",
      "title": "Unprotected Interfaces on Embedded Systems (BSI SYS.4.3)",
      "description": "The interfaces of embedded systems are potential attack vectors. This applies to interfaces at all layers of the OSI model and across all transmission media.",
      "impact": "Successful exploitation of unprotected interfaces can lead to unauthorized system intrusion, manipulation of safety-critical processes, theft of sensitive data, and system outages (denial-of-service).",
      "action": "Secure and control access to embedded system interfaces",
      "mitigation": "Implement robust physical security for the device (e.g., locked enclosures, tamper-evident seals) to prevent unauthorized physical access.",
      "check": "Are embedded systems physically secured against tampering? Are all network interfaces and APIs protected with strong authentication? Are all communication channels encrypted?",
      "asvs": "BSI IT-Grundschutz, SYS.4.3: Eingebettete Systeme (Embedded Systems)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_Allgemeine_Embedded_Systeme_Edition_2023.html",
      "detectionLogic": "This rule triggers for all technical assets of the type 'IoT device' ('iot-device').",
      "riskAssessment": "The likelihood of exploitation is significantly increased if the device is physically accessible to potential attackers or exposed to untrusted networks (such as the internet).",
      "falsePositives": "The risk may be a false positive if robust physical security measures or compensating network controls (like a separate firewall) are in place but are not explicitly modeled.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "109_sec3.ts",
      "bsiCode": "SYS.4.3",
      "id": "physical-access-to-embedded-systems",
      "title": "Physical Access to Embedded Systems (OT Devices)",
      "description": "If embedded systems (like OT devices) are physically accessible, attackers can destroy, damage, or access their electronic components (e.g., IC pins, ports).",
      "impact": "Successful physical attacks can lead to a complete compromise of the Confidentiality, Integrity, and Availability of information stored on and processed by the embedded system.",
      "action": "Implement Physical Protection Measures for Embedded Systems",
      "mitigation": "Physically secure embedded systems based on their deployment environment. Use tamper-resistant or tamper-evident enclosures.",
      "check": "Is the device located in a physically secure environment? Does it have a tamper-resistant/evident casing? Are unused physical debug ports disabled in production firmware? Is data at rest encrypted? Does the device use a secure boot process?",
      "asvs": "BSI IT-Grundschutz SYS.3.2.1.A5: Protection against unauthorised physical access (Schutz vor unbefugtem physischem Zugriff)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Embedded_systems_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers for technical assets of type 'IoT Device'. The risk is considered present if the device is not located within a trust boundary that implies physical security (like 'Network On-Prem' or 'Network Dedicated Hoster'), or if it has no trust boundary assigned at all.",
      "riskAssessment": "The likelihood is considered 'Likely' for any physically exposed IoT device, and 'Very Likely' if it is also connected to the internet, increasing its exposure. The impact is determined by the highest Confidentiality, Integrity, and Availability ratings of the device and the data it handles. A device controlling critical operations or storing strictly confidential data will have a 'High' or 'Very High' impact.",
      "falsePositives": "A device might be located in a physically secure location (e.g., a locked cabinet in a public area) that is not modeled as a specific trust boundary. The risk must be evaluated based on the actual physical deployment context, which might not be fully captured in the model.",
      "cwe": "1260",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "109_sec4.ts",
      "bsiCode": "SYS.4.3",
      "id": "environmental-failure-of-embedded-systems",
      "title": "Environmental Influences Causing Failures in Embedded Systems",
      "description": "Environmental factors such as electromagnetic interference, temperature fluctuations, unstable power supplies, dust, sand, or dirt can cause embedded systems (like IoT devices) to fail.",
      "impact": "A failure of an embedded system primarily impacts its Availability. If the device controls or monitors physical processes or provides data to other critical systems,",
      "action": "Implement Physical and Environmental Protection for Embedded Systems",
      "mitigation": "Ensure that embedded systems, especially IoT devices, are suitable for their deployment environment. Use hardware with an appropriate IP rating for protection against dust and moisture.",
      "check": "Are embedded systems and IoT devices deployed in environments for which they are certified (e.g., temperature range, IP rating)?",
      "asvs": "This risk is related to physical and environmental protection, which is covered in standards like IEC 60529 (IP Code) and is a foundational aspect of physical security in frameworks like ISO 27001 (Annex A.11) or BSI IT-Grundschutz (INF modules). It falls outside the scope of the OWASP Application Security Verification Standard (ASVS), which focuses on software.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_and_cabinet_security_edition_2023.pdf?__blob=publicationFile&v=2 (Related BSI Topic: INF.5 Room and cabinet security)",
      "detectionLogic": "This risk is triggered for all technical assets of type 'IoT Device', as they are, by definition, embedded systems often deployed outside controlled data center environments.",
      "riskAssessment": "The likelihood of failure is considered higher in harsh or uncontrolled environments. The impact is determined by the Availability requirement (criticality) of the device itself and, more importantly, of any other assets that communicate with it and depend on its function. The lack of redundancy significantly increases the impact of a single device failure.",
      "falsePositives": "This risk might be rated too high for an IoT device that is deployed within a physically secure, climate-controlled environment (e.g., a server room). In such cases, the asset should be tagged with `@environment:controlled` to suppress this risk.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "109_sec5.ts",
      "bsiCode": "SYS.4.3",
      "id": "manipulated-firmware-update-on-embedded-systems",
      "title": "Manipulated Firmware Update on Embedded Systems",
      "description": "Many embedded systems store their software on persistent storage (such as Flash or EEPROMs) and provide a mechanism to update this firmware, either via a physical data interface or a network connection. Attackers can abuse this mechanism to install manipulated software updates, thereby modifying the system's function. As a result, the system's intended tasks can be interrupted or tampered with.",
      "impact": "If an attacker successfully installs malicious firmware, they can gain full control over the embedded system. This can lead to a severe loss of integrity (manipulating system behavior and data) and availability (disrupting or disabling system functions). This could compromise business processes, facilitate further attacks, and cause physical or operational damage.",
      "action": "Implement Secure Firmware Update Mechanism",
      "mitigation": "The firmware/software update process must be secured. All firmware updates should be digitally signed, and the embedded system must verify this signature before applying the update. Access to the update interface (both physical and network-based) should be strictly controlled and authenticated. Employing a secure boot process helps establish a hardware root of trust, ensuring that only trusted code is executed from the initial boot sequence.",
      "check": "Is all firmware/software for the embedded system cryptographically signed? Does the device verify the signature before installation? Is access to the update mechanism (e.g., network port, JTAG/serial interface) authenticated and access-controlled? Is a secure boot mechanism in place?",
      "asvs": "V14.2.5: Verify the integrity of application components, including frameworks, libraries, and dependencies during development, and before deployment or use.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Firmware_Security_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for technical assets representing embedded systems (e.g., IoT devices) that could have an updatable firmware. The risk is mitigated if the asset is tagged with `@Mitigation:firmware-update-secured`. The likelihood is considered higher for devices that are internet-facing or have network-based communication links, as these present remote attack vectors.",
      "riskAssessment": "The exploitation impact is determined by the integrity and availability requirements of the embedded system. A system controlling critical physical processes will have a very high impact. The likelihood is higher for remotely accessible systems (via network) compared to those requiring physical access for updates. Without signed firmware, a successful attack is significantly more likely.",
      "falsePositives": "The risk may be a false positive if the embedded system has no field-update mechanism at all, or if the update mechanism is already secured through measures not captured in the model (e.g., a physically separate, air-gapped update environment).",
      "cwe": "494",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "109_sec6.ts",
      "bsiCode": "SYS.4.3",
      "id": "side-channel-attack",
      "title": "Side-Channel Attack on Cryptographic Implementation",
      "description": "Attackers could break encryption or digital signatures by exploiting observable properties of the physical implementation of a cryptosystem.",
      "impact": "A successful side-channel attack can lead to the complete compromise of cryptographic keys. This would allow an attacker to decrypt sensitive data (violating Confidentiality) and forge digital signatures (violating Integrity and leading to Repudiation issues). The impact is directly related to the value of the data protected by the compromised cryptosystem.",
      "action": "Use Hardened Cryptographic Implementations and Hardware",
      "mitigation": "Prefer using certified hardware security modules (HSMs) for all critical cryptographic operations. For software implementations, use cryptographic libraries that have been vetted and are known to implement constant-time algorithms to resist timing attacks.",
      "check": "Are cryptographic operations performed on certified hardware (e.g., FIPS 140-2/3 validated HSMs)? Are constant-time cryptographic libraries used in custom-developed code? For virtual environments, what cross-tenant side-channel protections are in place?",
      "asvs": "V6.2.5: Verify that cryptographic algorithms are implemented correctly and used according to their specification, including avoiding known insecure options.",
      "cheatSheet": "https://cwe.mitre.org/data/definitions/208.html",
      "detectionLogic": "This risk is raised for technical assets that perform cryptographic operations, especially those running on physical, virtual, or containerized machines where side-channels could be observed. The likelihood is increased for assets with custom-developed parts and decreased for dedicated hardware like HSMs.",
      "riskAssessment": "The impact is determined by the Confidentiality and Integrity requirements of the asset and the data it handles. A compromise of an Identity Provider or a system handling strictly confidential data has a very high impact.",
      "falsePositives": "The model cannot verify whether a software library is implemented in constant time or whether a specific virtualization platform is hardened against side-channel attacks. This risk may be flagged as a false positive if the underlying implementation is robust despite the model's indications (e.g., a custom-developed component that correctly uses a hardened library).",
      "cwe": "208",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "109_sec7.ts",
      "bsiCode": "SYS.4.3",
      "id": "insecure-embedded-systems",
      "title": "Insecure Communication in Embedded Systems (based on BSI SYS.4.3)",
      "description": "Embedded systems are often constrained in resources (power, cost, size), which can lead to insufficient security features such as strong cryptography. When networked using standard protocols, these devices become vulnerable to attack. This risk covers the misuse of insecure communication interfaces (e.g., unencrypted protocols, missing authentication) to manipulate data or software, hijack connections, or penetrate the system.",
      "impact": "Successful exploitation can lead to data and software tampering, spoofing of messages, and unauthorized system access. This compromises the Confidentiality, Integrity, and Availability of the embedded system and the data it handles, potentially enabling larger-scale attacks on the connected infrastructure.",
      "action": "Secure All Communication Interfaces",
      "mitigation": "Use encrypted communication protocols (e.g., HTTPS, WSS, MQTTS, FTPS) for all network links. Enforce strong, non-default authentication mechanisms for all connections. Where possible, use network segmentation, IP filtering, or VPNs to protect the communication channel. Disable unused physical ports (like USB) and harden those in use.",
      "check": "Are all communication links from embedded devices using encrypted protocols? Is authentication enforced on all links? Are sensitive data assets protected in transit? Are physical ports secured?",
      "asvs": "Based on BSI IT-Grundschutz Baustein SYS.4.3 (Eingebettete Systeme)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_6_Embedded_systems_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Scans for technical assets representing embedded devices. It then inspects all outgoing communication links from these devices. A risk is flagged if a communication link uses an unencrypted protocol or has no authentication, especially when transmitting sensitive data or connecting across trust boundaries to the internet.",
      "riskAssessment": "The likelihood is high if both encryption and authentication are missing on a network connection. The impact is determined by the sensitivity (CIA) of the data transmitted and the criticality of the source and target assets. Impact and likelihood increase if the connection crosses a trust boundary, especially towards the internet.",
      "falsePositives": "The risk might be a false positive if the unencrypted communication occurs exclusively on a physically secured and isolated network segment where interception is not considered a credible threat.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "109_sec8.ts",
      "bsiCode": "SYS.4.3",
      "id": "counterfeit-hardware-components",
      "title": "Counterfeit or Manipulated Hardware Components (BSI G 0.46)",
      "description": "Counterfeit or manipulated components may be installed in embedded systems or other physical hardware during production or service. This can happen unintentionally due to the prevalence of fakes, or intentionally by an attacker.",
      "impact": "The use of counterfeit or manipulated hardware compromises the system's integrity and availability. It can lead to system failures, incorrect processing, and denial of service.",
      "action": "Implement Hardware and Supply Chain Verification Processes",
      "mitigation": "Source all hardware components from trusted, vetted suppliers. Implement a receiving process to verify the authenticity of components (e.g., checking for physical signs of tampering, using hardware scanners).",
      "check": "Is there a formal process for vetting hardware suppliers? Are components physically and/or electronically verified upon receipt? Is access to hardware components controlled during storage, assembly, and maintenance? Are tamper-evident seals used?",
      "asvs": "BSI IT-Grundschutz Threat G 0.46 Sabotage of Hardware, Software, or Data. See also: NIST SP 800-161 (Supply Chain Risk Management for Federal Information Systems and Organizations).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2022/Threats/G_0_46_Sabotage_of_hardware_software_or_data_EN.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for physical assets, especially operational technology (OT) devices, which are common targets for component-level attacks. The risk is considered higher for assets explicitly marked as sensitive to supply chain issues via tags.",
      "riskAssessment": "The likelihood increases for assets that are physically accessible or part of a complex, less-controlled supply chain (for example, many OT devices). The impact is directly related to the confidentiality, integrity, and availability (CIA) requirements of the asset itself and the data it processes or stores. Compromising a mission-critical asset can have a very high impact.",
      "falsePositives": "The risk may be a false positive if the organization has strong, proven supply chain and physical security controls that are not captured in the model. Verification requires auditing procurement and hardware handling procedures.",
      "cwe": "354",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "10_sec1.ts",
      "bsiCode": "APP.3.4",
      "id": "unprotected-smb-communication",
      "title": "Unprotected SMB Communication (BSI APP.3.4.A15 – Encrypt SMB traffic)",
      "description": "Unencrypted or weakly protected Samba/SMB communication can be eavesdropped, allowing interception of credentials and sensitive files.",
      "impact": "Cleartext SMB traffic can expose credentials and confidential data (Confidentiality) and enable lateral movement.",
      "action": "Enforce SMB3 encryption and disable SMBv1",
      "mitigation": "Require SMB 3.0+ with encryption enabled end-to-end (prefer AES-GCM where available).",
      "check": "Search all communication links modeled with protocol 'smb'. Verify they have been switched to 'smb-encrypted' or are explicitly protected by a VPN/tunnel.",
      "asvs": "OWASP ASVS 4.0 – V9: Communication Security (e.g., verify confidential data is encrypted in transit).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "Triggers for any communication link using the unencrypted 'smb' protocol.",
      "riskAssessment": "Likelihood increases to 'very-likely' if the link crosses a trust boundary and to 'frequent' if an internet-facing asset participates.",
      "falsePositives": "Traffic may be on a physically isolated network segment, or encryption may be provided at a lower layer (e.g., IPsec/VPN) not modeled on the link.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "10_sec2.ts",
      "bsiCode": "APP.3.4",
      "id": "insecure-samba-default-configuration",
      "title": "Insecure Default Configuration of Samba Server",
      "description": "To facilitate a quick start, Samba server installations often generate a default 'smb.conf' configuration file.",
      "impact": "If unwanted file shares are active due to an unreviewed default configuration, sensitive data stored on the server can be exposed, violating confidentiality.",
      "action": "Harden Samba Server Configuration",
      "mitigation": "Never use the default 'smb.conf' file in a production environment without a thorough review.",
      "check": "Is the Samba server's 'smb.conf' file reviewed and hardened? Are there any default, example, or unintended shares active?",
      "asvs": "V14.2.1: Configuration",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for any 'File Server' technical asset that receives traffic over SMB or SMB-encrypted protocols.",
      "riskAssessment": "The likelihood is considered 'Likely' as using default configurations is a common administrative oversight.",
      "falsePositives": "A model can correctly identify a file server using SMB, but cannot verify its live configuration.",
      "cwe": "1188",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "10_sec3.ts",
      "bsiCode": "APP.3.4",
      "id": "outdated-admin-tools",
      "title": "Use of Outdated Administration Tools (BSI-based)",
      "description": "Unauthorized individuals can gain access to confidential information, manipulate it, or cause disruptions by using applications or IT systems.",
      "impact": "Successful exploitation can lead to unauthorized administrative control over the managed system (e.g., a file server), resulting in Elevation of Privilege.",
      "action": "Phase Out and Replace Outdated Components",
      "mitigation": "Regularly inventory all administrative tools and software components. Identify any tools that are no longer supported or updated by the vendor (End-of-Life).",
      "check": "Is there an inventory of administrative software? Are components checked for their support lifecycle status? Are there known outdated tools like Samba's SWAT in use?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Software and system lifecycle), specifically Requirement CON.1.A15 (Patch and change management), which covers the handling of components and their lifecycle.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_application_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
      "detectionLogic": "This risk is triggered for any technical asset explicitly tagged as an `outdated-admin-tool` or a specific known-vulnerable tool like `samba-swat-tool`.",
      "riskAssessment": "The likelihood of exploitation for a publicly known obsolete tool is considered VERY LIKELY.",
      "falsePositives": "The risk might be a false positive if the tool, despite being tagged as outdated, is heavily firewalled, accessible only from a secure management network, and has other compensating controls in place.",
      "cwe": "937",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "10_sec4.ts",
      "bsiCode": "APP.3.4",
      "id": "samba-misconfiguration-due-to-insufficient-knowledge",
      "title": "Samba Misconfiguration due to Insufficient Administrator Knowledge",
      "description": "If administrators are insufficiently familiar with the extensive components, functions, options, and configuration settings of Samba,",
      "impact": "Misconfiguration of a file server like Samba can directly compromise the confidentiality, integrity, and availability of the data it stores and serves.",
      "action": "Ensure Samba Administrators Receive Specialized Training",
      "mitigation": "Administrators responsible for Samba servers must be adequately trained on its configuration, security features, and potential pitfalls.",
      "check": "Are Samba administrators formally trained or can they demonstrate equivalent expertise? Are configuration changes reviewed and logged? Are Samba configurations regularly audited against a secure baseline?",
      "asvs": "BSI IT-Grundschutz SYS.1.2.2 Linux and Unix-Servers; ORP.1 Information security organisation",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_2_Linux_and_Unix_Server_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for technical assets identified as file servers, either by their technology type (`file-server`) or by being the target of SMB/CIFS communication protocols.",
      "riskAssessment": "The likelihood is rated as 'likely' by default, as Samba is a complex system with many security-critical settings. The impact is calculated based on the CIA requirements of the file server itself and the data assets it stores and processes. A server handling 'Strictly Confidential' or 'Mission-Critical' data will result in a higher impact.",
      "falsePositives": "This risk is based on the general complexity of the technology and does not assess the specific skill level of the organization's administrators.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "10_sec5.ts",
      "bsiCode": "APP.3.4",
      "id": "data-loss-on-incompatible-filesystems-bsi",
      "title": "Data Loss or Corruption due to Incompatible Filesystem Semantics",
      "description": "When files are shared between different operating systems (e.g., Windows and Unix/Linux) via services like Samba, differences in filesystem capabilities can lead to data loss or corruption.",
      "impact": "If business-relevant information is destroyed or altered, business processes and tasks can be delayed or fail entirely.",
      "action": "Ensure Filesystem Compatibility and Data Integrity Preservation",
      "mitigation": "When using file sharing services across different platforms, ensure the service is configured to preserve file metadata and permissions as much as possible (e.g., using Samba's `vfs_streams_xattr` module to save ADS).",
      "check": "Is a file server used to share files between clients of different operating systems (e.g., Windows and Linux)? Are applications using the share dependent on platform-specific file attributes (like ADS or extended POSIX ACLs)? How is the file sharing service (e.g., Samba) configured to handle metadata and permission incompatibilities?",
      "asvs": "Derived from BSI IT-Grundschutz principles, particularly concerning system interoperability as seen in modules like SYS.1.3 (Windows Server) and SYS.2.1 (Linux and Unix Servers). There is no single direct control, but the risk arises from their interaction.",
      "cheatSheet": "https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html",
      "detectionLogic": "Triggers on technical assets with 'FileServer' technology that store data with more than minimal integrity requirements. The risk is inherent in such setups, as preserving file semantics across different operating systems is complex and a common source of data loss if not explicitly configured and verified.",
      "riskAssessment": "The likelihood is considered 'Likely' for any cross-platform file sharing scenario due to the complexity of maintaining perfect semantics.",
      "falsePositives": "This risk can be a false positive if the file server is used exclusively by clients of the same operating system family, if the server is explicitly configured to handle metadata incompatibilities (e.g., via Samba VFS modules), or if the stored data and associated applications do not use any platform-specific filesystem features.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "10_sec6.ts",
      "bsiCode": "APP.3.4",
      "id": "samba-tdb-inconsistency",
      "title": "Samba TDB Inconsistency on an Unreliable File System",
      "description": "Samba stores critical operational data—such as user mappings, share definitions, and session information—in Trivial Database (TDB) files. If the underlying operating system or file system does not handle these database files with sufficient performance and consistency (e.g., when placed on network shares like NFS/SMB without proper locking guarantees), the TDBs can become corrupted. This can lead to instability or complete failure of Samba services.",
      "impact": "Corruption of Samba's TDB databases can lead to severe service degradation or complete unavailability (Denial of Service). It may also cause silent data integrity loss for Samba's internal state, potentially affecting security controls and access rights.",
      "action": "Ensure Samba TDBs Are Stored on a Reliable, Local File System",
      "mitigation": "Store Samba's TDB files on a local, high-performance, and consistent file system (e.g., ext4, XFS). Avoid placing TDB files on network file systems (NFS, SMB/CIFS) unless the storage solution explicitly guarantees the required consistency and locking semantics for database-like workloads. Regularly back up TDB files as part of the system's backup strategy.",
      "check": "Review the Samba configuration (smb.conf) to identify the location of database directories (e.g., 'private dir', 'state directory'). Verify that these locations map to a local filesystem on the host server. Check monitoring for I/O errors or performance issues on the volume where TDBs are stored.",
      "asvs": "N/A - This is a specific infrastructure and configuration risk not directly covered by OWASP ASVS.",
      "cheatSheet": "https://wiki.samba.org/index.php/TDB_files",
      "detectionLogic": "This risk is identified when a technical asset representing a 'File Server' (as a proxy for Samba) communicates with a 'Datastore' over a network file system protocol such as NFS or SMB. This pattern suggests that the server's operational data, including TDBs, might be stored on network-attached storage, which is a known anti-pattern that can lead to database corruption.",
      "riskAssessment": "The likelihood of this risk is considered 'Likely' if the architectural pattern is detected, as it's a known cause of instability. The impact is determined by the Availability and Integrity requirements of the File Server asset. A 'Mission-Critical' server suffering from this issue would result in a 'Very High' impact.",
      "falsePositives": "The model might incorrectly represent the storage topology. The identified network storage might be used exclusively for user data shares, while the TDBs are correctly located on a local disk. This risk requires manual verification of the Samba server's configuration on the target system.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "110_sec1.ts",
      "bsiCode": "SYS.4.4",
      "id": "insecure-iot-components-sys-4-4",
      "title": "Insecure IoT Components (BSI SYS.4.4)",
      "description": "During the development of IoT devices, information security aspects are often not considered or are given low priority. This has repeatedly led to IoT devices being misused to gather information about users or their environment. The BSI provides examples such as hijacked surveillance cameras and baby monitors due to missing authentication, or backdoors in room sensors allowing unauthorized data exfiltration.",
      "impact": "A successful attack can lead to the takeover of the IoT device's control functions and the compromise of processed data (e.g., video streams, sensor data). This can result in espionage and the leakage of confidential information such as user credentials or infrastructure details, which can facilitate further, more sophisticated attacks on the network.",
      "action": "Implement Secure IoT Lifecycle Management",
      "mitigation": "Procure IoT devices from reputable manufacturers with a track record of security updates. Change all default credentials immediately upon deployment. Segment the network to isolate IoT devices from critical systems (e.g., using a dedicated VLAN or trust boundary). Disable all unnecessary services and ports. Implement a process for monitoring and applying firmware updates. Monitor network traffic from IoT devices for suspicious outbound connections.",
      "check": "Are default credentials changed on all IoT devices? Are IoT devices located in a separate, isolated network segment? Is there a process to keep firmware up to date? Are unnecessary features and services disabled? Is the network traffic from these devices monitored?",
      "asvs": "BSI IT-Grundschutz SYS.4.4 Allgemeines IoT-Gerät (General IoT Device)",
      "cheatSheet": "https://www.bsi.bund.de",
      "detectionLogic": "Triggers for all in-scope technical assets of the technology type 'IoT Device'. The risk is inherent to this class of devices due to widespread vulnerabilities like missing authentication, hardcoded credentials, and infrequent updates, unless explicitly hardened and managed.",
      "riskAssessment": "The likelihood is considered 'Very Likely' for internet-facing IoT devices and 'Likely' for internal ones, due to the prevalence of vulnerabilities. The impact scales with the confidentiality and integrity of the data processed or the environment controlled by the device. For example, a camera in a server room (processing 'Strictly Confidential' data) results in a 'Very High' impact.",
      "falsePositives": "Can be considered a false positive if the specific device has been through a thorough security assessment, is fully hardened, and managed according to best practices. This would typically be documented and validated outside the model.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "110_sec2.ts",
      "bsiCode": "SYS.4.4",
      "id": "uncontrolled-i@SystemType:OT-internet-exposure",
      "title": "Uncontrolled Internet Exposure of LAN-integrated I@SystemType:OT Devices",
      "description": "I@SystemType:OT devices integrated into local area networks (LANs) often attempt to independently establish a connection to the internet. They may use protocols like UPnP (Universal Plug and Play) to automatically configure routers for port forwarding. This makes the I@SystemType:OT devices, which may have unpatched vulnerabilities, visible and accessible from outside the trusted LAN. An attacker can exploit such a device to compromise it, incorporate it into a botnet, or use it as a piv@SystemType:OT point to inject malware into the internal network, leading to further malicious activities.",
      "impact": "If an externally exposed I@SystemType:OT device is compromised, it can serve as an entry point into an otherwise protected internal network. This could lead to widespread malware infection, data breaches of sensitive internal systems, and the disruption of critical business processes. The compromised device itself can be used for malicious purposes like participating in DDoS attacks as part of a botnet.",
      "action": "Segment I@SystemType:OT Devices and Implement Egress Filtering",
      "mitigation": "Disable UPnP on all network infrastructure devices within the LAN. Segment I@SystemType:OT devices into a separate, isolated network zone (VLAN/subnet) with strict firewall rules. Implement a default-deny egress filtering policy for the I@SystemType:OT network segment, only allowing connections to specific, required external endpoints. All traffic from the I@SystemType:OT segment to the internal corporate network should be blocked by default and only allowed on a case-by-case basis if absolutely necessary, typically through a proxy or gateway.",
      "check": "Are I@SystemType:OT devices deployed on the same network segment as critical internal assets? Is UPnP disabled on all routers and firewalls? Are there strict egress firewall rules in place for network segments containing I@SystemType:OT devices? Is traffic between the I@SystemType:OT segment and internal corporate networks monitored and restricted?",
      "asvs": "OWASP I@SystemType:OT Top 10: I5 - Lack of Network Hardening",
      "cheatSheet": "https://owasp.org/www-project-internet-of-things-project/assets/OWASP_IoT_Top_10_2018_final.pdf",
      "detectionLogic": "This rule checks for technical assets of technology type 'I@SystemType:OT-Device' that are located within an on-premise or LAN-like trust boundary but also have a direct communication link to an asset on the internet or are themselves marked as internet-facing. This configuration suggests a lack of proper network segmentation and control over the I@SystemType:OT device's external communications.",
      "riskAssessment": "The likelihood of exploitation is considered high due to the often-poor security posture of I@SystemType:OT devices and default-enabled features like UPnP. The impact is determined by the sensitivity of other assets located in the same network segment as the I@SystemType:OT device. If the I@SystemType:OT device shares a network with assets processing or storing highly confidential or critical data, a compromise could have a very high impact.",
      "falsePositives": "This risk can be a false positive if the modeled connection to the internet is intentional and secured through a dedicated, properly configured firewall with strict egress rules that is n@SystemType:OT explicitly modeled. The model might simply show a logical connection without capturing the network controls in place.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "111_sec1.ts",
      "bsiCode": "SYS.4.5",
      "id": "careless-handling-of-removable-media",
      "title": "Careless Handling of Removable Media",
      "description": "In many organizations, organizational regulations and technical security procedures for removable media exist,",
      "impact": "If removable media containing sensitive or critical data is lost, it can lead to a significant breach of confidentiality, especially if the data is unencrypted.",
      "action": "Enforce Secure Handling and Encryption Policies for Removable Media",
      "mitigation": "A comprehensive policy for the use of removable media must be created and enforced. All removable media used to store sensitive company data must be encrypted (e.g., using full-disk encryption).",
      "check": "Is there a policy for the secure use of removable media? Is strong encryption mandatory for all removable media containing sensitive data? Are users aware of the risks and trained in secure handling procedures?",
      "asvs": "BSI IT-Grundschutz CON.3 Removable Media",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Removable_media_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any technical asset identified as removable media (via the '@RemovableMedia' tag).",
      "riskAssessment": "The likelihood of careless handling of physical media is inherently high. The impact depends directly on the sensitivity (CIA rating) of the data stored on the media and whether effective encryption is used.",
      "falsePositives": "The model might n@SystemType:OT capture specific compensating controls, such as a strictly enforced organizational policy that only allows company-issued, pre-encrypted USB drives.",
      "cwe": "311",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "111_sec2.ts",
      "bsiCode": "SYS.4.5",
      "id": "insecure-handling-of-removable-media",
      "title": "Insecure Handling of Removable Media (BSI CON.3)",
      "description": "If the regulations for the correct handling of removable media (e.g., USB sticks, external hard drives) are n@SystemType:OT sufficiently known or followed, they cann@SystemType:OT be complied with.",
      "impact": "A system compromised by malicious removable media can lead to a loss of confidentiality, integrity, and availability for the system and the data it processes.",
      "action": "Establish and Enforce a Strict Policy for Removable Media Usage",
      "mitigation": "Define and enforce a clear policy for the use of removable media. This policy should include measures such as: disabling autorun features, scanning all media for malware before use, restricting the use of removable media to authorized personnel and devices only, and encrypting sensitive data stored on them.",
      "check": "Is there a formal policy for removable media? Are users trained on this policy? Are technical controls in place to enforce the policy (e.g., port blocking, mandatory scanning)? Are physical ports on servers in data centers secured?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Wechseldatenträger / Removable Media).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Removable_data_media_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is generated for any in-scope technical asset designated as a physical machine (`machine: physical`).",
      "riskAssessment": "The likelihood is considered `Likely` as it depends on user behavior, which can be unpredictable without strong technical and organizational controls.",
      "falsePositives": "This risk can be considered a false positive if all physical ports on the asset are verifiably disabled by technical controls (e.g., GPO, MDM) or are physically secured and inaccessible.",
      "cwe": "506",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "111_sec3.ts",
      "bsiCode": "SYS.4.5",
      "id": "data-loss-on-removable-media",
      "title": "Data Loss on Unencrypted Removable or Portable Media (BSI SYS.4.5)",
      "description": "The risk of data loss due to theft or physical loss is significantly higher for removable media (such as USB drives, external hard drives, optical media, or memory cards) than for stationary IT systems. If such media are lost or stolen and the storage is not encrypted, the information can be irretrievably lost (availability impact) and may be exposed to unauthorized third parties (confidentiality impact).",
      "impact": "This can lead to a severe breach of confidentiality if sensitive data is exposed, and a loss of availability if the data is not backed up elsewhere. This may result in financial loss, reputational damage, and non-compliance with data protection regulations like @DataType:PII.",
      "action": "Enforce Full-Disk and Removable Media Encryption",
      "mitigation": "All data stored at rest on removable media (USB drives, external hard drives, memory cards, optical media) must be encrypted using strong, industry-standard algorithms (e.g., via BitLocker, FileVault, LUKS). Implement policies that enforce encryption for all such media. Additionally, maintain regular backups of critical data to mitigate availability risks from device loss.",
      "check": "Are all technical assets representing portable systems or removable media configured with an `encryption` style other than `none`? Is there a policy enforcing encryption for data at rest on these types of assets?",
      "asvs": "BSI IT-Grundschutz SYS.4.5 Wechseldatenträger, particularly SYS.4.5.A10 (Data carrier encryption) and SYS.4.5.A12 (Protection against malware).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_Mobile_workstation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset that is inherently portable (e.g., `technology: client-system` or `desktop`) or represents removable storage (e.g., `type: datastore` with `technology: local-file-system` or `block-storage`). The risk is triggered if the asset stores data (`data_assets_stored` is not empty) but has its `encryption` property set to `none`.",
      "riskAssessment": "The likelihood of physical loss or theft of removable media is considered 'Likely'. The impact is calculated based on the Confidentiality and Availability of the data stored on the asset. If the data is highly sensitive or critical, the impact is high. The absence of encryption makes a data breach 'Probable' if the device is lost.",
      "falsePositives": "The risk can be considered a false positive if the asset, despite being removable or portable, is used exclusively within a highly secure physical environment (e.g., media that never leave a secure data center) and this is strictly enforced. Such exceptions must be documented and justified.",
      "cwe": "311",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "111_sec4.ts",
      "bsiCode": "SYS.4.5",
      "id": "physical-damage-to-removable-media",
      "title": "Physical Damage to Removable Media (BSI SYS.4.5)",
      "description": "Removable media, such as USB drives or external hard disks, are susceptible to damage, errors, or failures due to their size, portability, and physical nature.",
      "impact": "Failure or damage to removable media directly impacts the Availability and Integrity of the data stored on them.",
      "action": "Implement secure handling, encryption, and @Backup:Target policies for removable media",
      "mitigation": "To mitigate the risk of data loss from physical damage, enforce mandatory backups for any critical or important information stored on removable media.",
      "check": "Is there a policy governing the use of removable media? Is data encryption enforced for removable media that store sensitive information?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.4.5 (Wechseldatenträger), specifically the scenario 'Defekte Datenträger' (Defective data carriers).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Removable_data_media_edition_2023.pdf?__blob=publicationFile&v=2 (BSI SYS.4.5)",
      "detectionLogic": "This rule triggers for any 'datastore' technical asset that is explicitly marked with the `@RemovableMedia` tag. The risk is inherent to the physical nature of such devices.",
      "riskAssessment": "The likelihood of physical failure or damage is considered 'Likely' for portable media. The impact is calculated based on the Availability and Integrity requirements of the data stored on the asset.",
      "falsePositives": "The risk might be considered partially mitigated if strong physical controls, mandatory encryption, and robust @Backup:Target procedures are demonstrably in place.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "111_sec5.ts",
      "bsiCode": "SYS.4.5",
      "id": "removable-media-risk-con5",
      "title": "Risks of Using Removable Media (BSI SYS.4.5)",
      "description": "Removable media are used in very different environments and are therefore exposed to many threats.",
      "impact": "If removable media are not handled securely, it can lead to the loss of confidentiality, integrity, and availability of the data stored on them and the systems they connect to.",
      "action": "Implement Secure Handling Procedures for Removable Media",
      "mitigation": "A comprehensive policy for the use of removable media must be created and enforced.",
      "check": "Is there a documented and enforced policy for the use of removable media? Are technical controls like mandatory encryption and antivirus scanning in place?",
      "asvs": "BSI IT-Grundschutz SYS.4.5: Removable media",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Removable_media_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all in-scope technical assets that are classified as clients or other physically accessible device types (e.g., desktops, laptops, IoT devices).",
      "riskAssessment": "The impact of this risk is determined by the highest confidentiality, integrity, and availability requirements of the data processed or stored by the affected technical asset.",
      "falsePositives": "The risk may be a false positive if an organization has implemented effective technical controls that are not visible in the model, such as disabling all relevant physical ports via hardware settings or central management policies (MDM/GPO).",
      "cwe": "552",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "111_sec6.ts",
      "bsiCode": "SYS.4.5",
      "id": "malware-via-removable-media-sys-4-5",
      "title": "Malware Propagation via Removable Media (BSI SYS.4.5)",
      "description": "Removable media (e.g., USB drives, external hard disks) are often used to exchange data between different devices and workstations.",
      "impact": "If malware is introduced via removable media, it can lead to compromise of confidentiality (data theft), integrity (data manipulation),",
      "action": "Implement Strict Controls for Removable Media Usage",
      "mitigation": "Disable autorun/autoplay features for all media using endpoint management policies. Implement an endpoint protection solution (antivirus/antimalware)",
      "check": "Are endpoint protection systems configured to scan removable media? Are autorun features disabled via group policy or similar mechanisms?",
      "asvs": "BSI IT-Grundschutz Baustein SYS.4.5 Wechseldatenträger, e.g., Requirements SYS.4.5.A12 Schutz vor Schadsoftware and SYS.4.5.A4 Richtlinie zum sicheren Umgang mit Wechseldatenträgern.",
      "cheatSheet": "BSI IT-Grundschutz Kompendium – Baustein SYS.4.5 \\",
      "detectionLogic": "This risk is generated for any in-scope technical asset identified as a client system (e.g., `desktop`, `client-system`, `mobile-app`, `devops-client`)",
      "riskAssessment": "The likelihood is considered 'Likely' for general-purpose workstations without specific controls, as this is a common attack vector.",
      "falsePositives": "The risk might be a false positive if the asset is in a highly controlled physical environment where no external media can be introduced,",
      "cwe": "506",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "11_sec1.ts",
      "bsiCode": "APP.3.6",
      "id": "dns-failure-bsi-app-3-6",
      "title": "DNS Server Failure (BSI APP.3.6)",
      "description": "If a DNS server fails, it can disrupt the entire IT operation. Because clients and other servers of the institution are then no longer able to resolve internal or external hostnames to addresses, data connections cannot be established. This risk identifies DNS servers that are not configured for high availability and therefore constitute a single point of failure (SPOF).",
      "impact": "A failure of a central DNS server leads to widespread service outages. External IT systems, such as those of mobile employees, customers, and business partners, cannot access the institution's servers. This typically disrupts essential business processes, leading to significant operational and financial losses.",
      "action": "Implement Redundant and Resilient DNS Infrastructure",
      "mitigation": "Ensure high availability of DNS services by implementing redundant DNS servers (e.g., a primary/secondary setup). The `redundant: true` flag should be set on the technical asset in the model to reflect this. Use multiple, geographically distributed DNS servers for critical operations. Implement active monitoring to quickly detect DNS server failures and trigger failover mechanisms. Ensure DNS server configurations are regularly backed up.",
      "check": "Is the technical asset tagged with '@Service:DNSServer' also marked as `redundant: true`? Are there multiple assets providing DNS services in a failover configuration? Is the availability of the DNS service actively monitored?",
      "asvs": "Derived from the BSI IT-Grundschutz-Kompendium 2023, Baustein APP.3.6: DNS-Server, specifically requirement APP.3.6.A2 'Einsatz redundanter DNS-Server' (Use of redundant DNS servers).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_DNS_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any in-scope technical asset that is tagged with `@Service:DNSServer` and is not marked as `redundant: true` in the model. The absence of the `redundant` flag on a critical infrastructure component such as a DNS server indicates a Single Point of Failure (SPOF).",
      "riskAssessment": "The likelihood is considered **Likely** for any non-redundant DNS server, as it represents a single point of failure. The impact is derived directly from the availability rating of the DNS server asset itself. A `Mission-Critical` DNS server leads to `Very-High` impact, `Critical` to `High` impact, and so on. The overall risk severity is a function of this likelihood and impact.",
      "falsePositives": "This risk can be a false positive if the DNS service's redundancy is managed by an underlying platform (e.g., a cloud provider's managed DNS service or a load balancer) even if the asset in the model is not explicitly marked as `redundant: true`.",
      "cwe": "0",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "11_sec2.ts",
      "bsiCode": "APP.3.6",
      "id": "insufficient-dns-capacity",
      "title": "Insufficient DNS Server Capacity (DoS Risk)",
      "description": "The BSI notes: 'If the network capacity for a DNS server is insufficient, access times to internal and external services can increase. As a result, these services may be only partially available or not available at all. The DNS server also becomes more susceptible to a Denial-of-Service (DoS) attack.' This risk applies to assets identified as DNS servers, especially those lacking redundancy.",
      "impact": "A successful Denial-of-Service attack or capacity overload on a central DNS server can render dependent services and applications unusable, severely impacting business operations. This directly threatens the availability of all IT infrastructure components that rely on it for name resolution.",
      "action": "Ensure DNS Server Redundancy and Capacity Planning",
      "mitigation": "Deploy DNS servers in a redundant, highly-available configuration (e.g., a cluster). Use load balancing to distribute requests. For internet-facing DNS servers, implement robust DoS protection measures (e.g., via a WAF, specialized provider, or cloud service features). Regularly monitor server load and network capacity, and scale resources proactively. The asset in the model should be marked as `redundant: true` to reflect these measures.",
      "check": "Is the technical asset configured for high availability (e.g., clustered, redundant instances)? Is it monitored for performance and load? Are there DoS protection mechanisms in place, especially if it's internet-facing?",
      "asvs": "Derived from a general BSI threat description regarding DNS availability. This aligns with high-availability architecture principles.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for technical assets tagged with `@Service:DNSServer`. The risk is generated if the asset is not marked as redundant (`redundant: false`). The severity is elevated if the asset is internet-facing and/or serves a large number of clients, as these factors increase its exposure and the potential impact of an outage.",
      "riskAssessment": "The likelihood of an outage is significantly increased by a lack of redundancy. Internet exposure makes the asset a more likely target for external attacks. The impact is derived from the availability requirement of the DNS server itself, as it is a critical infrastructure component for many other assets.",
      "falsePositives": "This rule may generate a false positive if an asset is modeled as a single component but is, in reality, a managed, highly-available DNS service (e.g., from a cloud provider) where redundancy is implicit. In such cases, the asset should be marked as `redundant: true` in the model to suppress this risk.",
      "cwe": "770",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "11_sec3.ts",
      "bsiCode": "APP.3.6",
      "id": "inadequate-dns-planning-bsi-net2.2",
      "title": "Insufficient or Missing Planning of DNS Deployment (BSI NET.2.2)",
      "description": "Planning errors often have particularly serious effects, as they can easily create widespread security vulnerabilities.",
      "impact": "If firewall rules controlling DNS traffic are too permissive, they can enable attacks such as DNS tunneling for data exfiltration (loss of Confidentiality) or DNS spoofing (loss of Integrity).",
      "action": "Develop and implement a comprehensive DNS security concept and firewall rule set",
      "mitigation": "A documented DNS concept should be created and maintained. Firewall rules for DNS traffic must be defined on a strict 'allow-list' basis, only permitting necessary queries from specific sources to authorized servers.",
      "check": "Is there a documented DNS concept? Are firewall rules for DNS traffic based on an 'allow-list' principle? Is DNS traffic monitored for anomalies? Is a Protective DNS service in use? Is DNSSEC validated?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein NET.2.2 (@Service:DNSServer), specifically relating to threat NET.2.2.A2 (Unplanned or improper connection of a DNS server to the Internet).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_2_2_DNS_server_edition_2023.pdf?__blob=publicationFile (BSI NET.2.2)",
      "detectionLogic": "This risk is triggered for any network-level trust boundary (such as on-premises networks, cloud providers, or security groups) that has traffic crossing it and is not explicitly marked with the '@DNS-Concept-Applied' tag.",
      "riskAssessment": "The likelihood is considered 'likely' if no documented DNS concept exists for a network boundary. The impact is derived from the highest sensitivity (CIA ratings) of the assets located inside the trust boundary.",
      "falsePositives": "This risk can be a false positive if a robust DNS security concept is in place but the corresponding trust boundary has not been tagged in the model.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "11_sec4.ts",
      "bsiCode": "APP.3.6",
      "id": "incorrect-dns-information",
      "title": "Incorrect DNS Information",
      "description": "Even if the use of DNS has been carefully planned and all security-relevant points have been taken into account, this is not sufficient if semantically and syntactically incorrect domain information is created.",
      "impact": "Incorrect or maliciously altered DNS information can lead to severe service disruptions (Availability), as applications may be unable to connect to required backends, databases, or external services.",
      "action": "Implement and Enforce DNS Data Integrity and Consistency Checks",
      "mitigation": "Ensure that access to DNS server configuration and zone files is strictly controlled. Implement a four-eyes principle for changes to critical DNS records.",
      "check": "Are there processes to verify the correctness of DNS records before and after they are deployed? Is access to manage DNS records restricted to authorized personnel?",
      "asvs": "BSI IT-Grundschutz NET.1.1 @Service:DNSServer, specifically Requirement NET.1.1.A5 'Konsistente Zonendaten' (Consistent zone data).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_1_DNS_server_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset explicitly marked as a DNS server via the '@Service:DNSServer' tag.",
      "riskAssessment": "The likelihood of misconfiguration is considered 'Likely' due to the manual nature and complexity of DNS management. The impact scales with the highest Confidentiality, Integrity, and Availability requirements of all dependent client systems.",
      "falsePositives": "This rule might generate a false positive if the tagged asset is merely a caching or forwarding DNS resolver and not authoritative for any zones. The risk primarily applies to authoritative DNS servers where incorrect data can originate.",
      "cwe": "20",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "11_sec5.ts",
      "bsiCode": "APP.3.6",
      "id": "misconfigured-@Service:DNSServer",
      "title": "Misconfigured DNS Server (BSI APP.3.6)",
      "description": "Security-critical default settings, custom security-critical settings, or incorrect configurations can cause a DNS server to malfunction. This includes issues such as operating as an open resolver or permitting unrestricted zone transfers.",
      "impact": "An open resolver configuration can severely impair the server's availability due to increased load and expose it to DNS reflection attacks, leading to denial of service. Additionally, unrestricted zone transfers allow unauthorized hosts to read complete domain information (zone data), which contains valuable network topology details that can facilitate subsequent attacks.",
      "action": "Secure DNS Server Configuration",
      "mitigation": "Configure the DNS server to accept recursive queries only from trusted internal networks (disable open recursion). Restrict DNS zone transfers (e.g., AXFR/IXFR queries) strictly to the IP addresses of authorized secondary DNS servers. Ensure the DNS server software is kept up to date and patched against known vulnerabilities.",
      "check": "Is recursion for external queries disabled? Are zone transfers restricted to specific, authorized IP addresses? Is the DNS server software regularly patched?",
      "asvs": "BSI IT-Grundschutz APP.3.6 DNS-Server, e.g., A4 (Secure base configuration of a DNS server: restrict recursion and zone transfers) and A18 (Enhanced protection of zone transfers).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_DNS-Server_Edition_2023.html",
      "detectionLogic": "This rule identifies assets tagged as DNS servers. It then checks for two distinct misconfiguration risks: 1. If the DNS server receives any communication from an asset marked as 'internet', it raises a Denial-of-Service risk due to potential abuse as an open resolver. 2. If the DNS server receives communication from an asset outside its own network trust boundary (and that source is not a DNS server), it raises an Information Disclosure risk due to potential unrestricted zone transfers.",
      "riskAssessment": "The likelihood for both risks is considered high if the respective exposure exists, as these are common and well-known attack vectors. The impact of the 'open resolver' vulnerability is rated based on the 'availability' requirement of the DNS server asset. The impact of the 'unrestricted zone transfer' vulnerability is rated based on the 'confidentiality' of the data stored and the network information that would be revealed.",
      "falsePositives": "A connection from the internet might be intended for an authoritative-only server, which is less risky than a recursive one; the model cannot distinguish query types. A connection from another network might be for a legitimate, authorized secondary server that happens to be in a different network trust boundary. Manual verification of the server's specific configuration is required.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "11_sec6.ts",
      "bsiCode": "APP.3.6",
      "id": "dns-cache-poisoning-app4.4",
      "title": "DNS Cache Poisoning (BSI APP.3.6)",
      "description": "A DNS cache poisoning attack aims to make the attacked IT system store incorrect mappings of IP addresses and names.",
      "impact": "Successful DNS cache poisoning attacks are often conducted with the goal of redirecting requests to malicious servers (e.g., for phishing or malware distribution).",
      "action": "Implement Secure DNS Resolution Mechanisms",
      "mitigation": "Use trusted, security-aware DNS resolvers that support DNSSEC. For clients and applications making outbound calls, enable DNSSEC validation to ensure the authenticity and integrity of DNS responses.",
      "check": "Are all clients and servers configured to use a trusted, corporate DNS resolver? Is DNSSEC validation enforced for external lookups?",
      "asvs": "V14.2 Communication Security Verification Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/DNS_Security_Cheat_Sheet.html",
      "detectionLogic": "This risk is flagged for any technical asset that communicates with an asset on the internet from within a trusted network boundary.",
      "riskAssessment": "The likelihood is considered higher for client-type technologies (browsers, mobile apps, IoT devices) which may operate on less trusted networks.",
      "falsePositives": "This risk is triggered based on the modeled network topology. It may be a false positive if the target domain is non-critical, or if the client application has other built-in protections against redirection (e.g., certificate pinning, which is not modeled here).",
      "cwe": "290",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "11_sec7.ts",
      "bsiCode": "APP.3.6",
      "id": "dns-hijacking",
      "title": "DNS Hijacking",
      "description": "DNS Hijacking is a Man-in-the-Middle (MITM) attack method used to intercept and redirect communication by compromising the Domain Name System (DNS) resolution process. An attacker can route communication between a client's resolver and a DNS server through their own system. This allows them to eavesdrop on, record, and arbitrarily modify the traffic. A successful attack enables the attacker to change the IP address associated with a domain name, redirecting users to malicious sites.",
      "impact": "Successful DNS hijacking can lead to phishing attacks, credential theft, and malware distribution by redirecting users to fraudulent websites. It fundamentally undermines the trust in domain names, compromising the integrity of communications. This can result in significant financial loss, reputational damage, and the compromise of sensitive data (violating Confidentiality and Integrity).",
      "action": "Enforce Encrypted Communication Protocols and Secure DNS",
      "mitigation": "All communication, especially across trust boundaries to the internet, must use encrypted protocols (e.g., HTTPS, LDAPS, FTPS). This prevents MITM attacks, including those facilitated by DNS hijacking. Additionally, utilize secure DNS protocols like DNS-over-HTTPS (DoH) or DNS-over-TLS (D@SystemType:OT) to encrypt the DNS queries themselves. Implementing DNSSEC validation at the resolver ensures the authenticity and integrity of DNS responses. If unencrypted protocols are unavoidable, ensure they are protected by a mandatory, trusted VPN, which should be modeled with the 'vpn: true' property on the communication link.",
      "check": "Review all communication links that cross trust boundaries to external or internet-facing assets. Verify that they exclusively use strongly encrypted protocols. Check client and server configurations for the use of secure DNS (DoH/D@SystemType:OT) and DNSSEC validation.",
      "asvs": "BSI IT-Grundschutz: SYS.1.2.2 DNS Server. OWASP: ASVS V4.0.3 - 9.1.1 (Verify that all connections to external systems are authenticated and encrypted in transit).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any unencrypted communication link from an in-scope asset to an external, internet-facing asset. Such connections rely on DNS for resolution, and without transport-layer encryption, they are vulnerable to MITM attacks initiated via DNS hijacking.",
      "riskAssessment": "The likelihood is considered 'Likely' for any unencrypted channel to the internet, as the means for MITM attacks are widespread. The impact is determined by the sensitivity (Confidentiality and Integrity) of the data assets transferred over the communication link and the criticality of the communicating technical assets. Transferring 'Confidential' data over an unencrypted link results in a 'High' impact.",
      "falsePositives": "A risk might be a false positive if the communication protocol, while technically unencrypted, is protected by other compensating controls like a mandatory, trusted VPN that encrypts all traffic between the two endpoints. This must be modeled explicitly (e.g., using the `vpn: true` property on the communication link).",
      "cwe": "345",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "11_sec8.ts",
      "bsiCode": "APP.3.6",
      "id": "dos-on-@Service:DNSServer",
      "title": "Denial-of-Service Attack on a DNS Server",
      "description": "In a Denial-of-Service (DoS) attack on a DNS server, a vast number of requests, typically from a botnet, are sent to the server.",
      "impact": "A successful DoS attack against a DNS server will lead to a loss of availability for all systems and applications that depend on it.",
      "action": "Implement Volumetric DoS Protection and Ensure DNS Redundancy",
      "mitigation": "Protect DNS servers with a specialized DoS mitigation service (e.g., from a CDN or cloud provider).",
      "check": "Is the DNS server protected by a professional anti-DoS service? Are there redundant, geographically separate DNS servers?",
      "asvs": "OWASP ASVS V4.0.3: 11.1.1 (Verify that the application is able to handle requests and gracefully fail when under a denial of service attack.)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any technical asset identified as a DNS server (via the '@Service:DNSServer' tag) that is exposed to untrusted networks.",
      "riskAssessment": "The likelihood of an attack is high for any public-facing DNS server. The impact is directly proportional to the availability requirement",
      "falsePositives": "This risk might be a false positive if the DNS service is provided by a major cloud provider (e.g., AWS Route 53, Google Cloud DNS)",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "12_sec1.ts",
      "bsiCode": "APP.4.2",
      "id": "insecure-sap-erp-configuration-bsi-app2.1",
      "title": "Insecure SAP ERP Configuration (BSI APP.2.1)",
      "description": "If an SAP ERP system is set up without adhering to the recommended security guides from SAP, it can lead to serious security vulnerabilities.",
      "impact": "Failure to follow SAP hardening guides can compromise the confidentiality, integrity, and availability of the entire ERP system.",
      "action": "Apply SAP Security Hardening Guides",
      "mitigation": "The SAP ERP system must be configured and hardened according to the official SAP security recommendations and best practices.",
      "check": "Has the SAP ERP system been configured according to SAP's security best practices and hardening guides? Has a security audit of the SAP configuration been performed?",
      "asvs": "BSI IT-Grundschutz APP.2.1 SAP-ERP-System",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_2_1_SAP_ERP_System_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all in-scope technical assets of the 'ERP' technology type, as these are assumed to be SAP systems in the context of this rule.",
      "riskAssessment": "The likelihood is considered high by default due to the complexity of SAP systems, making misconfigurations common. The impact is derived from the",
      "falsePositives": "This risk might be a false positive if the system is confirmed to be fully hardened according to SAP guidelines, but this information is n@SystemType:OT captured in the threat model.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "12_sec2.ts",
      "bsiCode": "APP.4.2",
      "id": "missing-sap-patches-or-security-notes",
      "title": "Missing SAP Patches or Security Notes",
      "description": "SAP ERP systems are complex and typically process sensitive data. SAP regularly publishes patches and security advisories to fix software bugs and known vulnerabilities.",
      "impact": "Failure to apply SAP patches promptly can lead to the exploitation of known vulnerabilities. This can compromise the confidentiality of sensitive data, the integrity of business-critical processes, and the availability of the entire ERP system, potentially causing significant financial and reputational damage.",
      "action": "Implement and Enforce a Timely Patch Management Process for SAP Systems",
      "mitigation": "Establish a formal patch management process for all SAP systems. This process should include regularly monitoring for new SAP security notes and patches, assessing their relevance and criticality, testing them in a non-production environment, and deploying them to production systems within a defined timeframe. Automate monitoring and deployment where possible and maintain an audit trail of all applied patches.",
      "check": "Is there a documented patch management policy for SAP systems? Are SAP security notes actively monitored? Is there a defined process for testing and deploying patches within a specified timeframe? Are patch levels regularly audited?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.1.1 (General Server), Requirement SYS.1.1.A20 (Timely application of security updates).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_1_General_server_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is automatically raised for any technical asset identified as an SAP ERP system (technology: 'erp'). The risk's severity is calculated based on the CIA ratings of the asset and of the data it processes or stores.",
      "riskAssessment": "The likelihood is considered 'likely' by default, as patch management is an ongoing operational task requiring constant diligence. The impact escalates from 'low' to 'very high' depending on the confidentiality, integrity, and availability requirements of the ERP system and the data it handles. For systems critical to business operations, the impact can be very high.",
      "falsePositives": "This risk can be considered a false positive if a robust, audited, and timely patch management process for SAP systems is verifiably in place. This cannot be determined from the model alone and requires reviewing operational security procedures and records.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "12_sec3.ts",
      "bsiCode": "APP.4.2",
      "id": "inadequate-sap-authorization-concept",
      "title": "Inadequate SAP Authorization Concept (BSI APP.4.2)",
      "description": "SAP authorization concepts are technically and functionally complex. Due to this complexity, they are often poorly planned or implemented. Without a well-thought-out concept, accounts are frequently assigned excessive permissions (violating the principle of least privilege), which could be used to intentionally manipulate or accidentally damage the SAP ERP system, thus compromising its integrity, confidentiality, and availability.",
      "impact": "These issues can lead to unauthorized access, data manipulation, fraud, and exposure of sensitive business data. In S/4HANA systems, misaligned permissions between ABAP, HANA, and NetWeaver Gateway components can create conflicting and insecure access states. Poor documentation prevents effective maintenance and access reviews, allowing former employees or those in new roles to retain unnecessary privileges.",
      "action": "Design, implement, and document a role-based SAP authorization concept",
      "mitigation": "Develop and enforce a detailed, role-based authorization concept based on the principle of least privilege. For S/4HANA, ensure permissions are synchronized across ABAP, HANA, and NetWeaver Gateway. Thoroughly document the concept and all assigned privileges. Implement regular, periodic access reviews (user access recertification) to ensure permissions are aligned with current job roles and to remove obsolete access for movers and leavers. Use specialized tools to analyze and manage SAP authorizations to identify and remediate excessive privileges. Mark the asset with the `@Mitigation:sap-authorization-concept-reviewed` tag once this has been verified.",
      "check": "Is there a documented, role-based SAP authorization concept? Are permissions regularly reviewed? Is there a process to handle movers and leavers in a timely manner? Are permissions across different S/4HANA components synchronized and consistent?",
      "asvs": "BSI IT-Grundschutz APP.4.2 SAP-ERP-System",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_4_2_SAP_ERP_System_Edition_2022.html",
      "detectionLogic": "This risk is raised for any in-scope technical asset of technology type 'ERP', as these systems are complex and prone to having inadequate authorization concepts if not explicitly and carefully designed and maintained. The risk can be mitigated by verifying a robust authorization concept is in place and tagging the asset with `@Mitigation:sap-authorization-concept-reviewed`.",
      "riskAssessment": "The likelihood is considered high by default due to the inherent complexity of SAP systems. The impact is derived from the CIA rating of the ERP system itself. An ERP system handling 'Strictly Confidential' data or rated as 'Mission-Critical' will result in a very high impact, leading to a critical overall risk.",
      "falsePositives": "The risk is a generic best-practice check for SAP systems. It may be a false positive if a robust, well-documented, and regularly reviewed authorization concept already exists. This must be confirmed by manual review.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "12_sec4.ts",
      "bsiCode": "APP.4.2",
      "id": "lack-of-erp-documentation-and-contingency-plan",
      "title": "Lack of SAP/ERP System Documentation and/or Contingency Plan",
      "description": "If documentation for an SAP/ERP system is non-existent or not maintained, it becomes impossible to track how the system was configured and built.",
      "impact": "Failure to document the system and prepare contingency plans can severely impact the system's availability. In a failure scenario, recovery efforts will be slow and disorganized,",
      "action": "Create and Maintain System Documentation and Contingency Plans",
      "mitigation": "Create comprehensive technical and operational documentation for the SAP/ERP system, covering all configurations, customizations, and dependencies. Keep this documentation up-to-date with any changes.",
      "check": "Is there up-to-date, comprehensive documentation for the SAP/ERP system? Does a detailed, tested contingency plan for the system exist? Are the responsible personnel aware of and trained on the plan?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.4.2 (SAP-ERP-System), notably section 2.4 (Missing SAP documentation and emergency plans) and requirement APP.4.2.A28 (Creation of an emergency plan).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_4_2_SAP_ERP_System_Edition_2023.pdf?__blob=publicationFile (German BSI Reference)",
      "detectionLogic": "Triggers on in-scope technical assets with the 'ERP' technology type. The risk is raised if the asset is business-critical (in terms of availability) and lacks the `@documentation-present` or `@contingency-plan-present` tags.",
      "riskAssessment": "The impact is directly tied to the availability rating of the ERP system. For a 'mission-critical' system, the impact is 'very-high' as its failure would halt core business functions.",
      "falsePositives": "This risk may be a false positive if the required documentation and plans exist in reality but have not been tagged accordingly in the threat model. The purpose of this risk is to prompt verification.",
      "cwe": "755",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "13_sec1.ts",
      "bsiCode": "APP.4.3",
      "id": "insufficient-hardware-resources-for-database",
      "title": "Insufficient Hardware Resources for Database System (BSI-based)",
      "description": "If the hardware of a database system does n@SystemType:OT have sufficient system resources (CPU, memory, storage I/O),",
      "impact": "A lack of sufficient hardware resources for a database directly threatens its Integrity and Availability.",
      "action": "Implement and Monitor Capacity Management",
      "mitigation": "Ensure the database system is provisioned with adequate hardware resources (CPU, memory, I/O, storage) to handle peak loads, based on a capacity plan (BSI OPS.1.1.5.A1).",
      "check": "Is there a capacity plan for the database? Is performance and resource utilization being monitored?",
      "asvs": "BSI IT-Grundschutz: OPS.1.1.5 Capacity management (especially A1 Planning, A2 Monitoring)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Capacity_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for all technical assets of the 'Database' technology type.",
      "riskAssessment": "The impact is determined by the availability and integrity requirements of the database asset and the data it stores.",
      "falsePositives": "This risk can be a false positive if the database is already well-provisioned and monitored, which cann@SystemType:OT be determined from the model alone.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "13_sec2.ts",
      "bsiCode": "APP.4.3",
      "id": "default-database-accounts",
      "title": "Default Accounts on Database Management Systems (BSI APP.4.4.A6)",
      "description": "Upon initial installation or in its delivery state, a Database Management System (DBMS) often has default accounts (for users and administrators) that are either unsecured or protected only by publicly known passwords.",
      "impact": "Successful exploitation allows unauthorized access to the database with potentially administrative privileges. This can lead to a complete compromise of the confidentiality, integrity, and availability of all data stored in the database, as well as manipulation of the DBMS configuration.",
      "action": "Secure or Remove Default Database Accounts",
      "mitigation": "All default passwords for pre-configured accounts on the DBMS must be changed to strong, unique values immediately after installation. Unnecessary or unused default accounts should be disabled or deleted. Access to administrative accounts must be tightly controlled and monitored.",
      "check": "Verify that no default accounts exist on the database with their initial, publicly known passwords. Check if unused default accounts have been disabled or removed. Review the database hardening guide and confirm its application.",
      "asvs": "BSI IT-Grundschutz APP.4.4.A6 (Secure administration account for the DBMS)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_Database_management_system_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all technical assets of technology type 'Database' or 'Identity-Store-Database' that are not explicitly tagged as hardened or as having their default accounts secured. These systems are prime targets for attacks using default credentials.",
      "riskAssessment": "The likelihood of exploitation is very high, as scanning for default credentials is a common automated attack vector. The impact is directly related to the sensitivity (Confidentiality and Integrity) of the data stored within the database. A database containing 'Strictly Confidential' data will result in a 'Very High' impact.",
      "falsePositives": "This risk can be a false positive if the database was installed from a pre-hardened 'golden image' or if automated configuration management tools have secured the default accounts, but the corresponding tags (`hardened`, `default-accounts-secured`) have not been applied in the model.",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "13_sec3.ts",
      "bsiCode": "APP.4.3",
      "id": "unencrypted-database-communication",
      "title": "Unencrypted Communication to Database (BSI-derived)",
      "description": "In their default configuration, many database management systems (DBMS) connect to applications without encryption.",
      "impact": "Eavesdropping on the communication can lead to the disclosure of sensitive business data, personal data, or technical credentials.",
      "action": "Enforce Encrypted Database Connections",
      "mitigation": "Configure all communication links between applications and database systems to use strong, state-of-the-art encryption protocols (e.g., via TLS).",
      "check": "Review the connection strings and configuration for all application-to-database links. Verify that an encrypted protocol is used.",
      "asvs": "V9.1 Data Protection",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule identifies communication links where the target is a 'Database' technology and the protocol used is n@SystemType:OT recognized as encrypted.",
      "riskAssessment": "The impact is determined by the highest Confidentiality and Integrity of the data assets transferred over the link.",
      "falsePositives": "Can occur if a custom or non-standard protocol that includes encryption is used but n@SystemType:OT recognized by the tool.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "13_sec4.ts",
      "bsiCode": "APP.4.3",
      "id": "data-loss-in-database-due-to-failures",
      "title": "Data Loss in a Database due to Technical or Human Failure (BSI APP.4.3)",
      "description": "Data can be lost in a database due to hardware or software errors, as well as human misconfiguration or mistakes.",
      "impact": "Since databases typically store information critical for applications, the loss or unavailability of data can cause services to fail or",
      "action": "Implement and regularly test backup and recovery procedures and/or high availability.",
      "mitigation": "Regularly create backups of the database. Store backups securely and in a separate location (ideally off-site or in a different availability zone).",
      "check": "Are regular backups of the database being created? Are backups stored securely and separately? Is there a documented and tested recovery plan? Is the database asset marked as 'redundant' in the model to reflect a high-availability setup?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.4.3: Relationale Datenbanken.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_5_Datenbanken.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is generated for all in-scope technical assets of type 'datastore' with the technology 'database' that are not marked as redundant. The assumption is that a non-redundant database represents a single point of failure regarding data availability and integrity.",
      "riskAssessment": "The likelihood is considered 'likely' for any non-redundant critical system over its lifetime, as hardware, software, or human errors are inevitable. The impact is directly tied to the availability and integrity ratings of the technical asset and the data it stores. A database supporting mission-critical processes will have a 'very-high' impact if it fails.",
      "falsePositives": "This risk might be a false positive if high-availability or backup and recovery mechanisms exist but are not modeled. To mitigate this, mark the corresponding database asset as 'redundant: true' in the model file if such controls are in place.",
      "cwe": "755",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "13_sec5.ts",
      "bsiCode": "APP.4.3",
      "id": "data-integrity-violation-in-database-con-4-a19",
      "title": "Violation of Data Integrity in a Database (BSI CON.4.A19)",
      "description": "The integrity of information in a database can be violated due to misconfigurations, software errors, or direct data manipulation.",
      "impact": "If data integrity is compromised and not detected promptly, it can lead to incorrect business decisions, financial loss (e.g., due to faulty billing or tax data),",
      "action": "Implement and Enforce Data Integrity Controls",
      "mitigation": "Utilize database-native integrity constraints like primary keys, foreign keys (referential integrity), UNIQUE, NOT NULL, and CHECK constraints.",
      "check": "Review the database schema for the use of integrity constraints (foreign keys, check constraints, etc.). Analyze application code for strict server-side validation logic before database writes. Are there auditing or monitoring mechanisms in place to detect unauthorized or unexpected data changes?",
      "asvs": "V7.1.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html",
      "detectionLogic": "Triggers on in-scope technical assets of type 'datastore' with database-related technologies (e.g., 'database', 'identity-store-database', 'data-lake', 'big-data-platform').",
      "riskAssessment": "The impact is determined by the highest 'integrity' and 'availability' classification of the data assets stored within the database.",
      "falsePositives": "This risk might be a false positive if data integrity is enforced entirely and robustly at the application layer, but this is not documented in the model via the mitigation tag.",
      "cwe": "353",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "13_sec6.ts",
      "bsiCode": "APP.4.3",
      "id": "sql-injection-bsi",
      "title": "SQL Injection",
      "description": "A common attack method on database systems is SQL Injection. When an application accesses data from an SQL database, commands are transmitted to the DBMS as SQL statements. If input data is insufficiently validated within the application, attackers can inject their own SQL commands, which are then processed with the permissions of the application's service account.",
      "impact": "Attackers can read, manipulate, delete, or add data, and potentially execute system commands. While SQL injections primarily target applications, they have a significant impact on the database system itself and the associated infrastructure, potentially leading to complete data compromise (Confidentiality, Integrity), system unavailability (Availability), and further infrastructure compromise.",
      "action": "Implement Input Validation and Use Parameterized Queries",
      "mitigation": "The primary defense is to use parameterized queries (prepared statements) for all database access. All user-supplied input must be validated, filtered, or sanitized on the server side. Enforce the principle of least privilege for the database service account. Use an ORM (Object-Relational Mapping) framework that correctly handles parameterization. Avoid dynamic SQL query construction with unvalidated data.",
      "check": "Is all user-supplied input strictly validated? Are parameterized queries or prepared statements used for all database interactions? Does the database service account have the minimum necessary permissions? Is dynamic SQL construction with unvalidated data avoided?",
      "asvs": "V5.3.3: Verify that the application protects against SQL injection attacks.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for technical assets (like Web Applications or Web Services) that are custom-developed and have a direct communication link to a database using a SQL-based protocol. The risk is heightened if the asset is exposed to the internet or processes data from untrusted sources, as this provides a vector for malicious input.",
      "riskAssessment": "Likelihood is HIGH for custom-developed applications that are exposed to the internet and do n@SystemType:OT use a modern, secure ORM. Impact is directly related to the Confidentiality and Integrity of the data in the connected database. If the database contains 'Strictly Confidential' or 'Mission-Critical' data, the impact is Very High.",
      "falsePositives": "The risk may be a false positive if the application uses a modern, secure framework (like a well-configured ORM) that prevents SQLi by default, even if the model shows the vulnerable pattern. Verification requires code review or dynamic/static application security testing (DAST/SAST).",
      "cwe": "89",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "13_sec7.ts",
      "bsiCode": "APP.4.3",
      "id": "unhardened-database-defaults",
      "title": "Insecure Default Configuration of Database System (BSI-DB-STD-CFG)",
      "description": "In the default configuration of a database management system (DBMS), unnecessary functions are often enabled. This can make it easier for attackers to read or manipulate data in the database. For example, due to an unchanged default installation, attackers might connect to an unused administrative programming interface without authenticating. This could allow unauthorized access to the institution's databases.",
      "impact": "If this vulnerability is exploited, an attacker could gain unauthorized administrative access to the database. This would allow them to read, modify, or delete sensitive data, leading to a breach of confidentiality and integrity. It could also lead to a denial of service by altering or deleting database components.",
      "action": "Harden Database Configuration",
      "mitigation": "Review the default configuration of the DBMS and disable all unnecessary features, services, and programming interfaces. Ensure that all administrative interfaces require strong authentication and are not exposed to untrusted networks. Apply security configuration hardening guides from the vendor or trusted third parties (e.g., CIS Benchmarks). The application of a `@Hardened:Database` tag on the asset can signify that this review and hardening process has been completed.",
      "check": "Is the database configuration regularly reviewed and hardened against a security baseline (like CIS Benchmarks)? Are all unused features and interfaces disabled? Is strong authentication enforced on all administrative access points?",
      "asvs": "V14.2.1 (Secure Configuration), V14.2.3 (Unnecessary Features Disabled)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Secure_Configuration_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for any technical asset of type `database` that has not been explicitly marked as hardened. The absence of a `@Hardened:Database` tag is used as the indicator. It assumes that without explicit confirmation, a database might retain insecure default settings.",
      "riskAssessment": "The likelihood is considered 'likely' for unhardened databases, as default configurations are a well-known attack vector. The impact relates directly to the sensitivity (CIA ratings) of the data stored in the database. A database holding `strictly-confidential` data will have a 'very high' impact, while one with only `public` data will have a 'low' impact.",
      "falsePositives": "Can occur if the database *is* hardened in reality but has not been tagged accordingly in the threat model. Verification requires checking the actual configuration of the database instance.",
      "cwe": "1188",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "13_sec8.ts",
      "bsiCode": "APP.4.3",
      "id": "unchecked-or-malicious-database-scripts",
      "title": "Unchecked or Malicious Database Scripts (BSI APP.4.3.A19)",
      "description": "Database management systems often allow actions to be automated via scripts executed within the database context (e.g., PL/SQL, triggers). If used without proper review by responsible personnel, these scripts may not meet the institution's software development requirements. Furthermore, core database functions, such as data dictionary tables, can be manipulated by attackers using malware or database scripts. Such attacks are difficult to detect. Quality defects in these scripts and embedded malware can compromise the confidentiality, integrity, and availability of data stored in the databases.",
      "impact": "Successful exploitation can lead to data tampering, unauthorized data disclosure, or denial of service for the database. This compromises the confidentiality, integrity, and availability (CIA) of stored data, potentially leading to significant business disruption, financial loss, and reputational damage.",
      "action": "Implement strict change control and secure coding practices for database scripts",
      "mitigation": "Establish a formal process for developing, reviewing, and deploying all database scripts, including stored procedures, triggers, and automated jobs. This process should include peer reviews and security testing to identify vulnerabilities and quality issues. Access to create or modify these scripts should be highly restricted. Regularly monitor for unauthorized changes to database schemas and core functions. Ensure developers are trained in secure database programming practices.",
      "check": "Is there a mandatory code review process for all database scripts? Are permissions to create stored procedures and triggers limited to authorized administrators? Is there active monitoring for changes to the database's core components and active scripts?",
      "asvs": "BSI IT-Grundschutz APP.4.3.A19 Schutz vor schädlichen Datenbank-Skripten",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Database_management_system_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for all in-scope technical assets of type 'datastore' with the 'database' technology. The likelihood of this risk increases if the database is marked as having custom-developed parts, as this implies a higher probability of using custom scripts.",
      "riskAssessment": "The impact is determined by the highest confidentiality, integrity, and availability requirements of the database and the data it stores. The likelihood is considered 'Likely' by default for databases and 'Very Likely' if they involve custom-developed parts, reflecting the inherent risk of complex, unaudited code running with high privileges.",
      "falsePositives": "This risk may be a false positive if the organization has robust, out-of-band controls for database script management (e.g., all database changes managed via a GitOps workflow with mandatory approvals) that are not reflected in the Threagile model.",
      "cwe": "506",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "14_sec1.ts",
      "bsiCode": "APP.4.4",
      "id": "unprotected-administrative-access",
      "title": "Unprotected Administrative Access",
      "description": "To manage runtimes, nodes, and container platforms like Kubernetes, administrators and automated tools require administrative access.",
      "impact": "Successful exploitation allows an attacker to gain administrative control over the affected component. This can lead to arbitrary code execution,",
      "action": "Enforce Authentication and Encryption on Administrative Interfaces",
      "mitigation": "Ensure that all administrative access points (network ports, APIs, sockets) for infrastructure components (like Kubernetes, databases, application servers)",
      "check": "Review the configuration of all relevant infrastructure components. Are all administrative network ports and APIs configured with mandatory authentication?",
      "asvs": "V14.2.1: Secure Component Configuration",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for incoming communication links configured for 'DevOps' usage that target critical infrastructure components.",
      "riskAssessment": "The impact is determined by the CIA rating of the target asset and the data it processes or stores. A high-value asset leads to a high or very high impact.",
      "falsePositives": "The risk might be a false positive if the administrative interface is protected by other compensating controls not modeled in detail,",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "14_sec2.ts",
      "bsiCode": "APP.4.4",
      "id": "stolen-kubernetes-access-token",
      "title": "Stolen Kubernetes Access Token from Pod",
      "description": "Pods often require access tokens (associated with a Service Account) to interact with the Kubernetes API server (Control Plane).",
      "impact": "With a stolen token, an attacker can perform authenticated actions against the Control Plane.",
      "action": "Apply the principle of least privilege to Service Accounts and Pods",
      "mitigation": "Ensure that Kubernetes Service Accounts have the minimum required permissions (RBAC).",
      "check": "Review the permissions of all Service Accounts. Are they overly permissive? Do pods that don't need API access still have tokens mounted?",
      "asvs": "OWASP Kubernetes Top 10: K01 - Insecure Workload Configurations",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Kubernetes_Security_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for any technical asset running as a container (`machine: container`) that is not the container platform itself.",
      "riskAssessment": "The likelihood of exploitation is considered higher for custom-developed parts, as they present a larger attack surface than off-the-shelf software.",
      "falsePositives": "This risk may be a false positive if the specific service account used by the pod has no permissions at all, or if the token is verifiably not mounted within the pod's filesystem.",
      "cwe": "522",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "14_sec3.ts",
      "bsiCode": "APP.4.4",
      "id": "pod-resource-exhaustion-on-node",
      "title": "Pod Resource Exhaustion on Node (Denial of Service)",
      "description": "Individual pods (containers) can overload the node (host system) or the orchestration platform by consuming excessive resources such as CPU or memory.",
      "impact": "If a container consumes all available resources on a node, it can cause the node to become unresponsive. This leads to a Denial of Service (DoS) for all other applications and services hosted on that node.",
      "action": "Enforce Resource Quotas and Limits on Containers",
      "mitigation": "Define and enforce resource requests and limits for both CPU and memory on all container specifications.",
      "check": "Review container definitions to ensure that `resources.requests` and `resources.limits` are specified for CPU and memory.",
      "asvs": "V13.2.3: Verify that resource utilization limits are in place to prevent denial of service attacks, such as CPU, memory, number of threads, or disk space.",
      "cheatSheet": "https://kubernetes.io/docs/concepts/policy/resource-quotas/",
      "detectionLogic": "This rule iterates through all 'Shared Runtimes' that host containerized assets.",
      "riskAssessment": "The impact is determined by the highest availability requirement of any asset running on the shared runtime. A node hosting mission-critical components will have a very high impact if it goes down.",
      "falsePositives": "A risk might be flagged if resource limits are enforced by a cluster-wide admission controller or policy engine that is not reflected in the Threagile model via tags.",
      "cwe": "770",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "14_sec4.ts",
      "bsiCode": "APP.4.4",
      "id": "unauthorized-deployment-via-cicd-pipeline",
      "title": "Unauthorized Deployment or Host Compromise via CI/CD Pipeline",
      "description": "The automation inherent in CI/CD pipelines requires granting these tools privileged access to deployment targets such as container clusters. This creates a risk of unauthorized changes. For example, an application version that has not been sufficiently tested or has bypassed the official release process could be deployed. Furthermore, misconfigurations or vulnerabilities in the CI/CD environment itself could allow malware to infiltrate the cluster, leading to data exfiltration, modification, or deletion.",
      "impact": "A compromised CI/CD pipeline can lead to the deployment of malicious or faulty software, potentially causing service disruptions (Availability), data breaches (Confidentiality), or data corruption (Integrity). It bypasses quality assurance and security gates, effectively giving an attacker a trusted path into the production environment.",
      "action": "Secure CI/CD Pipeline and Deployment Process",
      "mitigation": "Implement the principle of least privilege for CI/CD service accounts; they should only have the permissions necessary to deploy and manage applications, not full cluster-admin rights. Enforce protected branches and require multiple approvals for merges into release branches. Integrate security scanning (SAST, DAST, SCA) into the pipeline to detect vulnerabilities before deployment. Regularly audit CI/CD configurations, access permissions, and logs. Use signed commits and signed container images to ensure the integrity of the code and artifacts from development to deployment.",
      "check": "Are CI/CD service account permissions minimized? Are there mandatory review/approval steps for production deployments? Are container images scanned for vulnerabilities and their signatures verified before deployment? Are CI/CD environment access logs monitored for suspicious activity?",
      "asvs": "BSI IT-Grundschutz CON.6.A6 (Control of the software development and release process) and CON.6.A21 (Secure provision of development environments)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Software_development_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered by communication links from development-relevant assets (such as Build Pipeline, Source Code Repository, Artifact Registry) to runtime environments (such as Container Platform, Application Server, Web Server). The existence of such a deployment path forms the basis of this risk.",
      "riskAssessment": "The likelihood is considered 'Likely' for any automated deployment path. The impact is determined by the sensitivity (CIA ratings) of the target asset and the data it processes or stores. A pipeline deploying to a critical production system has a much higher impact than one deploying to a staging environment.",
      "falsePositives": "The model may not capture fine-grained permissions or compensating controls (such as mandatory manual approvals, image signing, etc.) that mitigate this risk. The risk should be verified by examining the actual CI/CD pipeline configuration and RBAC policies on the target cluster.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "14_sec5.ts",
      "bsiCode": "APP.4.4",
      "id": "unrestricted-container-communication",
      "title": "Unrestricted Container Communication (BSI CON.1.A21)",
      "description": "All pods in a cluster are generally able to communicate with each other, with the nodes in their own cluster, and with any other IT systems.",
      "impact": "If communication between containerized assets is not restricted, a single compromised container can be used for lateral movement to attack other containers, the underlying host nodes, or even the cluster's control plane. This can lead to a full cluster takeover, data breaches of all applications running on the cluster, and widespread denial-of-service.",
      "action": "Implement Network Segmentation for Containers",
      "mitigation": "Enforce fine-grained network segmentation between containerized assets using technologies like Kubernetes Network Policies, Istio Authorization Policies, or other service mesh/CNI features.",
      "check": "Are all container assets located within a trust boundary of type 'network-policy-namespace-isolation'? Are 'default-deny' network policies in place for all container environments? Is inter-container communication restricted to only what is functionally necessary?",
      "asvs": "BSI IT-Grundschutz CON.1.A21 (Restricting network access for containers)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/con/CON_1_General_container_usage_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies technical assets of machine type 'container' that are not located inside a 'network-policy-namespace-isolation' trust boundary.",
      "riskAssessment": "The likelihood of exploitation is considered 'Likely' in an environment without network segmentation, as a single container vulnerability can be leveraged for lateral movement.",
      "falsePositives": "This risk can be a false positive if network segmentation is achieved by means not represented in the model, such as a service mesh with strict mTLS authorization policies that is not modeled with dedicated trust boundaries, or strict host-based firewalling on the nodes.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "15_sec1.ts",
      "bsiCode": "APP.4.6",
      "id": "missing-sap-authorization-check",
      "title": "Missing SAP Authorization Check in Custom Code",
      "description": "In SAP systems, authorizations are checked only if developers implement an explicit authorization check (e.g., `AUTHORITY-CHECK` in ABAP) in the program code. Without such a check, the system does not verify whether a user is truly authorized to perform an action. In custom-developed code, these essential security checks are frequently forgotten.",
      "impact": "This failure bypasses the entire SAP authorization concept, allowing unauthorized users to access, modify, or delete data stored in the SAP system. This can lead to severe compliance violations, data breaches, and significant negative findings during financial or security audits.",
      "action": "Enforce Authorization Checks in Custom Code",
      "mitigation": "Ensure that all custom-developed SAP programs and functions that handle sensitive data or perform critical actions include explicit authorization checks. Use static application security testing (SAST) tools configured for ABAP to find missing checks. Conduct regular code reviews focusing on access control. Mandate developer training on secure SAP development practices, including the correct use of the authorization concept.",
      "check": "Are there processes (like mandatory SAST scans or peer reviews) in place to verify that custom SAP code includes necessary authorization checks before deployment? Are developers adequately trained on SAP secure coding standards?",
      "asvs": "V4.1.1: Verify that the application enforces access control rules on each request from a trusted source, except for public resources.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any technical asset that is marked as a custom-developed part (`custom_developed_parts: true`) and is identified with a technology 'ERP', which is commonly used for SAP systems. The risk's severity increases based on the sensitivity of the data the component processes or stores.",
      "riskAssessment": "The likelihood is considered high for any custom SAP component, as this is a very common and well-known development error. The impact is directly proportional to the confidentiality and integrity of the data assets handled by the component. A missing check on a component processing financial data ('strictly-confidential', 'mission-critical') will result in a critical risk.",
      "falsePositives": "The risk might be a false positive if the custom component does not perform any sensitive actions or access protected data, or if it is a simple wrapper that delegates all actions to standard, secure SAP transactions that do have proper checks. Manual verification of the code's function is required to confirm the risk.",
      "cwe": "862",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "15_sec2.ts",
      "bsiCode": "APP.4.6",
      "id": "bypass-sap-security-via-custom-abap",
      "title": "Bypassing SAP Security Mechanisms via Custom ABAP Code",
      "description": "SAP systems often contain institution-critical information protected by various standard security mechanisms.",
      "impact": "Faulty custom ABAP programs can lead to unauthorized manipulation (tampering) of critical data or the exfiltration (information disclosure)",
      "action": "Secure code review and static/dynamic analysis for custom ABAP developments",
      "mitigation": "All custom ABAP code must undergo a mandatory and rigorous security review before deployment into production environments.",
      "check": "Is there a formal, enforced process for reviewing all custom ABAP code for security vulnerabilities before deployment? Are SAST/DAST tools utilized for ABAP analysis? Do developers receive specific ABAP secure coding training?",
      "asvs": "ASVS V4.1.1: Verify that the application enforces access control rules on a trusted service layer, especially if client-side access control is present and could be bypassed.",
      "cheatSheet": "https://pages.sap.com/abap-secure-programming/index.html",
      "detectionLogic": "This risk is raised for any technical asset identified as an ERP system (or tagged with 'sap' or 'erp') where custom-developed parts are present (`customDevelopedParts: true`).",
      "riskAssessment": "The likelihood is considered high if custom ABAP code is present, as the potential for human error or lack of security awareness during development is significant.",
      "falsePositives": "This risk can be considered a false positive if the `customDevelopedParts` flag is set, but the custom code is verifiably non-security-relevant, minimal, or has already undergone a thorough and documented security audit that confirms its robustness against common ABAP vulnerabilities.",
      "cwe": "288",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "15_sec3.ts",
      "bsiCode": "APP.4.6",
      "id": "injection-vulnerability-in-custom-code",
      "title": "Injection Vulnerability in Custom-Developed Code (BSI-based)",
      "description": "Injection vulnerabilities arise when attackers can inject control characters or commands into an application, often through data input fields.",
      "impact": "A successful injection attack can lead to complete system compromise, unauthorized data access (confidentiality), data modification (integrity), or denial of service (availability).",
      "action": "Implement Robust Input Validation and Use Safe APIs",
      "mitigation": "Treat all input from external sources as untrusted. Implement strong, allow-list-based input validation for all data.",
      "check": "Are all external inputs validated against a strict schema or allow-list? Is parameterized query API used for all database interactions?",
      "asvs": "V5 Input Validation and Encoding",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for all in-scope, custom-developed technical assets that accept potentially complex data formats (like JSON, XML, files).",
      "riskAssessment": "The likelihood of this vulnerability is significant in custom code. It increases if the asset is a web application or service communicating with a database.",
      "falsePositives": "This risk might be a false positive if the application is built with a modern, secure framework that provides strong, default protection against injection flaws (e.g., ORMs with non-concatenated queries, templating engines with auto-escaping), and this architectural choice is n@SystemType:OT captured in the model.",
      "cwe": "89",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "15_sec4.ts",
      "bsiCode": "APP.4.6",
      "id": "bypass-of-sap-security-in-custom-code",
      "title": "Bypass of Standard SAP Security in Custom ABAP Code (BSI APP.4.6)",
      "description": "Standard SAP systems (and other ERPs) provide various data protection mechanisms such as client separation, identity and access management (IAM), and roles/permissions.",
      "impact": "Bypassing these controls can lead to severe security incidents, including unauthorized access across business clients (in multi-tenant environments), elevation of privileges, data tampering, and information disclosure.",
      "action": "Secure Code Review and Static Analysis for Custom ABAP Code",
      "mitigation": "Enforce mandatory, security-focused code reviews for all custom developments and modifications.",
      "check": "Are all custom developments subject to a security code review before deployment? Is a SAST tool integrated into the development lifecycle for the ERP?",
      "asvs": "BSI IT-Grundschutz APP.4.6 SAP ABAP-Programmierung, e.g., A1–A4, A6, A9, A10, A12, A20; OWASP Top 10 2021: A01-Broken Access Control",
      "cheatSheet": "https://help.sap.com/doc/abapdocu_750_index_htm/7.50/en-US/abensecure_coding_guidl.htm (SAP ABAP Secure Programming Guide)",
      "detectionLogic": "This risk is automatically detected for any in-scope Technical Asset of technology type 'ERP' that is marked as having 'custom developed parts'.",
      "riskAssessment": "The likelihood is considered high for any custom code on an ERP system, as developer error or oversight in complex authorization landscapes is common.",
      "falsePositives": "Can occur if the custom code is trivial and does not interact with authorization checks or data access logic.",
      "cwe": "284",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "16_sec1.ts",
      "bsiCode": "APP.5.2",
      "id": "insufficient-exchange-outlook-regulations",
      "title": "Insufficient Regulations for Exchange and Outlook (BSI APP.5.2)",
      "description": "Overarching regulations and specifications for Exchange and Outlook are necessary to ensure the security of the information they process.",
      "impact": "A lack of clear security regulations for the mail system can lead to misconfigurations that compromise the confidentiality, integrity, or availability of email data.",
      "action": "Define and enforce security policies for the mail system",
      "mitigation": "Establish and enforce comprehensive security policies for the entire lifecycle of the Exchange/Outlook environment. This must include:",
      "check": "Are client-to-server connections for mail services always encrypted and authenticated? Is the connection from the mail server to the identity provider (e.g., Active Directory) encrypted?",
      "asvs": "BSI IT-Grundschutz: APP.5.2 Microsoft Exchange und Outlook",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_1_Exchange_Server_und_Outlook_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified by detecting specific technical misconfigurations that indicate a lack of overarching security policy for the mail system. The rule checks for:",
      "riskAssessment": "The likelihood of exploitation is high if cleartext protocols or missing authentication are used for sensitive access. The impact is directly related to the sensitivity of the data transmitted over the insecure channel and the criticality of the mail server itself. For example, unencrypted access to a mail server handling 'Strictly Confidential' data constitutes a very high impact.",
      "falsePositives": "The rule might flag connections within a highly secured, physically isolated network segment where encryption is deemed unnecessary by policy. However, this is generally not a recommended practice. Such cases should be reviewed, justified, and formally accepted.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "16_sec2.ts",
      "bsiCode": "APP.5.2",
      "id": "faulty-exchange-migration",
      "title": "Faulty Exchange Server Migration (BSI-Style)",
      "description": "Exchange systems are frequently migrated rather than newly installed. Migrating to a new version often requires underlying operating system upgrades, which in turn can impact the existing domain concept and directory services.",
      "impact": "A faulty migration can severely impact business productivity by disrupting mail services. Failures in configuration, authentication, or encryption can lead to data integrity issues, unauthorized access, and information disclosure, compromising the Confidentiality, Integrity, and Availability of all communication handled by the server.",
      "action": "Implement a Secure and Tested Migration Process",
      "mitigation": "Develop a comprehensive migration plan that includes all dependencies (OS, directory services).",
      "check": "Is there a documented migration plan that includes testing and rollback procedures?",
      "asvs": "BSI IT-Grundschutz: OPS.1.1.5 Change Management, SYS.3.2.1 Mail server",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Mail_server_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies any technical asset with 'MailServer' technology, as migrations are a common and high-risk operational activity for such systems.",
      "riskAssessment": "The likelihood is considered 'Likely' due to the complexity and frequency of such migrations. The impact is directly related to the availability and integrity rating of the mail server asset.",
      "falsePositives": "This risk may be a false positive if a very mature and robust, but un-modeled, change management and migration process is in place.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "16_sec3.ts",
      "bsiCode": "APP.5.2",
      "id": "insecure-mail-server-web-access-bsi-app-3-2",
      "title": "Insecure Web Access to Mail Server (BSI APP.3.2)",
      "description": "When users can access their email accounts via a browser, components like Internet Information Services (IIS) are often used. If this function is improperly planned and incorrectly configured, it can potentially lead to uncontrolled access to the internal network from the outside, creating a significant security risk.",
      "impact": "If e-mails are accessed via the Internet with a browser, this harbors great potential for danger. Without direct access to the institution's network, attackers could access the e-mails and thus, among other things, spy on e-mail addresses and content, misuse e-mail functions to send spam, and gain access to sensitive internal information.",
      "action": "Secure Configuration and Hardening of Web-Facing Mail Components",
      "mitigation": "Harden the web server (e.g., IIS) and the mail server's web application (e.g., OWA) according to security best practices. Disable unnecessary features and apply security patches promptly. Place web-facing components in a properly configured Demilitarized Zone (DMZ) to segment them from the internal network. Enforce strong authentication (ideally multi-factor) and ensure all communication is encrypted using up-to-date TLS (HTTPS). Consider using a Web Application Firewall (WAF) as an additional layer of protection.",
      "check": "Is the web server providing mail access properly hardened and patched? Is it located in a DMZ? Is access protected by strong authentication and encrypted via HTTPS? Is a WAF in use?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.3.2 Exchange Server und Outlook Web Access. Relevant OWASP ASVS chapters include V4 (Configuration) and V14 (Access Control).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2022/APP_Anwendungen.pdf?__blob=publicationFile&v=5#page=110",
      "detectionLogic": "This risk is triggered when a technical asset identified as a 'Mail Server', or an asset directly connected to it (like a 'Web Server' or 'Reverse Proxy'), receives traffic from the internet over a web protocol (HTTP/HTTPS). The logic checks for a direct or one-hop connection path from an internet-facing asset to a mail server.",
      "riskAssessment": "The likelihood is high if an unencrypted connection is used or if the exposed asset is n@SystemType:OT within a well-secured trust boundary (like a DMZ). The impact is determined by the confidentiality and integrity requirements of the data handled by the mail server, which is typically high to very high due to the sensitive nature of email communications.",
      "falsePositives": "This risk may be a false positive if compensating controls like a Web Application Firewall (WAF), strict network segmentation (DMZ), and mandatory multi-factor authentication are in place but are n@SystemType:OT fully represented in the threat model.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "16_sec4.ts",
      "bsiCode": "APP.5.2",
      "id": "improper-foreign-system-connection-to-exchange",
      "title": "Improper Connection of Third-Party Systems to Exchange Server",
      "description": "Microsoft Exchange systems are tightly integrated with the Windows operating system and often use connectors to interoperate with third-party systems. These connectors allow other email systems to send or retrieve emails using standard protocols like SMTP, POP3, or IMAP. However, several risks arise from these integrations.",
      "impact": "If third-party systems are connected insecurely to an Exchange server, it can lead to the loss of confidentiality and integrity of emails and other sensitive data. Attackers might intercept, read, or modify emails transmitted over unencrypted connections. Lack of proper authentication can allow unauthorized systems to connect. This can also result in a denial-of-service, blocking the mail system and disrupting critical business communication. Overall, it can cause data breaches, financial loss, and reputational damage.",
      "action": "Securely Configure and Manage Third-Party System Connectors",
      "mitigation": "Ensure that all connectors to third-party systems are documented, actively managed, and verified for compatibility with the current Exchange version, especially after migrations. Enforce strong security settings on all connections to external systems, including mandatory use of encrypted protocols (e.g., SMTPS, POP3S, IMAPS with STARTTLS) and robust authentication mechanisms. Avoid using unencrypted protocols or anonymous access. Administration of connected systems should be consistent and follow the same security baseline. Regularly audit these connections for compliance with security policies.",
      "check": "Are all connections to third-party systems from the Exchange server documented? Is the use of encrypted protocols and strong authentication enforced for all external mail connections? Has compatibility of all connectors been verified? Are there regular audits of these external connection security settings?",
      "asvs": "BSI IT-Grundschutz APP.4.2.A11 Connection of third-party systems to the Exchange Server",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_2_Exchange_Server_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks for technical assets identified as Microsoft Exchange servers (via technology type 'mail-server' and the 'product:exchange' tag). It then inspects all incoming communication links from assets *n@SystemType:OT* tagged as being from the same vendor ('vendor:microsoft'). A risk is raised if these connections use standard mail protocols (SMTP, POP3, IMAP) without encryption or without authentication.",
      "riskAssessment": "The likelihood of exploitation is high if unencrypted protocols are used, as this allows for trivial eavesdropping or modification attacks. The impact is directly related to the sensitivity (CIA ratings) of the Exchange server and the data assets (emails) it handles. A mission-critical Exchange server handling strictly confidential data will result in a very high impact.",
      "falsePositives": "This risk might be a false positive if the connected 'third-party' system is located within the same trusted security zone and managed under identical security policies, even without being a Microsoft product. Compensating controls, such as a mandatory VPN for all connections, could also mitigate the risk, though protocol-level encryption is still recommended.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "16_sec5.ts",
      "bsiCode": "APP.5.2",
      "id": "excessive-permissions-on-mail-server",
      "title": "Excessive Permissions on Mail Server (based on BSI APP.5.2)",
      "description": "If access rights for an email client or to data stored on an email server (e.g., Exchange) are created or administered improperly, significant security vulnerabilities can arise. This is especially true when permissions exceed the necessary scope (violating the principle of least privilege), potentially allowing unauthorized individuals to access, modify, or delete sensitive information.",
      "impact": "The primary impact is the unauthorized disclosure of confidential information (loss of Confidentiality). It can also lead to data tampering (loss of Integrity) or unauthorized deletion of emails/mailboxes (loss of Availability). This can result in data breaches, non-compliance with data protection regulations (like @DataType:PII), and reputational damage.",
      "action": "Enforce Principle of Least Privilege for Mailbox and Data Access",
      "mitigation": "Implement a strict, role-based access control (RBAC) model for all mail-related data. Access permissions must be granted based on the 'need-to-know' principle. Use end-user identity propagation for authentication and authorization wherever possible, instead of shared technical user accounts. Conduct regular access rights reviews and audits for all mailboxes, especially for those with delegated access. Ensure a formal process exists for requesting, approving, and revoking access rights.",
      "check": "Is there a documented RBAC model for the mail server? Are permissions regularly reviewed? Is access granted based on documented and approved requests? Is end-user identity used for authorization checks instead of generic service accounts?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.5.2 'Microsoft Exchange und Outlook', specifically requirement APP.5.2.A3 'Berechtigungsmanagement und Zugriffsrechte'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_5_2_Microsoft_Exchange_und_Outlook_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified when a technical asset of type 'Mail Server' receives communication that does not enforce fine-grained, user-specific authorization. The rule checks for incoming communication links to 'mail-server' assets. A risk is raised if the authorization method on the link is not 'End-User Identity Propagation', as this implies coarser, less secure access control mechanisms are in place, increasing the likelihood of excessive permissions being exploitable.",
      "riskAssessment": "The impact is determined by the confidentiality and integrity of the data assets being sent to or from the mail server. If highly sensitive data is involved, the impact is high. The likelihood is considered 'likely' if authorization is based on a 'technical-user' and 'very likely' if there is no authorization ('none') specified on the communication link.",
      "falsePositives": "This risk may be a false positive if a compensating access control mechanism exists outside of the modeled system, such as a sophisticated permissions system within the mail server application itself that is not represented by the 'authorization' property in the model. However, the lack of end-user identity propagation on the communication link itself remains a potential weakness.",
      "cwe": "272",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "16_sec6.ts",
      "bsiCode": "APP.5.2",
      "id": "faulty-exchange-migration",
      "title": "Faulty Exchange Migration",
      "description": "Exchange systems are often migrated rather than newly installed. Upgrading to a new version may require an operating system upgrade, which can affect the existing domain design and directory services.",
      "impact": "A faulty migration can significantly reduce productivity by disrupting mail services. Misconfigurations in authentication, encryption, or general settings can lead to integrity issues, unauthorized access, and information disclosure, compromising the confidentiality, integrity, and availability of communications handled by the server.",
      "action": "Implement a secure, tested migration process",
      "mitigation": "Develop a comprehensive migration plan that accounts for all dependencies (operating system, directory services).",
      "check": "Is there a documented migration plan that includes testing and rollback procedures?",
      "asvs": "BSI IT-Grundschutz: OPS.1.1.5 Change Management, SYS.3.2.1 Mail server",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Mail_server_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule flags any technical asset with the 'MailServer' technology, as migrations are a common, high-risk operational activity for such systems.",
      "riskAssessment": "The likelihood is set to 'Likely' due to the complexity and frequency of such migrations. The impact depends on the availability and integrity classification of the mail server.",
      "falsePositives": "This risk can be a false positive if a mature and robust, but unmodeled, change-management and migration process exists.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "16_sec7.ts",
      "bsiCode": "APP.5.2",
      "id": "incorrect-email-client-configuration",
      "title": "Incorrect Email Client Configuration (aligned with BSI APP.5.2)",
      "description": "The email client (e.g., Outlook) is a critical part of an Exchange-based email system. For the security of the entire system, clients must be configured correctly. Choosing an inappropriate communication protocol can introduce serious security weaknesses. Misconfiguration can cause issues such as a loss of confidentiality through unauthorized access and can render network-level encryption (e.g., TLS) ineffective.",
      "impact": "If an email client uses unencrypted protocols to communicate with the mail server, all transmitted data, including credentials and email content, can be intercepted and read by an attacker on the network. This leads to a direct loss of confidentiality and can enable further attacks like account takeover and impersonation.",
      "action": "Enforce Secure Outlook/Email Client Configuration Standards",
      "mitigation": "Define and enforce secure configuration baselines for all Outlook/email clients. This must include the mandatory use of encrypted communication protocols (e.g., IMAPS, SMTP with STARTTLS, POP3S) for all connections to the Exchange/mail server. Use configuration management tools (e.g., GPO, MDM/Intune) to deploy and lock down these settings. Block unencrypted email protocols at the network or mail server level where possible. If client-side encryption (e.g., S/MIME) is used, ensure the secure storage and handling of private keys on the client device.",
      "check": "Are client configurations managed centrally? Is the use of unencrypted email protocols blocked or monitored? Are all communication links from clients to Exchange/mail servers configured to use encryption (TLS)?",
      "asvs": "BSI IT-Grundschutz APP.5.2 Microsoft Exchange and Outlook",
      "cheatSheet": "BSI IT-Grundschutz Kompendium – APP.5.2 Microsoft Exchange und Outlook",
      "detectionLogic": "This rule checks for technical assets identified as clients (e.g., desktop, mobile app) that communicate with a mail server. It triggers a risk if the communication link between them uses an unencrypted email protocol (SMTP, IMAP, POP3) instead of its secure, TLS-wrapped variant.",
      "riskAssessment": "The likelihood of exploitation is very high when unencrypted protocols are used, as sniffing network traffic is a standard attack vector. The impact depends directly on the sensitivity of the data transmitted via email. If data assets with 'Confidential' or 'Strictly Confidential' ratings are sent or received over such a link, the impact is considered 'High' or 'Very High', leading to a severe overall risk.",
      "falsePositives": "This risk is unlikely to be a false positive if the conditions are met. A potential exception could be a scenario where the connection is entirely contained within a physically secure, trusted network segment where sniffing is not a credible threat, or if another compensating control like a mandatory, system-wide VPN is strictly enforced for all client connections (which should be modeled with the 'vpn: true' property on the communication link).",
      "cwe": "319",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "16_sec8.ts",
      "bsiCode": "APP.5.2",
      "id": "abuse-of-api-and-macros",
      "title": "Abuse of APIs and Macros in Outlook (BSI-based)",
      "description": "Many software products, including Outlook, provide Application Programming Interfaces (APIs) and macro capabilities to extend functionality or integrate with other programs.",
      "impact": "Successful exploitation can lead to the unauthorized disclosure (Confidentiality), modification (Integrity), or deletion (Availability) of data.",
      "action": "Harden and Restrict API and Macro Execution",
      "mitigation": "Disable APIs and macro execution by default where not required for business-critical functions.",
      "check": "Are macro and scripting capabilities disabled by default on end-user systems?",
      "asvs": "BSI module: APP.5.2 Microsoft Exchange und Outlook",
      "cheatSheet": "https://owasp.org/www-community/attacks/Code_Injection",
      "detectionLogic": "This risk is generated for technical assets that support powerful, potentially abusable scripting or macro functionalities, especially those with custom-developed parts or handling sensitive data.",
      "riskAssessment": "The likelihood of exploitation is higher for general-purpose client systems (desktops, browsers) and applications with custom-coded extensions.",
      "falsePositives": "The risk may be a false positive if the asset has strong, model-invisible compensating controls, such as a mandatory, enforced code-signing policy for all scripts and a robust EDR solution that are not documented in the threat model.",
      "cwe": "358",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "18_sec1.ts",
      "bsiCode": "APP.5.4",
      "id": "limited-availability-of-ucc-services",
      "title": "Limited Availability of UCC Services (BSI UCC.2.1)",
      "description": "UCC services often have high availability requirements, yet their functionality depends on other IT systems and applications. If underlying components such as data networks, internet connections, or authentication services fail or are not fully functional, the availability of the UCC services can be severely impaired. This can lead to cascading failures, especially if the UCC platform is required to coordinate recovery of the failed network.",
      "impact": "Compromised availability of UCC services disrupts communication and business processes. This can manifest as poor quality (latency, artifacts), dropped connections, or complete service outages, hindering task completion and potentially violating service-level agreements.",
      "action": "Ensure Redundancy and Resilience of Critical Dependencies",
      "mitigation": "Identify all critical dependencies for UCC services (e.g., networks, authentication services, cloud infrastructure). Ensure these dependencies are engineered for high availability with redundancy and failover mechanisms. Develop and test recovery plans that account for these dependencies. For cloud-based services, review the provider's SLA and resilience measures.",
      "check": "Are critical dependencies for UCC services identified and documented? Are they designed for high availability? Is the UCC service itself redundant? Is there a tested recovery plan?",
      "asvs": "BSI IT-Grundschutz: APP.1.A26 (Failure and Emergency Management), NET.1.1.A4 (Redundant Design of Active Network Components)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_1_General_applications_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Identifies UCC services with high availability requirements that rely on non-redundant technical assets. The risk is raised against the UCC service itself and highlights the fragile dependency.",
      "riskAssessment": "The impact is derived from the availability requirement of the UCC service and the data it handles. A 'Mission-Critical' service becoming unavailable has a very high impact. The likelihood is assessed as high if a critical dependency is identified as a single point of failure (i.e., not modeled as redundant).",
      "falsePositives": "The model may not capture all redundancy measures, especially those implemented at the infrastructure or cloud provider level that are not explicitly modeled as a redundant technical asset.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "18_sec2.ts",
      "bsiCode": "APP.5.4",
      "id": "inadequate-planning-of-ucc",
      "title": "Inadequate UCC Planning (BSI APP.5.4, Section 2.2)",
      "description": "If UCC solutions are not planned according to their actual use, this can negatively impact functionality. This includes underprovisioning network capacity for required services (e.g., video) or using client hardware with insufficient performance (e.g., thin clients) for resource-intensive UCC applications.",
      "impact": "Inadequate planning can lead to poor service quality—such as audio/video delay and artifacts—or render services unusable. This directly affects the availability of the communication services.",
      "action": "Conduct capacity and performance planning for UCC infrastructure and clients",
      "mitigation": "Analyze and forecast usage patterns to provision adequate network bandwidth. Define and enforce minimum hardware specifications for client devices. Perform load and performance testing before rollout, especially when using thin clients or VDI solutions for UCC.",
      "check": "Was capacity planning performed for the UCC network traffic? Are client hardware specifications sufficient for the intended services? Has performance been tested under realistic load conditions?",
      "asvs": "BSI IT-Grundschutz: APP.5.4.A1 (Planning of UCC), APP.5.4.A2 (Network planning), APP.5.4.A3 (Initial and regular testing)",
      "cheatSheet": "See BSI IT-Grundschutz: APP.5.4 Unified Communications and Collaboration (UCC).",
      "detectionLogic": "Detects risk in two scenarios: 1) Thin clients or other low-power clients connecting to UCC services may struggle with processing demands. 2) A large number of users connect to a non-redundant, small-scale UCC service, indicating potential server-side capacity issues.",
      "riskAssessment": "Impact is derived from the availability rating of the UCC service. Likelihood is high if underpowered clients are used, or if a non-redundant service supports a large number of users.",
      "falsePositives": "The model's concept of a 'thin client' via a tag is an abstraction. A well-designed VDI environment might offload processing effectively, mitigating the risk, which wouldn't be visible from the tag alone.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "18_sec3.ts",
      "bsiCode": "APP.5.4",
      "id": "incorrect-configuration-of-ucc",
      "title": "Misconfiguration of UCC (BSI APP.5.4, 2.3)",
      "description": "The complexity of UCC services provides numerous configuration options, increasing the risk of misconfiguration. This can occur at the user level (e.g., incorrect audio device selection), the administrative level (e.g., routing errors), or due to a weak identity and access management (IAM) model (e.g., granting external participants excessive permissions).",
      "impact": "Misconfigurations can lead to denial of service (users being inaudible or invisible), information disclosure (auto-accepting calls on a room system, data leakage to guests), or data tampering.",
      "action": "Implement secure configuration management and robust IAM",
      "mitigation": "Provide secure default configurations and limit risky user-configurable options. Enforce a strong Identity and Access Management (IAM) model, especially for guest and external access, based on the principle of least privilege. Audit administrative changes to critical settings.",
      "check": "Are secure configuration baselines used? Is there a robust IAM policy for the UCC service? Are permissions for external users appropriately restricted?",
      "asvs": "BSI IT-Grundschutz: OPS.1.1.4 (Secure system configuration), ORP.4 (Identity and access management)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Detects UCC services that allow communication from external entities without strong authorization, which is a key risk highlighted in the BSI text regarding misconfigured permissions for external participants.",
      "riskAssessment": "Impact is high if the UCC service handles confidential data. Likelihood is high if external communication is permitted without a strong authorization mechanism such as identity propagation or token-based authentication.",
      "falsePositives": "The model might not reflect compensating controls, such as network-level isolation or specific application-level guest policies that are not captured in the authorization model.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "18_sec4.ts",
      "bsiCode": "APP.5.4",
      "id": "misuse-of-ucc-admin-privileges",
      "title": "Misuse of UCC Administrative Privileges (BSI APP.5.4, Section 2.4)",
      "description": "Administrators of UCC services can make far-reaching changes to the system. If these privileges are used improperly—whether accidentally or maliciously—the consequences can be significant. Examples include changing permissions to expose private data, altering routing to cause denial of service, or tampering with system data.",
      "impact": "Misuse of administrative privileges can lead to severe information disclosure, data tampering, and denial of service, compromising the entire UCC environment.",
      "action": "Enforce least privilege and auditing for administrators",
      "mitigation": "Implement Role-Based Access Control (RBAC) for administrators to enforce least privilege. Use dual control (four-eyes principle) for critical configuration changes. Log all administrative actions and review logs regularly for suspicious activity.",
      "check": "Are administrative privileges based on the principle of least privilege? Are administrative actions logged and regularly reviewed? Are critical changes subject to an approval process (e.g., the four-eyes principle)?",
      "asvs": "BSI IT-Grundschutz: ORP.4.A6 (Management of privileged accounts), ORP.4.A20 (Logging and monitoring of access)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Flags any UCC service with administrative access, which inherently carries a risk of privilege misuse. Detection is based on a DevOps-style communication link or when the asset is explicitly tagged with an administrator role.",
      "riskAssessment": "The impact of this risk is directly proportional to the highest sensitivity of the data handled by the UCC service, as a malicious admin could compromise all of it. The likelihood is considered 'likely' as a baseline for any system with administrative access, assuming no specific compensating controls are modeled.",
      "falsePositives": "This is a fundamental risk for any administered system. An organization may have strong out-of-band controls (such as rigorous staff vetting and auditing) that are not visible in the threat model.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "18_sec6.ts",
      "bsiCode": "APP.5.4",
      "id": "accidental-disclosure-of-personal-information-in-ucc",
      "title": "Disclosure of Personal Data in UCC (BSI APP.5.4 Section 2.6)",
      "description": "UCC services collect and display various user data—such as availability status, timestamps, and profile details—which may enable unintended monitoring. In addition, video calls during remote work can inadvertently expose private information from a user’s home environment (e.g., background objects, other people, or sounds).",
      "impact": "Unintentional disclosure of personal data can lead to privacy violations (e.g., GDPR non-compliance), employee dissatisfaction, and the creation of detailed, sensitive user profiles without consent.",
      "action": "Implement Privacy-Enhancing Features and Policies",
      "mitigation": "Provide users with granular controls over presence and profile information. Offer and encourage privacy features such as virtual backgrounds. Define data-retention policies for metadata and logs. Perform a Data Protection Impact Assessment (DPIA) and be transparent about which data is collected and displayed to others.",
      "check": "Does the UCC solution provide privacy controls (e.g., presence, background blur)? Are users aware of them? Is there a DPIA and a clear privacy policy for the service?",
      "asvs": "BSI IT-Grundschutz: CON.6 (Data Protection)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Data_protection_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Identifies UCC services that handle data assets tagged as containing personally identifiable information (@DataType:PII). This risk is inherent to such services due to the nature of metadata and video communication.",
      "riskAssessment": "Impact depends on the sensitivity and volume of PII processed. Likelihood is very high for modern UCC systems, as metadata collection and video are standard features.",
      "falsePositives": "The organization may have strong data-protection policies and user training that effectively mitigate this risk, which may not be visible in the technical model.",
      "cwe": "359",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "18_sec7.ts",
      "bsiCode": "APP.5.4",
      "id": "negative-interactions-between-ucc-services",
      "title": "Negative Interactions Between UCC Services (BSI APP.5.4, Section 2.7)",
      "description": "UCC services can interfere with each other. This can occur on the server side, where services are integrated into a single user interface, creating a single point of failure. It can also occur on the client side, where multiple UCC applications compete for exclusive resources such as headsets or consume excessive CPU and memory, making the system unstable or causing crashes.",
      "impact": "Negative interactions between services or applications can lead to partial or complete loss of service, reducing user productivity and disrupting business operations.",
      "action": "Manage service dependencies and client-side resource consumption",
      "mitigation": "On the server side, decouple services where possible or ensure the integrating platform is highly available. On the client side, test for resource conflicts on standard client hardware builds, establish policies for running multiple UCC applications simultaneously, and provide user guidance.",
      "check": "Are service dependencies identified and managed for availability? Are client-side resource conflicts tested and documented?",
      "asvs": "BSI IT-Grundschutz: SYS.1.1.A4 (Planning of server resources)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_General_Server_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Identifies client assets that connect to multiple distinct UCC services, indicating a risk of client-side resource contention between different UCC applications.",
      "riskAssessment": "Impact is medium because it typically affects a single user's client, but it can be higher for critical roles. Likelihood is high when a client is expected to run multiple UCC applications from different vendors.",
      "falsePositives": "A user may have multiple UCC applications installed but only run one at a time, or the client machine may have sufficient resources to handle them concurrently.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "18_sec8.ts",
      "bsiCode": "APP.5.4",
      "id": "uncontrolled-access-via-remote-control-feature",
      "title": "Uncontrolled Access via Remote-Control Feature (BSI APP.5.4, section 2.8)",
      "description": "UCC platforms often include a feature that allows a participant to take remote control of another user's desktop. Because this feature is used infrequently, many users are unfamiliar with it. They may accidentally accept a control request and not know how to revoke it, thereby losing control of their client device to another participant in the conversation.",
      "impact": "An attacker gaining remote control of a user's device constitutes a full compromise of that client, leading to elevation of privilege, information disclosure, and tampering with any data or systems accessible to that user.",
      "action": "Restrict or disable remote-control features and train users",
      "mitigation": "If the remote-control feature is not required for business purposes, disable it by default. If it is required, ensure the user interface for granting and revoking control is extremely clear and provides persistent, visible feedback. Train all users on the risks of this feature and how to use it safely.",
      "check": "Is the remote-control feature enabled in the UCC client? Is it necessary? Are users trained in its safe operation?",
      "asvs": "BSI IT-Grundschutz: CON.3 – Security awareness and training",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Security_awareness_and_training_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to any UCC client that offers a remote-control capability. The risk is raised against the client asset itself, as it is the component that would be compromised.",
      "riskAssessment": "The impact can be very high because it can lead to a full compromise of the client device. The likelihood is considered 'likely' because the feature is common and user unfamiliarity is a frequent issue.",
      "falsePositives": "The specific UCC product in use may not have this feature, or it may be disabled by a global policy not reflected in the model.",
      "cwe": "284",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "18_sec9.ts",
      "bsiCode": "APP.5.4",
      "id": "identity-spoofing-in-ucc",
      "title": "Identity Spoofing in UCC (BSI APP.5.4, 2.9)",
      "description": "Attackers can exploit UCC platforms for social engineering by impersonating trusted parties. Users may perceive UCC as a trusted internal platform and therefore be less suspicious of malicious links or requests. The risk increases when external users can contact internal users without strong authentication, and when attackers can manipulate display names, voice, or video.",
      "impact": "Identity spoofing can lead to significant information disclosure, credential theft, and financial fraud.",
      "action": "Strengthen authentication and implement anti-spoofing measures",
      "mitigation": "Require strong authentication for all users, especially those joining from external networks. Implement clear visual indicators in the UI to distinguish external participants from internal colleagues. Prevent users from setting display names that could be used for impersonation. Train users to stay vigilant against social engineering attacks over UCC channels.",
      "check": "Is strong authentication required for all participants, including external users? Are external users clearly identified in the UI? Are users trained on UCC-based social engineering tactics?",
      "asvs": "OWASP ASVS: Authentication verification requirements. BSI IT-Grundschutz: ORP.4.A4 (Identity and access management)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Detects communication links from an external entity to a UCC service. The risk is significantly higher if the communication channel lacks authentication, as this makes spoofing trivial.",
      "riskAssessment": "Impact is high if the UCC service handles sensitive data that could be exfiltrated via a social engineering attack. Likelihood is very high if unauthenticated external users can initiate contact with internal users.",
      "falsePositives": "The platform may have other anti-spoofing controls (e.g., email domain validation for guests) not captured in the authentication property of the communication link.",
      "cwe": "290",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "19_sec1.ts",
      "bsiCode": "APP.6",
      "id": "unsuitable-software-selection",
      "title": "Unsuitable Software Selection (based on BSI APP.6, Section 2.1)",
      "description": "Many different software solutions are available for various applications and purposes. If unsuitable software is selected that does not meet the organization's requirements, operations can be significantly disrupted. For example, data formats might be incompatible with existing programs, or new products may have insufficient functionality. This can lead to performance degradation, disruptions, or errors within business processes.",
      "impact": "Particularly if the software fails to meet the organization's security requirements, the data processed by it could be disclosed or tampered with. A common example is when the software's authentication mechanisms are not designed for the intended deployment environment, such as an open data network or the public internet. This can lead to unauthorized access (Elevation of Privilege), data breaches (Information Disclosure), and manipulation of critical information (Tampering).",
      "action": "Formalize Software Evaluation and Procurement",
      "mitigation": "Establish a formal software procurement and evaluation process. Define clear security requirements for all new software, based on the intended use case, deployment environment, and the sensitivity of the data it will handle. Before deployment, verify that the software meets these requirements, especially concerning authentication, access control, data encryption, and logging. For internet-facing systems or services handling sensitive data, ensure strong authentication is enforced on all exposed interfaces.",
      "check": "Is there a formal process for evaluating the security of new software? Are security requirements for authentication and access control verified before deployment? Are all communication links to sensitive components properly authenticated?",
      "asvs": "V4.0.3-2.1.1, V4.0.3-2.1.2, V4.0.3-4.1.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for technical assets that are targets of unauthenticated communication, especially when those links cross trust boundaries or originate from the internet. The rule identifies assets (like web applications, services, or databases) that lack authentication on incoming data flows, which is a sign of software being unsuitable for its deployment context.",
      "riskAssessment": "The impact is determined by the confidentiality and integrity requirements of the data processed or stored by the vulnerable asset. A higher data classification leads to a higher impact. The likelihood is considered higher for assets exposed to the internet compared to those only accessible on an internal network. The overall severity is a combination of this calculated impact and likelihood.",
      "falsePositives": "A risk might be a false positive if other compensating controls that are not modeled exist, such as a web application firewall (WAF) or a reverse proxy that enforces authentication before traffic reaches the target asset.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "19_sec2.ts",
      "bsiCode": "APP.6",
      "id": "misconfiguration-information-disclosure",
      "title": "Information Disclosure via Misconfigured Software (BSI APP.6)",
      "description": "If software is configured insecurely or with unnecessary features enabled, sensitive information can be unintentionally exposed.",
      "impact": "Disclosure of sensitive or personal data (e.g., @DataType:PII) can cause financial loss, regulatory penalties, and reputational damage,",
      "action": "Harden software configurations and disable unnecessary features",
      "mitigation": "Establish hardened baselines per component and vendor guidance; disable unnecessary services, features, and ports; apply least functionality and least privilege;",
      "check": "Are secure baselines defined and reviewed? Are unnecessary features/services disabled by default? Is configuration drift monitored with alerts?",
      "asvs": "BSI IT-Grundschutz APP.6 (esp. 2.2 Offenlegung durch fehlerhafte Konfiguration) and CON.1 A15 (Secure basic configuration); OWASP ASVS V19: Configuration.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_component_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule flags assets that are (1) data stores with confidentiality ≥ Restricted that communicate across a trust boundary, to the Internet, or to an ExternalEntity —",
      "riskAssessment": "Impact scales with the highest confidentiality and integrity of the affected asset. Likelihood increases for custom-developed parts and for assets with outbound links",
      "falsePositives": "Connections to external parties might be intentional and tightly controlled (e.g., encrypted managed replication, well-audited DLP-approved exports).",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "19_sec3.ts",
      "bsiCode": "APP.6",
      "id": "software-from-unreliable-sources",
      "title": "Software from Unreliable Sources (BSI CON.3.A13)",
      "description": "If software is obtained from unreliable sources, it cannot be guaranteed that an unchanged, original version is being used.",
      "impact": "Installing compromised software can impair the integrity and availability of IT systems, leading to system downtime, data corruption, or the execution of malicious functions.",
      "action": "Establish and Enforce Policies for Trusted Software Acquisition and Integrity Verification",
      "mitigation": "Define and enforce strict policies for software acquisition, permitting installations only from vetted, trustworthy sources (e.g., official vendor sites, curated internal artifact repositories).",
      "check": "Is there a defined policy for trusted software sources? Are all software components, including dependencies and libraries, sourced from verified locations? Is there a process to verify the integrity of new software before deployment (e.g., signature checking)? Is a secure software supply chain (e.g., CI/CD pipeline with an artifact registry) used for custom-developed components?",
      "asvs": "Derived from BSI IT-Grundschutz-Kompendium CON.3, Requirement A13 'Obtaining software from trustworthy sources'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Protection_against_malicious_programs_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for custom-developed technical assets that execute code but do not appear to be sourced from a controlled software supply chain.",
      "riskAssessment": "The likelihood is considered 'Likely' if no secure supply chain is modeled, as this indicates a lack of controls over how software and its dependencies are sourced and built.",
      "falsePositives": "The model may not fully represent the software supply chain. An organization might have strong offline processes for vetting and deploying software that are not modeled as explicit data flows. This risk should be confirmed by reviewing the actual software development, dependency management, and deployment processes.",
      "cwe": "829",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "19_sec4.ts",
      "bsiCode": "APP.6",
      "id": "@Maintenance:Unmaintained-dependencies",
      "title": "@Maintenance:Unmaintained Dependencies or Components",
      "description": "Security vulnerabilities and software weaknesses can be discovered throughout the software lifecycle. This can jeopardize the information security of the data processed with the software, for example by allowing login functions to be bypassed or encryption to be broken. Security vulnerabilities and weaknesses cannot be remedied in a timely manner if no suitable maintenance contract has been concluded with the manufacturer or supplier or if the software is simply used beyond the maintenance period. Violations of the license conditions can also lead to (auto-)update mechanisms being deactivated and the software therefore no longer being maintained.",
      "impact": "If @Maintenance:Unmaintained components with known vulnerabilities are used, attackers can exploit them to compromise the confidentiality, integrity, or availability of the entire system or the data processed by it. This can lead to a complete takeover of the component, data breaches, or denial of service.",
      "action": "Patch or Upgrade Vulnerable Component",
      "mitigation": "Establish a process for managing third-party and open-source components, including maintaining a complete inventory (e.g., a Software Bill of Materials (SBOM)). Use Software Composition Analysis (SCA) tools to regularly scan for known vulnerabilities in all dependencies. Ensure that all commercial software has an active maintenance and support contract. Components that are end-of-life (i.e., '@Maintenance:Unmaintained') must be replaced in a timely manner. The CI/CD pipeline should include automated checks to prevent the introduction of new vulnerable dependencies.",
      "check": "Are all third-party components and their versions inventoried? Is there an automated process (SCA) to scan for vulnerable dependencies? Is there a documented procedure for patching or replacing vulnerable or @Maintenance:Unmaintained components?",
      "asvs": "V14.2.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
      "detectionLogic": "This risk is automatically raised for any technical asset explicitly tagged '@Maintenance:Unmaintained'.",
      "riskAssessment": "The likelihood of exploitation is considered very high for any component that is no longer receiving security patches, as new vulnerabilities are constantly being discovered by researchers. If the component is exposed to the internet, the likelihood is considered frequent. The impact of successful exploitation depends directly on the sensitivity (Confidentiality, Integrity, and Availability) of the technical asset itself and the data assets it processes or stores.",
      "falsePositives": "This risk is based on the presence of the '@Maintenance:Unmaintained' tag. A false positive can occur only if this tag is applied to a component that is actually still maintained through a process not documented in the model.",
      "cwe": "1104 // Use of @Maintenance:Unmaintained Third Party Components",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "19_sec5.ts",
      "bsiCode": "APP.6",
      "id": "accidental-data-loss-or-corruption-by-misuse",
      "title": "Accidental Data Loss or Corruption by Software Misuse (BSI APP.6 – 2.5)",
      "description": "Incorrect or careless use of software can lead to unintended deletion, overwriting, or corruption of information.",
      "impact": "Integrity and Availability are primarily affected. Consequences include halted processes, recovery costs, loss of critical records, breach of business objectives, and—in regulated contexts—potential non-compliance.",
      "action": "Introduce safeguards to prevent accidental deletion/corruption and ensure robust recovery.",
      "mitigation": "Apply least-privilege permissions, confirmation dialogs for destructive actions, clear UI copy, and safe defaults. Provide undo/versioning where feasible. Train users on correct handling.",
      "check": "Are destructive actions confirmed and reversible? Are privileges constrained to the minimum needed? Are users trained? Do tested backups exist for stored/processed data?",
      "asvs": "Mapped to BSI APP.6 (section 2.5: Datenverlust durch fehlerhafte Nutzung von Software) and OPS.1.2.2 (Operating Personnel) for backup/restore responsibilities.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_Operating_personnel_edition_2023.pdf?__blob=publicationFile&v=2 (BSI OPS.1.2 reference)",
      "detectionLogic": "Raise when a non-out-of-scope technical asset is likely to be misused by humans AND handles sensitive availability/integrity or involves complex encryption.",
      "riskAssessment": "Likelihood is higher for custom-developed components due to potentially less mature UX and guardrails. Impact scales with the asset’s highest Integrity/Availability ratings:",
      "falsePositives": "May be a false positive if the application has exceptional error-prevention UX, strict read-only defaults, four-eyes (dual-control) on destructive actions,",
      "cwe": "284",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "19_sec6.ts",
      "bsiCode": "APP.6",
      "id": "insufficient-system-resources",
      "title": "Insufficient System Resources for Critical Operations (BSI CON.3.A5)",
      "description": "If IT systems have insufficient resources (e.g., CPU, memory, disk I/O) to execute the required software,",
      "impact": "A lack of system resources directly impacts service availability. This can render services unusable,",
      "action": "Implement Resource Monitoring and Capacity Planning",
      "mitigation": "Implement robust monitoring for key system resources (CPU, memory, disk space, network bandwidth).",
      "check": "Are key system resources being monitored? Is there a capacity plan? Is the asset configured to be redundant or to auto-scale?",
      "asvs": "ASVS V14.1.1: Verify the application or system is able to handle requests and gracefully fail when under a denial of service attack.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
      "detectionLogic": "This rule identifies technical assets that have a high or critical availability requirement but are not modeled as redundant.",
      "riskAssessment": "The impact is derived directly from the availability rating of the technical asset.",
      "falsePositives": "The model may not capture all forms of redundancy. For example, an asset might be part of an external high-availability cluster,",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "19_sec7.ts",
      "bsiCode": "APP.6",
      "id": "poor-usability-leads-to-shadow-it",
      "title": "Poor Usability Leading to Shadow IT",
      "description": "If software fulfills its functional requirements but is awkward or complicated to use, it may not be accepted by users.",
      "impact": "When users create insecure workarounds due to poor usability, it can lead to data exfiltration to uncontrolled environments (e.g., private laptops, public cloud services),",
      "action": "Improve application usability and prohibit unsanctioned workarounds",
      "mitigation": "Involve end-users in the design and testing phases of an application to ensure high usability (UX/UI).",
      "check": "Was formal usability testing conducted with target users? Is there a feedback channel for user experience issues?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (General Client), Requirement CON.1.A23 (Use of private IT equipment).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_client_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for technical assets that are explicitly tagged as having poor usability (`@Usability:Poor`).",
      "riskAssessment": "The impact is determined by the sensitivity of the data processed by the poorly usable application. If users export 'Strictly Confidential' data to an",
      "falsePositives": "A system might be complex but have well-trained users who do not resort to workarounds. This risk is best validated by",
      "cwe": "200",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "1_sec1.ts",
      "bsiCode": "APP.1.1",
      "id": "inadequate-office-product-procurement",
      "title": "Inadequate Office Product Procurement & Adaptation",
      "description": "If office products are procured or adapted without a documented requirements baseline, operations may be disrupted: existing templates and documents can become incompatible, integrations with partner systems may fail, and performance or usability can degrade. Tailoring the software to institutional needs is essential to avoid process interruptions and errors.",
      "impact": "Primary impact on Integrity and Availability due to broken processes, incompatible formats, or workflow failures; secondary impact on Confidentiality may occur when documents are mishandled across boundaries.",
      "action": "Introduce and enforce a formal software requirements and procurement process for office products.",
      "mitigation": "Define a repeatable procurement process including requirements elicitation (functional, interoperability, template/format compatibility), non-functional criteria (performance, usability), and integration checks. Pilot on representative workloads and validate against existing macros/templates before rollout.",
      "check": "Is there a documented procurement and adaptation process? Does it verify compatibility with existing assets and partner systems? Are pilot tests and performance/usability checks executed before deployment?",
      "asvs": "Grounded in BSI IT-Grundschutz APP.1.1 Office-Produkte; related to APP.4.4 Allgemeine Anwendungssoftware and modern application lifecycle practices.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_General_applications_Edition_2023.pdf?__blob=publicationFile (BSI APP.4 General Applications)",
      "detectionLogic": "Multi-signal scoring: office context tags, acceptance of document-like formats, communication across trust boundaries (and whether internet-facing), presence of document/‘doc-ish’ protocols, data transfer on links, VDI/terminal-server hints, and macro indicators. OT/ICS assets are hard-excluded. Email-only stacks are explicitly set to ‘Unlikely’ regardless of score. Assets meeting the minimum score threshold are flagged.",
      "riskAssessment": "Likelihood is derived from the evidence score. Impact is mapped from the asset’s highest Availability/Integrity ratings and is increased when StrictlyConfidential data traverses a network trust boundary. Mission-critical processes raise impact to VeryHigh.",
      "falsePositives": "May be reduced (but not eliminated) where a robust procurement/test process exists. Assets tagged ‘procurement-process-followed’ receive a lower score. Confirmation should involve architecture and procurement owners.",
      "cwe": "770",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "1_sec2.ts",
      "bsiCode": "APP.1.1",
      "id": "malicious-content-in-office-documents",
      "title": "Malicious Content in Office Documents",
      "description": "Office documents can contain active content or macros that are useful for automation but can also conceal malicious code.",
      "impact": "Successful exploitation can lead to data tampering, information disclosure, and system compromise. This can disrupt business functions,",
      "action": "Implement content security for document processing",
      "mitigation": "Disable active content (e.g., macros) in Office documents by default, especially for documents from untrusted sources.",
      "check": "Is active content disabled by default for incoming documents? Are all processed files scanned for malware?",
      "asvs": "BSI IT-Grundschutz: CON.3 Malware protection; APP.4.4 Filtering of data and information.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Malware_protection_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "Identifies technical assets that are configured to accept file-based data formats and use technology types that commonly process",
      "riskAssessment": "The likelihood is considered higher for internet-facing assets that directly receive files from external sources.",
      "falsePositives": "This risk might be a false positive if the asset, despite accepting files, has other effective, non-modeled mitigations in place,",
      "cwe": "434",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "1_sec3.ts",
      "bsiCode": "APP.1.1",
      "id": "unauthorized-modification-of-office-documents",
      "title": "Unauthorized Modification of Office Documents (aligned with BSI APP.1.1, Section 2.3)",
      "description": "The integrity of documents (such as Office files, PDFs, etc.) can be compromised through unintentional or intentional content changes.",
      "impact": "If business processes rely on, or decisions are based on, undetected falsified documents, it can lead to incorrect strategic outcomes, process failures, financial loss, and significant reputational damage to the organization.",
      "action": "Implement and Enforce Document Integrity Controls",
      "mitigation": "Use technical mechanisms such as digital signatures to ensure document integrity and authenticity.",
      "check": "Are digital signatures or similar integrity mechanisms used for critical documents? Are file permissions on storage systems appropriately restricted to prevent unauthorized modifications? Is user awareness training conducted on this topic? Is a FIM solution in place?",
      "asvs": "BSI IT-Grundschutz Baustein APP.1.1 Office-Produkte, Abschnitt 2.3 (Integritätsverlust von Office-Dokumenten)",
      "cheatSheet": "BSI IT-Grundschutz Kompendium – APP.1.1 Office-Produkte (Edition 2023)",
      "detectionLogic": "This risk is raised for in-scope technical assets of type Datastore or Process that accept file-based data (`DataFormat.File`) and are responsible for data assets with 'important', 'critical', or 'mission-critical' integrity requirements.",
      "riskAssessment": "The impact of this risk is derived directly from the integrity requirement of the data being handled ('important' -> Medium, 'critical' -> High, 'mission-critical' -> Very High).",
      "falsePositives": "This risk might be a false positive if the handled files are not business-critical (e.g., temporary log files) despite a high integrity rating, or if robust compensating controls exist that are not explicitly modeled (e.g., a separate, secure document management system).",
      "cwe": "353",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "20_sec1.ts",
      "bsiCode": "APP.7",
      "id": "inadequate-contractual-agreements-with-service-providers",
      "title": "Inadequate or Missing Contractual Security Requirements for External Service Providers",
      "description": "If contracts with external service providers (ESPs) lack clear, enforceable information-security clauses, responsibilities, and performance parameters, essential safeguards may be overlooked or under-implemented. This is especially risky when ESPs develop, integrate, or maintain systems that process sensitive data or underpin critical business services.",
      "impact": "Weak or ambiguous supplier contracts can lead to non-compliance with laws and regulations, data protection violations, unclear accountability, and insufficient auditability. Consequences include confidentiality breaches, integrity loss, service outages, financial penalties, and reputational damage.",
      "action": "Define, contract, and verify security requirements for all external providers handling your data or systems.",
      "mitigation": "Ensure every ESP contract specifies: security responsibilities and SLAs; data handling and protection (incl. personal data/PII); secure development and change control; incident reporting/notification timelines; vulnerability management and patch SLAs; right-to-audit and evidence provision; sub-processor controls; data location and sovereignty; exit/transition assistance (e.g., escrow); and compliance with relevant standards and laws.",
      "check": "Before signing, do security/legal review of ESP contracts. Do they include explicit clauses for information security, data protection, incident response, vulnerability/patch SLAs, audit rights, and subcontractor control? Is there a documented supplier risk assessment and continuous monitoring process?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Supplier Relationship Management), specifically requirement CON.1.A4 (Determining information security requirements for supplier relationships).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Supplier_relationship_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
      "detectionLogic": "Auto-detected when a Technical Asset represents an external entity (type = ExternalEntity) or is tagged with @ExternalServiceProvider. Impact is derived from the highest CIA ratings of data the provider processes or stores. If the provider is multi-tenant, the model increases the impact. The rule also highlights the most sensitive referenced data asset to aid review.",
      "riskAssessment": "Likelihood defaults to Likely (governance gaps are common). Impact scales with the sensitivity and criticality of processed/stored data: Restricted/Important ⇒ Medium, Confidential/Critical ⇒ High, StrictlyConfidential/MissionCritical ⇒ VeryHigh. Multi-tenant providers bump impact one level up to a maximum of VeryHigh. Overall severity is CalculateSeverity(Likely, Impact).",
      "falsePositives": "Flagging can occur even if contracts are robust—this is by design to prompt verification. Mark as 'mitigated' or 'accepted' if strong contractual controls (incl. audit evidence) are confirmed.",
      "cwe": "284",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "20_sec2.ts",
      "bsiCode": "APP.7",
      "id": "conceptual-flaws-from-component-reuse",
      "title": "Conceptual Flaws from Component Reuse (BSI APP.2.2)",
      "description": "When applications, programs, and protocols are designed, security-relevant conceptual flaws can arise.",
      "impact": "Reusing components in an unintended security context can bypass fundamental security assumptions, leading to vulnerabilities.",
      "action": "Review and Harden Reused Components for New Deployment Contexts",
      "mitigation": "Ensure that any component reused in a new security context (e.g., exposing an internal service to the internet) undergoes a thorough security review and threat model update.",
      "check": "Is there a formal review process for components when their deployment context changes?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.2 (Webanwendungen). This risk addresses fundamental architectural design flaws.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_2_Web_applications_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is detected by identifying communication links from internet-facing technical assets to assets that are not internet-facing,",
      "riskAssessment": "The impact is determined by the Confidentiality, Integrity, and Availability (CIA) rating of the internal component being exposed.",
      "falsePositives": "A risk might be flagged if a connection is heavily restricted by other means not fully captured in the model (e.g., strict network ACLs, mTLS with short-lived certificates).",
      "cwe": "501",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "20_sec3.ts",
      "bsiCode": "APP.7",
      "id": "undocumented-functions",
      "title": "Undocumented Functions (Backdoors)",
      "description": "Many applications contain undocumented functions built in by the manufacturer, often for development or support purposes. These are usually unknown to users and are not part of the official documentation.",
      "impact": "If these functions allow bypassing essential security mechanisms, such as access control, the confidentiality, integrity, and availability of processed data can be significantly compromised. This can lead to unauthorized access, data manipulation, or service disruption.",
      "action": "Code Review, Component Analysis, and Penetration Testing",
      "mitigation": "Thoroughly review and test all custom-developed or third-party components for undocumented features. This includes static and dynamic code analysis (SAST/DAST) and penetration testing specifically targeting backdoors or hidden administrative interfaces. For third-party software, require vendors to document all features, including those intended for support and maintenance. Implement strong network segmentation and monitoring to limit the impact and increase the chance of detection if such a function is discovered and exploited.",
      "check": "Is there a process for reviewing third-party and custom-developed code for hidden functionality? Has the application undergone penetration testing that includes searching for backdoors? Do vendor contracts require full disclosure of all application features, including diagnostic and support endpoints?",
      "asvs": "V14.2.1: Verify that the application does not contain any backdoors or other intentionally malicious code.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk applies to technical assets that are custom-developed or contain custom-developed parts, as indicated by the `custom_developed_parts` flag. The presence of custom code increases the likelihood that undocumented features, whether intentional or accidental, might exist.",
      "riskAssessment": "The likelihood is higher for complex, custom-developed systems, especially those with a long history or multiple development teams. The impact is directly proportional to the CIA rating of the asset and the data it processes or stores. A backdoor in a system handling 'Strictly Confidential' data is a critical risk.",
      "falsePositives": "The risk might be a false positive if the custom-developed parts have been rigorously vetted and tested, and no such features were found. The `custom_developed_parts` flag is a strong indicator of potential risk but not definitive proof of a backdoor. This risk should be verified through targeted security testing.",
      "cwe": "912",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "20_sec4.ts",
      "bsiCode": "APP.7",
      "id": "weak-or-missing-security-controls",
      "title": "Weak or Missing Security Controls (BSI CON.2)",
      "description": "Security mechanisms or functions within an application are intended to ensure that the confidentiality, integrity, and availability of information are guaranteed to the required extent during processing.",
      "impact": "If critical security controls are weak or absent, they cannot adequately protect information and systems. This can lead to unauthorized access, data manipulation, information disclosure, or denial of service.",
      "action": "Implement Security by Design and Defense-in-Depth",
      "mitigation": "For all custom-developed components, ensure that security is a core requirement throughout the development lifecycle.",
      "check": "Are all communication links carrying sensitive data across trust boundaries encrypted?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.2 (Software development and manufacturing), Requirement CON.2.A5 (Security by Design in software development).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_2_Software_development_and_manufacturing_edition_2023.pdf?__blob=publicationFile (BSI CON.2)",
      "detectionLogic": "This risk is raised for custom-developed technical assets that have incoming communication links with weak or missing security controls.",
      "riskAssessment": "The impact is determined by the highest CIA requirement of the data assets transferred over the insecure communication link or processed by the target asset.",
      "falsePositives": "This risk might be a false positive if there are other compensating controls that are not modeled, such as a Web Application Firewall (WAF) or an API Gateway that terminates TLS and handles authentication centrally.",
      "cwe": "693",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "20_sec5.ts",
      "bsiCode": "APP.7",
      "id": "insufficient-development-control",
      "title": "Insufficient Control of Custom Software Development",
      "description": "If software development is not adequately controlled and directed by the commissioning party,",
      "impact": "Missing, weak, or improperly prioritized security functions in custom-developed software can lead to a wide range of vulnerabilities,",
      "action": "Establish Clear Security Requirements and Governance for Development Projects",
      "mitigation": "The client must define clear and testable security requirements before and during the development of custom software.",
      "check": "Are there documented security requirements for this custom component? Is there a defined process for project governance involving the client/product owner?",
      "asvs": "ASVS V1.1 (Architecture, Design and Threat Modeling Requirements), ASVS V1.3 (Architecture and Design Requirements)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for any in-scope technical asset marked as having 'custom developed parts'.",
      "riskAssessment": "The likelihood is considered 'Likely' as a baseline for any custom-developed software, as process deficiencies are common.",
      "falsePositives": "This risk can be a false positive if the custom software was developed under a strong, security-aware governance model",
      "cwe": "284",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "20_sec6.ts",
      "bsiCode": "APP.7",
      "id": "inadequate-developer-expertise",
      "title": "Inadequate Developer Expertise or Resources",
      "description": "Commissioning unsuitable software developers can lead to various threats. A lack of technical expertise",
      "impact": "If developers lack the required security expertise or resources, it can lead to the introduction of critical vulnerabilities.",
      "action": "Ensure Developer Suitability and Enforce Secure Development Practices",
      "mitigation": "Vet developers for the required technical and security expertise before and during projects.",
      "check": "Is there a formal process for vetting developer skills, including security? Is a Secure SDLC documented and followed?",
      "asvs": "Derived from BSI IT-Grundschutz CON.1 (General Software Development and Acquisition). Also relates to OWASP Top 10 A05:2021 - Security Misconfiguration and general secure coding practices.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_software_development_and_acquisition_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all in-scope technical assets marked as having 'custom developed parts'.",
      "riskAssessment": "The impact of this risk is determined by the Confidentiality, Integrity, and Availability (CIA) requirements of the technical asset and the data it handles.",
      "falsePositives": "This risk might be a false positive if the development team has proven, strong security expertise and follows a robust Secure SDLC,",
      "cwe": "284",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "21_sec1.ts",
      "bsiCode": "CON.10",
      "id": "flawed-authorization-in-web-applications",
      "title": "Flawed Authorization in Web Applications (BSI-based)",
      "description": "In an attack, attempts are often made to access functions or data of web applications that are only available with specific access rights.",
      "impact": "If authorization checks are missing or flawed, attackers can elevate their privileges, leading to unauthorized access to sensitive data and critical functionalities.",
      "action": "Implement and Enforce Correct Authorization Logic",
      "mitigation": "Ensure that every request to a protected resource on the server-side re-validates the user's authorization and permissions.",
      "check": "Are server-side authorization checks performed for every request to a protected resource? Is it possible to bypass these checks by manipulating request parameters, URLs, or headers?",
      "asvs": "V4.1: Verify that the application enforces access control rules on each request from a client, and that it does not expose any sensitive data or functionality to unauthorized users.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is identified for web-facing assets (like Web Applications, Web Services) that have incoming communication links with no authorization mechanism specified (`authorization: 'none'`).",
      "riskAssessment": "The impact is determined by the highest confidentiality and integrity rating of the data processed or stored by the web application.",
      "falsePositives": "A risk might be a false positive if the endpoint is intentionally public (e.g., a login page or a public-facing API with no sensitive data).",
      "cwe": "285",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "21_sec2.ts",
      "bsiCode": "CON.10",
      "id": "improper-input-validation-and-output-encoding-bsi-app-4-a7",
      "title": "Improper Input Validation and Output Encoding (XSS) (BSI APP.4.A7)",
      "description": "If a web application processes unvalidated input data, protective mechanisms can be bypassed. This risk increases if, at the same time, the output data of the web application is transmitted without sufficient encoding directly to the web browser, the calling application, or downstream IT systems. Such output data can contain malicious code (e.g., JavaScript) that is then interpreted or executed on the target systems, leading to a Cross-Site Scripting (XSS) attack.",
      "impact": "Successful exploitation can lead to the execution of unauthorized scripts in a user's browser, enabling session hijacking, theft of sensitive information (e.g., credentials, personal data), website defacement, or redirection to malicious sites. If the tainted data is consumed by other backend systems, it could lead to further compromise.",
      "action": "Implement Robust Input Validation and Context-Aware Output Encoding",
      "mitigation": "All input data must be validated against a strict allow-list of expected characters, formats, and lengths. Crucially, all data must be encoded immediately before being rendered in the output, using a context-aware approach (e.g., for HTML bodies, HTML attributes, JavaScript, CSS, or URLs). Use standard, trusted libraries for encoding. Implement a strong Content Security Policy (CSP) as a defense-in-depth measure to restrict the execution of untrusted scripts.",
      "check": "Are all user-supplied inputs validated against a strict allow-list? Is context-aware output encoding applied to all data before it is rendered in the browser or sent to other systems? Is a Content Security Policy (CSP) in place?",
      "asvs": "OWASP ASVS V4.0.3: 5.1 Input Validation, 5.2 Sanitization and Sandboxing, 5.3 Output Encoding and Injection Prevention",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for web applications or web services, especially those with custom-developed parts, that receive data and then send data to a client-side component (like a browser). The risk is considered present unless the asset is explicitly tagged as having both input validation and output encoding controls.",
      "riskAssessment": "The likelihood is high for internet-facing, custom-developed applications. The impact is determined by the sensitivity (Confidentiality and Integrity) of the data being transferred over the affected communication link. An attack on a system handling strictly confidential data or enabling critical operations will have a high impact.",
      "falsePositives": "This risk can be a false positive if the application employs effective input validation and output encoding, but this is not reflected by tags in the model.",
      "cwe": "79",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "21_sec3.ts",
      "bsiCode": "CON.10",
      "id": "improper-error-handling-web-app",
      "title": "Improper Error Handling in Web Application",
      "description": "If errors that occur during the operation of a web application are not handled correctly, both the operation of the web application and the protection of its functions and data can be impaired. For example, an error can cause the web application to no longer run correctly and become unreachable for clients. In addition, actions may be performed only partially, cached actions and data may be lost, or security mechanisms may fail.",
      "impact": "Improper error handling can lead to various security threats. Verbose error messages can leak sensitive system information (Information Disclosure). An unhandled exception might cause a Denial of Service. If an application fails to a non-secure state, it might allow for bypassing security controls (Elevation of Privilege) or data corruption (Tampering).",
      "action": "Implement Robust and Secure Error Handling",
      "mitigation": "Implement a centralized and robust error handling mechanism for the entire application. All exceptions should be caught and handled gracefully. Ensure that user-facing error messages are generic and do not reveal any internal system details, stack traces, or database errors. Log detailed error information securely on the server-side for debugging and analysis. The application should fail to a secure state, preventing any potential bypass of security controls.",
      "check": "Review the source code for consistent use of try-catch blocks or a global exception handler. Check that user-facing error pages are generic. Trigger errors in the application to verify that no sensitive information is leaked in the HTTP response. Ensure that the application remains in a secure and consistent state after an error occurs.",
      "asvs": "V7.1.1: Verify that all application components handle errors and exceptions in a way that preserves the security and integrity of the application, including by not revealing sensitive information in error responses.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html",
      "detectionLogic": "This risk is automatically identified for all in-scope, custom-developed technical assets that are web applications, web servers, or web services. The use of custom code significantly increases the likelihood of programming flaws such as improper error handling.",
      "riskAssessment": "The likelihood of this risk is considered high for any custom-developed web component, as error handling is a common area for mistakes. The impact depends directly on the CIA requirements of the asset and the data it processes. A failure in an application handling 'Strictly Confidential' data has a much higher impact than one handling 'Public' data. The failure of security mechanisms as a consequence can also lead to very high impacts.",
      "falsePositives": "This risk can be considered a false positive if the development team can demonstrate a mature, consistently applied, and secure error handling framework that is used throughout the entire application.",
      "cwe": "755",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "21_sec4.ts",
      "bsiCode": "CON.10",
      "id": "insufficient-logging-in-web-application",
      "title": "Insufficient Logging in Web Application (based on BSI)",
      "description": "If security-relevant events are not sufficiently logged by a web application, it becomes difficult or impossible to reconstruct security incidents later. The root cause of an incident may no longer be determinable. For example, configuration errors can be overlooked if they do not result in error messages in the log files. Vulnerabilities are also difficult or impossible to detect and fix with inadequate logging.",
      "impact": "Lack of proper logging prevents or hinders incident response, forensic analysis, and effective auditing. It allows attackers to operate with a lower chance of detection, cover their tracks more easily, and makes it difficult to assess the scope of a compromise. This can lead to prolonged system compromises, undetected data breaches, and failure to meet compliance requirements for auditing and accountability.",
      "action": "Implement Comprehensive and Structured Security Logging",
      "mitigation": "Ensure the web application logs all security-relevant events, including authentication attempts (success and failure), access control decisions, significant server-side errors, session management events, and input validation failures. Logs should be in a structured format (e.g., JSON), include sufficient context (timestamps, source IP, user ID, event correlation ID), and be protected from unauthorized access or modification. It is best practice to forward logs to a centralized and secured log management system for aggregation, monitoring, and alerting.",
      "check": "Review the application's source code and configuration to verify which events are being logged. Inspect the running application's logs during security testing to confirm that events are captured as expected. Check if a centralized logging solution (e.g., a 'Monitoring' asset) receives logs from this component.",
      "asvs": "OWASP ASVS V7: Error Handling and Logging",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for all in-scope technical assets identified as web applications or web services (e.g., using technologies like 'web-application', 'web-server', 'web-service-rest'). The risk is heightened for custom-developed parts. Its severity increases based on the sensitivity (CIA ratings) of the asset and the data it handles. The check assumes that without an explicitly modeled and connected logging system, logging is likely insufficient by default.",
      "riskAssessment": "The likelihood is considered higher for custom-developed applications, as comprehensive logging is often an overlooked requirement. The impact is directly related to the confidentiality and integrity requirements of the data processed or stored by the application. An application handling 'Strictly Confidential' data with poor logging capabilities represents a much higher impact than one handling only 'Public' data, as a potential breach cannot be properly investigated.",
      "falsePositives": "This risk might be a false positive if a robust, centralized logging mechanism is in place and collects logs from the asset but is not explicitly modeled as a `Monitoring` or `IDS`/`IPS` asset with a communication link from the web application. This generic risk should always be verified against the actual implementation details.",
      "cwe": "778",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "21_sec5.ts",
      "bsiCode": "CON.10",
      "id": "information-leakage-via-web-application",
      "title": "Information Leakage of Technical Details via a Web Application",
      "description": "Websites and data generated and delivered by a web application may contain information about backend systems,",
      "impact": "If an attacker learns about the specific technologies and versions used by the web application, they can more easily find and exploit known vulnerabilities.",
      "action": "Configure the Web Server and Application to Prevent Information Leakage",
      "mitigation": "Configure the web server and application framework to avoid disclosing specific software versions and other technical details.",
      "check": "Are HTTP response headers sanitized to remove version information? Do error messages avoid showing technical details like stack traces or internal server data?",
      "asvs": "V6.2.5 (ASVS 4.0.3), V14.2.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html",
      "detectionLogic": "This risk is automatically checked for all in-scope technical assets of type Web Server, Web Application, Application Server, or Web Service (REST/SOAP).",
      "riskAssessment": "The likelihood is considered 'Likely' as many frameworks and servers expose this information by default.",
      "falsePositives": "This might be a false positive if a security control in front of the application (like a WAF or a reverse proxy) is configured to strip this information from all responses.",
      "cwe": "200",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "21_sec6.ts",
      "bsiCode": "CON.10",
      "id": "automated-threats-against-web-application",
      "title": "Automated Threats against Web Applications (based on BSI APP.3.1)",
      "description": "When web application functions are used in an automated fashion, numerous operations can be executed in a short amount of time.",
      "impact": "A lack of protection against automated attacks can lead to account takeovers (via brute-force), sensitive data disclosure (via enumeration),",
      "action": "Implement Protection Against Automated and High-Frequency Attacks",
      "mitigation": "Implement technical controls to detect and block automated attacks. This includes rate-limiting on sensitive endpoints (e.g., login, search, API calls),",
      "check": "Are there mechanisms like rate limiting, CAPTCHAs, or temporary account lockouts on sensitive functions (login, password reset, complex searches)?",
      "asvs": "BSI IT-Grundschutz APP.3.1 (Web Applications), particularly A11 (Hardening), A17 (Protection against DoS), and A19 (Error Handling). Also relates to OWASP ASVS V4.3 (Authentication) and V10.4 (Availability).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Blocking_Brute_Force_Attacks_Cheat_Sheet.html",
      "detectionLogic": "This risk applies to internet-facing technical assets that are web applications or web services.",
      "riskAssessment": "The likelihood is considered high for any public-facing web application lacking these protections. The impact is determined by the CIA rating of the asset.",
      "falsePositives": "This risk can be a false positive if automated attack protection is implemented by an underlying component (e.g., a WAF, API Gateway, or Cloud Armor/Shield)",
      "cwe": "770",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "21_sec7.ts",
      "bsiCode": "CON.10",
      "id": "insufficient-session-management",
      "title": "Insufficient Session Management",
      "description": "Insufficient session management can allow an attacker, without special access rights, to determine the session ID of an account with extensive privileges. This ID can then be used to access protected functions and resources of the web application, for example, in a session fixation attack. In such an attack, an attacker first obtains a session ID with limited rights from the web application. This ID is then sent to a higher-privileged user, for example, via a link in an email. If the higher-privileged user follows this link and authenticates to the web application under that session ID, the attacker can subsequently use the application with the full access rights of the legitimate account.",
      "impact": "If an attacker successfully takes over a legitimate user's session (session hijacking), they can perform all actions and access all data that the user is authorized for. This can lead to unauthorized data disclosure, modification, or deletion, as well as fraudulent transactions, depending on the compromised account's privileges. This constitutes a full elevation of privilege to the victim's level.",
      "action": "Strengthen Session Management Mechanisms",
      "mitigation": "Implement robust session management. Key measures include: 1. Generating a new, high-entropy session ID upon successful user authentication to prevent session fixation. 2. Invalidating the session ID after logout or a reasonable period of inactivity. 3. Using the `Secure` and `HttpOnly` flags for session cookies. 4. Avoid exposing session IDs in URLs. 5. Implementing strict timeout mechanisms for all sessions.",
      "check": "Review the application's authentication and session handling logic. Does the application issue a new session token after a user logs in? Are session tokens transmitted securely over encrypted channels and protected from client-side script access (HttpOnly)? Are sessions properly invalidated on logout and timeout?",
      "asvs": "V3 Session Management, especially V3.3.1 and V3.4.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html",
      "detectionLogic": "This risk is generated for technical assets identified as web applications or services. It triggers when an incoming communication link from a client-like asset (e.g., Browser) uses session-based authentication ('session-id' or 'token'). The model assumes that without explicit countermeasures (which cannot be modeled), a risk of session fixation exists, as the framework cannot verify if the application correctly regenerates session IDs upon login.",
      "riskAssessment": "The likelihood is considered 'Likely' for custom-developed applications where secure session handling might be overlooked. The impact is directly proportional to the sensitivity of the data assets processed and the privileges of the users who authenticate. Hijacking an administrator's session on a system handling 'Strictly Confidential' data results in a 'Very High' impact.",
      "falsePositives": "The risk can be considered a false positive if the application correctly implements session management best practices (e.g., renewing session IDs after successful authentication). This cannot be verified from the architectural model alone and requires a code review or a dynamic application security test (DAST).",
      "cwe": "384",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "22_sec1.ts",
      "bsiCode": "CON.11.1",
      "id": "unauthorized-disclosure-of-classified-information",
      "title": "Unauthorized Disclosure of Classified Information (VS-NfD / Geheimschutz)",
      "description": "A significant threat to classified information (German: 'Verschlusssache' or 'VS') is unauthorized access or disclosure. This can occur when the governing security regulations (e.g., 'Verschlusssachenanweisung' - VSA) are not followed.",
      "impact": "If classified information is disclosed to unauthorized parties, it can be harmful to the organization or the state. Leaked information (e.g., network plans, security concepts) can be exploited to facilitate further intrusions.",
      "action": "Enforce Data-at-Rest Encryption and Secure Data Handling on Non-Ephemeral Systems",
      "mitigation": "Ensure all assets storing classified data (equivalent to 'Confidential' or 'Strictly-Confidential') use data-at-rest encryption (i.e., set the asset's `encryption` property to `transparent` or a data-level encryption style).",
      "check": "Are all datastores handling 'Confidential' or 'Strictly-Confidential' data configured with an `encryption` style other than `none`?",
      "asvs": "OWASP ASVS V4.0.3: 6.2.2 (Data-at-rest encryption) and 6.2.5 (Securely purge temporary files)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for technical assets that handle highly sensitive data without adequate built-in protection mechanisms modeled in Threagile.",
      "riskAssessment": "The impact is derived directly from the confidentiality level of the affected data asset ('High' for 'Confidential', 'Very High' for 'Strictly-Confidential').",
      "falsePositives": "The risk might be a false positive if there are compensating controls not modeled in Threagile, such as mandatory OS-level full-disk encryption on all servers, which would mitigate the 'unencrypted at rest' scenario. This must be verified outside the model.",
      "cwe": "312",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "22_sec2.ts",
      "bsiCode": "CON.11.1",
      "id": "covert-espionage-attack-bsi",
      "title": "Covert Espionage Attack (Konspirativer Angriff)",
      "description": "A covert espionage attack is a form of espionage where information is secretly obtained from non-public sources by foreign intelligence services, organized crime, or other sophisticated attackers. The primary goal is to remain undetected while accessing valuable or classified information, often by exploiting technical vulnerabilities (like backdoors or malware) or using human sources (social engineering).",
      "impact": "If successful, attackers can access sensitive or classified information, gaining a strategic, financial, or political advantage. This can lead to severe reputational damage, financial loss, and compromise of national or corporate security. It represents a critical breach of confidentiality.",
      "action": "Implement Layered, Defense-in-Depth Security for High-Value Assets",
      "mitigation": "Protect high-value assets through multiple layers of security. This includes strict network segmentation to create highly secured zones, enforcing the principle of least privilege and need-to-know for access control, and using strong encryption for data at rest and in transit. Implement advanced monitoring and anomaly detection, especially for data exfiltration patterns. All systems must be hardened, and a rigorous vulnerability management and patching process must be in place. Personnel security, including awareness training against social engineering, is also crucial.",
      "check": "Are high-value data and the assets processing it clearly identified? Are these assets isolated in dedicated, hardened security zones? Is access to these assets and data strictly limited and monitored? Is all communication involving these assets encrypted? Is there an advanced threat detection and response capability (e.g., a SOC) monitoring these assets?",
      "asvs": "This describes a general threat ('Gefährdung') from the BSI context, not a specific control. It relates to protecting high-value assets against advanced persistent threats (APTs).",
      "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Unternehmen-und-Organisationen/Informationen-und-Empfehlungen/Lageberichte/lageberichte_node.html",
      "detectionLogic": "This risk is raised for any technical asset that processes or stores highly sensitive data (Confidential or Strictly Confidential). The likelihood of the risk is increased if the asset is exposed to less trusted environments, such as being directly internet-facing or receiving unencrypted traffic from other zones.",
      "riskAssessment": "The impact is directly derived from the confidentiality level of the data processed or stored by the asset. The likelihood is considered 'Likely' for any such high-value target and increases to 'Very Likely' if aggravating factors like internet exposure exist. These attackers are assumed to be skilled and motivated.",
      "falsePositives": "The model might not be aware of advanced, non-technical, or out-of-band security controls like physical air-gapping, 24/7 human-led security operations center (SOC) monitoring, or counter-intelligence programs that could significantly mitigate this threat.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "22_sec3.ts",
      "bsiCode": "CON.11.1",
      "id": "insider-threat-theft-of-classified-information",
      "title": "Insider Threat: Theft of Classified Information (BSI-Gefährdung: Insider)",
      "description": "Malicious insiders (internal or external employees with legitimate access) intentionally steal confidential or classified information. These individuals possess extensive knowledge of internal processes and have authorized access rights, which they can abuse to increase the likelihood of a successful attack. They may also time their attacks to coincide with periods of low monitoring, such as maintenance windows, to avoid detection.",
      "impact": "Successful theft of information by an insider leads to unauthorized third parties gaining access to sensitive or classified data. This can result in severe damage to the organization, including financial loss, reputational harm, loss of competitive advantage, and potential legal or regulatory penalties. For government entities, it can be detrimental to national interests.",
      "action": "Implement Layered Defense, Monitoring, and Access Control for Insider Threats",
      "mitigation": "Mitigation requires a multi-layered approach. Enforce the Principle of Least Privilege (PoLP) and Separation of Duties (SoD) to limit the potential scope of damage. Implement comprehensive logging and monitoring of access to critical assets and sensitive data, utilizing anomaly detection (e.g., UEBA) to identify suspicious behavior. Employ Data Loss Prevention (DLP) solutions to control data exfiltration channels. Conduct regular access reviews to ensure permissions are current and necessary. The 'four-eyes principle' should be applied to critical administrative tasks.",
      "check": "Are the principles of least privilege and separation of duties strictly enforced? Is all access to sensitive data and systems logged and regularly audited? Are there anomaly detection or UEBA systems in place? Is there a DLP solution? Are user access rights reviewed periodically?",
      "asvs": "BSI ORP.4 (Identity and Access Management), OPS.1.1.5 (Logging); OWASP ASVS V1.4 (Access Control - Least Privilege), V7.1 (Logging and Monitoring)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is generated for any technical asset that processes or stores data with a Confidentiality rating of 'Confidential' or 'Strictly Confidential'. The presence of authorized access to such high-value data inherently creates an opportunity for malicious insider activity. The risk is elevated for assets with a high number of incoming data flows, as this can increase the number of potential insiders with legitimate access.",
      "riskAssessment": "The impact is directly derived from the confidentiality rating of the data at risk ('High' for Confidential, 'Very High' for Strictly Confidential). The likelihood is considered 'Likely' by default due to the inherent difficulty in preventing abuse of legitimate access, and can be elevated if many users or systems have access.",
      "falsePositives": "This risk can be considered a false positive or accepted if comprehensive, specific insider threat countermeasures (like dedicated User and Entity Behavior Analytics (UEBA), robust DLP, and strict, audited PoLP) are in place for the identified asset and are confirmed to be effective. A generic 'we do logging' statement is insufficient to mitigate this risk.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "23_sec1.ts",
      "bsiCode": "CON.1",
      "id": "inadequate-key-management",
      "title": "Inadequate Key Management (BSI CON.1.G1)",
      "description": "Inadequate key management can lead to the exposure of unencrypted information during an attack.",
      "impact": "If cryptographic keys are not managed properly, it can lead to a loss of confidentiality for encrypted data. It can also cause a denial of service if expired keys or certificates render critical system functions unusable.",
      "action": "Establish and Enforce a Key Management Policy",
      "mitigation": "A comprehensive key management lifecycle process must be established. This includes secure key generation, distribution, storage, rotation, and destruction.",
      "check": "Is there a documented key management policy? Are keys and data stored separately? Are key management systems like a Vault or HSM in use? Is there a process to monitor and handle key/certificate expiration?",
      "asvs": "BSI IT-Grundschutz CON.1: Cryptographic Concept (CON.1.G1 Inadequate key management)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Cryptographic_concept_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is detected in two primary ways.",
      "riskAssessment": "The impact on Availability is determined by the availability rating of the affected asset. The impact on Confidentiality is determined by the confidentiality rating of the data at risk.",
      "falsePositives": "The model may not explicitly show the use of a cloud-provider-managed key service (like AWS KMS or Azure Key Vault), which might be used correctly but not modeled as a 'Vault' asset. This could lead to a false positive.",
      "cwe": "320",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "23_sec2.ts",
      "bsiCode": "CON.1",
      "id": "legal-crypto-restrictions",
      "title": "Legal and Regulatory Restrictions on Cryptography",
      "description": "When institutions use hardware or software with cryptographic functions, they must comply with various legal frameworks.",
      "impact": "A conflict between legal requirements—where one country mandates strong encryption (e.g., for data protection) while another prohibits it without a permit—can make legal communication impossible.",
      "action": "Verify and Comply with Jurisdictional Cryptography Regulations",
      "mitigation": "Conduct a thorough legal review for all jurisdictions where encrypted data is sent or processed. Use cryptographic modules that are compliant with the regulations in all relevant countries.",
      "check": "Is encrypted data being transferred across national borders? Have the cryptographic laws of the source and destination countries been reviewed?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Kryptokonzept), especially section 2.2, and data protection regulations like the GDPR (Art. 32, 44-50) governing data security and international transfers.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Cross-border_cloud_usage_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule flags communication links that are (a) encrypted (e.g., HTTPS/TLS), (b) use a VPN, or (c) carry data with Confidentiality ≥ Restricted, and that cross national borders.",
      "riskAssessment": "Likelihood is 'Likely' if the target jurisdiction requires a permit ('crypto-requires-permit:true'); otherwise 'Unlikely'.",
      "falsePositives": "A risk might be a false positive if a specific legal agreement or permit is in place that allows the transfer but is not captured in the model.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "23_sec3.ts",
      "bsiCode": "CON.1",
      "id": "improper-or-missing-use-of-cryptography",
      "title": "Improper or Missing Use of Cryptography",
      "description": "If cryptographic functions are not used or are used incorrectly, they cannot provide the intended protection for information.",
      "impact": "Failure to correctly encrypt sensitive data, both in transit and at rest, can lead to unauthorized disclosure of information, violating its confidentiality.",
      "action": "Ensure Correct and Enforced Use of Cryptography",
      "mitigation": "Ensure that all communication channels transmitting sensitive data utilize strong, state-of-the-art encryption protocols (e.g., TLS 1.2/1.3).",
      "check": "Are all communication links carrying sensitive data encrypted? Is data-at-rest encryption applied for all data stores holding sensitive information? Are the cryptographic protocols and algorithms in use considered strong and are they configured correctly?",
      "asvs": "V7: Communication Security Verification Requirements, V6: Stored Cryptography Verification Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for two primary conditions:",
      "riskAssessment": "The likelihood of exploitation is higher for assets and links connected to the internet.",
      "falsePositives": "This risk might be flagged for communication links within a highly secure and isolated environment where encryption is considered unnecessary overhead.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "23_sec4.ts",
      "bsiCode": "CON.1",
      "id": "flaw-in-crypto-implementation",
      "title": "Flaw in Cryptographic Implementation",
      "description": "Vulnerabilities or errors in hardware or software with cryptographic functions can compromise the security of the cryptographic methods used.",
      "impact": "If an implementation flaw in a cryptographic function is exploited, it can lead to a complete loss of confidentiality for the data protected by it.",
      "action": "Validate and Verify Cryptographic Implementations",
      "mitigation": "Use well-vetted, standard, and up-to-date cryptographic libraries and algorithms from trusted sources.",
      "check": "Are cryptographic implementations based on standard, up-to-date libraries? Is there a process for patching cryptographic components?",
      "asvs": "BSI IT-Grundschutz CON.1 Cryptographic Concept; OWASP Top 10 2021 A02: Cryptographic Failures.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for technical assets that use cryptography, either for data at rest or for data in transit.",
      "riskAssessment": "The likelihood is higher for custom-developed cryptography and lower for standard, patched components. The impact is directly",
      "falsePositives": "This risk might be a false positive if a component marked as 'custom-developed' does not actually contain custom cryptographic code",
      "cwe": "327",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "23_sec5.ts",
      "bsiCode": "CON.1",
      "id": "hardware-crypto-failure-con8-a23",
      "title": "Failure of Non-Redundant Cryptographic Hardware (BSI CON.8.A23)",
      "description": "Hardware with cryptographic functions (e.g., Hardware Security Modules (HSM) or hardware-backed vaults) can fail due to technical defects, power outages, or physical damage.",
      "impact": "A failure of non-redundant cryptographic hardware can cause entire business process chains to halt, especially when other applications or services depend on the now-inaccessible information.",
      "action": "Ensure Redundancy and Disaster Recovery for Critical Cryptographic Hardware",
      "mitigation": "Critical hardware components with cryptographic functions, such as HSMs, should be designed with redundancy (e.g., in a cluster configuration).",
      "check": "Is the technical asset configured with the `redundant: true` flag? Are there documented and tested disaster recovery plans for this hardware component?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.8 (Cryptography), Requirement CON.8.A23 (Redundancy of cryptographic components).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Cryptography_edition_2023.pdf?__blob=publicationFile (BSI CON.8)",
      "detectionLogic": "This risk is triggered for any in-scope technical assets of technology type 'HSM' or 'Vault' that are not marked as redundant (`redundant: false`).",
      "riskAssessment": "The likelihood of a single hardware component failing over its operational lifetime is considered 'Likely'.",
      "falsePositives": "This risk might be a false-positive if the component is not used for business-critical real-time operations or if alternative, effective, and tested recovery procedures exist that are not captured by the `redundant` flag in the model.",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "23_sec6.ts",
      "bsiCode": "CON.1",
      "id": "insecure-cryptographic-algorithms",
      "title": "Use of Insecure or Outdated Cryptographic Algorithms",
      "description": "Insecure or outdated cryptographic algorithms can be broken with little effort. For encryption algorithms, this means that an attacker can derive the original plaintext from the encrypted text without needing additional information, such as the cryptographic key.",
      "impact": "Failure to use strong, up-to-date cryptography can lead to the compromise of confidentiality and integrity of data, both in transit and at rest. This can result in data breaches, unauthorized access, and tampering, leading to financial loss, reputational damage, and non-compliance with regulations.",
      "action": "Use Strong, State-of-the-Art Cryptography",
      "mitigation": "Ensure all data-in-transit is protected by strong, state-of-the-art encryption protocols (e.g., TLS 1.2+ with modern cipher suites). Ensure all sensitive data-at-rest is encrypted using vetted, industry-standard algorithms and strong key management practices.",
      "check": "Are all communication links carrying sensitive data using an encrypted protocol? Are all data stores holding sensitive information configured for encryption-at-rest? Is there a defined policy for cryptographic standards that is regularly reviewed and updated?",
      "asvs": "V6 Cryptography, V13 Transport Layer Security",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule detects two primary conditions:",
      "riskAssessment": "The likelihood of exploitation increases significantly when unencrypted communication crosses network trust boundaries or involves internet-facing assets. The impact is determined by the confidentiality and integrity requirements of the data being transmitted or stored. A data breach is considered probable if highly sensitive data is left unprotected.",
      "falsePositives": "This rule may flag unencrypted communication within a physically secure network or inside an outer encrypted tunnel (like a VPN or IPsec) that is not explicitly modeled. It also might not recognize application-level encryption if the data is sent over an unencrypted protocol, as this requires deeper model details.",
      "cwe": "327",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "23_sec7.ts",
      "bsiCode": "CON.1",
      "id": "corruption-of-encrypted-data-or-keys",
      "title": "Corruption of Encrypted Data or Keys Leading to Data Loss",
      "description": "If encrypted information (ciphertext) or the associated cryptographic key is altered, even slightly, it may become impossible to decrypt the original data.",
      "impact": "The primary impact is a loss of availability for all data that was encrypted with the compromised key or whose ciphertext was corrupted.",
      "action": "Implement Robust Data @Backup:Target, Key Management, and Integrity Verification",
      "mitigation": "Maintain regular, automated backups of all critical data. Crucially, ensure that cryptographic keys are also securely backed up, for example in a Hardware Security Module (HSM), a vault, or another key management system.",
      "check": "Is there a regularly tested @Backup:Target and recovery process for encrypted data stores? Are cryptographic keys securely stored and backed up in a separate, resilient system (e.g., Vault, HSM)?",
      "asvs": "Derived from BSI IT-Grundschutz Bausteine CON.1 (Cryptographic Concept) and CON.8 (Key Management). Also relates to OWASP Top 10 A02:2021 - Cryptographic Failures.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Cryptographic_concept_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule targets data stores that use encryption but lack explicit confirmation of a tested @Backup:Target process.",
      "riskAssessment": "The impact of this risk is directly proportional to the availability requirement of the data being stored.",
      "falsePositives": "A risk might be flagged if the @Backup:Target and recovery process exists but is not documented in the model via the '@Mitigation:@Backup:Target-verified' tag. This is an organizational control that may not be visible in the architecture diagram alone.",
      "cwe": "345",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "23_sec8.ts",
      "bsiCode": "CON.1",
      "id": "compromise-of-cryptographic-keys",
      "title": "Compromise of Cryptographic Keys (BSI)",
      "description": "The security of cryptographic mechanisms depends critically on the confidentiality of the cryptographic keys used.",
      "impact": "If an attacker gains access to cryptographic keys, all data encrypted with these keys must be considered compromised. This leads to a severe loss of confidentiality and can undermine the integrity and authenticity of data if the keys are also used for signing.",
      "action": "Implement secure key management and storage",
      "mitigation": "Store cryptographic keys in a secure, dedicated location, such as a Hardware Security Module (HSM) or a trusted key vault service.",
      "check": "Are cryptographic keys stored in a dedicated secure management system (HSM, Vault)? Are keys ever stored in plaintext in configuration files, source code, or unsecured backups? Is there a key rotation policy?",
      "asvs": "BSI IT-Grundschutz: CON.1 Cryptographic Concept",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Cryptographic_controls_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies technical assets that use application-level encryption but are not specialized key management systems (like Vaults or HSMs) and do not appear to be communicating with one.",
      "riskAssessment": "The likelihood is high for custom-developed components that perform their own encryption without integrating a dedicated key management system.",
      "falsePositives": "A risk might be a false positive if an asset uses a secure, but un-modeled, key management mechanism (e.g., using secure OS key stores or a key management service that is not represented as a separate asset in the model).",
      "cwe": "522",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "23_sec9.ts",
      "bsiCode": "CON.1",
      "id": "forged-certificates",
      "title": "Forgery of Certificates (BSI CON.4)",
      "description": "Certificates are used to bind a public cryptographic key to an identity (person, IT system, or institution).",
      "impact": "If a forged certificate is accepted, an attacker can impersonate a legitimate system or user, leading to Man-in-the-Middle (MITM) attacks.",
      "action": "Implement Robust Certificate and Trust Chain Validation",
      "mitigation": "The client application connecting to a service must perform strict validation of the presented TLS certificate. This includes:",
      "check": "Is the application code validating the full certificate chain of every communication partner? Does it perform hostname verification? Is revocation checking implemented? Are self-signed or expired certificates rejected?",
      "asvs": "V14.2.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for every communication link that uses a certificate-based protocol (e.g., HTTPS, LDAPS) or requires client-certificate authentication.",
      "riskAssessment": "The likelihood of exploitation is higher for communication crossing network trust boundaries, as this increases the opportunity for MITM attacks.",
      "falsePositives": "This can be a false positive if the application has been explicitly developed to perform all required certificate validation steps correctly.",
      "cwe": "295",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "24_sec1.ts",
      "bsiCode": "CON.2",
      "id": "fundamental-rights-interference",
      "title": "Insufficiently Mitigated Interference with Fundamental Rights (BSI Risk Type A)",
      "description": "This risk addresses scenarios where the processing of personal data interferes with the fundamental rights of individuals in a way that is not sufficiently mitigated or minimized ('nicht hinreichend milde gestaltet').",
      "impact": "Failure to adequately mitigate the impact of data processing on fundamental rights can lead to severe legal and financial consequences, including substantial fines under the GDPR (DSGVO) and other data protection laws.",
      "action": "Implement Data Protection by Design and by Default (DPbDD)",
      "mitigation": "Strictly adhere to the principles of data minimization and purpose limitation. Only collect, process, and store personal data that is absolutely necessary for a clearly defined and legitimate purpose.",
      "check": "Has a Data Protection Impact Assessment (DPIA) been conducted? Is all processed personal data strictly necessary for the defined business purpose?",
      "asvs": "This concept is central to legal frameworks like the GDPR, particularly Article 5 (Principles relating to processing of personal data) and Article 25 (Data protection by design and by default). It is also a core principle of the BSI's 'Standard-Datenschutzmodell' (SDM).",
      "cheatSheet": "https://gdpr-info.eu/art-25-gdpr/",
      "detectionLogic": "This risk is raised for technical assets that process or store a significant quantity of highly sensitive personal data.",
      "riskAssessment": "The impact is directly derived from the confidentiality and criticality rating of the data asset, as this reflects the potential harm to the individual. 'Strictly-Confidential' data leads to a 'Very High' impact.",
      "falsePositives": "This rule can trigger for systems that legitimately and lawfully process large amounts of sensitive personal data (e.g., a hospital's patient management system).",
      "cwe": "359",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "24_sec10.ts",
      "bsiCode": "CON.2",
      "id": "inherent-risk-of-processing-@DataType:PII-gdpr75",
      "title": "Inherent Risk of Processing Personal Data (GDPR Recital 75)",
      "description": "Processing personal data inherently creates risks to the rights and freedoms of natural persons, with varying likelihood and severity. These risks can result in physical, material, or immaterial harm if data is compromised, for example through unauthorized access, processing, or disclosure.",
      "impact": "A breach involving personal data can cause severe consequences, including discrimination, identity theft or fraud, financial loss, reputational damage, loss of confidentiality of data subject to professional secrecy, unauthorized reversal of pseudonymization, or other significant economic or social disadvantages. Individuals may lose control over their personal data, particularly when special categories of data (e.g., health, ethnic origin, political opinions) are involved, when profiling is performed, or when vulnerable persons are affected.",
      "action": "Implement Appropriate Technical and Organizational Measures (TOMs)",
      "mitigation": "Implement a defense-in-depth strategy based on a Data Protection Impact Assessment (DPIA). Key measures include strong access control, data minimization, pseudonymization, and encryption (both in transit and at rest). Apply security-by-design and security-by-default principles. Regularly test, assess, and evaluate the effectiveness of the implemented measures. Ensure that data processing is limited to what is necessary for the specified purpose.",
      "check": "Is there a Data Protection Impact Assessment (DPIA) for processing this data? Are the data assets correctly classified? Is access strictly controlled on a 'need-to-know' basis? Is sensitive personal data encrypted at rest and in transit? Are measures such as pseudonymization used where possible? Are systems regularly patched and securely configured?",
      "asvs": "GDPR Recital 75",
      "cheatSheet": "https://gdpr-info.eu/recitals/no-75/",
      "detectionLogic": "This risk is raised for any in-scope technical asset that processes or stores data assets identified as containing personal information (via tags or high confidentiality). The risk level is adjusted based on the sensitivity and quantity of the data and the exposure of the technical asset (e.g., internet-facing).",
      "riskAssessment": "The impact is directly related to the confidentiality and quantity of the personal data being processed or stored. Special categories of data (e.g., health data) or data concerning vulnerable subjects significantly increase the impact. The likelihood of exploitation increases if the asset is internet-facing, custom-developed, or part of a less-controlled environment (such as a client device), as these factors increase the attack surface.",
      "falsePositives": "The risk might be flagged even if strong, non-modeled compensating controls are in place. A formal DPIA may have assessed the risk and deemed it acceptable with the existing controls. This generated risk should serve as a prompt to verify that such assessments and controls exist and are effective.",
      "cwe": "359",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "24_sec11.ts",
      "bsiCode": "CON.2",
      "id": "incorrectly-assessed-protection-requirement-for-@DataType:PII",
      "title": "Incorrectly Assessed Protection Requirement for Personal Data (BSI-Style)",
      "description": "An institution might incorrectly assess the protection requirements for personal data, typically setting them too low. This can occur if the extended data protection goals (beyond standard CIA) are ignored, if there's a failure to distinguish between risks to the data subject and risks to the institution, or if processes are intentionally biased against the data subject. This risk identifies data assets tagged as containing personal data but modeled with suspiciously low CIA ratings, indicating a potential violation of data protection by design principles.",
      "impact": "Incorrectly assessing the protection requirement for personal data can lead to insufficient safeguards. This increases the risk of data breaches, violating the fundamental rights and freedoms of data subjects. Consequences can include significant legal and financial penalties (e.g., under the GDPR/DSGVO), reputational damage, and loss of customer trust.",
      "action": "Review and Correct CIA Ratings for Personal Data",
      "mitigation": "Ensure all data assets containing personal information are correctly identified and tagged (e.g., with `@DataType:PII`). Conduct a proper Data Protection Impact Assessment (DPIA) to determine the true risk to data subjects. Adjust the confidentiality, integrity, and availability ratings within the threat model to reflect the results of the DPIA, ensuring that protection levels are adequate and comply with legal requirements like the GDPR/DSGVO. The justification for the rating should be documented.",
      "check": "Are all data assets containing personal information tagged appropriately (e.g., `@DataType:PII`)? Do the CIA ratings of these assets reflect the potential impact of a breach on the data subjects, in compliance with data protection laws like the GDPR/DSGVO?",
      "asvs": "Derived from data protection principles such as those in the GDPR/DSGVO (Art. 5, Art. 25, Art. 32) and the BSI's perspective on data protection risk assessment.",
      "cheatSheet": "https://www.bsi.bund.de/EN/Topics/Topics_node.html",
      "detectionLogic": "This rule scans for data assets tagged as containing personal data (`@DataType:PII`) but having suspiciously low confidentiality, integrity, or availability ratings. A risk is then raised for each technical asset that processes or stores this inadequately protected data, as this indicates a failure in data protection by design.",
      "riskAssessment": "The likelihood is considered high if a misconfiguration is detected, as it represents a permanent weakness. The impact on the data subject from a breach of personal data is intrinsically high. The model calculates severity based on this, and the risk is flagged as a potential model failure because the model's own data (the low CIA rating) is being questioned.",
      "falsePositives": "This risk might be considered a false positive if the data has been effectively pseudonymized or anonymized, significantly lowering the risk to the data subject, but this nuance is not captured in the model's tags. Verification requires reviewing the Data Protection Impact Assessment (DPIA) for the specific data asset.",
      "cwe": "359",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "24_sec2.ts",
      "bsiCode": "CON.2",
      "id": "insufficient-or-ineffective-controls-bsi-type-b",
      "title": "Insufficient or Ineffective Controls (BSI Risk Type B)",
      "description": "This risk describes a scenario where the security measures intended to protect a system and its data (i.e., reduce the 'intensity of intervention') are either incomplete, not operated effectively, or are not continuously monitored, audited, and assessed. It represents a failure or gap in the overall security posture, leaving the system vulnerable even if specific controls are thought to be in place.",
      "impact": "Failure to implement and maintain effective controls directly undermines the protection goals of Confidentiality, Integrity, and Availability. This can lead to unauthorized access, data tampering, service disruption, data breaches, and non-compliance with legal/contractual obligations, resulting in significant financial, reputational, and legal damage.",
      "action": "Implement a Robust Security Control Lifecycle",
      "mitigation": "Ensure a defense-in-depth strategy where controls are layered. All security controls (e.g., authentication, authorization, encryption, input validation, network filtering) must be explicitly designed, correctly implemented, and thoroughly tested. Establish a continuous monitoring and auditing process, including regular vulnerability scanning, penetration testing, and log analysis, to verify that all security controls are operating effectively and have not degraded over time.",
      "check": "Are all security controls for the asset documented? Is there a process for regularly testing the effectiveness of these controls (e.g., audit, pentest)? Is there active security monitoring (e.g., SIEM, IDS/IPS) to detect control failures or bypass attempts? Are security logs regularly reviewed?",
      "asvs": "BSI IT-Grundschutz DER.1.A7 (Checking the functionality of security functions) and the broader concepts of CON.1 (Security testing).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Security_monitoring_and_detection_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This is a meta-risk that is difficult to detect automatically. It is raised for any in-scope technical asset with a non-trivial CIA rating (i.e., above public/archive level). The presence of the risk serves as a mandatory checkpoint to manually verify that the documented and implemented security controls for the asset are complete, effective, and continuously monitored.",
      "riskAssessment": "The likelihood is considered 'Likely' as control failures or gaps are a common issue in complex systems. The impact is directly proportional to the highest CIA rating of the technical asset and the data it processes or stores. An asset with 'Strictly Confidential' data will have a 'Very High' impact, while an asset with 'Restricted' data will have a 'Medium' impact.",
      "falsePositives": "This risk may be a false positive if an asset has robust, effective, and well-monitored controls that are not fully detailed in the threat model. The risk should be accepted or marked as a false positive after a manual review and confirmation of the control landscape's effectiveness.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "24_sec3.ts",
      "bsiCode": "CON.2",
      "id": "incomplete-or-ineffective-security-measures",
      "title": "Incomplete or Ineffective Security Measures (BSI Risk Type C)",
      "description": "This risk arises when the security measures required by information security policies (e.g., as per BSI IT-Grundschutz) are not completely implemented, are not operated with sufficient effectiveness, or are not continuously monitored, audited, and assessed. A lack of monitoring and control over critical system components is a primary indicator of this weakness, as it prevents the detection of attacks and operational failures, leaving vulnerabilities exposed.",
      "impact": "Failure to implement, operate, and control security measures effectively can lead to the compromise of confidentiality, integrity, and availability of critical assets. Without proper monitoring, security incidents may go unnoticed, allowing attackers extended time to pivot, escalate privileges, and exfiltrate data. This can result in severe data breaches, system downtime, financial loss, and reputational damage.",
      "action": "Implement and Operate Comprehensive Security Monitoring",
      "mitigation": "Establish a robust security monitoring and detection capability. Key components should send relevant security and operational logs to a central, protected logging system (e.g., SIEM). Define and monitor events that indicate potential security incidents for all critical assets. Ensure monitoring systems themselves are secure and that there are defined processes for analyzing events and responding to alerts. Regularly review and audit the effectiveness of monitoring controls.",
      "check": "Are all critical technical assets configured to send logs to a central monitoring system? Are there alerts configured for suspicious activities? Is there a defined process for incident detection and response based on monitoring events? Are monitoring logs protected against tampering?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein DER.1: Security monitoring and detection. This risk directly relates to requirements like DER.1.A2 (Networked logging) and DER.1.A4 (Selecting suitable log-worthy events).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Security_monitoring_and_detection_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies critical technical assets that lack a modeled communication link to a monitoring system. It flags in-scope assets that are considered sensitive (due to high CIA ratings) or are of a critical technology type (like web applications, databases, or identity providers) but do not appear to be sending data to any asset with the 'Monitoring' technology type. This suggests a gap in continuous control and visibility.",
      "riskAssessment": "The impact is derived directly from the confidentiality and integrity rating of the unmonitored technical asset. The likelihood of an undetected compromise is considered 'Very Likely' if a critical asset has no monitoring link at all, as any attack against it would have a low probability of being detected in a timely manner. The data breach probability is 'Probable' for assets storing or processing sensitive data, as a successful compromise is likely to lead to data exposure.",
      "falsePositives": "A false positive can occur if the monitoring architecture is not fully represented in the model. For example, monitoring may be performed by an agent on a shared host or via network-level taps that are not modeled as explicit communication links from each asset. This risk should be validated against the actual monitoring implementation.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "24_sec4.ts",
      "bsiCode": "CON.2",
      "id": "inadequate-data-protection-in-security-measures-bsi-d",
      "title": "Inadequate Data Protection in Security Measures (BSI Risk Type D)",
      "description": "Information security measures, such as logging, monitoring, or traffic inspection systems (WAF, IDS/IPS), are not always operated in a way that sufficiently complies with data protection principles.",
      "impact": "If security measures improperly handle sensitive or personal data, this can lead to severe data protection violations and data breaches.",
      "action": "Ensure Security Measures Adhere to Data Protection Principles",
      "mitigation": "Review the configuration of all security-related components (e.g., WAFs, IDS/IPS, APM, monitoring/logging systems) to ensure strict data minimization.",
      "check": "Do security components process only the minimum data required for their function? Is sensitive data (credentials, tokens, @DataType:PII) redacted or masked in logs and traces?",
      "asvs": "BSI IT-Grundschutz CON.1.A5 Data minimisation",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_data_protection_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This generator runs only when the selected threat standard is 'BSI'. It identifies in-scope technical assets that function as security controls (e.g., WAF, IDS/IPS, Monitoring, Reverse Proxy or other forwarding components).",
      "riskAssessment": "Impact scales with the confidentiality of the data processed by the security component: processing 'Strictly Confidential' data yields a very high impact; otherwise the impact is high.",
      "falsePositives": "A finding can be a false positive if the security component has been explicitly configured and verified to be privacy-compliant (e.g., it redacts all sensitive fields before processing or logging and enforces minimal retention).",
      "cwe": "359",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "24_sec5.ts",
      "bsiCode": "CON.2",
      "id": "inadequate-consideration-of-privacy-risks",
      "title": "Inadequate Consideration of Privacy Risk Types",
      "description": "The BSI notes: 'If one or more risk types are not considered or not sufficiently differentiated, there is a danger that the informational self-determination of the affected person cannot be guaranteed in a legally compliant manner.'",
      "impact": "Failure to adequately assess privacy risks for systems handling personal data can lead to violations of data subjects' rights, resulting in significant legal penalties (e.g., GDPR fines), reputational damage, and loss of customer trust. It may lead to a formal data breach if sensitive information is exposed or misused.",
      "action": "Conduct a Data Protection Impact Assessment (DPIA)",
      "mitigation": "For all components processing personal or sensitive data, conduct and document a Data Protection Impact Assessment (DPIA). This process should go beyond standard threat modeling to explicitly identify and evaluate risks to data subjects' rights and freedoms. Ensure the principles of Privacy by Design and by Default are implemented. Consider the use of Privacy-Enhancing Technologies (PETs) like anonymization, pseudonymization, or data minimization.",
      "check": "Is there a documented DPIA for systems processing personal data? Does the risk inventory for these systems consider privacy-specific threats? Have data minimization and purpose limitation principles been applied?",
      "asvs": "Derived from the principles of GDPR Article 35 (Data Protection Impact Assessment - DPIA), which requires assessing risks to the rights and freedoms of natural persons.",
      "cheatSheet": "https://www.enisa.europa.eu/publications/data-protection-engineering",
      "detectionLogic": "This rule heuristically identifies technical assets that handle highly sensitive data (based on confidentiality rating or @DataType:PII tags) but have a surprisingly low number of identified risks or only low-severity risks. This suggests that the specific, often complex, privacy risks associated with the data might have been overlooked during the threat modeling process.",
      "riskAssessment": "The likelihood of this governance failure is considered high if a component processes sensitive personal data without a corresponding high-severity risk being identified, suggesting an incomplete analysis. The impact is directly proportional to the sensitivity and quantity of the personal data being processed, as this determines the potential harm to data subjects and the legal liability for the organization.",
      "falsePositives": "A system might be genuinely well-designed and secure, resulting in few identified risks. This risk is intended to trigger a manual verification: 'Have we performed a dedicated privacy risk assessment for this component?' The model might not capture all organizational controls (like a completed offline DPIA).",
      "cwe": "359",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "24_sec6.ts",
      "bsiCode": "CON.2",
      "id": "non-compliant-data-processing-purpose-limitation",
      "title": "Non-Compliant Data Processing (Purpose Limitation & Transparency)",
      "description": "Processing of personal data is non-compliant when purposes are undefined, overstretched, or detached from the original lawful basis (GDPR Art. 5). This includes opaque processing or missing integrity safeguards, particularly where auxiliary/dev/monitoring systems touch production data without a documented, legitimate purpose.",
      "impact": "Violations can trigger regulatory penalties (e.g., GDPR), damages, loss of trust, and misuse of sensitive data. Impact grows with the data’s confidentiality and integrity requirements and with the distance between the system’s purpose and the data’s intended use.",
      "action": "Document lawful purposes and enforce technical purpose limitation",
      "mitigation": "Define and record specific, explicit, legitimate purposes per data asset (e.g., in RoPA/DPIA). Enforce least-privilege and purpose-bound access paths so that auxiliary/dev/monitoring tools cannot process production personal data by default. Minimize, pseudonymize, or use synthetic/test data for non-production uses. Regularly review data flows to prevent purpose creep and revoke unused accesses.",
      "check": "Is each data asset’s purpose documented and linked to a legal basis? Are auxiliary/dev/monitoring tools prevented (by design) from accessing production personal data? Are RoPA/DPIA entries current, and are logging/monitoring controls transparent and justified? Is there periodic review for purpose creep and non-essential data access?",
      "asvs": "Derived from GDPR Article 5(1)(b) 'Purpose Limitation' and related principles of lawfulness, fairness, transparency, and integrity.",
      "cheatSheet": "https://gdpr-info.eu/art-5-gdpr/",
      "detectionLogic": "Flag technical assets with auxiliary, development, or monitoring functions that process or store sensitive or business-critical data assets. The rule considers technology hints (development relevance or tolerance of unnecessary data) and data attributes (confidentiality/integrity). Likelihood increases when modeled data flows show these assets handling production or business-usage data.",
      "riskAssessment": "Impact scales with confidentiality/integrity of the involved data: high for strictly confidential or critical integrity data, medium for restricted/important, low otherwise. Likelihood is set to 'Likely' when the model shows auxiliary/dev/monitoring assets processing such data, indicating an architectural pattern that may breach purpose limitation.",
      "falsePositives": "May be acceptable where a documented legal basis and technical safeguards exist (e.g., authorized security inspection of sensitive streams, tightly scoped troubleshooting with pseudonymized data, or synthetic data in non-production). Mark as false positive only with clear justification in RoPA/DPIA and access logs.",
      "cwe": "840",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "24_sec7.ts",
      "bsiCode": "CON.2",
      "id": "inherent-risk-of-processing-personal-data",
      "title": "Inherent Risk of Processing Personal Data (based on BSI Data Protection View)",
      "description": "From a data protection perspective, any institution that processes personal data (e.g., collects, stores, transmits, or deletes) fundamentally represents a risk to the affected data subjects. This risk is inherent to the act of data processing itself and exists even if all operations are designed to be legally compliant (e.g., under GDPR). It is the baseline risk that security measures aim to manage and mitigate.",
      "impact": "Should this inherent risk materialize into a data breach, the compromise of personal data can lead to significant harm for individuals, including identity theft, financial loss, discrimination, and reputational damage. For the institution, consequences can include severe legal penalties, loss of customer trust, and major financial repercussions.",
      "action": "Acknowledge, Manage, and Minimize Inherent Data Processing Risk",
      "mitigation": "While this inherent risk cannot be entirely eliminated, it must be managed by implementing a multi-layered 'Defense-in-Depth' security strategy. This includes robust Technical and Organizational Measures (TOMs), conducting Data Protection Impact Assessments (DPIAs) for high-risk processing, and strictly adhering to principles of data minimization and purpose limitation. The goal is to continuously reduce the likelihood and potential impact of this inherent risk materializing into an actual data breach. Every other identified and mitigated risk contributes to managing this fundamental risk.",
      "check": "Does the organization acknowledge the inherent risks of processing personal data? Are Data Protection Impact Assessments (DPIAs) performed where required? Are principles like data minimization and 'privacy by design' actively followed? Is there a comprehensive and effective security program in place to protect the data throughout its lifecycle?",
      "asvs": "This concept is a foundational principle of data protection frameworks like the GDPR (Arts. 5, 24, 25, 32) and is not covered by a single ASVS item. It relates to the overall responsibility of the data controller.",
      "cheatSheet": "https://gdpr-info.eu/art-5-gdpr/",
      "detectionLogic": "This risk is generated for any technical asset that processes or stores data assets classified with high sensitivity (i.e., 'Confidential' or 'Strictly-Confidential'). This classification serves as a proxy for identifying the processing of personal or otherwise sensitive data, which carries inherent risk.",
      "riskAssessment": "The likelihood is considered 'Likely' because the risk is an intrinsic and ever-present consequence of handling sensitive data. The impact is directly proportional to the confidentiality level and quantity of the data being processed or stored. Processing large volumes of 'Strictly Confidential' data results in a 'Very High' impact.",
      "falsePositives": "This risk can only be considered a 'false positive' if a data asset has been misclassified as 'Confidential' or 'Strictly-Confidential' but does not, in fact, contain personal or sensitive data. Otherwise, it represents a fundamental risk that should be acknowledged.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "24_sec8.ts",
      "bsiCode": "CON.2",
      "id": "data-access-beyond-original-purpose",
      "title": "Unauthorized Data Access Beyond Original Purpose",
      "description": "A frequently occurring risk in practice is access to data that does not serve the purpose of the original data processing.",
      "impact": "Accessing data beyond its intended and legally justified purpose can lead to severe data privacy violations (such as personal data/PII), resulting in significant fines, reputational damage, and loss of customer trust. It directly compromises the confidentiality and integrity of the data assets involved.",
      "action": "Enforce Purpose Limitation and Strict Access Control",
      "mitigation": "Implement strict, role-based access controls based on the principle of least privilege ('need-to-know').",
      "check": "Is there a documented inventory of data processing purposes? Are all data flows, especially to external entities or across different usage contexts (Business, DevOps), justified by a documented purpose and legal basis? Is access to sensitive data logged and audited for anomalies?",
      "asvs": "ASVS V13.1 (Data Protection)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/GDPR_Compliance_Cheat_Sheet.html",
      "detectionLogic": "This rule identifies communication links where data flows between different contexts, which indicates a potential for purpose violation.",
      "riskAssessment": "The impact is determined by the sensitivity (confidentiality and integrity) of the data being transferred. The higher the sensitivity, the higher the impact of a purpose violation.",
      "falsePositives": "Legitimate and well-documented data transfers to partners or service providers might be flagged.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "24_sec9.ts",
      "bsiCode": "CON.2",
      "id": "lack-of-standardized-process-for-third-party-access",
      "title": "Lack of Standardized Process for Third-Party Access",
      "description": "A risk exists for both individuals and the responsible institution if there are no standard processes for legitimate access to IT services or data transmission by third parties. The risk is compounded if the legitimacy of these actions cannot be proven through logs and documentation.",
      "impact": "This can lead to unauthorized or untraceable access, making it impossible to hold third parties accountable for their actions. It facilitates Repudiation, where a third party can deny their actions. This may result in data breaches, unauthorized modifications, or service disruption, with significant legal, financial, and reputational consequences.",
      "action": "Define and Enforce Standard Access Procedures for Third Parties",
      "mitigation": "Establish clear, documented procedures for granting, monitoring, and revoking third-party access. All communication links from external entities must enforce strong authentication (e.g., tokens, client certificates) and authorization. Ensure that all access is logged with sufficient detail to provide an audit trail, identifying the external entity, the time of access, and the actions performed. Consider using VPN or strict IP filtering as compensating controls.",
      "check": "Is there a documented process for third-party access? Do all communication links from external entities require authentication and authorization? Are access logs generated and regularly reviewed?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Supplier management), specifically requirements like ORP.2.A5 (Defining and implementing rules for information exchange) and ORP.2.A8 (Monitoring, reviewing, and auditing supplier services).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Supplier_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is detected by analyzing communication links originating from an 'External-Entity'. The rule checks for links that lack proper authentication (i.e., 'none') and authorization (i.e., 'none'). The risk is associated with the internal asset being accessed. Links with VPN or IP filtering are considered mitigated for this rule.",
      "riskAssessment": "Likelihood is high if no authentication is used. Impact depends on the sensitivity (CIA ratings) of the data assets being transferred and the criticality of the target technical asset. Access to mission-critical systems or strictly-confidential data without auditable proof is a high-impact event.",
      "falsePositives": "The risk may be a false positive if compensating controls exist outside the model that are not documented on the communication link itself.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "25_sec1.ts",
      "bsiCode": "CON.3",
      "id": "data-loss-without-@Backup:Target",
      "title": "Risk of Permanent Data Loss due to Missing @Backup:Target Strategy (BSI)",
      "description": "If data is lost and it was not backed up beforehand, this can have existential consequences for an institution.",
      "impact": "The permanent loss of data compromises its Availability and Integrity. Depending on the criticality of the affected data, this can",
      "action": "Implement a Resilient @Backup:Target and Recovery Strategy",
      "mitigation": "Implement a comprehensive data @Backup:Target and recovery strategy for all critical systems storing data.",
      "check": "Is there a documented and regularly tested @Backup:Target and recovery plan for the asset? Are backups stored in a separate, secure location?",
      "asvs": "BSI IT-Grundschutz CON.3 (Data @Backup:Target Concept). While not a direct OWASP ASVS item, this aligns with general principles of operational resilience and data protection.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2022.pdf?__blob=publicationFile (BSI CON.3)",
      "detectionLogic": "This rule identifies technical assets that typically store significant data (e.g., databases, file servers, data lakes)",
      "riskAssessment": "The likelihood of an event causing data loss (e.g., hardware failure, human error, malware) is considered 'Likely' over the lifecycle of any system.",
      "falsePositives": "A @Backup:Target and recovery strategy might exist for the asset, but it has not been documented in the model using the '@Backup:Target:resilient' tag.",
      "cwe": "1189",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "25_sec10.ts",
      "bsiCode": "CON.3",
      "id": "ransomware-attack",
      "title": "Ransomware Attack (BSI OPS.1.1.5)",
      "description": "A specialized form of malware is ransomware, which encrypts data on infected IT systems. After encryption, a ransom is demanded for the victim to be able to decrypt the data.",
      "impact": "If this risk is exploited, data on affected systems will be encrypted and become unavailable, leading to a massive disruption of business and IT operations.",
      "action": "Implement Multi-Layered Ransomware Defense",
      "mitigation": "Implement a robust, multi-layered defense strategy. This includes: 1. Maintaining regular, automated, and tested backups. 2. Ensuring that primary @Backup:Target copies are stored offline, air-gapped, or in immutable storage, making them inaccessible to ransomware spreading across the network.",
      "check": "Are backups regularly created and tested? Are the @Backup:Target datastores protected from write access from the regular network (i.e., offline or immutable)? Are file share permissions on datastores reviewed and restricted based on the principle of least privilege?",
      "asvs": "BSI IT-Grundschutz Baustein OPS.1.1.5 Malicious Code Protection (related to Threat T 5.143 Ransomware)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Malicious_code_protection_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks for datastores that have incoming communication links which are not 'readonly'. Such a configuration allows a potentially compromised source asset to write to the datastore, which is the primary mechanism for ransomware to encrypt data on network shares and backups.",
      "riskAssessment": "The likelihood of a successful attack is significantly increased if the writeable connection originates from a client-type asset (e.g., desktop, browser), as these are common initial infection vectors.",
      "falsePositives": "This risk can be a false positive if write access is strictly controlled by other mechanisms not modeled in Threagile (e.g., application-level logic, specific OS-level user permissions) or if the source system is exceptionally hardened and isolated.",
      "cwe": "732",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "25_sec2.ts",
      "bsiCode": "CON.3",
      "id": "untested-backups",
      "title": "Untested Backups Leading to Restore Failure (BSI CON.3)",
      "description": "If data is backed up regularly, this does not automatically guarantee that it can be restored without issues.",
      "impact": "Failure to restore from backups leads to a loss of data availability and potentially integrity. This can disrupt business operations,",
      "action": "Implement and regularly test a backup and recovery procedure",
      "mitigation": "Establish a formal backup and recovery plan for all critical systems. Regularly test the restore process for critical data stores to ensure data integrity and timeliness of recovery.",
      "check": "Is there a documented backup and recovery plan? Are restore procedures tested on a regular schedule? Are the results of these tests documented and reviewed? Can the team demonstrate a successful restore from a recent backup?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein CON.3: Datensicherungskonzept.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Contingency_Management_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for technical assets that store data (e.g., type 'datastore' or technologies like 'database', 'file-server')",
      "riskAssessment": "The impact is directly proportional to the Availability and Integrity requirements of the asset and the data it stores. A datastore for 'Mission-Critical' data faces a 'Very High' impact.",
      "falsePositives": "This risk may be a false positive if recovery testing is performed but not documented in the threat model via the '@Recovery:Tested' tag.",
      "cwe": "754",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "25_sec3.ts",
      "bsiCode": "CON.3",
      "id": "unsafe-storage-of-@Backup:Target-media",
      "title": "Unsafe Storage of @Backup:Target Media",
      "description": "@Backup:Target media, whether traditional tapes or modern storage systems, contain sensitive information.",
      "impact": "Compromise of @Backup:Target media can lead to severe breaches of Confidentiality (data theft), Integrity (data manipulation), and Availability (data loss).",
      "action": "Ensure Secure Physical and Environmental Storage for @Backup:Target Media",
      "mitigation": "Store all @Backup:Target media in a secure, access-controlled location (e.g., a locked room, a fire-proof safe).",
      "check": "Are @Backup:Target media stored in a locked, environmentally controlled, and access-restricted location? Is the data on the @Backup:Target media encrypted? Is there a documented policy for handling, storing, and transporting @Backup:Target media?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium, specifically Baustein OPS.1.1.4 (Datensicherung). This addresses threats like G 0.25 (Theft of devices or data carriers) and G 0.14 (Failure of backup media), and relates to requirements like OPS.1.1.4.A7 (Protection of @Backup:Target media against unauthorized access) and OPS.1.1.4.A8 (Proper storage of @Backup:Target media).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_4_Data_backup_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is automatically raised for any technical asset of type 'datastore' that is tagged with `@Backup:Target`.",
      "riskAssessment": "The impact of this risk is calculated based on the highest Confidentiality, Integrity, and Availability ratings of the data stored on the @Backup:Target asset.",
      "falsePositives": "This risk can be considered a false positive if the asset, despite being tagged, is already subject to robust physical and environmental controls that meet or exceed the mitigation requirements. Such controls are outside the scope of a typical threat model and must be confirmed through an audit or review of operational procedures.",
      "cwe": "530",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "25_sec4.ts",
      "bsiCode": "CON.3",
      "id": "inadequate-backup-and-recovery-documentation-con3",
      "title": "Inadequate Backup and Recovery Documentation (BSI CON.3)",
      "description": "If data backups and especially recovery measures are not, or are only inadequately, documented, this can significantly delay restoration after an incident like a hardware failure or ransomware attack.",
      "impact": "Failure to restore systems in a timely manner due to poor or inaccessible documentation directly impacts business continuity. It can cause significant financial loss from operational downtime, reputational damage, and permanent loss of critical or sensitive data, which violates integrity and availability principles.",
      "action": "Establish, document, and regularly test a recovery plan",
      "mitigation": "Create a detailed and clear recovery plan for all critical data-storing assets. This documentation should be tested regularly via recovery drills to ensure its accuracy and effectiveness.",
      "check": "Is there a documented recovery plan for the asset? Is it regularly tested? Is a copy stored securely offline and accessible in a disaster scenario?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Backup and Recovery Concept), specifically requirements CON.3.A5 (Recovery tests) and CON.3.A6 (Documentation of data backups).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Datensicherungskonzept_Edition_2023.pdf?__blob=publicationFile (German BSI CON.3)",
      "detectionLogic": "This rule targets in-scope technical assets that are of type 'datastore' or use technologies typically meant for storing data (e.g., databases, file servers).",
      "riskAssessment": "The impact is determined by the availability and integrity rating of the affected asset and its data. An asset with 'mission-critical' data will result in a 'very-high' impact risk.",
      "falsePositives": "A recovery plan might exist but may not be tagged in the model. This rule serves to highlight the absence of this assertion in the model, prompting verification.",
      "cwe": "755 // CWE-755: Improper Handling of Exceptional Conditions (a disaster recovery scenario is an exceptional condition)",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "25_sec5.ts",
      "bsiCode": "CON.3",
      "id": "non-compliance-in-data-@Backup:Target-con3",
      "title": "Non-Compliance with Legal Requirements in Data @Backup:Target (BSI CON.3)",
      "description": "If legal and regulatory requirements (e.g., @DataType:PII, industry-specific data protection laws) are not observed during the data @Backup:Target process, the organization is exposed to significant risks. This includes failing to apply necessary security controls like encryption, access control, and defined retention policies to @Backup:Target data. An unencrypted @Backup:Target of sensitive data is a direct violation of the security principles mandated by most data protection laws.",
      "impact": "Failure to comply with legal requirements for data backups can lead to severe consequences. Regulators can impose heavy fines, and affected parties may file for damages. This can result in significant financial loss, legal battles, and severe reputational damage. Furthermore, improperly secured backups are a prime target for attackers, and their compromise can lead to a major data breach, violating the confidentiality and integrity of sensitive information.",
      "action": "Ensure @Backup:Target Strategy Complies with Legal and Regulatory Requirements",
      "mitigation": "The data @Backup:Target strategy must incorporate all applicable legal, regulatory, and contractual requirements. Sensitive data within backups must be protected by strong encryption at rest. Access to @Backup:Target media and systems must be strictly controlled and logged. Implement and enforce data retention and deletion policies for backups to ensure data is not kept longer than necessary. Regularly test the @Backup:Target and restore process to verify both technical functionality and compliance.",
      "check": "Are all legal requirements for data backups identified and documented? Are backups containing sensitive data encrypted at rest? Are access controls for backups strictly enforced and audited? Are there defined and enforced retention/deletion policies for backups?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Data @Backup:Target Concept)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies datastore assets that appear to be used for backups but lack encryption. A @Backup:Target is identified by the '@Backup:Target' tag, or heuristically by having an 'archive' integrity rating. The risk is raised if such an asset stores sensitive data (Restricted/Important or higher) and has its encryption property set to 'none'.",
      "riskAssessment": "The impact is directly rated based on the highest sensitivity (confidentiality and integrity) of the data stored in the @Backup:Target. The likelihood is considered high because the absence of a fundamental control like encryption on a @Backup:Target of sensitive data makes a compliance violation and a potential data breach very likely.",
      "falsePositives": "An asset might be misidentified as a @Backup:Target if it has an 'archive' rating for other reasons. The most reliable method is to use the '@Backup:Target' tag. The risk might also be a false positive if encryption is handled by an underlying platform in a way not visible to the model (e.g., full-disk encryption on the host).",
      "cwe": "311",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "25_sec6.ts",
      "bsiCode": "CON.3",
      "id": "risk-outsourced-@Backup:Target",
      "title": "Risks of Outsourced Data Backups (BSI-based)",
      "description": "When data backups are outsourced to a third-party institution, attacks on the provider can affect the organization's own data, leading to data leakage (Confidentiality breach).",
      "impact": "A confidentiality breach at the @Backup:Target provider can lead to the exposure of sensitive or critical data. An availability failure can lead to extended downtime during a recovery scenario, impacting business continuity and potentially causing mission failure if data is permanently lost.",
      "action": "Secure and Verify Outsourced @Backup:Target Solution and Contracts",
      "mitigation": "For Confidentiality: Ensure data is encrypted *before* being sent to the provider (client-side encryption) and is also stored encrypted-at-rest by the provider. Use strong, unique encryption keys managed by the organization. Vet the provider's security posture, certifications (e.g., ISO 27001), and contractual obligations regarding data protection. In the model, the target asset's `encryption` should be set to a form of `data-with...-key`.",
      "check": "Is data encrypted in transit and at rest at the @Backup:Target provider? Does the organization control the encryption keys? Are there contractually defined RTO/RPO SLAs? Are restore procedures tested regularly? Is the provider's infrastructure redundant?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein CON.1 (Redundancy), particularly the requirement for analyzing dependencies on external providers (CON.1.A5) and ensuring information for restoration is available (CON.1.A11).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Redundancy_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies communication links that appear to be sending backups to an external entity. It triggers on data flows from an in-scope asset to a `datastore` or `external-entity` across a network trust boundary. The risk is significantly higher if the data has high CIA requirements and mitigations like at-rest encryption or redundancy on the target asset are not modeled.",
      "riskAssessment": "The impact is derived directly from the Confidentiality and Availability ratings of the data assets being backed up. A high impact is assigned for 'confidential'/'critical' data, and a very high impact for 'strictly-confidential'/'mission-critical' data. The likelihood is considered 'likely' by default due to the inherent risks of outsourcing, but is reduced to 'unlikely' if specific mitigations (like data-level encryption for confidentiality or redundancy for availability) are modeled.",
      "falsePositives": "A generic 'External Entity' in the model might represent a highly secure, certified provider in reality, making the generated risk seem higher than it is. The model also cannot verify contractual SLAs. This risk should always prompt a manual review of the provider's contract and security posture.",
      "cwe": "200 // CWE-200: Exposure of Sensitive Information to an Unauthorized Actor. Also relates to CWE-400 (DoS) for the availability part.",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "25_sec7.ts",
      "bsiCode": "CON.3",
      "id": "insufficient-@Backup:Target-storage-capacity",
      "title": "Insufficient Backup Storage Capacity (BSI CON.3.G5)",
      "description": "If storage media for data backups lack sufficient free capacity, recent data may not be backed up.",
      "impact": "This can lead to a partial or complete loss of data integrity and availability. In a recovery scenario, the inability to restore",
      "action": "Implement Capacity Planning and Monitoring for Backup Storage",
      "mitigation": "Implement robust capacity planning and monitoring for all backup storage systems. Configure monitoring to send alerts when capacity reaches predefined thresholds (e.g., 80%, 90%).",
      "check": "Is there active capacity monitoring for backup datastores? Are alerting mechanisms in place for low storage capacity? Is there a documented process for handling capacity alerts and managing data retention on backup media?",
      "asvs": "BSI IT-Grundschutz CON.3 Data Backup Concept",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for datastore assets tagged with `@Backup:Target`. The risk is considered higher if the asset is not connected to a 'Monitoring' component.",
      "riskAssessment": "The likelihood is high if no monitoring is in place to warn about capacity limits. The impact depends on the availability and integrity requirements of the data being backed up.",
      "falsePositives": "A risk might be generated for a datastore that is monitored by an external system not represented in the model. This risk is primarily organizational and operational, and its actual status depends on implemented monitoring processes.",
      "cwe": "755",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "25_sec8.ts",
      "bsiCode": "CON.3",
      "id": "inadequate-data-@Backup:Target-concept-con3",
      "title": "Inadequate Data @Backup:Target Concept (BSI CON.3)",
      "description": "If an adequate concept for data @Backup:Target measures is not created, the technical requirements of the affected business processes may be overlooked.",
      "impact": "Failure to restore data from backups due to an inadequate concept can lead to severe business disruption, permanent data loss, and failure to meet business, legal, and contractual obligations.",
      "action": "Develop, Implement, and Test a Robust Data @Backup:Target and Recovery Concept",
      "mitigation": "Establish a comprehensive @Backup:Target and recovery concept that meets business requirements for Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).",
      "check": "Is there a documented @Backup:Target concept? Are RTOs/RPOs defined and met? Are encrypted backups used? If so, where are the decryption keys stored? Is the key store isolated from the primary systems? Are restore procedures regularly and successfully tested?",
      "asvs": "BSI IT-Grundschutz-Kompendium: CON.3 Datensicherungskonzept (@Backup:Target and Recovery Concept)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Backup_and_recovery_concept_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks for critical flaws in the modeled @Backup:Target strategy, focusing on key management for encrypted backups.",
      "riskAssessment": "The likelihood is considered 'Likely' if a configuration is found where @Backup:Target keys are potentially co-located with source data, as this is a common and serious oversight.",
      "falsePositives": "The rule assumes that a key management system (like a Vault) located in the same trust boundary as a data source might store the keys for that source's @Backup:Target.",
      "cwe": "522",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "25_sec9.ts",
      "bsiCode": "CON.3",
      "id": "@Backup:Target-process-time-exceeds-window",
      "title": "@Backup:Target Process Time Exceeds Allotted Window (BSI CON.1)",
      "description": "In addition to the storage space required for data @Backup:Target, the time required to perform a data @Backup:Target also increases with data volume.",
      "impact": "If @Backup:Target jobs are incomplete or the @Backup:Target system fails, the ability to restore data is severely compromised. This directly threatens the integrity and availability of business-critical information in a disaster recovery scenario, potentially leading to significant data loss and extended downtime.",
      "action": "Review and Optimize @Backup:Target Strategy and Resources",
      "mitigation": "Regularly monitor @Backup:Target job runtimes and set alerts for when they approach the @Backup:Target window limit.",
      "check": "Are @Backup:Target job runtimes continuously monitored? Is there a clearly defined and respected @Backup:Target window? Does the @Backup:Target strategy account for data growth? Are regular data cleanup or archiving processes in place?",
      "asvs": "BSI IT-Grundschutz CON.1: Data @Backup:Target concept",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Data_backup_concept_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for data stores that hold a large quantity of data. The assumption is that any data store is subject to some form of @Backup:Target procedure.",
      "riskAssessment": "The likelihood of this risk materializing increases with the quantity of data stored. A 'very-many' quantity suggests a 'very-likely' chance of extended @Backup:Target times, while a 'many' quantity suggests a 'likely' chance.",
      "falsePositives": "The model does not know the specific @Backup:Target strategy (e.g., incremental backups might be very fast) or the performance of the @Backup:Target infrastructure. An organization might have a powerful @Backup:Target system and a large time window, which would mitigate this risk.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "26_sec1.ts",
      "bsiCode": "CON.6",
      "id": "insecure-data-deletion-con8",
      "title": "Insecure Deletion of Information and Data Carriers (BSI CON.8)",
      "description": "If there are no secure processes and procedures for deleting and destroying information and data carriers, or if they are not applied correctly, it is not guaranteed that confidential information will be securely deleted or destroyed. It is therefore impossible to predict where this information will remain and whether it will be accessible to third parties. This risk is particularly high for digital data carriers and IT systems that are to be decommissioned, as it is not always immediately apparent what (residual) information is on them. This information could be read by unauthorized third parties. If this involves particularly sensitive information, such as personal data requiring special protection under Article 9 of the GDPR or trade secrets, this can result in heavy fines.",
      "impact": "Failure to securely delete data from decommissioned assets can lead to data remanence, where sensitive information is left accessible to unauthorized individuals who gain access to the hardware. This directly compromises confidentiality and can lead to severe data breaches, regulatory fines (e.g., under GDPR), loss of trade secrets, and significant reputational damage.",
      "action": "Establish and Enforce Secure Deletion Procedures",
      "mitigation": "Define and implement a formal policy for the secure deletion and destruction of data and data carriers. The policy should specify different procedures based on data classification and media type (e.g., cryptographic erasure for SSDs, multi-pass overwriting for HDDs, physical destruction for highly sensitive data or damaged media). Maintain a documented chain of custody for all media designated for disposal or reuse. Ensure personnel are trained on these procedures. Use the '@Deletion:secure-process-defined' tag on assets for which such a process is in place and audited.",
      "check": "Is there a documented policy for data deletion and media destruction? Are the methods used compliant with standards like NIST SP 800-88? Is there an inventory of decommissioned assets and proof of their secure sanitization or destruction?",
      "asvs": "BSI IT-Grundschutz Baustein CON.8 (Löschen und Vernichten)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_8_Loeschen_und_Vernichten_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all in-scope technical assets that store data (i.e., asset type is 'datastore', technology is a storage type, or the asset has 'data_assets_stored'). The risk is considered mitigated if the asset is tagged with '@Deletion:secure-process-defined'.",
      "riskAssessment": "The impact of this risk is directly proportional to the confidentiality of the data stored on the asset. A higher confidentiality level results in a higher impact. The likelihood is considered 'Likely' by default, assuming that without a specific, enforced process, insecure or incomplete deletion methods will be used. A data breach is considered 'Probable' if confidential or strictly confidential data is involved.",
      "falsePositives": "This risk might be a false positive if a robust, organization-wide decommissioning and data destruction process exists but is not explicitly modeled with a tag on the specific asset. The model cannot verify physical off-band processes.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "26_sec2.ts",
      "bsiCode": "CON.6",
      "id": "insecure-data-deletion-con6",
      "title": "Insecure Data Deletion (BSI CON.6)",
      "description": "Most applications and operating systems do not securely and irreversibly delete files by default.",
      "impact": "If data is not securely deleted, sensitive information such as passwords, cryptographic keys, and confidential data can be accessed by unauthorized individuals.",
      "action": "Implement and Enforce Secure Deletion Policies and Tools",
      "mitigation": "Use specialized tools to securely wipe data from media before disposal or repurposing.",
      "check": "Are secure deletion methods (e.g., data shredding software) used for all data carriers before disposal or transfer? Is full-disk encryption enabled on assets storing sensitive data? Are temporary files and swap partitions configured to be wiped on shutdown?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Deletion and Destruction), specifically Requirement CON.6.A1 (Rules for secure deletion and destruction).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Deletion_and_destruction_edition_2023.pdf?__blob=publicationFile (BSI CON.6)",
      "detectionLogic": "This rule triggers on all in-scope technical assets that are of a type that stores data (e.g., datastores, file systems, clients) or are modeled to store data assets.",
      "riskAssessment": "The likelihood of this vulnerability being present is high by default on most standard systems. The likelihood of exploitation depends on the asset's lifecycle (e.g., disposal, theft).",
      "falsePositives": "The risk might be a false positive if secure deletion is handled by platform-level controls modeled in detail (e.g., a cloud provider's physical media destruction policy for which the user has contractual guarantees).",
      "cwe": "212",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "26_sec3.ts",
      "bsiCode": "CON.6",
      "id": "improper-media-sanitization-by-supplier",
      "title": "Improper Media Sanitization by External Service Provider (BSI CON.8, DER.1)",
      "description": "When data media (e.g., datastores, hard drives) are deleted or destroyed by external service providers, the information contained on them can be disclosed if the process for involving the service provider is not sufficiently regulated and secured.",
      "impact": "Failure to properly sanitize media before disposal or transfer to an external party can lead to the disclosure of all data stored on it. This can result in a severe breach of confidentiality, leading to reputational damage, financial loss, and legal or regulatory penalties, especially if sensitive personal or business data is involved.",
      "action": "Establish and Enforce Secure Media Sanitization Procedures with Third Parties",
      "mitigation": "Implement a robust, contractually-enforced process for media sanitization and destruction with external service providers. This must include clear responsibilities, secure transport and storage of media, defined sanitization methods (e.g., compliant with NIST SP 800-88), and a requirement for the provider to issue a verifiable certificate of destruction for each item. The process should be audited periodically.",
      "check": "Are there formal contracts with external service providers that explicitly detail secure media sanitization and destruction requirements? Is there a documented process for handling, transporting, and verifying the destruction of media? Are certificates of destruction collected and archived?",
      "asvs": "Derived from BSI IT-Grundschutz Bausteine CON.8 (Deletion and Destruction) and DER.1 (General Service Provider Management).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Deletion_and_destruction_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any 'datastore' asset that has a communication link to an 'external-entity' asset, which represents an external service provider. The assumption is that such a link might be used for management or decommissioning activities. The risk is heightened if the datastore contains highly sensitive data.",
      "riskAssessment": "The impact is determined by the highest confidentiality and integrity of the data stored on the asset. The likelihood is considered 'likely' if a data transfer or management connection to an external entity exists without explicit modeling of security controls for media disposal (which is the default assumption).",
      "falsePositives": "This risk can be a false positive if the communication link is used for purposes completely unrelated to system or data lifecycle management (e.g., only consuming a public API from the external entity). It is also a false positive if a robust, audited, and contractually-obligated deletion process exists, which cannot be fully represented in the threat model.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "26_sec4.ts",
      "bsiCode": "CON.6",
      "id": "improper-media-disposal-or-repair",
      "title": "Improper Disposal or Handling of Defective Data Media",
      "description": "If defective data carriers or IT devices are disposed of or sent for repair without the data on them having been securely erased or destroyed, the data could be disclosed during the disposal or repair process.",
      "impact": "The unauthorized disclosure of sensitive information stored on the media. This constitutes a confidentiality breach and can lead to non-compliance with legal or contractual requirements,",
      "action": "Establish and Enforce a Secure Media Sanitization and Disposal Policy",
      "mitigation": "Implement a formal policy for handling defective or end-of-life data media that contain sensitive information.",
      "check": "Is there a documented and enforced policy for handling defective or end-of-life data media? Are personnel trained on this policy?",
      "asvs": "V14.3.1 (Verify that all sensitive data is securely erased when it is no longer needed.)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for data stores on physical or virtual machines that handle sensitive data. The risk is considered mitigated if the asset is tagged with '@Mitigation:SecureMediaDisposalProcess'.",
      "riskAssessment": "The impact is determined by the highest confidentiality and integrity of the data stored on the asset.",
      "falsePositives": "This risk can be a false positive if a robust, enforced disposal process exists but is documented in the threat model via the mitigation tag.",
      "cwe": "459",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "27_sec1.ts",
      "bsiCode": "CON.7",
      "id": "espionage-during-foreign-travel",
      "title": "Espionage During Foreign Travel (BSI Threat)",
      "description": "Espionage refers to attacks aimed at collecting, evaluating, and processing information about institutions, individuals, or products.",
      "impact": "Successful espionage during foreign travel leads to a breach of confidentiality and integrity of sensitive data.",
      "action": "Implement Secure Travel Policies and Device Hardening",
      "mitigation": "Establish a clear information security policy for foreign travel. Use dedicated, hardened 'travel devices' with minimal necessary data and applications.",
      "check": "Is there a security policy for foreign travel? Are employees trained on these risks? Are portable devices used for travel hardened and encrypted?",
      "asvs": "This threat scenario is described by the BSI IT-Grundschutz Compendium but does not map to a single Baustein. It's a cross-cutting threat ('Gefährdung') relevant to assets used outside of controlled environments.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/scenarios/sg_3_2_mobile_working_and_teleworking_edition_2023.pdf?__blob=publicationFile (Related BSI Scenario)",
      "detectionLogic": "This risk is triggered for portable technical assets (e.g., laptops, mobile phones) tagged as being used for foreign travel.",
      "riskAssessment": "The likelihood of an espionage attempt is considered likely for any international travel, especially when high-value data is involved.",
      "falsePositives": "The risk might be considered a false positive if the travel is to a demonstrably low-risk country and no sensitive data is on the device.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "27_sec2.ts",
      "bsiCode": "CON.7",
      "id": "unsafe-handling-of-information-during-travel",
      "title": "Unsafe Handling of Information during Business Travel (BSI CON.1-Scenario)",
      "description": "During business travel, there is an increased risk of unintentional disclosure or compromise of sensitive information.",
      "impact": "A compromise during travel can lead to the theft, manipulation, or destruction of data stored on the device, violating its Confidentiality and Integrity.",
      "action": "Implement Secure Travel Policies and Technical Controls",
      "mitigation": "Establish a clear security policy for business travel. Mandate the use of technical controls such as Full-Disk Encryption (FDE) for all travel devices.",
      "check": "Are all travel devices equipped with FDE? Is a corporate VPN enforced for remote connections?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Mobile Device Management), especially Requirement CON.1.A5 (Use of mobile devices in public spaces).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Mobile_device_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any in-scope client-type technical asset (e.g., laptop, mobile device)",
      "riskAssessment": "The likelihood of an incident is high if a travel device lacks basic controls like encryption. The impact is directly related to the",
      "falsePositives": "A model cannot confirm actual user behavior. An organization may have strong, enforced travel security policies that mitigate this risk in practice,",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "27_sec3.ts",
      "bsiCode": "CON.7",
      "id": "spoofing-in-untrusted-environments-con3",
      "title": "Spoofing and Identity Theft during Communication in Untrusted Environments (BSI CON.3)",
      "description": "During communication in untrusted environments (e.g., while traveling, in foreign facilities), there is an increased risk of identity theft and spoofing attacks.",
      "impact": "Successful spoofing or identity theft attacks can lead to the unauthorized disclosure of sensitive information and compromise data integrity.",
      "action": "Implement Strong Authentication and Encrypted Communication Channels",
      "mitigation": "All communication, especially across trust boundaries or from untrusted locations, must be protected by strong, end-to-end encryption (e.g., TLS 1.2+).",
      "check": "Are all communication links, especially those crossing trust boundaries, using encrypted protocols (e.g., HTTPS, SFTP, WSS)? Is strong, multi-factor, or certificate-based authentication used? Are assets used in high-risk locations explicitly managed with heightened security controls?",
      "asvs": "V4.1: Communication Security Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule checks all communication links. It flags links that cross a trust boundary without using both encryption and strong authentication.",
      "riskAssessment": "The likelihood of exploitation is high for unencrypted or non-authenticated communication across trust boundaries. The impact is determined by the sensitivity (Confidentiality and Integrity) of the data assets transmitted over the link. A link carrying 'Strictly Confidential' data without proper protection will result in a critical risk.",
      "falsePositives": "This risk might be a false positive if compensating controls exist outside the model, such as a mandatory, always-on corporate VPN that protects all traffic from a travel laptop, even if the direct link is modeled as HTTP.",
      "cwe": "295",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "27_sec5.ts",
      "bsiCode": "CON.7",
      "id": "risk-of-data-leakage-during-international-travel-con3",
      "title": "Risk of Data Leakage During International Travel (BSI CON.3)",
      "description": "When traveling abroad, personnel must consider differing laws and regulations at the destination, which can vary significantly from national laws.",
      "impact": "Failure to adhere to foreign legal requirements or to secure IT assets during international travel can lead to unauthorized access, data theft, or forced disclosure of sensitive information.",
      "action": "Implement Policies and Technical Controls for International Travel",
      "mitigation": "Establish a clear security policy for international travel. Technical assets used for travel must have full-disk encryption (FDE) enabled.",
      "check": "Is there a specific policy for international travel? Are mobile devices used for travel equipped with FDE and mandatory VPN?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Mobile Workplace), which addresses the protection of IT systems and data used outside the organization's premises.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_workplace_edition_2023.pdf?__blob=publicationFile (BSI CON.3)",
      "detectionLogic": "This risk is identified for any technical assets representing mobile or client systems (e.g., Laptops, Mobile Phones) that are tagged as being used for international travel.",
      "riskAssessment": "The likelihood of exploitation is considered high due to increased threats like unsecured networks, physical theft, or legal coercion at borders.",
      "falsePositives": "A risk might be considered a false positive if the organization can demonstrate robust, enforced technical controls and mandatory, destination-specific training for all international travel,",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "27_sec6.ts",
      "bsiCode": "CON.7",
      "id": "coercion-during-foreign-travel-con4",
      "title": "Coercion, Bribery, or Blackmail During Foreign Travel (BSI CON.4)",
      "description": "When traveling abroad, personnel may face elevated security risks due to varying political and social circumstances.",
      "impact": "Successful coercion or bribery of an employee can lead to the circumvention of established information security controls.",
      "action": "Develop and enforce a secure travel policy and provide pre-travel security briefings.",
      "mitigation": "Establish a comprehensive security policy for international travel. This policy should include pre-travel security briefings tailored to the destination's risk level.",
      "check": "Is there a formal security policy for international travel? Are employees, especially those in high-risk roles or traveling to high-risk destinations, given security briefings?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.4 (Dienstreisen und mobile Endgeräte / Business trips and mobile devices) and ORP.4 (Personal / Personnel).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_4_Dienstreisen_und_mobile_Endgeraete.pdf?__blob=publicationFile (BSI CON.4 German)",
      "detectionLogic": "This organizational and physical risk is detected by identifying technical assets likely used during international travel and associated with personnel in sensitive roles.",
      "riskAssessment": "Likelihood is considered HIGH if a sensitive role is traveling internationally, as they are a prime target. The potential for coercion is significant.",
      "falsePositives": "The risk might be lower if the travel is to a low-risk country or if the organization has strong, untracked compensating controls (e.g., rigorous real-world travel security protocols).",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "27_sec7.ts",
      "bsiCode": "CON.7",
      "id": "disinformation-during-business-travel-con-6-a22",
      "title": "Disinformation During Business Travel (BSI CON.6.A22)",
      "description": "During business travel abroad, personnel may be intentionally fed false or misleading information to deceive them.",
      "impact": "If deception is successful, false statements can be incorporated into business-critical reports and systems.",
      "action": "Implement Verification and Corroboration Procedures for Information Gathered Abroad",
      "mitigation": "Personnel traveling abroad must be trained on the risks of disinformation. Establish clear procedures for verifying and corroborating critical information gathered from external or untrusted sources during travel.",
      "check": "Are travelers aware of disinformation risks? Are there defined processes for validating information from untrusted sources abroad? Is there an approval or review step for critical data gathered during travel?",
      "asvs": "BSI IT-Grundschutz Kompendium: CON.6 Auslandseinsatz (Deployment in foreign countries), Requirement A22",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/con/con_6_auslandseinsatz.pdf?__blob=publicationFile (German)",
      "detectionLogic": "This risk is triggered for technical assets that process or store high-integrity data and are tagged as being used in a business travel context (e.g., via a `@Context:BusinessTravel` tag).",
      "riskAssessment": "The likelihood is considered 'Likely' given the targeted context of foreign travel where adversaries may operate with more freedom.",
      "falsePositives": "This risk can be considered a false positive if the asset, despite being used abroad, only consumes pre-vetted information from trusted internal sources and does not allow for the input of new, unverified information.",
      "cwe": "915",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "28_sec1.ts",
      "bsiCode": "CON.8",
      "id": "loss-or-theft-of-mobile-devices-con1",
      "title": "Loss or Theft of Mobile Devices (BSI CON.1)",
      "description": "Mobile devices, especially when used outside of secured company premises or while traveling, are highly susceptible to being lost or stolen. The smaller and more desirable the device, the higher the risk.",
      "impact": "The loss of a mobile device can lead to a breach of confidentiality if sensitive data is not adequately protected. This can result in financial loss, reputational damage to the institution, and violation of legal or contractual obligations (e.g., @DataType:PII).",
      "action": "Implement and Enforce Mobile Device Security Policies",
      "mitigation": "All mobile devices must have data-at-rest encryption enabled (e.g., full-disk encryption).",
      "check": "Are all mobile devices that handle company data managed by an MDM? Is data-at-rest encryption enforced?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Mobile device). Specifically relates to Threat G 0.14 (Loss of mobile IT systems).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Mobile_device_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
      "detectionLogic": "This risk is raised for all in-scope technical assets of technology 'mobile-app' or 'IoT-device'.",
      "riskAssessment": "The impact is determined by the highest sensitivity (Confidentiality, Integrity, and Availability) of the data assets processed or stored by the mobile device.",
      "falsePositives": "A device might be classified as mobile but used in a fixed, physically secure location (e.g., a tablet in a kiosk). In such cases, the risk of loss or theft might be significantly lower and could be considered a false positive or accepted with justification.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "28_sec2.ts",
      "bsiCode": "CON.8",
      "id": "unsuitable-development-environment",
      "title": "Unsuitable or Individual Development Environment",
      "description": "If an unsuitable development environment is used, or if employees choose their own environments individually,",
      "impact": "Using non-standardized or unsuitable development tools can inject vulnerabilities or defects into the final software product,",
      "action": "Standardize and Vet Development Toolchain",
      "mitigation": "Define a standardized, mandatory development and build environment (toolchain) for all custom-developed components.",
      "check": "Is there a defined, mandatory development toolchain for all developers? Are the tools within this toolchain vetted for security and kept up-to-date?",
      "asvs": "V14.3.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Secure_Software_Development_Lifecycle_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for in-scope technical assets marked as 'custom-developed parts'.",
      "riskAssessment": "The likelihood is considered high if the development process is modeled or if a component appears to be built outside the modeled process.",
      "falsePositives": "The organization might have a well-defined and secure development process that is simply not fully represented in the threat model.",
      "cwe": "937",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "28_sec3.ts",
      "bsiCode": "CON.8",
      "id": "insufficient-software-development-qa",
      "title": "Insufficient Quality Assurance in Software Development",
      "description": "Due to a missing or insufficient quality assurance (QA) process during software development, vulnerabilities can be introduced into the delivered software. If security QA is not firmly anchored in the development process, errors, vulnerabilities, and manipulations in the design or implementation may not be detected. This risk applies to both custom-developed code and the use of third-party or open-source components, which may contain known vulnerabilities.",
      "impact": "Unchecked vulnerabilities in software can be exploited by attackers, leading to a compromise of Confidentiality (data breaches), Integrity (unauthorized data modification), and Availability (denial of service). This can result in significant financial loss, reputational damage, and failure to meet compliance requirements.",
      "action": "Integrate Security-Focused Quality Assurance into the Development Lifecycle",
      "mitigation": "Establish a robust quality assurance process within the Secure SDLC. This includes using Static Application Security Testing (SAST) and Dynamic Application Security Testing (DAST) tools, as well as Software Composition Analysis (SCA) to identify vulnerabilities in third-party libraries. Integrate these checks into the CI/CD pipeline (e.g., by linking a 'build-pipeline' or 'sourcecode-repository' asset to a 'code-inspection-platform' asset in the model). Complement automated scanning with manual code reviews and regular penetration testing for critical components. Track and remediate all identified vulnerabilities in a timely manner.",
      "check": "Is there a 'code-inspection-platform' asset in the model connected to development assets? Are custom-developed assets tagged with 'sast-scanned', 'dast-scanned', 'dependency-scan-ok', or 'pentest-covered'? Is there a formal process for tracking and fixing vulnerabilities found during QA?",
      "asvs": "ASVS V4.0.3 - 14.2 Software Component Verification Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for any in-scope, custom-developed technical asset that is tagged with a relevant QA-mitigation tag (e.g., 'sast-scanned', 'dependency-scan-ok') and has no communication link to a 'code-inspection-platform' asset.",
      "riskAssessment": "The likelihood is high for internet-facing or other exposed assets built with less protected technologies (like web applications). The impact is determined by the maximum CIA requirements of the asset and the data it processes or stores. An asset handling 'strictly-confidential' data without any QA process poses a critical risk.",
      "falsePositives": "A risk might be a false positive if the QA process exists but is not modeled (e.g., QA is performed by a third party and not represented by an asset or tag in the model).",
      "cwe": "937",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "28_sec4.ts",
      "bsiCode": "CON.8",
      "id": "insufficient-software-documentation",
      "title": "Insufficient Software Documentation (BSI APP.4.4)",
      "description": "If software is not properly documented, or is documented inadequately, during the conception or development phase, it can lead to delayed or impossible diagnosis and resolution of potential errors.",
      "impact": "Incorrect operation or administration due to poor documentation can disrupt IT services, cause incorrect work results, delay workflows, and lead to security vulnerabilities (e.g., through misconfiguration).",
      "action": "Create and Maintain Comprehensive Software Documentation",
      "mitigation": "Ensure that comprehensive documentation is created and maintained throughout the software lifecycle. This includes:",
      "check": "Is there up-to-date documentation for developers, administrators, and users? Is the documentation comprehensive and clear enough to allow for secure operation, maintenance, and future development? Are secure configuration options clearly documented?",
      "asvs": "ASVS V1.1.2 (Architecture) - Verify that security-related documentation is created for each component or service in a system, including secure configuration, and API security.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk applies to all in-scope technical assets that are marked as having custom-developed parts (`custom_developed_parts: true`).",
      "riskAssessment": "The impact is determined by the criticality (Confidentiality, Integrity, and Availability) of the custom-developed asset. An asset with poor documentation that handles mission-critical data poses a much higher risk.",
      "falsePositives": "This is a process-related risk. An asset might be marked as custom-developed, but the project may have excellent and thorough documentation.",
      "cwe": "1035",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "28_sec5.ts",
      "bsiCode": "CON.8",
      "id": "insecure-development-environment",
      "title": "Insecure Development Environment (BSI CON.1)",
      "description": "If the development environment is insufficiently secured, the software being produced can be manipulated.",
      "impact": "Manipulation of the software supply chain can lead to backdoors or vulnerabilities in production systems, compromising the confidentiality, integrity, and availability of all data they process.",
      "action": "Secure the Development Lifecycle and Environment",
      "mitigation": "Implement strong access controls for all development systems (source code repositories, build pipelines, artifact registries).",
      "check": "Are all development-related assets (repositories, pipelines) identified? Is access to them restricted and logged?",
      "asvs": "BSI IT-Grundschutz CON.1: Software Development",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Software_development_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule checks for technical assets relevant to software development (e.g., 'SourcecodeRepository', 'BuildPipeline', 'ArtifactRegistry').",
      "riskAssessment": "The impact is determined by the criticality of the assets that are built or deployed by the development environment. Manipulating a pipeline that deploys a mission-critical service has a 'Very High' impact.",
      "falsePositives": "The risk might be flagged as 'accepted' if compensating controls exist outside the model (e.g., network-level IPS/IDS, strict physical access controls for on-premise servers).",
      "cwe": "829",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "28_sec6.ts",
      "bsiCode": "CON.8",
      "id": "conceptual-software-flaws",
      "title": "Conceptual Software Flaws (historically grown, hard to maintain)",
      "description": "As software grows in functionality, its code often becomes more complex. If the code is not properly structured based on a sound software architecture, it can be very difficult to maintain.",
      "impact": "The primary impact is an increased likelihood of unpatched or unpatchable vulnerabilities, which can be exploited to compromise the confidentiality, integrity, or availability of the system and its data.",
      "action": "Refactor or Replace Complex/Legacy Components",
      "mitigation": "For new development, establish and enforce a clear software architecture that emphasizes modularity, separation of concerns, and maintainability.",
      "check": "Is the software architecture for custom-developed components clearly documented? Is the code modular and testable?",
      "asvs": "V1 Architecture, Design and Threat Modeling Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for all in-scope, custom-developed technical assets.",
      "riskAssessment": "The impact is determined by the confidentiality and criticality of the asset and the data it processes or stores. An unmaintainable system handling mission-critical data poses a very high risk.",
      "falsePositives": "This risk might be a false positive if a 'legacy' or complex custom-developed system has been maintained exceptionally well, with up-to-date documentation, a modular internal structure, and a strong test suite.",
      "cwe": "1125",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "28_sec7.ts",
      "bsiCode": "CON.8",
      "id": "insufficient-software-testing-and-release-procedures",
      "title": "Insufficient Software Testing and Release Procedures (related to BSI CON.1/CON.3)",
      "description": "If new software is not sufficiently tested and formally released, critical errors and security vulnerabilities may go undetected.",
      "impact": "Failure to adequately test software can lead to the disclosure, manipulation, or destruction of sensitive information.",
      "action": "Implement and Enforce a Secure Software Development Lifecycle (SSDLC)",
      "mitigation": "Establish a formal process for testing and releasing all custom-developed software components. This process should include mandatory security testing, such as Static Application Security Testing (SAST),",
      "check": "Is there a documented testing strategy for custom-developed software? Are security testing tools integrated into the CI/CD pipeline?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (General Software Development) and CON.3 (Software Tests).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_software_development_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for all in-scope, custom-developed technical assets that are of a type that typically contains complex business logic (e.g., web applications, web services, application servers).",
      "riskAssessment": "The likelihood of exploitation is directly related to the complexity of the custom code and the lack of a structured testing process.",
      "falsePositives": "A risk might be flagged for a component that is covered by a comprehensive, organization-wide testing process that is explicitly modeled.",
      "cwe": "287",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "28_sec8.ts",
      "bsiCode": "CON.8",
      "id": "testing-with-production-data",
      "title": "Testing with Production Data (BSI CON.1.A15)",
      "description": "When new software is tested using production data, unauthorized individuals (e.g., developers, testers) may gain access to confidential information, such as sensitive personal data.",
      "impact": "If this risk materializes, it can lead to severe data breaches (Confidentiality), data corruption (Integrity), and service outages (Availability).",
      "action": "Use Anonymized, Pseudonymized, or Synthetic Data for Testing",
      "mitigation": "Strictly separate test and production environments. Establish and enforce a policy that prohibits the use of real production data in test environments.",
      "check": "Is there a documented policy for test data management? Are test and production environments logically and physically separated? What processes are in place to generate safe test data (anonymization, synthesis)? How is access to test environments controlled and monitored?",
      "asvs": "BSI IT-Grundschutz CON.1.A15 (Separation of test and production data)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_application_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified when a technical asset that appears to be in a test or development context processes or stores sensitive production-grade data.",
      "riskAssessment": "The impact is directly related to the confidentiality and integrity rating of the production data asset being used. A high impact is assumed if 'strictly-confidential' or 'mission-critical' data is involved.",
      "falsePositives": "A 'devops' communication link might be used for legitimate administrative access to a production system, not for application testing. This rule may flag such cases as false positives.",
      "cwe": "200",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "29_sec1.ts",
      "bsiCode": "CON.9",
      "id": "interruption-of-data-transmission-con1",
      "title": "Interruption of Data Transmission (BSI CON.1)",
      "description": "Information exchange can be disturbed, delayed, or completely interrupted due to technical failures or performance bottlenecks in communication links or their connected components.",
      "impact": "If information is not delivered on time, is incomplete, or is not delivered at all, business processes that depend on this data can be significantly impaired or fail completely.",
      "action": "Implement Resilient and Performant Communication Channels",
      "mitigation": "Ensure that data with high-availability requirements is transmitted over resilient communication channels.",
      "check": "Are communication links for critical systems designed for high availability? Are the technical assets involved in the data transmission (source and target) marked as redundant? Is there active monitoring of link performance and error rates?",
      "asvs": "Related to OWASP ASVS V1 Architectural Requirements, particularly V1.11 for availability and resiliency design.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Redundancy_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for communication links that are critical for availability but show signs of being a single point of failure.",
      "riskAssessment": "The impact is determined by the highest availability requirement of the data being transferred or the assets involved. The likelihood is based on the lack of redundancy of the participating assets. A non-redundant component handling mission-critical data poses a significant availability risk.",
      "falsePositives": "The model may not capture all forms of physical or network-level redundancy (e.g., BGP, diverse fiber paths) that are not explicitly modeled as separate components.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "29_sec2.ts",
      "bsiCode": "CON.9",
      "id": "missing-confidentiality-agreement-con7",
      "title": "Risk of Data Misuse due to Missing or Inadequate Confidentiality Agreement (related to BSI CON.7)",
      "description": "Sensitive information can fall into the hands of unauthorized persons if a confidentiality agreement (e.g., an NDA) was not concluded or was poorly formulated before an information exchange with an external party. This lack of a formal agreement increases the risk of data misuse, as there are no binding rules on how the external party can handle the received information.",
      "impact": "Without a clear and binding confidentiality agreement, sensitive data exchanged with external parties can be misused, disclosed, or handled improperly. This can lead to a breach of confidentiality, reputational damage, competitive disadvantage, and potential legal or financial penalties, especially if personal or business-critical data is involved.",
      "action": "Establish and Enforce Confidentiality Agreements for External Data Exchange",
      "mitigation": "For any communication link with an external entity that involves the transfer of sensitive data (rated 'restricted' or higher), ensure a formal, legally-reviewed confidentiality agreement or Non-Disclosure Agreement (NDA) is in place. Once confirmed, add the tag `@nda-signed` to the respective communication link in the threat model to mark this risk as mitigated.",
      "check": "Review all communication links to/from assets of type 'external-entity'. If sensitive data is exchanged, verify that a binding confidentiality agreement exists. Check if the communication link is tagged with `@nda-signed`.",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.7 (Exchange of information). Requirement CON.7.A3 (Agreements on information transfer) requires establishing formal transfer policies, procedures, and controls.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_7_Exchange_of_information_edition_2023.pdf?__blob=publicationFile (BSI CON.7)",
      "detectionLogic": "This rule checks all communication links that connect to a technical asset of type `external-entity`. If such a link transfers data with a confidentiality rating of 'restricted' or higher and is not tagged with `@nda-signed`, a risk is generated.",
      "riskAssessment": "The impact of this risk is directly proportional to the confidentiality level of the data being exchanged. The likelihood is considered high if no agreement is in place, as there is no formal barrier to misuse. The highest confidentiality level of the data assets transferred over the communication link determines the impact.",
      "falsePositives": "A risk might be flagged if a confidentiality agreement exists but has not been documented in the model using the `@nda-signed` tag. It can also be a false positive if the data exchange is covered by a broader Master Service Agreement (MSA) specific to this individual link.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "29_sec3.ts",
      "bsiCode": "CON.9",
      "id": "accidental-data-leakage",
      "title": "Accidental Data Leakage (based on BSI Threat Description)",
      "description": "Sensitive information can be inadvertently sent to unauthorized recipients due to human error, insufficient training, or a lack of clear procedures. Examples include sending data to the wrong email address, or transmitting documents that contain hidden residual information (like internal comments or insufficiently deleted data).",
      "impact": "This can lead to a breach of confidentiality for sensitive data, resulting in non-compliance with legal or contractual requirements (like @DataType:PII), reputational damage, and financial loss.",
      "action": "Implement Controls for Data in Transit",
      "mitigation": "Use Data Loss Prevention (DLP) tools to monitor and block unauthorized transmission of sensitive information. Enforce strong authorization on communication channels, especially for external-facing protocols like email. Implement data sanitization to strip metadata and comments from files before they are sent. Provide regular, targeted training to all personnel on secure data handling procedures and how to identify and protect sensitive information.",
      "check": "Are data-in-transit controls (like DLP) in place for sensitive data flows? Are file-sharing and email protocols properly secured and access-controlled? Does the organization provide mandatory, regular training on data handling and classification?",
      "asvs": "Related to concepts in BSI IT-Grundschutz CON.1 (General data protection) and DER.1 (Detection of security-related events).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_data_protection_Print_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified by analyzing communication links that transfer sensitive data (Confidentiality of 'restricted' or higher). The risk is elevated for protocols prone to human error (like SMTP, FTP, SMB) or those with weak or missing authentication/authorization, especially if they cross trust boundaries.",
      "riskAssessment": "The impact is directly rated based on the confidentiality of the data being transferred (e.g., 'strictly-confidential' data leads to 'very-high' impact). The likelihood increases with weaker protocols (like unencrypted SMTP/FTP) and the absence of authentication or other compensating controls like VPN or IP filtering.",
      "falsePositives": "This risk might be a false positive if there are out-of-band compensating controls in place, such as a separate, mandatory DLP gateway that scans all outgoing email, or if the specific data flow is highly proceduralized and automated, reducing the chance of human error.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "29_sec4.ts",
      "bsiCode": "CON.9",
      "id": "unprotected-data-in-transit-or-at-rest-bsi",
      "title": "Unprotected Data In-Transit or At-Rest (BSI CON.1, SYS.1.6)",
      "description": "Information and data can be surreptitiously intercepted (Information Disclosure) or altered (Tampering) if not adequately protected.",
      "impact": "Successful exploitation leads to the loss of confidentiality and/or integrity of the affected data. Attackers can steal sensitive information (e.g., credentials, personal data, business secrets), inject malicious content (like malware into file transfers), or manipulate critical data. This can result in data breaches, financial loss, reputational damage, and legal consequences.",
      "action": "Enforce Encryption for Data In-Transit and At-Rest",
      "mitigation": "All communication links transmitting data across trust boundaries MUST use a strong, encrypted protocol (e.g., TLS 1.3+, HTTPS, SFTP, WSS, encrypted database protocols).",
      "check": "Review all communication links in the architecture. Do they use an encrypted protocol, especially when crossing trust boundaries or transmitting sensitive data?",
      "asvs": "BSI IT-Grundschutz: CON.1 (General data transmission), SYS.1.6 (Servers under Windows and Linux). Maps to OWASP ASVS V5: V9.1 (Communications) and V7.2 (Cryptographic Storage).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule identifies risks in two scenarios:",
      "riskAssessment": "The likelihood of exploitation is higher for data in-transit over untrusted networks (like the internet). The impact is directly proportional to the sensitivity (CIA rating) of the data being transmitted or stored. Transmitting 'Strictly Confidential' data over an unencrypted link poses a very high impact. Storing 'Mission Critical' data on an unencrypted database is similarly severe.",
      "falsePositives": "A communication link might be part of a physically secured, isolated network where the risk of interception is considered acceptable.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "29_sec5.ts",
      "bsiCode": "CON.9",
      "id": "unencrypted-transmission",
      "title": "Unencrypted Transmission of Sensitive Data",
      "description": "The protection of information during transmission using cryptographic methods can be undermined by attacks. If cryptographic methods are not applied correctly, an attacker can intercept and access the transmitted data. This is especially true if sensitive data is sent over an unencrypted communication channel across a trust boundary. The BSI warns that inadequately protected communication can lead to data interception and manipulation.",
      "impact": "If sensitive data is transmitted unencrypted, it can be intercepted and read (loss of confidentiality) or modified (loss of integrity) by an attacker with access to the communication path. This can lead to data breaches, unauthorized access to systems, financial loss, and reputational damage.",
      "action": "Enforce Encrypted Communication",
      "mitigation": "Ensure that all communication links carrying sensitive data across trust boundaries use strong, encrypted protocols (e.g., HTTPS, TLS, SFTP, JDBC-encrypted). Disable weak cipher suites. Use a VPN as a compensating control if the native protocol cannot be encrypted. Ensure keys are managed securely and separately from the data they protect.",
      "check": "Are all communication links between different trust boundaries using an encrypted protocol? Is a VPN used for unencrypted protocols? Are there any links carrying confidential or critical data that are unencrypted?",
      "asvs": "V9.1: Verify that all communications between components are encrypted in transit.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for communication links that cross trust boundaries and are not encrypted (i.e., do not use a protocol like HTTPS, TLS, etc.) and are not protected by a VPN. The risk is raised if these links transmit data with a confidentiality level higher than 'Public' or an integrity level higher than 'Operational'.",
      "riskAssessment": "The likelihood is influenced by the network exposure (e.g., internet vs. internal) and compensating controls like IP filtering. The impact is determined by the highest confidentiality and integrity of the data assets transmitted over the link.",
      "falsePositives": "The risk might be a false positive if other, un-modeled compensating controls are in place (e.g., a hardware-based network encryptor). It can also be considered a false positive for certain monitoring or security protocols that intentionally operate on unencrypted traffic within a controlled environment.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "2_sec1.ts",
      "bsiCode": "APP.1.2",
      "id": "malicious-code-execution-in-browser",
      "title": "Malicious Code Execution in Web Browser",
      "description": "Web browsers regularly load data from untrusted sources. Such data can contain executable malicious code that exploits vulnerabilities and infects the user's IT system without their knowledge.",
      "impact": "If malicious code is executed via the browser, an attacker can compromise the client system. This can lead to theft of sensitive data (Information Disclosure), manipulation of data or system files (Tampering), or installation of ransomware (Denial of Service).",
      "action": "Implement and Enforce Browser and Endpoint Security Hardening",
      "mitigation": "Ensure browsers are kept up-to-date with the latest security patches through a managed process. Disable or restrict unnecessary or risky plugins and extensions.",
      "check": "Are all client web browsers centrally managed and automatically updated? Is there a policy for allowed/disallowed browser extensions? Are security configurations for browsers enforced? Is an endpoint protection solution with browser security features active?",
      "asvs": "BSI IT-Grundschutz SYS.3.2.1 Web Browser",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Web_browser_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any in-scope technical asset identified with the 'Browser' technology type. Browsers, by their nature, process untrusted content from the internet, making them a primary vector for client-side attacks.",
      "riskAssessment": "The likelihood is considered 'Very-Likely' due to the constant exposure of web browsers to untrusted internet content. The impact is directly related to the CIA requirements of the client system and the data it processes or can access.",
      "falsePositives": "This risk is fundamental to using a web browser for general internet access. It can be considered a false positive only in rare cases where the browser is used in an extremely restricted 'kiosk' mode, limited to a small, fully trusted set of internal-only websites, and is unable to download any external content or files.",
      "cwe": "94",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "2_sec2.ts",
      "bsiCode": "APP.1.2",
      "id": "exploitation-of-client-side-vulnerabilities",
      "title": "Exploitation of Client-Side Vulnerabilities",
      "description": "Vulnerability lists and exploit kits significantly simplify the development of custom malware.",
      "impact": "If client-side vulnerabilities are successfully exploited, attackers can install malware (like ransomware, spyware, or keyloggers) on the client system.",
      "action": "Implement Client Hardening, Patch Management, and Endpoint Protection",
      "mitigation": "Keep client operating systems, browsers, and all extensions/plugins up-to-date with the latest security patches.",
      "check": "Are client systems and browsers centrally managed and kept up-to-date with security patches? Is a modern EDR/antivirus solution deployed and active on all clients?",
      "asvs": "BSI IT-Grundschutz: SYS.2.1 Web Browser, SYS.1.2.2 Client under Windows, SYS.1.3 Client under macOS",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_1_Web_browser_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for all in-scope technical assets identified as client systems (e.g., technology types: Browser, Desktop, Mobile App, etc.).",
      "riskAssessment": "The likelihood of exploitation is very high for unmanaged client systems connected to the internet, as they are exposed to automated scanning and drive-by attacks.",
      "falsePositives": "This risk may be a false positive if robust, centrally-managed compensating controls (like a comprehensive EDR, strict application whitelisting, or a non-persistent VDI environment) are in place but n@SystemType:OT modeled.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "2_sec3.ts",
      "bsiCode": "APP.1.2",
      "id": "insecure-communication-over-internet",
      "title": "Insecure Communication over the Internet",
      "description": "The fundamental security of communication over the internet depends significantly on the authentication methods used and the encryption of data in transit.",
      "impact": "If communication is not effectively secured, sensitive information can be intercepted (violating Confidentiality) or modified in transit (violating Integrity).",
      "action": "Enforce Strong Authentication and Encryption for Communication",
      "mitigation": "All communication links, especially those crossing trust boundaries or carrying sensitive data, must use strong, state-of-the-art encrypted protocols (e.g., using TLS 1.2/1.3, SSH).",
      "check": "Review all communication links in the model. Verify that any link carrying sensitive data or crossing a trust boundary uses an encrypted protocol (e.g., HTTPS, FTPS, WSS, LDAPS, etc.).",
      "asvs": "V4: Communication Security",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule checks all communication links in the model. It triggers a risk if a link uses an unencrypted protocol, especially when it crosses a trust boundary, involves an internet-facing asset, or is not protected by a VPN.",
      "riskAssessment": "The impact is determined by the highest Confidentiality and Integrity requirements of the data assets transmitted over the link.",
      "falsePositives": "A risk might be a false positive if the communication occurs over a completely isolated and physically secured network segment where interception is considered impossible.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "2_sec4.ts",
      "bsiCode": "APP.1.2",
      "id": "malicious-browser-components-from-untrusted-sources",
      "title": "Malicious Browser Components from Untrusted Sources (BSI SYS.1.2.1)",
      "description": "If web browsers, plug-ins, or extensions are obtained from untrusted sources, malicious functions can be executed unintentionally and unnoticed.",
      "impact": "Compromise of client systems through malicious browser components can lead to phishing, unauthorized data access and exfiltration (breach of confidentiality),",
      "action": "Enforce Secure Software Sourcing and Client Hardening",
      "mitigation": "Only obtain browsers, plugins, and extensions from trusted, official sources (e.g., official vendor websites, corporate software portals).",
      "check": "Are there effective technical controls and policies that prevent users from installing software from untrusted sources? Is there a central, vetted software repository for users? Are client systems regularly scanned for unauthorized software?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.1.2.1 (Allgemeiner Client). The described threat aligns with fundamental secure configuration principles.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html",
      "detectionLogic": "This risk applies to any client-side technical asset used by a human to interact with the internet or other systems. The rule identifies assets configured as human-operated clients (e.g., browsers, desktops) which, without proper controls, are susceptible to this threat.",
      "riskAssessment": "The likelihood is considered high in environments without strict controls on software installation. The impact is directly related to the sensitivity of the data accessed or processed by the user via the compromised client. Accessing mission-critical systems with a compromised browser results in a very high impact.",
      "falsePositives": "This risk might be a false positive in environments where, despite the technical possibility, strong organizational policies and user training effectively prevent the installation of untrusted software. Verifying the effectiveness of such non-technical controls is required to dismiss the risk.",
      "cwe": "829",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "2_sec5.ts",
      "bsiCode": "APP.1.2",
      "id": "insecure-browser-configuration",
      "title": "Insecure Web Browser Configuration (BSI APP.3.2)",
      "description": "If web browsers are configured insecurely, confidential data can be accidentally or maliciously exposed to unauthorized third parties. Passwords can also be unintentionally shared. If cookies, passwords, history, form data, and search queries are stored, or unnecessary extensions are enabled, data can be more easily read and misused by third parties or malware.",
      "impact": "This can lead to the theft of credentials, session hijacking, disclosure of sensitive personal or business data, and unauthorized access to other systems, compromising the confidentiality and integrity of information.",
      "action": "Secure Browser Configuration and Management",
      "mitigation": "Enforce a secure baseline configuration for all browsers used to access corporate resources. This includes disabling password saving, clearing history/cookies on exit, restricting or auditing browser extensions, and using privacy-enhancing features. Use Mobile Device Management (MDM) or Group Policies (GPO) to enforce these settings. Educate users on the risks of insecure browser settings and extensions.",
      "check": "Are there centrally managed, enforced security policies for web browsers? Is password saving disabled in the browser? Is the installation of unapproved extensions blocked or monitored? Are users trained on secure browser usage?",
      "asvs": "BSI IT-Grundschutz Baustein APP.3.2 Web-Browser",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_Web_browser_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Triggers for any client-type technical assets (e.g., Browser, Desktop, Mobile App) that communicate with other assets handling sensitive data (rated 'Restricted'/'Important' or higher). The risk assumes that unmanaged or insecurely configured clients pose a threat to the data they access.",
      "riskAssessment": "The likelihood is considered higher for clients that are external or directly exposed to the internet, as they are less likely to be under strict corporate control. The impact is determined by the maximum confidentiality and integrity ratings of the assets the client connects to. Accessing a 'Strictly Confidential' system from an insecure browser has a very high impact.",
      "falsePositives": "This risk can be considered a false positive if endpoint security measures (like browser isolation/virtualization) are in place but n@SystemType:OT modeled, or if the client asset is used in a context (e.g., public kiosk) where it never accesses sensitive systems or data.",
      "cwe": "522",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "30_sec4.ts",
      "bsiCode": "DER.1",
      "id": "unintentional-data-leakage-on-mobile-device-app4.4",
      "title": "Unintentional Data Leakage on Mobile End-Device (BSI APP.4.4)",
      "description": "Data is transferred to and from a mobile application through various channels provided by the mobile operating system.",
      "impact": "If sensitive data is not properly protected on the mobile device, it can be exfiltrated by other malicious applications,",
      "action": "Implement Secure Data Handling and Storage on Mobile Devices",
      "mitigation": "Sensitive data should not be stored on the mobile device unless absolutely necessary. If storage is required, use platform-provided secure,",
      "check": "Is sensitive data stored locally on the device? If so, is it encrypted using platform-provided secure storage mechanisms?",
      "asvs": "BSI IT-Grundschutz APP.4.4.A5 (Protection of local data). Also relates to OWASP MASVS V2 (Data Storage and Privacy Requirements).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_Mobile_applications_edition_2022.pdf?__blob=publicationFile (BSI APP.4.4)",
      "detectionLogic": "This risk is triggered for all in-scope technical assets of type 'Mobile App' that process or store data with a confidentiality rating of 'Restricted' or higher.",
      "riskAssessment": "The likelihood and impact of this risk are determined by the highest confidentiality level of the data processed or stored by the mobile application.",
      "falsePositives": "This risk is raised based on the potential for data leakage. A model cannot verify the implementation details of specific controls like disabled clipboard access",
      "cwe": "922",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "30_sec5.ts",
      "bsiCode": "DER.1",
      "id": "inadequate-monitoring-of-network-boundaries",
      "title": "Inadequate Monitoring of Network Boundaries (BSI DER.1.A4)",
      "description": "If no detection systems are used and the detection functions available in IT systems and applications are not used, attackers can more easily penetrate the institution's network without being noticed.",
      "impact": "Successful exploitation can lead to undetected attackers persisting in the network, accessing or exfiltrating sensitive data, and potentially escalating privileges to compromise further systems. This directly threatens the confidentiality and integrity of information.",
      "action": "Implement Intrusion Detection/Prevention Systems (IDS/IPS)",
      "mitigation": "Deploy IDS/IPS solutions to monitor traffic at critical network boundaries, especially where trust levels change.",
      "check": "Are network communications, especially those crossing trust boundaries, monitored by an IDS/IPS? Are alerts from these systems reviewed and acted upon? Are logs from relevant assets collected and analyzed?",
      "asvs": "BSI IT-Grundschutz DER.1.A4 Use of systems for attack detection (IDS)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Detection_of_security-relevant_events_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers for all communication links that cross a trust boundary.",
      "riskAssessment": "The likelihood of an undetected intrusion is considered very likely for unmonitored network boundary crossings.",
      "falsePositives": "Can occur if monitoring solutions (e.g., host-based or agent-based IDS) are not represented in the threat model.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "30_sec6.ts",
      "bsiCode": "DER.1",
      "id": "insufficient-personnel-for-log-analysis-orp4",
      "title": "Insufficient Personnel for Log Analysis and Monitoring (related to BSI ORP.4)",
      "description": "If there is not enough personnel to evaluate log data, security-relevant events cannot be fully detected. This can lead to attacks remaining hidden for extended periods or only being discovered after significant damage, such as data exfiltration, has already occurred.",
      "impact": "A failure to detect security incidents in a timely manner can compromise the confidentiality, integrity, and availability of critical systems and data. It may allow attackers prolonged unauthorized access, leading to severe data breaches, system disruption, and a delayed incident response, which magnifies the overall business impact.",
      "action": "Ensure Sufficient Staffing for Security Monitoring and Analysis",
      "mitigation": "Allocate adequate and qualified personnel for the regular analysis of log data and the evaluation of security-relevant events. Establish clear processes and responsibilities for monitoring activities, including reviewing logs from critical assets. Utilize security automation and tooling (e.g., SIEM) to support the security team and ensure that alerts are managed effectively. Also, maintain a process for evaluating external threat intelligence to proactively identify vulnerabilities.",
      "check": "Are there dedicated personnel or a team (e.g., a SOC) responsible for security monitoring? Is there a defined and followed process for log review? Is the workload for security analysis considered manageable for the current staff? Is there tooling in place to aggregate and analyze logs from critical systems?",
      "asvs": "BSI IT-Grundschutz ORP.4: Detection of Security-Relevant Events, specifically Requirement ORP.4.A5 (Personnel resources for the detection of security-relevant events).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Detection_of_security-relevant_events_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This organizational risk is raised for critical, in-scope technical assets that are not client-side technologies. The assumption is that these assets produce valuable log data that requires monitoring. The risk is heightened for assets with high confidentiality, integrity, or availability requirements, as the impact of an undetected incident would be greater. Monitoring and security control platforms themselves are excluded.",
      "riskAssessment": "The likelihood is considered 'Likely' as understaffed security teams are a common organizational challenge. The impact is calculated based on the CIA ratings of the technical asset in question. A highly critical asset with sensitive data will result in a high-impact risk, while a less critical asset will result in a lower impact.",
      "falsePositives": "This risk is organizational and cannot be fully verified by the technical model alone. The organization may have a well-staffed 24/7 SOC and robust monitoring processes, which would render this risk a false positive. Confirmation requires discussion with the operations and security teams about their monitoring capabilities and resources.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "31_sec1.ts",
      "bsiCode": "DER.2.1",
      "id": "inadequate-incident-handling-con1",
      "title": "Inadequate Handling of Security Incidents (BSI CON.1)",
      "description": "In practice, security incidents can never be completely ruled out, even with many security measures in place.",
      "impact": "Without a proper procedure for handling security incidents, wrong decisions can be made under pressure.",
      "action": "Establish and Maintain a Formal Incident Response Process",
      "mitigation": "Define and implement a comprehensive incident response plan. This includes clear procedures for detection, reporting, analysis, containment, eradication, and recovery.",
      "check": "Is there a documented incident response plan? Are roles and responsibilities for incident handling clearly defined?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Security Incident Management). Specifically relates to requirements like CON.1.A4 (Preparation for handling security incidents) and CON.1.A5 (Reporting and handling security incidents).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Security_incident_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
      "detectionLogic": "This is an organizational risk. The model identifies technical assets where effective and timely incident response is most critical.",
      "riskAssessment": "Likelihood is HIGH if no formal incident response plan exists or is tested. Likelihood is MEDIUM if a plan exists but is not well-communicated or regularly practiced.",
      "falsePositives": "This risk is organizational. The model can only identify assets where incident response is *critical*.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "31_sec2.ts",
      "bsiCode": "DER.2.1",
      "id": "improper-incident-handling-and-evidence-destruction",
      "title": "Improper Incident Handling and Evidence Destruction (BSI DER.2)",
      "description": "If personnel react improperly or fail to follow established procedures after a security incident,",
      "impact": "The primary impact is the loss of forensic evidence, which prevents a proper investigation into the incident's cause, scope, and damage.",
      "action": "Establish and Train Formal Incident Response Procedures with Evidence Preservation.",
      "mitigation": "Develop a formal, documented incident response plan that includes clear procedures for evidence preservation (e.g., isolating systems instead of shutting them down, creating forensic images of disks and memory before performing remediation).",
      "check": "Is there a formal incident response plan? Does it include specific steps for evidence preservation? Are IT and security personnel trained on this plan? Are roles and responsibilities for incident handling clearly defined?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein DER.2 (Security Incident Management).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/DER_2_Behandlung_von_Sicherheitsvorfaellen_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This is an organizational risk that applies to critical systems where an incident would require a formal response.",
      "riskAssessment": "The likelihood is considered 'Likely' by default, assuming a lack of a formal, trained incident response process. This should be adjusted based on the organization's actual maturity.",
      "falsePositives": "This risk is inherently organizational. An organization might have excellent incident response procedures in place that are not visible in the threat model.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "32_sec1.ts",
      "bsiCode": "DER.2.2",
      "id": "improper-handling-of-@DataType:PII-during-forens@SystemType:ICS",
      "title": "Improper Handling of Personal Data during IT Forensic Investigations (BSI-Style)",
      "description": "During IT forensic investigations, it is common to copy, secure, and analyze all data deemed necessary. This data frequently includes personal data of employees, partners, or customers. If this data is accessed without a valid legal basis or without the involvement of the Data Protection Officer (DPO), the institution may violate legal regulations (e.g., @DataType:PII's purpose limitation principle). Furthermore, there is a risk that employee behavior can be inferred from the collected data or that a direct link to individuals can be established, leading to violations of both internal and external regulations.",
      "impact": "Violating data protection laws and internal policies can lead to significant legal fines, reputational damage, and loss of trust. Improper access to personal data compromises its confidentiality and can disrupt business processes if forensic activities are challenged or halted due to non-compliance.",
      "action": "Establish and Enforce Data Handling Procedures for Forensic Investigations",
      "mitigation": "Define and document clear procedures for all IT forensic investigations. These procedures must:",
      "check": "Are there documented, formally approved procedures for conducting IT forensic investigations? Do these procedures explicitly address the handling of personal data and mandate the involvement of the DPO? Are access controls for forensic evidence stores implemented and audited?",
      "asvs": "Derived from BSI IT-Grundschutz principles in DER.1 (Data Protection) and CON.8 (Handling of security incidents). Forensic processes must adhere to fundamental data protection principles like purpose limitation, data minimization, and lawful processing.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Data_protection_edition_2023.pdf?__blob=publicationFile (BSI DER.1)",
      "detectionLogic": "This risk is raised for any technical assets identified as part of the forens@SystemType:ICS workflow (tagged with `@forens@SystemType:ICS-tool` or `@forensic-datastore`) that process or store sensitive data (Confidentiality of 'Restricted' or higher, or tagged with `@DataType:PII`). The presence of such a workflow without assured procedural safeguards represents a significant risk.",
      "riskAssessment": "The likelihood of this risk is considered 'Likely' if formal, audited procedures for forensic data handling are not in place. The impact is determined by the highest confidentiality level of the personal data being handled by the forensic asset, ranging from 'Medium' for restricted data to 'Very High' for strictly confidential data.",
      "falsePositives": "This risk may be a false positive if robust, audited, and enforced procedures for handling personal data during forens@SystemType:ICS are already in place. The technical model alone cannot verify the existence or effectiveness of such organizational controls.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "32_sec2.ts",
      "bsiCode": "DER.2.2",
      "id": "improper-evidence-handling-bsi",
      "title": "Improper Handling and Securing of Digital Evidence (BSI-based)",
      "description": "If digital evidence is secured incorrectly or not quickly enough, important data can be lost that cannot be recovered later.",
      "impact": "The loss or corruption of digital evidence compromises the integrity of post-incident investigations.",
      "action": "Establish and Regularly Practice Forensic Readiness and Evidence Handling Procedures",
      "mitigation": "Develop and document clear, step-by-step procedures for evidence collection, including the preservation of volatile data (e.g., memory, network state) and non-volatile data (e.g., disk images).",
      "check": "Are there documented procedures for digital evidence collection? Are personnel trained on these procedures and the use of forensic tools? Are drills conducted to test forensic readiness?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein DER.4 (Incident Management), specifically requirement DER.4.A19 (Forensic analysis of IT systems).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_4_Incident_Management_edition_2023.pdf?__blob=publicationFile (BSI DER.4)",
      "detectionLogic": "This organizational risk is raised against technical assets that are critical for security and incident analysis.",
      "riskAssessment": "The likelihood is considered high for critical systems if no explicit forensic readiness measures are in place, as mistakes are common under the pressure of a real incident.",
      "falsePositives": "This risk is procedural and organizational. The model identifies assets where this weakness would have the greatest impact.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "33_sec1.ts",
      "bsiCode": "DER.2.3",
      "id": "apt-firmware-persistence",
      "title": "APT Persistence via Firmware/Hardware Manipulation",
      "description": "Advanced Persistent Threats (APTs) aim for long-term infiltration of target networks. A sophisticated technique is to install persistent backdoors by manipulating low-level, hardware-near components like system firmware (e.g., UEFI/BIOS). Such modifications are extremely difficult to detect and can survive traditional incident response measures like reinstalling the operating system or replacing hard drives. The BSI warns that attackers might even compromise firmware update routines, ensuring their malicious code persists even after a legitimate update is applied. This grants the attacker a permanent, stealthy foothold inside the IT infrastructure.",
      "impact": "Successful exploitation results in a complete and persistent compromise of the affected asset's integrity and confidentiality. Attackers can exfiltrate data, tamper with critical processes, pivot to other systems, and maintain long-term, virtually undetectable access to the corporate network.",
      "action": "Implement Hardware and Firmware Integrity Verification and Control",
      "mitigation": "For critical assets, implement a defense-in-depth strategy for hardware security. Use platforms with a hardware-based root of trust (e.g., TPM). Enforce Secure Boot to ensure only signed and trusted firmware, bootloaders, and operating systems can execute. Where possible, use remote attestation to continuously verify the integrity of platforms before granting them access to sensitive parts of the network. Maintain a secure supply chain for hardware procurement to prevent tampering before deployment.",
      "check": "Are critical systems equipped with TPMs? Is Secure Boot enabled and actively enforced? Is there a process for remote attestation to verify platform integrity? Is the hardware supply chain managed and trusted?",
      "asvs": "This advanced threat exceeds the scope of most standard ASVS checks. However, it relates to the principles of system integrity verification, such as in section V14. Related NIST guidelines like SP 800-193 (Platform Firmware Resiliency) are highly relevant.",
      "cheatSheet": "https://csrc.nist.gov/publications/detail/sp/800-193/final",
      "detectionLogic": "This rule triggers on high-value technical assets that are attractive targets for APTs. The risk is raised for assets that are either explicitly tagged as high-value targets or are internet-facing systems processing or storing sensitive data. The risk is considered for physical, virtual, and containerized machines, as they all rely on underlying host firmware.",
      "riskAssessment": "The impact of such a compromise is always considered 'Very High'. The likelihood is adjusted based on the asset's value and exposure. For an internet-facing, mission-critical system, the likelihood of being targeted with such an attack is considered 'Very Likely'. For other high-value systems, it is 'Likely'. The resulting severity is typically 'High' or 'Critical'.",
      "falsePositives": "A risk might be flagged on an asset where this attack vector is deemed non-viable. This can be considered a false positive if the organization can demonstrate robust and actively monitored hardware-level security controls (e.g., strictly enforced Secure Boot, remote attestation) that effectively mitigate this specific threat.",
      "cwe": "494",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "33_sec2.ts",
      "bsiCode": "DER.2.3",
      "id": "destruction-of-forensic-evidence-after-apt",
      "title": "Destruction of Forensic Evidence after an APT Incident (BSI CON.3)",
      "description": "After an Advanced Persistent Threat (APT) incident, IT systems are often reinstalled or decommissioned to remove the threat.",
      "impact": "Destroying forensic evidence prevents a thorough analysis of the security incident. This can make it impossible to determine the full scope of the compromise,",
      "action": "Establish and Adhere to a Forensic-Ready Incident Response Plan",
      "mitigation": "A formal incident response plan must be in place that explicitly mandates the creation of forensic images (disk and memory) of affected systems *before* any recovery or re-installation procedures begin.",
      "check": "Is there a documented incident response plan? Does the plan explicitly require forensic imaging before system recovery?",
      "asvs": "BSI IT-Grundschutz CON.3 Security Incident Management, specifically CON.3.A15 Forensic investigations.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Security_incident_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organizational risk is raised for all in-scope technical assets that are client systems or external entities.",
      "riskAssessment": "The likelihood of this risk materializing during a real incident is considered 'Likely' if a formal, tested incident response plan with forensic procedures is in place.",
      "falsePositives": "This risk is procedural and organizational. A model cannot verify the existence or quality of an incident response plan.",
      "cwe": "223",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "33_sec3.ts",
      "bsiCode": "DER.2.3",
      "id": "apt-premature-cleanup-detection",
      "title": "Premature Detection of APT Remediation (BSI-OPS.1.2.5)",
      "description": "During the response to an Advanced Persistent Threat (APT), attackers who are still active within the infrastructure might detect the analysis and cleanup activities.",
      "impact": "If attackers detect the remediation efforts, they can actively work to undermine them. This can lead to a failed cleanup, prolonged attacker presence, installation of deeper and more resilient backdoors, destruction of evidence, and intentional sabotage of critical systems. The result is a more severe and costly incident, potentially compromising the integrity, availability, and confidentiality of the entire IT infrastructure.",
      "action": "Establish and Use Secure Out-of-Band (OOB) Channels for Incident Response",
      "mitigation": "All communication and coordination for responding to critical incidents like APTs MUST be conducted over a separate, trusted infrastructure (OOB channel) that is isolated from the compromised network. Remediation activities should be planned as a coordinated, simultaneous operation to prevent tipping off the attacker. Tag communication links used for this purpose in the model with `@out-of-band-management` to signify they use a secure OOB channel.",
      "check": "Is there a documented incident response plan that mandates OOB channels for high-impact incidents? Are technical assets used for these channels modeled and isolated? Are remediation plans designed for simultaneous, coordinated execution?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.2.5 (Incident Handling). This risk describes a specific threat during the remediation phase of an APT incident, where attackers detect the cleanup activities.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_Reaktion_auf_Sicherheitsvorfaelle_und_Schadensereignisse_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies administrative or DevOps-related communication links (`usage: devops`) that are explicitly marked as using an out-of-band channel via the `@out-of-band-management` tag. The assumption is that using the standard, potentially compromised network for incident response or high-privilege administration on critical assets risks detection by a resident APT.",
      "riskAssessment": "The likelihood is high if administrative tasks are performed 'in-band' on critical assets, as APTs are expected to monitor such activities to maintain their foothold. The impact is directly related to the CIA value of the target asset and the overall business criticality, as a failed cleanup can lead to catastrophic damage.",
      "falsePositives": "An out-of-band channel might exist in reality but is not documented in the Threagile model with the `@out-of-band-management` tag. This risk should be confirmed with the operations and security teams.",
      "cwe": "507",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "33_sec4.ts",
      "bsiCode": "DER.2.3",
      "id": "service-disruption-during-apt-cleanup",
      "title": "Service Disruption During APT Incident Cleanup (BSI Scenario)",
      "description": "During the cleanup of an Advanced Persistent Threat (APT) incident, various IT systems may need to be reinstalled and networks temporarily isolated. This necessary remediation can lead to the failure of IT systems and services, making them limited or completely unavailable.",
      "impact": "If the cleanup process is prolonged, especially due to a lack of sufficient or accessible documentation for rebuilding, it can severely impact the institution's productivity. This can result in significant economic losses, which may even become an existential threat to the organization. This risk is most acute for critical, non-redundant systems.",
      "action": "Develop and Maintain a Comprehensive Incident Response and Business Continuity Plan",
      "mitigation": "Establish a robust incident response plan that includes procedures for isolating and remediating compromised systems after an APT. Crucially, maintain up-to-date and accessible documentation for all critical systems to enable rapid and predictable rebuilding (e.g., Infrastructure as Code, configuration backups, detailed runbooks). Regularly test the recovery procedures through drills and simulations to minimize downtime and ensure business continuity. Implementing redundancy for critical components can prevent a total service outage during remediation.",
      "check": "Is there a documented incident response plan for major threats like APTs? Is system documentation for recovery complete, current, and readily available? Are recovery procedures regularly tested? Are critical systems designed with redundancy?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.4 (Incident Response), specifically CON.4.A7 (Handling security incidents), and OPS.1.1.5 (Standard operating procedures), which covers the need for recovery documentation.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_4_Incident_Response_edition_2023.pdf?__blob=publicationFile (BSI CON.4)",
      "detectionLogic": "This risk is triggered for in-scope technical assets with high-availability requirements that lack redundancy. The assumption is that such assets represent single points of failure, and their remediation after an APT incident would cause a significant service outage, as described in the BSI scenario.",
      "riskAssessment": "Likelihood is based on the probability of a successful APT attack requiring major cleanup, which can be considered 'Likely' for many organizations. The impact is directly tied to the availability requirement of the affected asset. For a 'Mission-Critical' asset, the impact is 'Very High' as its unavailability can be existential. The impact is exacerbated if the asset is non-redundant and documentation for a swift recovery is inadequate.",
      "falsePositives": "The model cannot verify the quality of an organization's incident response plans or system documentation. This risk should be accepted or mitigated based on a manual review of the organization's business continuity and disaster recovery (BCDR) capabilities for the identified asset.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "33_sec5.ts",
      "bsiCode": "DER.2.3",
      "id": "apt-lateral-movement-and-persistence",
      "title": "APT Lateral Movement and Persistence (based on BSI Threat Scenario)",
      "description": "In an Advanced Persistent Threat (APT) attack, attackers gain detailed knowledge of the target environment's architecture and configuration, including network segments, system naming schemes, accounts, and deployed software. With this knowledge, attackers can move stealthily and efficiently within the network (lateral movement). Even after a partial cleanup, they may leverage this understanding to quickly regain access and re-establish a high degree of compromise, making complete eradication difficult.",
      "impact": "If an attacker establishes a foothold on a critical system, they can leverage it to compromise other connected systems. This can lead to widespread data exfiltration, manipulation of critical business processes, persistent long-term access, and significant disruption. The ability to move laterally multiplies the potential damage from a single initial breach.",
      "action": "Implement and Enforce Strong Network Segmentation, Access Control, and Threat Detection",
      "mitigation": "Employ a defense-in-depth strategy. Use micro-segmentation to isolate critical systems and restrict east-west traffic. Apply the principle of least privilege to all service and user accounts. Enforce strong, multi-factor authentication (MFA) for all administrative access and critical service-to-service communication. Implement robust logging and monitoring across the infrastructure, using Network and Endpoint Detection and Response (NDR/EDR) solutions to detect anomalous behavior indicative of lateral movement. Use egress filtering to prevent data exfiltration.",
      "check": "Are internal network segments and trust boundaries properly isolated? Is traffic between critical systems monitored for anomalies? Is access based on the principle of least privilege? Is strong authentication required for administrative and service-to-service communication?",
      "asvs": "Derived from BSI threat descriptions for Advanced Persistent Threats. Related concepts include BSI Bausteine DER.1 (Detection) and OPS.1.1.5 (Handling security incidents).",
      "cheatSheet": "https://www.bsi.bund.de/EN/Top@SystemType:ICS/Cyber-Security/Analyses-and-Trends/APT/apt_node.html",
      "detectionLogic": "This rule identifies high-value technical assets (high RAA, critical CIA ratings). It then checks for outgoing communication links to other high-value assets, which could serve as pathways for lateral movement. The risk is elevated if these pathways exist, especially across trust boundaries or with weak authentication, as they represent how an APT might expand their control after an initial compromise.",
      "riskAssessment": "The impact is determined by the sensitivity of the initial asset and the most critical asset it can reach. A high-value asset that can communicate with many other critical systems presents a very high impact. The likelihood is based on the number of potential lateral movement paths and the strength of the controls on those paths (e.g., authentication). An environment with many unrestricted pathways from one critical system to another is considered more likely to be exploited for lateral movement.",
      "falsePositives": "The model may flag legitimate and necessary communication between critical systems. This risk requires a qualitative assessment to confirm if the existing monitoring, authentication, and access control measures for these connections are sufficient to mitigate the threat of lateral movement.",
      "cwe": "288",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "34_sec1.ts",
      "bsiCode": "DER.3.1",
      "id": "un-restarted-temporarily-disabled-security-measures",
      "title": "Security Measures Temporarily Disabled but Not Re-Enabled",
      "description": "The overall security level of an application or system depends on all security measures being implemented completely and correctly.",
      "impact": "If security controls are not re-enabled, the system operates at a lower security level than designed.",
      "action": "Establish and Enforce Secure Configuration and Change Management Processes",
      "mitigation": "Establish strict change management procedures that include checklists for disabling and re-enabling security functions.",
      "check": "Are there documented procedures for temporarily disabling and re-enabling security controls? Is there an automated system to verify the security configuration baseline against a golden image? Are alerts generated for disabled security controls?",
      "asvs": "V14.2 Configuration Verification",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Hardening_Cheat_Sheet.html",
      "detectionLogic": "This risk is common on systems that are manually configured or undergo frequent manual changes during deployment or maintenance.",
      "riskAssessment": "The likelihood is considered higher for systems requiring manual intervention during deployment or updates. The impact is directly related to the",
      "falsePositives": "This risk might be flagged for assets even if the organization has very mature, checklist-driven, or automated operational procedures that prevent this from happening.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "34_sec2.ts",
      "bsiCode": "DER.3.1",
      "id": "ineffective-or-uneconomical-security-measures",
      "title": "Ineffective or Uneconomical Security Measures",
      "description": "When security measures are implemented without considering practical aspects of their use, they might be ineffective or uneconomical.",
      "impact": "If security controls can be bypassed or are misapplied, assets they are meant to protect are exposed to threats, potentially leading to the compromise of their confidentiality, integrity, or availability. This can result in data breaches, system takeovers, and other security incidents despite the presence of security measures, creating a false sense of security.",
      "action": "Review and Harden Access Paths to Critical Assets",
      "mitigation": "Ensure that all access paths to a sensitive asset are protected with a consistent and appropriate level of security.",
      "check": "Review all incoming communication links to sensitive assets. Are there any links that lack authentication or encryption, especially when other links to the same asset are well-secured? Is it possible for an attacker to use a 'back door' to bypass the intended 'front door' security?",
      "asvs": "Based on BSI IT-Grundschutz CON.1 (Security concept and policies), which emphasizes the need for a coherent and appropriate set of security measures.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Security_concept_and_policies_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks for architectural inconsistencies in access control. It identifies sensitive technical assets that have at least one strongly authenticated incoming communication link but also at least one weak (unauthenticated) remote communication link. This constellation suggests a potential bypass of the intended security controls.",
      "riskAssessment": "The impact is determined by the CIA requirements of the asset being protected. A higher-value asset leads to a higher impact. The likelihood is considered high because the weak access path is readily available for exploitation. The risk is raised for each weak 'back door' path found.",
      "falsePositives": "A weak or unauthenticated link might be deliberately in place for a low-risk, public-facing function (like a health check endpoint that reveals no sensitive data), while authenticated links are for administrative access. This requires manual verification. However, unauthenticated access to sensitive systems is generally discouraged.",
      "cwe": "693",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "34_sec3.ts",
      "bsiCode": "DER.3.1",
      "id": "lack-of-independent-isms-review",
      "title": "Lack of Independent ISMS Review",
      "description": "In many institutions, the Information Security Officer (ISO) is responsible for verifying the implementation of security measures.",
      "impact": "If the ISMS is not independently and effectively audited, the overall security level of the institution can be significantly degraded.",
      "action": "Establish and Execute a Regular, Independent ISMS Audit Program",
      "mitigation": "Implement a formal process for regularly auditing the ISMS. These audits must be performed by a party independent of the Information Security Officer's direct operational responsibilities (e.g., a dedicated internal audit team or a qualified external third party).",
      "check": "Is there a documented process for auditing the ISMS? Are audits performed by a party independent of the ISO? Is there a recent audit report available? Are findings tracked to resolution?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium, Baustein ORP.3 'Internal Audit', specifically Requirement ORP.3.A3 'Independence of the auditors', which stresses the need for auditors to be independent of the activity being audited.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_Internal_audit_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.3)",
      "detectionLogic": "This is an organizational risk related to governance and process assurance. In a technical model, this risk is surfaced by attaching it to assets that are central to security management.",
      "riskAssessment": "The likelihood is considered HIGH if there is no established independent audit process for the ISMS. The impact is determined by the highest sensitivity of the assets and data managed under the ISMS, as a process failure at this level puts all protected assets at risk. The risk is calculated based on the CIA rating of the specific technical asset it is attached to in the model.",
      "falsePositives": "This risk is inherently organizational and cannot be validated from a technical model alone. The model surfaces the risk based on the presence of a security management role.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "34_sec4.ts",
      "bsiCode": "DER.3.1",
      "id": "inadequate-audit-or-review-orp-4-g1",
      "title": "Inadequate Audit or Review due to Unqualified or Unprepared Auditors (BSI ORP.4.G1)",
      "description": "If personnel conducting an audit or review are not sufficiently qualified or are inadequately prepared,",
      "impact": "A flawed audit can result in either an overestimation of security, leaving critical vulnerabilities unaddressed, or an underestimation,",
      "action": "Ensure Auditor Qualification and Preparation",
      "mitigation": "Ensure that internal and external auditors are appropriately qualified, independent, and have sufficient resources and time to prepare for and conduct audits.",
      "check": "Are there defined qualification criteria for auditors? Are audit plans and scopes documented? Are audit reports reviewed and tracked by management? Is there a process to ensure corrective actions are implemented and effective?",
      "asvs": "BSI IT-Grundschutz ORP.4 Audit and Review",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Audit_and_review_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This organizational risk is triggered by technical assets tagged with the `role:pruefer` (auditor/reviewer) tag.",
      "riskAssessment": "The likelihood is considered 'Likely' as a baseline, assuming a potential weakness in the organizational process for ensuring auditor qualification.",
      "falsePositives": "This risk is raised based on the presence of an audit-related role. The actual qualification and preparation of auditors cannot be determined from the technical model alone and requires reviewing the organization's audit processes and personnel qualifications.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "34_sec5.ts",
      "bsiCode": "DER.3.1",
      "id": "lack-of-central-audit-planning-orp2-a1",
      "title": "Lack of Central and Long-Term Audit Planning (BSI ORP.2.A1)",
      "description": "If audits and reviews are not planned centrally and for the long term, it can lead to an imbalanced audit scope.",
      "impact": "The primary impact is the inability to reliably assess the security status of the information system. Hidden vulnerabilities and non-compliance in unaudited areas may persist undetected.",
      "action": "Establish a Centralized, Risk-Based, and Strategic Audit Program",
      "mitigation": "Develop and implement a central, long-term audit plan that covers all relevant areas of the information system based on risk.",
      "check": "Is there a documented, long-term audit plan? Is the plan based on a risk assessment? Does it cover all critical systems and processes?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Information security auditing and review), Requirement ORP.2.A1 (Planning of information security audits).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Information_security_auditing_and_review_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.2)",
      "detectionLogic": "This is an organizational risk that cannot be detected directly from a technical model.",
      "riskAssessment": "The likelihood is considered 'Likely' as incomplete audit planning is a common organizational weakness.",
      "falsePositives": "This risk is inherently organizational. An organization might have a robust, centrally-managed audit program that is not reflected in the technical asset model.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "34_sec6.ts",
      "bsiCode": "DER.3.1",
      "id": "insufficient-audit-planning-orp3-g6",
      "title": "Insufficient Audit Planning (BSI ORP.3.G6)",
      "description": "If an audit or security check is poorly planned and not sufficiently coordinated with the institution, required personnel may not be available during the review.",
      "impact": "The primary impact is that existing security vulnerabilities, configuration errors, or non-compliance with security policies may go undetected.",
      "action": "Establish and Follow a Formal Audit and Security Check Process",
      "mitigation": "Define and implement a structured process for planning and conducting audits and security checks. This process must include clear communication channels,",
      "check": "Is there a documented procedure for planning audits and security checks? Are audit plans created, documented, and communicated in advance?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.3 (Security check and audit), Requirement ORP.3.A1 (Planning security checks).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_Security_check_and_audit_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.3)",
      "detectionLogic": "This is an organizational risk related to the audit process. It applies to technical assets that should be subject to audits.",
      "riskAssessment": "The likelihood is considered 'Likely' by default, as procedural gaps in audit planning are a common organizational weakness.",
      "falsePositives": "This risk is organizational and cannot be fully verified by the technical model alone. An organization might have a robust audit planning process.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "34_sec7.ts",
      "bsiCode": "DER.3.1",
      "id": "insufficient-compliance-with-co-determination-law",
      "title": "Insufficient Compliance with Co-determination Law during Audits",
      "description": "Data from audits and revisions can inadvertently contain information that allows for conclusions about employee performance.",
      "impact": "Violating co-determination laws can lead to legal disputes, fines, and a significant loss of trust between employees and management.",
      "action": "Establish Clear Policies for Audit Data Usage",
      "mitigation": "Clearly define and document the purpose of all auditing and logging activities, explicitly excluding employee performance evaluation.",
      "check": "Is there a written policy governing the use of audit and log data? Has the employee representation body formally approved this policy? Are access logs for audit data reviewed to prevent misuse?",
      "asvs": "Derived from user-provided BSI-style text. The principles align with BSI IT-Grundschutz Baustein DER.1 Data Protection, specifically requirements like DER.1.A6 'Involving the employee representation body'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Data_protection_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organizational risk is raised for technical assets that typically collect detailed, user-specific logs which could be repurposed for performance monitoring.",
      "riskAssessment": "The likelihood is considered 'Likely' if systems capable of detailed user logging exist, as the potential for misuse is inherent if policies are lacking.",
      "falsePositives": "This risk can only be confirmed by reviewing internal company policies and legal agreements with the employee representation body. A technical model cannot verify the existence or enforcement of such policies.",
      "cwe": "359",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "34_sec8.ts",
      "bsiCode": "DER.3.1",
      "id": "concealment-of-security-weaknesses-con1-a23",
      "title": "Concealment of Security Weaknesses (BSI CON.1.A23)",
      "description": "Employees, fearing that their mistakes will be discovered during audits, reviews, or testing, may attempt to conceal existing security problems or vulnerabilities. This can lead to a distorted and overly optimistic view of the actual security posture, leaving critical vulnerabilities unaddressed.",
      "impact": "Concealing vulnerabilities means they remain unaddressed and unmitigated, providing attackers with a persistent window of opportunity. The resulting false sense of security can lead to misinformed risk management decisions. Ultimately, this can result in severe security incidents, compromising the confidentiality, integrity, or availability of the system and associated data.",
      "action": "Foster a No-Blame Culture for Security Reporting",
      "mitigation": "Establish a clear, non-punitive process for reporting security weaknesses and errors. Management should actively promote a 'no-blame' culture where discovering and reporting vulnerabilities is rewarded, rather than punished. Emphasize that the goal of audits and reviews is system improvement, not assigning personal blame. Anonymous reporting channels can also help lower the barrier for employees to come forward.",
      "check": "Is there a formal policy for reporting security issues? Does the organizational culture encourage or discourage reporting errors? Are post-mortems of incidents focused on learning and improvement rather than blame? Are there anonymous reporting options available?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Security testing and exercises). This is an organizational risk related to human factors and company culture, which impacts the effectiveness of all technical verification and testing activities.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Security_testing_and_exercises_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This is an organizational risk related to human behavior and company culture. It cannot be detected automatically from a technical model. It is raised against assets that are likely to be subject to audits or reviews, especially those with custom-developed parts or those handling highly sensitive data, as the pressure to conceal failures is higher in these cases.",
      "riskAssessment": "The likelihood is HIGH in environments with a punitive or 'blame' culture and LOW in organizations with a mature, open, and blameless security culture. A 'Likely' exploitation is assumed as a baseline. The impact is directly proportional to the criticality (CIA) of the asset where a vulnerability is concealed. A hidden flaw in a mission-critical system has a 'Very High' impact.",
      "falsePositives": "This risk is always a potential false positive when generated from a technical model, as it depends entirely on the organizational culture, which cannot be modeled. Its presence should trigger a discussion about the company's security culture and reporting processes.",
      "cwe": "287",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "35_sec1.ts",
      "bsiCode": "DER.3.2",
      "id": "failure-to-implement-up-bund-2017",
      "title": "Failure to Implement UP Bund 2017 Requirements",
      "description": "The 'Umsetzungsplan für die Gewährleistung der IT-Sicherheit in der Bundesverwaltung' (UP Bund 2017) mandates that German federal agencies, and other institutions by law or contract, must implement an Information Security Management System (ISMS) based on BSI IT-Grundschutz standards. This includes using the standard security approach as a minimum requirement and regularly auditing the ISMS status using the 'Leitfaden für die Informationssicherheitsrevision'. Failure to establish, maintain, and regularly audit the ISMS in accordance with these requirements constitutes a direct violation of the UP Bund.",
      "impact": "Non-compliance with UP Bund 2017 can lead to significant legal, contractual, and financial penalties. It indicates a fundamental gap in the security governance, suggesting that required security controls (as defined by IT-Grundschutz) may be missing, unenforced, or unverified. This elevates the overall risk of security incidents, which could compromise the confidentiality, integrity, and availability of all information assets within the system's scope, leading to reputational damage and disruption of services.",
      "action": "Establish and Audit an ISMS based on BSI IT-Grundschutz",
      "mitigation": "Implement a comprehensive ISMS that fully aligns with the requirements of BSI IT-Grundschutz. This includes defining security policies, assigning responsibilities, implementing technical and organizational controls, and creating incident response plans. Crucially, conduct regular internal and external security audits based on the BSI's 'Leitfaden für die Informationssicherheitsrevision' to verify compliance and effectiveness. All audit findings must be tracked and remediated in a timely manner. Ensure that compliance documentation is maintained and readily available.",
      "check": "Is the organization obligated to comply with UP Bund 2017? Is a formal ISMS based on IT-Grundschutz established and actively maintained? Are regular IS audits, as required by the plan, being conducted and their results acted upon? Can compliance be demonstrated through documentation and audit reports?",
      "asvs": "Derived from German 'UP Bund 2017', which mandates the use of BSI IT-Grundschutz standards.",
      "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Oeffentliche-Verwaltung/IT-Grundschutz-in-Behoerden/it-grundschutz-in-behoerden_node.html",
      "detectionLogic": "This is an organizational compliance risk. In a Threagile model, it's triggered by the presence of the '@Compliance:UP-Bund-2017' tag on a technical asset. The risk assumes that if an asset falls under this regulation, the entire process of establishing and auditing an ISMS must be in place. The absence of such a process is the identified risk.",
      "riskAssessment": "The likelihood of this risk is considered high if the organization is subject to UP Bund 2017, as compliance is mandatory, but optional for non-OT system types. The impact is also inherently high due to the legal and procedural consequences of non-compliance. The impact is further elevated based on the CIA requirements of the assets governed by the regulation. A failure to implement the required security baseline exposes critical assets to a wide range of threats.",
      "falsePositives": "This risk can be considered a false positive if a robust, compliant, and regularly audited ISMS is indeed in place, but the threat model has not been updated to reflect this (e.g., via a risk tracking status change). Verification requires reviewing organizational compliance documentation, ISMS policies, and recent audit reports.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "35_sec10.ts",
      "bsiCode": "DER.3.2",
      "id": "concealment-of-security-deficiencies-during-audits",
      "title": "Concealment of Security Deficiencies during Audits (BSI-based)",
      "description": "Personnel might fear that an information security audit will reveal their mistakes. To avoid repercussions, they might conceal or downplay existing security problems, presenting a false picture of the actual security posture. This prevents the discovery and correction of security vulnerabilities.",
      "impact": "When security deficiencies are intentionally hidden, they remain uncorrected and can be exploited by attackers. Furthermore, management might misjudge the true risk level associated with a system, leading to poor security investment decisions and a false sense of security. This undermines the entire governance and audit process.",
      "action": "Foster a No-Blame Security Culture and Ensure Independent Audits",
      "mitigation": "Promote a security culture where reporting issues is encouraged and not punished. Ensure that security audits are conducted by independent parties (internal or external) who are separate from the teams being audited. Use automated tools for objective security scanning where possible. Establish clear procedures for reporting and remediating findings without assigning personal blame for unintentional errors. Management must communicate that the goal of audits is improvement, not punishment.",
      "check": "Is there a formal policy for 'no-blame' incident and vulnerability reporting? Are security audits performed by teams independent of the system owners/developers? Are audit results discussed constructively with a focus on remediation?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Information security governance), specifically opposing the principle of Requirement ORP.2.A5 (Reviewing information security), which requires transparent and regular reviews.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Information_security_governance_edition_2023.pdf?__blob=publicationFile (BSI ORP.2)",
      "detectionLogic": "This is an organizational and cultural risk. It is difficult to detect automatically. This rule raises the risk for technical assets where responsible personnel (like administrators or developers) might feel pressure to hide mistakes. It is triggered by assets tagged with specific roles.",
      "riskAssessment": "The likelihood is difficult to assess from the model alone but is assumed to be 'likely' in environments without a strong, blameless security culture. The impact is directly related to the criticality of the technical asset where a flaw is being concealed. Hiding a vulnerability on a mission-critical system has a very high impact.",
      "falsePositives": "This risk is inherently organizational and cultural. A model cannot verify the company culture. An organization might have a very healthy, open 'no-blame' culture, making this risk a false positive. Confirmation requires discussion with management and teams about audit processes and reporting culture.",
      "cwe": "1027",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "35_sec11.ts",
      "bsiCode": "DER.3.2",
      "id": "leakage-of-is-audit-information",
      "title": "Leakage of IS Audit Information (BSI ORP.3.A5)",
      "description": "During an information security audit, sensitive data such as identified vulnerabilities, security gaps, and potential attack vectors are collected and documented.",
      "impact": "If this audit information is leaked to unauthorized parties, it provides a direct roadmap for attacking the institution's systems.",
      "action": "Secure Handling and Storage of Audit Information",
      "mitigation": "Audit results and related documentation must be classified according to their sensitivity (e.g., 'Confidential' or 'Strictly Confidential').",
      "check": "Are audit results and reports classified and access-controlled? Are the systems storing this data hardened and monitored? Is encryption used for audit data storage and transmission?",
      "asvs": "BSI IT-Grundschutz ORP.3.A5 (Handling of audit results)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_Audit_and_review_of_information_security_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for technical assets that are likely to process or store sensitive IS audit information.",
      "riskAssessment": "The impact of a leak is determined by the sensitivity of the audit data, which is represented by the confidentiality rating of the technical asset or the data it handles.",
      "falsePositives": "The risk may be a false positive if the identified asset is part of a highly secured, segregated audit environment with strict access controls, even if n@SystemType:OT explicitly modeled as such.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "35_sec2.ts",
      "bsiCode": "DER.3.2",
      "id": "disabled-security-controls-reenabled",
      "title": "Security Controls Re-enabled (based on BSI)",
      "description": "The security level of an institution is influenced by whether security measures are implemented completely and correctly.",
      "impact": "Failure to re-enable security controls after temporary suspension leads to a persistent state of vulnerability.",
      "action": "Implement and Enforce Strict Change Management and Post-Change Validation Processes",
      "mitigation": "Establish a formal, audited process for temporarily disabling and re-enabling any security control.",
      "check": "Is there a formal change management process for altering security configurations? Is there an automated system to verify the security posture of assets after deployment or maintenance?",
      "asvs": "OWASP Top 10 2021: A05-Security Misconfiguration",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for technical assets and communication links where there's a contextual reason to believe security measures might be temporarily disabled.",
      "riskAssessment": "The likelihood of this risk is higher for assets undergoing frequent changes or active development.",
      "falsePositives": "This risk may be flagged for assets within a well-managed CI/CD pipeline where automated post-deployment checks already mitigate this process failure.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "35_sec3.ts",
      "bsiCode": "DER.3.2",
      "id": "impractical-or-ineffective-security-measures-bsi",
      "title": "Impractical or Ineffective Security Measures (BSI-style)",
      "description": "If security measures are implemented without taking practical aspects into account, these measures may be ineffective. For example, it is pointless to block an entrance area with turnstiles if employees can enter the building through an open side entrance instead. It can also happen that individual measures are taken that do not make economic sense. For example, for the protection of information with a normal need for protection with regard to confidentiality, an appropriately implemented rights and roles concept is more sensible and economical than setting up complex, certificate-based encryption on the file server.",
      "impact": "Ineffective measures create a false sense of security while leaving critical vulnerabilities open. This can result in security controls being bypassed, leading to unauthorized access, data breaches (loss of Confidentiality), data manipulation (loss of Integrity), or service disruption (loss of Availability). Over-engineered controls can increase complexity and cost without providing proportional security benefits.",
      "action": "Review and Refine Security Architecture and Control Selection",
      "mitigation": "Ensure security controls are placed appropriately within the data flow to be effective. For internet-facing systems, sensitive backend components should not be directly exposed. Instead, traffic should be routed through dedicated entry-point components like Reverse Proxies, WAFs, or API Gateways. Regularly review the architecture to identify and eliminate bypass routes. For data protection, select controls (like encryption) that are appropriate for the data's classification level to balance security with operational and economic viability.",
      "check": "Are there direct communication paths from untrusted networks (like the internet) to sensitive backend services, bypassing intended security controls (like WAFs, proxies)? Are the implemented security measures, such as encryption levels, proportional to the protection requirements of the assets?",
      "asvs": "Derived from BSI IT-Grundschutz principles. Aligns with OWASP Top 10 2021: A04 - Insecure Design.",
      "cheatSheet": "https://owasp.org/Top10/A04_2021-Insecure_Design/",
      "detectionLogic": "This rule identifies two potential architectural flaws: 1. A 'bypassed control' where an internet-exposed asset, which is not a typical gateway/proxy, communicates directly with a sensitive backend component. 2. An 'over-engineered control' where a datastore uses very strong encryption for data of only low-to-medium confidentiality.",
      "riskAssessment": "For bypassed controls, the likelihood is high if a direct, unfiltered path exists, and the impact is based on the CIA requirements of the target asset. For over-engineered controls, the risk is typically lower and relates more to operational complexity and cost, but can still indicate a misunderstanding of security requirements.",
      "falsePositives": "A direct connection might be intentionally designed and secured through other means (e.g., strong endpoint security, specific protocol hardening). A strong encryption choice might be a preemptive measure or required by a blanket policy. Manual verification is required.",
      "cwe": "501",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "35_sec4.ts",
      "bsiCode": "DER.3.2",
      "id": "lack-of-impartial-isms-audit",
      "title": "Lack of Impartial ISMS Audit (BSI ORP.4)",
      "description": "In many organizations, the Information Security Officer (ISO) is responsible for verifying the implementation of security measures.",
      "impact": "If the ISMS is not reviewed by an impartial entity, significant weaknesses in security governance, processes, and controls may go undetected.",
      "action": "Establish an Independent Audit Function for the ISMS",
      "mitigation": "Ensure that the ISMS is regularly audited by personnel who are independent of the ISMS management function (i.e., not the ISO).",
      "check": "Is there a documented process for auditing the ISMS? Is the entity (person or team) performing the ISMS audit demonstrably independent from the ISO and their team?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein ORP.4 (Internal and external audit), specifically Requirement ORP.4.A6 (Performing internal audits), which emphasizes the need for auditor objectivity and impartiality.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Internal_and_external_audit_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
      "detectionLogic": "This organizational risk is detected by checking for the presence of an Information Security Officer ('@Role:ITSecurityOfficer')",
      "riskAssessment": "The likelihood is considered 'Likely' if an ISO is defined without an independent auditor, as this structural conflict of interest directly enables the risk.",
      "falsePositives": "A false positive may occur if the audit function is performed by an external party not documented in the threat model, or if an internal asset performs audits but is not tagged with the 'role:pruefer' tag.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "35_sec5.ts",
      "bsiCode": "DER.3.2",
      "id": "inadequate-auditor-qualification-and-preparation",
      "title": "Inadequate Auditor Qualification and Preparation (BSI DER.2)",
      "description": "If an audit team ('Prüfteam') is not sufficiently qualified or prepares inadequately for audits,",
      "impact": "Flawed audit findings can result in a false sense of security, where critical vulnerabilities remain unaddressed.",
      "action": "Establish and Enforce a Formal Process for Auditor Selection and Audit Preparation",
      "mitigation": "Define clear, stringent qualification criteria for both internal and external auditors based on the scope and complexity of the systems being audited.",
      "check": "Is there a formal policy for selecting IS auditors? Are qualification criteria documented and enforced?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium: Baustein DER.2 'IS-Revision', particularly requirements DER.2.A5 'Auswahl geeigneter IS-Revisoren' (Selection of suitable IS auditors) and DER.2.A6 'Planung und Vorbereitung der IS-Revision' (Planning and preparation of the IS audit).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/der/DER_2_IS-Revision_Edition_2023.html",
      "detectionLogic": "This is an organizational risk related to the audit process. It can be raised against technical assets that are typically subject to or involved in security audits.",
      "riskAssessment": "The likelihood is considered 'Likely' if there's no formal, enforced process for auditor qualification and preparation.",
      "falsePositives": "This risk is organizational and cannot be fully confirmed by the technical model alone.",
      "cwe": "287",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "35_sec6.ts",
      "bsiCode": "DER.3.2",
      "id": "biased-internal-audit-team",
      "title": "Biased Internal IT Audit Team (BSI ORP.3.A3)",
      "description": "Internal IT audit teams may lack independence if they are not sufficiently separated from other processes.",
      "impact": "A biased audit compromises the reliability of security assessments, potentially causing security vulnerabilities to be overlooked,",
      "action": "Ensure Independence of the Audit Team",
      "mitigation": "Establish and enforce a clear policy on auditor independence and conflict of interest. Ensure that internal audit members do not audit processes,",
      "check": "Is there a documented policy defining auditor independence? Are internal auditors organizationally separate from the teams responsible for ISMS implementation and operations?",
      "asvs": "BSI IT-Grundschutz ORP.3 ISMS audit, Requirement ORP.3.A3 Independence of the auditors.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_ISMS_audit_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organizational risk is detected by identifying technical assets that represent an auditing function (tagged with 'role:pruefer')",
      "riskAssessment": "The likelihood is considered high if a clear conflict of interest is identified in the model via tags. The impact is derived from the",
      "falsePositives": "A technical asset might be generically tagged and may not accurately represent the distinct roles of the personnel involved.",
      "cwe": "269",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "35_sec7.ts",
      "bsiCode": "DER.3.2",
      "id": "lack-of-central-audit-planning-rev1.a4",
      "title": "Lack of Central and Long-Term Audit Planning (BSI REV.1.A4)",
      "description": "If information security audits/revisions are not planned centrally and for the long term, some organizational units or systems might be audited frequently while others are not audited at all. Also, changes to the ISMS (Information Security Management System) might not be adequately examined if audits are irregular. This makes it very difficult or impossible to properly assess the security posture of the entire information system.",
      "impact": "Unaudited areas may harbor undetected vulnerabilities, and security controls for new or changed components may not be verified. This leads to an increased risk of security incidents, non-compliance with regulations, and potential data breaches, as the actual security state of the system cannot be reliably determined.",
      "action": "Establish a Centralized and Regular Audit Program",
      "mitigation": "Develop and implement a formal, long-term audit plan that is managed centrally. The plan should define the scope, frequency, and methodology for audits across all organizational units and information systems. It must ensure regular coverage of all critical areas and include provisions for ad-hoc audits in response to significant changes or security incidents. The audit plan should be approved by management and communicated to relevant stakeholders.",
      "check": "Is there a formal, documented information security audit plan? Is it managed centrally? Does it specify scope and frequency for all critical systems? Is there a process for auditing significant changes to the system?",
      "asvs": "BSI IT-Grundschutz Kompendium 2023: Baustein REV.1 Revision, Anforderung REV.1.A4 Planung der IS-Revision.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/rev/REV_1_Revision_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This is a fundamental organizational risk that applies to the entire modeled system. The risk is generated if the model contains at least one in-scope, high-value technical asset, as the absence of a structured audit process poses a significant threat to such assets. The risk is raised once for the entire system, with its impact scaled by the highest criticality asset found.",
      "riskAssessment": "The likelihood is considered 'Likely' by default, assuming the absence of a formal audit plan is a significant process gap. The impact is directly correlated with the highest confidentiality and criticality of the data and assets within the system. If mission-critical or strictly confidential assets exist, the impact is 'High' or 'Very High', as their security posture cannot be reliably verified.",
      "falsePositives": "This risk is organizational and cannot be validated purely from a technical model. The organization may have a robust audit program that is not represented in the model. Verification requires checking for an official, management-approved audit plan and schedule.",
      "cwe": "732",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "35_sec8.ts",
      "bsiCode": "DER.3.2",
      "id": "inadequate-is-audit-planning-orp3-a1",
      "title": "Inadequate IS Audit Planning (BSI ORP.3.A1)",
      "description": "If an Information Security (IS) audit is poorly planned and not properly coordinated with the responsible personnel, the required subject matter experts may not be available during the on-site inspection.",
      "impact": "A poorly planned or executed audit provides a false sense of security. Undiscovered vulnerabilities or compliance gaps can be exploited later,",
      "action": "Establish and Follow a Formal IS Audit Planning and Coordination Process",
      "mitigation": "Define and enforce a formal process for planning and conducting IS audits. This process must include proactive coordination with all relevant stakeholders to ensure personnel availability and access to necessary systems, evidence, and documentation.",
      "check": "Is there a documented process for IS audit planning? Are audit schedules consistently coordinated with the affected departments and personnel?",
      "asvs": "BSI IT-Grundschutz Baustein ORP.3 IS-Revision, Requirement ORP.3.A1 Planung der IS-Revision (Planning of the IS audit).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_IS_revision_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This is an organizational risk that applies to any system requiring security assurance. In a technical model, this risk is raised for any in-scope assets that are highly sensitive (and thus require thorough auditing)",
      "riskAssessment": "The likelihood is considered 'Likely' if a formal, coordinated audit planning process is absent or ineffective. The impact is directly dependent on the business criticality (CIA) of the assets under audit.",
      "falsePositives": "This risk is procedural and organizational; its existence cannot be confirmed by a technical model alone. The organization may have a robust audit planning process that is not reflected in the model.",
      "cwe": "668",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "35_sec9.ts",
      "bsiCode": "DER.3.2",
      "id": "is-audit-as-performance-monitoring-der3.a1",
      "title": "IS Audit as Performance Monitoring without Staff Council Involvement (BSI DER.3.A1)",
      "description": "During IS audits, aspects can be checked that could allow conclusions to be drawn about how personnel behave at work and how capable they are.",
      "impact": "Failure to involve the staff council when an audit could be perceived as performance monitoring can lead to the delay or cancellation of crucial security audits.",
      "action": "Ensure Staff Council Involvement in IS Audits",
      "mitigation": "Establish and follow a formal process for planning IS audits that includes the timely and appropriate involvement of the staff council, especially when employee performance or behavior data might be collected or analyzed.",
      "check": "Is there a documented process for involving the staff council in IS audit planning? Is the staff council regularly consulted before audits that could involve employee data are conducted? Is there evidence (e.g., meeting minutes, official agreements) of this involvement?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein DER.3 Revision, Requirement DER.3.A1 Einbindung der Personalvertretung (Involvement of the staff council).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/der/DER_3_Revision_Edition_2023.pdf?__blob=publicationFile (BSI DER.3 German)",
      "detectionLogic": "This is an organizational risk that applies to technical assets used for auditing and monitoring purposes.",
      "riskAssessment": "The likelihood is considered high if a formal process for involving the staff council is missing or not followed.",
      "falsePositives": "This risk is inherently organizational. A technical model cannot definitively know if the staff council was involved.",
      "cwe": "213",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "36_sec1.ts",
      "bsiCode": "DER.4",
      "id": "personnel-failure-knowledge-monopoly",
      "title": "Personnel Failure / Knowledge Monopoly (BSI ORP.4.A23)",
      "description": "The failure or absence of key personnel can prevent an organization from performing its core tasks and business processes.",
      "impact": "If a non-redundant, critical system can no longer be operated due to personnel failure, its availability is directly compromised.",
      "action": "Implement Redundancy, Knowledge Transfer, and Contingency Planning",
      "mitigation": "Ensure that no single person is the only one capable of operating or maintaining a critical system.",
      "check": "Is the technical asset marked as redundant in the model? Is there a documented and tested contingency plan for this asset/service?",
      "asvs": "BSI IT-Grundschutz ORP.4: Notfallmanagement (Contingency Management), Requirement ORP.4.A23: Regelungen für den Personalausfall (Regulations for personnel failure).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Notfallmanagement.html",
      "detectionLogic": "This rule triggers for any technical asset that is N@SystemType:OT marked as 'redundant' and has a 'Critical' or 'Mission-Critical'",
      "riskAssessment": "The likelihood of a single person or a single non-redundant component eventually failing is considered 'Likely'.",
      "falsePositives": "A risk might be flagged for an asset that has organizational redundancy (e.g., a team of administrators sharing a role)",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "36_sec2.ts",
      "bsiCode": "DER.4",
      "id": "component-failure-endangering-availability-con1",
      "title": "Component Failure Endangering Availability (BSI CON.1)",
      "description": "If components of an IT system fail, for example due to defective hardware or a power outage, the entire IT operation can be disrupted.",
      "impact": "A failure of a critical, non-redundant component leads to a denial of service, directly impacting the availability of the technical asset,",
      "action": "Implement Redundancy and High-Availability Measures",
      "mitigation": "Ensure that critical system components have a redundant design. The easiest way to model this mitigation is to set the 'redundant' flag to 'true' for the affected technical asset.",
      "check": "Are critical technical assets configured for high availability? Is the 'redundant' flag set to true in the model for these assets? Are there documented and tested disaster recovery and business continuity plans?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Redundant IT Systems) and INF.5 (Power Supply).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Redundant_IT_systems_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers for any in-scope technical asset that is marked as `redundant`. The risk is particularly high for assets with high availability requirements.",
      "riskAssessment": "The impact is derived directly from the 'availability' rating of the technical asset and the data it handles. A non-redundant asset with 'mission-critical' availability poses a 'very-high' impact risk. The likelihood is generally considered 'likely' as component and power failures are common operational risks.",
      "falsePositives": "The risk might be a false positive if redundancy is handled outside the component itself (e.g., at a higher infrastructure layer) but modeled as such. For low-impact, non-critical components, accepting this risk might be a valid business decision.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "36_sec3.ts",
      "bsiCode": "DER.4",
      "id": "wan-outage",
      "title": "Wide Area Network (WAN) Outage (BSI-Style)",
      "description": "The causes of a Wide Area Network (WAN) failure can be diverse, affecting individual users, a provider, or an entire region.",
      "impact": "A WAN outage primarily affects the availability of services and business processes that depend on this connectivity. This can lead to reduced productivity,",
      "action": "Ensure Redundancy and High Availability for WAN Connections",
      "mitigation": "Use redundant WAN links, preferably from different providers, to mitigate single points of failure.",
      "check": "Are critical services connected via redundant WAN links? Are these links from different providers? Is there an automatic failover mechanism?",
      "asvs": "BSI IT-Grundschutz: NET.3.2 Wide Area Network",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Wide_Area_Network_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies all communication links that cross a network-only trust boundary (e.g., between on-premise and cloud, or between two data centers),",
      "riskAssessment": "The likelihood of a temporary WAN outage is considered 'Likely'. The impact is determined by the highest availability requirement of the technical assets",
      "falsePositives": "This risk might be a false positive if the communication link, while traversing a WAN, is used for non-critical purposes that can tolerate outages.",
      "cwe": "755",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "36_sec4.ts",
      "bsiCode": "DER.4",
      "id": "unavailability-of-premises",
      "title": "Unavailability of Premises (BSI INF.5)",
      "description": "Buildings can become unexpectedly unusable, for example, because they have been partially or completely destroyed by fire, storm, flood, earthquake, or an explosion.",
      "impact": "If a physical location housing IT infrastructure becomes unavailable, all business and technical processes dependent on that infrastructure will be disrupted or completely halted.",
      "action": "Implement Business Continuity and Disaster Recovery Plans",
      "mitigation": "To mitigate the risk of premises unavailability, organizations should implement a robust Business Continuity Plan (BCP) and Disaster Recovery Plan (DRP). Key measures include:",
      "check": "Is there a documented and tested Business Continuity Plan? Does it account for the total failure of the primary physical location? Are there redundant systems in a separate physical location?",
      "asvs": "BSI IT-Grundschutz INF.5: Building, BSI 200-4: Business Continuity Management",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Building_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is automatically raised for each trust boundary representing a physical, on-premise location ('network-on-prem' or 'network-dedicated-hoster' types).",
      "riskAssessment": "The likelihood of a catastrophic event is considered 'unlikely' by default but represents a high-impact threat that must be considered in business continuity planning.",
      "falsePositives": "This risk might be considered a false positive if the model uses an 'on-prem' trust boundary for logical grouping rather than representing a single physical building susceptible to a single point of failure.",
      "cwe": "0",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "36_sec5.ts",
      "bsiCode": "DER.4",
      "id": "dependency-on-external-service-availability",
      "title": "Dependency on External Service Availability (BSI CON.3)",
      "description": "Institutions often depend on external services and suppliers. A partial or complete failure of such a service provider can quickly lead to interruptions in the institution's own business continuity.",
      "impact": "If an external service that a critical business process depends on fails, it can lead to a direct interruption of that process. This can result in an inability to perform key business functions, leading to financial losses, reputational damage, and failure to meet service-level agreements (SLAs) with customers. The availability of the system is compromised.",
      "action": "Implement Redundancy and Business Continuity Planning for External Dependencies",
      "mitigation": "For critical dependencies, ensure that contracts with service providers include specific SLAs for availability and that performance is monitored.",
      "check": "Are critical external service dependencies identified and documented? Are availability SLAs defined in contracts? Is the internal system designed to be resilient to the failure of this dependency? Is this scenario covered in the business continuity plan?",
      "asvs": "BSI IT-Grundschutz Kompendium: CON.3 Business Continuity Management",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Business_continuity_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule scans for communication links from in-scope technical assets with high-availability requirements to external entities or assets marked as out-of-scope. The risk is elevated if the internal, dependent asset is configured for redundancy.",
      "riskAssessment": "The impact is derived directly from the availability requirement of the internal asset that depends on the external service. A 'Mission-Critical' asset failing has a 'Very High' impact. The likelihood of exploitation (i.e., the provider failing) is considered 'Likely' by default. This likelihood is reduced if the dependent internal component is modeled as redundant, assuming it can fail over to a working instance.",
      "falsePositives": "The dependency might be on a non-critical feature of the external service captured in the model's granularity. The external service may have an extremely high, contractually guaranteed uptime that makes failure 'Unlikely' in practice. The model might capture complex, multi-layered business continuity or disaster recovery strategies that mitigate this risk.",
      "cwe": "1174",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "37_sec1.ts",
      "bsiCode": "IND.1",
      "id": "harsh-environmental-conditions-for-@SystemType:ICS-components",
      "title": "Harsh Environmental Conditions for Physical Components (BSI CON.1.A9)",
      "description": "Components in industrial, on-premise, or uncontrolled environments are often exposed to adverse conditions that can impair safe operation.",
      "impact": "The primary impact of component failure due to environmental stress is a loss of availability (Denial of Service).",
      "action": "Implement Physical and Environmental Protections",
      "mitigation": "Ensure that all physical components (servers, network devices, @SystemType:ICS/I@SystemType:OT hardware) are suitable for their operating environment.",
      "check": "Are physical assets installed in environments that protect them from temperature extremes, humidity, dust, and vibration?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium Baustein CON.1 (Physical Environmental Protection), specifically requirement CON.1.A9 (Protection against environmental damage).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Physical_environmental_protection_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified for technical assets that are explicitly marked as being in a harsh environment via the `@Environment:Harsh` tag.",
      "riskAssessment": "The likelihood of failure is considered higher for assets explicitly tagged for harsh environments.",
      "falsePositives": "A risk might be flagged for an asset that has adequate, but un-modeled, physical protections (e.g., a ruggedized server case or a climate-controlled cabinet).",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "37_sec10.ts",
      "bsiCode": "IND.1",
      "id": "insecure-component-procurement",
      "title": "Insecure Component Procurement (based on BSI)",
      "description": "Due to insufficient security requirements and cost-cutting measures, information security is often neglected during the procurement of components.",
      "impact": "Acquiring components with inherent flaws introduces vulnerabilities directly into the system architecture.",
      "action": "Establish and Enforce Secure Procurement Policies",
      "mitigation": "Define and enforce a secure procurement policy that mandates security assessments for all third-party components (hardware and software) before acquisition.",
      "check": "Is there a formal security policy for procuring third-party assets? Are security assessments part of the purchasing process?",
      "asvs": "V14.2 Supply Chain",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Software_Supply_Chain_Security_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for any technical asset that is marked as custom-developed for n@SystemType:OT (`custom_developed_parts: false`).",
      "riskAssessment": "The likelihood is considered higher for complex, sensitive, or opaque systems (e.g., devices from n@SystemType:OT, ERPs, mainframes, security appliances).",
      "falsePositives": "This risk may be a false positive if an organization has a robust secure procurement process in place but has documented it in the model using the 'procurement-process-followed' tag.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "37_sec11.ts",
      "bsiCode": "IND.1",
      "id": "insecure-@SystemType:OT-protocol-@SystemType:ICS-t5-21",
      "title": "Insecure @SystemType:OT/@SystemType:ICS Protocol Usage (BSI @SystemType:ICS.T.5.21)",
      "description": "Industrial Control System (@SystemType:ICS) and Operational Technology (@SystemType:OT) components often use specialized network protocols that were not designed with security in mind.",
      "impact": "Successful exploitation can lead to a compromise of Confidentiality (eavesdropping on process data), Integrity (manipulating commands or data), and Availability (disrupting or stopping processes).",
      "action": "Use Secure Communication Protocols and Network Segmentation",
      "mitigation": "Whenever possible, use protocols that provide end-to-end encryption, integrity protection, and mutual authentication (e.g., OPC UA with a security policy, Modbus-Secure).",
      "check": "Are all communication links to and from @SystemType:OT/@SystemType:ICS components using encrypted protocols? If not, is the traffic tunneled over a VPN?",
      "asvs": "BSI IT-Grundschutz Kompendium: NET.3.2 @SystemType:ICS-Protokolle, @SystemType:ICS.1 Allgemeine @SystemType:ICS-Komponente",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Kompendium_Edition_2023.pdf?__blob=publicationFile (Search for NET.3.2)",
      "detectionLogic": "This rule triggers for any communication link involving an @SystemType:OT/@SystemType:ICS-style asset (e.g., technology 'i@SystemType:OT-device', 'mainframe', or tagged with '@SystemType:OT-asset') that uses an unencrypted protocol.",
      "riskAssessment": "The impact is calculated based on the Confidentiality, Integrity, and Availability ratings of the data assets being transferred.",
      "falsePositives": "The rule might trigger for protocols that have security features enabled at the application layer which are not captured in the model's protocol definition.",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "37_sec12.ts",
      "bsiCode": "IND.1",
      "id": "insecure-default-configuration-of-@SystemType:ICS-components",
      "title": "Insecure Default Configuration of @SystemType:ICS Components (related to BSI CON.1)",
      "description": "In the default configuration of @SystemType:ICS components, security measures are n@SystemType:OT always enabled. This can allow unauthorized individuals to easily gain access.",
      "impact": "If this vulnerability is exploited, an attacker could gain unauthorized access to the @SystemType:ICS component, leading to data theft, system manipulation, or a complete denial of service. This can compromise the confidentiality, integrity, and availability of the controlled industrial process, potentially causing physical damage, production downtimes, and safety hazards.",
      "action": "Harden @SystemType:ICS Component Configuration",
      "mitigation": "All @SystemType:ICS components must be hardened before being deployed into production. This includes changing all default passwords, disabling unnecessary services and physical interfaces (like USB ports), enabling and correctly configuring built-in security functions, and ensuring that encrypted protocols (like SSH) are used for all administrative access. A standardized hardening checklist specific to the component type should be developed and consistently applied.",
      "check": "Are all @SystemType:ICS components configured according to a security hardening guide before deployment? Are default passwords changed? Are administrative protocols encrypted? Are all unnecessary services and interfaces disabled?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (General @SystemType:ICS System), especially requirements like CON.1.A10 (Secure basic configuration of @SystemType:ICS components) and CON.1.A11 (Disabling unused interfaces and services on @SystemType:ICS components).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_ICS_system_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks for technical assets representing Industrial Control Systems (@SystemType:ICS), identified either by the 'IoTDevice' technology type or the '@SystemType:ICS-component' tag. It flags risks if it discovers administrative communication links ('devops' usage) that are either unencrypted or lack any form of authentication, as these are common signs of an insecure default configuration.",
      "riskAssessment": "The likelihood of exploitation is high for unencrypted or unauthenticated administrative interfaces, as these are common targets. The impact is determined by the criticality (CIA) of the @SystemType:ICS component itself and the data it processes or stores. A compromise of an @SystemType:ICS component controlling a critical process has a very high impact.",
      "falsePositives": "The risk might be flagged for a protocol that is seemingly unencrypted but secured by a separate mechanism n@SystemType:OT modeled (e.g., a VPN, which is checked for). A link using 'credentials' authentication might have a strong, non-default password, which the model cann@SystemType:OT verify. Manual verification of the component's configuration is always necessary.",
      "cwe": "798",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "37_sec13.ts",
      "bsiCode": "IND.1",
      "id": "dependency-on-external-systems-@SystemType:OT",
      "title": "Dependency of @SystemType:OT Systems on External IT Infrastructures (BSI-@SystemType:OT-Dependence-IT)",
      "description": "Operational Technology (@SystemType:OT) is increasingly no longer operated in a fully self-sufficient manner. When dependencies on other systems, networks, or services exist, failures or security incidents in the IT network can directly impact the @SystemType:OT environment. Especially when these dependent systems and networks are not directly controlled by the @SystemType:OT operator, the availability of @SystemType:OT systems and their associated processes can be severely impaired. Furthermore, resolving such incidents often requires external support, leading to delays.",
      "impact": "A failure or security incident in a dependent IT system (e.g., shared infrastructure, cloud service, remote access connection) can directly disrupt or halt @SystemType:OT processes, leading to production downtime, safety risks, and financial losses. Incident response can be delayed as it often depends on external parties.",
      "action": "Reduce and Harden Dependencies of @SystemType:OT Systems",
      "mitigation": "Minimize dependencies of @SystemType:OT systems on external or shared IT services wherever possible. For unavoidable dependencies, ensure the target IT service is designed for high availability and redundancy (e.g., clustered services, redundant network links). Implement strict access controls and monitoring at the IT/@SystemType:OT boundary using firewalls or data diodes. Use dedicated, hardened infrastructure for services critical to @SystemType:OT. Establish clear Service Level Agreements (SLAs) and joint incident response procedures with external service providers.",
      "check": "Are all communication links from @SystemType:OT assets to non-@SystemType:OT assets identified and justified? Are the target IT systems designed and operated for high availability? Are there contingency plans in case a dependent IT service fails? Are SLAs in place for externally managed services?",
      "asvs": "Derived from BSI IT-Grundschutz, specifically concepts in OPS.1.2 (Network and connections) and NET.1.1 (Network architecture) applied to an @SystemType:OT context. The risk description is based on observations from the BSI's guidance on @SystemType:OT security.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/@SystemType:ICS/BSI-CS_108_EN.pdf?__blob=publicationFile (BSI - Industrial Control System Security)",
      "detectionLogic": "This rule triggers risks in two scenarios: 1. When a technical asset tagged as `@SystemType:OT-Asset` has a communication link to an asset that is not part of the @SystemType:OT environment (i.e., not tagged `@SystemType:OT-Asset`). 2. When an `@SystemType:OT-Asset` runs on a Shared Runtime that also hosts non-@SystemType:OT assets, creating a dependency via a shared execution environment.",
      "riskAssessment": "The impact is determined by the availability requirement of the @SystemType:OT asset. A dependency for a 'mission-critical' @SystemType:OT asset results in a very high impact. The likelihood is considered `likely` or higher if the dependency is on a standard, non-redundant IT service or an internet-based service. The likelihood can be reduced if the target service is modeled as `redundant`.",
      "falsePositives": "The risk might be overstated if the target IT service is implicitly highly available (e.g., a major public cloud provider's core API) but not marked as `redundant` in the model. The dependency might be for non-critical, asynchronous tasks (like sending logs) that do not impact core @SystemType:OT functions in real-time.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "37_sec2.ts",
      "bsiCode": "IND.1",
      "id": "it-@SystemType:OT-security-policy-conflict",
      "title": "IT/@SystemType:OT Security Policy Conflict (based on BSI @SystemType:ICS recommendations)",
      "description": "Different frameworks, knowledge, and procedures in Office IT and Operational Technology (@SystemType:OT) can lead to implementation problems for overarching security requirements. Security specifications from the Office IT environment may not be feasible in @SystemType:ICS systems due to technical or procedural peculiarities. Conversely, @SystemType:OT-specific information security and functional safety aspects may not be known to Office IT security officers. This can result in friction in communication and implementation, and risks might not be identified or addressed adequately.",
      "impact": "Failure to harmonize IT and @SystemType:OT security policies can lead to improperly configured security controls, creating vulnerabilities. This can compromise the Integrity and Availability of critical @SystemType:OT/@SystemType:ICS systems, potentially causing production outages, physical damage, or safety incidents. It also opens pathways for attackers to pivot from less-secure IT environments into the highly sensitive @SystemType:OT network.",
      "action": "Harmonize IT and @SystemType:OT Security Policies and Controls",
      "mitigation": "Establish a joint IT/@SystemType:OT security governance team. Conduct a unified risk assessment that considers the specific constraints and safety requirements of the @SystemType:OT environment. Adapt generic IT security policies to be applicable and effective for @SystemType:ICS components. Use security gateways, DMZs, or data diodes to create strictly controlled communication channels between IT and @SystemType:OT networks. Ensure cross-functional training and awareness for both IT and @SystemType:OT personnel.",
      "check": "Is there a dedicated, documented security architecture for IT/@SystemType:OT integration? Are security controls on communication links between IT and @SystemType:OT (e.g., firewalls, proxies) configured with @SystemType:OT-specific rule sets? Do IT and @SystemType:OT teams conduct joint change management and incident response planning?",
      "asvs": "BSI IT-Grundschutz IND.2.2 Network Architecture for @SystemType:ICS",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/IND/IND_2_2_Network_architecture_for_ICS_Edition_2023.pdf",
      "detectionLogic": "Detects communication links between technical assets tagged as part of the IT domain (e.g., '@Domain:IT') and assets tagged as part of the @SystemType:OT/@SystemType:ICS domain (e.g., '@SystemType:OT', '@SystemType:ICS'). The risk is heightened if the communication link lacks strong authentication or encryption.",
      "riskAssessment": "The likelihood is high if the connection between IT and @SystemType:OT is direct and lacks specific security controls. The impact is determined by the criticality of the connected @SystemType:OT asset. A connection to a Mission-Critical @SystemType:OT asset results in a very high impact, as a compromise could affect physical processes.",
      "falsePositives": "A model might generate a false positive if a specialized security appliance (like a data diode or an @SystemType:OT-aware firewall) that mitigates the risk is modeled simply as a generic asset, or if its specific filtering capabilities are not captured in the model's tags.",
      "cwe": "1123",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "37_sec3.ts",
      "bsiCode": "IND.1",
      "id": "inadequate-@SystemType:OT-change-management",
      "title": "Inadequate Change Management in @SystemType:OT Environments",
      "description": "While Operational Technology (@SystemType:OT) and IT are converging, there are unique characteristics of @SystemType:ICS that complicate the transfer of established IT operational processes.",
      "impact": "Disruptions in @SystemType:OT systems, which monitor and control physical processes, can lead to production outages, physical damage to equipment, harm to personnel, and environmental damage.",
      "action": "Establish and Enforce @SystemType:OT-Specific Change and Incident Management Procedures",
      "mitigation": "Develop, document, and enforce change management processes tailored specifically for @SystemType:OT/@SystemType:ICS assets. These processes must integrate safety, engineering, and regulatory considerations.",
      "check": "Are there documented change and incident management processes specifically for @SystemType:OT/@SystemType:ICS assets? Do these processes account for safety, regulatory, and vendor support constraints? Are changes logged and approved by relevant stakeholders (e.g., engineering, safety teams)?",
      "asvs": "Derived from BSI IT-Grundschutz, particularly the Industrial Control Systems (@SystemType:ICS) overlay. While related to general processes like OPS.1.1.5 (Patch and change management), this risk highlights the specific challenges in @SystemType:OT environments that standard IT processes fail to address.",
      "cheatSheet": "https://www.bsi.bund.de/EN/Top@SystemType:ICS/Industrie_und_KRITIS/@SystemType:ICS/ics_node.html (BSI @SystemType:ICS Security)",
      "detectionLogic": "This is a process-level risk inherent to @SystemType:OT/@SystemType:ICS assets. The rule triggers for any technical asset explicitly tagged as an '@SystemType:OT-asset',",
      "riskAssessment": "The likelihood is high if no @SystemType:OT-specific change management process exists. The impact is directly correlated with the availability and integrity requirements of the @SystemType:OT asset,",
      "falsePositives": "This risk is raised to ensure a verification of operational processes. A false positive can be claimed if the organization has a mature, documented, and enforced change management program specifically designed for its @SystemType:OT environment.",
      "cwe": "1123",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "37_sec4.ts",
      "bsiCode": "IND.1",
      "id": "insufficient-access-protection-for-ot-systems",
      "title": "Insufficient Access Protection for OT/ICS (BSI-Style)",
      "description": "Industrial Control Systems (ICS/OT) are increasingly connected to other networks, such as corporate Office IT, partners, and service providers, for data exchange, monitoring, and remote maintenance.",
      "impact": "A compromise of OT systems can lead to manipulation of physical processes, production standstills, equipment damage, and safety hazards. This severely impacts the availability and integrity of the industrial processes.",
      "action": "Implement Strict Network Segmentation and Access Control for OT Environments",
      "mitigation": "Strictly segment the OT network from the Office IT network, typically using a Demilitarized Zone (DMZ) and firewalls.",
      "check": "Is there a firewall or DMZ between the IT and OT networks? Are all IT-to-OT communication links explicitly whitelisted, authenticated, and encrypted?",
      "asvs": "BSI IT-Grundschutz: SYS.2.4 Industrial Control System (ICS) components, NET.1.1 Network architecture",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_4_Industrial_Control_System_components_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies communication links that originate from a non-OT asset and terminate at an OT asset (identified by the '@OT' tag).",
      "riskAssessment": "The likelihood is high if an unsecured communication channel exists from IT to OT, as the IT environment is a common source of malware.",
      "falsePositives": "The risk might be a false positive if the connecting 'IT' asset is a dedicated, hardened jump host or data diode that is part of a secure architecture, but not tagged as '@OT' in the model.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "37_sec5.ts",
      "bsiCode": "IND.1",
      "id": "insecure-software-development-and-modification",
      "title": "Vulnerabilities due to Insecure Software Development and Modification (based on BSI)",
      "description": "Adjustments and further developments of IT systems and applications can introduce critical risks.",
      "impact": "If vulnerabilities are introduced into custom-developed components, this can lead to a compromise of their confidentiality, integrity, and availability,",
      "action": "Implement and Enforce a Secure Software Development Lifecycle (SDLC)",
      "mitigation": "Establish a comprehensive Secure SDLC program that includes threat modeling, secure coding standards, mandatory code reviews (manual and automated),",
      "check": "Is a formal Secure SDLC process defined and followed? Are development environments secured and monitored?",
      "asvs": "V1 Architecture, Design and Threat Modeling Requirements, V14 Configuration",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is identified for all in-scope technical assets marked as having `custom_developed_parts`.",
      "riskAssessment": "The likelihood is considered 'Likely' for any custom-developed component, as bugs can always occur.",
      "falsePositives": "A technical asset might be flagged because it contains custom code, even if the organization follows a very mature and secure SDLC.",
      "cwe": "20",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "37_sec6.ts",
      "bsiCode": "IND.1",
      "id": "insecure-remote-access-to-@SystemType:OT",
      "title": "Insecure Remote Access to @SystemType:OT/@SystemType:ICS Components (BSI INF.11)",
      "description": "In some cases, industrial control systems are administered via network access.",
      "impact": "If remote access to @SystemType:OT/@SystemType:ICS components is not adequately secured, attackers could gain unauthorized control, leading to manipulation of industrial processes,",
      "action": "Secure Remote Administration Access to @SystemType:OT/@SystemType:ICS",
      "mitigation": "All remote access to @SystemType:OT components must be routed through a secured, monitored gateway (e.g., a bastion host or jump server).",
      "check": "Are all remote administration connections to @SystemType:OT systems encrypted via VPN or at least a strongly authenticated, encrypted protocol? Is multi-factor authentication enforced?",
      "asvs": "BSI IT-Grundschutz Kompendium 2023: INF.11 Zugriff auf @SystemType:OT-Komponenten über Netze",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/IT-GS-Kompendium_2023/bausteine/INF/INF_11_Zugriff_auf_OT_Komponenten_ueber_Netze_Edition_2023.html",
      "detectionLogic": "This risk is triggered for @SystemType:OT/@SystemType:ICS components (modeled as 'I@SystemType:OT Device' or tagged with '@SystemType:OT'/'@SystemType:ICS') that have an incoming communication link from the Internet.",
      "riskAssessment": "The impact is determined by the availability and integrity rating of the @SystemType:OT component, as compromise can lead to physical process disruption.",
      "falsePositives": "A risk might be flagged if an intermediate security component (like a cloud provider's VPN gateway or a specialized firewall) that secures the connection is not modeled explicitly.",
      "cwe": "287",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "37_sec7.ts",
      "bsiCode": "IND.1",
      "id": "inadequate-monitoring-of-@SystemType:ICS-it-infrastructure",
      "title": "Inadequate Monitoring of Supporting IT Infrastructure for Industrial Control Systems (@SystemType:ICS)",
      "description": "A key function of industrial control systems is to monitor the automated process itself (e.g., fill levels, temperatures, valve positions).",
      "impact": "Failure to monitor the supporting IT infrastructure can lead to delayed detection and response to security incidents, component failures, or performance degradation.",
      "action": "Implement Comprehensive Monitoring and Logging for @SystemType:ICS Supporting Infrastructure",
      "mitigation": "Implement a dedicated monitoring solution that covers all critical IT components supporting the industrial process (e.g., servers, databases, network devices, applications).",
      "check": "Are all IT assets supporting the @SystemType:ICS environment connected to a monitoring system? Are security-relevant events being actively logged and analyzed? Is there an automated alerting mechanism for critical events? Is there a defined and tested incident response process linked to these alerts?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.A6 'Detection of security-relevant events' and OPS.1.1.A5 'Logging'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_operation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks for technical assets identified as part of an Industrial Control System (e.g., assets of type 'I@SystemType:OT Device' or assets tagged with '@SystemType:ICS') that are @SystemType:OT connected to a monitoring system.",
      "riskAssessment": "The impact is derived from the availability and integrity requirements of the unmonitored @SystemType:ICS component. A lack of monitoring on a 'mission-critical' asset will result in a higher impact.",
      "falsePositives": "This risk may be a false positive if monitoring is performed by an external system or a platform feature @SystemType:OT represented as a dedicated 'Monitoring' asset in the model.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "37_sec8.ts",
      "bsiCode": "IND.1",
      "id": "unplanned-changes-in-@Environment:OT",
      "title": "Unplanned or Untested Changes in @SystemType:OT Environments (BSI @SystemType:OT.1.A4)",
      "description": "Industrial control systems (@SystemType:OT/@SystemType:ICS) often have very high availability requirements, as disruptions or technical failures can lead to severe damage and high consequential costs.",
      "impact": "Failure to properly test and manage changes can lead to severe disruptions, system failures, physical damage, and high consequential costs, primarily affecting the Availability and Integrity of the @SystemType:OT system and the physical processes it controls.",
      "action": "Implement a Formal Change and Test Management Process for @SystemType:OT Systems",
      "mitigation": "Establish a strict change management process that includes planning, risk assessment, coordination with all stakeholders, and thorough testing in a representative, non-production environment before deployment. All changes, including vendor updates and parameter adjustments, must follow this process. Maintain rollback plans and ensure changes are performed by authorized and trained personnel.",
      "check": "Is there a documented change management policy for @SystemType:OT systems? Are all changes, including patches and configuration adjustments, tested in a separate, representative environment before deployment? Are change records, test results, and rollback procedures maintained?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium, Baustein @SystemType:OT.1: General @SystemType:OT components, Requirement @SystemType:OT.1.A4: Change and patch management.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OT_1_General_OT_components_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to technical assets identified as part of an Operational Technology (@SystemType:OT) environment, especially those with high availability or integrity requirements. The rule identifies these assets via a specific tag (`@SystemType:@SystemType:OT`). The risk is raised because such environments are highly sensitive to untested changes, which is a common procedural weakness if not explicitly countered.",
      "riskAssessment": "The likelihood is considered 'Likely' as a baseline, assuming a standard organization may not have a perfect, audited @SystemType:OT-specific change process. The impact is directly proportional to the `availability` and `integrity` ratings of the @SystemType:OT asset. A `mission-critical` asset will result in a `VeryHigh` impact, while a `critical` asset will result in a `High` impact.",
      "falsePositives": "This risk can be considered a false positive if the organization can demonstrate a robust, strictly enforced, and audited change and test management process specifically for their @SystemType:OT environment.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "37_sec9.ts",
      "bsiCode": "IND.1",
      "id": "unsupported-components-in-@Environment:OT",
      "title": "Unsupported Components in @SystemType:OT Environment (BSI-based)",
      "description": "In Operational Technology (@SystemType:OT) environments, components from standard Office-IT are often used.",
      "impact": "Successful exploitation of vulnerabilities in unsupported components can lead to unauthorized intrusion into critical @SystemType:OT systems.",
      "action": "Implement Component Lifecycle Management and Replace/Isolate Unsupported Assets",
      "mitigation": "Maintain a complete inventory of all hardware and software components and track their support lifecycle status.",
      "check": "Is there a complete and up-to-date inventory of all hardware and software components?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, SYS.1.2 Server under Windows, Requirement SYS.1.2.A16 'Use of up-to-date server products and components'. This principle applies broadly to all system components.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_Server_under_Windows_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule triggers for any technical asset that is tagged as `@Maintenance:Unmaintained` AND is identified as being part of an @SystemType:OT environment via the `@SystemType:OT` tag. The @SystemType:OT domain context can be applied directly to the asset or to a trust boundary containing the asset.",
      "riskAssessment": "The likelihood of exploitation is considered high because vulnerabilities in unsupported products are often publicly known and exploit tools are readily available.",
      "falsePositives": "A false positive may occur if an unsupported component is fully air-gapped and has no digital or physical data-transfer interfaces, which might not be fully represented in the model. However, such isolation is rare and difficult to maintain, so the risk should be carefully evaluated before being dismissed.",
      "cwe": "1104",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "38_sec1.ts",
      "bsiCode": "IND.2.1",
      "id": "insecure-default-configuration-app4.4.a1",
      "title": "Insecure Default Configuration of Components (BSI APP.4.4.A1)",
      "description": "The default configuration of components is often designed for correct functionality and easy commissioning. Security mechanisms often play a subordinate role.",
      "impact": "If an attacker successfully exploits an insecure default configuration, they could gain control over the component. This can lead to the leakage of institution-critical information (loss of Confidentiality),",
      "action": "Implement and Enforce Secure Baseline Configurations (Hardening)",
      "mitigation": "Establish and enforce documented hardening guidelines for all types of components before they are deployed into production. This process should include:",
      "check": "Is there a documented hardening process for components of this type? Are default credentials verifiably changed? Are all running services, protocols, and open ports necessary and documented? Is there a process for regularly reviewing the configuration against the baseline?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein APP.4.4 'General Server', Requirement A1 'Secure basic configuration'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_General_server_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk applies to all technical assets that are simple clients, embedded components (like libraries), or DevOps-specific infrastructure (which have their own configuration risks), and are in-scope.",
      "riskAssessment": "The likelihood of this risk is considered high by default, as insecure configurations are a very common attack vector. The likelihood increases if the asset is exposed to the internet or has unauthenticated communication links.",
      "falsePositives": "This risk may be considered a false positive if the organization has a robust, mature, and consistently applied hardening process for all assets, even if explicitly tagged in the model. The tag serves as a way to explicitly confirm this within the threat model.",
      "cwe": "1032",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "38_sec2.ts",
      "bsiCode": "IND.2.1",
      "id": "inadequate-user-and-authorization-management",
      "title": "Inadequate User and Authorization Management on Components (BSI-@SystemType:ICS-SEC-1)",
      "description": "Some components, particularly those with their own user and authorization management, are susceptible to operational weaknesses.",
      "impact": "Unauthorized individuals gaining access to components can lead to a severe compromise of confidentiality, integrity, and availability.",
      "action": "Implement and Enforce Strict User and Permission Management",
      "mitigation": "Ensure that every user has a unique, individual account; prohibit and technically prevent the use of shared accounts.",
      "check": "Is there a documented process for user lifecycle management? Are shared accounts prohibited? Are access rights regularly audited?",
      "asvs": "V4 Access Control",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authorization_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for technical assets that are likely to have their own user management, especially when they are simple clients.",
      "riskAssessment": "The likelihood is high if a component with its own user management does not integrate with a central identity provider and/or relies on protocols with weak or no authentication.",
      "falsePositives": "A component might have a robust, well-maintained local user management system even if the model does not explicitly state it.",
      "cwe": "285",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "38_sec3.ts",
      "bsiCode": "IND.2.1",
      "id": "inadequate-security-logging-on-@SystemType:ICS-components",
      "title": "Inadequate Security Logging on @SystemType:ICS Components",
      "description": "On Industrial Control Systems (@SystemType:ICS) components, logging is often limited to process-relevant events, while data crucial for information security is not recorded. This deficiency makes it difficult to detect security incidents in a timely manner and often impossible to reconstruct them for forensic analysis afterwards.",
      "impact": "The absence of security-relevant logs prevents or significantly delays the detection of attacks and security breaches. After an incident, the lack of data hinders root cause analysis, making it impossible to understand the attack path, assess the full extent of the damage, or implement effective countermeasures to prevent recurrence. This can lead to prolonged system compromises, data manipulation, or physical process disruption going unnoticed.",
      "action": "Implement and Enhance Security-Relevant Logging on @SystemType:ICS Components",
      "mitigation": "Ensure that @SystemType:ICS components log security-relevant events in addition to process-relevant ones. This includes failed login attempts, configuration changes, administrative actions, network connection anomalies, and errors. Logs should be sent to a central, secured log management system (like a SIEM) for correlation, analysis, and alerting. The logging configuration must be protected against tampering. Timestamps should be synchronized across all components.",
      "check": "Are security events (e.g., logins, configuration changes, errors) being logged on @SystemType:ICS components? Are these logs collected centrally in a protected manner? Is there a process for reviewing these logs for anomalies?",
      "asvs": "BSI IT-Grundschutz COMPENDIUM, Module OPS.1.2.5: Logging",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_5_Logging_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for technical assets identified as @SystemType:ICS components (either via the `@SystemType:ICS` tag or `IoTDevice` technology) that lack explicit indicators of sufficient security logging (i.e., are not tagged with `@SecurityLogging` or `@SIEM-Connected`).",
      "riskAssessment": "The likelihood is considered high for any @SystemType:ICS component by default, as security logging is not a primary design feature for many of these systems. The impact is directly related to the criticality of the @SystemType:ICS component and the physical process it controls, with a focus on Integrity and Availability. A compromise of a mission-critical process controller has a very high impact.",
      "falsePositives": "A risk might be a false positive if the @SystemType:ICS component has robust, security-focused logging capabilities that are not reflected in the model (e.g., the `@SecurityLogging` tag is missing), or if logging is handled by a dedicated, connected monitoring device that is part of the model and protects the @SystemType:ICS component.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "38_sec4.ts",
      "bsiCode": "IND.2.1",
      "id": "@SystemType:ICS-manipulation-of-components-and-information",
      "title": "Manipulation of @SystemType:ICS Components and Information (BSI CON.6)",
      "description": "The diverse interfaces of Industrial Control System (@SystemType:ICS) components lead to an increased risk of manipulation for the IT systems, software, and information they transmit. Depending on the motivation and skills of the attackers, this can have local or even multi-site effects. Furthermore, status and alarm messages or other measured values can be suppressed or altered.",
      "impact": "Manipulated measurement values can lead to incorrect decisions by @SystemType:ICS components or operating personnel. Manipulated systems can be used to attack other systems or locations, or to conceal an ongoing manipulation. This directly threatens the integrity and availability of the production process, potentially causing physical damage, production downtimes, and safety hazards.",
      "action": "Secure @SystemType:ICS Interfaces and Validate Control Data",
      "mitigation": "All interfaces to @SystemType:ICS components must be secured using strong authentication and authorization mechanisms. Communication across network boundaries should be encrypted. All incoming data, especially control commands, measurements, and alarms (often tagged as @ICSControlData), must be validated for integrity and plausibility before being processed. Implement strict network segmentation to isolate critical control networks (@SystemType:OT) from corporate networks (IT) and the internet. Regularly update and patch @SystemType:ICS software and firmware where feasible.",
      "check": "Are all communication links to @SystemType:ICS components authenticated and authorized? Is data in transit encrypted when crossing trust boundaries? Are critical control data assets validated before being used? Is the @SystemType:ICS network properly segmented?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Manipulation of information) and aligns with industrial security standards like IEC 62443.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Manipulation_of_information_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule triggers for technical assets of type 'IoTDevice' (representing @SystemType:ICS components) that have incoming communication links with weak or no security controls (i.e., lacking authentication or authorization). The risk is elevated if these links transmit data assets tagged as '@ICSControlData', as these represent critical operational values.",
      "riskAssessment": "The likelihood is high if interfaces are unprotected, especially if they are exposed to less trusted networks. The impact is directly related to the Integrity and Availability rating of the @SystemType:ICS component and the data it processes. Manipulation of a 'mission-critical' component that controls physical processes has a 'very-high' impact.",
      "falsePositives": "A risk might be a false positive if compensating controls exist that are not @SystemType:OT modeled, such as an out-of-band physical monitoring system that would detect implausible values or actions, or if the interface is only accessible in a physically secured and highly restricted maintenance mode.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "38_sec5.ts",
      "bsiCode": "IND.2.1",
      "id": "insecure-@SystemType:ICS-@SystemType:OT-protocols",
      "title": "Insecure @SystemType:ICS/@SystemType:OT Protocols (based on BSI)",
      "description": "Protocols used in Industrial Control Systems (@SystemType:ICS) and Operational Technology (@SystemType:OT) environments often lack adequate security mechanisms.",
      "impact": "Successful exploitation can lead to a loss of Confidentiality (e.g., of process parameters), Integrity (e.g., manipulation of control commands),",
      "action": "Use Secure Communication Protocols and Network Segmentation",
      "mitigation": "Whenever possible, use protocols that provide end-to-end encryption, strong authentication, and message integrity checks.",
      "check": "Review the protocols used for communication with and between @SystemType:ICS/@SystemType:OT components. Are they encrypted? Is there mutual authentication? Is message integrity verified?",
      "asvs": "Derived from BSI recommendations for @SystemType:ICS/@SystemType:OT security. See BSI CS 132 'Cyber-Sicherheits-Anforderungen an netzwerkverbundene Industriesysteme' and IEC 62443 standard.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/@SystemType:ICS/BSI-CS_132.pdf?__blob=publicationFile (BSI CS 132)",
      "detectionLogic": "This rule checks for communication links involving Industrial Control Systems (@SystemType:ICS) or Operational Technology (@SystemType:OT) Devices that use insecure protocols.",
      "riskAssessment": "The likelihood of exploitation is considered high if an insecure protocol is used without compensating controls, as the vulnerability is easily accessible to anyone on the network segment.",
      "falsePositives": "A risk might be flagged even if the network is physically isolated and considered secure.",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "38_sec6.ts",
      "bsiCode": "IND.2.1",
      "id": "dos-against-@SystemType:ICS-components",
      "title": "Denial-of-Service against @SystemType:ICS Components (BSI @SystemType:ICS-K.3)",
      "description": "Attackers can impair the operation of Industrial Control System (@SystemType:ICS) components through Denial-of-Service (DoS) attacks.",
      "impact": "A successful DoS attack against an @SystemType:ICS component can render it unavailable, disrupting or halting critical industrial processes. This directly impacts Availability and can lead to secondary impacts on Integrity (e.g., corrupted production batches) and even safety.",
      "action": "Implement Network Segmentation and DoS Resilience Measures",
      "mitigation": "Protect @SystemType:ICS components by placing them in a segmented, controlled network zone, separate from general corporate IT and the internet. Use firewalls and intrusion detection/prevention systems (IDS/IPS) to strictly control traffic to the @SystemType:ICS zone. Ensure that components are configured for resilience and have sufficient resources to handle expected network loads. Consider using protocols and devices with built-in DoS protection mechanisms. Have a documented incident response plan for DoS events.",
      "check": "Are @SystemType:ICS components isolated in a dedicated network segment? Are there firewalls or other security gateways protecting the @SystemType:ICS network? Have components been assessed for their resilience to abnormal traffic patterns?",
      "asvs": "BSI IT-Grundschutz @SystemType:ICS-K.3 Denial-of-Service",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/@SystemType:ICS/BSI-CS_108.pdf?__blob=publicationFile (German)",
      "detectionLogic": "This rule triggers for technical assets identified as @SystemType:ICS components (either by technology type `i@SystemType:OT-device` or an `@SystemType:ICS` tag) that have a high or mission-critical availability requirement. The risk is raised if these components have incoming communication links, indicating network exposure.",
      "riskAssessment": "The likelihood of a DoS attack increases with the component's network exposure. Internet-facing @SystemType:ICS components are at a very high risk. Components connected to other internal, non-@SystemType:ICS networks are at a high risk. The impact is derived directly from the availability requirement of the component, as its failure could halt mission-critical operations.",
      "falsePositives": "The risk might be overstated if the component has robust, specialized DoS protection mechanisms that are not captured in the model, or if the connecting networks are very small and highly controlled. It can also be a false positive if an asset is modeled as an `i@SystemType:OT-device` but is not used in a real-time control capacity.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "38_sec7.ts",
      "bsiCode": "IND.2.1",
      "id": "malware-on-@SystemType:ICS",
      "title": "Malware on Industrial Control Systems (@SystemType:ICS)",
      "description": "The threat of malware is increasingly severe for Industrial Control Systems.",
      "impact": "A malware infection on an @SystemType:ICS component can lead to manipulation or failure of industrial processes,",
      "action": "Segment Networks and Control External Interfaces",
      "mitigation": "Strictly segment the @SystemType:ICS/@SystemType:OT network from Office IT and the internet using firewalls or DMZs.",
      "check": "Are @SystemType:ICS assets properly isolated within a dedicated trust boundary? Are all incoming connections from less-trusted networks (Office IT, Internet)",
      "asvs": "N/A (Related to ISA/IEC 62443 standards for IACS Security)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/CS/@SystemType:ICS-Security-Compendium/@SystemType:ICS-Security-Compendium.pdf?__blob=publicationFile (BSI @SystemType:ICS Security Compendium)",
      "detectionLogic": "This rule checks for technical assets tagged as `@SystemType:ICS-component`. It then identifies potential malware infection vectors by analyzing incoming communication links from:",
      "riskAssessment": "The impact is rated based on the @SystemType:ICS component's availability and integrity requirements, which are typically high.",
      "falsePositives": "The model might not capture the presence of specific network security controls like next-gen firewalls, data diodes, or intrusion detection systems (IDS) that mitigate this risk.",
      "cwe": "94",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "38_sec8.ts",
      "bsiCode": "IND.2.1",
      "id": "industrial-espionage-via-@SystemType:ICS-data",
      "title": "Industrial Espionage via @SystemType:ICS/I@SystemType:OT Data (BSI OPS.1.1.5)",
      "description": "@SystemType:ICS/I@SystemType:OT components often contain or transmit detailed information about the regulated or monitored process.",
      "impact": "If an attacker gains access to sensitive @SystemType:ICS/I@SystemType:OT data, it can lead to a loss of competitive advantage and intellectual property.",
      "action": "Encrypt @SystemType:ICS/I@SystemType:OT Communication and Data-at-Rest",
      "mitigation": "All communication to and from @SystemType:ICS/I@SystemType:OT components that transmits sensitive data must be encrypted using strong, modern protocols (e.g., MQTTS, OPC UA with security enabled, HTTPS).",
      "check": "Are all communication channels to/from @SystemType:ICS/I@SystemType:OT devices encrypted? Is sensitive configuration/process data encrypted on the device? Are the devices properly isolated in the network?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.5.A16 (Protection of confidentiality during data transmission) & A17 (Protection of confidentiality for stored data)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Industrial_IT_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies @SystemType:ICS/I@SystemType:OT components (assets with technology 'I@SystemType:OT Device' or tagged with '@SystemType:ICS') that either",
      "riskAssessment": "The likelihood of exploitation is significantly increased if the component is internet-facing or communicates across trust boundaries without encryption.",
      "falsePositives": "This risk may be a false positive if compensating controls exist that are not modeled for @SystemType:OT, such as a hardware-based VPN appliance encrypting all traffic for a network segment, or if the data, despite its classification, is not considered a trade secret for @SystemType:OT.",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "38_sec9.ts",
      "bsiCode": "IND.2.1",
      "id": "manipulation-of-@SystemType:ICS-firmware-ics1-a5",
      "title": "Manipulation of Firmware/Software on @SystemType:ICS Component (BSI @SystemType:ICS.1.A5)",
      "description": "Firmware and application software on @SystemType:ICS (Industrial Control System) components can be illicitly modified. This can happen through various vectors, including: a compromised programming device, a local data interface (e.g., USB), an existing network connection, a manipulated software update in-transit, or a compromised supply chain where the component arrives with malicious firmware already installed.",
      "impact": "Attackers gaining the ability to modify software or firmware can alter, falsify, or disrupt controlled industrial processes. This can lead to equipment damage, production loss, unsafe operating conditions, and denial of service. The primary impact is on the Integrity and Availability of the @SystemType:ICS component and the process it controls.",
      "action": "Implement Firmware/Software Integrity Controls and Secure Update Mechanisms",
      "mitigation": "Use digitally signed firmware and software to ensure authenticity and integrity. Implement secure boot mechanisms to verify software before execution. All update channels, whether network-based or local, must be strongly authenticated and encrypted. Restrict physical and logical access to programming and management interfaces. Vet the supply chain for all hardware and software components to reduce the risk of pre-compromised elements.",
      "check": "Is all firmware and application software digitally signed? Is secure boot enabled? Are software updates delivered over a secure, authenticated channel? Is access to management interfaces (network and physical) strictly controlled and monitored?",
      "asvs": "BSI IT-Grundschutz: @SystemType:ICS.1 General @SystemType:ICS component, Requirement @SystemType:ICS.1.A5 Manipulation of software and firmware on an @SystemType:ICS component.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ICS_1_General_ICS_component_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset of technology type 'I@SystemType:OT-Device' or 'Mainframe', as these often represent specialized @SystemType:ICS or control system hardware. The likelihood increases if the asset receives communication from development or operational tools (e.g., 'Build-Pipeline', 'DevOps-Client'), especially over insecure channels, or if it's a physical machine, which implies susceptibility to local attacks.",
      "riskAssessment": "The impact is derived directly from the **Integrity** and **Availability** ratings of the @SystemType:ICS component itself, as manipulation directly affects these properties. A 'Mission-Critical' component will result in a 'Very-High' impact. The likelihood is considered 'Unlikely' by default but is elevated to 'Likely' if clear-risk factors like insecure update paths or physical accessibility are present in the model.",
      "falsePositives": "The model may not be aware of out-of-band security controls such as strict physical security measures, air-gapped update procedures, or a thoroughly vetted supply chain, which could mitigate this risk in practice.",
      "cwe": "494",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "39_sec1.ts",
      "bsiCode": "IND.2.2",
      "id": "incomplete-plc-documentation",
      "title": "Incomplete PLC/Industrial Control Systems (ICS) Documentation (BSI G 0.19)",
      "description": "Programmable Logic Controllers (PLCs) and other Industrial Control Systems (ICS) are often incompletely documented, so not all product functions are known. Documentation frequently lacks information about used services, protocols, communication ports, and permission management.",
      "impact": "This lack of documentation significantly hinders threat analysis, as critical interfaces, functions, and security mechanisms may be overlooked. Potential threats might not be identified or considered in the security concept. Furthermore, it becomes difficult or impossible to react to newly discovered vulnerabilities if the affected components and their configurations are not properly documented, which can lead to compromises of integrity, availability, and confidentiality.",
      "action": "Ensure Complete and Accurate System Documentation",
      "mitigation": "Create and maintain comprehensive documentation for all PLCs/ICS components. This must include all network interfaces, protocols, ports, and services, as well as the complete authorization and authentication concept. Utilize network scanning and asset inventory tools to discover and verify system properties. Harden systems by disabling all unused and undocumented services and ports. Regularly review and update the documentation, especially after system changes.",
      "check": "Is there complete technical documentation for the PLC/ICS asset? Does it accurately list all communication links, protocols, and ports? Is the permission and authentication model clearly defined?",
      "asvs": "Derived from BSI IT-Grundschutz Catalogues, Threat G 0.19 (Missing or insufficient documentation) as applied to module APP.4.4 (PLC) or newer modules like IND.2 (Industrial IT).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2022/bausteine/APP/APP_4_4_SPS_Edition_2022.html",
      "detectionLogic": "Automatically detects technical assets representing PLCs/ICS (e.g., technology 'IndustrialControlSystem-device') that show signs of being incompletely modeled. This includes communication links using 'unknown-protocol', missing authentication/authorization, or data flows without specified data assets.",
      "riskAssessment": "The likelihood is based on the number and severity of modeling omissions. A link with an 'unknown-protocol' is a strong indicator. The impact is derived from the CIA rating of the asset and the data it processes. An undocumented interface to a mission-critical system represents a high-impact risk.",
      "falsePositives": "The risk might be a false positive if the model is simply incomplete, while the real-world documentation is actually accurate and comprehensive. This must be verified outside the tool.",
      "cwe": "1059",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "3_sec1.ts",
      "bsiCode": "APP.1.4",
      "id": "unsuitable-apps-bsi-threat",
      "title": "Unsuitable or @Maintenance:Unmaintained Applications (BSI Threat)",
      "description": "The choice of applications significantly impacts the information they process, the mobile devices they run on, and often the institution's backend IT infrastructure.",
      "impact": "Using unsuitable or @Maintenance:Unmaintained applications can lead to the compromise of confidentiality, integrity, and availability (CIA) of the data and systems involved.",
      "action": "Establish a Vetting and Lifecycle Management Process for Applications",
      "mitigation": "Implement a formal process for vetting and approving all applications, especially those on mobile devices. This process should include a security review,",
      "check": "Is there a documented policy for selecting and approving third-party applications? Are all mobile applications vetted for security and support before deployment?",
      "asvs": "BSI IT-Grundschutz SYS.2.2.2 Mobile Device Management (MDM)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_2_2_Mobile_Device_Management_MDM_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule triggers for any technical asset of the type 'Mobile App' that is marked as 'custom-developed'. The assumption is that third-party or",
      "riskAssessment": "The likelihood is considered 'Likely', and 'Very Likely' if the asset is internet-facing. The impact is calculated based on the highest CIA requirements of the",
      "falsePositives": "This risk may be considered a false positive if a formal, effective vetting and lifecycle management process is in place for all third-party applications,",
      "cwe": "1104",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "3_sec2.ts",
      "bsiCode": "APP.1.4",
      "id": "excessive-mobile-app-permissions",
      "title": "Excessive Mobile App Permissions (BSI APP.1.2)",
      "description": "Mobile applications require certain permissions to access device functions and services, such as internet connectivity, location data, or the address book.",
      "impact": "Exploitation of excessive permissions can lead to data breaches, unauthorized data modification or deletion, and financial loss.",
      "action": "Apply Principle of Least Privilege for App Permissions",
      "mitigation": "Ensure the mobile application requests only the absolute minimum set of permissions required for its functionality.",
      "check": "Is there a documented justification for every permission the mobile app requests? Does the app use runtime requests for sensitive permissions?",
      "asvs": "MASVS-V2.1: The app only requests the minimum set of permissions required.",
      "cheatSheet": "https://mas.owasp.org/MASTG/tests/android/MASVS-PLATFORM/MASTG-TEST-0055/",
      "detectionLogic": "This risk is raised for all 'Mobile App' technical assets.",
      "riskAssessment": "The likelihood is considered 'Likely' as requesting excessive permissions is a very common issue in mobile app development.",
      "falsePositives": "This risk can be considered a false positive if a thorough review confirms that all requested permissions are minimal, justified, and necessary for the app's core functionality.",
      "cwe": "272",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "3_sec3.ts",
      "bsiCode": "APP.1.4",
      "id": "malicious-mobile-app-sys2.4",
      "title": "Risk from Malicious Mobile Apps (BSI SYS.2.4)",
      "description": "Although some app store operators check the apps they offer, these can still contain security vulnerabilities or deliberately deployed malicious functions.",
      "impact": "If a malicious app is installed, it can lead to unauthorized access to sensitive data, data tampering, service disruption, and compromise of the entire device.",
      "action": "Restrict App Sources and Vet Applications",
      "mitigation": "Enforce a policy that only allows installation of applications from vetted, trustworthy sources (e.g., official corporate or public app stores).",
      "check": "Is there a policy that restricts app installation to trusted sources? Is this policy technically enforced by an MDM/MAM solution?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.2.4 (Clients under Android), specifically Requirement SYS.2.4.A5 'Use of trustworthy app sources'. The principle applies to all mobile operating systems.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_4_Clients_under_Android_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for any 'mobile-app' technical asset. The likelihood is significantly increased if the app is sourced from an 'untrusted' source, as indicated by a tag.",
      "riskAssessment": "The likelihood is 'Very Likely' if an app is sourced from an untrusted location (`@AppSource:untrusted`) and 'Likely' if it comes from a public app store without additional vetting.",
      "falsePositives": "This risk might be flagged for an app from an official store where the organization has a strong, but unmodeled, manual vetting process.",
      "cwe": "506",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "3_sec4.ts",
      "bsiCode": "APP.1.4",
      "id": "vulnerable-@Maintenance:Unmaintained-software",
      "title": "Vulnerabilities in @Maintenance:Unmaintained Software",
      "description": "Software components (e.g., applications, libraries, or systems) that are no longer maintained by their developers pose a significant security risk.",
      "impact": "Successful exploitation of vulnerabilities in @Maintenance:Unmaintained software can lead to a complete compromise of the affected asset's confidentiality, integrity, and availability.",
      "action": "Implement Patch and Vulnerability Management for All Components",
      "mitigation": "Establish a robust patch and vulnerability management process. Maintain a complete inventory of all software assets and their dependencies (a Software Bill of Materials - SBOM).",
      "check": "Is there a documented process for tracking and applying security patches? Is there a complete software inventory (SBOM)?",
      "asvs": "V14.2.1: An inventory of all software components and their versions is maintained.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for any in-scope technical asset marked with the `@Maintenance:Unmaintained` tag.",
      "riskAssessment": "The likelihood of exploitation is significantly increased if the asset is internet-facing or otherwise exposed on a network.",
      "falsePositives": "This risk can be considered a false positive if the `@Maintenance:Unmaintained` tag is applied incorrectly or if effective, verified compensating controls (like virtual patching) are in place but not modeled.",
      "cwe": "1104",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "3_sec5.ts",
      "bsiCode": "APP.1.4",
      "id": "insecure-local-data-storage-on-client",
      "title": "Insecure Local Data Storage on Client Device",
      "description": "Some applications store data on the client device, such as user profiles or documents. If this data is inadequately protected, other applications on the same device might be able to access it. This applies to both intentionally stored data and temporary data, such as information cached by the application.",
      "impact": "Failure to adequately protect locally stored data can lead to breaches of Confidentiality (unauthorized access by other apps or attackers with physical device access), Integrity (unauthorized modification), and Availability (data loss upon device failure or loss). This can result in the exposure of sensitive information and permanent data loss if not backed up.",
      "action": "Implement Secure Storage and Backup for Client-Side Data",
      "mitigation": "Utilize platform-provided secure storage mechanisms (e.g., iOS Keychain, Android Keystore). Encrypt all sensitive data before writing it to local storage on the client device. In the Threagile model, this is reflected by setting the 'encryption' property of the technical asset to a value other than 'none'.",
      "check": "Review client-type technical assets that store data. Verify that the 'encryption' property is not 'none'. For data with high availability requirements, confirm that the 'redundant' flag is set to true or that a communication link to a backup system exists.",
      "asvs": "OWASP MASVS V2: MSTG-STORAGE-1, MSTG-STORAGE-2",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Mobile_Security_Testing_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for in-scope client assets (e.g., mobile apps, desktop clients) that store data. A risk is generated if the data is stored unencrypted ('encryption: none'). A separate risk is generated if the asset is marked as redundant and stores data with high availability requirements.",
      "riskAssessment": "The impact is determined by the Confidentiality and Availability ratings of the data assets stored on the client.",
      "falsePositives": "The risk might be a false positive if the data stored is non-sensitive and public by nature, making encryption unnecessary. The availability risk may be falsely triggered if a backup mechanism is in place but not modeled via the 'redundant' flag (e.g., a specific data flow to a backup service).",
      "cwe": "312",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "3_sec6.ts",
      "bsiCode": "APP.1.4",
      "id": "unwanted-data-leakage-via-app-metadata",
      "title": "Unwanted Data Leakage via App Metadata (BSI APP.4.2)",
      "description": "Apps on client devices (e.g., mobile phones, desktops) often collect extensive metadata about their usage.",
      "impact": "Third parties could analyze this collected metadata to infer sensitive information, even if the app does not have direct access to it.",
      "action": "Restrict App Permissions and Manage Client Devices",
      "mitigation": "Strictly manage and restrict the permissions granted to applications on client devices, especially mobile apps.",
      "check": "Are policies in place to manage app installations and permissions on client devices? Is a Mobile Device Management (MDM) or similar endpoint protection solution used? Are users trained on these risks?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium, Baustein APP.4 Mobile Devices, specifically addressing the threat 'APP.4.2 Unerwünschter Datenabfluss' (Unwanted data leakage).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_Mobile_devices_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is automatically raised for all in-scope technical assets identified as client systems (e.g., mobile apps, browsers, desktop clients, IoT devices).",
      "riskAssessment": "The likelihood is rated higher for mobile and IoT technologies. The impact is determined by the confidentiality requirements of the technical asset,",
      "falsePositives": "This risk might be a false positive if robust device management solutions are in place that effectively restrict app permissions and data exfiltration, but the corresponding asset in the model has not been tagged as such.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "40_sec1.ts",
      "bsiCode": "IND.2.3",
      "id": "@System:UCC-availability-dependencies",
      "title": "Availability Risk for @System:UCC Services due to Critical Dependencies (BSI APP.3.2.A5)",
      "description": "@System:UCC (Unified Communications and Collaboration) services often have high availability requirements. However, their functionality depends on various other IT systems.",
      "impact": "If a critical dependency of a @System:UCC service fails, the availability of the service is compromised. This can hinder communication-dependent business processes.",
      "action": "Architect for Resilience and Manage Critical Dependencies",
      "mitigation": "Identify all critical dependencies for @System:UCC services. For each dependency, implement resilience measures.",
      "check": "Are all dependencies for the @System:UCC service documented? Are the dependencies designed for high availability?",
      "asvs": "BSI IT-Grundschutz APP.3.2.A5 (High availability of @System:UCC services) and CON.1 (Contingency Management).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_UCC_services_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is detected by identifying assets tagged as `@System:UCC-service`. The rule then analyzes their communication links for critical dependencies:",
      "riskAssessment": "The impact is determined by the availability requirement of the @System:UCC service itself (e.g., `mission-critical` availability leads to `very-high` impact).",
      "falsePositives": "The model might not fully capture the resilience of a dependent service. For example, an asset representing an authentication provider might be a single node in the diagram but represent a highly-available cluster in reality. This risk should be validated against the detailed architecture of the dependent services.",
      "cwe": "693",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "40_sec2.ts",
      "bsiCode": "IND.2.3",
      "id": "inadequate-planning-of-@System:UCC-systems-app-3-2-a5",
      "title": "Inadequate Planning of @System:UCC Systems (BSI APP.3.2.A5)",
      "description": "If a Unified Communications and Collaboration (@System:UCC) system is not planned according to its actual and future usage, the functionality of all @System:UCC services can be severely impacted. As usage patterns change or the number of users increases, an initially suitable plan can become insufficient, leading to performance degradation or service outages. This is particularly true for network capacity and the processing power of endpoint devices.",
      "impact": "This can lead to severe degradation or complete failure of communication services (voice, video, messaging), disrupting business processes. For example, video conferences may suffer from stuttering, audio dropouts, or visual artifacts, and real-time communication may become unusable. This directly impacts operational efficiency, collaboration, and the availability of the system.",
      "action": "Ensure Comprehensive @System:UCC Planning and Capacity Management",
      "mitigation": "@System:UCC deployments must be meticulously planned based on current and projected usage, including user numbers, feature sets, and traffic patterns. Network infrastructure must be assessed and dimensioned to handle @System:UCC traffic, especially for real-time services like video and voice. The capabilities of endpoint client devices must be considered, avoiding the use of underpowered devices (like certain thin clients) for performance-intensive tasks. System performance and capacity should be regularly monitored and reviewed.",
      "check": "Is there a formal capacity and usage plan for the @System:UCC system? Has the network been explicitly dimensioned for @System:UCC traffic? Are the minimum hardware requirements for client devices documented and enforced? Is system performance actively monitored?",
      "asvs": "BSI IT-Grundschutz APP.3.2: Unified Communications and Collaboration, Requirement APP.3.2.A5: Planung des @System:UCC-Einsatzes (Planning the use of @System:UCC)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Bausteine/APP/APP_3_2_Unified_Communications_und_Collaboration.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for technical assets identified as part of a @System:UCC system (tagged with `@System:UCC`). The risk is heightened if these systems have high availability requirements. A specific risk is also generated if clients with limited processing power (tagged with `@ThinClient`) connect to @System:UCC systems, as this can lead to performance issues on the client-side, effectively causing a denial of service for that user.",
      "riskAssessment": "The likelihood is high if mission-critical @System:UCC services are deployed without specific capacity planning or if they rely on underpowered clients. The impact is directly related to the availability requirement of the @System:UCC system and the business processes that depend on it. A failure of a mission-critical collaboration platform has a very high impact.",
      "falsePositives": "This risk might be a false positive if comprehensive capacity planning and performance testing have already been performed, even if the model uses tags like `@ThinClient` or marks a @System:UCC system as mission-critical. The model does not contain data about network bandwidth or specific client hardware models. Verification requires reviewing network diagrams, capacity plans, and client hardware specifications.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "40_sec3.ts",
      "bsiCode": "IND.2.3",
      "id": "misconfiguration-of-services",
      "title": "Misconfiguration of Services",
      "description": "A large number of functions and services often implies a multitude of configuration options. This complexity can lead to misconfigurations, especially in systems like those for Unified Communications and Collaboration (@System:UCC), as cited by the BSI. Users may be overwhelmed when configuring their own clients, and administrators may introduce critical errors when altering central settings, particularly if the Identity and Access Management (IAM) concept is insufficient. Such misconfigurations can also result in inadequately restricted permissions for external participants.",
      "impact": "Misconfigurations can lead to a range of negative outcomes, including partial or complete service unavailability (Denial of Service), data loss, and security breaches. Specifically, they can cause unintentional information disclosure (e.g., a conference system auto-accepting calls), information leakage to unauthorized external parties, or data tampering.",
      "action": "Implement and Enforce Secure Configuration Baselines and a Robust IAM Concept",
      "mitigation": "Define hardened security baselines for all system components and verify them regularly. Manage configurations using version-controlled Infrastructure-as-Code (IaC) with automated linting and mandatory peer reviews. Implement a robust Identity and Access Management (IAM) concept based on the principle of least privilege for both administrators and end-users. For user-configurable clients, provide sensible, secure-by-default settings and clear guidance. Permissions for external or guest users must be strictly limited to only what is necessary.",
      "check": "Are secure configuration baselines defined, versioned, and automatically enforced? Is there a formal process for reviewing and approving configuration changes? Does a clear IAM concept exist that enforces least privilege? Are default permissions for external participants explicitly defined and restrictive?",
      "asvs": "OWASP ASVS V1.11.1 (was V14.2.1): The application is hardened and securely configured for all components in the stack.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Configuration_Management_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for technical assets that present a high potential for misconfiguration. This includes: 1. Assets representing user-facing clients which may be misconfigured by end-users. 2. Complex back-end systems, especially those with custom-developed parts. 3. Assets that accept incoming communication from external entities or across trust boundaries with weak or missing authorization, indicating a potential IAM or access control misconfiguration.",
      "riskAssessment": "The likelihood is considered higher for custom-developed components and for services exposed to external users with weak access controls. The impact is directly derived from the Confidentiality, Integrity, and Availability ratings of the technical asset and the data it processes or stores. A misconfiguration of a system handling 'Strictly Confidential' data can lead to a 'Very High' impact.",
      "falsePositives": "This risk is generated based on architectural patterns and asset properties, not the actual live configuration of the system. An asset might be flagged but be perfectly configured and managed according to best practices. Manual verification of the configuration and operational processes is required to confirm or dismiss this risk.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "40_sec4.ts",
      "bsiCode": "IND.2.3",
      "id": "misuse-of-administrative-privileges-on-@System:UCC-systems",
      "title": "Misuse of Administrative Privileges on @System:UCC Systems (BSI APP.3.2)",
      "description": "Due to their assigned administrative rights, administrators can potentially make profound changes to Unified Communications and Collaboration (@System:UCC) services.",
      "impact": "Unauthorized or abusive use of administrative privileges can lead to breaches of Confidentiality (e.g., exposing private chats/files), Integrity (e.g., unauthorized modification of data), and Availability (e.g., maliciously altering routing configurations to disrupt services like telephony).",
      "action": "Implement Strict Access Control, Monitoring, and Auditing for Administrative Roles on @System:UCC Systems",
      "mitigation": "Enforce the principle of least privilege for all administrative accounts on @System:UCC systems. Use dedicated, separate accounts for administrative tasks versus daily use.",
      "check": "Are administrative privileges on @System:UCC systems granted based on the principle of least privilege? Are all administrative actions logged? Are these logs regularly reviewed for suspicious activity? Are separate accounts used for administrative access?",
      "asvs": "BSI IT-Grundschutz Baustein APP.3.2 Unified Communications und Collaboration (@System:UCC)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_2_Unified_Communications_und_Collaboration_UCC__Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for technical assets that are identified as part of a @System:UCC system (e.g., mail servers, file servers, web applications, message queues) and are tagged with administrative roles.",
      "riskAssessment": "The impact is directly dependent on the confidentiality, integrity, and availability requirements of the @System:UCC system and the data it processes. A system handling 'strictly-confidential' data faces a 'very-high' impact.",
      "falsePositives": "A risk might be flagged as a false positive if the model does not capture compensating controls, such as a strictly enforced four-eyes principle for all administrative changes or real-time automated auditing that can block malicious actions.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "40_sec5.ts",
      "bsiCode": "IND.2.3",
      "id": "unintentional-disclosure-via-@System:UCC-client",
      "title": "Unintentional Information Disclosure via @System:UCC Client",
      "description": "Modern Unified Communications and Collaboration (@System:UCC) clients offer a wide range of features, which can make them complex and confusing for many users.",
      "impact": "Misuse of @System:UCC clients can lead to serious breaches of confidentiality and violations of internal policies. Sensitive information can be exposed to unauthorized individuals, both internal and external, leading to reputational damage, loss of competitive advantage, and potential legal or regulatory penalties.",
      "action": "Implement User Training and Harden @System:UCC Service Configuration",
      "mitigation": "A combination of user awareness and technical controls is required.",
      "check": "Are users regularly trained on secure @System:UCC practices? Are there clear policies for data handling within @System:UCC platforms? Are @System:UCC services configured with secure defaults (e.g., private-by-default team spaces)? Does the client UI provide clear warnings and indicators to prevent user error?",
      "asvs": "Derived from BSI IT-Grundschutz SYS.3.2.2 Unified Communications und Collaboration, specifically Requirement SYS.3.2.2.A5 'Sensibilisierung der Benutzer für die sichere Nutzung von @System:UCC-Diensten' (Sensitization of users for the secure use of @System:UCC services).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/sys/SYS_3_2_2_Unified_Communications_und_Collaboration_Edition_2023.pdf?__blob=publicationFile (BSI SYS.3.2.2)",
      "detectionLogic": "This risk is triggered for in-scope technical assets representing clients (e.g., Desktop, Mobile App, Browser) that are explicitly identified as being used for Unified Communications and Collaboration via the '@System:UCC-Client' tag.",
      "riskAssessment": "The likelihood of this risk is considered high due to the inherent complexity of feature-rich @System:UCC clients and common gaps in user awareness. The impact is determined by the sensitivity of the data that the client asset is rated to handle, as well as the data it processes. A client used to discuss 'Strictly Confidential' project details poses a much higher impact than one used for public relations.",
      "falsePositives": "The risk might be lower than calculated if the organization has an exceptionally robust and effective user training program for its @System:UCC tools, or if the specific client application has a very simple, intuitive design that minimizes the chance of user error.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "40_sec6.ts",
      "bsiCode": "IND.2.3",
      "id": "unwanted-disclosure-via-@System:UCC-services",
      "title": "Unwanted Disclosure of Information via @System:UCC Services (BSI OPS.2.2, OPS.1.1.5)",
      "description": "Unified Communications and Collaboration (@System:UCC) services often collect and display user data, such as presence status, activity timestamps, and even detailed analytics of conversations and content. This can lead to the creation of user profiles and the unintentional disclosure of personal or sensitive information.",
      "impact": "The unintentional disclosure of information can lead to privacy violations, enabling behavior and performance monitoring of employees. It can also expose personal relationships, work habits, and details of an individual's private life. This compromises confidentiality and can lead to reputational damage or social engineering attacks.",
      "action": "Implement and Enforce Privacy-Enhancing Configurations and User Training for @System:UCC Services.",
      "mitigation": "Technically, configure @System:UCC services to minimize data collection and exposure. Restrict visibility of presence status, disable or limit activity logging and analytics features, and enforce the use of virtual backgrounds or background blur in video conferences.",
      "check": "Are @System:UCC privacy settings reviewed and configured to a 'privacy-first' baseline? Are features like activity tracking disabled or their use justified and restricted? Is there a user training program that covers the privacy risks of remote collaboration and video conferencing?",
      "asvs": "BSI IT-Grundschutz Baustein OPS.2.2.A15 (Protection of user privacy in groupware) and OPS.1.1.5.A7 (Training for users of video conference systems).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_2_2_Groupware_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for assets identified as Unified Communications and Collaboration (@System:UCC) components. This includes both server-side assets (like Web Applications, Mail Servers, or Message Queues) that might aggregate user data, and client-side assets (like Mobile Apps or Browsers) that might expose the user's private environment when communicating with @System:UCC services.",
      "riskAssessment": "The likelihood is considered high for client applications due to the commonness of environmental exposure in video calls, and likely for server applications that offer extensive collaboration features. The impact is determined by the confidentiality of the data assets processed by the asset or transmitted over its communication links. Higher confidentiality data leads to a higher impact rating.",
      "falsePositives": "This risk might be a false positive if the identified asset is a @System:UCC tool with very limited functionality (e.g., a simple text-only chat with no presence) or if strong technical and organizational privacy controls are already proven to be in place and effective.",
      "cwe": "359",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "40_sec7.ts",
      "bsiCode": "IND.2.3",
      "id": "@System:UCC-service-interaction-risk-app-5-3",
      "title": "Functional Impairment due to @System:UCC Service Interaction (BSI APP.5.3.T5)",
      "description": "@System:UCC (Unified Communications and Collaboration) services can cause interactions with each other that restrict functionality.",
      "impact": "If @System:UCC services interfere with each other or overload the client system, their availability is compromised. This can disrupt business processes, prevent employees from completing tasks, and lead to a loss of productivity.",
      "action": "Isolate @System:UCC Services or Manage Shared Resources",
      "mitigation": "To prevent conflicts, run critical @System:UCC services on dedicated clients or in isolated environments (e.g., virtual machines).",
      "check": "Are multiple technical assets tagged with '@UCCService' running within the same shared runtime?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.5.3 @System:UCC-Clients (Edition 2022)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_5_3_UCC_clients_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is automatically triggered for any 'Shared Runtime' that contains two or more technical assets tagged as an '@UCCService'.",
      "riskAssessment": "The likelihood of a conflict is considered 'Likely' when multiple @System:UCC services are co-located. The impact is determined by the highest availability requirement among the conflicting services.",
      "falsePositives": "This risk might be a false positive if the @System:UCC applications are specifically designed to interoperate without conflict, or if the underlying operating system and hardware have robust resource management that prevents contention issues.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "40_sec8.ts",
      "bsiCode": "IND.2.3",
      "id": "uncontrolled-desktop-sharing",
      "title": "Uncontrolled Desktop or Application Sharing (BSI CON.3.A13)",
      "description": "When desktop or screen content is shared with other participants in a conversation (e.g., video conference, remote support), control can be transferred to other users.",
      "impact": "If an attacker or unauthorized participant gains control over a user's client, they can access sensitive data, install malware, manipulate files, or use the compromised",
      "action": "Restrict or Control Remote Desktop Sharing Features",
      "mitigation": "If the remote control feature is required, it should be disabled by default in collaboration tools.",
      "check": "Is remote control functionality in collaboration and screen-sharing tools disabled by default? Are users trained on the risks of this feature?",
      "asvs": "BSI IT-Grundschutz CON.3.A13 Remote control of clients",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Video_conferencing_systems_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for all in-scope client-type technical assets that are marked as being used by a human.",
      "riskAssessment": "The likelihood is considered higher for any client system, as the vulnerability stems from user behavior and common application features.",
      "falsePositives": "This risk may be a false positive if the remote control feature is confirmed to be disabled via technical controls (e.g., GPO, MDM policies)",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "40_sec9.ts",
      "bsiCode": "IND.2.3",
      "id": "@System:UCC-impersonation-risk",
      "title": "Impersonation Risk in Unified Communications and Collaboration (@System:UCC) Services",
      "description": "The introduction of new Unified Communications and Collaboration (@System:UCC) services, which often allow external parties to initiate contact, creates new avenues for attackers.",
      "impact": "Successful impersonation can lead to unauthorized disclosure of sensitive or confidential information, manipulation of business processes, and financial fraud.",
      "action": "Strengthen Identity Verification and User Awareness for Communication Platforms",
      "mitigation": "Implement a multi-layered defense. From a technical perspective, ensure that any user interface (UI) clearly and unmistakably labels communications originating from external sources.",
      "check": "Are all incoming communications from external sources clearly and prominently marked as such in the user interface?",
      "asvs": "V4.1 Identity and Verification Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Social_Engineering_Prevention_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for communication-oriented technical assets (like web applications, message queues, or mail servers) that are exposed to interaction from less-trusted sources.",
      "riskAssessment": "The likelihood of exploitation is high if the communication platform is directly exposed to the internet and lacks strong authentication for incoming interactions.",
      "falsePositives": "A technical asset might be flagged incorrectly if it has robust, non-bypassable controls for differentiating and flagging external communications that are captured in the threat model.",
      "cwe": "451",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "41_sec1.ts",
      "bsiCode": "IND.2.4",
      "id": "lack-of-maintenance-ops1.1.2",
      "title": "Lack of Regular Maintenance (BSI OPS.1.1.2)",
      "description": "If systems, applications, or hardware components are not regularly maintained, they can malfunction, perform poorly, or fail completely.",
      "impact": "Failure to perform regular maintenance primarily compromises the **Availability** of the affected asset and can also impact its **Integrity** (e.g., through data corruption or performance degradation).",
      "action": "Establish and Document a Regular Maintenance Plan",
      "mitigation": "Define, document, and implement a formal maintenance plan for all in-scope technical assets. This plan should specify maintenance tasks (e.g., patching, health checks, capacity monitoring, hardware inspection), frequencies, and responsible personnel.",
      "check": "Is there a documented maintenance plan for the asset? Are maintenance activities logged and auditable?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.2 (Proper Operation), specifically Requirement OPS.1.1.2.A11 (Maintenance and repair of IT components).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_2_Proper_operation_edition_2023.pdf?__blob=publicationFile (BSI OPS.1.1.2)",
      "detectionLogic": "This risk is raised for any technical asset that is not explicitly excluded (like serverless platforms or external entities) and does not have a `maintenance` tag.",
      "riskAssessment": "The likelihood of failure due to lack of maintenance increases with the asset's own operational requirements (i.e., its Availability rating).",
      "falsePositives": "A risk might be flagged for an asset that is actually well-maintained but lacks the corresponding tag in the model.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "41_sec2.ts",
      "bsiCode": "IND.2.4",
      "id": "insufficient-machine-interface-protection",
      "title": "Insufficient Machine Interface Protection (BSI-based)",
      "description": "If the interfaces of a machine (e.g., an IoT device, industrial control system, or mainframe) are insufficiently protected,",
      "impact": "Successful manipulation can lead to tampering with the machine's core functions. This could result in damaged physical goods or faulty product series (a loss of Integrity for processed assets),",
      "action": "Harden and Protect All Machine Interfaces",
      "mitigation": "Ensure that all communication links to the machine, especially those used for configuration, control, or administration, are adequately protected.",
      "check": "Review all incoming communication links to assets identified as physical machines. Are any using unencrypted protocols? Is authentication and/or authorization set to 'none'? Is network access appropriately restricted?",
      "asvs": "Not directly applicable as ASVS is web-focused. The equivalent in the Industrial Control Systems (ICS) space is IEC 62443, particularly concepts around zone and conduit boundaries and access control.",
      "cheatSheet": "https://www.cisa.gov/uscert/ICS/Recommended-Practices",
      "detectionLogic": "This rule triggers for technical assets that represent physical machines (i.e., `machine: physical`), particularly those with technologies like `IoT-device` or `mainframe`.",
      "riskAssessment": "The likelihood of exploitation is elevated if the insecure interface is accessible across a network trust boundary. The impact is directly correlated with the 'Integrity' and 'Availability' ratings of the machine.",
      "falsePositives": "This risk can be a false positive if there are strong compensating controls captured in the model, such as the machine being located in a physically secure, air-gapped network.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "42_sec1.ts",
      "bsiCode": "IND.2.7",
      "id": "manipulation-of-safety-instrumented-system",
      "title": "Manipulation of Safety Instrumented System (based on NAMUR NA 163)",
      "description": "The manipulation of the application program on a logic system within a Safety Instrumented System (SIS) poses a significant risk. Unlike standard IT or OT components, a compromise of a SIS can have severe consequences for the safety of people, the environment, and physical plants.",
      "impact": "Successful manipulation can lead to a range of outcomes from operational downtime (spurious trip) to the complete failure of safety functions, potentially resulting in catastrophic physical damage, environmental harm, or loss of life when a hazardous event occurs.",
      "action": "Implement a Defense-in-Depth Security Architecture for OT/ICS Environments",
      "mitigation": "A multi-layered security approach is required. This includes strict network segmentation to isolate the SIS, robust access control mechanisms (both physical and logical) for the logic controller, and continuous integrity monitoring of the application program.",
      "check": "Is the SIS network segment isolated from the corporate and other control networks? Is access to the logic controller's programming interface restricted to authorized personnel and workstations?",
      "asvs": "Derived from BSI recommendations and NAMUR NA 163 guidelines for industrial control system security.",
      "cheatSheet": "https://www.namur.net/fileadmin/media/Publications/NA163_Automation_Security_for_Safety_Instrumented_Systems_2020-03-31.pdf",
      "detectionLogic": "This rule triggers on technical assets identified as core logic controllers for Safety Instrumented Systems, marked with the '@AssetType: sis-logic-controller' tag.",
      "riskAssessment": "The risk is assessed across three categories:",
      "falsePositives": "The risk may be overstated if the asset is incorrectly tagged or if there are extensive, un-modeled compensating controls (e.g., separate physical safety relays, redundant diverse systems).",
      "cwe": "749",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "42_sec2.ts",
      "bsiCode": "IND.2.7",
      "id": "inadequate-monitoring-of-it-infrastructure",
      "title": "Inadequate Monitoring of Supporting IT Infrastructure for Security Events",
      "description": "A key function of automation systems is to monitor the operational states of the process to be automated (e.g., fill levels, temperature).",
      "impact": "Failure to monitor the IT infrastructure prevents the early detection of security incidents, system failures, or performance degradation. This can lead to successful attacks going unnoticed, prolonged downtime, and an inability to perform forensic analysis, ultimately compromising the confidentiality, integrity, and availability of the system and its data.",
      "action": "Implement Comprehensive Security Monitoring and Logging",
      "mitigation": "Ensure that all critical IT infrastructure components (servers, network devices, applications, databases) generate security-relevant logs. These logs should be centrally collected, correlated, and monitored by a Security Information and Event Management (SIEM) system or a dedicated monitoring solution. Define and implement alerts for suspicious activities, security events, and critical system health indicators. Ensure monitoring systems themselves are secured and highly available. Model these monitoring systems and the communication links from monitored assets to them.",
      "check": "Are security-relevant events from all critical infrastructure components being logged? Is there a central logging and monitoring system in place? Are there defined alert rules for security events? Are personnel assigned to respond to these alerts? Is this architecture reflected in the threat model?",
      "asvs": "BSI IT-Grundschutz DER.1: Detection of Security-Relevant Events",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Detection_of_security_relevant_events_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified for any in-scope 'process' or 'datastore' asset that is not itself a monitoring component and does not have a documented communication link to a monitoring system (e.g., an asset with technology like 'Monitoring', 'IDS', 'IPS', or 'WAF').",
      "riskAssessment": "The likelihood is considered 'Likely' for any unmonitored critical component, as attacks and failures are common occurrences. The impact is rated based on the highest Confidentiality, Integrity, and Availability (CIA) rating of the technical asset, including the data it processes or stores. An unmonitored mission-critical database poses a very high impact.",
      "falsePositives": "This risk can be a false positive if monitoring is achieved through mechanisms not represented in the model, such as host-based agents reporting to a SaaS platform that isn't modeled, or via infrastructure-level monitoring in a cloud environment. It can also be a false positive for ephemeral assets or components with no security-sensitive role.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "43_sec1.ts",
      "bsiCode": "IND.3.2",
      "id": "undocumented-@SystemType:OT-remote-access",
      "title": "Undocumented or Unmanaged Remote Maintenance Access in @SystemType:OT/@SystemType:ICS Environment",
      "description": "Remote maintenance access points in Operational Technology (@SystemType:OT) are often numerous and diverse, managed by various internal and external parties. This complexity can lead to an incomplete or inaccurate inventory of access points. If undocumented remote access paths exist, they cannot be controlled, monitored, or secured. Unauthorized users could gain access and directly manipulate physical processes, causing equipment malfunction, production standstills, or even physical harm to on-site personnel. This risk is often amplified when vendors supply 'Package Units' with pre-configured, insecure default remote access.",
      "impact": "An exploited unmanaged remote access can directly compromise the integrity and availability of Industrial Control Systems (@SystemType:ICS). This can lead to significant operational disruptions, damage to machinery, loss of production, and severe health and safety incidents. It represents a critical failure in the separation of IT and @SystemType:OT networks.",
      "action": "Establish and Maintain a Comprehensive Inventory and Management of Remote Access Points",
      "mitigation": "Establish a strict process for authorizing, documenting, and provisioning all remote access to the @SystemType:OT environment. Maintain a complete and current inventory of all remote access links, including their purpose, owner, and security controls. All access should be routed through a controlled gateway or 'jump host'. Default credentials and configurations from vendors must be changed immediately upon deployment. Employ a 'deny-by-default' network policy for the @SystemType:OT boundary. Ensure all remote connections use strong, multi-factor authentication, are encrypted, and are logged and monitored.",
      "check": "Is there a complete, up-to-date inventory of all remote maintenance access points into the @SystemType:OT zone? Is all remote access forced through a secure, monitored gateway? Are security controls like VPN, IP filtering, and strong authentication enforced on all remote links? Are default vendor settings for remote access disabled or changed?",
      "asvs": "Derived from BSI IT-Grundschutz Compendium, specifically concepts in IND.1 (Industrial Control System) and IND.2 (Remote maintenance of industrial components). This rule addresses the threat of unmanaged remote connections (IND.2.4.A1, IND.2.4.A2).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/IND_2_Remote_maintenance_of_industrial_components_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies communication links that originate from outside a trust boundary tagged as an '@Environment:OT' and target an asset within it. It flags such remote access links if they lack fundamental security controls like VPN, IP filtering, strong authentication, or encryption. The presence of such a link suggests a potential unmanaged or insecure remote access path.",
      "riskAssessment": "The likelihood of exploitation is high if multiple security controls are missing (e.g., no VPN and weak authentication). The impact is determined by the criticality of the target @SystemType:OT asset. If the asset controls a process with high integrity or availability requirements (e.g., mission-critical), the impact is rated as very high, reflecting the potential for physical damage or safety incidents.",
      "falsePositives": "This risk may be a false positive if compensating controls exist that are not modeled (e.g., a hardware firewall enforcing IP filtering that is not represented as a 'WAF' or 'ip_filtered' property in the model). The rule assumes that the model accurately reflects the security properties of the communication link.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "43_sec2.ts",
      "bsiCode": "IND.3.2",
      "id": "unmanaged-dependencies-between-@SystemType:OT-and-it",
      "title": "Unmanaged Dependencies between @SystemType:OT and Office IT (BSI @SystemType:ICS-style)",
      "description": "Industrial Control Systems (@SystemType:ICS) and Operational Technology (@SystemType:OT) often depend on uninterrupted, real-time data flows.",
      "impact": "If dependencies between @SystemType:OT and office IT are not taken into account and, as a result, security vulnerabilities are not closed, security incidents (especially availability failures) can quickly spread to the entire @SystemType:OT.",
      "action": "Segment and Control Connections between @SystemType:OT and Office IT",
      "mitigation": "Strictly segment the @SystemType:OT network from the office IT network using firewalls, data diodes, or other perimeter protection. All communication crossing this boundary must be explicitly defined, monitored, and secured.",
      "check": "Are there communication links between assets tagged '@Domain:IT' and assets tagged '@SystemType:OT'? Is remote maintenance performed via shared office IT infrastructure? Are the availability ratings of the IT assets sufficient for the dependent @SystemType:OT assets?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (General @SystemType:ICS component), specifically threat T 0.40 'Failure or disruption of a central infrastructure service'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_ICS_component_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is detected by identifying communication links that cross from a technical asset tagged as '@Domain:IT' to an asset tagged as '@SystemType:OT'.",
      "riskAssessment": "The impact is determined primarily by the Availability rating of the target @SystemType:OT asset. A dependency on a low-availability IT service for a 'mission-critical' @SystemType:OT asset constitutes a very high impact.",
      "falsePositives": "This risk can be a false positive if the network segmentation is handled by an out-of-scope component (e.g., a firewall not modeled in Threagile) that effectively mitigates the risk. The tagging '@Domain:IT' and '@SystemType:OT' must be applied correctly across assets to ensure accurate detection.",
      "cwe": "668",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "43_sec3.ts",
      "bsiCode": "IND.3.2",
      "id": "inadequately-regulated-@SystemType:OT-remote-access",
      "title": "Inadequately Regulated @SystemType:OT Remote Access (BSI CON.6)",
      "description": "@SystemType:OT remote maintenance access has a very large potential user base outside the operating institution. At the same time, the seamless availability of real-time data in an Industrial Control System (@SystemType:ICS) is essential. General regulations for office IT remote access are often unsuitable for @SystemType:OT or allow too much leeway. This lack of specific, restrictive rules for @SystemType:OT remote access can lead to severe security gaps.",
      "impact": "If the use of @SystemType:OT remote access is inadequately regulated, operators cannot control who uses the access or how it is used. This can lead to unauthorized access, credential sharing with unknown third parties, and difficulty in forensic analysis during security incidents, potentially prolonging costly production downtimes. If access paths are shared with standard office IT, inconsistent security configurations can arise that fail to meet the stricter requirements of the @SystemType:OT environment, exposing critical infrastructure to threats originating from the corporate network.",
      "action": "Implement Strict Contractual and Technical Controls for @SystemType:OT Remote Access",
      "mitigation": "Enforce dedicated, isolated access paths for all @SystemType:OT remote maintenance. Use a bastion host or jump server as a single, controlled entry point. Mandate strong multi-factor authentication (MFA/2FA) for all remote access. Ensure all connections are encrypted via VPN and an encrypted protocol. Apply the principle of least privilege for authorization. All remote access sessions must be logged in detail and monitored for suspicious activity. These technical requirements should be part of a formal, documented agreement with any third-party service provider.",
      "check": "Is there a documented policy specifically for @SystemType:OT remote access? Is access strictly limited to dedicated pathways, separate from corporate IT? Is two-factor authentication mandatory? Is the connection secured by both a VPN and an encrypted protocol? Are sessions logged and monitored?",
      "asvs": "BSI IT-Grundschutz CON.6 Remote Maintenance",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Remote_maintenance_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies remote maintenance communication links from external entities to technical assets within an @SystemType:OT environment. It then checks for common security weaknesses, such as inadequate authentication (n@SystemType:OT 2FA), lack of VPN encryption, or use of unencrypted protocols. It also detects architectural flaws where a single external entity has an access path to both @SystemType:OT and standard office IT environments, violating required network segmentation.",
      "riskAssessment": "The impact of any weakness in @SystemType:OT remote access is rated High or Very-High, depending on the availability and integrity requirements of the target @SystemType:OT asset, reflecting the potential for physical damage or production stoppage. The likelihood is rated based on the detected weakness; shared access paths are considered Very Likely to be exploited as a pivot vector, while missing technical controls are considered Likely.",
      "falsePositives": "The model may not fully represent complex network architectures, such as a well-configured bastion host that mitigates the risk of a shared access path. Such compensating controls should be verified manually before accepting the risk.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "43_sec4.ts",
      "bsiCode": "IND.3.2",
      "id": "uncontrolled-@SystemType:OT-remote-maintenance",
      "title": "Uncontrolled Remote Maintenance in @SystemType:OT Environments",
      "description": "Data and configuration settings within an Industrial Control System (@SystemType:ICS), as well as on-site personnel, property, and production processes, can be endangered by any access from other zones that is not adequately controlled by internal on-site staff or is insufficiently secured. In particular, personnel from external maintenance service providers, integrators, and manufacturing companies have the necessary specialized knowledge of the plant, machine, or component to be maintained, but are often unaware of the potential harmful effects a specific remote maintenance session can have on the overall system.",
      "impact": "If the processes and contents of @SystemType:OT remote maintenance sessions cannot be adequately controlled by the operators, configuration errors with high-risk potential, as well as unintentional or intentional misconduct by maintenance personnel, may not be detected or traced quickly enough. This can lead to failures or manipulation of real-time data streams, or allow malware to spread unnoticed throughout the entire @SystemType:OT network. The consequences can range from harm to life and limb of on-site operating personnel, to high financial losses due to production downtimes, up to the destruction of entire plants. Disclosure of trade secrets is also possible. Furthermore, the integrity of the manufactured products can be impaired (e.g., through manipulation of recipes), which can lead to reputational damage.",
      "action": "Implement Controlled and Monitored Remote Maintenance Access",
      "mitigation": "All remote maintenance access to @SystemType:OT/@SystemType:ICS environments, especially from external entities, must be routed through a controlled and monitored gateway (e.g., a jump host or bastion host). Implement a strict approval process for every maintenance session (e.g., 'four-eyes principle'). All sessions must be logged and, for critical systems, recorded. Access should be restricted to specific systems and times (principle of least privilege). Use strong authentication and encrypted protocols (e.g., via a mandatory VPN). Network segmentation should prevent lateral movement from the maintenance target into the wider @SystemType:OT network.",
      "check": "Is all remote maintenance access from external parties logged and monitored? Is there a formal approval process for initiating a remote session? Is access restricted to only the necessary components and timeframes? Are secure protocols and VPNs enforced for all remote connections into the @SystemType:OT environment?",
      "asvs": "BSI IT-Grundschutz @SystemType:ICS.S.5 Fernwartung, BSI-CS 108",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/@SystemType:ICS/BSI-CS_108.pdf?__blob=publicationFile (German)",
      "detectionLogic": "This rule identifies communication links originating from an 'External Entity' used for 'DevOps' (maintenance) purposes that target a technical asset tagged as being part of an @SystemType:OT/@SystemType:ICS environment. The existence of such a direct, potentially unmanaged access path is the primary risk.",
      "riskAssessment": "The likelihood is considered high by default for any direct external maintenance access to an @SystemType:OT system, as the potential for unmonitored, uncoordinated actions is significant. The impact is derived from the availability and integrity rating of the target @SystemType:OT asset, as failures or manipulations can halt production or destroy equipment. If the target asset is 'Mission-Critical', the impact is rated as 'Very High'.",
      "falsePositives": "A risk might be a false positive if the model shows a direct connection, but in reality, it passes through a central, fully-controlled and monitored remote access solution that is not explicitly modeled as a separate asset. In such cases, the risk can be accepted with justification.",
      "cwe": "552",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "43_sec5.ts",
      "bsiCode": "IND.3.2",
      "id": "direct-access-to-@SystemType:ICS-@SystemType:OT-from-less-trusted-networks",
      "title": "Direct IP Access to @SystemType:ICS/@SystemType:OT Systems from Less-Trusted Networks (BSI CON.6)",
      "description": "Data within an Industrial Control System (@SystemType:ICS) as well as on-site personnel, property, and production processes are fundamentally endangered by direct IP-based access from other zones and networks. This is exacerbated by factors like the significantly longer patch cycles in @SystemType:OT compared to office IT. Furthermore, remote maintenance access to an @SystemType:ICS often originates from networks that are not fully trusted, including not only external third-party networks but also other zones within the organization's own network, such as internal office IT, building management systems, or even other @SystemType:OT zones (e.g., for production management with MES, ERP).",
      "impact": "Direct access to an @SystemType:ICS from other zones and networks, for instance via a local connection or VPN, can introduce malware and facilitate targeted attacks. This can lead to physical harm to individuals, substantial financial losses from production downtime, and the exfiltration of confidential information, such as trade secrets.",
      "action": "Implement Strict Network Segmentation and Access Control for @SystemType:ICS/@SystemType:OT Environments",
      "mitigation": "Prohibit direct communication from less-trusted networks (like office IT) to the @SystemType:OT/@SystemType:ICS network zone. All remote access must be brokered through a hardened bastion host (jump server) located in a dedicated Demilitarized Zone (DMZ). Enforce strict firewall rules to ensure that only authorized and necessary traffic can enter the @SystemType:OT zone, based on the principle of least privilege. Use secure protocols for all remote access and monitor all connections crossing the boundary into the @SystemType:OT environment.",
      "check": "Are there any direct communication links from assets in office/corporate networks to assets inside the @SystemType:OT/@SystemType:ICS trust boundary? Is all remote maintenance access forced through a hardened jump host? Are firewall rules in place to strictly control traffic into the @SystemType:OT zone?",
      "asvs": "BSI IT-Grundschutz CON.6 (Industrial Control Systems)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Industrial_Control_Systems_ICS_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule checks for communication links that cross from a non-@SystemType:OT network boundary directly into an @SystemType:OT network boundary, targeting an asset tagged as '@SystemType:OT-Asset'. It identifies situations where office systems, clients, or other non-hardened assets have a direct communication path to critical industrial control systems, bypassing recommended architectural patterns like a DMZ with a bastion host.",
      "riskAssessment": "The impact is determined by the CIA ratings of the target @SystemType:OT asset, reflecting the potential for physical harm, production stoppage, or data theft. The likelihood is considered higher for remote maintenance connections ('devops' usage) or connections from standard client systems, as these are common attack vectors. Unencrypted protocols further increase the likelihood.",
      "falsePositives": "A direct connection might be reported as a risk even if it is secured by an external, un-modeled firewall with very strict rules. This risk is most accurate when trust boundaries are modeled correctly to represent the separation between @SystemType:OT and corporate networks.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "43_sec6.ts",
      "bsiCode": "IND.3.2",
      "id": "insecure-alternative-remote-access-@SystemType:OT",
      "title": "Insecure Alternative Remote Maintenance Access to @SystemType:OT/@SystemType:ICS Environments",
      "description": "In industrial environments, alternative remote maintenance accesses are often set up to ensure reliability and performance, especially during incidents where primary access may fail or be too slow. These secondary access paths (e.g., via cellular modem) provide a quick way to manage remote systems. However, such alternative access points can be particularly vulnerable to attack if they are not implemented with the same rigor as primary systems.",
      "impact": "If an alternative remote access path does not fully meet the institution's security requirements, attackers can use it as a weak point to penetrate the @SystemType:OT network. This can lead to unauthorized control of industrial processes, equipment damage, production stoppage, safety hazards, and the theft of sensitive operational data, severely impacting the Integrity and Availability of the @SystemType:ICS.",
      "action": "Secure and Harden All Remote Maintenance Access Paths",
      "mitigation": "Ensure that all remote access paths, including alternative and emergency ones, are subject to the same stringent security policies. This includes enforcing strong multi-factor authentication (MFA), using encrypted protocols (e.g., within a robust VPN), implementing strict IP-based access control lists (firewalls), and routing traffic through a bastion host or jump server. All access attempts should be logged and actively monitored. Alternative access should be disabled by default and only enabled when explicitly required.",
      "check": "Are all remote access paths to @SystemType:OT networks, including alternatives, fully documented? Do they all enforce MFA, strong end-to-end encryption, and strict access controls? Is all remote access traffic logged and monitored for anomalies?",
      "asvs": "BSI IT-Grundschutz CON.1: General Remote Access. The described scenario is a classic example of bypassing standard security controls for operational convenience, a key concern in @SystemType:ICS security.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/CON_1_General_remote_access_Edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
      "detectionLogic": "This rule checks for communication links tagged as '@MaintenanceAccess:alternative' that provide access to sensitive @SystemType:OT/@SystemType:ICS networks. A risk is raised if such a link originates from a non-@SystemType:OT environment and lacks fundamental security controls like VPN, IP filtering, strong authentication, or protocol-level encryption.",
      "riskAssessment": "The impact is directly related to the criticality of the target @SystemType:OT asset. Access to a mission-critical system can have a 'Very High' impact. The likelihood is considered 'Likely' or 'Very Likely' because attackers specifically target such misconfigured remote access points as they are often a reliable and overlooked entry vector.",
      "falsePositives": "The model might capture compensating controls (e.g., a separate, unmodeled hardware firewall) that mitigate the risk. A link might be tagged as an alternative but still be fully secured, which would result in a false positive. Manual verification of the link's security configuration is recommended.",
      "cwe": "287",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "43_sec7.ts",
      "bsiCode": "IND.3.2",
      "id": "insecure-@SystemType:OT-remote-maintenance-access",
      "title": "Insecure Remote Maintenance Access in @SystemType:OT/@SystemType:ICS Environments (BSI CON.1-Style)",
      "description": "Decentralized Industrial Control System (@SystemType:ICS) infrastructures often feature numerous remote maintenance access points from various manufacturers, many using proprietary solutions. This complexity hinders proper central security management. When these @SystemType:OT remote access points are located in openly accessible areas, or are protected only by weak, manufacturer-provided security components that do not meet the organization's standards, attackers can more easily penetrate @SystemType:OT networks to carry out manipulations.",
      "impact": "Successful exploitation of insecure remote access can allow attackers to manipulate control processes, disrupt physical operations, cause equipment damage, and compromise safety systems. This directly threatens the integrity and availability of the @SystemType:OT environment, leading to production loss, financial damage, and potential physical harm.",
      "action": "Implement Hardened and Centralized Remote Access Solution",
      "mitigation": "All remote maintenance access to @SystemType:OT environments should be routed through a centralized, hardened bastion host or jump server. Enforce strong, multi-factor authentication (MFA) for all remote access. Use encrypted protocols (e.g., VPN, SSH tunnels) for the entire communication path. Physically secure any hardware providing remote access capabilities. Deactivate or replace weak, manufacturer-default credentials and security settings with configurations that comply with internal security policies. Implement strict network segmentation and firewall rules to limit access from the bastion host to only the necessary target systems and ports.",
      "check": "Are all @SystemType:OT remote access points inventoried and managed centrally? Is strong MFA required for all remote connections? Are all remote sessions encrypted end-to-end? Are remote access points physically secured? Have default manufacturer credentials and settings been changed?",
      "asvs": "BSI IT-Grundschutz CON.1: Remote Access",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Remote_access_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies communication links from external entities to technical assets tagged as '@SystemType:OT-Asset'. It flags risks for specific vulnerabilities: physical insecurity of the target asset (tagged '@PhysicalSecurity:Insufficient'), use of unencrypted communication protocols, or weak authentication methods (like 'none' or just 'credentials').",
      "riskAssessment": "The impact is determined by the integrity and availability rating of the target @SystemType:OT asset, as these are paramount in an @SystemType:ICS environment. A breach of a 'mission-critical' asset has a 'very-high' impact. The likelihood is considered 'very-likely' for easily exploitable conditions like physical access or no encryption, and 'likely' for weak credential-based authentication.",
      "falsePositives": "A model might not capture all compensating controls, such as a separate, un-modeled firewall appliance that restricts access. The risk might be flagged even if the connection is only used in highly controlled, temporary maintenance windows.",
      "cwe": "288",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "43_sec8.ts",
      "bsiCode": "IND.3.2",
      "id": "insecure-@SystemType:OT-remote-maintenance-access-@SystemType:ICS-3-a5",
      "title": "Insecure @SystemType:OT Remote Maintenance Access (BSI @SystemType:ICS.3.A5)",
      "description": "Due to long lifecycles in industrial environments, @SystemType:OT remote maintenance solutions are often used for a decade or more and may have security vulnerabilities due to their age.",
      "impact": "If @SystemType:OT remote maintenance access points are not adequately secured, this facilitates unauthorized access to an Industrial Control System (@SystemType:ICS) and other networks and systems both inside and outside the @SystemType:OT environment.",
      "action": "Secure, Inventory, and Regularly Review @SystemType:OT Remote Maintenance Access",
      "mitigation": "Maintain a complete inventory of all remote maintenance access points for @SystemType:OT systems. Disable any unused or unknown access points immediately.",
      "check": "Is there a complete inventory of all @SystemType:OT remote maintenance accesses? Are all connections encrypted and do they use strong authentication?",
      "asvs": "BSI IT-Grundschutz @SystemType:ICS.3.A5: Insecure remote maintenance access",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ICS_3_Remote_maintenance_and_remote_access_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for technical assets tagged as `@SystemType:OT-system` that have insecure remote access.",
      "riskAssessment": "The impact is determined by the integrity and availability rating of the @SystemType:OT asset, as manipulation and denial of service are the primary threats. An asset with 'mission-critical' integrity or availability will result in a 'very-high' impact.",
      "falsePositives": "The model might not capture all compensating controls, such as an intermediate firewall or bastion host that secures the connection.",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "44_sec1.ts",
      "bsiCode": "INF.10",
      "id": "improper-handling-of-physical-environments",
      "title": "Improper Handling of Physical Environments (based on BSI Recommendations)",
      "description": "Based on BSI recommendations, a common vulnerability arises when employees fail to secure physical spaces after use.",
      "impact": "This can lead to the unauthorized disclosure of confidential information, violating data protection regulations and causing reputational or financial damage.",
      "action": "Establish, Communicate, and Enforce Clear-Desk and Clear-Room Policies.",
      "mitigation": "Define and communicate clear rules for securing physical work environments, especially shared spaces like meeting rooms. This includes policies for closing doors/windows, erasing whiteboards, and securing documents.",
      "check": "Are there established 'clear room' and 'clear desk' policies? Is this topic covered in security awareness training? Are physical security walkthroughs performed?",
      "asvs": "BSI IT-Grundschutz INF.1 General Building, particularly INF.1.A15 Use of Rooms for other Purposes and INF.1.A16 Order and Cleanliness.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This organizational risk is detected by identifying technical assets that are explicitly modeled as physical machines (`machine: physical`) or are located in shared physical spaces (e.g., tagged with `@Location:MeetingRoom`).",
      "riskAssessment": "The likelihood is considered 'Likely' by default, assuming a baseline lack of specific training or enforcement. The impact is derived from the highest confidentiality of the data assets processed or stored by the physical technical asset, or the confidentiality of the asset itself.",
      "falsePositives": "The model cannot verify the actual implementation of physical security policies or the effectiveness of employee training. This risk should be validated against the organization's real-world security practices.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "44_sec2.ts",
      "bsiCode": "INF.10",
      "id": "incompatible-hardware-interfaces-sys-1-7",
      "title": "Incompatible Hardware Interfaces (BSI SYS.1.7)",
      "description": "Mobile IT systems are increasingly used in diverse environments. A common issue is the inability to use these systems as planned due to physical incompatibility with foreign IT systems.",
      "impact": "The primary impact is a loss of availability, preventing users from performing their tasks. This can disrupt business processes significantly.",
      "action": "Ensure Hardware Compatibility for Mobile Assets",
      "mitigation": "Establish a standard for hardware interfaces on all corporate mobile devices.",
      "check": "Are mobile assets (like laptops) equipped with standard, modern interfaces? Is a standard adapter kit issued to users of mobile assets?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.1.7 Mobiler Arbeitsplatz (Mobile Workstation), specifically related to the general operational risks in varied environments.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_7_Mobile_workstation_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk applies to technical assets that are physically mobile and used in various environments.",
      "riskAssessment": "The likelihood is considered 'Likely' for any mobile asset, as encountering varied environments is inherent to its use.",
      "falsePositives": "A risk might be flagged for a mobile asset where the organization has already implemented robust mitigation measures (e.g., providing universal dongles to all employees).",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "44_sec3.ts",
      "bsiCode": "INF.10",
      "id": "improper-physical-cabling",
      "title": "Improper Physical Cabling in Shared-Use Rooms",
      "description": "In rooms with frequently changing use, such as meeting, event, or training rooms, the equipment setup and cabling are often modified.",
      "impact": "Physical damage to IT systems caused by tripping over insecure cables can lead to a direct loss of availability for those systems (e.g., laptops, projectors, network devices).",
      "action": "Ensure Secure and Orderly Cabling Practices",
      "mitigation": "In all shared-use rooms, ensure that power and data outlets are conveniently located to minimize the need for long cable runs.",
      "check": "Perform physical inspections of meeting, event, and training rooms. Are there loose cables creating tripping hazards on the floor?",
      "asvs": "BSI IT-Grundschutz: INF.6 Cabling (specifically INF.6.A4 Orderly cabling) and INF.5 Room and Cabinet.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_Edition2023/bausteine/INF/INF_6_Cabling_Edition_2023.pdf?__blob=publicationFile (BSI INF.6)",
      "detectionLogic": "This risk is identified for technical assets located within trust boundaries tagged as shared-use spaces (e.g., '@Location:MeetingRoom').",
      "riskAssessment": "The likelihood is considered 'Likely' for any client-type device in a designated shared-use room, as these environments inherently have changing setups.",
      "falsePositives": "This risk might be flagged for a device that is permanently and securely installed within a shared-use room (e.g., a rack-mounted switch in a closet).",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "44_sec4.ts",
      "bsiCode": "INF.10",
      "id": "theft-of-it-equipment-in-meeting-rooms",
      "title": "Theft of IT Equipment from Meeting/Event Rooms (BSI INF.5.G1)",
      "description": "If data carriers, IT systems, accessories, software, or data that are sometimes permanently installed in a meeting, event, or training room are stolen,",
      "impact": "The theft of equipment leads to direct financial costs for replacement and restoration. It causes a loss of availability for the room and the associated business functions.",
      "action": "Implement Physical Security Measures for Assets in Shared/Public Spaces",
      "mitigation": "Physically secure all IT assets in meeting, event, or training rooms. For mobile devices like laptops, use Kensington locks or secure storage cabinets.",
      "check": "Are there policies and procedures for the physical security of assets in common areas like meeting rooms? Are devices like laptops required to be secured when left unattended?",
      "asvs": "BSI IT-Grundschutz Kompendium 2023: INF.5 Raum und Schrank (Room and Cabinet)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_and_cabinet_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any technical assets marked with a tag indicating they are located in a shared physical space like a meeting room (`@Physical@Location:MeetingRoom`).",
      "riskAssessment": "The likelihood is considered 'Likely' due to the opportunistic nature of physical theft in accessible areas. The impact is calculated based on the highest CIA requirement",
      "falsePositives": "This risk can be considered a false positive if the specific location tagged has exceptionally strong, enforced, and audited physical security controls that are captured in the model.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "44_sec5.ts",
      "bsiCode": "INF.10",
      "id": "unauthorized-disclosure-of-confidential-information",
      "title": "Unauthorized Disclosure of Confidential Information (based on BSI G 2.4)",
      "description": "Confidential information can be disclosed through technical failures, carelessness, ignorance, or intentional malicious acts. This information may reside on various media, such as internal storage within IT systems (e.g., hard drives), removable storage media (e.g., USB drives), or during transmission over a network. If information is read or disclosed without authorization, it can have serious consequences for the organization.",
      "impact": "Unauthorized disclosure of information can lead to severe consequences, such as violations of laws (e.g., @DataType:PII), competitive disadvantages, loss of customer trust, and direct financial losses.",
      "action": "Enforce Data-at-Rest and Data-in-Transit Encryption for Sensitive Data",
      "mitigation": "For data at rest, ensure that all technical assets storing `confidential` or `strictly-confidential` data use strong, modern encryption. This can be achieved through transparent disk/file system encryption, database-level encryption, or application-level encryption. The asset's `encryption` property in the model should be set accordingly (e.g., to `transparent` or a data-level encryption style). For data in transit, all communication links carrying such data must use strong, authenticated, and encrypted protocols like TLS 1.2+ (e.g., HTTPS, WSS, LDAPS, JDBC-encrypted).",
      "check": "Review asset configurations to verify that `encryption` is enabled for stored sensitive data. Analyze communication links in the model to ensure protocols are encrypted (e.g., `https`, `ldaps`) when transferring sensitive data. Penetration tests and network traffic analysis can confirm these controls in the running system.",
      "asvs": "OWASP ASVS V4.0.3: V4.1 (Data Classification), V4.2 (Data Protection)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html, https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers risks for two primary conditions: 1. A technical asset (especially a `datastore`) stores `confidential` or `strictly-confidential` data but has its `encryption` property set to `none`. 2. A communication link transfers `confidential` or `strictly-confidential` data but uses an unencrypted protocol.",
      "riskAssessment": "The impact is directly tied to the confidentiality level of the data involved (`High` for confidential, `Very High` for strictly confidential). The likelihood is considered `Very Likely` if sensitive data is handled without any encryption, as this represents a direct and exploitable weakness. The overall severity is calculated from these factors.",
      "falsePositives": "A risk might be flagged if encryption is handled by an underlying platform or hardware layer explicitly modeled (e.g., an encrypted file system on the host VM). In such cases, the asset's `encryption` property in the model should be updated to `transparent` to reflect this control and resolve the finding.",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "45_sec1.ts",
      "bsiCode": "INF.11",
      "id": "bsi-unregulated-vehicle-comms",
      "title": "Disclosure of Confidential Information via Unregulated In-Vehicle Networks (BSI 2.1)",
      "description": "If it is not regulated, or only inadequately regulated, which information may be transmitted and processed via networks provided by vehicles for users (e.g., @Network:WLAN or Bluetooth) and which protective measures must be taken, confidential information may be disclosed. If rules for securing and using these networks are insufficient, sensitive information such as personal data could be exposed.",
      "impact": "Unauthorized disclosure of confidential or personal data transmitted over in-vehicle networks, leading to privacy violations, compliance failures, reputational damage, and potential financial loss.",
      "action": "Define and Enforce Secure Configuration Policies for In-Vehicle Networks",
      "mitigation": "Establish clear policies for all in-vehicle communication interfaces (@Network:WLAN, Bluetooth, etc.). Policies must specify the types of data permitted for transmission, require strong authentication and encryption (e.g., WPA3 for Wi-Fi, secure pairing for Bluetooth), and mandate secure default configurations. These policies must be enforced and regularly audited. Communication links in the model should use encrypted protocols.",
      "check": "Are there documented policies for in-vehicle network usage? Do all modeled communication links from the vehicle asset use encrypted protocols? Is authentication required for connections?",
      "asvs": "BSI IT-Grundschutz Kompendium 2023, Baustein INF.11: Allgemeines Fahrzeug",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP/APP_6_Vehicles_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Triggered for any 'IoT Device' technical asset (representing a vehicle) that has at least one outgoing communication link where: (1) the protocol is unencrypted (isProtocolEncrypted(link.protocol) === false) and vpn === false; and (2) the highest confidentiality of the transmitted data is 'Restricted' or higher.",
      "riskAssessment": "Impact depends directly on the confidentiality of data transmitted from the vehicle asset. Likelihood is 'Likely' or 'Very Likely' if unencrypted communication protocols are used for sensitive data. If strong encryption is used on all relevant links, the risk is mitigated.",
      "falsePositives": "This risk may be a false positive if the 'IoT Device' is not a vehicle or if the transmitted data is misclassified in the model. A link might be tunneled over a VPN, which should be modeled explicitly.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "46_sec1.ts",
      "bsiCode": "INF.12",
      "id": "cable-fire-bsi-inf-1",
      "title": "Cable Fire (BSI INF.1)",
      "description": "Cable fires can cause significant damage to an information system. A fire can cause short circuits, interrupt conductors, lead to the failure of protective equipment, and release aggressive, corrosive gases from insulation materials, causing long-term damage to electronic components.",
      "impact": "The primary impact is a loss of availability for all affected physical assets and the communication links they depend on, potentially leading to a complete service outage. Secondary impacts include loss of integrity due to data corruption from short circuits or abrupt power failures, and potential loss of confidentiality if physical or logical security controls (e.g., firewalls, access systems) fail as a consequence.",
      "action": "Implement physical and environmental controls for fire protection",
      "mitigation": "Ensure proper fire prevention measures are in place, such as using fire-retardant cabling (e.g., plenum-rated), maintaining proper cable management to avoid overheating, and performing regular inspections of electrical systems. Implement and regularly test fire detection (e.g., smoke/heat detectors) and suppression systems (e.g., inert gas suppression in server rooms). Ensure physical separation of redundant systems and cable routes to minimize the impact of a localized fire.",
      "check": "Are fire detection and suppression systems installed and regularly tested? Is fire-retardant cabling used in critical areas? Are redundant systems and their cabling physically separated? Is there a documented fire safety and evacuation plan?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.1 (General building) Requirement INF.1.A17 (Fire prevention and protection in buildings).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all in-scope technical assets of the 'physical' machine type located within an 'on-premise' network trust boundary. These assets are susceptible to physical threats like fire, which are visible in a logical threat model.",
      "riskAssessment": "The impact is directly related to the availability and integrity criticality of the affected physical asset. A fire damaging a 'Mission-Critical' system has a 'Very-High' impact. The likelihood is set to 'Unlikely' by default, as major fires are not a daily occurrence, but this should be re-evaluated based on the specific physical environment and preventive measures in place.",
      "falsePositives": "This risk can be considered a false positive or mitigated if the physical location has certified, regularly maintained fire detection and suppression systems, and if appropriate fire-retardant infrastructure is verifiably in place. The model typically lacks insight into these specific physical controls.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "46_sec10.ts",
      "bsiCode": "INF.12",
      "id": "wiretapping-or-cable-manipulation",
      "title": "Wiretapping or Physical Manipulation of Data Cables (BSI INF.5)",
      "description": "Eavesdropping on data cables is a significant threat to information security. No cable is completely immune to tapping;",
      "impact": "Successful eavesdropping attacks compromise the confidentiality of all data transmitted over the affected line.",
      "action": "Use End-to-End Encryption and Ensure Physical Security of Cabling",
      "mitigation": "The most effective technical countermeasure is the consistent use of strong, end-to-end encryption protocols (e.g., TLS, IPsec/VPN) for all data transmission.",
      "check": "Is the communication protocol encrypted? Is the data transmitted over the link sensitive? Are the physical pathways for the cabling secured against unauthorized access?",
      "asvs": "BSI IT-Grundschutz Kompendium: INF.5 Verkabelung (Cabling), Threats INF.5.G5 Abhören der Kommunikationsverbindungen (Eavesdropping) and INF.5.G6 Manipulation oder Zerstörung der Kommunikationsverbindungen (Manipulation/Destruction).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Cabling_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks all communication links that are process-local. It triggers a risk for any link that uses an unencrypted protocol.",
      "riskAssessment": "The likelihood of a physical attack is considered higher for links crossing trust boundaries. The impact is calculated based on the highest Confidentiality,",
      "falsePositives": "This risk might be a false positive if the physical path of the cable is demonstrably secure (e.g., within a guarded data center),",
      "cwe": "311",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "46_sec2.ts",
      "bsiCode": "INF.12",
      "id": "inadequate-physical-capacity-planning",
      "title": "Inadequate Capacity Planning for Physical Infrastructure",
      "description": "When data centers, server rooms, or other physical hosting environments are planned, the designs are often based exclusively on current needs.",
      "impact": "If the physical infrastructure cannot support required growth, it can be impossible to deploy new systems or scale existing ones, directly impacting service availability.",
      "action": "Incorporate Scalability and Future Growth into Physical Infrastructure Planning",
      "mitigation": "During the planning and build-out of physical locations like data centers, explicitly plan for future growth.",
      "check": "Is there documentation for the power, network, and cooling capacity of the physical site? Was future growth a specified requirement during its design? Are there established procedures for capacity monitoring and review?",
      "asvs": "BSI IT-Grundschutz: INF.1 Allgemeines Gebäude (General Building)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers for physical, on-premise, or dedicated-hoster network trust boundaries that are not explicitly tagged as being designed for growth.",
      "riskAssessment": "The impact is determined by the highest availability requirement of the technical assets located within the boundary; if mission-critical systems cannot be scaled, the impact is very high.",
      "falsePositives": "This risk may be a false positive if a physical location is implicitly scalable even without being tagged, or if it hosts legacy systems with no foreseeable growth. Manual verification of the site's physical planning is required to confirm.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "46_sec3.ts",
      "bsiCode": "INF.12",
      "id": "improper-cabling-documentation-inf5",
      "title": "Improper Documentation of Physical Cabling (BSI INF.5)",
      "description": "If the exact location of physical network cables is unknown due to insufficient documentation, these cables can be accidentally damaged during construction, relocation, or maintenance work.",
      "impact": "Accidental damage to undocumented physical cabling can lead to a Denial of Service (DoS) for all systems and applications that rely on the affected network connection, potentially causing major business disruptions.",
      "action": "Establish and Maintain Comprehensive Cabling Documentation",
      "mitigation": "Create and maintain a detailed, accurate, and up-to-date documentation of all physical network cabling, including precise cable runs, patch panels, outlets, and connection points.",
      "check": "Is there a complete and current cabling plan for all physical network infrastructure? Are all physical cables and connection points clearly labeled?",
      "asvs": "BSI IT-Grundschutz Baustein INF.5 Verkabelung, Anforderung INF.5.A10 Dokumentation der passiven Netzkomponenten.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Cabling_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for communication links that likely represent physical, on-premise cabling but are not explicitly marked as documented.",
      "riskAssessment": "The likelihood of accidental damage is higher in environments undergoing frequent physical changes (e.g., construction, office reorganization, hardware changes).",
      "falsePositives": "This risk may be a false positive if comprehensive cabling documentation exists but this fact is not captured via a tag in the threat model.",
      "cwe": "730",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "46_sec4.ts",
      "bsiCode": "INF.12",
      "id": "unsecured-network-or-power-distributors",
      "title": "Unsecured Network or Power Distributors in Accessible Areas",
      "description": "Occasionally, power supply or data network distributors are installed without locks in generally accessible areas.",
      "impact": "Physical tampering with unsecured distributors can cause a Denial of Service, interrupting critical business processes that rely on the affected network or power infrastructure.",
      "action": "Secure Physical Infrastructure Components",
      "mitigation": "Ensure that all power and data network distributors (e.g., patch panels, server racks, fuse boxes) located in accessible or semi-public areas are installed in lockable cabinets or rooms.",
      "check": "Are all physical network and power distribution points in accessible areas secured against unauthorized access?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Physical and Environmental Security), Requirement INF.5.A10 (Protection of the technical infrastructure).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Physical_and_environmental_security_edition_2023.pdf?__blob=publicationFile (BSI INF.5)",
      "detectionLogic": "This risk is triggered for in-scope physical assets (`machine: physical`) that are tagged with `@PhysicalSecurity:Insufficient`.",
      "riskAssessment": "The impact is determined by the availability requirements of the physical asset and the data it processes or stores. A physical server hosting mission-critical applications poses a very high impact if taken offline.",
      "falsePositives": "This risk may be a false positive if compensating controls exist that are n@SystemType:OT modeled, such as constant surveillance of the area or if the 'accessible area' is still within a broader secure perimeter.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "46_sec5.ts",
      "bsiCode": "INF.12",
      "id": "unprotected-cables",
      "title": "Risk of Damaged Unprotected Cables",
      "description": "If a cable is routed in an unprotected manner, the risk of it being damaged, either intentionally or unintentionally, increases.",
      "impact": "Damage to physical cables can lead to a Denial of Service (DoS) by interrupting network connectivity between critical systems.",
      "action": "Ensure Secure Cable Routing and Physical Protection",
      "mitigation": "Cables should be routed through physically secure areas (e.g., locked server rooms, protected cable ducts, raised floors).",
      "check": "Are network cables for critical systems physically protected along their entire length? Is access to server rooms and wiring closets controlled? Are there regular physical inspections of the infrastructure?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Cabling), which details requirements for secure physical network infrastructure.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Bausteine/INF/INF_5_Verkabelung_Edition_2023.html",
      "detectionLogic": "This risk is generated for communication links between two technical assets that are both marked as `physical` machines and reside within the same on-premise trust boundary (`network-on-prem` or `network-dedicated-hoster`).",
      "riskAssessment": "The likelihood is considered 'Likely' for any unprotected physical connection, as both accidents and malicious acts are common threats in unsecured environments.",
      "falsePositives": "The model assumes a standard level of physical risk for on-premise connections.",
      "cwe": "732",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "46_sec6.ts",
      "bsiCode": "INF.12",
      "id": "power-supply-fluctuation-inf2.4",
      "title": "Power Supply Fluctuations (BSI INF.12 2.6)",
      "description": "Fluctuations in the supply voltage, such as surges, sags, or brownouts, can occur in all areas of electrical networks.",
      "impact": "If IT systems are affected by power supply fluctuations, their Availability is directly threatened, leading to service interruptions and potential hardware failure.",
      "action": "Implement power conditioning and @Backup:Target",
      "mitigation": "Protect sensitive and critical IT systems with an Uninterruptible Power Supply (UPS) to provide short-term @Backup:Target power and protect against voltage fluctuations.",
      "check": "Are critical servers and network components connected to a UPS? Is the capacity of the UPS sufficient for the connected load?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.12 (Cabling) section 2.6 (Voltage fluctuations, overvoltage, undervoltage) and requirements INF.12.A4 (EMC-compliant power supply) and INF.12.A7 (Surge protection).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Data_Centre_edition_2023.pdf?__blob=publicationFile (BSI INF.12)",
      "detectionLogic": "This risk applies to all in-scope technical assets running on physical or virtual machines, as they rely on a stable power supply.",
      "riskAssessment": "The impact is determined by the availability and integrity requirements of the affected asset. An asset with 'Mission-Critical' availability has a very high impact.",
      "falsePositives": "This risk may be a false positive if an asset is located in a data center with certified high-availability power infrastructure that is explicitly modeled with a tag,",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "46_sec7.ts",
      "bsiCode": "INF.12",
      "id": "improper-use-of-power-strips-inf5",
      "title": "Improper Use of Power Strips (BSI INF.12)",
      "description": "The use of low-quality power strips or chaining multiple strips together ('daisy-chaining') is a common but dangerous practice.",
      "impact": "A fire caused by faulty power strips can lead to catastrophic data loss, destruction of hardware, and prolonged service unavailability.",
      "action": "Ensure Proper Power Distribution and Cabling",
      "mitigation": "Only use high-quality, certified (e.g., CE, VDE) power strips adequate for the required load. Strictly prohibit the practice of chaining power strips ('daisy-chaining').",
      "check": "Are power strips daisy-chained anywhere in the facility? Are the power strips in use certified and of high quality?",
      "asvs": "N/A (physical security risk). See BSI IT-Grundschutz INF.12: Cabling.",
      "cheatSheet": "BSI IT-Grundschutz: INF.12 Cabling (Verkabelung)",
      "detectionLogic": "This is a physical, operational risk. It cannot be detected by analyzing a logical model alone.",
      "riskAssessment": "The impact is directly derived from the **Availability** and **Integrity** rating of the physical asset. A physical machine hosting mission-critical services will suffer a much higher impact from a fire.",
      "falsePositives": "This risk can be considered a false positive if the organization can demonstrate that strict power management and cabling policies are enforced, including the exclusive use of high-quality hardware and regular inspections.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "46_sec8.ts",
      "bsiCode": "INF.12",
      "id": "impermissible-network-connection",
      "title": "Impermissible Cable or Network Connection (BSI G 0.23)",
      "description": "In some cases, physical cable connections or network links are established between IT systems or other technical components that are not intended and are impermissible, bypassing security controls.",
      "impact": "Such impermissible connections can allow unauthorized access to data networks, IT systems, information, or applications, bypassing intended security checkpoints like WAFs or API Gateways.",
      "action": "Enforce Architectural Network Segmentation and Access Control",
      "mitigation": "Ensure that high-value assets or backend services are not directly accessible from components that are not designated as trusted intermediaries (e.g., API Gateways, WAFs, Application Servers).",
      "check": "Review network diagrams and firewall/network-policy configurations. Do any communication links bypass established security controls like API Gateways or WAFs to directly access backend databases or services?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.5 Network architecture and design, particularly Requirement A.12 Network segmentation.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Network_architecture_and_design_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified when a communication link directly connects to a sensitive backend asset (like a database, web service, or mainframe) from a source that is not a recognized intermediary or security control (like a WAF, Reverse Proxy, or Gateway).",
      "riskAssessment": "The likelihood of exploitation is higher if the source asset of the impermissible connection is exposed to less trusted zones (e.g., the internet or a client network).",
      "falsePositives": "Legitimate 'back-channel' or administrative connections might be flagged. For example, a batch-processing component might need direct database access, which can be allowed by policy.",
      "cwe": "424",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "46_sec9.ts",
      "bsiCode": "INF.12",
      "id": "crosstalk-on-communication-lines-inf5",
      "title": "Crosstalk on Communication Lines (BSI INF.12 – Leitungsbeeinträchtigungen/Übersprechen)",
      "description": "Electrical signal transmission in communication cables can be negatively influenced by electric and magnetic fields.",
      "impact": "Crosstalk can corrupt or alter data in transit, leading to a loss of Integrity. In severe cases, it can disrupt communication entirely, causing a Denial of Service (Availability).",
      "action": "Use Shielded/Fiber Cabling and Proper Separation",
      "mitigation": "Use high-quality, shielded cabling (e.g., S/FTP Cat. 6a or higher) appropriate for the data rate and environment.",
      "check": "Are communication links using shielded twisted-pair (STP/FTP) or fiber optic cables? Is the cabling category sufficient for the required bandwidth? Are data cables physically separated from power cables and documented in the model via `cabling:shielded` or `cabling:fiber-optic`?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.12 (Verkabelung), esp. 2.9 Leitungsbeeinträchtigungen (Übersprechen) and requirements INF.12.A1, INF.12.A2, INF.12.A9.",
      "cheatSheet": "BSI IT-Grundschutz Kompendium – Baustein INF.12 Verkabelung (Edition 2023)",
      "detectionLogic": "This risk is raised for network communication links that are not process-local and that are not explicitly tagged as using shielded or fiber-optic cabling.",
      "riskAssessment": "The likelihood is considered 'Likely' for copper-based network cabling in typical office or datacenter environments due to cable proximity and EMI sources.",
      "falsePositives": "This risk may be a false positive if appropriate cabling (e.g., fiber optic, shielded copper) is already in use but not documented in the model.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "47_sec1.ts",
      "bsiCode": "INF.13",
      "id": "inf13-unclear-or-missing-requirements",
      "title": "Unclear or Missing TGM Requirements During Planning (BSI INF.13 §2.1)",
      "description": "If stakeholders, user groups, or “demand organizations” are not clearly defined during planning and development, their concrete objectives and needs remain unknown. As a result, the system may be implemented without the necessary operational and security requirements, causing mismatches between what is needed and what is built.",
      "impact": "A system built on unclear requirements can miss business goals and contain security gaps. Missing specifications for roles, data handling, or compliance can lead to weak authorization, logging, validation, and monitoring—affecting Confidentiality, Integrity, and Availability. Consequences include data breaches, misuse, downtime, costs, and possible regulatory penalties.",
      "action": "Identify demand organizations early and document measurable requirements",
      "mitigation": "Identify and involve all relevant stakeholder groups (e.g., building operations, tenants, safety/security, legal/compliance, IT/OT). Elicit and validate functional, non-functional, and security requirements; capture interfaces to TGA/GA systems; and maintain living documentation. Use user stories, abuse/misuse cases, and acceptance criteria. Review and baseline requirements before implementation and for every change.",
      "check": "Are all demand and operating organizations named with contacts? Is there a baselined, accessible, and up-to-date requirements set (including security and operational needs)? Are interfaces and responsibilities documented? Is there a change process for requirements?",
      "asvs": "V1.1: Maintain a security requirements list derived from business needs.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html",
      "detectionLogic": "Raise a finding for entry-point technical assets (internet-facing, web applications, or web services that are not development tooling) that have no incoming communication from an External Entity. The absence of any modeled external actor suggests stakeholder interactions and requirements were not captured or validated for this entry point.",
      "riskAssessment": "Likelihood is high when a primary entry point lacks modeled users/stakeholders. Impact scales with the asset’s CIA ratings: the more critical the asset, the more severe building the wrong behavior becomes.",
      "falsePositives": "Possible if the model is incomplete while the real-world requirements process was thorough, or if the asset is a backend without direct stakeholder interaction. Validate by reviewing planning documents, stakeholder registers, and agreed requirements baselines.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "47_sec2.ts",
      "bsiCode": "INF.13",
      "id": "incomplete-external-service-documentation",
      "title": "Incomplete Documentation for External Services (BSI TGM-style)",
      "description": "In complex systems, many external service providers are involved. If the documentation of responsibilities, contact persons, and Service Level Agreements (SLAs) is incomplete or inaccessible, it can lead to avoidable delays during incidents, such as when a critical system fails.",
      "impact": "Failure to properly document external service details can severely impact availability by delaying incident response. It can also lead to non-compliance with legal or contractual requirements and compromise system integrity if uncertified or vulnerable services are used. In critical infrastructure scenarios, this could even pose a risk to safety.",
      "action": "Establish and Maintain Comprehensive Documentation for Third-Party Services and Certifications.",
      "mitigation": "Maintain a central, accessible repository of all external service providers. For each provider, document emergency contact details, escalation procedures, and agreed-upon SLAs.",
      "check": "Is there a central repository for service provider contracts and SLAs? Are emergency contacts and escalation procedures documented and accessible to the incident response team? Is there a system to track certification validity and renewal dates for all external services?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein ORP.2 (Supplier relationships), which covers requirements for monitoring, controlling, and reviewing services from suppliers.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Supplier_relationships_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organizational risk is triggered for any technical asset of type 'external-entity'. The model cannot verify offline documentation processes.",
      "riskAssessment": "The impact is determined by the highest CIA requirement of the external service itself or any assets it communicates with. If a mission-critical system depends on an external service with poor documentation, the impact of a failure is very high. The likelihood is considered 'likely' by default unless there is explicit confirmation (via tags) that documentation processes are in place.",
      "falsePositives": "This risk can be a false positive if the organization has excellent, well-maintained documentation for all its service providers, but this has not been reflected in the model using the mitigation tags. The risk serves as a prompt to verify these external processes.",
      "cwe": "1059",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "47_sec3.ts",
      "bsiCode": "INF.13",
      "id": "compromise-of-physical-safety-interfaces",
      "title": "Compromise of Interfaces to Cyber-Physical Safety Systems",
      "description": "Technical Building Management (TGM) systems often provide interfaces to areas requiring special protection, such as Safety Instrumented Systems (SIS), security services, or fire alarm systems. If these interfaces are compromised—whether deliberately or unintentionally—it can lead to legal violations and pose a direct danger to life and limb.",
      "impact": "A compromise of these critical interfaces can have severe physical consequences. For example, disabling a fire alarm",
      "action": "Secure Communication Channels to Cyber-Physical Systems",
      "mitigation": "Communication links to cyber-physical systems must be robustly secured. This includes using strongly",
      "check": "Are communication links to assets tagged as '@Category:Cyber-Physical-System' using an encrypted protocol?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.3.2 Building automation and control systems (formerly CON.6).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_3_2_Building_automation_and_control_systems_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies communication links from any standard technical asset to a specialized asset tagged as a",
      "riskAssessment": "The impact of compromising a physical safety system is always considered 'Very High' due to the potential for physical harm to personnel.",
      "falsePositives": "A risk might be flagged if compensating controls exist that are not modeled, such as a physically isolated and secured",
      "cwe": "345",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "47_sec4.ts",
      "bsiCode": "INF.13",
      "id": "inadequate-monitoring-of-critical-systems",
      "title": "Inadequate Monitoring of Critical Systems (BSI INF.13 · OPS.1.1.5)",
      "description": "If critical systems (e.g., Technical Building Automation, TGA) are not adequately monitored, security-relevant events such as malfunctions or attacks may go undetected or be detected too late. Minor issues can escalate into major incidents impacting operations and safety.",
      "impact": "Undetected failures can cause prolonged downtime, physical damage to infrastructure, or even threats to life and limb. This primarily impacts Availability and Integrity. Example: an unnoticed heating failure during sub-zero temperatures can cause severe secondary damage.",
      "action": "Establish comprehensive monitoring and automated alerting for all critical TGA/OT systems",
      "mitigation": "Continuously monitor failures, anomalies, and security events via a central monitoring solution. Implement automated alerting to the on-call/operations team, define thresholds and escalation paths, and regularly test both monitoring coverage and alert delivery.",
      "check": "Are all assets identified as critical systems (e.g., IoT devices, TGA systems) sending monitoring data to a dedicated 'Monitoring' asset in the model? Is there a defined and tested alerting process?",
      "asvs": "BSI IT-Grundschutz / Bausteine INF.13 (TGM) & OPS.1.1.5 (Monitoring und Logging)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Logging_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule flags technical assets that are critical physical/control systems (technology = IoTDevice or explicitly tagged with '@tga') which lack any modeled communication link to an asset of technology 'Monitoring'. Missing such a link indicates a potential monitoring/alerting gap.",
      "riskAssessment": "Likelihood is high when no monitoring connection is modeled. Impact is derived from the asset’s Availability/Integrity ratings: Important → Medium, Critical → High, Mission-Critical → Very High.",
      "falsePositives": "The threat model may be incomplete: a monitoring system and data flows might exist in reality but are not documented. Validate with operations/TGM owners before remediation.",
      "cwe": "755",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "47_sec5.ts",
      "bsiCode": "INF.13",
      "id": "inadequate-dedicated-iam-for-segregated-environment",
      "title": "Weak Dedicated IAM in Segregated TGM Environment",
      "description": "If parts of a building’s technical environment (TGM/TGA/GA) are operated in a segregated zone with a separate Identity & Access Management (IAM), weaknesses in that dedicated IAM (e.g., shared accounts, missing MFA, slow JML handling) can open a single fault path to the entire zone. This aligns with BSI INF.13 (Technisches Gebäudemanagement) and ORP.4 (Identitäts- und Berechtigungsmanagement).",
      "impact": "Compromise of the dedicated IAM enables broad unauthorized access to TGM/TGA assets, endangering confidentiality (e.g., plans/BIM), integrity (control parameters), and availability (building functions: HVAC, alarms). Impacts can cascade to safety-relevant systems and legal obligations.",
      "action": "Harden and govern the dedicated IAM: unique identities only, MFA, automate Joiner–Mover–Leaver, periodic access reviews, and SoD for privileged operations.",
      "mitigation": "Disallow shared/service account reuse; enforce MFA for admins and high-impact operations; implement robust, automated JML workflows with immediate de-provisioning; schedule quarterly access reviews; integrate IAM logs with SIEM; use PAM for privileged access; maintain break-glass accounts with strict controls and monitoring; continuously reconcile identities with sources of truth.",
      "check": "Is a separate IAM used for the segregated TGM boundary? Are unique identities and MFA enforced? Is JML automated with timely revocation? Are periodic (e.g., quarterly) access reviews documented? Are shared accounts technically blocked and PAM enforced for admins? Is emergency access ('break-glass') controlled and logged?",
      "asvs": "OWASP ASVS V2 (Authentication), V4 (Access Control)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
      "detectionLogic": "Detect trust boundaries tagged with '@IAM:dedicated' and look for identity-related technical assets inside (e.g., IdentityProvider, LDAP/LDAPS directories). For each such IAM asset within the tagged boundary, raise one risk. Increase concern where the boundary also hosts high-criticality assets or safety-adjacent integrations; the rule inherently flags because dedicated IAMs demand strong governance and are frequent failure points.",
      "riskAssessment": "Likelihood defaults to 'Likely' due to operational fragility of separate IAMs without automation and periodic reviews. Impact is derived from the highest CIA ratings of assets inside the tagged boundary; safety-adjacent or mission-critical functions elevate impact to 'Very High'. MFA, PAM, automated JML, and audited access reviews can justify downgrading likelihood during expert assessment.",
      "falsePositives": "Lower risk where the dedicated IAM enforces unique accounts and MFA, uses PAM, automates JML with immediate revocation, performs periodic reconciliations and access reviews, integrates with SIEM, and applies SoD. In such mature setups, the finding may be informational.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "48_sec1.ts",
      "bsiCode": "INF.14",
      "id": "inadequate-planning-of-building-automation-inf4-g1",
      "title": "Inadequate Planning of Building Automation (BSI INF.14 – Unzureichende Planung der GA)",
      "description": "Building automation (GA) systems coordinate and control technical building equipment (TGA). According to BSI, deficient planning of these systems, such as inadequate redundancy for central controllers, can lead to failures with significant consequences. The complexity of integrating heterogeneous systems (e.g., HVAC, access control, fire alarms) and multiple service providers exacerbates this risk.",
      "impact": "A failure resulting from poor planning can cause a denial of service to critical building functions, leading to property damage (e.g., from failed climate control), financial loss, disruption of business operations, and even physical harm to individuals (e.g., being trapped by a failed access control system). This directly impacts the availability of the controlled systems and the physical environment.",
      "action": "Ensure Comprehensive and Resilient Planning for Building Automation Systems",
      "mitigation": "The planning of Building Automation (GA) systems must be thorough, involving IT security, facility management, and other stakeholders. A key aspect is implementing redundancy for all critical components to prevent single points of failure. The model should reflect this by setting the 'redundant' flag to true for such assets. The design must also define safe fail-states for all controlled equipment. The network architecture for the GA should be robust and strictly segmented from other corporate IT networks.",
      "check": "Is there a detailed planning and architecture document for the building automation system? Does it include a redundancy concept for critical components (e.g., controllers)? Is the corresponding technical asset in the model marked as 'redundant'?",
      "asvs": "BSI IT-Grundschutz Baustein INF.14: Gebäudeautomation, Gefährdung: Unzureichende Planung der GA.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_4_Gebaeudeautomation_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset identified as a building automation controller (via the `@AssetType:BuildingAutomationController` tag) that is not marked as redundant (`redundant: false`). The absence of planned redundancy for such a central control component is a direct indicator of this risk.",
      "riskAssessment": "The impact is derived directly from the 'availability' rating of the non-redundant building automation asset. A system with 'mission-critical' availability will result in a 'very-high' impact risk. The likelihood is considered 'likely' because a non-redundant system is, by definition, susceptible to failure from a single fault over its operational lifetime.",
      "falsePositives": "A risk might be a false positive if the asset is not critical and its temporary failure is acceptable. This should be reflected by a low availability rating (e.g., 'archive' or 'operational'), which the risk logic already considers to lower the impact. It might also be a false positive if redundancy is achieved through external means not captured in the model.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "48_sec2.ts",
      "bsiCode": "INF.14",
      "id": "improper-subsystem-integration-in-building-automation",
      "title": "Improper Integration of Subsystems in Building Automation (BSI IND.2.2)",
      "description": "If a subsystem (e.g., access control, climate sensor, HVAC unit) is incorrectly or insufficiently integrated into the central building automation system, the functionality of the entire system can be compromised.",
      "impact": "An operational failure in building automation can have direct physical consequences. This includes failures in controlling heating, ventilation, lighting, or physical access systems.",
      "action": "Ensure robust integration, communication protocols, and error handling",
      "mitigation": "Use standardized, robust, and resilient communication protocols (e.g., BACnet/SC, OPC UA) for subsystem integration.",
      "check": "Are the communication protocols between the central controller and its subsystems documented and standardized? Is there monitoring and alerting for communication failures? How does the system behave if a subsystem becomes unavailable? Is data from subsystems validated before being acted upon?",
      "asvs": "BSI IT-Grundschutz Baustein IND.2.2: Gebäudeautomation",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/IND/IND_2_2_Gebaedeautomation_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for technical assets acting as central controllers (e.g., tagged with '@AssetType:BuildingAutomationController' or of technology type 'Gateway' or 'IoT-Device') that communicate with other subsystems.",
      "riskAssessment": "The likelihood of exploitation depends on the resilience of the integration. It is considered higher for proprietary or unauthenticated protocols.",
      "falsePositives": "The model cannot fully assess the resilience or specific error-handling capabilities of the implemented communication logic. A connection might be flagged as risky, but the application layer could have robust checks. This requires a manual review of the system's design and operational monitoring data.",
      "cwe": "755",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "48_sec3.ts",
      "bsiCode": "INF.14",
      "id": "outdated-or-unsupported-components",
      "title": "Use of Outdated or Unsupported Components",
      "description": "Many systems, especially in specialized environments like Building Automation (GA/TGA), use components (hardware or software) that are no longer supported by the manufacturer. This can be due to age, a lack of vendor patches, or inherent design limitations (e.g., insecure protocols due to limited computing resources). These components often have known, unpatched vulnerabilities, representing a significant security risk.",
      "impact": "Exploiting vulnerabilities in unsupported components can lead to a full compromise of the asset. This may result in unauthorized data access, manipulation of system functions (e.g., tampering with building controls), or using the compromised asset as a pivot point for further attacks within the network. This directly threatens the confidentiality, integrity, and availability of the system and the data it handles.",
      "action": "Implement a Vulnerability and Lifecycle Management Process",
      "mitigation": "Maintain a complete inventory of all hardware and software components, including version and support status (i.e., a Software/Hardware Bill of Materials). Proactively monitor for new vulnerabilities in these components. Apply security patches in a timely manner. For components that are End-of-Life (@Maintenance:Unmaintained) or no longer supported, devise a replacement plan. If immediate replacement is not feasible, apply compensating controls such as network segmentation, strict access control, virtual patching with a WAF/IPS, and enhanced monitoring.",
      "check": "Is there a complete inventory of components (SBOM/HBOM)? Is there a vulnerability monitoring and management process? Are End-of-Life components identified and subject to risk management (replacement or compensating controls)?",
      "asvs": "OWASP Top 10 A06:2021 - Vulnerable and Outdated Components",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any technical asset explicitly tagged as `@Unsupported-Component`. It is also raised for assets of type `IoT device` that use unencrypted communication protocols over a network, as this strongly indicates an outdated or insecure design.",
      "riskAssessment": "The likelihood is rated high for any component known to be unsupported, as vulnerabilities are often publicly known and unpatched. The impact is derived from the Confidentiality, Integrity, and Availability ratings of the technical asset and the data it processes or stores. Internet-facing unsupported components present a critical risk.",
      "falsePositives": "An asset might be tagged as unsupported but have effective compensating controls (such as being in a fully air-gapped network) that are not fully reflected in the model, reducing the practical risk.",
      "cwe": "1104",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "48_sec4.ts",
      "bsiCode": "INF.14",
      "id": "misconfiguration-of-building-automation-inf14",
      "title": "Misconfiguration of Building Automation (BSI INF.14)",
      "description": "Building Automation (BA) systems, also referred to as 'Gebäudeautomation' (GA), control critical physical infrastructure such as HVAC, power, fire suppression, and physical access. A misconfiguration in these systems can lead to severe consequences, as they are often complex, interconnected, and may lack proper testing environments before deployment. This risk is exacerbated by faulty updates or update processes that can render a BA system or component unusable.",
      "impact": "Depending on which area of the building automation is misconfigured, it can lead to disruptions in business operations, unauthorized physical access to protected areas, damage to IT systems (e.g., from overheating), and, in severe cases, damage to the building or personal injury.",
      "action": "Implement and enforce secure configuration management for building automation systems.",
      "mitigation": "Define and enforce secure configuration baselines for all BA components, tailored to their specific function. Implement a strict change management and review process for any configuration modifications. Where possible, use dedicated test environments to validate changes and software/firmware updates. Ensure update procedures are reliable and have documented rollback plans. Regularly audit configurations against the defined baselines.",
      "check": "Are there documented secure configuration standards for all building automation systems? Is there a formal change control process in place for these systems? Are logs from BA systems monitored for anomalies or unauthorized changes? Are personnel responsible for configuration adequately trained?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.14 Gebäudeautomation (Building Automation).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_14_Gebaudeautomation_Edition_2023.html",
      "detectionLogic": "Scans for technical assets representing Building Automation components (e.g., assets of technology type 'OT-Device' tagged with `@BuildingSystem:*`). The risk is heightened for systems that are not redundant, involve custom-developed parts, or lack defined coordination with other critical systems (such as power and fire suppression).",
      "riskAssessment": "The impact is directly related to the availability and integrity requirements of the controlled physical process. Any potential for personal injury (e.g., with access control or fire suppression systems) implies the highest impact. The likelihood is increased for complex or custom systems where configuration errors are more probable, especially given the difficulty of full-scale testing mentioned in the BSI source.",
      "falsePositives": "This risk is abstract, as the model cannot verify the actual real-world configuration state. An asset identified by this rule might be perfectly configured and managed. This risk serves as a reminder to audit and verify the configuration management processes for all critical BA systems.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "48_sec5.ts",
      "bsiCode": "INF.14",
      "id": "manipulation-of-ga-tga-interfaces",
      "title": "Manipulation of Interfaces between Building Automation (GA) and Technical Building Equipment (TGA) (BSI G 0.23)",
      "description": "Manipulated interfaces between building automation (GA) systems and coupled technical building equipment (TGA), such as sensors and actuators, can lead to incorrect reactions in the automation system.",
      "impact": "Successful manipulation of these interfaces can directly compromise physical security and safety. This can lead to unauthorized access to facilities, deactivation of security systems (like alarms or cameras), or dangerous manipulation of environmental controls (HVAC, fire suppression).",
      "action": "Implement Secure, Authenticated, and Integrity-Protected Communication",
      "mitigation": "All communication between building automation components (controllers, sensors, actuators) must be protected against tampering. Use cryptographically secure, mutually authenticated protocols like TLS (e.g., HTTPS, MQTTS, WSS) to ensure both confidentiality and integrity of the data in transit.",
      "check": "Are the communication links between physical control systems and their sensors/actuators encrypted (e.g., using TLS)? Is strong mutual authentication enforced between components? Are messages signed or otherwise protected to prevent tampering?",
      "asvs": "BSI IT-Grundschutz INF.14 & APP.5.3: Building Automation / Building Management Systems",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_5_3_Building_management_systems_edition_2022.html",
      "detectionLogic": "This rule detects communication links between GA controllers and TGA endpoints. A risk is raised when a link connects a controller with a sensor or actuator and the protocol is unencrypted or authentication is disabled.",
      "riskAssessment": "The likelihood of exploitation is considered very likely if the communication channel is unprotected, as it allows trivial message injection or modification by an attacker with network access.",
      "falsePositives": "A flagged link may be a false positive if integrity controls are implemented at the application layer (e.g., signed payloads) and are documented outside of the model's protocol metadata.",
      "cwe": "345",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "48_sec6.ts",
      "bsiCode": "INF.14",
      "id": "inadequate-protection-of-building-automation-networks",
      "title": "Inadequate Protection of Building Automation (GA) Networks (BSI INF.14)",
      "description": "Building Automation (GA) systems often consist of numerous interconnected components like IoT devices, sensors, and actuators that communicate over various network protocols (LAN, WLAN, Bluetooth).",
      "impact": "An attacker exploiting an unprotected network access point to a GA system can cause severe damage. This includes Denial-of-Service (DoS) attacks, manipulation or sabotage of physical controls (e.g., HVAC, lighting, access), data exfiltration (e.g., personnel location), and the injection of malware.",
      "action": "Secure Network Access to Building Automation Components",
      "mitigation": "All network communication with GA components must be secured. Enforce strong authentication for all access attempts.",
      "check": "Are all network links to building automation components authenticated and encrypted? Is the GA network properly segmented from other networks?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.14: Gebäudeautomation, e.g., INF.14.A6 (Separierung von Netzen der GA).",
      "cheatSheet": "BSI IT-Grundschutz Baustein INF.14 (Gebäudeautomation).",
      "detectionLogic": "This rule triggers for any technical asset identified as an `IoTDevice` (or tagged as part of a building automation system) that receives data via a communication link under risky conditions.",
      "riskAssessment": "The likelihood is considered 'Very Likely' if an unprotected channel crosses a network boundary into a GA component, as this is a common target for automated scanning and attacks.",
      "falsePositives": "A risk might be flagged as a false positive if compensating controls exist outside the modeled scope, such as physical network isolation that is not represented by a trust boundary in the model.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "48_sec7.ts",
      "bsiCode": "INF.14",
      "id": "insecure-control-elements",
      "title": "Insecure Control Elements (Physical Access)",
      "description": "If easily accessible control elements (e.g., wall-mounted touch panels, gate personnel consoles) are insufficiently secured, they can be used to attack connected systems. This includes exploiting a lack of authentication to operate the device or using unprotected physical ports (like LAN or USB) to gain unauthorized access.",
      "impact": "An attacker can gain unauthorized control over building automation or other systems, potentially opening secure doors, disabling alarms, or manipulating environmental controls. This can lead to physical security breaches, compromise of assets in secured areas, and disruption of operations. It represents a direct threat to the Integrity and Availability of the controlled systems.",
      "action": "Secure Physical Control Elements and their Interfaces",
      "mitigation": "Physically restrict or monitor access to control elements. Enforce strong, mandatory authentication for all operations on the control element. Disable or protect all unused physical ports (USB, LAN, etc.). Ensure that communication from the control element to the system it controls is encrypted and properly authorized.",
      "check": "Are control elements located in physically secure, monitored areas? Does using the control element require authentication (e.g., PIN, card, biometrics)? Are all physical ports on the device secured against unauthorized use? Is the communication from the device to the backend secure?",
      "asvs": "Derived from BSI IT-Grundschutz CON.1: General Building, specifically requirement CON.1.A15 (Protection against unauthorised access), which covers securing access points and control systems within a physical environment.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/con/CON_1_EN.html",
      "detectionLogic": "This rule triggers on technical assets, typically of type 'OT-Device' or 'Client-System', that are tagged as being in a physically unrestricted area (`@PhysicalAccess:Unrestricted`). It then checks for outgoing communication links from this device that lack any form of authentication (`authentication: none`).",
      "riskAssessment": "The likelihood of exploitation is considered Very Likely if a device is physically accessible and its control functions require no authentication. The impact is determined by the criticality (CIA) of the technical asset that the insecure control element communicates with. Controlling a mission-critical system has a higher impact than controlling a non-critical one.",
      "falsePositives": "This risk may be a false positive if other compensating physical controls exist that are not modeled (e.g., constant human supervision, CCTV monitoring). The presence of the `@PhysicalAccess:Unrestricted` tag is an assertion that must be validated against the real-world deployment environment.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "48_sec8.ts",
      "bsiCode": "INF.14",
      "id": "insecure-mobile-interface-on-ba-component",
      "title": "Insecure Mobile Network Interface on Building Automation (BA) / OT Component",
      "description": "Building automation (BA) or OT components are often connected via mobile network interfaces to external manufacturers or service providers.",
      "impact": "Successful exploitation can lead to unauthorized access to the entire building automation network. This allows an attacker to tamper with physical systems (e.g., HVAC, lighting, physical access controls), cause denial-of-service, or exfiltrate sensitive operational data. This compromises the integrity and availability of the controlled environment and can serve as an entry point for further attacks on connected IT systems.",
      "action": "Secure Remote Communication Interfaces",
      "mitigation": "Ensure all communication over mobile or other public networks is strongly encrypted using standard protocols like TLS or is encapsulated in a VPN.",
      "check": "Review the configuration of all BA/OT components with remote-access capabilities. Is the communication protocol encrypted? Is authentication required and is it strong? Is the component located in a properly segmented network? Is the interface active only when necessary?",
      "asvs": "BSI IT-Grundschutz: IND.2.2 Industrielle IT-Komponenten, NET.3.3 Mobilfunknetze; OWASP IoT Top 10: Insecure Network Services, Insecure Communication",
      "cheatSheet": "https://owasp.org/www-project-internet-of-things/",
      "detectionLogic": "This rule checks for technical assets of type 'OT device' that have communication links to the internet or external entities.",
      "riskAssessment": "The likelihood is considered high if the connection lacks both encryption and authentication, as this represents a wide-open door. The impact is determined by the criticality of the OT device itself and, more importantly, the assets it shares a network with, as the primary threat is lateral movement into the GA network.",
      "falsePositives": "A risk might be incorrectly flagged if the mobile communication is secured by an underlying mechanism not explicitly modeled in Threagile, such as a carrier-provided private APN with built-in security, or a hardware-level VPN. The component might also be in a completely isolated, non-critical test network where the risk is acceptable.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "49_sec1.ts",
      "bsiCode": "INF.1",
      "id": "fire-and-smoke-damage-inf5",
      "title": "Fire and Smoke Damage (BSI INF.5)",
      "description": "Buildings, facilities, and IT systems can be severely damaged by fire, and people can be seriously injured or killed.",
      "impact": "A fire can lead to the complete destruction of IT assets and facilities, resulting in a long-term, catastrophic loss of availability and integrity of systems and data.",
      "action": "Implement Comprehensive Fire Prevention and Protection Measures",
      "mitigation": "Implement a multi-layered fire protection strategy including: organizational measures (e.g., fire safety regulations, no-smoking policies),",
      "check": "Are fire detectors and automatic alarm systems installed and regularly tested? Is there an appropriate fire suppression system (e.g., sprinklers, gas-based) for the server room/data center?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Fire Prevention and Protection)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Fire_prevention_and_protection_edition_2023.pdf?__blob=publicationFile&v=2 (BSI INF.5)",
      "detectionLogic": "This is a physical risk that applies to all in-scope technical assets located in on-premise trust boundaries (`type: network-on-prem`) or explicitly modeled as physical machines (`machine: physical`).",
      "riskAssessment": "The likelihood is generally considered 'Unlikely' for modern buildings adhering to fire codes, but is elevated to 'Likely' for mission-critical assets where the impact of even a small fire is unacceptable.",
      "falsePositives": "This risk is generated based on the physical location of an asset as defined in the model. It cannot automatically know the specific fire protection level of the building or room.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "49_sec2.ts",
      "bsiCode": "INF.1",
      "id": "damage-from-lightning-strikes-inf3",
      "title": "Damage to IT Systems from Lightning Strikes (related to BSI INF.3)",
      "description": "During thunderstorms, lightning strikes pose a significant threat to buildings and IT equipment. A strike can reach voltages of several hundred thousand volts and currents up to 200,000 amperes.",
      "impact": "Destruction or damage to physical hardware (servers, network components, etc.) leads to a direct loss of availability for the technical assets running on them.",
      "action": "Implement comprehensive lightning and surge protection",
      "mitigation": "A comprehensive lightning and surge protection concept must be implemented for all physical locations housing IT assets. This includes an external lightning protection system (e.g., lightning rods) to protect against direct strikes and an internal surge protection system (using Surge Protective Devices - SPDs) at various stages of the power distribution system to mitigate induced overvoltages.",
      "check": "Is there a documented lightning and surge protection concept for the physical location? Are assets housed in facilities with appropriate external and internal protection measures? Is there a defined process for regular inspection and maintenance of these systems?",
      "asvs": "BSI IT-Grundschutz Baustein INF.3 Blitz- und Überspannungsschutz (Lightning and Surge Protection)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_3_Blitz_und_Ueberspannungsschutz_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all technical assets running on physical, virtual, or container-based machines located within an on-premises or dedicated hosting trust boundary.",
      "riskAssessment": "The impact is determined by the availability and integrity rating of the affected technical asset. An outage of a mission-critical asset constitutes a very high impact.",
      "falsePositives": "The model might not accurately reflect the physical protections of a specific data center. An asset modeled in an 'on-prem' boundary might reside in a state-of-the-art, highly protected facility. This risk should be verified against the actual physical security measures at the location.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "49_sec3.ts",
      "bsiCode": "INF.1",
      "id": "water-damage-physical-infrastructure",
      "title": "Water Damage to Physical Infrastructure (BSI INF.1 T 0.5)",
      "description": "Water can cause damage to a building and its facilities. The source can be external, such as heavy rain, storm surges, or flooding,",
      "impact": "If physical IT infrastructure is damaged by water, it can lead to a complete loss of availability for the affected technical assets.",
      "action": "Implement Physical and Environmental Protections",
      "mitigation": "Ensure server rooms and data centers are located in areas with a low risk of flooding (e.g., not in basements).",
      "check": "Is the IT equipment located in a building area that is protected from flooding and water leaks? Are environmental sensors like water detectors in place?",
      "asvs": "Not applicable. This is a physical and environmental threat, which is outside the scope of the OWASP Application Security Verification Standard (ASVS).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile (BSI INF.1)",
      "detectionLogic": "This risk is automatically raised for any technical asset explicitly modeled as a 'physical' machine that is located within an 'on-premises' network trust boundary.",
      "riskAssessment": "The impact of this risk is determined by the availability requirements of the affected physical asset and the data it processes or stores.",
      "falsePositives": "This risk can be considered a false positive if the specific location has advanced, proven environmental controls against water damage that are not captured in the threat model.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "49_sec4.ts",
      "bsiCode": "INF.1",
      "id": "elemental-damage-natural-disasters",
      "title": "Elemental Damage and Natural Disasters (BSI INF.1.G4)",
      "description": "Depending on the location, a building is exposed to varying degrees of risk from elemental damage and natural disasters. Causes of natural disasters can include seismic (earthquakes), climatic (floods, landslides, tsunamis), or volcanic phenomena. Extreme weather events like hurricanes or heavy rainfall also pose a significant threat. This risk addresses the potential for physical infrastructure housing IT assets to be damaged or destroyed.",
      "impact": "The primary impact is on the Availability of all technical assets and data housed within the affected physical site. Physical destruction can lead to a total loss of services and business operations. Secondary impacts could include breaches of Confidentiality or Integrity if physical security controls are compromised during or after the event, leading to data loss or exposure.",
      "action": "Assess Site-Specific Environmental Risks and Implement Protective Measures",
      "mitigation": "Conduct a thorough risk assessment for the physical location of any data center or building housing critical assets. This includes checking official maps for floodplains, seismic zones, and historical weather data. Based on the assessment, implement appropriate structural and organizational safeguards, such as sump pumps, reinforced structures, fire suppression systems, and ensuring power/network redundancy. A comprehensive and tested Business Continuity and Disaster Recovery Plan (BCP/DRP) is essential, including geographically separate (off-site) data backups and potentially a h@SystemType:OT/cold secondary operational site.",
      "check": "Has a site-specific risk assessment for natural disasters been performed for all physical locations? Are physical protections in place corresponding to the identified risks? Is there a tested disaster recovery plan that accounts for the loss of the primary site?",
      "asvs": "BSI IT-Grundschutz INF.1: Gebäude (Buildings)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_Building_and_rooms_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any physical trust boundary (types 'network-on-prem' or 'network-dedicated-hoster') that contains technical assets. The risk is suppressed if the trust boundary is tagged with 'disaster-protection-site', indicating that a site assessment has been conducted and appropriate mitigations are in place.",
      "riskAssessment": "The likelihood is highly dependent on the geographical location of the physical site, which is unknown to the model. A general 'likely' is assumed for any un-assessed site. The impact is determined by the highest availability requirement of the assets within the site; if mission-critical assets are present, the impact is very high, as their destruction would lead to catastrophic business consequences.",
      "falsePositives": "This risk may be flagged for a location that has excellent, un-modeled physical protections. The model has no knowledge of specific building codes, flood barriers, or seismic retrofitting. Verification requires knowledge of the physical site's specific safeguards and the existence of a BCP/DRP. Tagging the boundary with 'disaster-protection-site' will mark it as a false positive in the model.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "49_sec5.ts",
      "bsiCode": "INF.1",
      "id": "environmental-hazard-to-building-inf1",
      "title": "Environmental Hazard to Building (BSI INF.1)",
      "description": "Buildings can be damaged by events in their immediate vicinity, such as the leakage of toxic substances.",
      "impact": "This can lead to a partial or total failure of the IT systems housed within the affected building, primarily impacting their **Availability**.",
      "action": "Select a Secure Location and Implement Physical and Organizational Protection Measures",
      "mitigation": "Site selection for data centers or server rooms should consider environmental risks (e.g., flooding, proximity to hazardous industrial sites).",
      "check": "Has the physical location of the data center been assessed for environmental risks? Are there emergency and evacuation plans? Are critical systems replicated in a separate, geographically distinct physical location?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.1 (Building Security)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is automatically generated for each trust boundary of type 'network-on-prem' or 'network-dedicated-hoster', as these represent physical locations susceptible to environmental hazards.",
      "riskAssessment": "The likelihood is location-dependent but is generally considered **Unlikely** for a generic model, as major disasters are not an everyday occurrence for most locations.",
      "falsePositives": "The risk may be a false positive or have a lower severity if the specific location is known to be low-risk (e.g., not in a flood plain, far from industrial hazards) or if extensive physical protections and redundancy plans are already in place, which might not be fully captured in the threat model.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "49_sec6.ts",
      "bsiCode": "INF.1",
      "id": "unauthorized-physical-access",
      "title": "Unauthorized Physical Access to Buildings/Rooms",
      "description": "Unauthorized entry into buildings or rooms enables theft, manipulation, or destruction of information, IT systems, or components.",
      "impact": "Compromises to physical access directly threaten Confidentiality (data theft), Integrity (manipulation of data/systems), and Availability (theft/destruction of hardware) of affected assets and the business processes they support.",
      "action": "Implement and enforce physical access control",
      "mitigation": "Deploy layered physical access controls for all areas containing IT assets: secure doors/locks, electronic access control (e.g., key cards), visitor management, surveillance/monitoring where appropriate, and secured racks or rooms for high-value assets.",
      "check": "Are physical access policies documented, enforced, and audited? Are sensitive areas protected by appropriate barriers (doors/locks) and access control mechanisms? Are access events logged and reviewed?",
      "asvs": "BSI IT-Grundschutz INF.1 Allgemeines Gebäude — insbesondere INF.1.A6 (Geschlossene Fenster und Türen), INF.1.A7 (Zutrittsregelung und -kontrolle), INF.1.A27 (Einbruchschutz).",
      "cheatSheet": "BSI IT-Grundschutz Kompendium — INF.1 Allgemeines Gebäude (Übersicht).",
      "detectionLogic": "Triggered for all in-scope technical assets with machine type 'Physical' that are within organization-controlled trust boundaries (NetworkOnPrem or NetworkDedicatedHoster).",
      "riskAssessment": "Impact is derived from the highest CIA requirement of the physically accessible asset and the data it processes/stores.",
      "falsePositives": "Assets may be flagged even if they are in highly secure areas (e.g., vault, DC cage) when this detail is not present in the model.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "49_sec7.ts",
      "bsiCode": "INF.1",
      "id": "inf1-non-compliance-during-development",
      "title": "Non-Compliance with Safety Requirements During Development (BSI INF.1 Analogy)",
      "description": "When an IT system is built, numerous laws, standards, and internal policies must be observed (e.g., data protection, architectural security, physical/environmental safety). If these regulations are violated during development, this may not be noticed for a long time, but can have catastrophic consequences, for instance, if security controls are not implemented as specified or secure coding practices are ignored.",
      "impact": "Failure to adhere to security requirements and regulations during development can introduce critical vulnerabilities. This can lead to data breaches, system failures, unauthorized access, and non-compliance with legal or contractual obligations (e.g., handling of PII, PCI-DSS), resulting in significant financial loss, reputational damage, and legal penalties.",
      "action": "Establish and Enforce a Secure Software Development Lifecycle (SDLC)",
      "mitigation": "Integrate security into every phase of the development lifecycle. Define clear security requirements, architectural principles, and secure coding standards based on relevant laws and best practices. Use a combination of automated security testing (SAST, DAST, IAST, SCA) within the CI/CD pipeline and manual verification (peer reviews, security walkthroughs, penetration testing) to ensure compliance. Provide ongoing training for developers on secure coding practices and the specific requirements applicable to the project.",
      "check": "Is there a documented Secure SDLC? Are security requirements explicitly defined and tracked? Are automated security scanning tools integrated into the build process? Are there records of security-focused code reviews and penetration tests for custom-developed components?",
      "asvs": "V1: Architecture, Design and Threat Modeling Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Abuse_Case_Cheat_Sheet.html",
      "detectionLogic": "Heuristic used by this rule: (1) The asset must be in scope (outOfScope === false). (2) The asset must contain custom-developed parts (customDevelopedParts === true). (3) Likelihood is increased to VeryLikely if the asset is internet-facing (internet === true), otherwise Likely. (4) Impact is derived from the asset's highest confidentiality, integrity, and availability requirements; assets tagged 'high-value-target' are upgraded to VeryHigh impact. (5) Data breach probability rises when confidentiality >= Restricted and impact >= Medium. This focuses attention on custom code that, if non-compliant, could undermine overall (including building-related) safety requirements per the INF.1 analogy.",
      "riskAssessment": "Likelihood: at least 'Likely' for any custom-developed component and 'VeryLikely' for internet-facing ones. Impact: derived from CIA levels of the asset and the data it handles; 'high-value-target' elevates the impact to VeryHigh. Resulting severity is calculated from likelihood and impact.",
      "falsePositives": "Projects with a mature and enforced Secure SDLC (evidence: requirements traceability, SAST/DAST/IAST/SCA gates, code reviews, pentest reports) may be low risk in practice despite custom development. Treat such cases as acceptable with documented justification.",
      "cwe": "1035",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "49_sec8.ts",
      "bsiCode": "INF.1",
      "id": "inadequate-cable-and-pipe-seals-inf2",
      "title": "Inadequate Cable and Pipe Seals (Brandschotten) (BSI INF.2)",
      "description": "In any building housing IT, numerous cables and pipes for power, data, water, and heating must pass through fire-rated walls and floors.",
      "impact": "Failure to properly seal cable and pipe penetrations can lead to catastrophic fire and smoke damage, resulting in a total loss of availability for affected IT systems.",
      "action": "Implement and Regularly Inspect Certified Fire Protection Seals",
      "mitigation": "Ensure all cable and pipe penetrations through fire-rated barriers are sealed using certified fire-stop systems (Brandschotten).",
      "check": "Are all cable and pipe penetrations through fire-rated walls and floors sealed with appropriate, certified fire stops?",
      "asvs": "This is a physical and environmental control not covered by OWASP ASVS. It directly maps to BSI IT-Grundschutz, Baustein INF.2: Gebäude (Building).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Building_Edition_2023.pdf?__blob=publicationFile (BSI INF.2)",
      "detectionLogic": "This risk is triggered for any on-premise network trust boundary ('network-on-prem') that is not explicitly tagged as having verified fire seals.",
      "riskAssessment": "The likelihood is considered 'likely' due to the high frequency of cabling changes in IT environments, as noted by the BSI.",
      "falsePositives": "This risk can be a false positive if the physical fire seals are actually in place and properly maintained, but the model has not been updated with the 'physical-control-fire-seals-verified' tag on the relevant trust boundary.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "49_sec9.ts",
      "bsiCode": "INF.1",
      "id": "power-outage-bsi-inf4",
      "title": "Power Outage / Loss of Power Supply (BSI INF.4)",
      "description": "In the event of a power failure, entire buildings or parts of them can become unusable. Not only are obvious, direct power consumers such as IT systems or lighting dependent on the power supply, but all infrastructure facilities are also directly or indirectly dependent on electricity. This includes elevators, air conditioning, alarm systems, security locks, automatic doors, and even water pumps. A power outage represents a fundamental threat to the availability of all colocated systems.",
      "impact": "A power outage directly impacts the availability of all dependent IT systems and physical infrastructure. This can lead to a complete standstill of business operations, inability to access physical locations, and failure of safety and security systems, resulting in significant operational and financial losses.",
      "action": "Ensure Redundant Power Supply and Contingency Planning",
      "mitigation": "Mitigate the risk of power outages by implementing uninterruptible power supplies (UPS) for critical systems and emergency power generators for longer outages. For assets located in cloud environments, the provider's SLA regarding power availability and redundancy should be considered sufficient unless modeled otherwise. For on-premises assets, power redundancy measures should be documented and tested. This can be indicated in the model by applying a `@redundant-power`, `@ups-protected`, or `@generator-@Backup:Target` tag to the relevant Technical Asset, its Trust Boundary, or its Shared Runtime.",
      "check": "Are critical on-premises assets and the data centers hosting them protected by UPS and/or emergency generators? Is this protection documented and regularly tested? For cloud-hosted assets, does the cloud provider's SLA meet the availability requirements?",
      "asvs": "BSI IT-Grundschutz Baustein INF.4: Electrical Power Supply",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_4_Electrical_power_supply_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all in-scope technical assets running on physical or virtual machines within on-premises or dedicated hosting provider trust boundaries. The risk is considered mitigated if the asset, its containing trust boundary (or any parent boundary), or its shared runtime is tagged with `@redundant-power`, `@ups-protected`, or `@generator-@Backup:Target`. The risk is not applied to serverless or containerized assets within cloud provider boundaries, as power is assumed to be part of the managed service.",
      "riskAssessment": "The likelihood of a power outage causing a failure is considered 'likely' for non-redundant assets and 'unlikely' for redundant assets (which may still fail if the redundant power source fails). The impact is derived directly from the asset's 'availability' rating. A mission-critical asset failing has a 'very-high' impact.",
      "falsePositives": "This risk can be a false positive if power redundancy measures (UPS, generators) exist but are not documented in the model via the specified tags. It might also be incorrectly raised for assets within a data center that has certified high availability, which is not captured in the model.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "4_sec1.ts",
      "bsiCode": "APP.2.1",
      "id": "insecure-directory-service-deployment",
      "title": "Insecure Deployment of Directory Service due to Insufficient Hardening",
      "description": "The security of directory services (like LDAP) heavily relies on the security of the underlying operating system and its file system.",
      "impact": "A poorly configured or hardened directory service can be compromised, leading to unauthorized access, elevation of privilege across the entire network,",
      "action": "Apply OS and Application Hardening for Directory Services",
      "mitigation": "Ensure the operating system hosting the directory service is hardened according to established security baselines (e.g., CIS Benchmarks).",
      "check": "Are the operating system and the directory service application hardened according to a documented baseline? Are file system permissions restrictive?",
      "asvs": "Related to configuration and hardening best practices, similar in principle to CIS Benchmarks for operating systems and directory services. This is an operational and architectural risk rather than a specific application vulnerability.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS_1_3_Linux_und_Unix-Server_Edition_2023.pdf?__blob=publicationFile (BSI IT-Grundschutz SYS.1.3 as an example)",
      "detectionLogic": "This risk is raised for any technical asset of technology type `LDAP-Server` or `Identity-Store-LDAP` that is not explicitly tagged as hardened.",
      "riskAssessment": "The likelihood is considered higher for directory services in complex environments (i.e., with many communication links) where the chance of a configuration error increases.",
      "falsePositives": "This risk may be a false positive if the system is properly hardened in reality, but this fact is not reflected in the model via the `@Hardened:OS-for-Directory-Service` tag.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "4_sec2.ts",
      "bsiCode": "APP.2.1",
      "id": "improper-directory-service-partitioning-and-replication",
      "title": "Improper Directory Service Partitioning and Replication (BSI APP.2.1.A8)",
      "description": "Partitioning allows the directory data of a directory service to be divided into individual areas (partitions),",
      "impact": "Poorly planned partitioning and replication can lead to data loss, data inconsistencies, poor availability of the directory service,",
      "action": "Develop and adhere to a strategic partitioning and replication plan.",
      "mitigation": "A robust plan for partitioning and replication must be created before deployment. This plan should define the partitioning schema,",
      "check": "Is there a documented partitioning and replication strategy for the directory service?",
      "asvs": "BSI IT-Grundschutz APP.2.1 Allgemeiner Verzeichnisdienst, specifically requirement APP.2.1.A8 (Planning of partitioning and replication).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_2_1_Directory_services_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for any technical asset identified as an `LDAP Server` or `Identity Store LDAP`, as these technologies",
      "riskAssessment": "The likelihood is considered `Likely` due to the inherent complexity of managing distributed data stores.",
      "falsePositives": "This risk might be considered a false positive for very simple, single-instance, non-replicated directory services.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "4_sec3.ts",
      "bsiCode": "APP.2.1",
      "id": "incorrectly-administered-access-rights",
      "title": "Incorrectly Administered Access Rights (Least Privilege Violation)",
      "description": "Access rights to IT systems, applications, and stored data must be granted only to the extent necessary for assigned tasks (Principle of Least Privilege). This also applies to permissions for users and groups managed by a directory service. If these rights are administered incorrectly, it can lead to security vulnerabilities when excessive permissions are granted. Incorrect or inconsistent access rights, especially when no authorization is enforced on a data flow, can significantly jeopardize the security of the entire system.",
      "impact": "Failure to enforce the Principle of Least Privilege can allow attackers or malicious insiders to gain unauthorized access to data and functionality. If administrative rights are incorrectly assigned, the entire administrative concept can be subverted, potentially leading to a full system compromise. This directly threatens the Confidentiality, Integrity, and Availability of the system and its data, and can enable further attacks.",
      "action": "Review and Enforce Least Privilege Principle",
      "mitigation": "Implement a fine-grained authorization concept based on roles and responsibilities (RBAC). Regularly review and audit all access rights, especially administrative privileges. Avoid shared technical users with broad permissions where possible; prefer end-user identity propagation for accountability. Communication links to sensitive assets must have a defined and enforced authorization mechanism (e.g., avoid 'none').",
      "check": "Is there a documented authorization concept? Are access rights based on the Principle of Least Privilege? Are permissions, especially for administrators, regularly reviewed? Do communication links to data stores and sensitive components enforce authorization?",
      "asvs": "BSI IT-Grundschutz CON.8: Berechtigungskonzept (Authorization Concept), OWASP ASVS V4.0.3-4.1: Access Control Verification Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is identified when a communication link does not enforce any authorization (i.e., `authorization: none`) when accessing a technical asset. The risk is heightened when the target asset is a data store or another sensitive component (like an identity provider) and handles data with high confidentiality or integrity requirements.",
      "riskAssessment": "Impact is determined by the CIA rating of the target asset. A lack of authorization to a data store with 'Strictly Confidential' data constitutes a 'High' or 'Very High' impact. Likelihood is considered 'Likely' or 'Very Likely' because the lack of an authorization control is a direct, exploitable vulnerability for any party that can reach the asset.",
      "falsePositives": "A finding might be a false positive if the target endpoint is intentionally public and read-only, containing no sensitive information. Additionally, some applications might enforce authorization internally in a way that is not reflected in the model's communication link properties.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "4_sec4.ts",
      "bsiCode": "APP.2.1",
      "id": "bsi-app-2-1-insecure-directory-service-access",
      "title": "Insecure Access to Directory Service (based on BSI APP.2.1)",
      "description": "In many cases, other applications such as internet or intranet applications must access the directory service.",
      "impact": "If an attacker can exploit these misconfigurations, they could gain unauthorized access, elevate privileges, or intercept credentials by sniffing the network.",
      "action": "Secure Directory Service Configuration and Communication",
      "mitigation": "Ensure all communication with the directory service uses an encrypted protocol (e.g., LDAPS, or LDAP with STARTTLS).",
      "check": "Are all communication links to the directory service encrypted? Is authentication required for all access (i.e., no 'none' authentication)? Are anonymous binds disabled?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.2.1 (Allgemeiner Verzeichnisdienst). Relevant OWASP ASVS v4.0.3 requirements include V2.3.1 (secure transport), V4.1.1 (least privilege), and V4.2.1 (centralized access control).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Kompendium_Bausteine/APP_Anwendungen/APP_2_1_Allgemeiner_Verzeichnisdienst_Edition_2023.html",
      "detectionLogic": "This rule checks all assets that function as a directory service (e.g., technology 'ldap-server' or 'identity-store-ldap').",
      "riskAssessment": "The likelihood of exploitation is high for unauthenticated access and for unencrypted communication crossing trust boundaries.",
      "falsePositives": "This risk can be a false positive if the unencrypted/unauthenticated communication is strictly confined within a physically or logically isolated and trusted network segment where sniffing is considered infeasible (e.g., via localhost loopback). However, relying on network controls alone is not a robust defense.",
      "cwe": "522",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "4_sec5.ts",
      "bsiCode": "APP.2.1",
      "id": "technical-failure-of-directory-service-g0.18",
      "title": "Technical Failure of Directory Service (BSI G 0.18)",
      "description": "Technical failure due to hardware or software problems can cause directory services or parts of them to fail.",
      "impact": "The failure of a directory service can disrupt business processes and internal workflows that depend on it for authentication and authorization.",
      "action": "Ensure Redundancy and Implement @Backup:Target/Restore Strategy",
      "mitigation": "Implement the directory service in a redundant, highly-available configuration (e.g., clustered, with multi-master replication).",
      "check": "Is the technical asset representing the directory service configured as redundant in the model (i.e., `redundant: true`)?",
      "asvs": "Derived from BSI IT-Grundschutz Threat G 0.18 (Technical failure of IT components) applied to Baustein APP.2.1 (Directory Services).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_2_1_Directory_services_Edition_2023.pdf?__blob=publicationFile (BSI APP.2.1)",
      "detectionLogic": "This risk is automatically triggered for any technical asset identified as a directory service (e.g., technology is `ldap-server`, `identity-store-ldap`, `identity-store-database`, or `identity-provider`)",
      "riskAssessment": "The likelihood of a technical failure in a non-redundant system over its operational lifetime is considered 'likely'.",
      "falsePositives": "This risk can be a false positive if redundancy is achieved through mechanisms not captured in the model (e.g., underlying hypervisor or storage-level redundancy) and the asset itself is not marked as `redundant`. Manual verification of the architecture is required in such cases.",
      "cwe": "755",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "4_sec6.ts",
      "bsiCode": "APP.2.1",
      "id": "anonymous-access-to-directory-service",
      "title": "Anonymous Access to Directory Service (BSI-Style)",
      "description": "If anonymous users are permitted to access a directory service, its security is significantly at risk.",
      "impact": "Allowing anonymous access facilitates reconnaissance, which can expose sensitive information about the infrastructure and user accounts. It also makes Denial-of-Service (DoS) attacks easier to execute, as attackers have more uncontrolled access points. A full compromise could impact or destroy the entire system reliant on the directory service.",
      "action": "Disable Anonymous Access on Directory Services",
      "mitigation": "Configure all directory services (e.g., LDAP, Active Directory) to reject anonymous binds and queries by default. All access should require strong authentication and authorization. Any exceptions for anonymous access must be documented, risk-assessed, and limited to the absolute minimum required data.",
      "check": "Review the configuration of all directory services. Is anonymous binding disabled? Is there a documented business justification and risk acceptance for any exceptions?",
      "asvs": "V2.1.4: Verify that anonymous binding/access is disabled on the directory server unless it is specifically required for a public-facing resource.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for technical assets identified as directory services (e.g., technology is LDAP Server, Identity Store) that have incoming communication links with authentication set to 'none'. The risk is elevated if the anonymous connection originates from the internet.",
      "riskAssessment": "The likelihood of exploitation is high if an anonymous access path is discovered, especially from an untrusted network like the internet. The impact is determined by the sensitivity of the data within the directory service and the criticality of the systems that depend on it for authentication and authorization. A compromised directory service often leads to a widespread, high-impact breach.",
      "falsePositives": "Can occur if the model incorrectly flags an internal, highly trusted administrative connection as 'none' for authentication when it is otherwise secured (e.g., within a secure execution environment). This is generally rare.",
      "cwe": "306",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "4_sec7.ts",
      "bsiCode": "APP.2.1",
      "id": "misconfigured-directory-service-cleartext-auth",
      "title": "Misconfigured Directory Service (Cleartext Authentication)",
      "description": "Directory services offer extensive functionality, which can lead to misconfigurations if not carefully managed. A common and critical misconfiguration is allowing unencrypted communication. If default settings are not reviewed and hardened, authentication information can be transmitted in cleartext or with insufficient protection, allowing it to be intercepted by an attacker on the network.",
      "impact": "An attacker can eavesdrop on the network to capture credentials (usernames and passwords) sent in cleartext. This leads to unauthorized access to the directory service and potentially to all systems and applications relying on it for authentication, resulting in a widespread compromise.",
      "action": "Enforce Encrypted Communication for Directory Services",
      "mitigation": "All communication with the directory service MUST be encrypted using protocols like LDAPS or STARTTLS. Disable unencrypted LDAP (port 389) access entirely and only permit connections over the encrypted port (636). Ensure that clients are configured to verify the server's certificate to prevent man-in-the-middle attacks.",
      "check": "Review all communication links connected to any 'LDAP Server' or 'Identity Store LDAP' asset. Any link using the 'ldap' protocol is a vulnerability. All links should use 'ldaps'.",
      "asvs": "BSI IT-Grundschutz APP.4.4 Directory services, Requirement APP.4.4.A8 Secure communication with the directory service.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/APP/APP_4_4_Directory_services_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies any 'LDAP Server' or 'Identity Store LDAP' asset that communicates via the unencrypted 'ldap' protocol. It scans all communication links and flags those using 'ldap' where the source or target is a directory service.",
      "riskAssessment": "The likelihood is considered 'Very Likely' as the misconfiguration is actively present in the model. The impact is rated 'High' or 'Very High' depending on the confidentiality of the directory service, as it typically stores credentials for many other systems.",
      "falsePositives": "Can be considered a false positive only if the unencrypted LDAP traffic is strictly contained within a physically or cryptographically isolated network segment (e.g., a dedicated VLAN on a trusted switch, or within a service mesh with mTLS) where sniffing is impossible. This is a rare and high-risk exception.",
      "cwe": "319",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "50_sec1.ts",
      "bsiCode": "INF.2",
      "id": "inadequate-physical-protection-for-on-prem-datacenter",
      "title": "Inadequate Protection of On-Premises Data Center Against Environmental Threats (BSI INF.2)",
      "description": "If a data center or on-premises server location is designed without adequately considering and mitigating fundamental physical and environmental threats, there is a very high risk of service disruption.",
      "impact": "Failure to protect against environmental and physical threats can lead to prolonged downtime of all systems within the affected site.",
      "action": "Perform site risk assessment and implement physical & environmental controls",
      "mitigation": "Conduct a thorough risk assessment for the chosen physical location, considering all plausible environmental threats (e.g., flooding, fire, seismic activity, extreme weather).",
      "check": "Has a formal site risk assessment been performed and documented? Are there protections in place against power failure, fire, and water damage?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium, Baustein INF.2: Rechenzentrum sowie Serverraum (Data Center and Server Room)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_2_Serverraum_sowie_Rechenzentrum_Edition_2023.html",
      "detectionLogic": "Triggers for any trust boundary of type 'network-on-prem' or 'network-dedicated-hoster', as these types of infrastructure are inherently susceptible to physical and environmental threats that require explicit real-world mitigation beyond what can be modeled in software architecture.",
      "riskAssessment": "The impact is determined by the highest availability requirement of any technical asset located within the on-premises trust boundary.",
      "falsePositives": "This risk can be considered a false positive if a comprehensive, documented, and tested business continuity and disaster recovery plan, including all relevant physical and environmental protections, is in place for the specific site. This risk serves as a reminder to verify these external controls, which cannot be represented in the threat model itself.",
      "cwe": "693 // Protection Mechanism Failure",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "50_sec2.ts",
      "bsiCode": "INF.2",
      "id": "inadequate-physical-access-controls",
      "title": "Inadequate Physical Access Controls (BSI INF.2.A6)",
      "description": "If physical access controls to sensitive areas like data centers are missing or insufficient, the risk of unauthorized access increases significantly.",
      "impact": "Insufficient physical access controls directly threaten the Confidentiality (e.g., data theft), Integrity (e.g., server manipulation), and",
      "action": "Implement and Enforce Strict Physical Access Controls",
      "mitigation": "Implement a multi-layered physical access control system for all sensitive areas (e.g., data centers, server rooms).",
      "check": "Is there a documented physical access control policy? Are all entry points to sensitive areas secured? Is access restricted to authorized personnel and logged? Are there procedures for visitors, cleaners, and maintenance staff?",
      "asvs": "BSI IT-Grundschutz INF.2 Data Center, Requirement INF.2.A6 Access Control",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Data_centre_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any trust boundary representing a physical on-premise or dedicated hosting environment",
      "riskAssessment": "The likelihood is considered high if a physical location housing IT assets is not explicitly secured. The impact is determined by the highest",
      "falsePositives": "The model might not fully reflect all physical security measures in place. An area could be physically secure in reality,",
      "cwe": "288",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "50_sec3.ts",
      "bsiCode": "INF.2",
      "id": "insufficient-monitoring-of-infrastructure",
      "title": "Insufficient Monitoring of IT and Infrastructure (aligned with BSI OPS.1.1)",
      "description": "If IT and infrastructure components are insufficiently monitored and managed, components can fail without being noticed.",
      "impact": "Non-detection of component failures or performance degradation directly affects the availability of the impacted systems and dependent business processes.",
      "action": "Implement comprehensive monitoring and alerting",
      "mitigation": "Implement a robust monitoring system for all critical IT components and infrastructure (e.g., servers, network devices, databases, applications).",
      "check": "Is a monitoring solution in place for all non-client, in-scope assets? Are key performance and health indicators tracked for these assets? Are alert thresholds defined and is there a documented incident response process for handling alerts?",
      "asvs": "BSI IT-Grundschutz Baustein OPS.1.1: General IT Operations, Requirement OPS.1.1.A7 (Monitoring of IT components and services)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_IT_operations_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified for any in-scope, non-client technical asset that is not itself a monitoring system and does not have a communication link to a technical asset with technology 'monitoring', 'IDS', or 'IPS'.",
      "riskAssessment": "The impact is derived directly from the availability rating of the unmonitored asset. A 'mission-critical' asset without monitoring poses a 'very-high' impact risk.",
      "falsePositives": "This rule may generate a false positive if monitoring is achieved via an out-of-band management network, an agent-based system, or a cloud-native platform service (like AWS CloudWatch, Azure Monitor) that is not explicitly modeled as a 'monitoring' asset with a corresponding communication link in the diagram.",
      "cwe": "755 // Improper Handling of Exceptional Conditions - as an unmonitored failure is an unhandled exception at the system level.",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "50_sec4.ts",
      "bsiCode": "INF.2",
      "id": "inadequate-operating-environment-inf2.a5",
      "title": "Inadequate Operating Environment (BSI INF.2.A5)",
      "description": "IT components require specific operating conditions to function reliably. They also convert the electrical power they consume into additional heat. If the temperature, humidity, or airborne particulate levels in an IT operating area are not maintained within the limits specified by the equipment manufacturers, it can lead to technical components malfunctioning or failing completely.",
      "impact": "Failure to maintain a suitable physical operating environment can lead to the degradation or complete failure of hardware components. This directly impacts the Availability of the systems and the services they provide, potentially causing business process disruptions, data loss or corruption (Integrity), and significant downtime.",
      "action": "Ensure Proper Environmental Controls for Physical IT Assets",
      "mitigation": "The operating environment for physical IT assets, such as server rooms or data centers, must be equipped with appropriate climate control systems (HVAC) to regulate temperature and humidity. Implement air filtration to reduce dust and other particulates. Environmental conditions should be continuously monitored, with automated alerts configured to notify operations personnel when values exceed predefined thresholds. Regular maintenance of climate control and monitoring systems is essential.",
      "check": "Are physical IT components housed in an environment with climate control? Are temperature and humidity monitored? Are there alerting mechanisms for environmental anomalies? Do the environmental conditions meet manufacturer specifications for the deployed hardware?",
      "asvs": "BSI IT-Grundschutz INF.2 Serverraum (Server Room), Requirement INF.2.A5 Ausreichende Klimatisierung (Sufficient Air Conditioning)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_2_Serverraum_Edition_2023.pdf?__blob=publicationFile (German)",
      "detectionLogic": "This risk is triggered for any in-scope technical asset modeled as a physical machine. The likelihood and impact are elevated for assets with high availability requirements or those located in on-premise trust boundaries, where environmental controls might be less robust than in a dedicated hosting facility.",
      "riskAssessment": "The impact is directly derived from the availability requirement of the physical asset. A mission-critical system failing has a much higher impact than an archive system. The likelihood is considered higher for mission-critical systems and those in on-premise data centers, as any environmental fluctuation is more likely to cause a noticeable and critical incident.",
      "falsePositives": "The model cannot verify the actual quality of the physical environment (e.g., HVAC systems, monitoring). This risk should be considered a standard due-diligence check for all physical infrastructure to ensure that operational environmental security is not overlooked.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "50_sec5.ts",
      "bsiCode": "INF.2",
      "id": "fire-risk-g0.1",
      "title": "Fire (BSI G 0.1)",
      "description": "Fire is a rare but high-impact threat. Fire and smoke can cause severe damage to IT systems, support infrastructure, and buildings.",
      "impact": "A fire can lead to the destruction or severe damage of IT hardware, support infrastructure, and the facility itself. This results in a major loss of Availability for all systems and data hosted in the affected location.",
      "action": "Implement Comprehensive Fire Protection Measures",
      "mitigation": "Install certified fire and smoke detection systems connected to an alarm center. Use automatic fire extinguishing systems appropriate for IT environments (e.g., inert gas).",
      "check": "Are fire detection and suppression systems installed, regularly tested, and certified? Is the building divided into fire compartments? Are staff trained in emergency procedures? Is combustible material stored away from critical IT areas?",
      "asvs": "BSI IT-Grundschutz INF.2.A5 Fire Protection",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Building_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to all technical assets located in physical, on-premise environments, especially data centers. The risk is raised for assets within trust boundaries of type 'network-on-prem' or those tagged with 'location:on-premise-datacenter'. The risk can be mitigated if the asset or its containing trust boundary is tagged with 'fire-protection:adequate'.",
      "riskAssessment": "The likelihood is generally 'Unlikely' but can be elevated to 'Likely' if fire protection measures are explicitly modeled as inadequate (e.g., via the 'fire-protection:inadequate' tag).",
      "falsePositives": "The risk might be a false positive if a 'network-on-prem' trust boundary represents a location with no significant, centralized IT infrastructure (e.g., a small branch office). The model also cannot verify the *actual* effectiveness of declared fire protection measures; it relies on the 'fire-protection:adequate' tag being applied correctly.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "50_sec6.ts",
      "bsiCode": "INF.2",
      "id": "water-damage-inf-1-a5",
      "title": "Water Damage in Data Center (BSI INF.1.A5)",
      "description": "Water can enter a data center through various means, such as leaking water pipes, floods, burst pipes, or defective sprinkler or air-conditioning systems. This ingress of water can physically damage server hardware, storage systems, and network equipment, causing malfunction or complete failure. It can also trigger short circuits, which may lead to power outages for individual racks or entire sections of the data center and, in the worst case, may ignite a fire.",
      "impact": "The primary impact of water damage is a severe loss of availability for all affected systems and the data they process or store. It can also lead to a loss of integrity if storage media are physically damaged. This can halt business operations, result in significant financial loss for repairs and downtime, and potentially cause permanent data loss.",
      "action": "Implement Physical Protection Measures Against Water Damage",
      "mitigation": "Locate data centers and server rooms above ground level and away from areas with a high risk of flooding or sources of water. Install water detectors in critical areas, especially in basements and under raised floors. Ensure proper drainage is in place. Regularly inspect and maintain all plumbing, sprinkler systems, and air conditioning units. Establish emergency procedures for shutting down power in affected areas to prevent short circuits and fires. Ensure that critical equipment is housed in water-resistant racks where feasible.",
      "check": "Is the data center location assessed for water-related risks? Are water detectors installed and monitored? Are there regular maintenance schedules for plumbing and HVAC systems? Are emergency power-off procedures documented and tested?",
      "asvs": "BSI IT-Grundschutz Baustein INF.1: Allgemeines Gebäude, Anforderung INF.1.A5 Schutz vor Wasser und Feuchtigkeit.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_1_Allgemeines_Gebaeude_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to all physical and virtual assets located within an on-premises or a dedicated hosting provider data center. The threat model identifies these as technical assets with a machine type of 'physical' or 'virtual' that are located inside a trust boundary of type 'network-on-prem' or 'network-dedicated-hoster'.",
      "riskAssessment": "The impact is determined by the availability and integrity requirements of the affected assets. An outage of a 'mission-critical' asset constitutes a 'very high' impact. The likelihood is considered 'unlikely' by default but can be adjusted by tagging the corresponding trust boundary with '@water-risk:low', '@water-risk:medium', or '@water-risk:high' to reflect a specific environmental assessment.",
      "falsePositives": "The risk may be flagged for a data center that has extensive physical water protection measures (e.g., advanced water detection and diversion systems) which are not visible in the threat model. The existence of such controls should be verified with the infrastructure and operations teams.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "50_sec7.ts",
      "bsiCode": "INF.2",
      "id": "insufficient-break-in-protection-inf2-a5",
      "title": "Insufficient Protection Against Break-in at Data Center (BSI INF.2.A5)",
      "description": "Even with established access control measures, a data center may still be vulnerable to physical intrusion (break-in) if not sufficiently hardened.",
      "impact": "Attackers with physical access can steal or manipulate IT components, leading to data theft (loss of Confidentiality), data/system manipulation (loss of Integrity),",
      "action": "Enhance Physical Security Measures",
      "mitigation": "Implement robust physical security controls for the data center perimeter. This includes reinforced doors and windows, intrusion detection and alarm systems,",
      "check": "Are there certified physical security measures in place (e.g., resistance classes for doors/windows)? Is there a monitored intrusion detection system?",
      "asvs": "BSI IT-Grundschutz Baustein INF.2: Rechenzentrum baulich-technische Sicherung (Data Center Physical and Technical Security), Requirement INF.2.A5: Schutz vor Einbruch und Diebstahl (Protection against burglary and theft).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Data_Centre_physical_and_technical_security_edition_2023.pdf?__blob=publicationFile&v=2 (BSI INF.2)",
      "detectionLogic": "Triggered when a trust boundary represents a physical data center (type 'NetworkOnPrem' or 'NetworkDedicatedHoster') AND it contains at least one in-scope technical asset.",
      "riskAssessment": "Default likelihood is 'Unlikely' due to the effort and risk for attackers. Impact scales with the highest confidentiality, integrity, and availability requirements",
      "falsePositives": "Considered a false positive if the data center has exceptionally strong, certified physical security (e.g., high-security vault) that is clearly documented in the model.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "50_sec8.ts",
      "bsiCode": "INF.2",
      "id": "power-outage-datacenter-inf2-g0.1",
      "title": "Power Outage at Data Center (BSI INF.2 G 0.1)",
      "description": "If the power fails, the operations of a data center—and thus the institution—can be significantly disrupted.",
      "impact": "A power outage directly compromises the availability of all IT systems and services hosted within the affected data center.",
      "action": "Implement Redundant Power Supply and Emergency Power Systems",
      "mitigation": "Install an Uninterruptible Power Supply (UPS) to bridge short-term outages and allow for a graceful shutdown of systems.",
      "check": "Is there a documented and tested emergency power concept? Does it include both a UPS and a generator? Are maintenance and test logs for these systems available?",
      "asvs": "N/A (ASVS focuses on application-level controls, whereas this is an environmental/infrastructure threat). BSI IT-Grundschutz INF.2 is the relevant standard.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Data_centre_physical_security_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to all technical assets located within a trust boundary that is explicitly identified as a data center (e.g., via an '@Datacenter' tag).",
      "riskAssessment": "The likelihood of a power outage depends on the reliability of the local power grid and is considered 'Likely' for a standard grid without specific protections.",
      "falsePositives": "This risk might be considered a false positive if the model does not accurately represent existing power redundancy measures (e.g., UPS and generators are present but not modeled via tags or other attributes).",
      "cwe": "404",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "50_sec9.ts",
      "bsiCode": "INF.2",
      "id": "contamination-in-datacenter",
      "title": "Contamination in the Data Center (Dust, Dirt)",
      "description": "The BSI notes that dust and other contaminants in a data center can cause technical components (e.g., cooling fans) to fail.",
      "impact": "The failure of physical hardware components due to contamination can lead to service outages, system performance degradation, and, in worst-case scenarios without sufficient redundancy, data loss.",
      "action": "Implement and maintain environmental controls and cleaning schedules",
      "mitigation": "Ensure the data center environment is controlled against dust and other contaminants. This involves implementing professional-grade air filtration systems (e.g., HEPA filters),",
      "check": "Is there a documented policy and procedure for data center cleanliness? Is a regular, professional cleaning and maintenance schedule in place and being followed?",
      "asvs": "ASVS V14.1.1 (Physical Security): Verify that the application's hosting and cloud environments have sufficient physical security controls to prevent unauthorized physical access and tampering.",
      "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Oeffentliche-Verwaltung/Nach-Themen/Infrastruktur/Rechenzentren/RZ-Grundschutz/rz-grundschutz_node.html",
      "detectionLogic": "This risk is raised for any 'physical' machine-type technical assets that are located within a trust boundary representing a data center.",
      "riskAssessment": "The likelihood of failure is considered 'likely' in the absence of stringent environmental controls.",
      "falsePositives": "This risk might be flagged as a false positive if the trust boundary designated as 'network-on-prem' is not a controlled data center environment (e.g., an office space),",
      "cwe": "1355",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "51_sec1.ts",
      "bsiCode": "INF.5",
      "id": "inadequate-physical-security-for-infrastructure-room",
      "title": "Inadequate Physical Security for Infrastructure Room or Cabinet (BSI INF.5)",
      "description": "If a room or cabinet for technical infrastructure is poorly planned, several problems can arise. Water may enter, or IT components may overheat due to solar radiation if the location is unsuitable.",
      "impact": "Inadequate physical protection can compromise Availability (e.g., through power failure, overheating, water damage), Integrity (e.g., through physical damage or tampering),",
      "action": "Ensure Adequate Physical and Environmental Protection for Infrastructure Rooms and Cabinets",
      "mitigation": "Ensure that physical locations housing IT infrastructure (represented as on-premise trust boundaries in the model) are adequately protected against environmental and physical threats.",
      "check": "Is the trust boundary representing a physical room or cabinet for technical infrastructure tagged with `@PhysicalProtection:Reviewed-Adequate`?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5: Room and Cabinet for Technical Infrastructure.",
      "cheatSheet": "See BSI IT-Grundschutz Compendium, Baustein INF.5 (2023 edition).",
      "detectionLogic": "This risk is triggered for any `TrustBoundary` of type `network-on-prem` or `network-dedicated-hoster` that lacks the `@PhysicalProtection:Reviewed-Adequate` tag.",
      "riskAssessment": "The likelihood of physical threats (like unauthorized access, environmental damage) is considered 'Likely' by default for any on-premise or dedicated hoster location where physical security has not been explicitly confirmed via the `@PhysicalProtection:Reviewed-Adequate` tag. The impact is derived from the highest Confidentiality, Integrity, and Availability ratings of all technical assets located within the trust boundary. A breach of a location housing mission-critical assets can result in a 'Very High' impact.",
      "falsePositives": "The boundary might not represent a physical infrastructure room or cabinet, or physical security might be adequate but not yet documented in the model with the specified tag.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "51_sec2.ts",
      "bsiCode": "INF.5",
      "id": "lack-of-physical-access-control-bsi-inf5",
      "title": "Lack of Physical Access Control (BSI INF.5.A3)",
      "description": "If there is no access control or no intrusion protection for rooms with technical infrastructure, or if these measures are too weak, unauthorized persons may be able to gain physical access.",
      "impact": "A successful physical breach can directly compromise Confidentiality (via theft of data-bearing devices), Integrity (via manipulation or replacement of hardware), and",
      "action": "Implement and Enforce Physical Access Control and Intrusion Protection",
      "mitigation": "Ensure that all technical assets of machine type 'physical' are located in secure environments with appropriate physical access controls (e.g., key cards, biometrics, security personnel) and intrusion detection/prevention systems (e.g., alarms, video surveillance).",
      "check": "Are all physical assets located in secure, access-controlled environments? Is access restricted and logged?",
      "asvs": "BSI IT-Grundschutz INF.5.A3 (Zutrittsregelung und -kontrolle / Access Control)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers for any in-scope technical asset with `machine: physical` that is not tagged with `@PhysicalProtection`.",
      "riskAssessment": "The likelihood is considered high if no physical protection is modeled for a physical asset. The impact is derived from the CIA requirements of the physical asset itself and the data it processes or stores.",
      "falsePositives": "The model may not be aware of all physical security controls implemented (e.g., at a cloud provider's data center or a secured on-premise location).",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "51_sec3.ts",
      "bsiCode": "INF.5",
      "id": "inadequate-ventilation-bsi-inf-5-g3",
      "title": "Inadequate Ventilation or Climate Control (BSI INF.5.G3)",
      "description": "If a room housing technical infrastructure is inadequately ventilated or its climate control (HVAC) system fails, the ambient temperature can exceed the operational limits of the installed devices. This can lead to overheating.",
      "impact": "Exceeding the permissible temperature range can cause temporary device failure (outage), reduced performance, shortened lifespan, or permanent hardware damage. This directly impacts the **Availability** of the affected technical assets and the business processes that depend on them.",
      "action": "Ensure Adequate Environmental Controls for Physical Assets",
      "mitigation": "Ensure that rooms housing critical infrastructure have appropriate climate control (HVAC) systems. Implement temperature and humidity monitoring with alerting capabilities to notify operations staff of any anomalies. Ensure regular maintenance of HVAC systems. For critical environments, consider redundant climate control units. For assets in less controlled environments, ensure sufficient passive ventilation and placement away from heat sources.",
      "check": "Is the physical location of the asset equipped with climate control? Is there environmental monitoring (temperature, humidity) in place? Are there alerts for out-of-bounds conditions? Is there a maintenance plan for the HVAC system?",
      "asvs": "Not applicable, as this is a physical environmental risk. The relevant BSI IT-Grundschutz Baustein is INF.5: Room and Cabinet Air Conditioning.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_and_cabinet_air_conditioning_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any in-scope technical asset specified as a 'physical' machine that is not explicitly tagged as being in a controlled environment like '@Environment:DataCenter' or '@Environment:ServerRoom'. The absence of such a tag, or the presence of a tag like '@Environment:Office', implies a higher risk of inadequate climate control.",
      "riskAssessment": "The likelihood is higher for assets in environments not designed as data centers (e.g., office closets, uncontrolled spaces). The impact is directly proportional to the 'Availability' requirement of the asset and the services relying on it. A 'mission-critical' physical server failing has a much higher impact than an archive server.",
      "falsePositives": "A physical machine might be located in a well-ventilated, climate-controlled room even if it's not explicitly tagged as such in the model. The model may lack the necessary environmental details. This risk often highlights a need for more detail in the model's physical deployment description.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "51_sec4.ts",
      "bsiCode": "INF.5",
      "id": "fire-in-technical-infrastructure-room-inf5",
      "title": "Fire in Technical Infrastructure Room or Cabinet (BSI INF.5, Section 2.4 \\",
      "description": "A room or cabinet for technical infrastructure can be severely damaged or completely destroyed by a fire, causing the business processes or specialized tasks that depend on it to fail.",
      "impact": "A fire can lead to the partial or total destruction of technical assets, resulting in extended downtime and failure of dependent business processes. This directly impacts the Availability of systems and the Integrity of data, which may be corrupted or lost. In the worst case, physical destruction can lead to permanent data loss.",
      "action": "Implement Physical Fire Protection Measures",
      "mitigation": "Install professional fire detectors and a fire alarm system connected to a constantly manned office. Use a suitable fire suppression system (e.g., inert gas).",
      "check": "Are there fire/smoke detectors and a fire alarm system in place? Is a suitable fire suppression system installed? Are walls/doors/windows fire- and smoke-resistant? Is smoking prohibited? Are electrical installations regularly inspected? Are brand loads minimized?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Raum sowie Schrank für technische Infrastruktur), esp. Section 2.4 \\",
      "cheatSheet": "https://www.bsi.bund.de/EN/Themen/Unternehmen-und-Organisationen/Informationssicherheit/it-grundschutz/it-grundschutz-kompendium/it-grundschutz-kompendium_node.html",
      "detectionLogic": "Triggered for in-scope technical assets that (a) run on physical machines or (b) reside inside an on-premises trust boundary (e.g., server/infra room).",
      "riskAssessment": "Impact scales with the asset’s Availability/Integrity requirements. Mission-critical assets imply 'Very High' impact.",
      "falsePositives": "A risk may be flagged if physical fire protection measures exist but are not documented via the `@Control:fire-protection-present` tag.",
      "cwe": "730",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "51_sec5.ts",
      "bsiCode": "INF.5",
      "id": "flooding-in-infrastructure-room-con4",
      "title": "Flooding in Infrastructure Room (BSI CON.4 / INF.2)",
      "description": "Flooding within a room for technical infrastructure can cause water damage to the components operated there as well as to the room itself.",
      "impact": "The primary impact is a loss of availability for the technical assets within the affected room due to physical damage, short circuits, or subsequent corrosion.",
      "action": "Implement Physical and Environmental Controls against Water Damage",
      "mitigation": "Infrastructure rooms should be located in areas not prone to flooding (e.g., not in basements in flood zones). Install water detectors connected to an alarm system.",
      "check": "Is the location of the infrastructure room assessed for flood risk? Are water detectors installed? Are water-carrying pipes avoided or secured? Is building maintenance (e.g., roof, drainage) regularly performed?",
      "asvs": "BSI IT-Grundschutz INF.2: Building, Requirement INF.2.A11 Dealing with Water Hazards",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Building_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any physical or virtual technical asset located within a trust boundary that represents a physical infrastructure room.",
      "riskAssessment": "The impact is determined by the highest availability and integrity requirements of the technical assets within the room. A room containing mission-critical systems will have a 'Very High' impact.",
      "falsePositives": "This risk may be a false positive if the 'room' is located in a facility with certified, advanced environmental protections against water damage that are not captured in the model,",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "51_sec6.ts",
      "bsiCode": "INF.5",
      "id": "power-failure-in-infrastructure-room-inf2.g0.1",
      "title": "Power Failure in Infrastructure Room (BSI INF.2 G 0.1)",
      "description": "If the power supply to a room with technical infrastructure fails, multiple electrical components are usually affected.",
      "impact": "A power failure primarily impacts the availability of all systems within the affected physical space, leading to business process interruptions.",
      "action": "Ensure Redundant Power Supply and Environmental Controls",
      "mitigation": "Implement a multi-layered approach to power redundancy. An Uninterruptible Power Supply (UPS) should be used to bridge short-term outages and ensure a clean power supply.",
      "check": "Is there a UPS protecting the assets in the room? Is there a long-term power redundancy solution like a generator? Are environmental controls (e.g., cooling) also on redundant power? Are these systems regularly tested?",
      "asvs": "BSI IT-Grundschutz INF.2 Rechenzentrum sowie Server- und Technikraum (Data Center, Server Room, and Technical Room), Threat G 0.1 Ausfall der Stromversorgung (Power Supply Failure)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_2_Rechenzentrum_sowie_Server_und_Technikraum_Edition_2023.pdf?__blob=publicationFile (German)",
      "detectionLogic": "This risk is raised for any trust boundary representing a physical location (like an on-premise network or dedicated hoster) that contains technical assets but is not explicitly tagged as having power redundancy mitigations (like a UPS or generator).",
      "riskAssessment": "The likelihood of a power outage is considered 'likely' in many regions without specific mitigations. The impact is directly related to the availability requirements of the technical assets within the affected room. If mission-critical assets are present, the impact is very high, as their failure could halt core business functions.",
      "falsePositives": "The model might not accurately reflect the physical reality. A trust boundary could be a logical grouping rather than a single physical room with one power source. Also, mitigations might exist but are not documented with the specified tags in the model.",
      "cwe": "404",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "51_sec7.ts",
      "bsiCode": "INF.5",
      "id": "overvoltage-from-indirect-lightning-inf2",
      "title": "Overvoltage due to Indirect Lightning Strike (BSI INF.2)",
      "description": "In addition to the effects of a direct lightning strike, overvoltage spikes can also occur several hundred meters from the point of impact due to the inductive effect of indirect lightning.",
      "impact": "An overvoltage event can cause malfunctions or the complete failure of physical hardware. This directly compromises the Availability of the affected assets and any services, applications, or data they host or provide.",
      "action": "Implement and Maintain a Multi-Layered Surge Protection Concept",
      "mitigation": "A comprehensive surge protection concept should be implemented. This includes installing appropriate Surge Protection Devices (SPDs) at the building's power entry point (Type 1), at main and sub-distribution boards (Type 2), and close to sensitive terminal equipment (Type 3).",
      "check": "Is there a documented and implemented surge protection concept for all facilities housing physical IT assets? Are appropriate SPDs installed at critical points (building entry, distribution boards, near equipment)?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.2 (Rechenzentrum), Threat G 0.4 (Überspannung), and Requirement INF.2.A21 (Einsatz von Überspannungsschutzeinrichtungen).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_2_Rechenzentrum_Edition_2023.pdf?__blob=publicationFile (German BSI INF.2)",
      "detectionLogic": "This risk is raised for all in-scope technical assets of machine type 'physical' that are not located within a cloud environment (where the provider is assumed to manage this risk).",
      "riskAssessment": "The likelihood is considered 'Likely' for any unprotected physical asset in a susceptible location (i.e., not in the cloud). The likelihood is reduced if basic surge protection is in place and can be considered mitigated with a comprehensive solution.",
      "falsePositives": "This risk may be a false positive if a comprehensive, state-of-the-art surge protection system exists but has not been documented in the model using the `@SurgeProtection` tag.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "51_sec8.ts",
      "bsiCode": "INF.5",
      "id": "electromagnetic-interference",
      "title": "Electromagnetic Interference (EMI)",
      "description": "Electromagnetic fields can be emitted from sources of interference, such as elevator motors, powerful transmission systems, or discharge from lightning protection systems.",
      "impact": "Successful exploitation of this physical vulnerability by an EMI source leads to the malfunction or failure of affected hardware.",
      "action": "Shielding and Physical Protection against EMI",
      "mitigation": "Protect sensitive hardware by using shielded racks, shielded cables (e.g., STP instead of UTP), and ensuring proper electrical grounding.",
      "check": "Review the physical placement of hardware. Are sensitive assets located near potential EMI sources? Are shielded racks, enclosures, and cables in use where necessary?",
      "asvs": "BSI IT-Grundschutz: INF.5 Room for technical infrastructure",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_for_technical_infrastructure_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers for any in-scope technical asset running on physical, virtual, or containerized machines that is tagged with `@EMI-Source-Nearby`.",
      "riskAssessment": "The impact of this risk is determined by the **Availability** rating of the affected technical asset. A higher availability requirement (e.g., 'mission-critical') results in a higher impact.",
      "falsePositives": "This risk is based on the modeler's assessment of the physical environment. A false positive can occur if an asset is tagged but is, in reality, adequately shielded or the EMI source is weaker than assumed. The rule cannot validate the physical effectiveness of countermeasures.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "51_sec9.ts",
      "bsiCode": "INF.5",
      "id": "electrostatic-discharge-damage-inf-5-a8",
      "title": "Electrostatic Discharge (ESD) Damage (BSI INF.5 – Sections 2.9 / A8)",
      "description": "Uncontrolled electrostatic discharges can damage or destroy devices with sensitive electronic components, particularly in rooms or cabinets for technical infrastructure. This can lead to unreliable operation or complete failure of the affected equipment.",
      "impact": "Damage from ESD compromises the **Availability** of physical technical assets. This can disrupt business processes, cause data loss if assets fail during operations, and lead to significant hardware replacement costs.",
      "action": "Implement ESD Protection Measures in Physical Environments",
      "mitigation": "Implement comprehensive ESD protection measures in all areas housing physical hardware. This includes using conductive/anti-static flooring or mats, ensuring proper grounding of equipment racks, controlling ambient humidity, and using anti-static wrist straps and tools when handling sensitive components. All personnel working with physical hardware must be trained in ESD-safe procedures. Components should be stored and transported in anti-static packaging.",
      "check": "Are ESD protection measures (e.g., conductive/anti-static flooring, wrist straps, humidity control) in place in rooms or cabinets housing physical hardware? Is personnel trained in ESD safety? Are these measures regularly audited?",
      "asvs": "BSI IT-Grundschutz Baustein INF.5: Raum sowie Schrank für technische Infrastruktur (Abschnitt 2.9 / Anforderung A8)",
      "cheatSheet": "https://www.bsi.bund.de/",
      "detectionLogic": "This risk is triggered for any 'physical' technical asset located within a trust boundary representing a physical data center or on-premises location. The risk is elevated for non-redundant assets.",
      "riskAssessment": "The impact is directly related to the availability requirement of the physical asset and whether it is redundant. A non-redundant, mission-critical physical server suffering an ESD event has a very high impact. The likelihood is considered 'likely' by default for any physical asset in such an environment to ensure the risk is explicitly addressed, as ESD is an ever-present physical threat.",
      "falsePositives": "This risk can be considered a false positive if the physical location has comprehensive, audited ESD protection measures in place that are accurately reflected in the model. It may also not apply to hardware specifically designed to be resistant to ESD.",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "52_sec1.ts",
      "bsiCode": "INF.6",
      "id": "archive-room-environment-and-access-inf6",
      "title": "Datenträgerarchiv: Environmental & Physical Controls (BSI INF.6)",
      "description": "Datenträgerarchive (archive rooms for media) host physical storage media such as disks in servers/SAN/NAS and @Backup:Target tapes, but may also include non-digital media.",
      "impact": "Compromised environmental or physical controls can corrupt data (integrity), interrupt services (availability), and—through unauthorized access or theft—expose information (confidentiality).",
      "action": "Secure and properly operate the Datenträgerarchiv (media archive room).",
      "mitigation": "Provide and maintain suitable hand fire extinguishers; strictly regulate and control access with adequate mechanical resistance (e.g., DIN EN 1627 RC2–RC3 as appropriate); protect against dust and enforce no-smoking;",
      "check": "Is there a designated archive room with documented access control and mechanical resistance? Are fire extinguishers present and maintained? Are windows closed/doors locked policies enforced?",
      "asvs": "N/A (application security scope). This concerns physical/environmental controls covered by BSI IT-Grundschutz INF.6 and ISO/IEC 27001:2022 (e.g., Annex A.7/A.8).",
      "cheatSheet": "BSI IT-Grundschutz INF.6: Datenträgerarchiv (Kompendium).",
      "detectionLogic": "Approximates INF.6 by flagging non-serverless datastores on physical, virtual, or container machines.",
      "riskAssessment": "Impact is derived from the datastore’s Integrity and Availability ratings; long-term archives raise the minimum impact.",
      "falsePositives": "May be a false positive if the on-premises location is a certified data center or purpose-built archive with documented environmental monitoring, access control, alarm system, sealed windows/doors, and leak detection.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "52_sec2.ts",
      "bsiCode": "INF.6",
      "id": "unlocked-data-archive",
      "title": "Unlocked Data Archive (Physical Security Negligence)",
      "description": "If employees do not close or lock the doors and windows of a data carrier archive after leaving, physical data media or other information can be stolen or accessed without authorization.",
      "impact": "Theft of or unauthorized access to physical data media can lead to a direct compromise of sensitive information, violating its Confidentiality and Integrity.",
      "action": "Enforce and Audit Physical Access Control Procedures",
      "mitigation": "Implement strict physical access controls for the data archive, including logged access, secure locks on all entry points (doors, windows), and potentially surveillance systems.",
      "check": "Are there formal procedures for securing the data archive? Are doors and windows equipped with appropriate, functioning locks? Is physical access logged and restricted to authorized personnel? Are employees trained on these procedures? Are regular physical security audits performed?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.6 (Data Carrier Archive), specifically Requirements INF.6.A2 (Access control and monitoring) and INF.6.A4 (Closed windows and locked doors).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Data-carrier_archive_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any 'datastore' asset that is hosted on a 'physical' machine and is explicitly tagged as a physical archive (@Archive:Physical).",
      "riskAssessment": "The likelihood is considered 'likely' due to the high potential for human error in manual security procedures.",
      "falsePositives": "This risk might be a false positive if the model does not capture compensating controls, such as automated locking systems, 24/7 on-site security personnel, or if the archive is located within another highly secured physical zone (which should be modeled as a nested trust boundary).",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "52_sec3.ts",
      "bsiCode": "INF.6",
      "id": "insufficient-physical-access-control",
      "title": "Insufficient Physical Access Control",
      "description": "If physical access controls to a data carrier archive or data center are missing or insufficient, unauthorized persons can enter the premises.",
      "impact": "Unauthorized physical access can lead to theft of hardware, data media, or sensitive documents. It can also result in tampering with systems and data, or the installation of malicious hardware/software.",
      "action": "Implement and Enforce Physical Access Controls",
      "mitigation": "Implement a layered physical security strategy for all locations housing critical assets. This includes locked doors, access control systems (e.g., key cards, biometrics), visitor logging, security personnel, and surveillance systems.",
      "check": "Are all data centers, server rooms, and data archives protected by effective physical access controls? Is access restricted to authorized personnel only? Is there a process for managing and auditing physical access?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Physical and environmental security), Requirement CON.3.A2 (Securing offices, rooms, and facilities) and CON.3.A10 (Access control).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Physical_and_environmental_security_edition_2023.pdf?__blob=publicationFile (BSI CON.3)",
      "detectionLogic": "This risk is triggered for any in-scope, physical (non-virtual/container/serverless) technical assets of type 'datastore' (or similar technologies like file servers and mainframes) that are not explicitly marked as having physical access controls.",
      "riskAssessment": "The likelihood of an attempt is considered 'likely' for any unprotected physical asset, as insider threats or determined external attackers are always a possibility.",
      "falsePositives": "This risk may be a false positive if robust physical controls exist but have not been documented in the model via the 'mitigation:physical-access-control' tag.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "53_sec1.ts",
      "bsiCode": "INF.7",
      "id": "inadequate-physical-access-control-inf2.a5",
      "title": "Inadequate Physical Access Control (BSI INF.2.A5)",
      "description": "If physical access controls are missing or insufficient, unauthorized persons can enter an office space or data center and steal sensitive data, steal devices, or tamper with them. This can compromise the Availability, Confidentiality, or Integrity of devices and information. Even if no immediate damage is apparent, business operations can be disrupted, for example, by the need to investigate how such an incident was possible and whether any damage or tampering occurred.",
      "impact": "Failure to implement adequate physical access controls can lead to theft or manipulation of hardware and data, directly impacting the Confidentiality, Integrity, and Availability of the system. This can result in service disruptions, data breaches, and significant investigative overhead.",
      "action": "Implement and Enforce Physical Access Controls",
      "mitigation": "Ensure that all physical locations housing IT assets (e.g., data centers, server rooms, offices with workstations) have adequate access controls. This includes locked doors, electronic access control systems (e.g., key cards), reception staff, and a documented visitor policy. Access rights should follow the principle of least privilege. The effectiveness of these controls should be regularly reviewed. Tag the on-premises trust boundary or the specific physical asset with 'physical-security:adequate-access-control' to document that this has been implemented.",
      "check": "Are all access points to areas containing physical IT assets secured? Is there a documented visitor and access-control policy? Are access logs maintained and reviewed?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.2: Building and area management, Requirement INF.2.A5 (Access control for areas).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Building_and_area_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any in-scope technical assets of the machine type 'physical' that are located within a trust boundary of type 'network-on-prem'. The risk can be mitigated by applying the 'physical-security:adequate-access-control' tag to either the asset itself or its containing on-premises trust boundary.",
      "riskAssessment": "The likelihood of an unauthorized access attempt is considered 'likely' if basic physical controls are missing for on-premise assets. The impact is determined by the highest CIA requirement of the physical asset and the data it processes or stores. An asset processing 'Strictly Confidential' data or being 'Mission-Critical' for operations will result in a very high impact.",
      "falsePositives": "This risk may be a false positive if physical access controls exist but are not documented in the model via the specified tag. Verification requires a physical inspection or review of the organization's physical security policies.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "53_sec2.ts",
      "bsiCode": "INF.7",
      "id": "unfavorable-work-environment-inf5",
      "title": "Unfavorable Work Environment (BSI INF.7)",
      "description": "A non-ergonomic office space or an unfavorable work environment can prevent employees from working without distractions or from using the provided IT optimally.",
      "impact": "Failure to maintain a suitable work environment can lead to human error, resulting in the corruption of data (Integrity) or systems being used incorrectly (Availability).",
      "action": "Ensure Ergonomic and Distraction-Free Work Environment",
      "mitigation": "Workspaces for personnel should be designed to be ergonomic and minimize environmental distractions like noise, high traffic, and poor lighting/ventilation.",
      "check": "Are workspaces designed to minimize distractions from noise and traffic? Is there adequate and appropriate lighting and ventilation for IT use?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.7: Büroarbeitsplatz (Office Workspace)",
      "cheatSheet": "BSI IT-Grundschutz Baustein INF.7: Büroarbeitsplatz (overview)",
      "detectionLogic": "This is a physical/organizational risk. It is raised for technical assets that are likely used by humans in an on-premises office environment.",
      "riskAssessment": "The likelihood is rated as 'Likely' because poor ergonomics or distractions are common issues in many work environments.",
      "falsePositives": "This risk is highly dependent on the actual physical conditions of the workspace, which cannot be determined from the model alone.",
      "cwe": "20",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "53_sec3.ts",
      "bsiCode": "INF.7",
      "id": "uncontrolled-physical-access-by-visitors",
      "title": "Uncontrolled Physical Access by Visitors or External Personnel (BSI INF.2)",
      "description": "In office environments, visitors, cleaning staff, or other external personnel might gain uncontrolled access to internal areas.",
      "impact": "If uncontrolled physical access occurs, it can lead to the compromise of confidentiality (information disclosure), integrity (data or system manipulation), and availability (theft, damage, DoS) of assets located within the physical premises. This can result in data breaches, business process disruption, and financial loss.",
      "action": "Implement and Enforce a Visitor and External Personnel Management Policy",
      "mitigation": "Establish clear rules for all non-employees entering the premises. This includes maintaining a visitor log, enforcing an escort policy for all visitors in sensitive areas, and providing identification badges.",
      "check": "Is there a formal policy for managing visitors and external personnel? Are visitors required to sign in and be escorted? Are employees trained on clean desk and screen-locking policies? Are regular checks performed to ensure compliance?",
      "asvs": "BSI IT-Grundschutz INF.2.A12 (Regulation of the presence of external persons)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Rooms_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for all technical assets located within a trust boundary of type 'Network On-Premise'.",
      "riskAssessment": "The likelihood is considered 'Likely' by default, assuming that without specific physical controls (which cannot be modeled), an incident is probable over time.",
      "falsePositives": "This risk is procedural and environmental. An organization might have excellent physical security controls (e.g., locked server rooms, strict escort policies) that are not visible in the threat model.",
      "cwe": "284 // Improper Access Control",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "53_sec4.ts",
      "bsiCode": "INF.7",
      "id": "physical-manipulation-or-destruction",
      "title": "Physical Manipulation or Destruction of IT Systems and Data Carriers (BSI INF.2)",
      "description": "Attackers may attempt to manipulate or destroy IT systems, accessories, and other data carriers for various reasons. The effectiveness of such attacks increases with delayed detection, the perpetrator's level of knowledge, and the severity of the impact on work processes.",
      "impact": "Consequences can include unauthorized access to sensitive data (e.g., via stolen hard drives), destruction of data carriers or entire IT systems, and significant operational downtime and process limitations.",
      "action": "Implement Physical and Environmental Security Controls",
      "mitigation": "Protect IT systems and data carriers through physical access controls (e.g., locked rooms, racks), environmental controls (e.g., fire suppression), surveillance, and secure disposal procedures for media. Ensure that hardware and software integrity is monitored. Implement and regularly test backup and recovery strategies to restore service after destruction or manipulation.",
      "check": "Are sensitive IT systems and data carriers located in physically secured areas with controlled access? Are there procedures for secure hardware lifecycle management, including disposal? Are regular, tested backups available for all critical systems?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.2 (Physical and Environmental Security), specifically addressing threats like T 0.14 'Destruction of devices or data media' and T 0.17 'Manipulation of hardware or software'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Physical_and_environmental_security_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all in-scope technical assets that are not serverless (i.e., of machine type 'physical' or 'virtual'). These assets have a physical component that is susceptible to manipulation or destruction. The likelihood is considered higher for 'physical' machines than for 'virtual' ones, as the latter have an additional layer of abstraction (the hypervisor host) protecting them.",
      "riskAssessment": "The likelihood is higher for directly accessible physical machines. The impact is directly derived from the Availability, Integrity, and Confidentiality ratings of the technical asset and the data it stores or processes. A mission-critical system being destroyed has a 'very-high' impact.",
      "falsePositives": "This risk is generated based on the logical machine type. It cannot account for the actual physical security measures implemented in the deployment environment (e.g., a highly-secured data center). Therefore, the risk must be validated against the real-world security posture.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "53_sec5.ts",
      "bsiCode": "INF.7",
      "id": "theft-of-it-equipment-inf5",
      "title": "Theft of IT Equipment (BSI INF.5)",
      "description": "As IT devices become more portable, it is easier to steal them. The theft of data carriers, IT systems, or accessories incurs costs for replacement and restoration of operational capacity.",
      "impact": "The primary impact of theft is the potential for a severe confidentiality breach if the data on the device is unencrypted.",
      "action": "Implement Physical Security Controls and Enforce Data-at-Rest Encryption",
      "mitigation": "Physically secure all IT equipment, especially portable devices like laptops and mobile phones (e.g., using cable locks, locked cabinets).",
      "check": "Are all IT assets, especially portable ones, physically secured when unattended? Are server rooms and sensitive areas access-controlled?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Protection against unauthorized access) and Threat G 0.14 (Theft of equipment, storage media, or documents).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Protection_against_unauthorized_access_edition_2023.pdf?__blob=publicationFile (BSI INF.5)",
      "detectionLogic": "This rule checks for technical assets that are physical or client-type devices (like laptops, mobile devices) and lack data-at-rest encryption.",
      "riskAssessment": "The impact of this risk is directly related to the confidentiality and availability requirements of the data stored on the stolen device.",
      "falsePositives": "The model might not capture all physical security controls. An asset might be flagged as at risk, but in reality, it could be located in a highly secure, access-controlled environment, reducing the likelihood of theft.",
      "cwe": "311",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "53_sec6.ts",
      "bsiCode": "INF.7",
      "id": "improper-cabling-inf7",
      "title": "Improper Cabling / Tripping Hazard (BSI INF.7)",
      "description": "Cables for power and data networks might be laid across rooms and walkways, especially if outlets are inconveniently located.",
      "impact": "If this risk materializes, IT equipment can be physically damaged, leading to a loss of Availability.",
      "action": "Implement proper cable management for office workspaces",
      "mitigation": "Ensure that all power and data cables are managed properly. Use cable ducts, conduits, or cable bridges to protect cables running across floors.",
      "check": "Are there any cables running across walkways in areas with physical IT assets? Are cable management solutions like ducts, bridges, or trays in use?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.7 (Büroarbeitsplatz), specifically requirement INF.7.A3 (Fliegende Verkabelung),",
      "cheatSheet": "BSI IT-Grundschutz Baustein INF.7 (Büroarbeitsplatz), insbesondere INF.7.A3 (Fliegende Verkabelung).",
      "detectionLogic": "This is a physical risk that applies to on-premises environments. The rule triggers for any technical asset that is explicitly modeled as a 'physical' machine",
      "riskAssessment": "The likelihood is considered 'likely' for any identified physical asset in an on-premises environment, as improper cabling is a common oversight.",
      "falsePositives": "This risk might be a false positive if the 'physical' asset is located in a professional data center with raised floors and proper under-floor cabling,",
      "cwe": "404",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "54_sec1.ts",
      "bsiCode": "INF.8",
      "id": "insufficient-telework-regulations",
      "title": "Insufficient Regulations for Home Office / Teleworking (BSI INF.8)",
      "description": "Since a home office is located outside the organization's direct physical and network boundaries, employees are largely on their own.",
      "impact": "Failure to establish and enforce clear teleworking security policies can compromise the Confidentiality, Integrity, and Availability of information.",
      "action": "Establish and Enforce Clear Home-Office / Telework Security Policies",
      "mitigation": "Develop, document, and enforce a comprehensive security policy for all teleworking personnel. This policy should cover: secure remote access (e.g., mandatory VPN), handling and storage of physical and digital sensitive data at home, physical security of the workspace (lockable room/containers), use of private vs. company-provided devices, secure transfer/transport and disposal of documents and media, and defined procedures for IT support and incident response.",
      "check": "Is there a formal, documented security policy for home offices? Do employees receive training on this policy? Are procedures for remote support, secure transport and disposal of information, and incident response clearly defined and reviewed when household conditions change?",
      "asvs": "BSI IT-Grundschutz INF.8: Häuslicher Arbeitsplatz",
      "cheatSheet": "BSI Grundschutz-Kompendium – Baustein INF.8 „Häuslicher Arbeitsplatz“",
      "detectionLogic": "This risk is triggered for any technical asset that represents a client system (e.g., Desktop, Mobile App, Browser) that is internet-facing and communicates across a trust boundary with internal, non-internet-facing assets.",
      "riskAssessment": "The likelihood of exploitation is considered 'Likely' if teleworking setups exist without modeled mitigations (like specific policies being confirmed). The impact is determined by the highest sensitivity (CIA) of the data assets accessed by the teleworking client. Accessing 'Strictly Confidential' data from a home office poses a 'High' or 'Very High' impact.",
      "falsePositives": "This risk may be a false positive if the organization has strong, enforced teleworking policies that are not reflected in the threat model. The model identifies the technical potential for the risk; its actual existence depends on organizational controls.",
      "cwe": "668",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "54_sec2.ts",
      "bsiCode": "INF.8",
      "id": "unauthorized-physical-access-home-office-con.3.a15",
      "title": "Unauthorized Physical Access to Home Office (BSI CON.3.A15)",
      "description": "Rooms in a home office where sensitive information is stored/processed or sensitive equipment is kept become areas requiring protection.",
      "impact": "Unauthorized physical access can lead to theft of equipment, direct access to unlocked sessions, shoulder surfing, or installation of malicious hardware/software,",
      "action": "Implement and Enforce Physical Security Measures for Home Office Environments",
      "mitigation": "Define and enforce physical security policies for home offices. This includes secure storage for devices and documents (e.g., locked cabinets),",
      "check": "Are there defined policies for physical security in home offices? Are employees trained on these policies? Are technical measures like full-disk encryption and automatic screen locks enforced on assets used for teleworking?",
      "asvs": "BSI IT-Grundschutz Baustein CON.3 (Physical environmental security), Requirement CON.3.A15 (Physical access to teleworking and mobile working areas). This is a physical security risk and not directly covered by OWASP ASVS.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Physical_environmental_security_edition_2023.pdf?__blob=publicationFile (BSI CON.3)",
      "detectionLogic": "This risk is triggered for any in-scope technical asset that is explicitly tagged with `@Location:HomeOffice` and processes or stores data of at least `Restricted` confidentiality or `Important` integrity/availability.",
      "riskAssessment": "The likelihood is considered `Likely` due to the inherently less controlled nature of a home environment compared to a corporate office.",
      "falsePositives": "This risk can be considered a false positive only if the asset tagged with `@Location:HomeOffice` is used in a dedicated, professionally secured, and lockable room with controls that mirror a corporate environment. This status requires explicit justification and evidence.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "54_sec3.ts",
      "bsiCode": "INF.8",
      "id": "unsuitable-telework-environment-con3.g1",
      "title": "Unsuitable Telework Environment (BSI CON.3.G1)",
      "description": "A non-ergonomic or disruptive home office environment (e.g., due to noise, interruptions from family members, poor lighting, or poor ventilation) can prevent undisturbed work, hinder the optimal use of IT equipment, introduce errors, and reduce the protection of data. Confidentiality can also be at risk due to shoulder surfing or overheard conversations in non-private spaces.",
      "impact": "This can lead to reduced productivity, increased human error, and compromised data integrity as employees make mistakes or fail to follow security procedures correctly. Confidentiality can also be compromised, leading to data breaches, non-compliance with legal or contractual requirements, and subsequent financial or reputational damage.",
      "action": "Establish and Enforce Telework Security Policies",
      "mitigation": "Define and enforce clear policies for telework environments, including requirements for a private, distraction-free workspace, especially when sensitive data is handled. Provide ergonomic guidelines and security best practices for home offices (e.g., use of privacy screens, secure document storage, rules for smart home devices). Raise employee awareness about the risks of working in public or shared spaces. Provide necessary equipment like privacy screens or noise-cancelling headsets where appropriate.",
      "check": "Are there clear, communicated policies for teleworking? Do these policies address environmental security (privacy, distractions)? Are employees trained on these policies? Is there a process to assess or attest to the suitability of telework environments for handling sensitive information?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Telework), Gefährdung CON.3.G1 (Unsuitable conditions at the teleworkplace).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Telework_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This environmental risk is difficult to detect automatically. This rule triggers for any in-scope client-type assets (e.g., Browser, Desktop, Mobile App) that are used by humans, or any asset explicitly tagged as a '@telework-client'. The assumption is that these assets are used in a home office or remote setting which may not meet organizational security standards.",
      "riskAssessment": "The likelihood is rated as 'Likely' by default, assuming a baseline risk for any remote work. The impact scales with the Confidentiality and Integrity of the data processed by the teleworking user on the affected asset. An error made on a system processing 'Strictly-Confidential' or 'Mission-Critical' data has a very high impact.",
      "falsePositives": "This risk is environmental and depends on an individual's actual home office setup. The model can only flag assets used for telework as potentially being at risk. The actual risk level can only be confirmed by assessing the individual teleworkplaces or through organizational policies and employee attestations.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "54_sec4.ts",
      "bsiCode": "INF.8",
      "id": "insecure-data-transport-to-home-office-con3",
      "title": "Insecure Data Transport to Mobile/Home Office (BSI CON.3)",
      "description": "When documents, data carriers, or files are transported between the institution and a mobile or home office, this data and information can be lost.",
      "impact": "The loss of unique data originals without a backup can disrupt business processes (Availability). If unencrypted data carriers fall into the wrong hands, it can lead to a severe loss of Confidentiality.",
      "action": "Secure Physical Transport and Storage of Data on Mobile Assets",
      "mitigation": "Ensure all mobile assets (laptops, mobile devices) used for work have full-disk encryption enabled.",
      "check": "Is there a defined policy for mobile work and data transport? Are mobile assets like laptops required to have full-disk encryption enabled?",
      "asvs": "BSI IT-Grundschutz CON.3 Mobile Workplace & CON.4 Data Media Management",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_workplace_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for technical assets typical of mobile or remote work (e.g., 'Desktop', 'MobileApp', 'ClientSystem') that process or store data.",
      "riskAssessment": "The impact of this risk is directly related to the confidentiality, integrity, and availability requirements of the data stored on the mobile asset.",
      "falsePositives": "The model might identify a 'Desktop' asset as mobile, when in fact it is permanently located within a secure corporate facility.",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "54_sec5.ts",
      "bsiCode": "INF.8",
      "id": "improper-disposal-of-media-at-home-office",
      "title": "Improper Disposal of Media at Home Office (based on BSI)",
      "description": "If it is not possible to dispose of data carriers and documents appropriately in the home office,",
      "impact": "Improper disposal of media containing sensitive information can lead to severe breaches of confidentiality and integrity.",
      "action": "Establish and Enforce Secure Media Disposal Procedures for Remote Work",
      "mitigation": "Implement a clear policy for the secure disposal of all media (paper documents, USB drives, hard drives, CDs/DVDs, etc.)",
      "check": "Is there a documented policy for media disposal at home offices? Are employees provided with the necessary tools (e.g., shredders)?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 'Löschen und Vernichten' (Deletion and Destruction).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Deletion_and_destruction_of_data_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.6)",
      "detectionLogic": "This risk is identified for technical assets tagged as being used in a home office environment (e.g., via an `@Location:HomeOffice` tag),",
      "riskAssessment": "The likelihood is high if no formal disposal procedures for remote work exist. The impact is directly related to the",
      "falsePositives": "This risk might be a false positive if the organization has strong, enforced remote work policies for media disposal that are not",
      "cwe": "459",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "54_sec6.ts",
      "bsiCode": "INF.8",
      "id": "physical-tampering-or-destruction-at-home-office",
      "title": "Physical Tampering or Destruction at a Home Office",
      "description": "IT devices, accessories, information, and software used at a home office may be more easily manipulated or destroyed than within the institution's premises.",
      "impact": "If IT devices, accessories, information, or software are manipulated or destroyed, employees at the home office may have their ability to work significantly restricted (Availability).",
      "action": "Implement and Enforce Physical Security Policies for Home Office Environments",
      "mitigation": "Establish clear and enforceable security policies for home offices. This should include guidelines for the secure storage of devices and documents when not in use (e.g., in lockable cabinets), mandatory screen locking, and awareness about shoulder surfing.",
      "check": "Are there defined policies for physical security at home offices? Are employees trained on these policies? Is full disk encryption enabled and enforced on all mobile and home-office devices?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3: Mobile device usage. While not a perfect one-to-one match, the principles of securing devices outside a controlled corporate environment are highly relevant.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_device_usage_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to any technical asset that is used in a less controlled physical environment, such as a home office.",
      "riskAssessment": "The likelihood is considered 'Likely' due to the inherently reduced physical controls in a home environment compared to a corporate office.",
      "falsePositives": "This risk is generated based on the declared location of the asset. It cannot assess the actual physical security measures implemented by an individual employee in their specific home office.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "54_sec7.ts",
      "bsiCode": "INF.8",
      "id": "physical-theft-of-it-from-home-office",
      "title": "Physical theft of unencrypted IT equipment in the home office (BSI context)",
      "description": "Home-office environments are typically less physically secure than corporate offices, which often have measures such as access control systems and guards. This increases the risk of burglary and theft of company-issued IT equipment.",
      "impact": "Theft of an unencrypted device can directly compromise confidentiality and availability. Attackers could access sensitive corporate or customer data, trade secrets, and personal information. This information might be sold to competitors, used for extortion, or publicly leaked, resulting in significant financial losses, reputational damage, and legal or regulatory penalties.",
      "action": "Enable full-disk encryption and strong authentication on all devices used in the home office",
      "mitigation": "All IT equipment used outside secured corporate premises, especially in home offices, MUST be protected by full-disk encryption (e.g., BitLocker, FileVault).",
      "check": "Is the technical asset protected with full-disk encryption? Is strong authentication enforced? Is there a documented procedure and a technical capability to remotely wipe a stolen device?",
      "asvs": "BSI IT-Grundschutz Compendium reference: CON.1 Mobile device management; CON.3 Cryptographic methods. This scenario reflects common risks associated with teleworking described in BSI publications.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Mobile_device_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies client systems (laptops, desktops) used in a home-office environment (tagged '@Location:HomeOffice') that lack data-at-rest encryption. The absence of encryption on a portable, physically exposed device is a critical vulnerability.",
      "riskAssessment": "While targeted theft is hard to model, opportunistic theft is always possible. The likelihood is therefore considered 'Likely'.",
      "falsePositives": "This may be a false positive if the asset, although unencrypted, is confirmed to never store or process sensitive data (i.e., only public information). However, this is rare and risky for any corporate asset.",
      "cwe": "311",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "55_sec1.ts",
      "bsiCode": "INF.9",
      "id": "insufficiently-regulated-mobile-work",
      "title": "Insufficiently Regulated Mobile Work (based on BSI)",
      "description": "If mobile work is not, or is insufficiently, regulated, the institution may suffer financial and other damage.",
      "impact": "Failure to adequately secure mobile work and remote access can lead to the compromise of confidential data,",
      "action": "Define and Enforce a Secure Mobile Work Policy",
      "mitigation": "Establish a clear policy for mobile and remote work that specifies mandatory technical safeguards.",
      "check": "Is there a documented policy for mobile work? Does it mandate the use of VPNs or other encrypted communication for accessing sensitive data?",
      "asvs": "BSI IT-Grundschutz CON.3 Mobile Working",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_working_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for communication links that originate from a client asset likely used for mobile work",
      "riskAssessment": "The impact is determined by the confidentiality level of the data being transmitted.",
      "falsePositives": "This risk can be a false positive if other compensating controls that are not modeled exist,",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "55_sec2.ts",
      "bsiCode": "INF.9",
      "id": "physical-environmental-threats-mobile-devices-sys2-3",
      "title": "Physical and Environmental Threats to Mobile Devices (BSI SYS.2.3)",
      "description": "Since mobile end devices (laptops, tablets, smartphones) are used in very different and often uncontrolled environments, they are exposed to many threats.",
      "impact": "Successful exploitation of these threats can directly impact the Availability of the device (if damaged or lost), the Integrity of its data and the systems it connects to (if infected with malware), and the Confidentiality of its stored information (if lost or stolen).",
      "action": "Implement Physical and Technical Protections for Mobile Devices",
      "mitigation": "A combination of physical, technical, and organizational controls is required. Use protective cases and train users on safe transport and handling.",
      "check": "Are mobile devices physically protected (e.g., with cases)? Is full-disk encryption enforced on all mobile clients?",
      "asvs": "BSI IT-Grundschutz SYS.2.3 Clients under special conditions of use",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_3_Clients_under_special_conditions_of_use_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset identified as a client-type device (e.g., `mobile-app`, `desktop`/`laptop`).",
      "riskAssessment": "The likelihood of exposure is inherently high for portable devices. The impact scales with the CIA rating of the device and the data it processes or stores.",
      "falsePositives": "The risk may be a false positive if a device, although technically a 'client', is used exclusively in a physically secure, controlled environment (e.g., a kiosk in a locked server room).",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "55_sec3.ts",
      "bsiCode": "INF.9",
      "id": "manipulation-or-destruction-of-mobile-systems-con3",
      "title": "Manipulation or Destruction of Mobile IT Systems (BSI CON.3.G18)",
      "description": "IT systems, accessories, information, and software used in a mobile context may be more easily manipulated or destroyed than those on the institution's premises. Mobile workplaces are often accessible to third parties and may lack the institution's central security measures, such as front desk/security services.",
      "impact": "If IT systems, accessories, information, or software are manipulated or destroyed, an employee's ability to work at the mobile workplace can be severely limited. Furthermore, destroyed IT components or software may need to be replaced, requiring significant financial resources and time. This directly affects the integrity and availability of the systems and associated data.",
      "action": "Implement Physical and Technical Security Measures for Mobile Devices",
      "mitigation": "Utilize physically robust devices. Implement technical safeguards such as full-disk encryption (e.g., BitLocker, FileVault), strong authentication (passwords, biometrics), and remote wipe capabilities. Employees should be trained on situational awareness to protect devices in public spaces. Use secure carrying cases. When unattended, devices should be stored securely (e.g., in a locked room or safe).",
      "check": "Are mobile devices physically protected? Is full-disk encryption enforced? Is strong authentication required? Is a remote wipe solution in place? Are employees trained on securing their devices outside the office?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 'Mobiles Arbeiten', specifically relating to the elementary threat G 0.18 'Manipulation oder Zerstörung mobiler IT-Systeme'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobiles_Arbeiten.html",
      "detectionLogic": "This risk applies to any technical asset identified as a client system used in a mobile context. The tool identifies these assets based on their technology type (e.g., MobileApp, Desktop, ClientSystem, IoTDevice). The risk is raised because these devices, by their nature, operate outside the primary physical security perimeter of the organization.",
      "riskAssessment": "The likelihood is higher for devices that are frequently used in public or unsecured locations. The impact is directly related to the Integrity and Availability requirements of the device itself and the data it handles. Manipulation or destruction of a device with mission-critical data or function will have a 'Very High' impact, while the same event for a less critical device has a lower impact.",
      "falsePositives": "This risk may be a false positive if a device, although technically 'mobile' (e.g., a laptop), is exclusively used in a physically secure, non-public environment (like a locked home office) that is considered equivalent to the main office premises. This context is typically not captured in the technical model and requires manual assessment.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "55_sec4.ts",
      "bsiCode": "INF.9",
      "id": "delayed-information-flow-due-to-mobile-work",
      "title": "Delayed Information Flow due to Mobile Work (BSI INF.9)",
      "description": "Mobile employees often have flexible working hours and can be difficult to reach while traveling, which can significantly delay information flow.",
      "impact": "The temporarily limited availability of employees can severely restrict the availability of crucial information, impacting business processes that rely on timely decisions or data access.",
      "action": "Establish Clear Communication Protocols and SLAs for Mobile Work",
      "mitigation": "Define clear expectations and Service Level Agreements (SLAs) for response times from mobile workers.",
      "check": "Are there defined policies for mobile work communication? Are response time SLAs in place? Are there escalation procedures or deputy rules for time-sensitive tasks assigned to mobile workers?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium INF.9 Mobiler Arbeitsplatz. This is an organizational process risk related to Availability and does not directly map to a specific ASVS requirement.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/sys/SYS_3_2_2_Mobiler_Arbeitsplatz_Edition_2023.pdf?__blob=publicationFile (BSI INF.9)",
      "detectionLogic": "This organizational risk is triggered for any in-scope technical asset tagged 'WorkModel:Mobile'.",
      "riskAssessment": "The likelihood is situational but assumed to be likely if no specific communication SLAs for mobile work are in place.",
      "falsePositives": "This risk can be considered a false positive if the organization has effective, compensating controls in place (e.g., strict SLAs, automated escalation, robust deputy arrangements) that are not captured in the technical model.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "55_sec5.ts",
      "bsiCode": "INF.9",
      "id": "insecure-transport-of-data-to-mobile-workplaces",
      "title": "Insecure Transport of Data or Media to Mobile Workplaces (BSI CON.6)",
      "description": "When documents, data carriers, or files are transported between an institution and mobile workplaces,",
      "impact": "The consequences of insecure transport can be severe, leading to financial damage.",
      "action": "Ensure Secure Data Transport Channels and Protocols",
      "mitigation": "All data transport to mobile or external clients must occur over encrypted and authenticated channels.",
      "check": "Review all communication links that cross trust boundaries to client-type assets.",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Transport of ICT components and data carriers), specific threat 'Loss or theft of data carriers or files during transport'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Transport_of_ICT_components_and_data_carriers_edition_2022.pdf?__blob=publicationFile&v=2 (BSI CON.6)",
      "detectionLogic": "This risk is triggered by communication links that transfer data from within a trust boundary to a client-type technical asset (e.g., mobile app, browser, desktop) located outside of it.",
      "riskAssessment": "The likelihood is high if data is sent over an unencrypted protocol. The impact is determined by the highest Confidentiality, Integrity, and Availability rating of the data assets being transferred.",
      "falsePositives": "A risk might be flagged as a false positive if there are compensating controls modeled,",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "55_sec6.ts",
      "bsiCode": "INF.9",
      "id": "improper-disposal-of-media-con4",
      "title": "Improper Disposal of Data Media at Mobile Workplaces (BSI CON.4)",
      "description": "If it is not possible to dispose of data carriers (e.g., printouts, notes, old USB drives) appropriately at a mobile workplace, they often end up in regular household or public waste bins, or are left behind in hotels or on trains.",
      "impact": "The consequences of improper disposal range from loss of knowledge and confidentiality to existential threats to the institution, for example if important contracts are not concluded or partnerships fail as a result of the information leak.",
      "action": "Implement and Enforce Secure Disposal Procedures for Mobile Workplaces",
      "mitigation": "Establish clear, communicated procedures for the secure disposal of all sensitive information, both digital and physical, for mobile and remote workers.",
      "check": "Are there clear, documented guidelines for disposing of documents and data carriers from mobile workplaces?",
      "asvs": "BSI IT-Grundschutz CON.4: Vernichtung und Entsorgung (Destruction and Disposal), especially Requirement CON.4.A5 (Geeignete Entsorgung von schützenswerten Informationen). Also relates to SYS.3.3 (Mobiler Arbeitsplatz).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_4_Vernichtung_und_Entsorgung_Edition_2023.pdf?__blob=publicationFile (BSI CON.4)",
      "detectionLogic": "Raise a risk for any technical asset that: (1) is a mobile workplace (has the '@MobileWorkplace:true' tag or is a client-type technology) and (2) processes or stores data with confidentiality 'Restricted' or higher.",
      "riskAssessment": "Likelihood: 'Likely' for mobile clients handling sensitive data due to frequent ad-hoc work environments.",
      "falsePositives": "May be a false positive if the organization enforces and audits secure disposal for mobile/remote locations (e.g., mandated return-to-office destruction, certified shredding services, locked disposal containers, awareness training with attestation).",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "55_sec7.ts",
      "bsiCode": "INF.9",
      "id": "unauthorized-access-mobile-workplace-con3",
      "title": "Unauthorized Information Access at the Mobile Workplace (BSI INF.9)",
      "description": "At a mobile workplace, unauthorized third parties can more easily access confidential information stored on devices (e.g., hard drives, removable media) or eavesdrop on communication links, especially when acting professionally. This can have severe consequences for the entire institution.",
      "impact": "An unauthorized disclosure of information (loss of confidentiality) can lead to legal or contractual violations, competitive disadvantages, and significant financial or reputational damage.",
      "action": "Implement Data Protection Measures for Mobile Workplaces",
      "mitigation": "Protect data at rest on mobile devices using strong, full-disk or file-based encryption (e.g., BitLocker, FileVault, LUKS). Protect data in transit by using exclusively encrypted communication protocols (e.g., HTTPS, WSS, FTPS) and/or a mandatory VPN for all connections into corporate or cloud networks. Enforce policies regarding the use of removable media and user awareness for physical security.",
      "check": "Are mobile devices' local storage encrypted by default? Are all communication channels from mobile clients to backend services encrypted? Is a VPN enforced for access to internal resources? Are there policies and training regarding physical security of mobile devices?",
      "asvs": "BSI IT-Grundschutz INF.9 Mobile Workplace",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_workplace_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies technical assets that function as mobile or client workplaces (e.g., Mobile App, Desktop Client, IoT Device). It then checks for two conditions: 1. The storage of sensitive data on the device without asset-level encryption being enabled. 2. The use of unencrypted communication protocols to transmit sensitive data from or to the device.",
      "riskAssessment": "The impact of the risk is determined by the confidentiality of the data at risk (stored or transmitted). The likelihood is considered high if protective measures like encryption are missing. The overall severity is a result of this combination.",
      "falsePositives": "A risk might be a false positive if other compensating controls that are not modeled in Threagile exist, such as an OS-level policy that transparently encrypts all storage, or if a device is used exclusively within a physically secure, trusted network.",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "55_sec8.ts",
      "bsiCode": "INF.9",
      "id": "physical-loss-or-theft-of-mobile-workstation",
      "title": "Physical Loss or Theft of Mobile Workstation (BSI CON.3.A1)",
      "description": "Mobile workstations are not as well physically secured as workstations within a company or government agency's premises.",
      "impact": "In addition to the material damage from the immediate loss of the mobile IT system, further financial damage can occur if sensitive data such as e-mails, meeting notes, addresses, or other documents are disclosed.",
      "action": "Implement Physical and Technical Safeguards for Mobile Devices",
      "mitigation": "To mitigate the risk of data disclosure from lost or stolen devices, all mobile workstations must use full-disk encryption (FDE).",
      "check": "Are all mobile devices (laptops, tablets, smartphones) managed under an MDM? Is full-disk encryption enforced on all mobile devices?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein CON.3: Mobiler Arbeitsplatz, Requirement CON.3.A1 Diebstahl oder Verlust von mobilen Endgeräten.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobiler_Arbeitsplatz_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for all in-scope technical assets that are identified as physical client devices.",
      "riskAssessment": "The likelihood of a mobile device being lost or stolen is considered 'Likely' due to the nature of mobile work.",
      "falsePositives": "A technical asset might be flagged that, while technically a mobile device (e.g., a laptop), is used exclusively in a physically secure, static location (e.g., permanently docked in a secure office).",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "56_sec1.ts",
      "bsiCode": "ISMS.1",
      "id": "unclear-security-roles-and-responsibilities",
      "title": "Unclear Security Roles and Responsibilities (BSI ORP.1)",
      "description": "If roles and responsibilities within the security process are not clearly defined, many employees may neglect or deny their responsibility for information security, often deferring to higher management levels. As a consequence, necessary security measures are not implemented, as they almost always represent additional effort in the usual workflow.",
      "impact": "Failure to implement security measures due to unclear responsibilities creates vulnerabilities. This can lead to the compromise of confidentiality, integrity, or availability of critical assets, disrupt business processes, and result in security incidents and data breaches.",
      "action": "Clearly Define and Communicate Security Roles and Responsibilities",
      "mitigation": "Establish a formal information security organization with clearly defined roles (e.g., CISO, ISO, asset owners, technical administrators). Document the specific responsibilities for each role regarding information security. Ensure these roles and responsibilities are communicated effectively to all relevant personnel and are integrated into standard operational procedures. Assign clear ownership for all critical technical assets.",
      "check": "Is there a documented security organization? Are roles and responsibilities for information security clearly defined, assigned, and communicated? Do all critical technical assets have a designated owner or responsible administrator identified?",
      "asvs": "BSI IT-Grundschutz ORP.1: Information security organisation (specifically ORP.1.A1 Establishing an information security organisation and ORP.1.A2 Defining roles and responsibilities)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This is an organizational risk that can be detected by proxy within the technical model. The rule checks for high-value technical assets (based on their CIA rating) that lack a clearly assigned responsible role (i.e., are not tagged with any 'role:*' tag). The absence of a role tag on a critical asset implies that responsibilities for it may be unclear.",
      "riskAssessment": "The impact is determined by the CIA requirements of the technical asset for which responsibilities are unclear. A high-value asset without a clear owner poses a significant risk. The likelihood is considered high, as neglect of security duties is a common consequence of unclear responsibilities.",
      "falsePositives": "This risk can be a false positive if roles are managed outside of the threat model's tagging system. The model might simply be incomplete. Verification with the organization's role and responsibility matrix is required.",
      "cwe": "285",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "56_sec2.ts",
      "bsiCode": "ISMS.1",
      "id": "lack-of-management-support-for-security-orp1.a1",
      "title": "Lack of Management Support for Information Security (BSI ORP.1.A1)",
      "description": "If security officers do not receive unrestricted support from the institution's management, it can be difficult to enforce necessary security measures. This is particularly challenging when dealing with individuals who are hierarchically superior to the security officers. In such cases, the information security process cannot be fully implemented.",
      "impact": "A lack of management support undermines the entire information security process. Necessary security controls may be underfunded, bypassed, or ignored, leading to a weak security posture. This increases the likelihood of security incidents, potentially compromising the Confidentiality, Integrity, and Availability (CIA) of all assets, leading to data breaches, operational disruptions, financial loss, and reputational damage.",
      "action": "Establish and Demonstrate Clear Management Commitment to Information Security",
      "mitigation": "Management must visibly and actively support the information security strategy. This includes allocating sufficient resources (budget, personnel), approving security policies, empowering security roles (like the CISO or @Role:ITSecurityOfficer), and holding all personnel accountable for security. Management's commitment should be regularly communicated throughout the organization to foster a strong security culture.",
      "check": "Is there a documented information security policy approved by management? Are security roles clearly defined, empowered, and resourced? Does management regularly review the state of information security? Is security a topic in management meetings?",
      "asvs": "BSI IT-Grundschutz Kompendium: ORP.1.A1 Management responsibility for information security",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
      "detectionLogic": "This is an organizational risk that arises from a potential disconnect between management and security functions. This rule triggers if the threat model contains assets tagged with both a management role ('@Role:Management') and a security officer role ('@Role:ITSecurityOfficer'). When this condition is met, the risk is raised against all high-value technical assets, as they are the most likely to be affected by a failure to implement or enforce security controls.",
      "riskAssessment": "The likelihood is considered 'likely' by default, as a lack of explicit support is a persistent organizational vulnerability. The impact is calculated based on the Confidentiality, Integrity, and Availability (CIA) ratings of the affected assets. The failure to enforce security measures on a mission-critical system has a much higher impact than on a system processing public data.",
      "falsePositives": "This risk is an inference based on the presence of roles in the model. The actual level of management support is an organizational factor that cannot be fully determined from a technical model. The risk should be validated by reviewing internal policies, meeting minutes, and the effective power of the security team within the organization.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "56_sec3.ts",
      "bsiCode": "ISMS.1",
      "id": "isms1-unsupported-security-management",
      "title": "ISMS.1 – Unsupported Security Management",
      "description": "Das Sicherheitsmanagement (ISMS) existiert zwar auf dem Papier, ist jedoch organisatorisch nicht verankert: Rollen sind unklar, Ressourcen fehlen, die Leitlinie ist unbekannt und Sicherheitsziele werden nicht gesteuert. Dadurch werden Vorgaben ignoriert und Sicherheitsmaßnahmen bleiben Stückwerk.",
      "impact": "Fehlende Verantwortung und Ressourcen im ISMS führen zu lückenhaften Kontrollen, verspäteter Umsetzung und unkoordiniertem Incident Response. Die Folge sind erhöhte Risiken für Vertraulichkeit, Integrität und Verfügbarkeit (CIA) in besonders geschäftskritischen Assets – mit längeren Ausfällen, größerem Schaden und regulatorischen Konsequenzen.",
      "action": "ISMS sichtbar verankern: Leitung übernimmt Verantwortung, benennt Rollen, gibt Leitlinie frei, priorisiert Maßnahmen und stellt Budget/Personal bereit.",
      "mitigation": "Leitlinie beschließen und veröffentlichen, Sicherheitsziele & -strategie festlegen (mit Geltungsbereich), ISB benennen und ausstatten, Organisationsstruktur & Kommunikationswege definieren, Sicherheitskonzept(e) erstellen und pflegen, Management-Reporting etablieren, Revisionen/Wirksamkeitsprüfungen planen und dokumentieren.",
      "check": "Existiert eine freigegebene Leitlinie? Sind ISB und Rollen benannt und vertreten? Gibt es budgetierte Ressourcen & Zeit? Werden Management-Berichte erstellt (mind. jährlich) und Entscheidungen revisionssicher dokumentiert? Sind Sicherheitsmaßnahmen geplant, priorisiert, umgesetzt und überprüft?",
      "asvs": "Abgeleitet aus BSI IT-Grundschutz Kompendium 2023/2024, Baustein ISMS.1 (Sicherheitsmanagement), u. a. A1–A13 (Leitung, Leitlinie, Organisation, Sicherheitskonzept, Berichte).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/ISMS_1_Sicherheitsmanagement.pdf?__blob=publicationFile",
      "detectionLogic": "Heuristik (modellbasiert): Markiere technische Assets mit hoher Kritikalität (hohe CIA-Werte). Indizien: keine oder sehr wenige organisatorische Tags (z. B. „policy:missing“, „owner:unknown“), fehlende Zuordnung zu Sicherheitskonzepten/Leitlinien, sehr hohe Schutzbedarfe der verarbeiteten Daten (StrictlyConfidential/MissionCritical) bei zugleich fehlender Out-of-Scope-Markierung. Ergebnis: Hinweis auf mögliches fehlendes Management-Support und Ressourcenmangel.",
      "riskAssessment": "Wahrscheinlichkeit standardmäßig „Likely“, um eine organisatorische Prüfung anzustoßen. Die Auswirkung orientiert sich an den höchsten CIA-Einstufungen des betroffenen Assets und seiner Daten; bei Mission-Critical wird „Very High“ angesetzt.",
      "falsePositives": "Kein Befund, wenn Leitung sichtbar Verantwortung trägt, Rollen & Vertretungen geregelt sind, Ressourcen nachweislich ausreichen (Budget/Personen/Zeiten), Management-Berichte vorliegen und Sicherheitsmaßnahmen nach Plan umgesetzt/überprüft werden.",
      "cwe": "284",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "56_sec4.ts",
      "bsiCode": "ISMS.1",
      "id": "inadequate-management-reporting-and-oversight",
      "title": "Inadequate Management Reporting and Oversight",
      "description": "If management is not sufficiently informed about the security status of all business processes, IT systems, and applications, as well as existing deficiencies,",
      "impact": "This can result in an imbalance where some areas are over-protected while others have severe vulnerabilities.",
      "action": "Establish Clear Security Reporting and Oversight Processes",
      "mitigation": "Implement regular, clear, and comprehensive security reporting to management. This reporting should cover the current security posture, identified risks, incident statuses, and the effectiveness of security controls.",
      "check": "Is there a formal process for reporting security status to management? Does management regularly review this information? Are decisions about security resources and priorities documented and based on this reporting?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information security organisation), specifically Requirement ORP.1.A4 (Responsibility for information security).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
      "detectionLogic": "This is a high-level organizational risk. It is raised against mission-critical assets or key security controls under the assumption that a lack of management oversight could lead to their compromise due to misallocated resources or misconfiguration.",
      "riskAssessment": "The likelihood is considered 'Likely' if the organizational process for oversight is not explicitly modeled or confirmed. The impact is directly derived from the criticality of the assets that would be affected by this governance failure.",
      "falsePositives": "This risk is inherently organizational and serves as a prompt for review. An organization might have excellent oversight and reporting processes that are not visible in the technical threat model.",
      "cwe": "16",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "56_sec5.ts",
      "bsiCode": "ISMS.1",
      "id": "lack-of-cooperation-due-to-unclear-strategy-bsi",
      "title": "Lack of Cooperation due to Unclear Security Strategy (BSI-based)",
      "description": "To achieve a consistent and appropriate level of security, different areas of responsibility within an institution must cooperate. However, a lack of strategic guidelines and unclear objectives can lead to different interpretations of the importance of information security. As a result, necessary cooperation may not occur because the task of 'information security' is considered unnecessary or not a priority, leading to security measures not being implemented.",
      "impact": "Failure to cooperate on security matters leads to security measures not being implemented or being implemented inconsistently. This can create exploitable vulnerabilities, compromising the Confidentiality, Integrity, and Availability (CIA) of the entire system, leading to business disruptions, data breaches, and non-compliance.",
      "action": "Establish and Communicate a Clear Information Security Strategy and Foster Cooperation",
      "mitigation": "Management must define, document, and actively communicate a comprehensive information security strategy and policy. This includes clear objectives, defined roles and responsibilities, and processes that encourage and require cross-departmental cooperation on security topics. The strategy's importance must be championed by leadership to ensure it receives appropriate priority across the organization.",
      "check": "Is there a documented and communicated information security strategy and policy? Are security objectives clear and understood across different departments? Are there established processes for inter-departmental collaboration on security matters?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information security organisation), specifically Requirement ORP.1.A1 'Establishing an information security strategy' and ORP.1.A2 'Establishing an information security policy'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
      "detectionLogic": "This is a high-level organizational risk that applies to the entire system. It is generated once and attached to the most critical technical asset (based on its Relative Attacker Attractiveness - RAA) to represent the point of highest potential impact from this strategic failure. The presence of this risk suggests a foundational weakness that affects all components, not just the one it's attached to.",
      "riskAssessment": "Likelihood is HIGH if a clear security strategy is missing or not communicated effectively. Impact is directly related to the overall business criticality of the system. A lack of strategy for a mission-critical system has a VERY HIGH impact, as essential controls may be missing.",
      "falsePositives": "This risk is inherently organizational and its presence cannot be confirmed by the technical model alone. The model identifies it as a potential foundational risk. Verification requires reviewing organizational documents (strategy, policies) and interviewing key personnel to assess the state of inter-departmental cooperation on security.",
      "cwe": "693",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "56_sec6.ts",
      "bsiCode": "ISMS.1",
      "id": "outdated-security-concept-due-to-missing-review",
      "title": "Outdated Security Concept Due to Missing Review Processes (BSI-aligned)",
      "description": "New business processes, applications, and IT systems, as well as new threats, constantly affect the state of information security.",
      "impact": "An outdated security concept means that security measures are no longer adequate for the evolving system or the current threat landscape.",
      "action": "Establish a Regular Security Review and Threat Awareness Process",
      "mitigation": "Implement a formal, recurring process to review and update the information security concept. This process should include:",
      "check": "Is there a documented process for regularly reviewing the information security concept? When was the last review of this system's security architecture conducted?",
      "asvs": "Derived from the BSI IT-Grundschutz-Kompendium (2023), module ORP.4 (Continual improvement process), specifically requirement ORP.4.A5 (Reviewing the effectiveness of information security).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Continual_improvement_process_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organizational risk is raised for technical assets that evolve over time, making them susceptible to an outdated security concept.",
      "riskAssessment": "The likelihood is considered high when a review process is deficient or non-existent, since systems and threats evolve constantly.",
      "falsePositives": "This risk may be a false positive if a robust, continuous security review and improvement process is in place for the identified asset,",
      "cwe": "1104",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "56_sec7.ts",
      "bsiCode": "ISMS.1",
      "id": "violation-of-legal-or-contractual-requirements",
      "title": "Legal or Contractual Non-Compliance",
      "description": "Inadequately secured information, processes, and IT systems can trigger violations of laws (e.g., GDPR/DSGVO, NIS2), industry schemes (e.g., PCI DSS, HIPAA, SOC 2/ISO 27001), or contractual clauses (e.g., DPAs, SLAs). Lack of awareness of applicable national/international regulations and contractual obligations significantly raises this risk.",
      "impact": "Non-compliance can lead to fines and sanctions, regulatory action, loss of certifications/attestations, contractual penalties or termination, litigation, mandatory disclosures, and substantial reputational harm.",
      "action": "Establish and continuously verify compliance (policy → control → evidence → audit) across assets and suppliers.",
      "mitigation": "Identify all applicable legal, regulatory, and contractual requirements; map them to concrete controls with owners and evidence; maintain data inventories and processing purposes; enforce third-party security obligations (DPAs/SLAs, right-to-audit); implement change management for regulatory updates; and run periodic internal/external audits.",
      "check": "Is there an up-to-date register of applicable laws/standards/contracts? Are they mapped to implemented controls and evidence? Are responsibilities and review cadences defined? Are vendor DPAs/SLAs in place and audited? Is compliance re-validated after system or scope changes?",
      "asvs": "BSI IT-Grundschutz: ISMS.1 (Sicherheitsmanagement) — Gefährdung 2.7; related: DER.1 (Compliance).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Compliance_edition_2023.pdf?__blob=publicationFile&v=2 (BSI DER.1, see also ISMS.1 §2.7)",
      "detectionLogic": "Raised for technical assets likely under legal/contractual obligations when ANY of the following holds: (1) Asset carries a @Compliance base tag (e.g., @Compliance:GDPR/PCI-DSS). (2) Asset processes or stores highly sensitive or mission-critical data (Strictly-Confidential confidentiality OR Mission-Critical integrity/availability). (3) Asset communicates (inbound or outbound) with an External-Entity, implying contractual terms with partners/suppliers.",
      "riskAssessment": "Likelihood defaults to Likely due to the ongoing challenge of demonstrating continuous compliance. Impact scales with the asset’s highest CIA ratings: Important → Medium, Critical → High, Mission-Critical/Strictly-Confidential → Very High. Data breach probability is escalated to Probable when impact is High or above.",
      "falsePositives": "May be a false positive when an auditable compliance program fully covers the asset (clear control mapping, owners, evidence, and recurring audits). Review and document justification if the risk is accepted or downgraded.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "56_sec8.ts",
      "bsiCode": "ISMS.1",
      "id": "chain-of-events-leading-to-major-incident",
      "title": "Chain of Events Leading to Major Incident (BSI)",
      "description": "Security incidents can arise from a chain of minor causes or unfortunate circumstances, leading to major damage. A compromise of one system can enable an attacker to move laterally and compromise subsequent, more critical systems. This risk identifies potential architectural attack paths from less-trusted environments (such as the internet) to high-value assets via one or more intermediate systems.",
      "impact": "Successful exploitation of such an attack chain can lead to severe disruption of business processes, major data breaches affecting confidentiality and integrity, loss of system availability, significant reputational damage, and violation of legal or contractual obligations.",
      "action": "Implement Defense-in-Depth and Network Segmentation",
      "mitigation": "Architect the system to minimize attack paths and prevent lateral movement. Use strong trust boundaries (e.g., firewalls, network policies, security groups) to isolate critical assets from less trusted environments. Harden all systems in the chain, not just the initial entry point. Implement robust monitoring and alerting to detect anomalous behavior at any point in the chain, allowing for early intervention.",
      "check": "Are critical assets isolated from internet-facing systems by at least one security boundary? Is lateral movement between assets in the same trust zone restricted? Is there monitoring for multi-stage attack patterns?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein DER.1 (Security Incident Management), which addresses the need to prepare for and handle complex security incidents. The risk itself represents a potential failure of defense-in-depth, a core architectural principle.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Security_incident_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule detects potential attack paths (chains of communication) from internet-exposed assets to internal assets with high confidentiality, integrity, or availability ratings. A risk is generated if a high-value asset is reachable from the internet via one or more intermediate technical assets, representing a cascading risk.",
      "riskAssessment": "The likelihood is assessed based on the existence of such an architectural path. The impact is determined by the CIA rating of the final, high-value asset in the chain. A shorter, less-segmented path poses a higher risk than a multi-layered one. The impact is directly related to the business value of the compromised target.",
      "falsePositives": "The rule might flag standard n-tier architectures. A false positive can be claimed if the intermediate communication links are strongly secured (e.g., with application-layer firewalls, strict API contracts, and fine-grained authorization) to the point where lateral movement is considered infeasible.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "56_sec9.ts",
      "bsiCode": "ISMS.1",
      "id": "inadequate-security-management-orp1",
      "title": "Inadequate Security Management (BSI ORP.1)",
      "description": "Inadequate security management can lead to incorrect priorities being set and security investments not being made in areas that provide the most value. This can result in investing in expensive technologies without foundational organizational rules (like clear responsibilities), or focusing on less critical areas while neglecting business-essential systems. This misalignment creates significant, unaddressed risks despite security spending.",
      "impact": "Misaligned security priorities can lead to severe security incidents. Resources may be wasted on ineffective controls, while critical vulnerabilities in business-essential processes remain unmitigated. This can compromise the confidentiality, integrity, and availability of key assets, disrupt core business functions, and lead to significant financial and reputational damage.",
      "action": "Establish and Maintain a Holistic Information Security Management System (ISMS)",
      "mitigation": "Implement a comprehensive Information Security Management System (ISMS) to ensure a holistic and coordinated approach to security. The ISMS should align security priorities with business objectives, clarify roles and responsibilities, perform regular risk assessments to identify critical areas, and ensure a balanced and efficient allocation of security resources. The strategy should be documented, communicated, and regularly reviewed by management.",
      "check": "Is there a documented ISMS in place? Are security priorities and investments demonstrably linked to business-criticality and risk assessments? Is there a formal process for coordinating security measures and product selections across the organization?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023: ORP.1 Information security organisation.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This is a high-level organizational risk. It cannot be definitively identified from a technical model alone. This rule generates a single, model-wide risk if the system contains any in-scope technical assets. The risk is anchored to the most critical asset found, serving as a concrete example of what is at stake if security management is inadequate.",
      "riskAssessment": "The likelihood is rated as 'Likely' by default, as a perfect ISMS is rare and misalignment is a common organizational challenge. The impact is calculated based on the highest CIA ratings of the most critical asset in the model. A system with 'Strictly Confidential' data or 'Mission-Critical' services faces a 'Very High' impact from misaligned security priorities.",
      "falsePositives": "This risk can be considered a false positive if a mature and effective ISMS is in place that demonstrably aligns security investments with business risks. Verifying this requires reviewing organizational documentation, such as the security strategy, risk assessment reports, and management review minutes.",
      "cwe": "693",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "57_sec1.ts",
      "bsiCode": "NET.1.1",
      "id": "inadequate-communication-link-performance",
      "title": "Inadequate Communication Link Performance (based on BSI threat)",
      "description": "If communication links are insufficiently dimensioned, or their performance is degraded due to technical failure or a Denial-of-Service (DoS) attack, clients may only be able to communicate with servers to a limited extent, significantly increasing access times.",
      "impact": "Services dependent on the affected link may become only partially available or completely unusable. Institution-relevant information may no longer be accessible. In severe cases, this can lead to a standstill of essential business processes or entire production lines, causing major operational disruptions.",
      "action": "Ensure adequate capacity and redundancy for communication links",
      "mitigation": "Ensure communication links are dimensioned to handle peak loads and have sufficient capacity. Implement redundant communication paths for all critical connections to mitigate single points of failure. For internet-facing links, use DoS protection services. Monitor link utilization and performance to proactively identify and address bottlenecks. Implement Quality of Service (QoS) mechanisms to prioritize critical traffic.",
      "check": "Are communication links monitored for utilization and performance? Are critical communication paths redundant? Is there a DoS protection strategy in place for internet-facing links? Has a load analysis been performed to ensure sufficient capacity?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Redundant communication links), which outlines measures to prevent availability loss from link failures.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Redundant_communication_links_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
      "detectionLogic": "This risk is raised for communication links that transfer data with high or mission-critical availability requirements, especially those crossing trust boundaries or connecting to the internet. The risk is not raised if the link is marked with the 'redundant-link-manually-confirmed' tag or is a non-network, in-process communication.",
      "riskAssessment": "The likelihood is higher for links connecting to the internet or crossing major trust boundaries, as they are more exposed to external threats and contention. The impact is directly determined by the availability requirements of the technical assets and data assets relying on the communication link. A failure of a link used by a mission-critical system has a 'Very High' impact.",
      "falsePositives": "The model may not capture all forms of network redundancy (e.g., dynamic routing protocols, multiple physical links aggregated into one logical link). The risk might be flagged even if the underlying infrastructure is resilient, but this resilience is not expressed in the model. A manual check of the network architecture is required to confirm.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "57_sec2.ts",
      "bsiCode": "NET.1.1",
      "id": "insufficient-gateway-protection",
      "title": "Insufficient Gateway Protection (BSI-Style)",
      "description": "If an internal network is connected to the Internet and the ingress point is insufficiently protected (e.g., because no dedicated firewall, WAF, or reverse proxy is used), attackers from the Internet can directly access internal systems. This allows them to potentially access, copy, or manipulate sensitive information within the internal network, bypassing perimeter defenses.",
      "impact": "Insufficient gateway protection can lead to unauthorized access to internal assets, resulting in the loss of confidentiality and integrity of processed or stored data. This can lead to severe data breaches, system compromise, and further lateral movement within the network.",
      "action": "Enforce Gateway Security Controls",
      "mitigation": "Ensure that all communication links from an internet-facing component to an internal component pass through a dedicated network security control. This can be a Reverse Proxy, a Web Application Firewall (WAF), an Intrusion Prevention System (IPS), or a dedicated API Gateway. The internal asset should not be directly exposed to traffic from the Internet.",
      "check": "Review all communication links that cross a trust boundary from the Internet into an internal network. Verify that the target of every such link is a technical asset designated as a gateway security control (like a WAF or Reverse Proxy).",
      "asvs": "V1.1.2: Security Architecture",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This rule iterates through all communication links. It identifies risks where a technical asset marked as 'internet-facing' communicates directly with an asset that is not 'internet-facing' (i.e., an internal asset), crossing a trust boundary. A risk is raised if the internal receiving asset is not a recognized gateway or security technology (like a WAF, Reverse Proxy, Gateway, etc.) and if the communication involves data of at least 'restricted' confidentiality or 'important' integrity.",
      "riskAssessment": "The likelihood is considered high because a direct attack path from the Internet to an internal, non-hardened system exists. The impact is determined by the maximum confidentiality and integrity of the data assets transferred over the unprotected link. A direct connection involving 'strictly confidential' data poses a 'very high' impact.",
      "falsePositives": "This might be a false positive if a compensating control that is not modeled exists, such as a cloud provider's firewall (e.g., AWS Security Group, Azure NSG) that is implicitly protecting the asset. However, for a robust threat model, such controls should ideally be modeled as part of a trust boundary.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "57_sec3.ts",
      "bsiCode": "NET.1.1",
      "id": "insecure-network-topology-net1.1",
      "title": "Insecure Network Topology (BSI NET.1.1)",
      "description": "If a network is improperly built or incorrectly extended, insecure network topologies or configurations can arise.",
      "impact": "An insecure network topology significantly increases the risk of lateral movement for an attacker who has gained an initial foothold.",
      "action": "Implement Secure Network Segmentation and Monitoring",
      "mitigation": "Design and implement a segmented network architecture (e.g., using nested trust boundaries in the model to represent DMZs,",
      "check": "Review the threat model's trust boundaries. Are assets with different purposes (e.g., web servers, application servers, databases)",
      "asvs": "BSI IT-Grundschutz NET.1.1 (Network Architecture and Design)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_1_Network_architecture_and_design_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule inspects network-type trust boundaries. It triggers a risk if a boundary represents a 'flat network'",
      "riskAssessment": "The impact is determined by the highest CIA rating of any asset within the insecure network boundary.",
      "falsePositives": "A model might oversimplify a network that is, in reality, properly segmented by underlying infrastructure not fully detailed in the model.",
      "cwe": "501",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "58_sec1.ts",
      "bsiCode": "NET.1.2",
      "id": "compromise-of-network-management-solution",
      "title": "Compromise of Network Management Solution (BSI NET.1.2)",
      "description": "If an attack succeeds in accessing network management solutions, for example through unpatched security vulnerabilities or insufficient network separation, all connected network components can be controlled and reconfigured. This can lead to access to sensitive information, redirection of network traffic, or even sustained disruption of the entire network.",
      "impact": "Successful exploitation allows an attacker to control and reconfigure all connected network components. This can lead to unauthorized access to sensitive information (Confidentiality breach), redirection or manipulation of network traffic (Integrity breach), and sustained disruption of the entire network (Availability breach / Denial of Service).",
      "action": "Harden and Isolate Network Management Solutions",
      "mitigation": "Network management solutions must be conceptually treated as highly critical assets. They should be hardened according to best practices, including regular patching and vulnerability management. Access must be strictly controlled using multi-factor authentication and the principle of least privilege. Crucially, the management solution and its traffic should be isolated in a dedicated, restricted network segment (management VLAN/VPN) separate from production and user networks. All access to and from the management solution should be logged and monitored for anomalies.",
      "check": "Is the network management solution running in a dedicated, isolated network segment? Is access strictly limited to authorized administrators via secure channels? Is the system hardened and consistently patched? Are all administrative actions logged and monitored?",
      "asvs": "BSI NET.1.2 (Protection of network management), OWASP ASVS V4.0.3 - 1.1.2 (Secure Network Architecture), OWASP Top 10 2021: A05-Security Misconfiguration",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_2_Protection_of_network_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies technical assets that function as network or system management solutions based on their technology type (e.g., Monitoring, ContainerPlatform, ServiceMesh, WAF, LoadBalancer, etc.). A risk is raised if such a solution has outgoing communication links to manage other assets, as it represents a central point of control. The risk is considered higher if the management asset is exposed to less trusted environments (e.g., the Internet) or has a broad scope of control.",
      "riskAssessment": "The impact is calculated based on the highest Confidentiality, Integrity, and Availability of all technical assets managed by the solution. A compromise of a system managing mission-critical assets has a 'Very High' impact. The likelihood is considered 'Likely' by default and elevated to 'Very Likely' if the management solution is exposed to the Internet or consists of custom-developed parts, which implies a higher chance of vulnerabilities.",
      "falsePositives": "A risk might be a false positive if the identified asset is not used for management purposes, or if there are strong, unmodeled compensating controls like a physically separate management network or strict host-based firewalls.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "58_sec2.ts",
      "bsiCode": "NET.1.2",
      "id": "compromise-of-network-component",
      "title": "Compromise of a Network Component (BSI-style)",
      "description": "Based on a BSI-style threat: If an attacker succeeds in accessing an individual network component (such as a load balancer, reverse proxy, or gateway), the component can be controlled and manipulated. All data traffic routed through it can be compromised (eavesdropped on or tampered with). Furthermore, the compromised component can be used as a stepping stone to launch further attacks and penetrate deeper into the network.",
      "impact": "Successful exploitation leads to loss of confidentiality and integrity for all data traffic passing through the component. It enables man-in-the-middle attacks, session hijacking, and may facilitate lateral movement, significantly expanding an attacker's foothold within the architecture. This can result in major data breaches and system-wide compromise.",
      "action": "Harden Network Components and Monitor Traffic",
      "mitigation": "Apply security hardening baselines to all network components. Change default credentials immediately. Keep firmware and software patched and up-to-date. Implement strong, multi-factor authentication for management interfaces. Restrict access to management interfaces to a dedicated, secured management network. Employ network segmentation to limit the blast radius. Monitor traffic and component logs for anomalous activity.",
      "check": "Are default credentials for network devices changed? Are all component software and firmware regularly patched? Is access to management interfaces restricted (e.g., via firewall rules, jump hosts)? Is multi-factor authentication used for administrative access? Is network traffic to and from the component monitored for signs of compromise?",
      "asvs": "V14.2 Network and Platform Configuration",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for all in-scope technical assets that act as network infrastructure components, such as load balancers, reverse proxies, gateways, and service meshes. The severity is determined by the sensitivity of the data passing through the component and its exposure to the internet.",
      "riskAssessment": "The impact is calculated based on the highest confidentiality and integrity of data assets on all connected communication links. A higher impact is assigned if the data is confidential or critical. The likelihood is considered higher for components that are directly exposed to the internet, as they are more accessible targets for attackers.",
      "falsePositives": "This risk may be a false positive if extensive hardening measures are in place (e.g., hardware security modules, protected out-of-band management networks) but are not represented in the model.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "58_sec3.ts",
      "bsiCode": "NET.1.2",
      "id": "unprotected-network-management-communication",
      "title": "Unprotected Network Management Communication",
      "description": "If network management communication is eavesdropped upon and manipulated, active network components can be misconfigured or controlled.",
      "impact": "An attacker exploiting this vulnerability can intercept credentials, manipulate network traffic, reconfigure critical network components to disrupt service (Denial of Service), or pivot deeper into the infrastructure (Elevation of Privilege).",
      "action": "Encrypt Network Management Traffic",
      "mitigation": "Ensure all communication links used for management, monitoring, or other DevOps purposes utilize strong, encrypted protocols (e.g., SSH, HTTPS, LDAPS, FTPS, WSS, SNMPv3).",
      "check": "Review all communication links with a 'devops' usage designation. Verify that the protocol is encrypted or that the link is protected by a VPN.",
      "asvs": "V14.2.1 (ASVS 4.0.3) / 13.2.1 (ASVS 5.0): Data-in-transit is encrypted and authenticated using a secure protocol.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for any communication link marked with `usage: devops` that is not using an encrypted protocol and is not explicitly protected by a VPN.",
      "riskAssessment": "The likelihood is considered high, especially for links crossing trust boundaries. The impact is determined by the criticality (CIA ratings) of the target asset being managed.",
      "falsePositives": "This risk might be a false positive if the link is protected by other compensating controls not modeled, such as a physically isolated and secured management network which is considered fully trusted.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "58_sec4.ts",
      "bsiCode": "NET.1.2",
      "id": "insufficient-time-synchronization-ops1-1-5",
      "title": "Insufficient Time Synchronization (BSI OPS.1.1.5.A14)",
      "description": "If the system time of components—especially those used for infrastructure management and security monitoring—is not synchronized, correlating log data from different sources becomes difficult or impossible. Inconsistent timestamps can lead to incorrect event analysis, hindering incident response and forensic investigations.",
      "impact": "The inability to correlate events across systems hampers incident response, troubleshooting, and forensic analysis. Security incidents, data exfiltration, or coordinated attacks might go undetected or be misinterpreted, leading to prolonged system compromise, delayed remediation, and an inability to reliably prove what occurred.",
      "action": "Implement and Enforce Time Synchronization via NTP",
      "mitigation": "All relevant systems should be configured to synchronize their time with a reliable and consistent time source (e.g., using NTP - Network Time Protocol). Use internal, tiered NTP servers for on-premises networks and provider-managed time services in the cloud. Ensure firewall rules permit NTP traffic between clients and servers. Regularly monitor the time synchronization status of all critical components. Use the 'ntp-configured' tag on assets where this control is confirmed.",
      "check": "Are all technical assets configured to use a central, reliable time source (NTP)? Is the time synchronization status monitored? Can log entries from different systems be reliably correlated by timestamp?",
      "asvs": "BSI IT-Grundschutz-Kompendium: OPS.1.1.5.A14 Zeit-Synchronisation (Time synchronization)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Logging_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for all in-scope, server-side or infrastructure-related technical assets that do not have the 'ntp-configured' tag. Accurate time is fundamental for logging, which is critical for nearly all backend components. The risk is suppressed for client-side technologies and embedded libraries, where local time is less critical for cross-system event correlation.",
      "riskAssessment": "The likelihood is considered 'likely' when the control is not explicitly modeled, as misconfigurations are common. The impact is derived from the asset's Integrity and Availability ratings, because time synchronization is crucial for investigating issues related to both (e.g., data tampering or service outages). A higher CIA rating results in a higher impact.",
      "falsePositives": "This risk can be a false positive if time synchronization is implemented and managed at an underlying layer (e.g., by the cloud provider or via OS deployment images) but not explicitly tagged in the model. To remediate this finding, apply the 'ntp-configured' tag to the asset.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "59_sec1.ts",
      "bsiCode": "NET.2.1",
      "id": "@Network:WLAN-interference-or-jamming-bsi-net3.2",
      "title": "@Network:WLAN Interference or Jamming (BSI NET.3.2)",
      "description": "In wireless networks, information is transmitted using electromagnetic radio waves.",
      "impact": "Disruption or complete failure of wireless communication leads to a loss of availability for the @Network:WLAN and any assets or business processes that depend on it.",
      "action": "Secure @Network:WLAN Configuration and Monitoring",
      "mitigation": "To mitigate unintentional interference, perform site surveys to plan channel allocation and access point placement to avoid overlapping frequencies with other powerful sources.",
      "check": "Is there a WIPS in place to detect jamming and other wireless attacks? Are Protected Management Frames (802.11w) enabled on the @Network:WLAN?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium Baustein NET.3.2 Wireless LAN.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Wireless_LAN_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any communication link that is explicitly tagged as a wireless connection (e.g., using the `@Network:WLAN` tag).",
      "riskAssessment": "The likelihood of unintentional interference is considered 'Likely' in dense environments with many competing wireless devices.",
      "falsePositives": "This risk might be a false positive if the @Network:WLAN is operated in a specially shielded environment (e.g., a Faraday cage) or if highly specialized, military-grade anti-jamming technology is in use,",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "59_sec10.ts",
      "bsiCode": "NET.2.1",
      "id": "@Network:WLAN-hardware-damage-bsi-con-3",
      "title": "Hardware Damage to @Network:WLAN Components (BSI CON.3)",
      "description": "Hardware damage can disrupt wireless traffic, and in the worst-case scenario, the @Network:WLAN can fail completely.",
      "impact": "Physical damage to @Network:WLAN components primarily impacts Availability, leading to service disruption or complete failure.",
      "action": "Physically Protect Exposed @Network:WLAN Hardware",
      "mitigation": "@Network:WLAN components in exposed locations (outdoors, public areas) should be installed in physically secure, weather-resistant, and vandal-proof enclosures.",
      "check": "Are @Network:WLAN devices in exposed locations physically protected by appropriate enclosures? Is there protection against environmental factors like weather and lightning?",
      "asvs": "Derived from BSI IT-Grundschutz Compendium CON.3: Wireless LAN (@Network:WLAN)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Wireless_LAN_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified for any technical asset explicitly marked as a `@Network:WLAN-Component` that is also tagged as being in an exposed location with `@PhysicalLocation:Outdoor`.",
      "riskAssessment": "The likelihood of damage is considered high for any component tagged as being outdoors, as this is the explicit vulnerability condition.",
      "falsePositives": "A technical asset might be tagged as being outdoors but could be installed inside a highly durable, vandal-proof, and weather-proof enclosure.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "59_sec11.ts",
      "bsiCode": "NET.2.1",
      "id": "stolen-@Network:WLAN-access-point",
      "title": "Theft of a @Network:WLAN Access Point (BSI NET.3.2.A4)",
      "description": "If a @Network:WLAN Access Point (AP) is installed in an unsecured, publicly accessible area, it can be physically stolen.",
      "impact": "Extracting credentials from a stolen AP allows an attacker to gain unauthorized access to the wireless network.",
      "action": "Secure Physical Installation of Access Points",
      "mitigation": "Physically secure all @Network:WLAN Access Points, especially those in public or semi-public areas, using anti-theft enclosures, security cables, or by installing them in concealed locations (e.g., above a ceiling).",
      "check": "Are @Network:WLAN Access Points located in public areas physically secured against theft? Are sensitive credentials stored on the APs kept to a minimum and protected? Is there a documented process for decommissioning and disposing of network hardware?",
      "asvs": "BSI IT-Grundschutz NET.3.2 Wireless LAN, Threat NET.3.2.A4 Theft of an Access Point.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Wireless_LAN_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any `technical_asset` of type `physical` that is tagged with both `@component:@Network:WLAN-access-point` and `@location:public-area`.",
      "riskAssessment": "The likelihood is considered high if a physical AP is located in a public area without any modeled compensating controls.",
      "falsePositives": "This risk might be a false positive if the asset is tagged as being in a `@location:public-area` but is, in reality, inside a locked cabinet, behind a permanently locked door, or otherwise physically secured in a way not captured by the threat model. The model abstracts physical security into a simple location tag.",
      "cwe": "522",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "59_sec2.ts",
      "bsiCode": "NET.2.1",
      "id": "inadequate-@Network:WLAN-planning",
      "title": "Inadequate @Network:WLAN Planning (based on BSI NET.2.1)",
      "description": "Errors in planning information technology deployments often prove to be particularly serious because they can easily create widespread security vulnerabilities.",
      "impact": "Poor @Network:WLAN planning can lead to the compromise of data confidentiality through eavesdropping on unencrypted or weakly encrypted traffic.",
      "action": "Develop and Implement a Comprehensive @Network:WLAN Security and Deployment Concept",
      "mitigation": "A formal @Network:WLAN concept should be created before deployment. This concept must specify the use of strong, state-of-the-art encryption and authentication protocols (e.g., WPA3 with a strong pre-shared key or, preferably, WPA3-Enterprise with 802.1X/EAP-TLS).",
      "check": "Is there a documented @Network:WLAN security and deployment plan? Does it mandate strong encryption (WPA2/WPA3) and forbid outdated protocols?",
      "asvs": "BSI IT-Grundschutz NET.2.1 @Network:WLAN Operation (see also NET.2.2 @Network:WLAN Use)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_WLAN_use_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers risks for any communication link tagged as `@Network:WLAN-transport` that does not use an encrypted application-layer protocol (like HTTPS, FTPS, etc.).",
      "riskAssessment": "The likelihood of exploitation is considered high if sensitive data is transmitted without application-level encryption over a @Network:WLAN, as an attacker only needs to gain access to the wireless medium.",
      "falsePositives": "This risk may be a false positive if the underlying @Network:WLAN transport is stringently secured using mechanisms not visible in the model, such as WPA3-Enterprise with mandatory EAP-TLS and robust network segmentation.",
      "cwe": "326",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "59_sec3.ts",
      "bsiCode": "NET.2.1",
      "id": "unauthorized-wlan-access-point",
      "title": "Unauthorized WLAN Access Point Connected to the Internal Network",
      "description": "If an employee connects an unauthorized or insecurely configured wireless access point to an internal network segment, it can lead to severe security problems.",
      "impact": "A rogue access point compromises the network perimeter, exposing internal systems and data to unauthorized access.",
      "action": "Implement Network Access Control and Prohibit Unauthorized Hardware",
      "mitigation": "Implement technical controls like IEEE 802.1X Network Access Control (NAC) on all network switch ports to prevent unauthorized devices from gaining network access.",
      "check": "Are network access controls (like 802.1X) implemented on all user-accessible network ports? Are there regular, automated scans for rogue wireless access points? Is there a clear, communicated policy against connecting unauthorized devices?",
      "asvs": "V13.1.2: Verify that internal network segments containing sensitive data are separated from other network segments using firewalls and logical access controls.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
      "detectionLogic": "This risk is identified by detecting direct communication links from assets in untrusted or internet-facing zones to assets in trusted, internal network boundaries,",
      "riskAssessment": "The likelihood is considered 'Likely' if network ports are not physically or technically secured (e.g., via NAC), as this allows employees or attackers with physical access to connect unauthorized devices.",
      "falsePositives": "This rule might trigger a false positive if the model legitimately depicts a direct, highly privileged connection across network boundaries (e.g., a secure administrative tunnel) that is not explicitly modeled as a typical perimeter service.",
      "cwe": "501",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "59_sec4.ts",
      "bsiCode": "NET.2.1",
      "id": "insufficient-authentication-mechanisms",
      "title": "Weak or Missing Authentication Mechanisms",
      "description": "If authentication methods and mechanisms for communication links are missing or insufficient,",
      "impact": "Exploitation of weak or missing authentication can lead to unauthorized access, data breaches, and session hijacking.",
      "action": "Enforce Strong, Encrypted Authentication",
      "mitigation": "Ensure that all communication links, especially those crossing trust boundaries or carrying sensitive data,",
      "check": "Review all communication links in the model. Do any have authentication set to 'none'? Are there any links using 'credentials' over an unencrypted protocol (such as HTTP, FTP, or LDAP)?",
      "asvs": "V4.2 (Authentication), V7.1 (Network)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
      "detectionLogic": "This rule checks all communication links. It triggers a risk if a link has authentication set to 'none' or 'credentials' over an unencrypted channel.",
      "riskAssessment": "The impact is determined by the highest confidentiality and integrity of the data assets transferred over the link.",
      "falsePositives": "A risk might be a false positive if other compensating controls exist that are not modeled, such as physical network isolation or a service mesh that transparently adds mTLS. In such cases, the risk should be accepted with justification or mitigated by modeling the compensating control.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "59_sec5.ts",
      "bsiCode": "NET.2.1",
      "id": "insecure-@Network:WLAN-configuration",
      "title": "Insecure @Network:WLAN Configuration",
      "description": "Access Points and other @Network:WLAN components (e.g., @Network:WLAN Controllers) offer a variety of configuration settings, especially concerning security functions.",
      "impact": "Misconfiguration of @Network:WLAN components can lead to unencrypted data transmission, allowing attackers to intercept sensitive information (violating Confidentiality),",
      "action": "Securely Configure @Network:WLAN Components and Enforce Encrypted Communication",
      "mitigation": "Ensure all @Network:WLAN components are configured to use strong, modern security protocols such as WPA3 or WPA2 with AES encryption. Disable outdated protocols such as WEP, WPA, and features such as WPS (Wi-Fi Protected Setup).",
      "check": "Are all @Network:WLAN components configured to use WPA3/WPA2-AES? Are weak protocols and WPS disabled?",
      "asvs": "V14.2.1: Verify that all network connections use authenticated encryption (e.g., TLS).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for any technical asset tagged as a '@Network:WLAN-component' that has outgoing communication links using an unencrypted protocol.",
      "riskAssessment": "The likelihood of exploitation is considered high for unencrypted @Network:WLAN traffic, as sniffing tools are widely available. The impact is directly dependent on the sensitivity (Confidentiality and Integrity) of the data assets transmitted over the insecure link.",
      "falsePositives": "This risk might be a false positive if the @Network:WLAN is deployed in a physically secured, isolated environment with no unauthorized access possible,",
      "cwe": "319",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "59_sec6.ts",
      "bsiCode": "NET.2.1",
      "id": "weak-@Network:WLAN-security",
      "title": "Weak @Network:WLAN Encryption / Cleartext Traffic",
      "description": "@Network:WLAN components in their default delivery state are often configured with few or no security mechanisms enabled.",
      "impact": "If weak or no encryption is used for a @Network:WLAN, an attacker can eavesdrop on the data traffic (including credentials and session cookies), leading to disclosure of sensitive information and potential account takeover.",
      "action": "Enforce strong WLAN encryption and eliminate cleartext protocols",
      "mitigation": "Ensure all @Network:WLAN components enforce WPA3 or, at minimum, WPA2-Enterprise (802.1X) with strong EAP methods; avoid WPA2-PSK unless using long, unique passphrases.",
      "check": "Is the @Network:WLAN configured for WPA3 or WPA2-Enterprise (802.1X)? Are WEP and WPA/TKIP disabled? If PSK is used, is it unique and ≥20 characters? Is WPS disabled?",
      "asvs": "ASVS V14.2.1 & V9.1: Encrypt communications in transit using strong, peer-authenticated protocols; disable legacy/weak cipher suites and protocols.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/SYS/SYS_3_2_1_Wireless_LAN_en.html",
      "detectionLogic": "Triggers when a technical asset tagged `@Network:WLAN` participates in a communication link whose `protocol` is evaluated as cleartext by the platform’s `isProtocolEncrypted` check.",
      "riskAssessment": "Likelihood is very high for cleartext WLAN traffic because passive eavesdropping is trivial. Impact scales with the highest confidentiality of data observed on the affected link:",
      "falsePositives": "This risk might be a false positive if the apparent cleartext protocol is fully encapsulated in a modeled secure tunnel (e.g., a VPN link protocol is explicitly represented on the link).",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "59_sec7.ts",
      "bsiCode": "NET.2.1",
      "id": "eavesdropping-on-insecure-@Network:WLAN",
      "title": "Eavesdropping on Insecure @Network:WLAN Communication (BSI NET.2.1)",
      "description": "Because wireless communication (@Network:WLAN) is a shared medium, data transmitted over it can be intercepted and recorded. If this data is not encrypted, or is insufficiently encrypted, the payload can be read. Furthermore, the radio waves of wireless networks often extend beyond the physical boundaries of one's own premises. Thus, data is also broadcast into areas that cannot be controlled or secured by the user or organization.",
      "impact": "If sensitive data is transmitted unencrypted over a wireless network, an attacker can intercept and read it, leading to a breach of confidentiality. This can expose user credentials, personal data, session information, or business secrets and can cascade into identity theft, financial loss, or further system compromises.",
      "action": "Enforce strong end-to-end encryption on all @Network:WLAN communications and WPA3 on the WLAN itself.",
      "mitigation": "All communication links traversing a wireless network must use a protocol that provides strong, end-to-end encryption (e.g., HTTPS, WSS, JDBC-encrypted, FTPS, SFTP). For the @Network:WLAN infrastructure itself, use strong security protocols like WPA3 with robust authentication. Avoid using outdated or broken protocols like WEP. If an application protocol is inherently unencrypted, it must be tunneled through a secure layer like a VPN if it must traverse a wireless network. The use of a VPN can be modeled by setting the `vpn: true` flag on the communication link.",
      "check": "Review all communication links tagged as '@Network:WLAN'. Verify that the protocol used is encrypted or that the link is protected by a VPN. Check the WLAN infrastructure configuration to ensure WPA3 (or better) is enforced.",
      "asvs": "V11.1.1: Verify that all communications between components are encrypted in transit.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule scans for communication links that are explicitly tagged with `@Network:WLAN`. For each such link it checks `isProtocolEncrypted(link.protocol)` and the `link.vpn` flag. If the protocol is not encrypted and the link is not traversing a VPN, a risk is generated. Links using encrypted application protocols (e.g., HTTPS/WSS/JDBC-encrypted/FTPS/SFTP) or explicitly modeled with `vpn: true` are ignored. Impact is scaled based on `link.getHighestConfidentiality()` and the risk title names the source and target assets.",
      "riskAssessment": "The likelihood is very high if an unencrypted protocol is used over a @Network:WLAN, as eavesdropping tools are widely available and effective. The impact depends directly on the sensitivity (confidentiality) of the data assets being transmitted. Transmitting 'Strictly Confidential' data results in a very-high impact.",
      "falsePositives": "A false positive might occur if the model incorrectly tags a link as `@Network:WLAN` when it is entirely on a wired network, or when encryption is provided by an out-of-band tunnel that is not modeled (e.g., a site-to-site VPN not represented on the link). This risk is considered mitigated if the link is modeled with the `vpn: true` flag, even if the application protocol is unencrypted.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "59_sec8.ts",
      "bsiCode": "NET.2.1",
      "id": "rogue-access-point-net-2-1",
      "title": "Communication via Rogue/Evil-Twin Access Point (BSI NET.2.1)",
      "description": "An attacker can impersonate part of a wireless network infrastructure by deploying a malicious access point (a 'Rogue' or 'Evil Twin' AP)",
      "impact": "Successful exploitation can expose credentials, session tokens, and sensitive payloads (Confidentiality) and allow in-transit modification or",
      "action": "Implement Strong Wireless Security and Secure Communication Channels",
      "mitigation": "Enforce a secure VPN for all connections originating from clients on potentially untrusted networks to protect traffic end-to-end.",
      "check": "Review client-originating communication links: is a VPN enforced on untrusted networks? For managed WLANs, verify WPA3 or WPA2-Enterprise",
      "asvs": "BSI IT-Grundschutz NET.2.1 — WLAN-Betrieb",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/NET/NET_2_1_WLAN-Betrieb_Edition_2023.pdf?__blob=publicationFile (German)",
      "detectionLogic": "Flags communication links that originate from client-type technical assets (e.g., Mobile App, Laptop, IoT Device) where the link is not",
      "riskAssessment": "Likelihood is high for mobile/roaming clients. Impact scales with the confidentiality/integrity requirements of the data traversing the link.",
      "falsePositives": "May be a false positive for strictly wired-only environments or if compensating controls (e.g., always-on enterprise VPN with device",
      "cwe": "311",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "59_sec9.ts",
      "bsiCode": "NET.2.1",
      "id": "unprotected-access-point-backend-connection",
      "title": "Physically Accessible AP with Unencrypted Wired Backhaul",
      "description": "If a wireless Access Point (AP) is installed where unauthorized people can physically reach it, an attacker can tap or insert a device into the wired backhaul (e.g., Ethernet) between the AP and the switching infrastructure. This enables passive sniffing or active MitM on all traffic traversing the AP, regardless of the WLAN air-interface encryption (WPA2/WPA3).",
      "impact": "Leads to disclosure and potential manipulation of data transiting the AP, bypassing WLAN encryption. Impact scales with the highest confidentiality of data on the affected link; sensitive data can result in severe or critical impact.",
      "action": "Secure physical placement and encrypt the AP’s wired backhaul",
      "mitigation": "Install Access Points in physically secure or tamper-resistant locations (locked rooms/ceilings/enclosures). Encrypt the wired backhaul (e.g., IEEE 802.1AE MACsec on the switchport or tunneling AP traffic via IPsec/VPN to a controller). Enforce port security/802.1X on the switchport, disable unused ports, and ensure management access uses secure channels (SSH/TLS).",
      "check": "Are any Access Points publicly reachable (hallways, lobbies, outdoor areas)? Is the wired uplink from the AP to the switch encrypted (e.g., MACsec or VPN)? Do switchports enforce 802.1X/port security and are APs mounted to deter tampering/theft?",
      "asvs": "V14.1.1 Network Architectural Design and Segmentation",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "Flags technical assets modeled as Access Points (technology 'Gateway' or 'IoTDevice') that are tagged '@Access:Public'. For each such asset, all outgoing communication links are checked; if a link’s protocol is not considered encrypted by the model, a risk is raised for that link.",
      "riskAssessment": "Likelihood is 'Likely' if the AP is physically accessible and its backhaul is unencrypted. Impact derives from the highest confidentiality of data flowing over the link; risks become High or Critical when Confidential or Strictly Confidential data traverse the unencrypted path.",
      "falsePositives": "May be a false positive when compensating controls exist but are not represented in the model—e.g., MACsec enabled on the switchport (a Layer-2 control typically not modeled as a protocol), backhaul VPN tunneling, or continuous physical monitoring and tamper detection.",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "5_sec1.ts",
      "bsiCode": "APP.2.2",
      "id": "improper-ad-forest-security-boundary",
      "title": "Improper AD Forest Security Boundary",
      "description": "In Active Directory Domain Services (AD DS), the Forest is the ultimate security boundary, not the Domain.",
      "impact": "A full compromise of an AD Forest gives an attacker control over all objects belonging to all contained domains, including all user accounts, administrator accounts, and computer accounts.",
      "action": "Implement Forest-Level Segmentation for High-Security Zones",
      "mitigation": "For environments requiring true security isolation (e.g., separating production from development), use separate, non-trusting AD Forests.",
      "check": "Review the AD topology. Are distinct security zones (like production, staging, development) separated by domains within the same forest?",
      "asvs": "V1.4.1: Verify that there is appropriate separation of duties and least privilege between components, services and applications.",
      "cheatSheet": "https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models",
      "detectionLogic": "This rule identifies trust boundaries tagged as `@AD:Forest` that contain more than one nested trust boundary tagged as `@AD:Domain`.",
      "riskAssessment": "The impact of a forest compromise is almost always 'Very High'. The likelihood is rated as 'Likely' because attack paths within multi-domain forests are well-documented and commonly exploited.",
      "falsePositives": "This risk can be considered a false positive if the multi-domain forest is intended for a single, unified security context and a robust, well-maintained administrative tiering model is strictly enforced.",
      "cwe": "266",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec10.ts",
      "bsiCode": "APP.2.2",
      "id": "active-directory-compromise-via-ntdsdit",
      "title": "Compromise of Active Directory via ntds.dit Theft",
      "description": "A core component of Active Directory, the ntds.dit database, contains password hashes for all domain users and is replicated on every read-write domain controller (RWDC). Attackers who gain access to this file, either from a live system or an insecure @Backup:Target, can extract credentials. This risk is significantly amplified when domain controllers are virtualized and share a physical host with less secure systems, as compromising the host or its administrative accounts can provide a direct path to the virtualized DC's files.",
      "impact": "Successful exploitation leads to the complete compromise of the Active Directory domain, and potentially the entire forest. Attackers can create administrative accounts, access any system connected to the domain, decrypt sensitive data, and achieve full persistence. This constitutes a critical failure of confidentiality, integrity, and availability.",
      "action": "Isolate and Harden Domain Controllers",
      "mitigation": "Physically and logically secure all domain controllers. Use dedicated, hardened virtualization hosts for virtualized DCs or ensure strict network and administrative isolation from other VMs. Implement secure @Backup:Target procedures with encrypted, access-controlled storage for @Backup:Target files. Severely restrict and monitor administrative access to both the domain controllers and their virtualization hosts.",
      "check": "Are domain controllers running on dedicated physical or virtual hosts? If virtualized, are they isolated from other, less critical VMs? Are virtualization host administrator accounts strictly controlled and monitored? Is the @Backup:Target process for DCs documented, secure, and tested?",
      "asvs": "Derived from the BSI IT-Grundschutz APP.2.2 'Active Directory Domain Services', addressing threats such as T 5.147 'Compromise of domain controllers' and guidance on physical protection and the secure operation of virtualized domain controllers.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_2_2_Active_Directory_Domain_Services_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Identifies technical assets configured as LDAP identity stores (typically Active Directory domain controllers). The risk is elevated if these critical assets are virtualized and run on a shared runtime environment alongside other, potentially less secure, technical assets.",
      "riskAssessment": "The impact is considered 'Very High' due to the catastrophic consequences of a domain compromise. The likelihood starts as 'Likely' for any identified DC. It increases to 'Very Likely' if the DC is virtualized and shares a runtime environment with other assets, as this expands the attack surface to the virtualization host and its neighbors.",
      "falsePositives": "This risk may be a false positive if the shared virtualization environment has compensating controls visible in the model, such as advanced hypervisor security, micro-segmentation, and strict administrative separation between the DC and other VMs.",
      "cwe": "522",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec11.ts",
      "bsiCode": "APP.2.2",
      "id": "cached-privileged-credentials",
      "title": "Privileged Credentials Cached on Non-PAW Systems (BSI APP.2.2)",
      "description": "If highly privileged domain accounts (e.g., Domain Admins) sign in to standard servers or clients, their credentials can be cached on those systems (e.g., in LSASS memory). Compromise of such a system enables credential theft and rapid privilege escalation across the domain/forest.",
      "impact": "Compromise of one non-PAW system that cached privileged credentials can cascade to full domain and potentially forest compromise via lateral movement and impersonation.",
      "action": "Enforce PAW-only sign-in for Tier-0 roles and a strict tiered admin model; prefer JIT/JEA administration and remote workflows that do not expose credentials on standard hosts.",
      "mitigation": "Prohibit the use of highly privileged accounts on anything other than dedicated, hardened Tier-0 hosts (Domain Controllers and Privileged Access Workstations). Implement a tiered access model where administrative accounts for one tier cannot be used on lower-trust tiers. Use separate admin and daily-use accounts. Mandate PAWs for all domain administration. Enable Windows Defender Credential Guard and LSA protection (RunAsPPL) on endpoints. Prefer Remote Credential Guard/PowerShell Just-Enough-Administration to avoid credential material on targets.",
      "check": "Are privileged domain logons technically restricted to PAWs/DCs? Is a tiered access model (Tier-0/1/2) documented and enforced? Are PAWs mandated and verified? Are Credential Guard and LSA protection enabled? Are JIT/JEA processes in place to avoid persistent high-privilege sessions?",
      "asvs": "MITRE ATT&CK: T1003.001 (OS Credential Dumping: LSASS Memory); Related: T1550 (Use of Stolen Credentials)",
      "cheatSheet": "https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protecting-and-managing-credentials",
      "detectionLogic": "Flag whenever a communication link explicitly tagged as a high-privilege domain login (e.g., '@Privilege:DomainAdmin') originates from an in-scope technical asset that is not tagged '@AssetType:PAW' and targets an identity-related system (e.g., LDAP/AD DS/KDC/Identity Store). The source asset is marked at risk because it would cache the privileged credentials.",
      "riskAssessment": "Impact is Very High by default due to potential identity infrastructure takeover. Likelihood is higher for client-type sources (users browse/email) and lower for hardened servers. Severity is calculated from these factors.",
      "falsePositives": "May be a false positive if the source is actually a hardened PAW but is not tagged '@AssetType:PAW' in the model, or if the tag '@Privilege:DomainAdmin' was used for a non-interactive, isolated flow that cannot cache credentials.",
      "cwe": "522",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec12.ts",
      "bsiCode": "APP.2.2",
      "id": "uncontrolled-domain-join",
      "title": "Uncontrolled Domain Join by Authenticated Users",
      "description": "In the default configuration of Active Directory Domain Services (AD DS), any authenticated user is permitted to join up to ten IT systems to the domain, even without holding administrative privileges within AD DS.",
      "impact": "This misconfiguration can be exploited by an attacker with standard user credentials to escalate privileges within the domain. By joining a compromised machine to the domain, the attacker can potentially intercept credentials, move laterally, and gain access to sensitive resources, ultimately compromising the entire domain. It also undermines IT governance by allowing non-compliant or unmanaged systems into the trusted network.",
      "action": "Restrict Domain-Join Permissions",
      "mitigation": "Set the Active Directory attribute `ms-DS-MachineAccountQuota` to 0 for the domain. This prevents non-administrative users from adding computer accounts.",
      "check": "Verify that the `ms-DS-MachineAccountQuota` attribute is set to 0 in AD DS. Review the 'User Rights Assignment' in the relevant Group Policy Objects to confirm that 'Add workstations to domain' is restricted to authorized administrative personnel.",
      "asvs": "CIS Microsoft Windows Server Benchmark: 2.2.1 Ensure 'Add workstations to domain' is set to 'Administrators'",
      "cheatSheet": "https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/add-workstations-to-domain",
      "detectionLogic": "This risk is triggered for any in-scope technical asset identified as an LDAP-based identity store, which typically represents an Active Directory Domain Controller.",
      "riskAssessment": "The likelihood of exploitation is considered 'Likely' as it only requires standard authenticated user access, which is a common prerequisite for internal attackers. The impact is 'High' by default due to the potential for full domain compromise. If the asset itself is rated as 'Mission-Critical' for integrity or availability, the impact is elevated to 'Very High'.",
      "falsePositives": "This risk can be considered a false positive if the `ms-DS-MachineAccountQuota` has been manually set to 0 and the corresponding user rights have been restricted, which cannot be verified by the threat model alone and requires manual confirmation.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec2.ts",
      "bsiCode": "APP.2.2",
      "id": "improper-trust-relationship-evaluation",
      "title": "Improper Evaluation of Trust Relationships (BSI APP.2.2.A6)",
      "description": "Trust relationships between domains and forests (represented as separate network trust boundaries) allow accounts from one boundary to access resources within another.",
      "impact": "An attacker could exploit a weak or improperly configured trust relationship to escalate privileges from a lower-security environment to a higher-security one.",
      "action": "Review and Secure Trust Relationships",
      "mitigation": "All trust relationships (i.e., communication links crossing network boundaries between identity systems) must be regularly evaluated for their business necessity.",
      "check": "Are all communication links crossing network-level trust boundaries between identity-related assets necessary? Is SID filtering enabled for them? Is Selective Authentication used where appropriate?",
      "asvs": "BSI IT-Grundschutz APP.2.2.A6: Secure configuration of trust relationships",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Active_Directory_Domain_Services_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies communication links between identity-related technical assets (like LDAP servers or Identity Providers) that cross network-level trust boundaries.",
      "riskAssessment": "The likelihood is considered 'Likely' if an untagged trust relationship exists, as these are often complex and misconfigured. The impact is determined by the highest sensitivity (CIA rating) of the assets and data involved in the connected trust boundaries. A trust leading to a boundary with 'Strictly Confidential' data poses a 'High' or 'Very High' impact.",
      "falsePositives": "This risk is raised as a prompt for architectural review. A trust relationship might be fully secure and documented outside the model.",
      "cwe": "266",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec3.ts",
      "bsiCode": "APP.2.2",
      "id": "outdated-ad-ds-functional-level-bsi",
      "title": "Outdated Active Directory Functional Levels",
      "description": "Each new generation of Windows Server, up to and including Windows Server 2016, has introduced additional security features and enhancements for Active Directory Domain Services (AD DS) in the form of domain and forest functional levels.",
      "impact": "Failure to use modern security features in Active Directory can lead to a compromise of the entire domain or forest. This jeopardizes the confidentiality, integrity, and availability of all managed information (such as user credentials, group policies, and access rights) and can enable widespread elevation-of-privilege attacks.",
      "action": "Upgrade Domain Controllers and Raise Functional Levels",
      "mitigation": "All Domain Controllers (DCs) should be migrated to a current, supported version of Windows Server. After all DCs are upgraded, the domain and forest functional levels must be raised to the highest possible level.",
      "check": "Are all Domain Controllers running a current, supported version of Windows Server? Have the domain and forest functional levels been raised to the highest level supported by all DCs? Are modern AD security features enabled and configured?",
      "asvs": "BSI IT-Grundschutz CON.3.A11 Use of an up-to-date version of the directory service",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Directory_services_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for technical assets representing Domain Controllers (technology `identity-store-ldap` or `ldap-server`) that are tagged with an outdated Windows Server version (e.g., `os:windows-server-2016` or older). The presence of such a tag indicates that the system cannot benefit from the latest Active Directory security enhancements.",
      "riskAssessment": "The impact is considered very high if the asset is rated with high or critical CIA values, as compromising a Domain Controller typically compromises the entire environment it manages. The likelihood is considered likely, as exploits against older AD versions and configurations are well-documented and widely known.",
      "falsePositives": "The risk might be mitigated by extensive compensating controls not visible in the model, such as advanced endpoint detection and response (EDR) on the Domain Controllers, strict network segmentation of the management infrastructure, or specialized AD monitoring tools. However, the underlying risk of missing built-in security features remains.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec4.ts",
      "bsiCode": "APP.2.2",
      "id": "unnecessary-services-on-domain-controller",
      "title": "Unnecessary Services on a Domain Controller",
      "description": "Running additional services on a Domain Controller (DC) alongside identity services (like Active Directory) increases the attack surface of this highly critical component.",
      "impact": "If this risk is exploited, an attacker could gain control over the central identity and authentication system, leading to a complete loss of confidentiality, integrity, and availability for all connected systems and data. This constitutes a catastrophic security incident.",
      "action": "Isolate Domain Controller Services",
      "mitigation": "Domain Controllers must be treated as highly sensitive, dedicated systems. Do not install any software or services that are not essential for the functioning of the directory service itself.",
      "check": "Review all technical assets modeled as `IdentityStoreLDAP`. Are they located in a `SharedRuntime` that contains other, non-identity-related technical assets? If so, this risk is present.",
      "asvs": "Derived from the BSI IT-Grundschutz Compendium, Baustein DIR.1: Directory Services, specifically the principle of minimizing the attack surface of critical infrastructure.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DIR_1_Directory_services_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule iterates through all `SharedRuntime` components in the model. It flags any runtime that contains a technical asset of technology `IdentityStoreLDAP` (representing a DC) alongside any other non-identity-related technical assets.",
      "riskAssessment": "The impact of compromising a Domain Controller is consistently rated as `VeryHigh`. The likelihood of exploitation is elevated by the presence of any additional service, as each one introduces its own set of potential vulnerabilities.",
      "falsePositives": "The rule might trigger a false positive if a service that is essential for the operation or monitoring of the directory service (e.g., a specific, hardened security agent) is modeled as a separate technical asset within the same runtime. These cases should be reviewed and can be accepted with proper justification.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec5.ts",
      "bsiCode": "APP.2.2",
      "id": "excessive-rights-delegation",
      "title": "Excessive Rights Delegation Due to Unsystematic Planning (BSI-based)",
      "description": "If the creation of organization-specific groups and the delegation of rights to these groups or individual user objects are not systematically planned and implemented, the delegation becomes difficult to control. This can grant far more access than intended, which may be abused by third parties. A lack of regular auditing of access rights for groups and individual user objects can further exacerbate the problem. Similarly, when standard, highly privileged groups (e.g., 'Account Operators') are used to delegate permissions to other roles (e.g., helpdesk staff), more rights are typically granted than are actually required, violating the Principle of Least Privilege.",
      "impact": "Granting excessive permissions violates the Principle of Least Privilege. This can lead to unauthorized access, data tampering, information disclosure, or elevation of privilege by malicious actors or through accidental misuse by legitimate users. This directly threatens the Confidentiality, Integrity, and Availability of all assets managed by the compromised identity system.",
      "action": "Implement systematic access control and regular auditing",
      "mitigation": "Establish a formal process for requesting, approving, and granting access rights based on the Principle of Least Privilege. Avoid delegating permissions from broad, powerful standard groups (like 'Account Operators'). Instead, create fine-grained custom roles and groups with the minimum necessary permissions. Regularly audit and recertify all access rights to ensure they are still required and appropriate for the given role.",
      "check": "Is there a documented process for access rights management? Are access rights reviewed periodically (recertification)? Is the use of overly permissive standard groups for delegation avoided? Are roles and permissions based on the 'need-to-know' and 'need-to-do' principles?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Identity and access management), particularly requirements like ORP.4.A5 (Requesting authorizations), ORP.4.A6 (Granting authorizations), and ORP.4.A19 (Recertification of authorizations).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is detected by identifying core identity management assets (like Identity Providers, LDAP Servers, or Identity Stores) and checking for incoming communication from assets associated with roles that typically should not have broad administrative rights, such as 'helpdesk' or 'account-operator'. Such a connection implies a delegation of permissions that may be overly permissive.",
      "riskAssessment": "The likelihood is considered high if IAM components are managed by roles like 'helpdesk' without specific fine-grained controls, as this pattern is inherently risky. The impact is determined by the criticality of the identity management asset itself. If the IAM system controls access to mission-critical or strictly confidential assets, the potential impact is very high, as its compromise could lead to a widespread system breach.",
      "falsePositives": "The model cannot distinguish between a properly configured, least-privilege delegation and an overly permissive one. This risk flags a potentially dangerous architectural pattern. Confirmation requires a manual audit of the actual permissions configured in the target identity management system.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec6.ts",
      "bsiCode": "APP.2.2",
      "id": "legacy-authentication-in-ad-ds",
      "title": "Insecure Legacy Authentication in AD DS",
      "description": "Legacy authentication mechanisms in Active Directory Domain Services (AD DS), such as LAN Manager (LM) and NT LAN Manager (NTLM) v1, are insecure. Attackers can exploit them under certain conditions to gain and misuse privileges without knowing the plaintext passwords, potentially leading to the compromise of parts of the domain, the entire domain, or even the AD forest.",
      "impact": "Successful exploitation can lead to a full compromise of the Active Directory domain, granting attackers high-level privileges. This enables them to access, modify, or delete sensitive data, create rogue accounts, and disable security controls across the entire network infrastructure connected to Active Directory.",
      "action": "Disable legacy authentication protocols",
      "mitigation": "Configure Active Directory and all connected systems to reject insecure legacy authentication protocols such as LM and NTLMv1. Enforce the use of modern, secure protocols like Kerberos or NTLMv2. Manage this via Group Policy Objects (GPOs) applied to domain controllers and member servers and workstations. Audit logs should be monitored for legacy authentication attempts.",
      "check": "Are Group Policies in place to explicitly block LM and NTLMv1 authentication? Are audit logs reviewed for legacy authentication attempts? Have all clients and services been verified to support modern authentication protocols?",
      "asvs": "BSI IT-Grundschutz APP.2.2.A9 (Protection of authentication when using AD DS)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_2_2_Active_Directory_Domain_Controller_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for technical assets representing Active Directory Domain Services (e.g., technologies `identity-store-ldap`, `ldap-server`) that are explicitly tagged as using legacy authentication (e.g., via the `@LegacyAuth:used` tag).",
      "riskAssessment": "The likelihood of exploitation is high, as well-known tools exist to perform pass-the-hash and other related attacks against these weak protocols. The impact is considered very high as it can lead to a full domain compromise, which typically means a complete compromise of the entire IT infrastructure.",
      "falsePositives": "The risk might be a false positive if compensating controls (like strict network segmentation and monitoring) are in place that effectively prevent exploitation, though disabling the protocols is the recommended primary mitigation. The risk is directly dependent on the accuracy of the `@LegacyAuth:used` tag.",
      "cwe": "326",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec7.ts",
      "bsiCode": "APP.2.2",
      "id": "excessive-privileges-for-service-accounts",
      "title": "Excessive Privileges for Service Accounts (based on BSI APP.2.2)",
      "description": "Application service accounts are sometimes granted the rights of highly privileged groups (e.g., Domain Administrators) for ease of deployment or testing, even though significantly fewer rights are needed for normal operation. A significant risk arises if these service accounts use weak passwords or if their credentials are compromised. Even accounts not directly in a privileged group can be assigned extensive administrative permissions across many systems, granting similarly powerful rights. Attackers can abuse these over-privileged accounts to move laterally within the IT environment and escalate their privileges.",
      "impact": "Compromise of an over-privileged service account allows an attacker to gain extensive control over connected systems. This can be used for lateral movement, accessing or tampering with critical data, deploying ransomware, or achieving a full domain compromise, leading to severe impacts on Confidentiality, Integrity, and Availability.",
      "action": "Apply the principle of least privilege (PoLP) to all service accounts",
      "mitigation": "Ensure that all service accounts run with the minimum set of permissions necessary for their function. Avoid using Domain Administrator or equivalent high-privilege accounts for application services. Instead, create dedicated, unprivileged accounts for each service. Credentials for these accounts should be strong, unique, and managed securely, preferably through an automated vault or secrets management solution. Regularly audit the permissions of all service accounts.",
      "check": "Are any service accounts members of highly privileged groups like 'Domain Admins' or 'Enterprise Admins'? Do service accounts have administrative rights on systems where they are not required? Has the principle of least privilege been applied to all service account configurations?",
      "asvs": "BSI IT-Grundschutz APP.2.2 Active Directory Domain Services; OWASP Top 10 2021: A04: Insecure Design (Principle of Least Privilege)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_2_Active_Directory_Domain_Services_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers when a technical asset uses a 'technical-user' authentication for an outgoing communication link, AND the asset itself is tagged as having high privileges (e.g., '@Privilege:DomainAdmin'). This indicates a powerful account is being used for a service, violating the principle of least privilege.",
      "riskAssessment": "The impact is determined by the sensitivity of the target asset that can be accessed with the high privileges. If the target stores or processes 'Strictly Confidential' or 'Mission-Critical' data, the impact is very high. The likelihood is considered 'Likely' if password-based credentials are used, as these are more susceptible to compromise than certificate- or token-based authentication.",
      "falsePositives": "Can occur if the high privilege level is documented, formally accepted as a risk, and absolutely necessary for the service's core function. However, such cases should be extremely rare and are generally considered poor security architecture.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec8.ts",
      "bsiCode": "APP.2.2",
      "id": "reuse-of-local-credentials-on-shared-runtime",
      "title": "Reuse of Local Credentials Across Multiple Systems (BSI-Style)",
      "description": "Even when an IT system is joined to a domain, local accounts can still be used for sign-in. If identical local credentials—especially for built-in administrator accounts—are used on multiple IT systems (e.g., due to a common base image or deployment script), compromising one system enables an attacker to sign in to the others with the same credentials.",
      "impact": "This greatly facilitates lateral movement, allowing an attacker to spread throughout the infrastructure. It significantly increases the risk that an attacker will find and misuse highly privileged domain credentials on one of the systems, potentially leading to the compromise of the entire domain and its parent forest.",
      "action": "Ensure Unique Local Administrator Passwords",
      "mitigation": "Use a centralized solution such as Microsoft LAPS (Local Administrator Password Solution) to automatically manage and randomize local administrator passwords on all domain-joined systems. Avoid reusing any local account password across systems. Disable or rename the built-in local Administrator account where possible and restrict its ability to sign in remotely. If this is implemented, tag the relevant 'Shared Runtime' with 'laps-managed'.",
      "check": "Are local administrator passwords unique on each system? Is a tool such as LAPS deployed and configured correctly? Is there monitoring for sign-in events using local administrator accounts?",
      "asvs": "BSI IT-Grundschutz: APP.2.2 Active Directory Domain Services; SYS.1.2.2 Windows Client Hardening. MITRE ATT&CK T1078 (Valid Accounts) & T1550.002 (Use Alternate Authentication Material: Pass the Hash).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/IT-Grundschutz-Kompendium/bausteine/SYS/SYS_1_2_2_Windows_10_und_11_Edition_2023.html",
      "detectionLogic": "This risk is generated for any 'Shared Runtime' that contains multiple technical assets of types where local administrator accounts are common (e.g., desktops, servers). The assumption is that assets within a shared runtime (such as a common server image or desktop build) are at high risk of having identical local credentials, enabling lateral movement. The risk is raised if the assets reside within a common network trust boundary and the shared runtime is not tagged as 'laps-managed'.",
      "riskAssessment": "Likelihood is considered 'Very Likely' if multiple systems share a runtime without mitigation. The impact is calculated based on the highest confidentiality, integrity, and availability of all assets within that shared runtime, as a compromise of one can lead to a compromise of all.",
      "falsePositives": "A false positive may occur if the systems within the shared runtime are confirmed to have unique local credentials despite being part of a common build process. To suppress this finding, tag the 'Shared Runtime' with 'laps-managed'.",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "5_sec9.ts",
      "bsiCode": "APP.2.2",
      "id": "insecure-password-storage-in-ad-ds",
      "title": "Insecure Password Storage in Active Directory Domain Services (AD DS)",
      "description": "Active Directory Domain Services (AD DS) stores password representations for legacy compatibility (NTLM) using a weak, unsalted MD4 hash function.",
      "impact": "Successful exploitation allows an attacker to compromise user and service accounts. This can lead to widespread unauthorized access, elevation of privilege up to Domain Admin, data breaches, and a complete compromise of the Windows domain and all connected systems.",
      "action": "Harden Domain Controllers and Password Security",
      "mitigation": "Strictly limit and monitor administrative access to all Domain Controllers (DCs). Implement strong physical and network security controls for DCs.",
      "check": "Are Domain Controllers treated as the highest-value assets with maximum security controls? Is administrative access (especially Domain Admins) tightly controlled, minimized, and monitored?",
      "asvs": "BSI TR-02102-1 (Cryptographic Mechanisms: Recommendations and Key Lengths); BSI IT-Grundschutz APP.2.2 (Active Directory Domain Services)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/TechGuidelines/TR02102/BSI-TR-02102-1.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any 'datastore' asset identified as an 'identity-store-ldap' technology, which typically represents an Active Directory Domain Controller.",
      "riskAssessment": "The likelihood of exploitation is considered 'likely' if an attacker gains administrative access to a Domain Controller, as the vulnerability is inherent to AD DS and tools to extract hashes are widely available.",
      "falsePositives": "A technical asset might be incorrectly identified as a writable AD DS domain controller. The risk might be considered mitigated by compensating controls (like advanced threat detection and access control) that are not visible in the model.",
      "cwe": "328",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "60_sec1.ts",
      "bsiCode": "NET.2.2",
      "id": "improper-@Network:WLAN-usage",
      "title": "Improper @Network:WLAN Usage by Users (based on BSI)",
      "description": "If users are not sufficiently aware of the rules for the correct use of WLANs, they cannot adhere to them.",
      "impact": "Connecting to untrusted networks without proper safeguards can lead to eavesdropping on sensitive data, man-in-the-middle attacks,",
      "action": "Enforce Encrypted Communication and User Awareness",
      "mitigation": "All communication from client devices should enforce transport-level encryption (e.g., TLS).",
      "check": "Are all communication links from client devices encrypted by default? Is there a policy requiring VPN use on untrusted networks?",
      "asvs": "V6.2.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for client systems (e.g., mobile apps, browsers, desktop clients) that are exposed to the internet",
      "riskAssessment": "The impact is directly related to the confidentiality and integrity requirements of the data assets being transmitted.",
      "falsePositives": "This risk might be a false positive if the 'unencrypted' communication happens within a protected tunnel (like a VPN)",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "60_sec2.ts",
      "bsiCode": "NET.2.2",
      "id": "negligent-disregard-of-security-measures",
      "title": "Negligent Disregard for Security Measures (BSI style)",
      "description": "Due to negligence and a lack of controls, individuals sometimes do not implement, or only partially implement, recommended or mandated security measures. This can lead to bypassing security controls and creating vulnerabilities.",
      "impact": "If security policies are disregarded on client devices, it can lead to severe security incidents. For example, using a client in an unauthorized ad-hoc Wi-Fi mode could allow attackers to directly connect to the device, bypassing network firewalls. This could lead to unauthorized access to confidential data, malware injection, or system tampering, compromising the Confidentiality, Integrity, and Availability of the asset and any data it can access.",
      "action": "Enforce Security Policies via Technical Controls",
      "mitigation": "Ensure security policies are not only defined but also enforced through technical controls where possible (e.g., disabling ad-hoc Wi-Fi, USB port access, or unauthorized software installation via endpoint management solutions like MDM or GPO). Implement regular automated compliance checks and audits to verify that configurations align with policies. Use monitoring and endpoint detection and response (EDR) solutions to detect and alert on policy violations in real-time. Foster a security culture where compliance is understood and valued.",
      "check": "Are security policies for client devices technically enforced? Are there regular compliance audits? Is there monitoring for policy violations? Does the organization have a process to actively address non-compliance on endpoints?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Conformity), specifically requirement ORP.2.A5 'Review of compliance with information security'. The described threat results from a failure to ensure and verify compliance.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Conformity_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for in-scope client-type technical assets (e.g., desktops, mobile apps, IoT devices) that handle sensitive data (Restricted/Important or higher). Such devices are prone to user-induced misconfigurations if not strictly controlled, allowing security measures to be bypassed.",
      "riskAssessment": "The likelihood is considered 'Likely' for client devices, assuming a baseline level of user freedom and the potential for negligence. The impact is calculated based on the highest Confidentiality, Integrity, and Availability ratings of the client asset and the data it processes or stores. A breach of a client handling mission-critical data will have a high impact.",
      "falsePositives": "This risk might be a false positive if the organization has strong, centrally managed endpoint security controls (e.g., MDM, EDR, mandatory GPOs) that prevent users from altering security-critical settings, even if this is not explicitly modeled with a specific tag.",
      "cwe": "732",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "60_sec3.ts",
      "bsiCode": "NET.2.2",
      "id": "unencrypted-@Network:WLAN-communication-net-2-2",
      "title": "Unencrypted Communication over Wireless Networks (BSI NET.2.2)",
      "description": "Wireless networks (@Network:WLAN) are a shared medium, making it easy for unauthorized parties to intercept and record data traffic.",
      "impact": "Eavesdropping on unencrypted wireless communication can lead to the compromise of sensitive information, including credentials, personal data, and business secrets.",
      "action": "Enforce strong encryption on all wireless communication",
      "mitigation": "Ensure that all wireless communication links use protocols that provide strong, end-to-end encryption (e.g., HTTPS, WSS, SSH, any protocol using TLS).",
      "check": "Review all communication links tagged as '@Network:WLAN'. Verify that the protocol used for each link is an encrypted one (e.g., HTTPS, not HTTP).",
      "asvs": "V4.0.3-9.1.1 (Verify that all communication to or between components containing sensitive data is encrypted in transit)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for any communication link that is explicitly tagged as '@Network:WLAN' and uses a protocol that is not recognized as encrypted.",
      "riskAssessment": "The likelihood of an attacker eavesdropping on an unencrypted wireless network is considered very high.",
      "falsePositives": "A communication link might be mis-tagged as '@Network:WLAN'.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "60_sec4.ts",
      "bsiCode": "NET.2.2",
      "id": "mac-address-tracking-over-wlan",
      "title": "Movement Profile Creation via MAC Address Tracking over WLAN",
      "description": "In IEEE 802.11-based WLANs, the MAC address of a device is transmitted with every data frame. Since this address is sent unencrypted at Layer 2, it allows attackers on the same network to capture it. This can be used to create movement profiles of mobile users, for example, when they connect to various public hotspots. This risk is derived from BSI IT-Grundschutz concepts regarding WLAN security.",
      "impact": "An attacker can track the physical presence and movement of users across different locations where they use WLAN, leading to a significant loss of privacy. This can expose patterns of life (home, work, travel), which could be used for social engineering, stalking, or other malicious activities. This compromises the confidentiality of the user's location data, which is often considered sensitive personal information.",
      "action": "Enforce MAC Address Randomization on Client Devices",
      "mitigation": "For all mobile client assets (laptops, mobile phones, etc.), ensure the operating system's MAC address randomization feature is enabled and active, especially for non-trusted networks. For corporate-managed devices, this can be enforced via Mobile Device Management (MDM) policies. For Bring-Your-Own-Device (BYOD) scenarios, it is crucial to educate users on the risks and provide clear instructions on how to enable this privacy-enhancing feature. Note that while application-level encryption (TLS) is essential for protecting data content, it does not mitigate this specific Layer 2 identifier leakage.",
      "check": "Are client devices that connect to external or public networks configured to use MAC address randomization? Is there an enforceable policy (e.g., via MDM) or a user education program in place to ensure this setting is active?",
      "asvs": "This is a Layer 2 network protocol issue not directly covered by OWASP ASVS or MASVS, which focus on higher application layers. However, it relates to the broader principle of protecting data in transit. The most relevant BSI context is NET.2.2 WLAN usage, with related guidance in NET.2.1 WLAN operation and SYS.3.2 Mobile Device Management.",
      "cheatSheet": "https://www.wi-fi.org/download.php?file=/sites/default/files/private/Wi-Fi_Alliance_Device_MAC_Address_Randomization_Readiness_and_Best_Practices_202206.pdf",
      "detectionLogic": "This risk is raised for any technical asset identified as a client-type device (e.g., technology 'mobile-app', 'desktop', 'browser', 'IoT device') that has a communication link to an internet-facing asset or a link that crosses a trust boundary. The assumption is that such communication may traverse untrusted WLANs where its MAC address can be sniffed by third parties.",
      "riskAssessment": "The likelihood is considered 'Likely' as connecting to various Wi-Fi networks is a standard use case for mobile devices. The impact is rated as 'Medium' because it constitutes a significant privacy violation, even if it doesn't directly compromise data assets stored within the application. The severity is therefore typically 'Elevated'.",
      "falsePositives": "This risk can be considered a false positive if it can be confirmed that the client device will exclusively use trusted networks (e.g., cellular data, or a corporate network with mandatory VPN) and will never connect to third-party or public WLANs. It can also be mitigated if MAC randomization is verifiably enforced on the device.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "60_sec5.ts",
      "bsiCode": "NET.2.2",
      "id": "rogue-access-point",
      "title": "Rogue Access Point (BSI NET.2.2)",
      "description": "Attackers can impersonate part of a wireless network infrastructure by installing their own access point (AP) with a suitably chosen @Network:WLAN name (SSID) in the vicinity of a @Network:WLAN client. This fake AP is called a 'Rogue Access Point'. If this rogue AP offers the @Network:WLAN client a stronger signal than the legitimate AP, the client will use it as its base station, especially if mutual authentication is not performed. Additionally, the legitimate AP could be taken down by a Denial-of-Service attack to force the connection. As a result, users connect to a network that only pretends to be the target network, allowing attackers to eavesdrop on and control the communication. This is a common attack vector in public wireless networks (hotspots).",
      "impact": "If clients connect to a rogue access point, an attacker can intercept, read, and modify all transmitted data (Man-in-the-Middle). This can lead to the compromise of credentials, session tokens, and sensitive data, thus violating confidentiality and integrity. The attacker could also redirect the user to malicious sites or block access to legitimate services, affecting availability.",
      "action": "Enforce Strong Mutual Authentication and Use of Encrypted Tunnels (VPN)",
      "mitigation": "Use strong enterprise-grade authentication for wireless networks, such as WPA2/WPA3-Enterprise with 802.1X, which enables mutual authentication via client and server certificates. Configure client devices to not automatically connect to unknown or open Wi-Fi networks and to only trust specific, secured SSIDs. For all connections over untrusted or public networks, all traffic should be routed through a trusted VPN tunnel. Educate users about the risks of connecting to untrusted public Wi-Fi.",
      "check": "Is mutual authentication (e.g., via client certificates) enforced for the communication link? Does the client device connect to potentially untrusted networks (e.g., public hotspots)? Is a VPN used to protect the data in transit?",
      "asvs": "BSI IT-Grundschutz NET.2.2 WLAN Usage",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_WLAN_usage_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for client assets (e.g., mobile apps, desktop clients, IoT devices) that communicate over a network link without strong mutual authentication (i.e., not using client certificates). The risk is considered higher if the client is explicitly modeled to be in a public environment, connected to the internet, or is a mobile-type technology. The use of a VPN is considered a full mitigation for the data-in-transit aspect of this risk.",
      "riskAssessment": "The likelihood is high if a client asset connects over a network without strong mutual authentication like client certificates. The likelihood increases if the client is mobile or explicitly placed in an untrusted environment (like the internet or tagged as using public Wi-Fi). The impact is determined by the highest confidentiality and integrity of the data assets transmitted over the vulnerable link.",
      "falsePositives": "This risk might be a false positive if the modeled communication path, while lacking client-certificate authentication, is known to operate exclusively over a physically secured, private, wired network where the threat of a rogue AP is negligible. The model itself does not distinguish between wired and wireless connections, so this risk highlights a potential weakness in any non-local communication channel that isn't strongly authenticated.",
      "cwe": "290",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "61_sec1.ts",
      "bsiCode": "NET.3.1",
      "id": "unclear-it-administration-responsibilities",
      "title": "Unclear IT Administration Responsibilities",
      "description": "The administration of IT systems involves diverse tasks across various components and domains.",
      "impact": "A lack of clearly defined administrative responsibilities can directly endanger all three protection goals of information security.",
      "action": "Clearly Define and Document Administrator Roles and Responsibilities",
      "mitigation": "Establish a comprehensive concept for the administration of IT systems.",
      "check": "Is there a documented concept for IT administration? Are responsibilities for all administrative tasks clearly assigned?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.2 Administration of IT Systems",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_Operation_of_IT_systems_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified by analyzing the scope and distribution of administrative roles within the model.",
      "riskAssessment": "The impact is determined by the highest confidentiality, integrity, and availability requirements of the assets an administrator can access.",
      "falsePositives": "The model cannot fully understand the organizational context.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "61_sec10.ts",
      "bsiCode": "NET.3.1",
      "id": "human-error-in-administration-g3.3",
      "title": "Human Error in IT Administration (BSI G 3.3)",
      "description": "Human error can never be completely ruled out and may have far-reaching consequences in IT administration. The powerful tools used for administration allow extensive changes to IT components with minimal effort. Depending on the mistake, all information security objectives (confidentiality, integrity, and availability) can be seriously endangered. Errors are particularly likely during multitasking—for example, when different input windows or console outputs are confused—leading to unintended operations on critical systems.",
      "impact": "An administrative error can directly compromise the confidentiality, integrity, or availability of affected IT components. This can cause system outages (denial of service), data corruption or loss (integrity violations), or unauthorized data exposure (confidentiality violations), resulting in significant operational disruption and business damage.",
      "action": "Implement robust change management, automation, and operational procedures",
      "mitigation": "Use the 'four-eyes principle' for critical changes. Implement automated checks, linting, and validation before applying configurations (e.g., via CI/CD pipelines). Use dedicated, isolated administrative workstations. Minimize parallel administrative tasks across different environments. Maintain clear, up-to-date documentation for procedures. Implement comprehensive logging and monitoring to quickly detect and roll back erroneous changes. Provide regular, hands-on training for administrators on tools and emergency procedures.",
      "check": "Is there a formal change-management process? Are critical changes reviewed by a second person (four-eyes principle)? Are administrative actions logged and reviewed? Do administrators use hardened, dedicated environments for their tasks? Are configuration changes deployed through automated, tested pipelines where possible?",
      "asvs": "Derived from BSI IT-Grundschutz threat G 3.3 'Menschliche Fehlhandlung' (human error). Mitigations are described in modules such as OPS.1.1 'General Operation' and ORP.4 'Identity and Access Management'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_operation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This organizational risk is applied to technical assets that are typically managed by administrators and are critical to the system's function. The tool identifies these assets by their technology type (e.g., Database, Application Server, Container Platform, Load Balancer) and/or associated role tags (e.g., `@Role:Administrator`, `@Role:ITSecurityOfficer`). The risk is considered higher for assets involved in development and deployment pipelines, as errors there can propagate widely.",
      "riskAssessment": "The likelihood of an error occurring is high if manual changes are frequent and procedural controls like the four-eyes principle or automated deployment pipelines are absent. The impact is directly related to the CIA rating of the asset and the data it processes or stores. An error on a mission-critical database is far more severe than on a non-production test server.",
      "falsePositives": "The model cannot verify the existence or effectiveness of organizational procedures such as the four-eyes principle, the quality of administrator training, or the robustness of a change-management process. This risk should be validated by reviewing the organization's operational security procedures (OSP).",
      "cwe": "400 // CWE-400: Uncontrolled Resource Consumption (as a likely consequence",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "61_sec11.ts",
      "bsiCode": "NET.3.1",
      "id": "disruption-by-authorized-administration",
      "title": "Disruption by Authorized IT Administration",
      "description": "Even when IT administration activities are performed without errors, they can still disrupt the institution's IT environment.",
      "impact": "Failure to adhere to proper administrative procedures (such as maintenance windows) or unforeseen consequences of administrative changes can directly impact the availability of critical systems and business processes. This can lead to service outages, financial loss, and reduced operational capacity. In some cases, flawed changes can also impact data integrity or hinder future maintenance and recovery efforts.",
      "action": "Establish and Enforce Strict Change Management and Administration Procedures",
      "mitigation": "Implement a formal change management process for all administrative activities. Define, communicate, and enforce strict maintenance windows for production systems.",
      "check": "Is there a formal change management process? Are maintenance windows defined and enforced? Are administrative changes tested before deployment to production? Are there documented rollback procedures?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.5 Administration in accordance with regulations & OPS.1.1.3 Patch and change management",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Administration_according_to_regulations_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for technical assets that are likely subject to frequent and critical administrative tasks. This is determined by identifying assets that:",
      "riskAssessment": "The impact is derived directly from the availability requirement of the technical asset. A 'Mission-Critical' asset failing will have a 'Very High' impact.",
      "falsePositives": "This risk describes a potential failure in an organizational process (change management). A model cannot verify the quality of an organization's operational procedures.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "61_sec2.ts",
      "bsiCode": "NET.3.1",
      "id": "insufficient-documentation-ops1.1.a7",
      "title": "Insufficient Documentation (BSI OPS.1.1.A7)",
      "description": "Documentation may be insufficient if information about IT components (e.g., configurations or access rights) is not recorded or is incomplete.",
      "impact": "Insufficient documentation can lead to misconfigurations or generally flawed IT administration, which can significantly jeopardize all information security objectives (Confidentiality, Integrity, Availability).",
      "action": "Establish and Maintain Comprehensive System Documentation",
      "mitigation": "Implement a formal process for creating and maintaining documentation for all critical IT systems, including configuration details, network diagrams, access control lists, and operational procedures.",
      "check": "Is there a documented process for system documentation? Is the documentation for critical systems complete, accurate, and up-to-date? Is documentation easily accessible to authorized personnel, especially during an emergency?",
      "asvs": "BSI IT-Grundschutz Baustein OPS.1.1.A7 (Documentation of IT Operations)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_IT_operation_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organizational risk is raised for technical assets that are custom-developed (where documentation is often neglected) or have a high availability requirement (where lack of documentation severely impacts incident response and recovery times).",
      "riskAssessment": "The likelihood is considered 'Likely' as insufficient documentation is a very common problem in operations.",
      "falsePositives": "This risk is based on heuristics (custom-developed, high-availability) and might be a false positive if an organization has exceptionally disciplined documentation practices despite these indicators. Verification requires checking the actual documentation processes and quality.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "61_sec3.ts",
      "bsiCode": "NET.3.1",
      "id": "excessive-administrative-permissions-orp4",
      "title": "Excessive Administrative Permissions (BSI ORP.4)",
      "description": "Excessively broad administrative permissions can be exploited for sabotage or information gathering, which can then serve as a starting point for further attacks.",
      "impact": "Abuse of excessive administrative rights or retained access by former administrators can lead to system sabotage, data theft, unauthorized configuration changes, and widespread compromise of the IT landscape, directly impacting Confidentiality, Integrity, and Availability.",
      "action": "Enforce the Principle of Least Privilege (PoLP) and robust identity lifecycle management",
      "mitigation": "Strictly enforce the Principle of Least Privilege for all administrative accounts, granting only the minimum permissions necessary for assigned tasks.",
      "check": "Are administrative permissions reviewed on a regular basis? Is the Principle of Least Privilege demonstrably enforced?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Identity and Access Management), specifically requirements like ORP.4.A6 (Assignment of access rights) and ORP.4.A17 (Protection of privileged accounts).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
      "detectionLogic": "This risk is raised for any technical asset representing an administrative function (identified by '@Role:Administrator' or similar tags).",
      "riskAssessment": "The impact of this risk is directly proportional to the highest confidentiality, integrity, and availability requirements of all assets managed by the administrative component.",
      "falsePositives": "The model correctly identifies an administrative function. A false positive can occur if, in reality, the permissions are already strictly limited according to PoLP and robust offboarding processes are in place. This cannot be verified by the model alone and requires organizational assessment.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "61_sec4.ts",
      "bsiCode": "NET.3.1",
      "id": "insufficiently-secured-administrative-access",
      "title": "Insufficiently Secured Administrative Access",
      "description": "Administrative access points can expose sensitive information, such as system documentation or IT system configurations.",
      "impact": "Beyond the initial loss of confidentiality, compromised administrative access can be used to manipulate systems and data, or to launch further, more extensive attacks,",
      "action": "Secure Administrative Access Channels",
      "mitigation": "Ensure that all communication links used for administrative purposes are robustly secured. This includes using strongly encrypted protocols (e.g., HTTPS, SSH, RDP with TLS),",
      "check": "Are all administrative communication links using encrypted protocols? Do they enforce strong authentication (ideally MFA)? Are they protected by network controls like VPNs or IP filters when crossing network boundaries? Is authorization restricted based on the principle of least privilege?",
      "asvs": "Derived from BSI IT-Grundschutz principles. This aligns with OWASP ASVS V2 (Authentication Verification Requirements), especially V2.2.1 (MFA for high-value accounts) and V7 (Access Control).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
      "detectionLogic": "This rule inspects all communication links identified as administrative (either by 'DevOps' usage, or by targeting an asset with administrative technology or roles).",
      "riskAssessment": "The likelihood is determined by the specific weaknesses found; a lack of encryption or authentication is considered very likely to be exploited.",
      "falsePositives": "A link might be considered secure by compensating controls not captured in the model, such as being on a physically isolated and secured network segment.",
      "cwe": "522",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "61_sec5.ts",
      "bsiCode": "NET.3.1",
      "id": "insufficient-redundancy-of-admin-knowledge-bsi",
      "title": "Insufficient Redundancy of Administrator Knowledge (BSI-derived)",
      "description": "If the necessary knowledge for IT administration is not redundantly available among personnel,",
      "impact": "The primary impact is on the availability of IT systems, as failures cannot be addressed in a timely manner.",
      "action": "Establish and document substitution rules for administrators; verify substitutes can act without the primary admin.",
      "mitigation": "Define and document clear substitution rules for all administrative roles. Ensure that designated substitutes",
      "check": "Are primary and substitute administrators defined for all critical systems (esp. routers/switches)? Is there up-to-date documentation for all administrative procedures?",
      "asvs": "BSI IT-Grundschutz: ORP.2.A5 (Regelungen zur Vertretung), CON.1.A11 (Definition von Vertretungsregeln), NET.3.1.A9 (Betriebsdokumentationen), NET.3.1.A22 (Notfallvorsorge).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile (BSI ORP.2)",
      "detectionLogic": "Raised for any in-scope technical asset tagged with an administrative role (see SupportedTags)",
      "riskAssessment": "Impact is derived from the asset’s availability and integrity requirements: mission-critical implies very-high impact.",
      "falsePositives": "A risk might be flagged as a false positive if robust, organization-wide substitution policies are in place but not explicitly",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "61_sec6.ts",
      "bsiCode": "NET.3.1",
      "id": "staff-shortage-administrators",
      "title": "Staff Shortage Among Administrators (BSI Organizational Threat)",
      "description": "If there is a shortage of administrative personnel, for example due to insufficient personnel planning, overbooking, or a pandemic,",
      "impact": "Both neglected tasks and administrative errors can lead to insufficient availability of IT systems, an increased attack surface, and thus endanger all protection goals of information security (Confidentiality, Integrity, and Availability). This can result in system failures, security breaches, and non-compliance.",
      "action": "Ensure Adequate Staffing, Redundancy, and Training for Administrators",
      "mitigation": "Implement robust personnel and resource planning for IT administration to ensure sufficient staffing levels.",
      "check": "Is there a formal process for personnel resource planning for IT administration? Is there a contingency plan for administrator absence? Are administrators given dedicated time for training and non-urgent maintenance tasks? Are key administrative tasks automated?",
      "asvs": "Derived from BSI IT-Grundschutz CON.1 (Personnel) and related to failures in fulfilling requirements from OPS.1.1 (Server Operation).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Personnel_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This is an organizational risk that is difficult to detect automatically. This rule raises a risk for technical assets that require significant administrative effort, identified by role tags or high criticality.",
      "riskAssessment": "The likelihood is considered 'Likely' by default, as administrative staff shortages are a common organizational challenge.",
      "falsePositives": "The model cannot know the actual staffing levels of the organization. This risk is raised to prompt a manual review of administrative capacity. It can be considered a false positive if the organization can demonstrate adequate staffing, contingency planning, and high levels of automation for the identified asset.",
      "cwe": "732",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "61_sec7.ts",
      "bsiCode": "NET.3.1",
      "id": "inadequately-secured-admin-tools-bsi",
      "title": "Inadequately Secured Administration Tools (BSI)",
      "description": "Administration tools grant extensive access to an institution's IT systems. If these tools are not adequately secured and isolated, they can be compromised. This can lead to the sabotage of IT administration or enable unauthorized administrative access. A common cause of this vulnerability is insufficient separation of administrative tools and environments from general-use applications and networks (e.g., using the same workstation for system administration and for browsing the internet or checking email).",
      "impact": "If an attacker gains access to an inadequately secured administration tool or workstation, they can obtain far-reaching privileges. These privileges can be abused for various attacks, compromising the Confidentiality, Integrity, and Availability of all administered systems. This can lead to data breaches, system-wide compromise, and significant disruption of business operations.",
      "action": "Isolate Administrative Environments",
      "mitigation": "Ensure a strict separation between administrative and non-administrative environments. Use dedicated and hardened administrative workstations (Privileged Access Workstations - PAWs) or secure virtual environments for all administrative tasks. These administrative environments must not be used for general activities like email, web browsing, or using office software. Enforce multi-factor authentication, strong access controls, and comprehensive logging for all access to and from administrative tools and workstations.",
      "check": "Are administrative tasks performed from dedicated, hardened systems that are isolated from the general user network? Are the tools used for administration (e.g., SSH clients, RDP clients) also used for non-administrative tasks on the same machine? Is there a policy for Privileged Access Workstations (PAWs)?",
      "asvs": "Derived from BSI IT-Grundschutz principles, such as network separation (NET.1.1) and secure administration (related to SYS.1.2, SYS.1.3). The core concept is the use of a dedicated, hardened environment for privileged access (e.g., a Privileged Access Workstation - PAW). @BSI_ID: SYS.1.6.A5 (example: Secure Administrative Workstation).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_Windows_Server_2016_edition_2021.pdf?__blob=publicationFile&v=2 (Example: BSI Windows Server administration concepts)",
      "detectionLogic": "This rule identifies technical assets that are used for administrative purposes (e.g., using SSH or other DevOps protocols to manage backend systems) while simultaneously being used for general, non-administrative purposes (e.g., being a desktop/browser or having connections to the internet). This lack of separation creates a significant risk.",
      "riskAssessment": "The likelihood of exploitation is considered high, as general-purpose workstations are frequently targeted by malware. The impact is determined by the highest sensitivity (CIA rating) of the systems being administered from the insecure workstation. A compromise of the workstation can lead to a complete compromise of all administered systems.",
      "falsePositives": "A model might show a single 'Developer Desktop' asset for both administrative and general use. In reality, the developer might use a separate, isolated virtual machine (VM) for administrative tasks on that desktop. If this separation is not explicitly modeled, this risk may be flagged based on the available information.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "61_sec8.ts",
      "bsiCode": "NET.3.1",
      "id": "net31-admin-tools-spof",
      "title": "Single Point of Failure in Administration Tools (BSI NET.3.1)",
      "description": "If administrative tools or capabilities fail and there are no redundant systems or alternative",
      "impact": "A lack of redundant or alternative administration paths can cause prolonged outages, hinder incident response, and",
      "action": "Implement redundancy and alternative administration paths (e.g., out-of-band management, emergency console access); document and test failover.",
      "mitigation": "Ensure that critical administration tools are designed for high availability by marking them as 'redundant: true' in the model.",
      "check": "Review the model to identify critical assets. For each, verify that they are managed by at least one administration tool marked as redundant.",
      "asvs": "BSI NET.3.1: A13, A22, A26 (Managementnetz, Notfallvorsorge, Hochverfügbarkeit)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Contingency_planning_for_the_failure_of_an_IT_system_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "The rule treats an 'administration tool' as any asset with usage 'devops' or technologies such as",
      "riskAssessment": "Impact scales with the availability requirement of the managed asset.",
      "falsePositives": "The model may not capture out-of-band or emergency administration procedures that serve as alternatives.",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "61_sec9.ts",
      "bsiCode": "NET.3.1",
      "id": "net-3-1-unprotected-management-channels",
      "title": "Unprotected Router/Switch Management Channel",
      "description": "Management and monitoring channels for routers, switches, and other network/administrative components (e.g., SSH/HTTPS/SNMP) that lack strong authentication and transport encryption can be spoofed or tampered with. Attackers may inject fake alerts/commands or trick administrators into executing changes, leading to unauthorized configuration, traffic redirection, or outages.",
      "impact": "Compromise of device management can enable manipulation of configurations (Tampering), rerouting/blackholing or traffic interception (Information Disclosure), and service disruption up to backbone outage (Denial of Service). In effect, an attacker abuses administrative privileges to impact confidentiality, integrity, and availability across connected systems and network segments.",
      "action": "Harden network device management: prefer out-of-band management, restrict source IPs, require mTLS/SSHv2 with strong keys, disable Telnet/HTTP/SNMPv1, enable ACLs/timeouts, and centralize logging/alerting.",
      "mitigation": "Use mutually authenticated and encrypted management protocols (e.g., SSHv2, HTTPS with client certificates). Limit management access to dedicated networks and allowlisted sources. Disable legacy/unused services and in-band management where possible. Enforce MFA for privileged consoles, log administrative actions, and require four-eyes approval for high-impact changes.",
      "check": "Inspect all incoming links targeting network/administrative assets (routers, switches, monitoring, build/CI, container/IDP, registries). Are the links encrypted (TLS or VPN)? Is authentication strong (no anonymous/basic credentials)? Do links cross trust boundaries or originate from internet-exposed sources? Verify ACLs restricting management access.",
      "asvs": "BSI IT-Grundschutz NET.3.1 (A4 Schutz der Administrationsschnittstellen, A13 Managementnetz, A18 ACLs, A19 Switch-Ports, A21 IAM) and DER.1.A7 (Protokollierung von sicherheitsrelevanten Ereignissen).",
      "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/IT-Grundschutz/Kompendium/kompendium_node.html",
      "detectionLogic": "Treat an asset as a network/administrative target when its technology is administrative (Monitoring, BuildPipeline, ContainerPlatform, IdentityProvider, WAF/IDS/IPS, Vault, Service* components, LoadBalancer/ReverseProxy) or it has tags like '@Device:Router', '@Device:Switch', '@Capability:NetworkManagement', '@Role:NetworkAdministrator'. For each incoming link that crosses a trust boundary, raise the risk if the link uses weak authentication (none/credentials) OR an unencrypted protocol (no TLS and no VPN). Increase likelihood to VeryLikely when the source is internet-exposed or both weaknesses exist. Impact scales with the target’s CIA requirements; multi-tenant and core control planes (e.g., Vault/IdP/ContainerPlatform) are treated as VeryHigh impact. Data-breach scope includes the target and all its direct downstream links.",
      "riskAssessment": "Channels without authentication and encryption are high-risk. Impact is derived from the device’s confidentiality/integrity/availability needs and the blast radius of its role (e.g., routing/identity/control plane). Successful exploitation can enable widespread data exposure and outages.",
      "falsePositives": "May be a false positive if compensating controls not visible in the model exist (e.g., management happens only via a secured jump host or VPN with strong client auth, or strict operational procedures requiring out-of-band verification). Missing model details about authentication can also lead to false flags.",
      "cwe": "841",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "62_sec1.ts",
      "bsiCode": "NET.3.2",
      "id": "ddos-on-network-component-net3.2",
      "title": "DDoS on Network Entry Component (Firewall/WAF) — BSI NET.3.2",
      "description": "A Distributed Denial-of-Service (DDoS) attack (e.g., TCP SYN flooding, UDP packet storms) can overwhelm a perimeter component such as a firewall, WAF, reverse proxy, gateway, IPS, or load balancer. Excessive connection setup and packet processing exhausts resources, causing service degradation or outage for systems behind the component.",
      "impact": "Loss of availability for services and assets behind the overloaded entry component; potential outage of entire network segments; disruption of business processes with financial and reputational consequences for critical systems.",
      "action": "Implement and regularly test DDoS resilience for internet-facing network entry points.",
      "mitigation": "Use dedicated DDoS mitigation (e.g., upstream/anycast scrubbing); enable SYN cookies and connection limits; configure UDP/ICMP rate limiting and timeouts; deploy scalable architectures and HA pairs; filter at upstream providers; tune conntrack/state tables; maintain playbooks and monitoring with threshold-based alerts.",
      "check": "Is a DDoS mitigation solution (cloud or provider) in front of internet-facing entry points? Are SYN/UDP rate limits and timeouts configured and tested? Is monitoring in place with alarms and runbooks? Has failover and capacity under stress been validated (e.g., synthetic load or provider test)?",
      "asvs": "BSI IT-Grundschutz: NET.3.2 (Protection against DoS) — notably NET.3.2.A1 (Planning protection), A2 (Firewall rules), A19 (Rate limits/SYN/UDP), A23 (Monitoring).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
      "detectionLogic": "Raise a risk for in-scope TechnicalAssets whose technology is WAF, ReverseProxy, Gateway, IPS, or LoadBalancer and that are internet-facing (either directly via the 'internet' flag or indirectly via an incoming link from an internet-exposed source). Determine impact using the highest availability requirement among targets of the component’s outgoing links; if none exist, fall back to the component’s own availability. Attach the component’s trust boundary as context and ignore out-of-scope assets.",
      "riskAssessment": "Likelihood is Very Likely for public-facing entry components due to the prevalence of volumetric and protocol DDoS. Impact scales with the highest availability of protected services: Operational→Medium, Important/Critical→High, Mission-Critical→Very-High; the component’s own high availability rating can raise impact.",
      "falsePositives": "Possible false positive if a robust, dedicated third-party DDoS mitigation/scrubbing service is deployed in front of the component and modeled separately, or if capacity is significantly over-provisioned and validated by regular tests. Also possible if the asset is not actually reachable from the internet in the deployed topology.",
      "cwe": "770",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "62_sec2.ts",
      "bsiCode": "NET.3.2",
      "id": "unauthorized-firewall-access",
      "title": "Unauthorized Access to Firewall or Gateway",
      "description": "If an attacker gains unauthorized access to a network security component such as a firewall, gateway, or load balancer—or to its management interface—they can manipulate its files and configuration.",
      "impact": "A successful attack can lead to a complete compromise of the protected network segments. Attackers could bypass security controls to access internal systems, exfiltrate sensitive data, or launch Denial-of-Service (DoS) attacks by blocking legitimate traffic. This compromises the Confidentiality, Integrity, and Availability of all assets behind the security component.",
      "action": "Secure Administrative Access to Network Security Components",
      "mitigation": "Restrict access to management interfaces using dedicated, secured networks (e.g., management VLANs) and jump hosts. Enforce strong, multi-factor authentication (MFA) for all administrative access. Use encrypted protocols (e.g., SSH, HTTPS) for all management communication. Apply the principle of least privilege for administrative roles. Regularly audit configurations, rule sets, and access logs for unauthorized changes or suspicious activity. Keep the component's firmware/software patched and hardened by disabling unnecessary services.",
      "check": "Is administrative access to the component logged and monitored? Is strong MFA required for all administrative users? Are management interfaces isolated from general network traffic? Are all management connections encrypted?",
      "asvs": "BSI IT-Grundschutz NET.3.2 Firewall",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_1_Firewall_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers for network security components (such as firewalls, gateways, WAFs, reverse proxies, load balancers) that have weakly protected or unencrypted administrative communication links. It also flags components where no administrative link is modeled at all, as this represents a potential blind spot.",
      "riskAssessment": "The impact is rated High or Very High, as compromising such a component affects all the assets it protects. The likelihood depends on the security of the management interface. An unauthenticated or unencrypted interface exposed to untrusted networks poses a Very Likely risk. An interface with only basic password authentication is rated Likely. If no management interface is modeled, the risk is assumed to be present.",
      "falsePositives": "The model might not fully represent all access control mechanisms like jump hosts or out-of-band management, which could lead to a false positive. The risk might be accepted if compensating controls are in place and documented.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "62_sec3.ts",
      "bsiCode": "NET.3.2",
      "id": "firewall-bypass-via-protocol-manipulation",
      "title": "Firewall Bypass via Network Protocol Manipulation (BSI NET.3.2)",
      "description": "Attackers can exploit fundamental mechanisms within network protocols (e.g., fragmentation attacks)",
      "impact": "A successful bypass of firewall rules grants an attacker unauthorized access to a protected network segment.",
      "action": "Harden firewall and network segmentation rules",
      "mitigation": "Ensure that firewalls are stateful and properly configured to handle protocol anomalies like fragmented packets.",
      "check": "Are firewalls stateful and configured to reassemble fragmented packets before analysis? Is there a regular",
      "asvs": "Derived from BSI IT-Grundschutz Baustein NET.3.2 'Firewall'. This threat corresponds to the potential for",
      "cheatSheet": "https://www.owasp.org/index.php/Testing_for_Firewall_(OWASP-CM-008)",
      "detectionLogic": "This risk is triggered for every communication link that crosses a network-based trust boundary.",
      "riskAssessment": "The likelihood of exploitation is elevated for connections originating from the internet. The impact is calculated",
      "falsePositives": "This risk might be a false positive if the firewall in place is a sophisticated Next-Generation Firewall (NGFW) or",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "62_sec4.ts",
      "bsiCode": "NET.3.2",
      "id": "misconfigured-firewall",
      "title": "Misconfigured Firewall (BSI-based)",
      "description": "An incorrectly configured or operated firewall can seriously impact the availability of services. If firewall rules are set incorrectly, for example, network access can be blocked. Furthermore, faulty configurations can lead to IT systems no longer being fully protected or not protected at all. In the worst case, this makes internal services accessible to attackers.",
      "impact": "A misconfigured firewall can lead to either denial-of-service for legitimate users (if rules are too strict) or unauthorized access to internal systems (if rules are too lenient). This can compromise the Confidentiality, Integrity, and Availability (CIA) of the protected assets, potentially leading to data breaches, service disruption, and unauthorized system control.",
      "action": "Review and Harden Firewall Configuration",
      "mitigation": "Ensure all firewall, WAF, and reverse proxy components have a documented, reviewed, and hardened configuration. Implement a strict change management process for firewall rules. Regularly audit the rule set to remove obsolete or overly permissive rules. Employ a 'default-deny' policy. Use automated tools to scan for configuration weaknesses.",
      "check": "Is there a documented configuration standard for firewalls/WAFs? Is there a formal change review process for firewall rules? Are the rules audited regularly? Are there any 'allow any/any' rules connecting different trust zones?",
      "asvs": "BSI IT-Grundschutz NET.3.2 Firewall",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_2_Firewall_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any technical asset identified as a network security control point, such as a WAF, Reverse Proxy, Gateway, IDS, or IPS. The risk is generic as the model cannot verify the actual configuration. The severity increases based on the sensitivity of the assets it protects.",
      "riskAssessment": "The likelihood is considered 'Likely' due to the complexity and criticality of firewall configurations, where small errors can have large consequences. The impact is calculated based on the highest CIA requirements of the technical assets directly communicating with the firewall component. If a firewall protects mission-critical assets, the impact is very high.",
      "falsePositives": "This is a generic risk based on the presence of a firewall-like component. It may be a false positive if the component's configuration is indeed hardened, regularly audited, and managed under a strict, proven process. This must be verified manually.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "63_sec1.ts",
      "bsiCode": "NET.3.3",
      "id": "unregulated-it-administration-ism2.2",
      "title": "Insufficient Regulation of IT Administration Responsibilities (BSI-based)",
      "description": "IT administration involves diverse tasks across various components. If responsibilities and processes are not clearly regulated or are unknown to the personnel in charge, significant security gaps can arise. Necessary administrative tasks might be neglected, performed by unauthorized personnel lacking full context, or conflicting measures might be taken by different teams. This is particularly critical when roles such as application operations and system operations are not clearly separated, despite being interconnected.",
      "impact": "A lack of clear administrative regulations can lead to a loss of control, potentially compromising all three security goals. Systems may become partially or completely unavailable (Denial of Service). Administrators with excessive or ill-defined permissions might access confidential information beyond their need-to-know basis (Information Disclosure). The overall integrity of systems can be threatened, leading to a general loss of control over the IT landscape.",
      "action": "Establish and Enforce Clear IT Administration Roles, Responsibilities, and Processes",
      "mitigation": "Clearly define and document all IT administration responsibilities and associated processes. Assign specific roles for distinct administrative domains (e.g., application, system, database, network). Enforce the principle of least privilege, ensuring administrators only have the rights essential for their tasks. Avoid using shared administrative accounts. Implement a formal process for granting and revoking administrative privileges. Ensure all administrators are aware of and trained on these regulations.",
      "check": "Are administrative roles and responsibilities clearly documented? Is there a separation of duties between different administrative domains? Is the principle of least privilege enforced for all administrative accounts? Are there multiple, distinct administrative access paths to a single critical component?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Identity and Access Management), particularly requirements concerning the principle of least privilege for administrators (ORP.4.A5) and segregation of duties (ORP.4.A6).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
      "detectionLogic": "This risk is identified by detecting technical assets, especially critical backend systems, that are accessible by multiple distinct administrative sources. An 'administrative source' can be an asset tagged with an administrator role or a component used for DevOps purposes. A high number of such sources accessing a single asset suggests a potential lack of regulated responsibilities and increases the attack surface.",
      "riskAssessment": "The likelihood increases with the number of administrative access paths to a single asset. The impact is determined by the confidentiality, integrity, and availability requirements of the targeted asset. A mission-critical database accessed by numerous administrators poses a very high impact.",
      "falsePositives": "The model cannot verify the existence or enforcement of organizational policies. Multiple administrative access paths might be legitimate, necessary, and well documented. This risk should be validated by reviewing the organization's identity and access management policies for administrators.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "63_sec10.ts",
      "bsiCode": "NET.3.3",
      "id": "vpn-planning-configuration-operation",
      "title": "VPN Planning, Configuration & Operation Weakness (BSI NET.3.3)",
      "description": "VPNs protect sensitive data across untrusted networks using cryptography and mutual authentication. If planning, selection, configuration, or operation is weak, the VPN can become a high-impact entry point into the institutional network. Typical causes include missing requirement analysis, insecure defaults on VPN endpoints, poorly configured remote-access clients, unverified service providers, and insufficient monitoring or access review. Remote users connecting from unmanaged or insecure devices further increase exposure.",
      "impact": "A flawed VPN can enable unauthorized access into internal networks, exposing Confidentiality (e.g., data exfiltration), Integrity (e.g., manipulation via tunneled access), and Availability (e.g., outages through misrouting or DoS amplification). Cascading compromise of many connected systems is possible.",
      "action": "Plan, harden, and continuously monitor VPN endpoints and access.",
      "mitigation": "Implement: 1) Formal VPN plan with clear responsibilities, user groups, and rights (A1). 2) Evaluate and contract providers with SLAs and verify compliance (A2). 3) Secure installation by qualified staff with pre-go-live testing (A3). 4) Baseline hardened configurations and periodic reviews (A4). 5) Disable stale VPN accounts/tunnels promptly; restrict access to business hours (A5). 6) Requirements analysis covering processes, access paths, users, auth, and responsibilities (A6). 7) Technical design for crypto suites, endpoints, allowed protocols/services, and reachable subnets (A7). 8) VPN security policy, training, and user handouts (A8). 9) Fit-for-purpose product selection (A9). 10) Operating concept including QA, monitoring, maintenance, training, and authorization (A10). 11) Allow tunnels only between intended systems/services using suitable protocols (A11). 12) Centralized account and access management for remote-access VPNs (A12). 13) Integrate VPN components with the firewall and document the setup (A13).",
      "check": "Is there a documented VPN plan and operating concept? Are provider SLAs monitored? Are endpoint/client configurations hardened and periodically reviewed? Are unused accounts/tunnels disabled promptly and access time-boxed? Are crypto suites and reachable subnets explicitly defined? Is remote access centrally managed and integrated with the firewall? Are VPN logs monitored and correlated?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein NET.3.3 VPN; related: ORP.4, OPS.1.1.2, OPS.1.1.3, OPS.1.2.5, CON.1; references ISO/IEC 27033-5 and NIST SP 800-77.",
      "cheatSheet": "https://www.bsi.bund.de/EN/Topics/ITGrundschutz/itgrundschutz_node.html",
      "detectionLogic": "This rule flags likely VPN endpoints/concentrators by focusing on administered, backend assets with significant CIA ratings. Heuristics: (1) assets receiving 'DevOps' usage links (proxy for administrative/remote-ops paths); (2) exclusively backend technologies; (3) higher CIA requirements increase impact. If the model explicitly contains VPN signals—asset titles containing 'VPN', 'Gateway', 'Concentrator', 'Remote Access', or link protocols mentioning 'IPsec', 'OpenVPN', 'WireGuard', 'TLS VPN'—treat them as strong matches. The risk escalates with the asset’s criticality and the presence of incoming administrative links.",
      "riskAssessment": "Likelihood is considered 'Likely' due to omnipresent human error and configuration drift in VPN operations. Impact scales with the CIA requirements of the affected asset and whether it mediates access between untrusted and internal networks.",
      "falsePositives": "May be a false positive for non-VPN backend assets or where zero-trust access, strong automation, audited change control, and hardened baselines materially minimize human-error exposure. Provide evidence (policy, automation, monitoring) to downgrade.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "63_sec11.ts",
      "bsiCode": "NET.3.3",
      "id": "disruption-by-it-administration-t5.158",
      "title": "Disruption by IT Administration (BSI T 5.158)",
      "description": "Even when IT administration tasks are performed without error, they can inadvertently disrupt the institution's IT services.",
      "impact": "The primary impact is the disruption of service availability, either immediately by violating maintenance windows or delayed due to unforeseen side effects of administrative changes.",
      "action": "Implement and Enforce a Strict Change Management Process",
      "mitigation": "Implement and strictly enforce a formal change management process for all IT administration activities, as described in BSI control OPS.1.1.A15.",
      "check": "Is there a formal change management process in place? Are maintenance windows defined and respected? Are changes tested in a separate environment before production deployment? Are rollback procedures available and tested?",
      "asvs": "Corresponds to BSI IT-Grundschutz Threat T 5.158 (Incorrect planning or implementation of changes). Mitigation is covered by controls like OPS.1.1.A15 (Patch and change management).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_server_operation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to any in-scope, non-client technical asset that requires administration (e.g., servers, applications, databases, network components).",
      "riskAssessment": "The impact of the risk directly correlates with the availability requirement of the administered technical asset. A higher availability requirement (e.g., 'mission-critical') results in a higher impact.",
      "falsePositives": "This risk might be considered a false positive if the organization has an exceptionally mature and rigorously tested change management process that effectively eliminates unforeseen side effects and strictly adheres to non-disruptive maintenance schedules.",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "63_sec2.ts",
      "bsiCode": "NET.3.3",
      "id": "insufficient-documentation-bsi-ism2.2",
      "title": "Insufficient Documentation (BSI ISM.2.2)",
      "description": "Documentation can be insufficient if information about IT components (e.g., configuration or access rights) has not been recorded or is incomplete.",
      "impact": "Insufficient documentation can lead to misconfigurations and flawed IT administration, which can compromise the Confidentiality, Integrity, and Availability (CIA) of the affected systems.",
      "action": "Establish and Maintain Comprehensive System Documentation",
      "mitigation": "Establish and enforce a process for creating, maintaining, and regularly reviewing system documentation.",
      "check": "Is there a formal process for system documentation? Is the documentation for critical systems complete, current, and regularly reviewed?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1 (General IT Operation), Requirement OPS.1.A9 (Documentation of the regular IT operation) as per Edition 2023.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_General_IT_operation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI OPS.1)",
      "detectionLogic": "This is an organizational risk that can be difficult to verify from a technical model alone.",
      "riskAssessment": "The likelihood is considered 'Likely' as insufficient documentation is a very common organizational weakness.",
      "falsePositives": "This risk can be considered a false positive if the organization has a robust and mature documentation process that is consistently followed,",
      "cwe": "732",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "63_sec3.ts",
      "bsiCode": "NET.3.3",
      "id": "net-3-3-vpn-over-privileged-access",
      "title": "NET.3.3 VPN: Over-Privileged or Poorly Governed Access",
      "description": "VPN endpoints, gateways, and their administrative components often end up with broad, persistent reach into internal networks.",
      "impact": "Compromise or misuse of a VPN endpoint/gateway or its admin plane can grant wide network reach (east-west and north-south),",
      "action": "Harden VPN endpoints and enforce least privilege with strong identity, short-lived credentials, MFA, and timely off-boarding.",
      "mitigation": "Restrict VPN reach to defined subnets and services; avoid generic 'super-user' or 'any-to-any' access; disable split tunneling unless explicitly justified;",
      "check": "Are VPN assets explicitly modeled (e.g., '@Component:VPN', '@Tag:VPN-Gateway')? Is split tunneling disabled by default?",
      "asvs": "Mapped to BSI NET.3.3 (A1–A5, A7, A10–A13) with related governance in ORP.4 and cryptographic controls in CON.1.",
      "cheatSheet": "BSI IT-Grundschutz Baustein NET.3.3 VPN – planning, secure configuration, product selection, and periodic access review.",
      "detectionLogic": "This rule looks for technical assets tagged as VPN endpoints or privileged admin components (e.g., '@Component:VPN', '@Tag:VPN-Gateway', '@Role:Administrator')",
      "riskAssessment": "Impact is derived from the highest confidentiality, integrity, and availability of all reachable assets.",
      "falsePositives": "Central gateways or monitoring hubs may legitimately have many links but be constrained by strong segmentation, per-tunnel ACLs,",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "63_sec4.ts",
      "bsiCode": "NET.3.3",
      "id": "insufficiently-secured-admin-access",
      "title": "Insufficiently Secured Administrative Access",
      "description": "Administrative access can expose sensitive data and powerful functions (e.g., configuration changes, user management, operational data). If these administrative channels are not robustly secured, unauthorized actors may gain privileged access, enabling data disclosure, manipulation, or service disruption and threatening all CIA objectives.",
      "impact": "A successful exploitation of an insecure administrative channel can lead to a complete compromise of the target system, including data breaches, configuration manipulation, and service outages. It can also serve as a pivot point for further attacks within the infrastructure.",
      "action": "Secure Administrative Access Channels",
      "mitigation": "Administrative communication links must be strongly secured. Use encrypted protocols (e.g., HTTPS, SSH, FTPS, RDP with TLS), strong multi-factor authentication, and strict authorization. Apply network-level protections (VPNs, IP filtering), especially when crossing trust boundaries. Access credentials must not be transmitted in clear text. Enforce least privilege for administrative roles.",
      "check": "Are all administrative links (e.g., `usage: devops` or admin-tagged clients) encrypted? Is strong authentication (2FA, client certificates, externalized via IdP) enforced? Are VPN/IP filters used across trust boundaries, especially for internet exposure?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.2.A16 (Secure administration of IT systems)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_2_Regular_operations_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Analyze all communication links: flag those used for administration (either `usage: devops` or links from human-operated clients tagged `@Role:Administrator`). Raise a risk if any of the following hold: (1) protocol is unencrypted; (2) authentication is `none` or credentials-only; (3) the link crosses a trust boundary without VPN or IP filtering—especially when one side is internet-facing.",
      "riskAssessment": "Likelihood increases when administrative interfaces are reachable from untrusted networks or use weak/no authentication. Impact scales with the CIA rating of the target asset and processed/stored data. Compromising admin access to a mission-critical system implies very high impact due to privileged control.",
      "falsePositives": "May be a false positive if compensating controls exist but are not modeled (e.g., hardened bastion hosts or firewalls enforcing strict IP filtering). Treat plain 'credentials' as weak for admin access; in low-risk environments with strong policies this may be acceptable, but generally credentials-only are insufficient.",
      "cwe": "522",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "63_sec6.ts",
      "bsiCode": "NET.3.3",
      "id": "staff-shortage-administrators",
      "title": "Staff Shortage Among Administrators",
      "description": "A shortage of administrative personnel, whether due to insufficient planning, overcommitment, or external factors such as a pandemic, can prevent necessary administrative tasks from being completed in a timely manner.",
      "impact": "If administrative tasks are neglected or performed incorrectly due to staff shortages, critical security vulnerabilities may go unpatched, misconfigurations may occur, and system availability may be compromised.",
      "action": "Ensure adequate staffing, cross-training, and contingency planning for administrators",
      "mitigation": "Implement robust personnel and resource planning for administrative roles to ensure adequate staffing levels.",
      "check": "Is there a documented process for personnel capacity planning for IT administration? Are substitution rules for critical administrators defined, documented, and tested?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Personnel), especially ORP.2.A1 (Personnel requirements analysis) and ORP.2.A5 (Substitution rules).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.2)",
      "detectionLogic": "This is an organizational risk that is difficult to detect automatically. However, its potential impact can be highlighted by identifying the critical technical assets managed by administrators.",
      "riskAssessment": "The likelihood is HIGH if a staff shortage is a known organizational issue or if there is no formal capacity planning or substitution rules.",
      "falsePositives": "This risk is raised based on the presence of an administrative role tag on a technical asset. It does not verify the actual staffing levels of the responsible team.",
      "cwe": "1126",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "63_sec7.ts",
      "bsiCode": "NET.3.3",
      "id": "insufficient-separation-of-admin-tools",
      "title": "Insufficient Separation of Administration Tools",
      "description": "Administration tools grant extensive access to an institution's IT systems. If these tools are inadequately secured, for example, by being insufficiently separated from non-administrative applications, they can be compromised. This can occur when the same client system or application (e.g., a web browser or SSH client) is used for both privileged administrative tasks and general daily use (e.g., browsing the web, checking email). An attack originating from the non-administrative context can then pivot to compromise the administrative session.",
      "impact": "If an attacker gains access to an administration tool through a less secure context, they can gain extensive permissions. These permissions can be abused for various attacks, such as sabotaging IT administration, performing unauthorized administrative actions, or escalating privileges further into the network. This endangers the confidentiality, integrity, and availability of all systems managed by that tool.",
      "action": "Use dedicated and hardened administrative clients",
      "mitigation": "Administrative tasks should be performed from dedicated and hardened systems (e.g., Privileged Access Workstations - PAWs), which can be physical or virtual machines. These systems should be isolated from the general corporate network and have no access to the internet or email. The tools used for administration (browsers, terminals) must not be used for any non-administrative purpose. If dedicated systems are not feasible, use separate user profiles or browser profiles for administrative and regular tasks, although this provides weaker separation.",
      "check": "Are administrative tasks performed from dedicated, hardened systems? Are the client applications (e.g., browsers, SSH clients) used for administration strictly isolated from those used for daily business like email and general web browsing?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.5.A4 (Separate clients for administration)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Logging_edition_2023.pdf?__blob=publicationFile (Note: The specific requirement A4 is in the German version of the 'System- und Anwendungsadministration' Baustein, which is part of the broader OPS group).",
      "detectionLogic": "This rule identifies technical assets that are used by humans as clients (e.g., Desktops, DevOps Clients) and have outgoing communication links for both administrative purposes (usage: 'devops') and regular business purposes (usage: 'business'). This mixing of contexts on a single client system represents the vulnerability.",
      "riskAssessment": "The likelihood is considered high if a client mixes administrative and business usage contexts. The impact is determined by the highest sensitivity (a combination of Confidentiality, Integrity, and Availability) of the assets being administered via the 'devops' communication links. Compromising a client that administers mission-critical systems has a very high impact.",
      "falsePositives": "A model might show a single asset (e.g., 'Developer Desktop') with mixed-use communication links. In reality, the user may be employing mitigating controls not captured in the model, such as using separate virtual machines or heavily restricted profiles on that single desktop. This should be verified before accepting the risk.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "63_sec8.ts",
      "bsiCode": "NET.3.3",
      "id": "failure-of-administration-capabilities",
      "title": "Failure of Administration Capabilities / SPOF in Ops Tools (BSI CON.1.A4; supports NET.3.3 VPN availability)",
      "description": "If administration capabilities fail and there is no redundancy or alternative due to poor planning, related IT administration activities cannot be carried out until the failure is resolved. In the worst-case scenario, the entire IT infrastructure is restricted, unavailable, or non-functional. Administration tools can also fail due to their own administration, e.g., through misconfiguration, a faulty patch, or a change introduced by an IT administration activity, creating a Single Point of Failure (SPOF). This is particularly relevant for core access components such as VPN endpoints/concentrators governed by NET.3.3.",
      "impact": "The failure of a non-redundant administration tool can render the systems it manages inoperable or unmanageable, directly impacting their availability. This can lead to widespread service disruptions, violating SLAs and causing significant business harm.",
      "action": "Ensure redundancy and tested fallback for critical administration/operations tools and platforms (including VPN endpoints).",
      "mitigation": "Ensure that all technical assets performing critical administrative or operational functions are designed with redundancy (e.g., active-passive, active-active clustering). If a tool is identified as a Single Point of Failure (SPOF), implement a redundant instance or a documented, tested manual fallback/recovery procedure that can be executed if the primary tool fails. Change management processes for these tools should be particularly rigorous and include staged rollouts and quick rollback.",
      "check": "Are critical administration tools (like build pipelines, container orchestrators, identity providers, VPN concentrators) configured to be redundant? Is the 'redundant' flag in the model accurately set for these assets? Is there a documented and tested fallback procedure in case of failure?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Contingency Management), specifically requirement CON.1.A4 (Redundancy of platforms); also aligned with NET.3.3 VPN regarding availability and secure operation of VPN endpoints.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Contingency_Management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
      "detectionLogic": "This rule scans all technical assets and flags non-redundant administrative/operational tools. It checks assets whose `technology` is one of: BuildPipeline, SourcecodeRepository, ArtifactRegistry, CodeInspectionPlatform, Monitoring, IdentityProvider, Vault, HSM, ContainerPlatform, ServiceMesh, Scheduler, LoadBalancer, ReverseProxy, WAF, IDS, IPS, ServiceRegistry. Assets marked `outOfScope` or with `redundant=true` are ignored. A risk is raised only if the tool has at least one outgoing `communicationLink` with `usage === DevOps` to an existing target asset—indicating it actively manages other components and thus represents a Single Point of Failure (SPOF). For each such tool, the rule derives impact from the highest availability requirement among the managed targets.",
      "riskAssessment": "Impact scales with the highest availability requirement among the assets managed by the non-redundant tool: Important → Medium, Critical → High, Mission-Critical → Very High. Likelihood is `Likely` by default because administrative tools change frequently and outages due to updates or misconfiguration are plausible.",
      "falsePositives": "A risk might be flagged for a tool that is not critical for immediate production availability (e.g., a development-only tool or an offline analytics platform). It can also be a false positive if a documented and effective manual fallback procedure exists but is not captured in the model.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "63_sec9.ts",
      "bsiCode": "NET.3.3",
      "id": "misleading-it-administration",
      "title": "Misleading IT Administration",
      "description": "If IT administrators are misled, for example by false information, they may respond incorrectly.",
      "impact": "Being tricked into performing unauthorized administrative actions can lead to data or system manipulation (loss of integrity),",
      "action": "Implement and Enforce Strict Administrative Procedures with Verification",
      "mitigation": "Establish and enforce strict change management and incident response processes for all administrative tasks.",
      "check": "Are all administrative actions required to follow a documented process? Is there a requirement for out-of-band verification for critical administrative tasks?",
      "asvs": "Derived from BSI IT-Grundschutz Threat CON.8 (Manipulation of information). This is primarily an operational security and social engineering threat.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/CON_8_Manipulation_of_information_Edition_2023.html",
      "detectionLogic": "This is an operational risk that applies to any technical asset that requires administration. The risk is triggered for backend systems,",
      "riskAssessment": "The impact of a successful attack is directly related to the confidentiality, integrity, and availability requirements of the targeted technical asset.",
      "falsePositives": "This risk is process-related and cannot be fully confirmed or denied solely by the technical model. The model identifies assets where this risk would have a high impact.",
      "cwe": "285",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "64_sec1.ts",
      "bsiCode": "NET.3.4",
      "id": "inadequate-nac-planning-net-2-1",
      "title": "Inadequate NAC Planning or Implementation (BSI NET.2.1)",
      "description": "If not all IT systems relevant for Network Access Control (NAC) are recorded in IT asset management, a NAC solution cannot be adequately planned.",
      "impact": "Flaws in NAC planning and implementation can lead to unauthorized network access, granting attackers a foothold in internal networks. This can result in the compromise of sensitive data (Information Disclosure), lateral movement (Elevation of Privilege), or disruption of services (Denial of Service, Availability).",
      "action": "Review and Enhance NAC Strategy and Implementation",
      "mitigation": "Ensure a complete IT asset inventory exists and that all assets are modeled within appropriate network trust boundaries.",
      "check": "Are all network-connected assets registered and modeled within a defined network trust boundary? Do all communication links crossing network boundaries use strong, non-replayable authentication and explicit authorization policies?",
      "asvs": "BSI IT-Grundschutz: NET.2.1 Network Access Control",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_2_1_Network_Access_Control_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified in two ways: 1. When a communication link crosses a network-level trust boundary without strong authentication (e.g., 'none') or without specified authorization. 2. When a network-relevant technical asset is not placed inside any trust boundary, indicating a potential gap in asset management, which is a prerequisite for effective NAC.",
      "riskAssessment": "Impact is rated based on the sensitivity of the target asset and the data transferred. The likelihood is high for unauthenticated connections or unmanaged assets. The risk of data breach is considered probable when sensitive data is transferred over weakly protected links.",
      "falsePositives": "The model might not explicitly show a central NAC or authenticating proxy, making direct connections appear unauthenticated. This risk should be verified against the actual network architecture.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "64_sec2.ts",
      "bsiCode": "NET.3.4",
      "id": "inadequate-endpoint-integration-and-orchestration-con6",
      "title": "Inadequate Endpoint Integration and Orchestration (related to BSI CON.6)",
      "description": "A lack of, or poorly implemented, orchestration tools, security policies, and standardized processes for managing endpoints can lead to significant security gaps. Endpoints may be integrated into the network in an uncoordinated manner, making it difficult to enforce secure, role-based authentication and commissioning procedures. This can result in endpoints being placed in incorrect network segments, using weak authentication methods, or having their communication capabilities impaired.",
      "impact": "If endpoints are not managed and segmented correctly, this can lead to a variety of security incidents. Protected devices might be exposed in less secure network zones, making them vulnerable to attack. The use of weak authentication can allow for spoofing and unauthorized access. These failures can compromise the confidentiality, integrity, and availability of data, lead to privilege escalation, and cause service disruptions.",
      "action": "Implement Standardized Endpoint Onboarding and Management with proper Network Access Control (NAC).",
      "mitigation": "Establish and enforce a comprehensive strategy for endpoint management. Utilize orchestration tools to automate and standardize the configuration of endpoints. Define clear security policies, requirements, and commissioning processes for all device types. Ensure the Network Access Control (NAC) solution can enforce these policies, including strong authentication and correct network segmentation for different endpoint groups. Regularly audit endpoint configurations and network segments to ensure compliance.",
      "check": "Is there a central endpoint management or orchestration tool? Are there documented standards and onboarding processes for endpoints? Does the NAC solution enforce strong authentication and network segmentation based on defined policies?",
      "asvs": "BSI IT-Grundschutz Baustein CON.6: Netz-Zugangskontrolle (Network Access Control)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Network_access_control_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is detected by identifying its symptoms on client-type technical assets. The rule checks for two primary conditions: 1. Client assets using weak or no authentication on communication links that cross trust boundaries. 2. Sensitive client assets being placed in the same network trust boundary as less-secure assets (e.g., internet-facing systems), indicating poor segmentation.",
      "riskAssessment": "The likelihood is considered high if symptoms like weak authentication are present, as this directly indicates a failure in policy enforcement. The impact is determined by the sensitivity (CIA ratings) of the misconfigured endpoint and the data it handles. A highly confidential client in a poorly segmented network or using no authentication to access critical systems poses a very high risk.",
      "falsePositives": "The model might not fully capture the specifics of the NAC implementation or other compensating controls (e.g., host-based firewalls). A finding of 'weak authentication' could be a false positive if the target system is a public, low-value service where authentication is not required.",
      "cwe": "287",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "64_sec3.ts",
      "bsiCode": "NET.3.4",
      "id": "weak-network-access-authentication",
      "title": "Weak Authentication for Network Access (based on BSI INF.5.A10)",
      "description": "If secure authentication methods (like EAP with strong ciphers) are not supported or not enforced for network access, insecure protocols such as EAP-MD5 or MAC-based authentication might be used. This facilitates spoofing, replay, or man-in-the-middle attacks, allowing unauthorized systems to gain access to the network.",
      "impact": "An attacker can impersonate a legitimate device to gain unauthorized network access. If the network is not properly segmented for devices authenticated with weak methods, the attacker can gain extensive communication capabilities, potentially accessing sensitive systems, intercepting traffic, and compromising the confidentiality, integrity, and availability of data and services within the target network.",
      "action": "Enforce Strong, Encrypted Authentication for Network Access and Segment Networks",
      "mitigation": "Use strong, certificate-based authentication methods like EAP-TLS for network access whenever possible. Avoid using weak or non-existent authentication. If weak authentication (like MAC-based filtering or credentials over unencrypted protocols) is unavoidable for certain legacy devices, those devices must be placed in a strictly segregated network zone (VLAN) with tight firewall rules that only permit required communication to specific targets.",
      "check": "Are all network access points (@Network:WLAN, LAN ports) configured to enforce strong authentication? Is MAC-based authentication used? If so, are those devices in a separate, restricted network segment? Are credentials for network access ever sent over unencrypted protocols?",
      "asvs": "BSI IT-Grundschutz INF.5.A10 (Use of secure authentication methods)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_WLAN_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule detects communication links that cross network boundaries with weak authentication methods. Weak authentication is identified if the link uses no authentication, sends credentials over an unencrypted protocol, or is explicitly tagged as using a weak method like MAC-based authentication (`@authentication:mac-based`).",
      "riskAssessment": "The likelihood is high if no authentication is used, or likely if weak methods are used. The impact is determined by the sensitivity of the data traversing the link and the criticality of the assets within the target network segment. A flat, unsegmented network significantly increases the potential impact.",
      "falsePositives": "The risk might be a false positive if there are other compensating controls not modeled, such as a physically secured network where only trusted devices can be connected, or if the target network for the weak authentication is an isolated guest network with no access to internal resources.",
      "cwe": "287",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "64_sec4.ts",
      "bsiCode": "NET.3.4",
      "id": "misconfiguration-of-nac-components",
      "title": "Misconfiguration of Network Access Control (NAC) Components",
      "description": "Due to human error, inadequate processes, or insufficient personnel capacity and resulting time constraints,",
      "impact": "Incorrect NAC configuration can lead to two primary failure modes:",
      "action": "Implement Strict Configuration and Change Management for NAC Components",
      "mitigation": "Establish and enforce strict change management and configuration review processes for all NAC components (e.g., assets tagged as @NACComponent).",
      "check": "Is there a documented change control process for NAC configurations? Are configurations regularly audited for correctness and consistency? Is access to configure NAC components tightly controlled and logged?",
      "asvs": "V4.1 Access Control Design",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any technical asset identified as a core part of the Network Access Control infrastructure (tagged with `@NACComponent`).",
      "riskAssessment": "The likelihood is considered higher for manually managed systems or those involving custom-developed parts.",
      "falsePositives": "This risk can be considered a false positive if robust, automated, and audited configuration management processes are in place and visible within the threat model.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "64_sec5.ts",
      "bsiCode": "NET.3.4",
      "id": "inadequate-change-validation-process",
      "title": "Inadequate Validation of NAC Configuration Changes (BSI NET.3.4.A13/A11/A16)",
      "description": "Weak or missing validation in NAC-related change processes (e.g., on RADIUS, access switches, wireless controllers, supplicants) can introduce configuration errors. This may grant devices excessive access, assign them to the wrong VLAN/microsegment, disable NAC on ports, or deny legitimate access entirely. Disabling or loosening controls (e.g., IEEE 802.1X, authorization rules) without proper review can lead to unauthorized network access, lateral movement, or outages.",
      "impact": "Misconfigurations in NAC components directly threaten Confidentiality, Integrity, and Availability. Unauthorized endpoints may gain network access (confidentiality breach), authorized devices may be blocked (availability loss), and inconsistent authorization states can enable tampering or spoofing (integrity risk). Critical blast radius exists for central components like RADIUS, identity stores, and access switches.",
      "action": "Enforce Formal Validation for All NAC-Relevant Changes",
      "mitigation": "Establish a robust change process for NAC: peer review, test/stage validation, automated policy linting, and rollbacks for RADIUS, authorization rules, switch/WLAN authenticator settings, and supplicant configs. Require tickets with justification, impact analysis, and audit trails. Permit disabling NAC only via documented emergency policies with time-bounded approvals and monitoring.",
      "check": "Is there a documented workflow requiring validation of NAC changes (RADIUS policies, VLAN assignments, downloadable ACLs, 802.1X settings)? Are changes tested in staging with sample devices? Are NAC status changes (e.g., 802.1X disabled on ports) detected and alerted? Are configuration writes to central NAC components logged and reviewed?",
      "asvs": "BSI IT-Grundschutz NET.3.4 Network Access Control — esp. NET.3.4.A11 (Sichere Konfiguration), NET.3.4.A12 (Monitoring), NET.3.4.A13 (Validierungsvorgaben), NET.3.4.A16 (Protokollierung).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_4_Network_Access_Control.pdf",
      "detectionLogic": "Organizational risk with technical hotspots: flag assets where inadequate validation is most harmful — central RADIUS/AAA, identity providers, access control points (reverse proxies/WAFs as policy edge), CI/CD for network configs, and critical data/secret stores. Also highlight endpoints and client systems whose supplicant/policy deployment is frequently changed. The rule raises risks on these assets to surface where strict validation is essential.",
      "riskAssessment": "Likelihood increases with frequent changes, large device diversity (LAN/WLAN/IoT), or shared admin models. Impact scales with asset criticality and role: central AAA/IdP, production databases, and core security controls drive Very High impact if misconfigured. Weak logging/monitoring further raises residual risk.",
      "falsePositives": "If the organization operates a mature NAC change process with enforced reviews, staged validation, automated checks, and continuous monitoring, this finding may be informational. Verification requires reviewing documented procedures, change tickets, and audit logs.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "64_sec6.ts",
      "bsiCode": "NET.3.4",
      "id": "disabled-or-insufficient-network-access-control-net-3-4",
      "title": "Disabled or Insufficient Network Access Control (NAC) (BSI NET.3.4)",
      "description": "If Network Access Control (NAC) is temporarily or permanently disabled on network access points (e.g., switches/WLAN), network access is insufficiently protected. This allows unauthorized individuals or devices to access the network or lets insecure IT systems obtain excessive communication privileges. Similarly, if endpoint compliance is not verified before granting access, devices with vulnerabilities (e.g., outdated anti-virus) can connect.",
      "impact": "Unauthorized access may lead to disclosure, manipulation, or deletion of information (breaching confidentiality, integrity, and availability). Malware can be introduced, causing lateral movement, data breaches, and service disruptions.",
      "action": "Enforce, continuously monitor, and test NAC at all access layers",
      "mitigation": "Ensure strong NAC is active on all access ports and WLAN. Require certificate-based or account-based authentication (IEEE 802.1X/EAP) and verify endpoint compliance before granting access. Use least-privilege authorization (e.g., VLAN assignment/micro-segmentation), monitor for disabled NAC, and audit for policy violations or non-compliant devices.",
      "check": "Are NAC policies defined and enforced on all critical segments and ports? Is 802.1X with EAP in use and coupled to RADIUS? Are compliance checks and alerts for disabled NAC, unusual RADIUS failures, or MAC-auth exceptions in place?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein NET.3.4 Network Access Control, addressing risks from weak or missing NAC and insufficient endpoint compliance checks.",
      "cheatSheet": "BSI NET.3.4 Network Access Control (German) – guidance on IEEE 802.1X, RADIUS, MAC authentication, compliance checks, and operations.",
      "detectionLogic": "Detect links that simulate bypassing NAC: a client-type asset outside a network trust boundary connects to an in-boundary target over a link without authentication, VPN, or IP filtering. Such a path indicates that an untrusted endpoint could attach directly to internal segments without NAC enforcement.",
      "riskAssessment": "Likelihood increases when generic client devices can connect without network-layer protection. Impact aligns with the CIA requirements of the target asset and the data processed; compromises of mission-critical or strictly confidential environments are high impact.",
      "falsePositives": "Out-of-band compensating controls (e.g., dedicated NAC appliances, port security, physical controls) might not be modeled. Validate findings against actual NAC deployment, RADIUS policies, and switch/WLAN configurations.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "64_sec7.ts",
      "bsiCode": "NET.3.4",
      "id": "uncontrolled-network-access-on-nac-failure",
      "title": "Uncontrolled Network Access on NAC Failure",
      "description": "Failure or unavailability of central Network Access Control (NAC) components (e.g., RADIUS servers) can lead to unintended network access behavior. This can be caused by a lack of redundancy, software faults, DoS attacks, or network disruptions. Depending on the configuration of network infrastructure (e.g., switches), this can result in endpoints either losing all network access (fail-close) or gaining unrestricted access (fail-open).",
      "impact": "A fail-open scenario bypasses network segmentation and access controls, potentially exposing sensitive systems and data to unauthorized access, leading to severe confidentiality and integrity breaches. A fail-close scenario causes a denial-of-service, impacting the availability of applications and services within the affected network segment.",
      "action": "Implement a resilient and explicitly fail-closed NAC architecture with health monitoring and alerting.",
      "mitigation": "Ensure that all critical NAC components are implemented in a redundant, highly-available cluster. Explicitly configure the fail-state of network switches to 'fail-close' (deny access by default) to prevent unauthorized access. Only allow 'fail-open' where a documented, risk-accepted exception exists for a low-sensitivity environment. Implement comprehensive, end-to-end health monitoring for the NAC control path (RADIUS, directory services, network reachability) with immediate alerting and tested RADIUS-down policies.",
      "check": "Are NAC components (e.g., RADIUS servers) modeled as redundant? Is the fail-state (fail-open/fail-close) documented, configured, and regularly tested? Is end-to-end monitoring in place for NAC and its dependencies with alerting on failure?",
      "asvs": "V13 Network Architecture",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Network_Access_Control_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Raise this risk for technical assets that are potential NAC components (technology: 'IdentityProvider') that are in-scope and not redundant ('redundant: false'). The risk applies to the entire trust boundary guarded by that component. As an additional signal, prioritize cases where the trust boundary contains highly sensitive assets (high C/I/A).",
      "riskAssessment": "Impact is derived from the maximum Confidentiality, Integrity, and Availability of assets within the affected trust boundary. Fail-open primarily threatens Confidentiality and Integrity; fail-close threatens Availability. Likelihood is 'Likely' when the NAC component is a single point of failure (non-redundant).",
      "falsePositives": "An 'IdentityProvider' asset may serve purposes other than NAC (e.g., SSO for web apps). The model may also omit external redundancy (e.g., load balancers or managed HA), which could lead to over-reporting. Validate with architecture documentation.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "64_sec8.ts",
      "bsiCode": "NET.3.4",
      "id": "inadequate-log-data-protection-ops-1-1-5-g5",
      "title": "Inadequate Protection of Personal Log Data (BSI OPS.1.1.5.G 5)",
      "description": "An insufficient administration concept, inadequate implementation, excessive data retention periods, or a lack of coordination with the works council and data protection officer can lead to inadequate protection of personal log data. This could allow the creation of user profiles, enabling employees to be tracked over time.",
      "impact": "The unauthorized creation of user profiles from log data constitutes a significant violation of employee privacy and data protection regulations (e.g., @DataType:PII). This can lead to severe legal penalties, substantial fines, and reputational damage. It also undermines the trust between the organization and its employees, potentially affecting morale and productivity.",
      "action": "Establish and enforce a data-protection-compliant logging concept",
      "mitigation": "Develop a comprehensive logging concept in close coordination with the data protection officer and, where applicable, the works council. This concept must clearly define the purposes for logging, specify exactly what data is collected, establish appropriate and justifiable retention periods, and implement strict, role-based access controls for all log data. Employ pseudonymization or anonymization techniques wherever the purpose of logging allows. The entire logging process, from collection to deletion, should be regularly audited for compliance.",
      "check": "Is there a documented logging concept approved by the data protection officer? Are data retention periods defined, technically enforced, and justified? Are access rights to log data restricted on a strict need-to-know basis and regularly reviewed? Are there technical measures in place to prevent unauthorized analysis of log data?",
      "asvs": "BSI IT-Grundschutz-Kompendium 2023: OPS.1.1.5 Protokollierung (Logging), Gefährdung G 5 'Unzulässige Auswertung von Protokollierungsdaten' (Unauthorized evaluation of log data).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/OPS/OPS_1_1_5_Protokollierung_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for `datastore` assets that store `data_asset` items tagged as `@DataType:Logging`. The risk is considered more severe if the log data has a `confidentiality` level of `Restricted` or higher, as this indicates the presence of sensitive or personal information.",
      "riskAssessment": "The impact escalates with the confidentiality of the log data being stored. `Restricted` personal data implies a medium impact, while `Confidential` or `Strictly Confidential` data (such as detailed user activity logs) leads to a high or very high impact. The likelihood is considered `Likely` by default, as a lack of specific, modeled controls for log data implies a higher chance of misuse or unauthorized access.",
      "falsePositives": "This may be a false positive if a compliant and comprehensive logging concept is in place but its controls are not explicitly modeled. For example, if log data is managed by a specialized SIEM or log management platform with robust, audited access controls and retention policies, this risk may be considered mitigated, even if not visible in the model. Applying a `log-protection-compliant` tag to the datastore can suppress this finding.",
      "cwe": "532",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "65_sec1.ts",
      "bsiCode": "NET.4.1",
      "id": "unencrypted-telecommunication-eavesdropping",
      "title": "Eavesdropping on Unencrypted Telecommunication (related to BSI NET.4.1 / G 0.35)",
      "description": "When phone calls or other sensitive data are transmitted unencrypted over a telecommunication system (TK-Anlage), attackers can eavesdrop on or intercept the communication. Threats include tapping phone lines, intercepting VoIP streams, listening in on PBX systems, or capturing unencrypted data packets. Specific risks arise when voicemail systems forward audio files via unencrypted email, making them easy to intercept. Additionally, system features (e.g., call monitoring, 'Zeugenschaltung') can be abused to covertly listen to conversations, often enabled by publicly available system knowledge.",
      "impact": "Eavesdropping on unencrypted TK traffic compromises confidentiality, potentially leaking business secrets, personal data, or other sensitive information. Consequences include financial loss, reputational harm, legal liabilities, and regulatory penalties.",
      "action": "Encrypt Telecommunication Channels and Secure TK-Systems",
      "mitigation": "Encrypt all TK-related communication (voice, fax, voicemail, signaling) with state-of-the-art cryptography (e.g., TLS, SRTP for VoIP, STARTTLS for email, HTTPS for web). Harden PBX and VoIP gateways: disable unused features, enforce strong authentication, and restrict admin access. Ensure voicemails are protected both in transit and at rest.",
      "check": "Are all TK communication protocols (VoIP, email forwarding, signaling) encrypted? Are PBX/VoIP gateways securely configured and hardened? Are voicemail messages protected during transmission and storage?",
      "asvs": "BSI IT-Grundschutz: G 0.35 Mithören von Nachrichten; NET.4.1 TK-Anlagen; NET.1.2 VoIP, specifically NET.1.2.A5 'Encryption of VoIP data'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_2_VoIP_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "The rule checks:",
      "riskAssessment": "Likelihood is 'Likely' for unencrypted links and 'Very Likely' if crossing trust boundaries or involving unencrypted email forwarding. Impact depends on data confidentiality: 'Very High' for Strictly Confidential information.",
      "falsePositives": "False positives are rare. Only acceptable if TK traffic is carried over a fully isolated, physically secured network (e.g., air-gapped). Identification of 'telecom systems' for voicemail scenarios is heuristic and may not always be perfect.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "65_sec2.ts",
      "bsiCode": "NET.4.1",
      "id": "eavesdropping-via-microphone",
      "title": "Eavesdropping via Microphone in End Devices",
      "description": "Microphones in end devices can be exploited for eavesdropping in rooms. This can happen in two primary ways:",
      "impact": "Unauthorized eavesdropping leads to a severe breach of confidentiality. Sensitive conversations, business secrets, or personal data could be captured,",
      "action": "Harden End Devices, Manage Permissions, and Secure Remote Control Features",
      "mitigation": "Implement strong authentication for any feature capable of remotely activating hardware like microphones. For mobile or client applications,",
      "check": "Are there any features that allow remote, unauthenticated, or weakly authenticated microphone activation? Do applications on the device request microphone permissions?",
      "asvs": "OWASP MASVS-PLATFORM-2: Request only the minimum set of permissions required. OWASP IoT Top 10: I5 - Lack of Physical Hardening.",
      "cheatSheet": "https://owasp.org/www-project-internet-of-things/assets/cheatsheets/IoT_Firmware_Security_Cheat_Sheet.pdf",
      "detectionLogic": "This risk is raised for technical assets that are classified as end-user clients, which could plausibly have microphones.",
      "riskAssessment": "Likelihood is higher for devices with known insecure remote-control features or for applications that request microphone permissions without a clear, user-facing purpose.",
      "falsePositives": "The risk might be a false positive if the device physically has no microphone, if remote activation features are properly secured with strong authentication,",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "65_sec3.ts",
      "bsiCode": "NET.4.1",
      "id": "toll-fraud",
      "title": "Toll Fraud (Gebührenbetrug)",
      "description": "Toll fraud aims to shift the cost of telecommunication services (such as phone calls or data transfers) to a third party.",
      "impact": "The primary impact of toll fraud is direct financial loss for the organization. It can also lead to a denial-of-service condition if all available communication lines are occupied by fraudulent calls, disrupting legitimate business operations.",
      "action": "Secure Configuration and Monitoring of Telephony Systems",
      "mitigation": "Harden all telephony systems against abuse. Restrict access to administrative functions and remote maintenance ports (e.g., via VPN and strong multi-factor authentication).",
      "check": "Are remote administration interfaces for telephony systems secured? Are high-risk features like DISA and unauthenticated call forwarding disabled? Is there a policy for call barring, and is it enforced? Are call logs actively monitored for signs of fraud?",
      "asvs": "BSI IT-Grundschutz Kompendium: NET.4.1 TK-Anlagen",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_TK-Anlage_Edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers for any technical asset tagged as a `@Category:Telephony` system.",
      "riskAssessment": "The likelihood of exploitation is significantly higher for internet-exposed telephony systems, especially those with weak authentication. The impact is determined by the business-criticality (Integrity and Availability) of the telephony service. A successful attack against a mission-critical system will have a high impact due to both financial loss and operational disruption.",
      "falsePositives": "This risk is raised based on the presence of a 'Telephony' tag and high-level architectural properties. A manual check is required to confirm if the asset is indeed a telephony system and if its specific, detailed configuration is vulnerable. The system might have compensating controls not captured in the model.",
      "cwe": "306",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "65_sec4.ts",
      "bsiCode": "NET.4.1",
      "id": "unauthorized-access-to-phonebook-on-public-phones",
      "title": "Unauthorized Access to Electronic Phonebook on Publicly Accessible Telephones",
      "description": "Telephones, especially those not assigned to a specific user and located in publicly accessible areas (e.g., parking garages, lobbies, or in front of access control systems), may have an electronic phonebook. If this phonebook contains internal contact numbers, these numbers could be exfiltrated by unauthorized individuals, such as visitors.",
      "impact": "Leakage of internal phone numbers can facilitate social engineering attacks, targeted phishing (vishing), or harassment of employees. It exposes internal organizational structure and contact information to unauthorized parties, which can be a valuable precursor for more sophisticated attacks.",
      "action": "Restrict Access and Sanitize Data on Public-Facing Devices",
      "mitigation": "Telephones in public areas should not store internal contact directories. If they must, access to the phonebook feature should be protected (e.g., with a PIN or other authentication). Physical access to such devices should be controlled where possible. Regularly review and sanitize the data stored on such devices to remove non-essential sensitive information. Ideally, use phones without a local contact storage feature for such locations.",
      "check": "Are there technical assets representing telephones in publicly accessible areas? Do these devices store a data asset representing an internal-only contact directory? Is access to this directory restricted?",
      "asvs": "Derived from BSI IT-Grundschutz principles regarding physical, environmental, and component security.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_component_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
      "detectionLogic": "This risk is detected for technical assets identified as telephones (via the '@BSI-Device:Telephone' tag) that are located in a 'public' context. An asset is considered public if it is directly exposed to the internet, resides in a trust boundary tagged with '@Access:Public', or is not located within any trust boundary at all. The risk is confirmed if this asset stores a data asset representing internal phone numbers.",
      "riskAssessment": "The likelihood is considered high if an unprotected telephone storing internal contacts is located in a public area. The impact is directly related to the confidentiality of the contact data; leakage of a restricted internal directory is more severe than a public-facing one. The impact escalates if the phone numbers belong to key personnel.",
      "falsePositives": "A risk might be flagged if the phonebook feature is disabled or protected by a strong PIN, but the model does not capture this specific control. The model might also incorrectly assume an area is 'public' if trust boundaries are not defined accurately.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "66_sec1.ts",
      "bsiCode": "NET.4.2",
      "id": "misconfiguration-voip",
      "title": "Misconfiguration of VoIP Components (BSI SYS.3.2.1)",
      "description": "A VoIP-based telephone system can be affected by misconfigurations in a similar way to a circuit-switched telephone solution.",
      "impact": "Misconfiguration of VoIP components can lead to a complete failure of the telephone infrastructure (Availability),",
      "action": "Implement Configuration Management and Hardening for VoIP Systems",
      "mitigation": "Establish a robust configuration and change management process for all VoIP components.",
      "check": "Is there a documented change management process for the VoIP infrastructure?",
      "asvs": "BSI IT-Grundschutz SYS.3.2.1 VoIP-Komponenten",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_VoIP_Komponenten.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset identified as a VoIP component via the '@Service:VoIP' tag.",
      "riskAssessment": "The likelihood of misconfiguration is considered 'likely' due to the inherent complexity of VoIP systems.",
      "falsePositives": "The risk might be flagged for a system that is managed via a highly mature, automated, and tested configuration management pipeline, which is not visible in the threat model.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "66_sec2.ts",
      "bsiCode": "NET.4.2",
      "id": "incorrect-voip-compression-configuration",
      "title": "Incorrect VoIP Compression Configuration (BSI-style)",
      "description": "Whether VoIP components are dedicated hardware appliances or software-based systems, their configuration is crucial for proper functionality. This includes settings for media stream transmission, especially the compression method used. An incorrectly configured or unsuitable compression method can lead to significant transmission problems.",
      "impact": "If an unsuitable method with excessive compression is used, voice quality often deteriorates, impacting the integrity of the communication. Conversely, if a method with too little compression is chosen, the data stream is not sufficiently reduced, which can overload the network and lead to a Denial of Service (DoS), impacting availability.",
      "action": "Review and Validate VoIP Compression Settings",
      "mitigation": "Ensure that the compression codecs and transmission methods selected for VoIP media streams are appropriate for the network's bandwidth and the required voice quality. The configuration should balance bandwidth savings with acceptable audio fidelity to prevent both poor quality (integrity loss) and network overload (availability loss). This configuration should be part of a standardized build and regularly reviewed, especially after network infrastructure changes.",
      "check": "Are the VoIP codecs and compression settings documented? Has the chosen configuration been tested under various network load conditions? Is there a process to review and approve changes to VoIP configuration?",
      "asvs": "Derived from BSI IT-Grundschutz principles. Does not map directly to a specific ASVS item, but relates to general secure configuration principles found in V11.1 (Configuration).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any technical asset explicitly tagged as a VoIP system. The model cannot verify the specific configuration, so it serves as a reminder to manually check that compression settings are optimized to prevent network overload (Denial of Service) and poor voice quality (Integrity degradation).",
      "riskAssessment": "The likelihood is considered 'Likely' as misconfigurations are a common operational issue, especially in complex network environments. The impact is directly related to the availability requirements of the communication service provided by the asset. If VoIP is mission-critical for business operations, the impact of a service degradation or outage is high.",
      "falsePositives": "This risk is a general best-practice check. A false positive occurs if the VoIP system is already correctly configured and optimized, which can only be verified by a manual review of the component's settings.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "66_sec3.ts",
      "bsiCode": "NET.4.2",
      "id": "unencrypted-telephony-voip",
      "title": "Unencrypted Telephony / VoIP (based on BSI CON.3)",
      "description": "If phone calls, VoIP calls, or related data (such as voicemail-to-email) are transmitted unencrypted, an attacker on the same network segment can intercept, eavesdrop on, and record the communication. This is especially true for VoIP media streams (e.g., using RTP) on data networks and for voicemail audio files sent via unencrypted email protocols (like plain SMTP).",
      "impact": "Successful interception of unencrypted telephony or VoIP communication compromises the confidentiality of conversations and any data transmitted therein. Attackers gain access to potentially sensitive or confidential information, leading to data breaches, espionage, and providing material for further social engineering attacks.",
      "action": "Enforce encryption for all telephony and VoIP-related communication",
      "mitigation": "All communication links carrying voice data or related messages (e.g., voicemail) must use strong, state-of-the-art transport-layer encryption. Use encrypted protocols like SMTPS/IMAPS (for voicemail), HTTPS, WSS, or tunnel traffic through a secure VPN. For VoIP-specific protocols, ensure signaling (like SIP) and media (like RTP) are both encrypted, for example by using TLS for signaling and SRTP for media streams. For voicemail-to-email functionality, the communication link from the telephony system to the mail server must use an encrypted protocol (e.g., SMTP with STARTTLS).",
      "check": "Review the configuration of all telephony systems, VoIP gateways, clients, and mail servers. Are all relevant communication links using encrypted protocols? Verify that protocols like plain SMTP, FTP, or unencrypted BINARY/TEXT are not used for transmitting voice data or voicemails. Confirm that VoIP clients are configured to prefer or require encrypted media (SRTP).",
      "asvs": "BSI IT-Grundschutz CON.3 VoIP",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_VoIP_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is detected when communication links are identified as potentially carrying telephony or VoIP data without encryption. The check specifically looks for:  1. Unencrypted protocols (like SMTP) sending data to a Mail Server, which is a common pattern for voicemail-to-email.  2. Technical assets explicitly tagged as `@Service:VoIP` communicating over generic unencrypted protocols like BINARY or TEXT, which could represent unencrypted media streams.",
      "riskAssessment": "The likelihood of exploitation is significantly increased if the unencrypted communication crosses any network trust boundary. The impact is directly related to the confidentiality of the data assets being transmitted over the link. A conversation about a 'Strictly Confidential' topic has a much higher impact than a public one.",
      "falsePositives": "This risk might be a false positive if the unencrypted communication occurs entirely within a fully trusted and physically secured network segment where interception is practically impossible. The generic detection for BINARY/TEXT protocols might flag non-VoIP traffic if the `@Service:VoIP` tag is misapplied to an asset not related to telephony.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "66_sec4.ts",
      "bsiCode": "NET.4.2",
      "id": "unauthorized-access-via-public-phone-port",
      "title": "Unauthorized Network Access via Publicly Accessible Phone (BSI NET.4.2)",
      "description": "Networked devices, such as VoIP phones, are sometimes located in areas with unrestricted physical access (e.g., lobbies, printer rooms, parking garages).",
      "impact": "Successful exploitation can lead to the leakage of sensitive organizational data, compromise of the endpoint device, and unauthorized access to internal networks. This can result in further attacks, data breaches, service disruptions, and a complete compromise of the network segment's security.",
      "action": "Implement Network Access Control and Network Segmentation for Publicly Accessible Devices",
      "mitigation": "Do not place network-connected devices in publicly accessible areas if possible. If unavoidable, apply layered security controls:",
      "check": "Are there networked devices (like VoIP phones) in publicly accessible areas? Is the network port they use protected by NAC (e.g., 802.1X)? Is the device on an isolated, restricted network segment (VLAN)?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein NET.4.2 (VoIP), specifically section 2.4 on misuse of publicly accessible phone connections. Aligns with OWASP ASVS V14.2 (Network Security) requirements for network segmentation and access control.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_VoIP_systems_edition_2022.pdf?__blob=publicationFile (BSI NET.4.2)",
      "detectionLogic": "This rule triggers for technical assets of type 'IoT device' that are located in a physically unrestricted area (indicated by the `@PhysicalAccess:Unrestricted` tag).",
      "riskAssessment": "The exploitation likelihood is considered **Very Likely** due to the ease of physical access. The impact is calculated based on the sensitivity (CIA ratings) of the internal assets the device connects to. If the network port provides access to a network with mission-critical systems, the impact is very high.",
      "falsePositives": "This can be a false positive if compensating controls like a robust Network Access Control (NAC) solution are in place and correctly configured, which would prevent an unauthorized device from gaining network access. The model should be updated to reflect this (e.g., by tagging the communication link).",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "67_sec1.ts",
      "bsiCode": "NET.4.3",
      "id": "lack-of-consumables-for-@AssetType:Fax-or-@AssetType:Printer",
      "title": "Lack of consumables for @AssetType:Fax/@AssetType:Printer devices (BSI G 0.6)",
      "description": "Devices that produce physical output, such as @AssetType:Fax machines or printers, depend on consumables like paper and toner for their operation.",
      "impact": "A lack of consumables leads to a denial of service for the affected device. This can disrupt business processes that rely on printed documents or faxes.",
      "action": "Implement Monitoring and Replenishment Procedures for Consumables",
      "mitigation": "Establish a process for regularly monitoring the levels of all necessary consumables (paper, toner, etc.) for dependent devices.",
      "check": "Is there a documented process for monitoring and replenishing consumables? Are personnel assigned to this task?",
      "asvs": "Derived from BSI IT-Grundschutz Threat G 0.6 (Failure of consumables) applied to component SYS.3.2.1 (@AssetType:Fax devices). This is an operational availability risk.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_Faxgeraete.html (BSI SYS.3.2.1)",
      "detectionLogic": "This risk is triggered for any technical asset that is explicitly marked with the `@consumable-dependent` tag.",
      "riskAssessment": "The likelihood is considered 'Likely' if a device is dependent on consumables, as operational oversights can easily occur without a robust replenishment process.",
      "falsePositives": "This risk might be a false positive if the organization has a highly reliable, automated, and tested replenishment system for consumables.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "67_sec2.ts",
      "bsiCode": "NET.4.3",
      "id": "insecure-unreliable-@AssetType:Fax-transmission",
      "title": "Insecure or Unreliable @AssetType:Fax Transmission",
      "description": "@AssetType:Fax transmissions over traditional networks (like the public switched telephone network) are susceptible to various failures.",
      "impact": "Failures in @AssetType:Fax transmission can lead to faulty business decisions based on incorrect or missing information, causing operational delays and potential financial damage. The misdelivery of faxes can result in a breach of confidentiality, leading to reputational damage, competitive disadvantage, and non-compliance with data protection regulations (like @DataType:PII).",
      "action": "Secure, Monitor, and Verify @AssetType:Fax Transmissions",
      "mitigation": "For sensitive data, replace traditional faxing with more secure, verifiable electronic communication methods. If faxing is unavoidable, use encrypted @AssetType:Fax-over-IP (FoIP) solutions. Implement strict procedures for managing @AssetType:Fax server address books and for sending highly sensitive documents (e.g., four-eyes principle). Implement monitoring and alerting for transmission failures. Establish a process for senders to verify the successful and correct receipt of critical faxes.",
      "check": "Are @AssetType:Fax transmissions encrypted? Is there monitoring and alerting for failed transmissions? Are there formal procedures for managing @AssetType:Fax address books and verifying receipt of sensitive documents?",
      "asvs": "BSI IT-Grundschutz: SYS.3.2.1 @AssetType:Fax Server (Threats T 2.50 Erroneous transmission of @AssetType:Fax documents & T 2.51 Erroneous sending of @AssetType:Fax documents)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2021/bausteine/sys/sys_3_2_1_faxserver_edition_2021.html",
      "detectionLogic": "Identifies communication links to or from technical assets tagged as `@AssetType:Fax-related` that use unencrypted protocols to transmit data. The risk level is determined by the sensitivity of the data assets being transferred.",
      "riskAssessment": "The likelihood is considered 'Likely' for any unencrypted @AssetType:Fax transmission, as both transmission errors and misdelivery are common issues with this technology. The impact is calculated based on the highest Confidentiality, Integrity, or Availability requirement of the data being sent. A breach of highly confidential data or the corruption/loss of mission-critical data results in a high impact.",
      "falsePositives": "The model cannot determine if out-of-band compensating controls exist, such as a sender manually calling the recipient to confirm receipt. A link might also be a modern, secure FoIP solution that is incorrectly modeled with a generic or unencrypted protocol.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "67_sec3.ts",
      "bsiCode": "NET.4.3",
      "id": "manipulation-of-@AssetType:Fax-address-books",
      "title": "Manipulation of @AssetType:Fax Address Books and Distribution Lists",
      "description": "In @AssetType:Fax machines or @AssetType:Fax servers (often integrated with groupware), address books and distribution lists are used to store recipient numbers.",
      "impact": "Manipulation of @AssetType:Fax address books can lead to a breach of confidentiality if sensitive documents are sent to incorrect recipients.",
      "action": "Implement Strict Access Control and Auditing for Address Books",
      "mitigation": "Restrict modification permissions for @AssetType:Fax and groupware address books to authorized personnel only.",
      "check": "Are permissions to modify @AssetType:Fax/groupware address books tightly controlled? Is there an audit trail for all changes with alerts on bulk edits? Are users aware of the risk of mis-sending faxes?",
      "asvs": "ASVS V4.0.3 - 4.1 Access Control",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for technical assets that function as a mail/@AssetType:Fax server or a standalone communication device (like an IoT device representing a @AssetType:Fax machine)",
      "riskAssessment": "The impact is determined by the highest confidentiality of data processed by the asset and the highest availability requirements.",
      "falsePositives": "This risk might be a false positive if robust, non-technical controls (like a mandatory four-eyes principle for all address book changes) are in place, which cannot be modeled.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "67_sec4.ts",
      "bsiCode": "NET.4.3",
      "id": "unprotected-shared-@AssetType:Fax-machine",
      "title": "Unprotected Shared @AssetType:Fax Machine (based on BSI)",
      "description": "In many organizations, @AssetType:Fax machines are shared among multiple users for economic reasons.",
      "impact": "If confidential or strictly confidential information is received via a physically unsecured @AssetType:Fax machine,",
      "action": "Implement Physical and Procedural Controls for @AssetType:Fax Machines",
      "mitigation": "Place @AssetType:Fax machines that receive sensitive information in a secure, access-controlled room.",
      "check": "Are @AssetType:Fax machines that handle sensitive data located in physically secure areas? Is access to these machines logged or restricted?",
      "asvs": "Derived from BSI IT-Grundschutz Catalog principle regarding the physical security of shared office equipment (CON.1).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_physical_security_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers for any technical asset identified as a @AssetType:Fax machine (via the `@AssetType:Fax` tag) that receives data assets rated 'restricted' or higher in confidentiality.",
      "riskAssessment": "The impact is calculated based on the highest confidentiality of the data received by the @AssetType:Fax machine. The likelihood of exploitation is considered 'Very Likely' due to the ease of simply walking up to the machine and reading the paper.",
      "falsePositives": "A false positive might occur if the model does not accurately represent the physical security of the @AssetType:Fax machine's location.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "67_sec5.ts",
      "bsiCode": "NET.4.3",
      "id": "remnant-data-on-@AssetType:Fax-systems",
      "title": "Remnant Data on @AssetType:Fax Systems (BSI SYS.2.5.A10)",
      "description": "Depending on the technical process used by @AssetType:Fax systems to store, process, or print information, remnant data can remain on the device after faxes are sent or received.",
      "impact": "If remnant data from @AssetType:Fax transmissions is not properly sanitized, it can lead to a breach of confidentiality.",
      "action": "Implement and Enforce Secure Data Sanitization Procedures",
      "mitigation": "For @AssetType:Fax servers, use encrypted file systems and ensure that temporary files and completed jobs are securely deleted using cryptographically strong erasure methods.",
      "check": "Are @AssetType:Fax servers configured to securely delete temporary files and data from swap/paging files? Do physical @AssetType:Fax devices have certified data sanitization features enabled? Is there a formal, audited process for decommissioning hardware containing sensitive data?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.2.5 (@AssetType:Fax and Multifunction Devices), specifically requirement SYS.2.5.A10 (Secure deletion of information).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_2_5_Fax_and_multifunction_devices_edition_2023.pdf?__blob=publicationFile (BSI SYS.2.5)",
      "detectionLogic": "This risk is raised for assets that could function as a @AssetType:Fax server or a physical @AssetType:Fax/multifunction device, such as 'Mail Server', 'Client System', or 'IoT Device'. The risk is triggered if these assets process or store data with a confidentiality rating of 'restricted' or higher, as remnant data would pose a significant risk.",
      "riskAssessment": "The likelihood is considered 'likely' if sensitive data is handled, assuming no specific sanitization methods are modeled. The impact is directly related to the confidentiality and integrity of the data processed or stored by the asset. A breach of 'strictly-confidential' data has a very high impact.",
      "falsePositives": "The risk may be a false positive if the asset is a modern cloud-based @AssetType:Fax service that contractually guarantees data sanitization, or if the specific device model has certified secure-deletion features enabled by default, which is not captured in the threat model.",
      "cwe": "459",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "67_sec6.ts",
      "bsiCode": "NET.4.3",
      "id": "spoofed-or-tampered-@AssetType:Fax",
      "title": "Spoofed or Tampered @AssetType:Fax Communication",
      "description": "@AssetType:Fax transmissions are a common medium for sending documents that must bear a signature to be valid. However, just as a false sender can be faked with a forged name and letterhead, a @AssetType:Fax transmission can also be manipulated. For example, signatures can be scanned from other documents and copied onto the @AssetType:Fax document. In general, it is impossible to tell whether a signature was genuinely made or is merely a reproduced graphic file.",
      "impact": "Damages occur when recipients view the information contained therein as authentic or even legally binding. This compromises the integrity and authenticity of the transmitted data, potentially leading to financial loss, unauthorized actions, or legal disputes.",
      "action": "Use More Secure Alternatives for Legally Binding Documents",
      "mitigation": "For documents requiring a legally binding signature, replace @AssetType:Fax transmissions with more secure methods like qualified electronic signatures (QES) or secure document portals with strong authentication. If @AssetType:Fax must be used, implement a secondary out-of-band verification process (e.g., a phone call to the sender) to confirm the authenticity of critical or high-value faxes before acting upon them. Clearly define in policies which types of information are not permitted to be sent or accepted via @AssetType:Fax.",
      "check": "Are there policies defining the acceptable use of @AssetType:Fax for sensitive or legally binding documents? Is there a more secure alternative available and mandated for such documents? If faxes are still used for critical transactions, is there a mandatory out-of-band verification process in place?",
      "asvs": "N/A (BSI-derived recommendation). The risk relates to the inherent weakness of the @AssetType:Fax medium itself, which is not directly covered by a single ASVS control. Related concepts fall under data authenticity verification (ASVS V4.2).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for any technical asset identified as an @AssetType:Fax system via the `@AssetType:Fax-gateway` tag. The risk applies to the asset itself and all data assets it processes, as the integrity of the communication cannot be guaranteed.",
      "riskAssessment": "The likelihood is 'Very Likely' due to the ease of forging faxes. The impact is directly related to the integrity requirement of the data assets transmitted via @AssetType:Fax. If data assets with high integrity requirements (e.g., contracts, financial instructions) are sent, the impact is 'High' or 'Very-High'.",
      "falsePositives": "This can be considered a false positive if the @AssetType:Fax system is used exclusively for non-sensitive, non-binding information for which forgery has no significant impact, and this is enforced by policy.",
      "cwe": "345",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "68_sec1.ts",
      "bsiCode": "OPS.1.1.1",
      "id": "insufficient-personnel-capacity-it-operations",
      "title": "Insufficient Personnel Capacity in IT Operations",
      "description": "IT operations personnel are responsible for the functionality of the entire IT infrastructure, without which an organization often cannot operate. IT systems are particularly vulnerable if IT operations lack sufficient capacity.",
      "impact": "Failure to properly execute operational processes due to personnel shortages or knowledge silos can lead to severe service disruptions (Availability). It can also degrade security posture, as tasks like monitoring, patching, and incident response are neglected, impacting Confidentiality and Integrity. This can result in business downtime, data breaches, and failure to meet service level agreements.",
      "action": "Ensure Sufficient Personnel Capacity and Know-How Redundancy",
      "mitigation": "Develop and maintain a strategic personnel capacity plan for IT operations. Implement robust substitution rules (Vertretungsregelungen) for all critical operational roles to avoid single points of failure.",
      "check": "Is there a documented capacity plan for IT operations? Are there defined and tested substitution plans for key operational personnel? Is there evidence of cross-training programs for the operations team? Are critical operational procedures well-documented and accessible?",
      "asvs": "BSI IT-Grundschutz: ORP.2 Personnel (esp. A5 Substitution rules) and OPS.1.1 General IT Operations (esp. A5 Sufficient personnel resources, A15 Handling of operational disruptions and failures).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_IT_operations_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Raise this organizational risk for technical assets that (a) have operational role tags such as 'role:operator', 'role:devops', 'role:sre', or '@Role:Administrator', or (b) demand high Availability or Integrity (≥ Critical). Increase likelihood if the asset lacks redundancy (redundant = false) as a proxy for single-person dependency; otherwise decrease it. Assets out of scope are ignored.",
      "riskAssessment": "The impact is determined by the availability and integrity requirements of the affected asset. An asset critical for business operations ('mission-critical') will suffer a higher impact from operational failure.",
      "falsePositives": "This risk is organizational and is inferred from technical attributes. An organization might have excellent personnel planning and substitution rules that are not visible in the threat model, which would make this a false positive. Verification requires checking the organization's operational and HR-related documentation.",
      "cwe": "404",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "68_sec2.ts",
      "bsiCode": "OPS.1.1.1",
      "id": "insufficient-it-operations-documentation",
      "title": "Insufficient IT Operations Documentation (BSI-based)",
      "description": "If IT operations activities rely on insufficient, outdated, or manipulated documentation, they can cause severe disruptions. This includes incorrect incident response, configuration errors, and delays in maintenance. Without proper documentation, operational knowledge can be lost and the ability to manage and secure IT systems is diminished. Causes include a lack of coordination with service providers, poorly defined documentation processes, or failure to keep documentation current.",
      "impact": "Direct consequences include disruptions to IT functionality and incorrect or delayed incident resolution, primarily affecting Availability and Integrity. If sensitive configuration details (such as credentials or architectural weaknesses) are part of poorly secured documentation, Confidentiality is also at risk. Ultimately, this can lead to system downtime, data loss or corruption, and security breaches.",
      "action": "Establish and maintain comprehensive and secure IT operations documentation",
      "mitigation": "Create and enforce a policy for IT operations documentation. Documentation must be comprehensive, up to date, and securely stored with appropriate access controls. It should cover system administration, configuration, incident response procedures, and dependencies. Ensure clear agreements with external service providers about their documentation responsibilities. Regularly review and audit the documentation for accuracy and completeness.",
      "check": "Is there a documented process for creating, maintaining, and storing IT operations documentation? Is the documentation for critical systems complete, accurate, and regularly reviewed? Are access controls for the documentation system in place and enforced? Are incident response playbooks based on this documentation?",
      "asvs": "Derived from the BSI IT-Grundschutz module OPS.1.1.2 (Administration), particularly requirements A5 (creation of administration documentation) and A6 (maintenance of administration documentation).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_2_Administration_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This is an organizational risk that applies to all technical assets requiring operational management. The risk is raised for all in-scope, non-client, server-side assets. The impact is assessed based on the asset's criticality, as poor documentation for a mission-critical system is far more dangerous than for a non-critical one.",
      "riskAssessment": "The likelihood is often 'Likely' or 'Very Likely' in environments without a formal, enforced documentation policy. The impact correlates with the CIA requirements of the operated technical asset. A mission-critical system suffering from poor documentation will result in a High or Very High impact, whereas a non-critical internal tool might result in a Low impact.",
      "falsePositives": "This risk is organizational and cannot be fully verified by a technical model alone. The organization may have excellent, up-to-date documentation stored in a separate system not visible to the model. Verification requires auditing the actual operational documentation and processes.",
      "cwe": "755",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "68_sec3.ts",
      "bsiCode": "OPS.1.1.1",
      "id": "inadequate-operational-resources",
      "title": "Inadequate Operational Resources (BSI OPS.1.1.A10)",
      "description": "Operational resources, which encompass all IT components used to perform IT operations tasks (e.g., build servers, monitoring systems, container platforms), are critical for the efficient and secure functioning of IT processes.",
      "impact": "The unavailability of critical operational resources can prevent the timely resolution of errors or deployment of security updates to the managed IT components.",
      "action": "Ensure Redundancy and Hardening of Operational Resources",
      "mitigation": "Treat operational infrastructure with the same criticality as the business systems it manages.",
      "check": "Are all technical assets with `usage: devops` or development-relevant technologies (build pipelines, repositories) configured as `redundant: true` in the model?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.A10 High availability of components for IT operations",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_IT_operation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies technical assets that are used for operational or development purposes (`usage: devops` or technologies like 'build-pipeline', 'sourcecode-repository', etc.) but are not marked as redundant (`redundant: false`).",
      "riskAssessment": "The likelihood is considered high for any non-redundant operational system, as single points of failure are prone to disruption.",
      "falsePositives": "A risk might be a false positive if redundancy is achieved through mechanisms not captured in the model, such as cloud-native auto-healing, auto-scaling groups, or a documented and tested manual failover plan that meets the availability requirements.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "68_sec4.ts",
      "bsiCode": "OPS.1.1.1",
      "id": "abuse-of-privileged-rights-by-operations-personnel",
      "title": "Abuse of Privileged Rights by Operations Personnel (OPS.1.1.1)",
      "description": "Privileged rights held by operations personnel (admins, service providers, and similar roles) can affect the entire IT landscape. If those rights are misused—intentionally or under coercion—to sabotage, manipulate, or spy, all core security objectives (Confidentiality, Integrity, Availability) for operated components and institutional data are endangered. Typical root causes include overly broad permissions, poor offboarding, absence of segregation of duties, or the use of shared/break-glass accounts.",
      "impact": "Misuse of privileged access can trigger data exfiltration, integrity loss of critical configurations, and service outages across multiple systems. The blast radius usually spans entire platforms and environments, with financial, legal, and reputational harm.",
      "action": "Enforce least privilege, segregation of duties, and strong privileged access management (PAM)",
      "mitigation": "Implement PoLP and role-based access with strict separation between admin and non-admin tasks. Use PAM with just-in-time elevation, MFA, session recording, and approval workflows. Eliminate shared/group admin accounts; use individual, named identities. Ensure rapid de-provisioning during offboarding and periodic recertification of rights. Log and continuously review all privileged operations.",
      "check": "Are privileged roles minimal and separated (SoD)? Are shared/break-glass accounts prohibited or tightly governed? Are admin actions audited and reviewed? Are offboarding and periodic access recertifications enforced? Is PAM with MFA and JIT used for all high-value assets?",
      "asvs": "Aligned with BSI IT-Grundschutz OPS.1.1.1 (Allgemeiner IT-Betrieb)—notably A2 (Rollen/Berechtigungen), A12 (klare Betriebsprozesse), A13 (Absicherung Betriebsmittel/Dokumentation), A21 (Einbindung ins Sicherheitsmonitoring)—and ORP.4 (Identity & Access Management).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile (BSI ORP.4)",
      "detectionLogic": "Flag technical assets tagged with privileged roles (e.g., `@Role:Administrator`, `@Role:SystemAdministrator`, `@Role:ExternalServiceProvider`, `@Role:ITSecurityOfficer`) or with `account-type:shared-privileged-account`. Treat multi-tenant and high-value assets as higher impact. Consider stronger signals when tags like `break-glass`, `no-PAM`, or `no-audit` co-occur.",
      "riskAssessment": "Likelihood is typically high where persistent privileged access exists without strong PAM or auditing. Impact scales with the asset’s confidentiality and mission criticality; compromise of mission-critical, multi-tenant, or platform assets yields very high impact.",
      "falsePositives": "Lower risk where compensating controls exist—e.g., robust PAM with session monitoring, JIT elevation, MFA, immutable audit logs, and frequent access reviews. Also less relevant for strictly OT/isolated systems when modeled with appropriate constraints and monitoring.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "68_sec5.ts",
      "bsiCode": "OPS.1.1.1",
      "id": "inadequate-physical-access-control-inf1",
      "title": "Inadequate Physical Access Control (BSI INF.1)",
      "description": "If there is insufficient protection against unauthorized physical access to premises where IT equipment is located, this can be used as a starting point for any type of attack or misuse.",
      "impact": "Unauthorized physical access can lead to hardware theft, tampering with systems, installation of malicious hardware or software, and unauthorized access to sensitive data directly from the console.",
      "action": "Implement and Enforce Physical Access Controls",
      "mitigation": "Implement multi-layered physical security controls for all areas containing critical IT assets. This includes locked doors, electronic access control systems with logging, surveillance cameras, and policies for visitor access. Server racks should be individually locked.",
      "check": "Are server rooms and data centers physically secured with access controls? Is access restricted to authorized personnel and logged?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein INF.1 (General Building), Requirement INF.1.A1 (Adequate access control).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for technical assets located within physical trust boundaries (e.g., On-Premises Data Center, Dedicated Hoster) that are not explicitly tagged as having adequate physical access controls.",
      "riskAssessment": "The likelihood of exploitation is considered high if no physical security measures are modeled for an on-premises or dedicated hosting environment.",
      "falsePositives": "A model may not fully represent all existing physical security controls. The absence of a tag does not definitively mean the control is missing in reality.",
      "cwe": "1250",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "68_sec6.ts",
      "bsiCode": "OPS.1.1.1",
      "id": "social-engineering-against-it-operations",
      "title": "Social Engineering against IT Operations (Spoofing)",
      "description": "If internal or external individuals deliberately present false information to IT operations personnel, for example by falsely impersonating an authorized person (spoofing),",
      "impact": "A successful social engineering attack against IT operations can compromise all primary security goals. Administrators could be tricked into disabling security controls,",
      "action": "Implement Strong Authentication and Verification for Administrative Actions",
      "mitigation": "Protect all administrative access with Multi-Factor Authentication (MFA).",
      "check": "Are all administrative interfaces and actions protected by MFA? Are there clear, mandatory procedures for verifying sensitive requests from users or other administrators?",
      "asvs": "V2.2.1 (MFA), V1.4.2 (Awareness Training)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Social_Engineering_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for technical assets managed by administrative roles that receive communication from potentially untrusted sources (e.g., the internet, general end-user systems)",
      "riskAssessment": "The likelihood is high if administrative assets are reachable from untrusted networks or systems with only single-factor authentication (e.g., username/password).",
      "falsePositives": "The model might not be aware of out-of-band mitigating controls, such as a separate, mandatory phone call verification process for all administrative actions, which would lower the actual risk.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "68_sec7.ts",
      "bsiCode": "OPS.1.1.1",
      "id": "disruption-of-it-operations",
      "title": "Disruption of IT Operations (BSI-based)",
      "description": "If the activities of IT operations are blocked or not carried out properly, the availability and integrity of the entire IT infrastructure can be impaired. This can be caused by various factors, including inadequately designed or procured IT components that are difficult to operate, poor process planning with unclear interfaces or responsibilities, and incorrect execution of tasks by operations personnel due to insufficient know-how or unclear agreements with service providers.",
      "impact": "A disruption in IT operations can lead to a significant reduction in the availability and integrity of business-critical systems. This can halt business processes, lead to data inconsistencies, and prevent services from being delivered to customers, resulting in financial and reputational damage.",
      "action": "Establish and Maintain Robust IT Operations",
      "mitigation": "Ensure that IT components are procured and designed with operability in mind (e.g., adequate monitoring, configuration, and redundancy). Define clear operational processes, interfaces, and responsibilities, especially for interactions between different teams and with external service providers. Provide operations personnel with adequate training and documentation for all relevant operational processes and systems. Implement a robust monitoring and incident management process to quickly detect and respond to operational issues.",
      "check": "Are operational requirements (like monitoring and redundancy) considered during procurement and development? Are operational processes and responsibilities clearly documented? Is there an ongoing training program for operations staff? Are interfaces to external service providers clearly defined and secured?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.1 (IT-Betrieb) and OPS.1.1.2 (Behandlung von IT-Problemen und Störungen).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_1_IT_Betrieb_Edition_2023.pdf?__blob=publicationFile (BSI OPS.1.1.1)",
      "detectionLogic": "This risk is detected by identifying common indicators of poor operational readiness and planning. This includes: critical operational assets lacking redundancy; assets managed by operations staff (indicating a dependency on human processes); insecure or undefined communication links between operational components or with external service providers.",
      "riskAssessment": "The impact is determined by the criticality (Availability and Integrity) of the affected assets. A lack of redundancy for a mission-critical database has a very high impact. The likelihood is considered higher for concrete findings like insecure interfaces or a lack of redundancy, and medium for organizational risks like dependency on staff know-how.",
      "falsePositives": "The model identifies potential weaknesses based on declared properties. A system might be considered non-redundant in the model but have high-availability mechanisms at a lower, unmodeled layer. An unauthenticated link might be protected by network-level controls not visible in the model.",
      "cwe": "732",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "69_sec1.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "unclear-admin-responsibilities-ism2.2",
      "title": "OPS.1.1.2: Unclear or Missing Regulations for IT Administration Responsibilities",
      "description": "IT administration spans diverse tasks across many components. If responsibilities and processes are not defined, or the responsible personnel are not aware of them, significant security gaps can arise.",
      "impact": "All three security pillars can be compromised. Availability may be reduced or eliminated, confidentiality can be breached by excessive rights, and integrity can be harmed through misconfiguration.",
      "action": "Define, document, and enforce clear IT administration roles and responsibilities.",
      "mitigation": "Establish and document responsibilities and processes for all administration tasks. Grant administrative privileges strictly by least privilege and enforce segregation of duties.",
      "check": "Are admin roles and responsibilities documented and communicated? Is there a formal approval process for granting admin rights? Is segregation of duties enforced? Are admin permissions reviewed periodically?",
      "asvs": "Derived from BSI IT-Grundschutz (OPS.1.1.2 Ordnungsgemäße IT-Administration). Related fundamentals include ORP.4.A6 (Segregation of duties), ORP.4.A13 (Rules for administration), and ORP.4.A14 (Assignment of access rights).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
      "detectionLogic": "Detect in-scope, non-client, non-external technical assets with incoming communication links from assets tagged with administrative roles (e.g., '@Role:Administrator', '@Role:Operator', 'role:devops-engineer').",
      "riskAssessment": "Likelihood is set to 'Likely' for administered critical systems (organizational threat). Impact is derived from the administered asset’s CIA ratings: higher confidentiality (e.g., Strictly Confidential) or critical availability elevates impact.",
      "falsePositives": "Models may find administrative access to a critical system even when procedures are well-defined. Organizational verification is required to confirm.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "69_sec10.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "human-error-in-administration",
      "title": "Human Error in IT Administration (BSI OPS.1.1.2 / G 0.14)",
      "description": "Human errors can never be completely ruled out and can have far-reaching consequences in IT administration.",
      "impact": "An administrative error can lead to misconfigurations that compromise system security, cause service disruptions, or lead to data breaches.",
      "action": "Harden administrative processes and controls: enforce least privilege, change management with peer review, MFA for admin access, comprehensive logging/alerting, and dedicated hardened admin workstations.",
      "mitigation": "To reduce the likelihood and impact of administrative errors, implement a combination of technical and procedural controls. This includes:",
      "check": "Are administrative actions logged and reviewed? Is there a formal change management process for critical systems?",
      "asvs": "This is an organizational and operational risk. Related ASVS controls include V1 'Architecture, Design and Threat Modeling', V4 'Access Control', and V14 'Configuration', as robust access controls and secure configuration can limit the blast radius of an administrative error.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk applies to any technical asset that is subject to administrative action. It is raised when an asset carries administrative role tags (e.g., '@Role:Administrator', '@Role:Developer', '@Role:DevOpsEngineer', '@Role:ExternalServiceProvider', '@Role:ITSecurityOfficer')",
      "riskAssessment": "The likelihood of human error is treated as 'Likely'. The impact scales with the asset’s CIA ratings: high or mission-critical confidentiality/integrity/availability elevates impact, and multi-tenancy can further increase it.",
      "falsePositives": "A model cannot see procedural controls. An organization might have excellent change management, peer review, and automation that significantly reduces the real-world likelihood of a damaging error.",
      "cwe": "668",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "69_sec11.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "disruption-by-it-administration-bsi-ops",
      "title": "Disruption by IT Administration Activities (BSI-related)",
      "description": "Even if IT administration tasks are performed without errors, they can still disrupt the institution's IT services.",
      "impact": "Disruption of IT services due to administrative activities can lead to a loss of availability for critical business functions.",
      "action": "Establish and Enforce Strict Change Management and Maintenance Window Policies",
      "mitigation": "Define and strictly enforce maintenance windows for all administrative activities on production systems. Implement a formal change management process that",
      "check": "Is there a formal, enforced change management process? Are there defined and respected maintenance windows for production systems? Are administrative changes tested in a non-production environment before deployment? Are rollback procedures documented and tested?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.5 (Patch and Change Management), Requirement A 6 'Planning of patch and change management processes'.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for technical assets with at least 'important' availability that receive administrative access.",
      "riskAssessment": "The likelihood is higher for systems with high complexity or many interdependencies where unforeseen side effects are more probable. It's also considered high if formal change management processes are lacking.",
      "falsePositives": "An organization might have a very mature and strictly enforced change management process that mitigates this risk effectively, even though the model shows administrative access to critical systems.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "69_sec2.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "insufficient-documentation-bsi",
      "title": "Insufficient Documentation (BSI CON.2 / OPS.1.1.2)",
      "description": "Documentation can be insufficient if information about IT components (e.g., configuration, dependencies, or access rights) is not recorded, is incomplete, or is not kept up to date.",
      "impact": "Insufficient documentation can lead to misconfigurations or general errors in IT administration, significantly compromising Confidentiality, Integrity, and Availability.",
      "action": "Establish and Maintain Comprehensive System Documentation",
      "mitigation": "Implement a robust process to ensure that all IT components, including their configurations, access rights, network connections, and dependencies, are documented accurately.",
      "check": "Is there an established process for creating and updating system documentation? Is this process integrated with change management?",
      "asvs": "Derived from BSI IT-Grundschutz Bausteine CON.2 (Configuration Management) and OPS.1.1.2 (Proper IT Administration), specifically requirements like CON.2.A5 (Documenting the configuration) and OPS.1.1.2.A23 (Keeping a system file).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_2_Configuration_management_edition_2023.pdf?__blob=publicationFile (BSI CON.2)",
      "detectionLogic": "This is a process-level risk that applies to any technical asset. It is particularly relevant for assets that are custom-developed, as their documentation is often less standardized than that of commercial off-the-shelf products.",
      "riskAssessment": "The likelihood is considered high if there is no formal, enforced process for documentation management.",
      "falsePositives": "This risk is organizational and cannot be definitively confirmed by a technical model alone. The presence of a `custom_developed_parts` flag or high CIA ratings only indicates a higher potential impact.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "69_sec3.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "excessive-administrative-permissions",
      "title": "Excessive Administrative Permissions",
      "description": "Excessively broad administrative permissions can be exploited for sabotage or for spying on information, which can then serve as a starting point for further attacks. This endangers all information security objectives (Confidentiality, Integrity, and Availability). The risk increases when offboarding processes are inadequate, allowing former administrators to retain privileged access.",
      "impact": "Abuse of excessive permissions can lead to unauthorized modification or destruction of data (Integrity), exposure of sensitive information (Confidentiality), and disruption or complete loss of services (Availability). An attacker with such privileges can create backdoors, erase audit logs, or escalate privileges within the infrastructure, potentially resulting in a complete system compromise.",
      "action": "Enforce the Principle of Least Privilege (PoLP) and Just-in-Time (JIT) access",
      "mitigation": "Review and restrict administrative permissions to the absolute minimum required for each role. Implement fine-grained access control aligned with job functions. Use a Privileged Access Management (PAM) solution to manage, monitor, and control privileged sessions. Employ just-in-time (JIT) access mechanisms that grant temporary permissions for specific tasks. Regularly audit administrative accounts, their assigned permissions, and their activity. Ensure a robust and timely offboarding process that revokes all access for departing personnel.",
      "check": "Are administrative permissions regularly audited? Is there a documented process for granting and revoking administrative rights based on the principle of least privilege? Are PAM or JIT solutions in use? Are administrative tasks performed using dedicated, audited accounts?",
      "asvs": "V4.2 - Verify that the principle of least privilege is used to grant access and permissions to data and functionality.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for in-scope technical assets that are associated with administrative roles (e.g., tagged with `@Role:Administrator`, `@Role:ITSecurityOfficer`). The risk assumes that, without specific controls like a PAM or JIT system, these permissions might be overly broad by default, posing a significant threat.",
      "riskAssessment": "The likelihood of exploitation is higher for assets exposed to the internet or easily accessible within the internal network. The impact correlates with the CIA rating of the technical asset and the data it processes or stores. An administrator on a mission-critical, multi-tenant database poses a much higher risk than on a standalone, non-critical internal tool.",
      "falsePositives": "The model cannot verify the presence or effectiveness of external compensating controls such as a fully implemented PAM solution, rigorous JIT access policies, or strict real-time auditing. If such controls are confirmed to be in place and effective for the identified asset, this risk can be considered a false positive or mitigated.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "69_sec4.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "insecure-administrative-access",
      "title": "Insecure Administrative Access",
      "description": "Administrative access points (for configuration, maintenance, or monitoring) grant powerful privileges over systems and data. If these channels are not sufficiently secured, unauthorized individuals may gain access via weak authentication, unencrypted protocols, or exposure to untrusted networks.",
      "impact": "A successful exploit not only risks confidentiality of administrative data and configurations, but can enable manipulation of systems (integrity) or service disruption (availability). Compromised admin access is a common pivot for broader attacks and endangers all security objectives.",
      "action": "Harden Administrative Access Channels (encryption, MFA, network gating)",
      "mitigation": "Protect all administrative access with strong multi-factor authentication (MFA). Ensure all admin traffic uses encrypted protocols, preferably via dedicated secure channels (VPN, bastion/jump host) when crossing or originating from untrusted networks. Apply least privilege for admin roles, and comprehensively log and monitor administrative actions.",
      "check": "Are all admin interfaces behind MFA? Are they reachable only from trusted networks (e.g., via VPN/bastion) with IP filtering? Are protocols encrypted end-to-end? Are admin actions immutably logged and regularly reviewed?",
      "asvs": "V4 Access Control, e.g., 4.1.2 (Least Privilege for Admin Interfaces) and 4.2.1 (Strong Credentials/MFA for Admin Accounts)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "Identifies administrative communication links (Usage.DevOps) with missing MFA (authentication != TwoFactor), unencrypted protocols, or internet exposure from the source asset without VPN or IP filtering. Out-of-scope targets are ignored.",
      "riskAssessment": "Impact follows the target asset’s confidentiality/integrity/availability requirements. Likelihood is very high for internet-exposed access without compensating controls or when authentication is 'None'; otherwise medium–high if MFA or encryption is missing on internal links.",
      "falsePositives": "May trigger on DevOps links that are non-privileged or already protected by controls not modeled (e.g., jump hosts, PAM). Validate environment context, emergency-only paths, or temporary maintenance tunnels.",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "69_sec5.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "lack-of-redundant-admin-knowledge-orp-4-a5",
      "title": "Lack of Redundant Administrator Knowledge (BSI ORP.4.A5)",
      "description": "If the necessary knowledge for IT administration is not redundantly available among administrators,",
      "impact": "Failure to perform critical administrative tasks due to knowledge monopolies or lack of deputies can severely impact the availability of IT systems",
      "action": "Ensure Redundancy in Administrative Knowledge, Access, and Documentation",
      "mitigation": "Establish and enforce a policy for substitution for all critical administrative roles. This includes designating and training deputies.",
      "check": "Are deputies formally designated for all critical administrative roles? Is there up-to-date, accessible, and comprehensive documentation for all administrative tasks?",
      "asvs": "BSI IT-Grundschutz Kompendium: Baustein ORP.4 (Personal), Anforderung ORP.4.A5 (Regelung von Vertretungen / Regulation of substitution).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Personnel_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organizational risk is triggered for any in-scope technical asset that is associated with an administrative role (via `role:*` tags).",
      "riskAssessment": "The likelihood is considered 'Likely' as personnel turnover, illness, or vacation are common events.",
      "falsePositives": "The risk might be a false positive if the organization has robust, well-documented, and tested substitution policies that are not visible in the threat model.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "69_sec6.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "administrator-staff-shortage",
      "title": "Administrator Staff Shortage (based on BSI Generic Threat)",
      "description": "If there is a shortage of administrative staff (e.g., due to insufficient staffing plans, overbooking, illness, or pandemics), necessary administration tasks may not be performed in time.",
      "impact": "Missed tasks and administrative errors can reduce availability, increase attack surface (e.g., missed patching or misconfigurations), and jeopardize confidentiality, integrity, and availability.",
      "action": "Ensure Adequate Staffing, Training, and Tooling for Administrators",
      "mitigation": "Establish robust personnel/resource planning for administrative teams, including coverage for absences and emergencies. Implement cross-training and procedure documentation to avoid single points of failure.",
      "check": "Is there a formal capacity plan for operations/admin? Are there enough administrators to cover tasks without chronic overtime?",
      "asvs": "Derived from BSI IT-Grundschutz ORP.2 (Personnel), esp. ORP.2.A5 (Staffing of roles), requiring adequate staffing and qualification.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile (BSI ORP.2)",
      "detectionLogic": "Organizational risk surfaced at the asset level. A finding is created for technical assets tagged with administrative responsibility (e.g., @Role:Administrator, @Role:SystemAdministrator, @Role:DevOps, @Role:ExternalServiceProvider).",
      "riskAssessment": "Likelihood defaults to 'Likely' where ongoing administration is needed. Impact is scaled from the asset’s own CIA classification (mission-critical assets → very high).",
      "falsePositives": "This risk is raised based on administrative role tags and cannot be confirmed without insight into actual staffing levels and workload.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "69_sec7.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "inadequate-securing-of-admin-tools",
      "title": "Inadequate Securing of Administration Tools (based on BSI CON.8.A24)",
      "description": "Administration tools grant extensive access to an institution's IT systems. If these tools are inadequately secured, they pose a significant risk to all information security objectives. A primary cause for this vulnerability is the insufficient separation of administrative tools and tasks from non-administrative ones. For example, using the same client system, or even the same applications (like an SSH client or text editor), for both IT administration and general-purpose tasks (like browsing the web or checking email) creates a pathway for attackers to compromise the administrative session.",
      "impact": "If an attacker gains control over an inadequately secured administration tool, they can acquire far-reaching privileges. These privileges can be abused to sabotage IT administration, conduct unauthorized administrative actions, and launch further attacks against connected systems. This compromises the confidentiality, integrity, and availability of all managed IT assets, leading to data breaches, system downtime, and loss of control over the infrastructure.",
      "action": "Isolate Administrative Environments and Tools",
      "mitigation": "Use dedicated, hardened systems (physical or virtual) exclusively for administrative tasks. These 'Secure Admin Workstations' (SAWs) should not be used for general office work, email, or web browsing. Administrative access should be routed through hardened jump hosts or bastion servers. Enforce multi-factor authentication (MFA) for all administrative access. Use separate, privileged user accounts for administration that are distinct from standard user accounts. Network segmentation should be used to isolate administrative access paths from general user networks.",
      "check": "Are dedicated, isolated systems used for all administrative tasks? Is there a strict separation between administrative and non-administrative user accounts and sessions? Is administrative access restricted to specific network paths and controlled via bastion hosts? Is MFA enforced for all privileged access?",
      "asvs": "BSI IT-Grundschutz CON.8: Software development and testing; specifically A24 Segregation of administration clients. The principle also aligns with OPS.1.1.5 Administration using a standard client.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Software_development_and_testing_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified when a technical asset (like a desktop, client system, or CLI tool) is used for both administrative purposes and non-administrative, potentially less secure, activities. The model detects this by finding a client asset that has outgoing communication links with a 'devops' usage (indicating administration) and simultaneously has links with a 'business' usage (indicating general tasks). The risk is higher if the business usage involves connecting to the internet.",
      "riskAssessment": "The likelihood is high if a client asset mixes 'devops' and 'business' usage, and very high if the business usage includes internet access. The impact is determined by the highest CIA requirements of the systems being administered via the 'devops' links. Administering mission-critical databases from a mixed-use client poses a very high impact.",
      "falsePositives": "A model might flag a 'Desktop' asset as being used for mixed purposes. In reality, the organization might use a properly isolated Virtual Machine (VM) on that desktop for administrative tasks. The model cannot see this level of detail, which could result in a false positive. Manual verification of the administrative procedures is required.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "69_sec8.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "failure-of-administration-tools-ops115",
      "title": "Failure of Administration Capabilities (BSI-based)",
      "description": "If administration capabilities fail and, due to poor planning, there is no redundancy or alternative,",
      "impact": "A failure of critical, non-redundant administration tools leads to an inability to manage, monitor, or repair other IT systems.",
      "action": "Ensure Redundancy and Failover for Critical Administration Tools",
      "mitigation": "Identify all critical administration tools and components within the infrastructure.",
      "check": "Are all critical administration and infrastructure components (e.g., identity providers, container platforms, monitoring systems, CI/CD pipelines) designed to be redundant?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.5 Redundancy (Requirement A4 - Redundancy for central infrastructure services) and OPS.1.1.3 Patch and change management.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Redundancy_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for technical assets that are identified as administrative or critical infrastructure components, are rated as having 'Important' or higher availability requirements, and are explicitly marked as not being redundant in the model.",
      "riskAssessment": "The likelihood is considered 'Likely' because single points of failure (SPOFs) in complex systems are prone to eventual failure from hardware faults, software bugs, or human error (misconfiguration, bad patches).",
      "falsePositives": "A risk might be flagged for a component that has out-of-band or manual recovery procedures that are considered acceptable by the organization, even without being marked as 'redundant' in the model. This should be verified with the system architects or operations team.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "69_sec9.ts",
      "bsiCode": "OPS.1.1.2",
      "id": "misleading-it-administration",
      "title": "Misguided IT Administration (Fehlgeleitete Administration)",
      "description": "If IT administration is misled—for example, by an attacker injecting false information—administrators can be tricked into performing incorrect or harmful actions.",
      "impact": "Successful exploitation can lead to the manipulation of information, hardware, or software, compromising availability and integrity.",
      "action": "Implement strict verification and communication protocols for administrative actions",
      "mitigation": "Establish and enforce strict, out-of-band verification procedures for any critical administrative request (e.g., system restarts, configuration changes, user account modifications).",
      "check": "Are there formal, documented processes for critical administrative actions? Do these processes include out-of-band verification steps? Are administrators trained on social-engineering threats? Is there a secure, dedicated channel for administrative communication?",
      "asvs": "Based on BSI IT-Grundschutz, OPS.1.1.2 (section 2.9 “Fehlgeleitete Administration”) and general social-engineering threats against operators.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Incident_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any in-scope technical asset managed by personnel with administrative roles.",
      "riskAssessment": "The likelihood is higher for assets that are critical and managed by multiple administrators, increasing the social-engineering attack surface.",
      "falsePositives": "The risk might be considered a false positive if the organization has exceptionally strong, enforced, and audited out-of-band verification processes for all administrative actions, making such social-engineering attempts highly unlikely to succeed.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "6_sec1.ts",
      "bsiCode": "APP.2.3",
      "id": "improper-ldap-backend-selection",
      "title": "Improper OpenLDAP Backend Selection",
      "description": "If OpenLDAP backends, directives, and parameters are chosen incorrectly, they can negatively affect the functions offered by the directory service.",
      "impact": "Misconfiguration of the LDAP backend can severely limit the service's functionality, integrity, and availability. It can prevent proper management of a large user base,",
      "action": "Ensure a Robust and Scalable Backend is Used for OpenLDAP",
      "mitigation": "For production environments, configure OpenLDAP to use a robust, transactional backend like 'mdb' (Memory-Mapped Database), which is the recommended default.",
      "check": "Inspect the OpenLDAP server's configuration (e.g., slapd.conf or cn=config) to identify the configured database backend for the main suffix(es). Verify that the backend is suitable for the intended load and scale.",
      "asvs": "N/A. This is a specific technology configuration issue. The principle aligns with OWASP ASVS V14.1 (Configuration) but is more specific than any single requirement.",
      "cheatSheet": "https://www.openldap.org/doc/admin26/backends.html",
      "detectionLogic": "Automatically detects technical assets of type 'LDAP Server' or 'Identity Store (LDAP)' that are not explicitly tagged with a robust backend.",
      "riskAssessment": "The impact is determined by the CIA requirements of the assets relying on this LDAP server. If it is used for mission-critical authentication, the impact is high.",
      "falsePositives": "This risk might be a false positive for very small, non-critical, or temporary deployments where a simple backend might be sufficient and the operational risks are accepted.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "6_sec2.ts",
      "bsiCode": "APP.2.3",
      "id": "bsi-openldap-overlay-planning",
      "title": "Poorly Planned OpenLDAP Overlays (BSI-derived)",
      "description": "The BSI notes that if the use of OpenLDAP overlays is poorly planned, unnecessary operations may be executed or other functions may be impaired.",
      "impact": "This vulnerability can lead to incorrect or completely missing access logs, which undermines non-repudiation and can hide security incidents like data breaches or unauthorized modifications.",
      "action": "Develop and Enforce a Clear Configuration and Logging Plan for OpenLDAP Overlays",
      "mitigation": "Define and document the required functionality for all OpenLDAP overlays, with special attention to those responsible for logging ('auditlog', 'accesslog') and access control.",
      "check": "Is there a documented plan for OpenLDAP overlay usage? Are logging overlays like 'auditlog' and 'accesslog' configured correctly and are the logs monitored?",
      "asvs": "V14.2.1: Secure Configuration",
      "cheatSheet": "https://www.openldap.org/doc/admin24/overlays.html",
      "detectionLogic": "This risk is raised for any technical asset identified as an OpenLDAP server (technology: `ldap-server`).",
      "riskAssessment": "The likelihood is considered 'Likely' because secure configuration of specialized components like OpenLDAP overlays requires specific expertise that may not always be present.",
      "falsePositives": "This risk might be a false positive if a robust, audited configuration management and review process for the OpenLDAP server is in place, even if not explicitly captured in the threat model.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "6_sec3.ts",
      "bsiCode": "APP.2.3",
      "id": "unsuitable-environment-for-ldap",
      "title": "Unsuitable System Environment for OpenLDAP (BSI APP.2.3 / APP.3.2.A6)",
      "description": "OpenLDAP can malfunction when its live database (e.g., mdb/hdb) resides on network/distributed filesystems such as NFS or SMB/CIFS. These platforms often do not fully support POSIX file locking and atomic semantics needed by database backends. Missing or unreliable locks can cause write-race conditions, stale pages, and database corruption.",
      "impact": "Loss of integrity and availability of the directory service. Corruption or inconsistent states can break authentication/authorization flows for dependent applications, leading to outages and possibly forced restores with data loss.",
      "action": "Ensure the live LDAP database uses suitable local or block-level storage",
      "mitigation": "Store the OpenLDAP database and runtime state on storage that guarantees local POSIX locking and correct fsync semantics (e.g., ext4, XFS, APFS, or SAN block devices). Avoid NFS/SMB for the live database path. If network shares are required, restrict them to backups/exports/logs only and keep the live DB local.",
      "check": "Inspect the LDAP host's mount table and the configured database directory. Verify there is no writable NFS/SMB mount involved. In the model, look for write-capable communication links from an LDAP Server to a Datastore using NFS/SMB protocols.",
      "asvs": "BSI IT-Grundschutz APP.2.3 (Section 2.1); APP.3.2.A6",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_2_LDAP_en.html",
      "detectionLogic": "Detect in-scope technical assets with technology 'LDAP Server' that have non-readonly communication links using Protocol.NFS or Protocol.SMB pointing to a Datastore/File-Server asset. Such writable links indicate that the live database might be placed on an unsuitable distributed filesystem.",
      "riskAssessment": "Likelihood is high because the misconfiguration is self-exploiting during normal operations (concurrent writes). Impact scales with the LDAP server's integrity/availability criticality, often high due to its central role in authN/authZ.",
      "falsePositives": "May be a false positive if the NFS/SMB share is strictly for backups, exports, or logs and not the live database location. The model may not differentiate usage purpose; manual verification is recommended.",
      "cwe": "662",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "6_sec4.ts",
      "bsiCode": "APP.2.3",
      "id": "ldap-version-incompatibility",
      "title": "LDAP Version Incompatibility (BSI)",
      "description": "Incompatible versions of one or more applications may attempt to access the databases used by an LDAP server.",
      "impact": "If an incompatible client application connects to the LDAP server, it can lead to Denial of Service (through repeated connection failures or resource exhaustion),",
      "action": "Ensure and Verify Component Compatibility",
      "mitigation": "Maintain a bill of materials for all applications that connect to the LDAP server. Before deploying or updating a client application,",
      "check": "Is there a documented list of client applications and their versions that are certified to work with the production LDAP server?",
      "asvs": "V14.2.5: Verify that third-party components are from a trusted source and have a secure configuration.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html",
      "detectionLogic": "Identifies all 'LDAP Server' or 'LDAP Identity Store' technical assets. The risk is raised if these assets receive communications from other application components,",
      "riskAssessment": "The likelihood increases with the number and diversity of client applications connecting to the LDAP server. The impact is directly related to the",
      "falsePositives": "This risk can be considered a false positive if the organization enforces a strict version control and compatibility testing regime for all clients",
      "cwe": "1104",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "6_sec5.ts",
      "bsiCode": "APP.2.3",
      "id": "inconsistent-ldap-state-mixed-access-bsi-app-2-3",
      "title": "Inconsistent LDAP State from Mixed Access (BSI APP.2.3, Section 2.2)",
      "description": "Data in an OpenLDAP directory, including both directory objects and configuration settings, can be accessed through different methods.",
      "impact": "If both online and offline access methods are used without proper synchronization or understanding, the resulting LDAP database can become inconsistent.",
      "action": "Standardize and Restrict Access Methods to LDAP Database",
      "mitigation": "Define a strict and exclusive procedure for modifying the LDAP database. Prefer using standard online LDAP operations for all changes.",
      "check": "Review the operational runbooks for the LDAP server. Are there procedures that involve both online LDAP commands and offline file manipulation?",
      "asvs": "Derived from BSI IT-Grundschutz APP.2.3 (mixing online and offline access to the OpenLDAP database; see Section 2.2). This is a specific operational risk that does not directly map to an OWASP ASVS requirement.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_OpenLDAP_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is identified for any technical asset of technology type 'LDAP Server' that has both incoming communication links using the LDAP/LDAPS protocol (online access)",
      "riskAssessment": "The likelihood is higher if multiple administrative roles or systems have different types of access. The impact is directly related to the **Integrity** and **Availability**",
      "falsePositives": "The risk might be a false positive if the offline access protocols are used strictly for non-conflicting purposes (e.g., log file shipping, monitoring) and not for database manipulation,",
      "cwe": "345",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "70_sec1.ts",
      "bsiCode": "OPS.1.1.3",
      "id": "unclear-responsibilities-in-processes-bsi-orp1-a2",
      "title": "Unclear or Overlapping Responsibilities (BSI ORP.1.A2)",
      "description": "Poorly defined, overlapping, or unclear responsibilities for security-relevant processes can lead to significant delays and errors.",
      "impact": "In extreme cases, poorly defined responsibilities can disrupt the entire system or large parts of it. Operational disruptions negatively affect Availability.",
      "action": "Clearly Define, Document, and Communicate Roles and Responsibilities",
      "mitigation": "Establish and document clear responsibilities for all security-relevant processes, particularly for patch and change management, incident response, and access control.",
      "check": "Is there a documented patch and change management process? Are roles and responsibilities for testing, approving, and deploying changes clearly defined and assigned?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information security organisation), Requirement ORP.1.A2 (Defining roles and responsibilities).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
      "detectionLogic": "This is an organizational risk that can be modeled against technical assets where process failures have a high impact.",
      "riskAssessment": "The likelihood is considered 'Likely' by default, as this process weakness is common in many organizations.",
      "falsePositives": "This risk is raised based on the type of asset, not on direct evidence of a process failure. The model cannot know the quality of an organization's internal processes.",
      "cwe": "306",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "70_sec2.ts",
      "bsiCode": "OPS.1.1.3",
      "id": "inadequate-patch-and-change-management-ops-1-1-5",
      "title": "Inadequate Patch and Change Management (BSI OPS.1.1.5)",
      "description": "If patch and change management has low acceptance within the institution, or communication among a project's or system's stakeholders is poor, change requests may be delayed or be decided on incorrectly. This can lower the overall security level and seriously disrupt IT operations.",
      "impact": "Poor communication makes the change process inefficient, requiring excessive time and resources. This harms the institution's responsiveness and, in extreme cases, can introduce security vulnerabilities or prevent important business objectives from being achieved. The primary impacts concern the Integrity of systems (untested changes, new vulnerabilities) and Availability (disruption of IT operations).",
      "action": "Establish a formalized and well-communicated patch and change management process",
      "mitigation": "A documented patch and change management process must be established and consistently followed. This process should define clear roles and responsibilities, communication channels, testing procedures for all changes, and rollback plans. All changes, including patches, should be documented in a central system. Emergency change procedures should also be defined and tested. Ensure all involved personnel are trained on the process.",
      "check": "Is there a documented patch and change management policy? Are roles and responsibilities defined? Are all changes tested before deployment to production environments? Is there a documented history of all applied changes?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.5 (Patch and change management), particularly Requirements A1 (Planning of patch and change management), A4 (Documenting changes), and A6 (Testing of patches and changes).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organizational risk is often reflected in technical assets that require frequent manual intervention or are part of a complex delivery pipeline. This rule triggers on assets that have custom-developed parts or are related to development and operations infrastructure, as these are prime candidates for failures in the change management process. The risk also applies to assets managed by key operational roles.",
      "riskAssessment": "The likelihood is higher for assets that are custom-developed, as they lack standardized, automated update mechanisms. Impact directly depends on the asset's business criticality (CIA ratings). A failed change on a mission-critical, internet-facing asset has a much higher impact than on a non-critical internal system.",
      "falsePositives": "The model cannot verify the actual quality of an organization's patch and change management process. An organization might have a very mature, well-executed manual process for assets flagged as 'custom-developed', effectively mitigating this risk. This can only be verified by interviewing responsible staff and reviewing change logs and process documentation.",
      "cwe": "937",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "70_sec3.ts",
      "bsiCode": "OPS.1.1.3",
      "id": "inadequate-change-management-con-3-g5",
      "title": "Inadequate Change Management (BSI CON.3.G5)",
      "description": "Unsuitable or improperly assessed changes to IT systems can impair business processes, lead to system failures, or reduce the overall security level. This often occurs when testing is insufficient or when there is a lack of coordination between IT, security, and business departments during the change approval and implementation process.",
      "impact": "Flawed changes can directly impact the availability of services, causing business disruptions and outages. They can also introduce new vulnerabilities, compromising the confidentiality and integrity of data. This may lead to data breaches, financial loss, and reputational damage.",
      "action": "Implement a formal and comprehensive change management process",
      "mitigation": "Establish a documented change management policy that applies to all production systems. The process must include: formal change requests (CRs), risk and security impact analysis for each CR, approval workflows involving all relevant stakeholders (business, IT, security), dedicated testing in a pre-production environment, and a clear rollback strategy. Ensure all changes are tracked and audited.",
      "check": "Is there a formal change management process? Are all changes to production environments logged and approved? Does the process mandate security reviews and testing? Are rollback plans in place for critical changes?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Change Management), specifically threat G5 'Unzureichendes Änderungsmanagement' (insufficient change management).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Change_management_Edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.3)",
      "detectionLogic": "This organizational risk is identified on technical assets that are central to the software development and deployment lifecycle (e.g., build pipelines, source code repositories, container platforms) or are critical, custom-developed applications. The risk is higher for assets involved in 'DevOps' communication flows, as these are points where automated changes are funneled into production.",
      "riskAssessment": "The likelihood is considered higher for assets central to development and deployment. The impact is calculated based on the Confidentiality, Integrity, and Availability (CIA) ratings of the affected asset and the data it processes or stores. An improper change to a system with mission-critical data has a much higher impact than a change to a less critical component.",
      "falsePositives": "This risk is raised based on the technical role of an asset. The model cannot verify the actual quality of the organization's change management process. A well-disciplined organization might have a robust process, rendering this a false positive. Verification requires auditing the change management policy and its implementation.",
      "cwe": "755",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "70_sec4.ts",
      "bsiCode": "OPS.1.1.3",
      "id": "inadequate-patch-management-resources",
      "title": "Inadequate Resources for Patch and Change Management (BSI OPS.1.1.3)",
      "description": "Effective patch and change management requires adequate personnel, time, and financial resources. If these are not available, necessary roles may be filled by unsuitable personnel, communication channels between IT and business departments may not be established, and the required infrastructure for testing and deployment environments may not be provided. While such deficiencies can sometimes be compensated for during normal operations, they become particularly apparent under time pressure, such as when emergency patches must be deployed.",
      "impact": "A lack of resources for patch management leads to delayed or failed patching, leaving systems vulnerable to exploitation. This can result in the compromise of confidentiality, integrity, and availability of the organization's information and assets, leading to data breaches, system downtime, and significant financial or reputational damage.",
      "action": "Ensure Sufficient Resources for Patch and Change Management",
      "mitigation": "Allocate a sufficient budget for patch and change management activities. Assign qualified personnel to defined roles and responsibilities, and provide them with adequate time for testing and deployment. Establish clear, documented processes and communication channels between IT operations, development, and business departments. Maintain separate, adequately equipped environments for testing patches before deploying them to production systems. Use a tag like `@patch-process:managed` on assets to denote that a formal process is in place.",
      "check": "Are roles and responsibilities for patch management clearly defined and assigned to qualified individuals? Is there a documented process that includes communication with business departments? Are separate test/staging environments used for patch validation before production deployment? Is there a dedicated budget for these activities?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.3 (Patch and change management), especially requirements OPS.1.1.3.A1 (Concept for patch and change management) and OPS.1.1.3.A15 (Regular updating of IT systems and software).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This organizational risk is raised for all in-scope, non-client, non-library technical assets that are likely to require regular patching. The risk can be mitigated on a per-asset basis by applying a `@patch-process:managed` tag, which indicates that a formal, well-resourced process is in place for that asset.",
      "riskAssessment": "The likelihood of exploitation is higher for internet-facing systems and systems built on common third-party technologies. The impact is directly correlated with the business criticality (CIA) of the asset and the data it processes or stores. An unpatched, internet-facing asset with high-value data represents a very high risk.",
      "falsePositives": "This risk is raised based on the absence of explicit information about a managed patching process in the model. The model cannot verify the actual quality or resourcing of an organization's patching process. Therefore, this finding should be considered a strong recommendation to verify the process and its resource allocation externally.",
      "cwe": "1104",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "70_sec5.ts",
      "bsiCode": "OPS.1.1.3",
      "id": "flawed-patch-distribution-sys-1-3-g5",
      "title": "Faulty Automated Patch/Change Distribution (BSI OPS.1.1.3 §2.5)",
      "description": "Patches and changes are often distributed centrally using software-based automation.",
      "impact": "A faulty or malicious patch distributed via a central management system can introduce widespread vulnerabilities, system instability, or denial of service across numerous assets.",
      "action": "Harden, Stage, and Verify Patch Distribution",
      "mitigation": "Establish a multi-stage deployment process (e.g., dev, test, prod) to vet patches and changes before a full rollout.",
      "check": "Is there a central patch/change management system? Are patches and changes thoroughly tested in a pre-production environment before rollout?",
      "asvs": "BSI OPS.1.1.3 Patch- und Änderungsmanagement",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_3_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Automatically detects central DevOps assets (Usage = DevOps) that act as software/patch distribution hubs.",
      "riskAssessment": "Likelihood: 'Likely' due to automation complexity and human error in change management.",
      "falsePositives": "The model can identify the architectural pattern of centralized management but cannot assess the maturity of operational processes (testing, approvals, staged rollouts).",
      "cwe": "1104",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "70_sec6.ts",
      "bsiCode": "OPS.1.1.3",
      "id": "inadequate-patch-rollback-capability",
      "title": "Inadequate Patch/Change Rollback Capability",
      "description": "When patches or changes are distributed without a provisioned recovery option, or if the recovery routines of the software used are ineffective or inadequate, faulty updated software cannot be corrected in a timely manner. This can lead to the failure of important IT systems and result in high consequential damages.",
      "impact": "A failed update without a proper rollback plan can lead to extended outages, data corruption, or loss. The availability and integrity of the data and the affected IT systems are particularly endangered, potentially disrupting critical business processes.",
      "action": "Implement and test rollback plans for patches and changes",
      "mitigation": "Establish a formal change management process that requires a tested rollback or recovery plan for every significant patch or change. This can include system snapshots, database backups, application versioning, or blue-green/canary deployment strategies. The recovery procedure must be documented, and its effectiveness should be verified periodically, especially for critical systems. Ensure that personnel are trained on how to execute the rollback procedures.",
      "check": "Is there a documented change management process requiring a rollback plan for changes? Are these rollback plans tested before deploying the actual change to production? Can the operations team demonstrate a successful rollback from a recent deployment in a test or staging environment?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.5 Patch and Change Management, particularly requirement A6 (fallback option for patches).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This is a process-related risk. The rule triggers on technical assets where the impact of a failed update would be most severe. It identifies assets with high integrity or availability requirements, custom-developed components that change frequently, and key DevOps systems. The risk is heightened for non-redundant assets, where a single failure leads to a complete outage.",
      "riskAssessment": "The impact is directly derived from the availability and integrity rating of the affected technical asset. The likelihood is considered higher for non-redundant systems, as there is no immediate failover capability to mitigate the impact of a failed patch. For all other critical systems, the likelihood is assumed to be 'likely' to reflect the common operational challenge of maintaining perfect, tested rollback plans for every change.",
      "falsePositives": "This risk is raised based on asset criticality, assuming a potential weakness in operational processes. An organization may have an excellent and rigorously tested change management and rollback procedure, which cannot be verified by the model. This risk should be confirmed by reviewing the actual operational processes.",
      "cwe": "755 // CWE-755: Improper Handling of Exceptional Conditions (a failed patch being an exceptional condition that requires a recovery routine).",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "70_sec7.ts",
      "bsiCode": "OPS.1.1.3",
      "id": "flawed-patch-and-change-management",
      "title": "Flawed Patch and Change Management (BSI CON.1)",
      "description": "If changes are prioritized incorrectly, critical security patches might be installed too late, leaving known vulnerabilities open for exploitation.",
      "impact": "This can result in systems remaining vulnerable to known exploits, significantly increasing the likelihood of compromise. The integrity, availability, and confidentiality of the system and the data it processes are put at risk. Unpatched systems are a primary vector for attacks that can lead to data breaches, service disruptions, and unauthorized access.",
      "action": "Establish and Adhere to a Robust Patch and Change Management Process",
      "mitigation": "Define and enforce a clear, risk-based process for identifying, prioritizing, testing, and deploying patches and system changes.",
      "check": "Is there a documented patch and change management policy? Are patches consistently prioritized based on vulnerability severity and asset criticality? Are changes tested in a pre-production environment? Is there a verification process to confirm successful deployment and functionality?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Patch and change management).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for all technical assets that require regular patching (e.g., servers, applications, databases), excluding serverless components and the DevOps/management tools themselves.",
      "riskAssessment": "The impact is determined by the confidentiality, integrity, and availability (CIA) requirements of the technical asset and the data it handles.",
      "falsePositives": "This risk can be considered a false positive if a robust, effective, and well-documented patch management process exists for the asset, even if it is not fully represented by a 'build-pipeline' in the threat model.",
      "cwe": "937",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "70_sec8.ts",
      "bsiCode": "OPS.1.1.3",
      "id": "compromised-patch-management-system",
      "title": "Compromise of Patch and Change Management System",
      "description": "Patch and change management systems often operate from a central position to distribute software and updates.",
      "impact": "A successful attack can lead to widespread compromise across many systems, severely impacting the integrity, confidentiality, and availability of the entire ecosystem.",
      "action": "Harden Software Supply Chain Infrastructure",
      "mitigation": "Implement strict access control and network segmentation for all components of the software supply chain (source code repositories, build pipelines, artifact registries).",
      "check": "Are patch and artifact management systems isolated from general corporate networks? Is all administrative access secured with strong authentication?",
      "asvs": "V14.2 Software and Component Integrity Requirements",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Software_Component_Verification_Cheat_Sheet.html",
      "detectionLogic": "This rule identifies central components of the software delivery pipeline (e.g., Build Pipeline, Artifact Registry, Source Code Repository) that distribute software to multiple other assets.",
      "riskAssessment": "The impact is calculated based on the number and sensitivity of the downstream systems that receive software from this central component.",
      "falsePositives": "This rule may flag any central build system as risky.",
      "cwe": "494",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "71_sec1.ts",
      "bsiCode": "OPS.1.1.4",
      "id": "malware-infection-via-unpatched-client-software",
      "title": "OPS.1.1.4 – Malware Infection via Unpatched Client Software",
      "description": "If IT systems, particularly client-side applications like browsers or mobile apps, are not adequately protected against malware, attackers can exploit software vulnerabilities to execute malicious code. This often occurs when security patches are not applied promptly or when protection mechanisms are misconfigured. A common attack vector is a 'drive-by-download', where simply visiting a compromised website can lead to infection.",
      "impact": "A successful exploit can lead to system infection, giving an attacker extensive control over the compromised asset and a potential foothold into the institution's internal network. This can result in data theft (compromising Confidentiality), system modification (compromising Integrity), and inclusion in botnets for DDoS attacks (compromising Availability).",
      "action": "Establish and enforce a robust patch and vulnerability management process for all client systems.",
      "mitigation": "Keep client systems (desktops, laptops, mobile devices) and their applications (browsers, plugins) up to date with security patches. Use centrally managed, modern endpoint protection/EDR with frequent signature and engine updates. Harden browser settings to limit active content, disable deprecated plugins, and enforce safe defaults. Decommission unsupported software and hardware in time.",
      "check": "Is there a documented patch management policy for client software? Are clients regularly scanned for vulnerabilities? Is endpoint protection centrally deployed and updated? Are browser configurations hardened and enforced via management (e.g., MDM/GPO)?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.4 (Protection against malware); related: SYS.1.2.2, APP.3.2 (Web Browser), and patch management in client OS modules (e.g., SYS.1.3).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_Web_browser_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "Raised for any technical asset classified as a client (via isTechnologyClient) that is internet-connected. Typical technologies include Browsers, Mobile Apps, Desktops/Thin Clients. The rule favors internet exposure as a primary indicator of drive-by and client-side exploit risk.",
      "riskAssessment": "Likelihood is very high for internet-facing clients due to the steady discovery of client-side vulnerabilities. Impact scales with the asset’s highest CIA rating and the sensitivity of processed/stored data. Clients used for admin tasks or handling sensitive data imply higher impact.",
      "falsePositives": "May be a false positive in tightly managed environments with rapid, enforced patching, advanced EDR, application control, and strict egress filtering. Such mitigating controls cannot be fully derived from the model alone and require verification.",
      "cwe": "937",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "71_sec2.ts",
      "bsiCode": "OPS.1.1.4",
      "id": "ransomware-encryption",
      "title": "Risk of Ransomware & Malware Encryption (BSI OPS.1.1.4 / CON.8)",
      "description": "Malware—including ransomware—can execute without user awareness and encrypt or destroy information on clients, servers, mobiles, IoT and even industrial systems.",
      "impact": "Without effective malware protection and resilient backups, availability of information can be severely restricted, data may be permanently lost and operations disrupted—causing financial losses, legal exposure and reputational damage.",
      "action": "Establish multi-layered anti-malware controls and a hardened, regularly tested @Backup:Target & recovery strategy.",
      "mitigation": "Deploy enterprise-grade, centrally managed anti-malware on endpoints and servers (incl. behavioral analysis and host-based intrusion prevention).",
      "check": "Are enterprise anti-malware solutions deployed, updated and monitored on all relevant systems (incl. gateways)? Are backups isolated/immutable and restoration tested end-to-end? Are least-privilege, patching, application control and network segmentation enforced? Are incident procedures for malware alerts rehearsed?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.4 (Malware Protection) & CON.8",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Malware_protection_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Applicable to in-scope assets that are typical infection vectors (clients) or store valuable/operational data (datastores, file servers, databases).",
      "riskAssessment": "Prevalence of ransomware makes likelihood at least Likely; it becomes VeryLikely for Internet-facing assets or gateways.",
      "falsePositives": "Raised based on asset role and data criticality. The model cannot verify presence or effectiveness of external controls (e.g., EDR, email sandboxing) or the quality of @Backup:Target procedures.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "72_sec7.ts",
      "bsiCode": "OPS.1.1.5",
      "id": "inadequate-or-missing-logging-der.1.a5",
      "title": "Inadequate or Missing Logging (BSI DER.1.A5)",
      "description": "If IT systems within an information system fail to provide necessary logging data for security-relevant events,",
      "impact": "A lack of adequate logging creates a significant blind spot in the security posture, allowing attackers to remain undetected for extended periods.",
      "action": "Ensure Comprehensive and Monitored Logging",
      "mitigation": "Ensure all critical systems are configured to generate detailed logs for security-relevant events (e.g., login attempts, administrative actions, data access, errors).",
      "check": "Are all critical assets configured to log security-relevant events? Are logs sent to a central, secure repository?",
      "asvs": "BSI IT-Grundschutz DER.1.A5 (Logging of security-relevant events); OWASP ASVS V7.1 (Log Generation)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Detection_of_security-relevant_events_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified for critical in-scope 'process' or 'datastore' assets that do not have a communication link to a monitoring system (e.g., SIEM/log server).",
      "riskAssessment": "The likelihood is considered higher for custom-developed parts, as logging is often an afterthought.",
      "falsePositives": "The model might not represent a separate, out-of-band monitoring network. An asset might be monitored by a system not included in the threat model.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "72_sec8.ts",
      "bsiCode": "OPS.1.1.5",
      "id": "insufficient-logging-infrastructure-ops1.1.5",
      "title": "Insufficient Logging Infrastructure (BSI OPS.1.1.5)",
      "description": "Due to complex information networks and diverse attack scenarios, logging requirements are increasing, necessitating the storage and processing of large volumes of log data.",
      "impact": "An undersized logging infrastructure can lead to lost or incomplete log data. This prevents the detection of security incidents,",
      "action": "Ensure Sufficient Capacity for Logging Infrastructure",
      "mitigation": "The logging infrastructure must be designed with sufficient capacity to handle both normal operational load and peak loads during security incidents.",
      "check": "Is the logging infrastructure (storage, CPU, network) dimensioned to handle peak log volumes, especially during a simulated security incident?",
      "asvs": "BSI IT-Grundschutz Baustein OPS.1.1.5 (Logging), Requirement OPS.1.1.5.A5 (Sufficient dimensioning of the logging infrastructure).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Logging_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is identified for central monitoring and logging systems (e.g., technology 'Monitoring', 'Search-Index', 'Search-Engine')",
      "riskAssessment": "The likelihood of this risk materializing is high if a central logging/monitoring system has a large number of sources and no explicit capacity planning has been done.",
      "falsePositives": "The model cannot know the actual hardware or cloud resource allocation. A 'Monitoring' asset might be running on a highly scalable, auto-sizing platform.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "73_sec1.ts",
      "bsiCode": "OPS.1.1.6",
      "id": "testing-with-production-data-bsi-con-6",
      "title": "Testing with Production Data (BSI CON.6)",
      "description": "If software is tested using production data, significant security issues can arise.",
      "impact": "This practice can cause severe breaches of confidentiality, integrity, and availability. Unauthorized access to sensitive data may result in privacy violations, financial losses, and reputational damage.",
      "action": "Separate test/development and production environments; use anonymized or synthetic data for testing",
      "mitigation": "Strictly separate test, development, and production environments. Establish a policy that prohibits using real production data for testing.",
      "check": "Are test and production environments logically and physically separated? Is there a policy that prohibits using production data for testing?",
      "asvs": "V14.3.1: Verify that test and production environments are strictly segregated.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Testing_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is detected by identifying data flows from production datastores to development or test systems.",
      "riskAssessment": "Likelihood is considered high if a direct data flow from a production datastore to a test environment exists in the model.",
      "falsePositives": "A data flow might be mislabeled with 'DevOps' usage. The risk primarily concerns bulk data transfers for testing purposes.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "73_sec2.ts",
      "bsiCode": "OPS.1.1.6",
      "id": "insufficient-software-testing-con1",
      "title": "Insufficient Software Testing and Release Procedures (BSI OPS.1.1.6)",
      "description": "If new software is not tested or is tested inadequately and released without proper installation procedures, critical errors can remain undetected.",
      "impact": "Undetected software or installation errors can lead to unexpected system behavior, crashes, data corruption, or data loss, especially when updates are deployed.",
      "action": "Establish and enforce a formal software testing and release management process",
      "mitigation": "Implement a formal, multi-stage testing process for all new and updated custom-developed software before deployment. This should include unit, integration, and user acceptance testing (UAT).",
      "check": "Is there a documented software testing and release policy? Are test results (including security tests) reviewed and approved before release? Are installation and rollback guides provided for all software? Is a change management process strictly followed for all production deployments?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.6 (Software testing and releases), e.g., A2/A4/A15.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_software_development_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all in-scope technical assets marked as having 'custom-developed parts'.",
      "riskAssessment": "The likelihood is considered 'likely' for any custom-developed component, as missing or flawed testing is a common issue in many development lifecycles.",
      "falsePositives": "This risk may be a false positive if the organization has a very mature and rigorously enforced SDLC and testing process that is not visible in the threat model.",
      "cwe": "754",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "73_sec3.ts",
      "bsiCode": "OPS.1.1.6",
      "id": "'inadequate-release-process'",
      "title": "OPS.1.1.6 – Inadequate Software Test/Release & Approval Process",
      "description": "Software changes may reach production without structured testing, explicit sign-off, or artifact integrity checks. Missing approvals or weak gating can allow unverified code to be deployed.",
      "impact": "Unapproved or insufficiently tested releases can introduce unintended or malicious functions, remove needed features, break compatibility, or degrade security controls—directly threatening integrity and availability and potentially exposing data.",
      "action": "Establish and enforce auditable release gates with explicit approvals and artifact integrity verification.",
      "mitigation": "Define a documented, repeatable release workflow: mandatory sign-offs (product/QA/security), separation of duties, CI/CD gates (policy-as-code), artifact signing/checksums, environment promotion controls, and limited deploy privileges. Keep evidence for each deployment.",
      "check": "Is there a written test & release procedure? Are recent deployments backed by verifiable approvals and artifact integrity records? Do pipelines prevent unapproved or unsigned artifacts from being promoted to production?",
      "asvs": "OWASP ASVS: V1.1 (SDLC) • V14.2 (Supply Chain) • ISO/IEC 29119 (Testing)",
      "cheatSheet": "BSI OPS.1.1.6 – Software-Tests und -Freigaben (Test- & Release-Management)",
      "detectionLogic": "Triggers for in-scope technical assets with customDevelopedParts=true that represent executable code or data stores (processes/datastores). Heuristics (conceptual): higher priority where the asset is business-critical, processes or stores sensitive data, or lacks modeled references to approval gates. Absence of modeled release controls is treated as a warning requiring verification.",
      "riskAssessment": "Impact scales with the asset’s CIA requirements: Important⇒Medium, Critical⇒High, Mission-Critical/Strictly Confidential⇒Very High. Likelihood is set to Likely for custom software due to common organizational drift in enforcing approvals.",
      "falsePositives": "Organizational release processes may exist outside the model (e.g., out-of-band CAB/ITIL). Validate before remediation. If strong pipeline policies and artifact signing are already enforced, this can be marked as accepted with evidence.",
      "cwe": "494",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "73_sec4.ts",
      "bsiCode": "OPS.1.1.6",
      "id": "incomplete-test-documentation-bsi-con-1-a12",
      "title": "Incomplete Test Documentation (BSI CON.1.A12 / OPS.1.1.6)",
      "description": "If software test documentation is incomplete, it is impossible to determine retrospectively what was tested and with which results.",
      "impact": "Bugs or missing features that are not properly documented and addressed before a release can directly impact the integrity of processed data (unintentional modification/deletion)",
      "action": "Introduce and enforce comprehensive, reviewable test documentation and release criteria.",
      "mitigation": "Ensure that all test activities (test plan, cases, data, environment, execution logs, results, defects, and approvals) are complete, traceable, and versioned.",
      "check": "Is there an enforced policy for test documentation and release criteria? Are test results and deviations reviewed before approval? Is a bug tracker used, and are regression tests and environment separation practiced?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.6 Software-Tests und Freigaben; CON.1.A12 Documentation on tests and approvals",
      "cheatSheet": "https://www.bsi.bund.de/EN/Topics/ITGrundschutz/itgrundschutz_node.html",
      "detectionLogic": "Raised for each technical asset with customDevelopedParts=true that is in scope.",
      "riskAssessment": "Likelihood is set to 'Likely' as a baseline for custom software lacking verifiable, formal test documentation.",
      "falsePositives": "May be a false positive where a mature and enforced process exists: written policies, test plans, regression testing, separated test environments, formal approvals, and a mandatory defect management workflow.",
      "cwe": "1164",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "73_sec5.ts",
      "bsiCode": "OPS.1.1.6",
      "id": "unclear-software-release-criteria",
      "title": "Unclear Software Release Criteria (BSI-derived)",
      "description": "If release criteria for software are not clearly defined and communicated, software may be released prematurely with undetected defects, or conversely, releases may be unnecessarily delayed.",
      "impact": "Releasing software prematurely can introduce versions with undetected bugs, potentially disrupting production operations and affecting the Integrity and Availability of the system.",
      "action": "Define, document, and enforce clear release criteria",
      "mitigation": "Establish and document formal release criteria that cover functional correctness, security checks (e.g., SAST/DAST results, dependency scanning), performance testing, and operational readiness.",
      "check": "Is there a formal, documented policy for software release criteria? Do build pipelines enforce checks related to these criteria? Is there a formal approval or sign-off process for production releases?",
      "asvs": "ASVS V1.1 (Secure Software Development Lifecycle Requirements)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Secure_Software_Development_Lifecycle_Cheat_Sheet.html",
      "detectionLogic": "This organizational risk is raised for all in-scope technical assets marked as `custom_developed_parts`.",
      "riskAssessment": "The likelihood of this risk is considered 'Likely' as establishing and maintaining rigorous release processes is a common challenge.",
      "falsePositives": "This risk can be considered a false positive if a robust, well-documented release process is in place for the asset, but it has not been marked in the model with the `release-criteria:documented` tag.",
      "cwe": "400",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "74_sec1.ts",
      "bsiCode": "OPS.1.1.7",
      "id": "compromise-of-system-management-solution",
      "title": "Compromise of System Management Solution",
      "description": "Due to their central position and the necessary access rights to all managed systems, system management solutions are a primary target for attacks.",
      "impact": "A successful compromise can lead to the complete takeover of all managed systems. Attackers could install ransomware, exfiltrate sensitive data from across the managed fleet, or cause widespread service outages.",
      "action": "Harden System Management Solutions and Ensure Timely Patching",
      "mitigation": "Implement a robust patch and vulnerability management process for the system management solution itself.",
      "check": "Is there a documented and effective patch management process for the system management solution? Is the solution itself hardened? Is access to its management interfaces restricted to only authorized personnel and systems?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.5 (Patch and Change Management), specifically Requirement OPS.1.1.5.A13 (Timely application of security-relevant patches and updates).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for any technical asset explicitly tagged as a `@SystemManagementSolution`. The tool then identifies all systems managed by this solution (via outgoing communication links) to assess the potential blast radius and calculate impact.",
      "riskAssessment": "The likelihood is considered higher if the management solution is internet-exposed or consists of custom-developed parts, as these factors increase the attack surface.",
      "falsePositives": "This risk may be flagged even for well-maintained and hardened systems, as the model cannot verify the current patch level or the effectiveness of operational security controls. It should be considered a standing risk to be accepted or mitigated through robust operational processes.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "74_sec2.ts",
      "bsiCode": "OPS.1.1.7",
      "id": "faulty-automation-from-scripts-bsi",
      "title": "Compromise via Faulty System Management Automation (BSI-aligned)",
      "description": "All protection goals (Confidentiality, Integrity, Availability) of managed systems can be jeopardized by defective automation.",
      "impact": "A single flaw in automation (e.g., a mistaken configuration push or unsafe task) can propagate rapidly across many systems, including highly critical ones, causing outages, tampering, or data exposure.",
      "action": "Harden and validate automation that manages systems",
      "mitigation": "Apply SDLC controls to automation and IaC: code reviews, static checks, tests, and staged rollouts with automatic rollback.",
      "check": "Are automation scripts/pipelines reviewed and tested? Do automation accounts have only necessary permissions?",
      "asvs": "ASVS V1, V2, V3, V11.3.1 (Deployment Process Security)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/CI_CD_Security_Cheat_Sheet.html",
      "detectionLogic": "Trigger for technical assets that represent system-management automation (build/deploy pipelines, schedulers, orchestration, repos with webhooks)",
      "riskAssessment": "Likelihood rises when custom-developed automation is present or frequently changed. Impact is derived from the target’s CIA ratings—",
      "falsePositives": "May be a false positive if links are strictly read-only/monitoring, workflows are formally verified, or if changes cannot be applied to targets (e.g., air-gapped, immutable).",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "74_sec3.ts",
      "bsiCode": "OPS.1.1.7",
      "id": "insecure-system-management-communication",
      "title": "Insecure System Management Communication (BSI CON.6)",
      "description": "Accidental interference with or targeted attacks on system management communication can violate the integrity and availability of managed IT systems. If system management communication is eavesdropped on, data transmitted to and from the systems can be recorded and viewed. If the communication is manipulated, active systems can be controlled by unauthorized actors.",
      "impact": "If an attacker can eavesdrop on or manipulate this communication, they can intercept sensitive configuration data, credentials, or operational data (violating Confidentiality). They could also inject malicious commands to alter system configurations, deploy malware, or disrupt services (violating Integrity and Availability), effectively gaining unauthorized control over the target system (Elevation of Privilege).",
      "action": "Secure System Management Communication Links",
      "mitigation": "All communication links used for system management (`usage: devops`) must use strong, encrypted protocols (e.g., HTTPS, SSH, WSS, FTPS). Ensure that strong authentication methods are used and that authentication is never set to `none`. For highly sensitive connections crossing trust boundaries, consider enforcing the use of a VPN (`vpn: true`) and implementing strict IP filtering.",
      "check": "Review all communication links with `usage: devops`. Verify that their `protocol` is an encrypted variant and that `authentication` is not `none`. Check if these links cross trust boundaries without additional protection like a VPN.",
      "asvs": "V6.1.1: Verify that all communications between components are encrypted using TLS with a strong configuration.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for any `CommunicationLink` where `usage` is `devops` and the connection is either unencrypted (checked via `isProtocolEncrypted`) or uses no authentication (`authentication: none`). The risk is ignored if the link is marked as protected by a VPN (`vpn: true`).",
      "riskAssessment": "The likelihood is based on the context. An unencrypted management link on a trusted internal network might be 'Likely' to be exploited by an insider. If it crosses a trust boundary or the internet, it becomes 'Very Likely' or 'Frequent'. The impact is determined by the CIA ratings of the technical asset being managed. Gaining control over a `mission-critical` system has a `Very-High` impact.",
      "falsePositives": "A link might be mis-tagged as `devops`. The communication might be tunneled through an external VPN but not modeled with the `vpn: true` flag. Some legacy monitoring protocols might be intentionally unencrypted but heavily firewalled; this could be a valid exception if documented.",
      "cwe": "319",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "74_sec4.ts",
      "bsiCode": "OPS.1.1.7",
      "id": "insufficient-time-synchronization-bsi-ops114-a4",
      "title": "Insufficient Time Synchronization (BSI OPS.1.1.7.A3)",
      "description": "Errors in time synchronization can obscure problems and events, making it difficult to detect security incidents and data exfiltration.",
      "impact": "This can severely hamper incident response, hide unauthorized activities, and disrupt authentication or other time-sensitive protocols.",
      "action": "Ensure and Enforce Centralized Time Synchronization",
      "mitigation": "All server-side technical assets, especially those involved in logging, monitoring, authentication, and transaction processing, must be configured to use a central, reliable time source (e.g., via NTP).",
      "check": "Are all server-side systems and relevant devices (like IoT) configured to use a central NTP server? Is the health of the NTP service monitored? Do logs from different systems show synchronized timestamps?",
      "asvs": "BSI IT-Grundschutz Baustein OPS.1.1.7 (Systemmanagement), Requirement A3 (Time synchronization for system management)",
      "cheatSheet": "BSI IT-Grundschutz: OPS.1.1.7 Systemmanagement (A3: Zeitsynchronisation)",
      "detectionLogic": "This risk is raised for any in-scope, server-side technical asset (i.e., not a typical client like a browser or mobile app) that is not explicitly tagged as being time-synchronized via '@NTP-Synchronized: true'.",
      "riskAssessment": "The likelihood is considered 'Likely' if there is no explicit confirmation of a time synchronization mechanism. The impact is derived from the integrity and availability requirements of the asset.",
      "falsePositives": "This risk is generated based on the absence of a specific tag in the model. It can be a false positive if the asset is indeed time-synchronized but has not yet been tagged accordingly in the model. Verification with the operations team is required.",
      "cwe": "117",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "74_sec5.ts",
      "bsiCode": "OPS.1.1.7",
      "id": "incompatible-system-management-solution",
      "title": "Incompatible System Management Solution (related to BSI G 0.23)",
      "description": "A partially compatible system management solution can cause malfunctions in the managed IT systems, limiting their availability.",
      "impact": "The primary impact is on the **Availability** of the managed systems, potentially leading to instability, unexpected behavior, or crashes.",
      "action": "Verify and Test System Management Tool Compatibility",
      "mitigation": "Ensure that any system management solution is fully compatible with the target systems it manages. This should be verified before initial deployment and re-validated after any updates to either the management tool or the managed system.",
      "check": "Is there a documented compatibility matrix for the management tools and the systems they manage? Is there a testing and validation process to verify compatibility after updates?",
      "asvs": "Based on BSI IT-Grundschutz Catalog, Threat G 0.23 'Fehlfunktion durch Inkompatibilität' (Malfunction due to Incompatibility).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/kompendium_elementare_gefaehrdungen_2023.pdf?__blob=publicationFile (Catalog of Elementary Threats)",
      "detectionLogic": "Triggers on communication links originating from assets identified as system management tools (e.g., Monitoring, Scheduler, Container Platform, IDS/IPS) to other technical assets. The risk highlights the potential for incompatibility between the tool and the target, which requires manual verification.",
      "riskAssessment": "The impact is derived from the **Availability** rating of the managed target asset. A `mission-critical` target results in a 'Very High' impact. The likelihood is rated as `Likely` by default to flag this architectural concern for manual review, as it cannot be automatically confirmed. The risk is higher in heterogeneous environments.",
      "falsePositives": "This risk can be considered a false positive if the management tool is explicitly designed and certified for the target system (e.g., a vendor's proprietary management suite for its own products). Manual confirmation is required to close this risk.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "74_sec6.ts",
      "bsiCode": "OPS.1.1.7",
      "id": "connection-interruption-system-management",
      "title": "Connection Interruption of System Management Solution (BSI SYS.1.6.A1)",
      "description": "Connection interruptions can limit the availability of a system management solution.",
      "impact": "If a connection is interrupted or disrupted, costly, security-relevant, and time-critical tasks cannot be performed on schedule.",
      "action": "Ensure Network and System Resilience for Management Connections",
      "mitigation": "Implement redundant network paths for critical administrative connections. Ensure high-availability configurations for the system management solution itself and monitor connection health.",
      "check": "Are communication links to system management tools monitored for availability? Is the system management solution deployed in a highly available configuration?",
      "asvs": "ASVS V9.1: Denial of Service Defenses",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
      "detectionLogic": "This risk is generated for 'devops' usage communication links from an administrative client to a system management component (e.g., monitoring, container platform, identity provider).",
      "riskAssessment": "The likelihood of an interruption is higher for connections that cross unreliable networks (like the internet) without robust protocols or VPNs.",
      "falsePositives": "This risk might be a false positive if network redundancy exists but is not explicitly modeled (e.g., via BGP, multiple NICs, or SD-WAN).",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "74_sec7.ts",
      "bsiCode": "OPS.1.1.7",
      "id": "connection-loss-to-managed-systems",
      "title": "Connection Loss to Managed Systems",
      "description": "Connection interruptions to systems that are being managed (e.g., for administration, monitoring, or deployments) can impair the availability and integrity of services within the information network. The extent of such a connection loss determines whether services are impaired and what damage may occur. The resulting error patterns can be difficult to analyze, and the resulting faults can be difficult to rectify.",
      "impact": "A loss of a management connection can lead to service degradation or complete outages (Denial of Service). It may also result in data inconsistencies or corruption if ongoing processes are interrupted abruptly (loss of integrity). Furthermore, the resulting errors can be difficult to diagnose, prolonging downtime and increasing operational effort.",
      "action": "Implement Redundant Connections and Failover Mechanisms",
      "mitigation": "Ensure that critical management and operational connections are redundant. Use high-availability network setups. Implement automated health checks on connections with failover capabilities. Robust monitoring and alerting should be in place to quickly detect and respond to connection failures. The target systems themselves should also be redundant where possible.",
      "check": "Are connections for management and operations to critical systems designed for high availability? Do monitoring systems alert on connection failures? Is the target system itself redundant to mitigate the impact of a control plane failure?",
      "asvs": "Derived from general BSI threat assessments. Closely related to the principles of BSI IT-Grundschutz Baustein CON.3 (Redundancy).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Redundancy_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for `devops`-usage communication links connecting to important or critical technical assets, especially when the target asset is not marked as redundant. The severity increases based on the target's lack of redundancy and its overall availability and integrity requirements.",
      "riskAssessment": "The impact is determined by the highest availability and integrity requirements of the target asset and the data it handles. A lack of redundancy in the target system significantly increases the impact. The likelihood of an incident is considered higher for non-redundant targets, as a single connection failure directly leads to a loss of management capability.",
      "falsePositives": "The model may not capture underlying network-level redundancy (e.g., redundant switches, link aggregation). The risk may be acceptable if such infrastructure-level resilience is confirmed to be in place.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "74_sec8.ts",
      "bsiCode": "OPS.1.1.7",
      "id": "uncoordinated-network-and-system-management",
      "title": "Uncoordinated Network and System Management",
      "description": "Uncoordinated actions in network management can have a negative impact on system management.",
      "impact": "If changes to network and system configurations are not coordinated, it can lead to service disruptions (Denial of Service) or data corruption (Integrity loss).",
      "action": "Establish and Enforce Coordinated Change Management",
      "mitigation": "Implement a unified change management process that covers both network and system infrastructure.",
      "check": "Is there an integrated change management process for both network and systems? Are network changes assessed for their impact on application and data flows?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.5 Patch and Change Management",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is identified for communication links that traverse network-level trust boundaries.",
      "riskAssessment": "The likelihood of an incident is higher when communication crosses administrative or network boundaries.",
      "falsePositives": "This risk may be a false positive in organizations with exceptionally mature and integrated change management processes, even with complex network architectures.",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "75_sec1.ts",
      "bsiCode": "OPS.1.2.2",
      "id": "data-obsolescence-in-archives",
      "title": "Data Obsolescence in Long-Term Archives (BSI CON.8.G1)",
      "description": "Data intended for long-term storage can become unusable over time. This is due to the physical or technical aging of underlying system components, storage media, and data formats.",
      "impact": "If this risk materializes, archived information may become unreadable (loss of availability) or be altered by degradation (loss of integrity).",
      "action": "Implement Data Lifecycle and Archiving Strategy",
      "mitigation": "Establish a robust long-term archiving strategy. This should include selecting durable, open, and well-documented data formats.",
      "check": "Is there a defined strategy for long-term data preservation? Are data formats and storage media periodically checked for obsolescence and integrity?",
      "asvs": "BSI IT-Grundschutz CON.8.A3 Selection of suitable storage media and data formats; CON.8.A4 Regular check of the readability of information",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Long-term_archiving_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for any technical asset of type 'datastore' that stores data assets classified with a criticality of 'archive'.",
      "riskAssessment": "The likelihood is considered 'likely' by default, as data and media obsolescence is a certainty over long periods without intervention.",
      "falsePositives": "A false positive can occur if an effective archiving and migration strategy exists but is not documented in the model via the",
      "cwe": "353",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "75_sec2.ts",
      "bsiCode": "OPS.1.2.2",
      "id": "insufficient-archive-classification-criteria-bsi-con-8-a22",
      "title": "Insufficient Classification Criteria for Archives (BSI CON.8.A22)",
      "description": "Electronic archives may contain very large amounts of data. Records are stored based on classification criteria (indexing) derived from index data of business applications and from the archive system itself.",
      "impact": "Due to unsuitable or limited classification criteria, archiving objectives may be missed, such as the ability to provide evidence to third parties.",
      "action": "Define and Implement Robust Archiving and Indexing Policies",
      "mitigation": "Define and document suitable and sufficient classification criteria for all electronic archives based on business, operational, and legal requirements.",
      "check": "Are there documented classification and indexing criteria for all electronic archives? Do these criteria meet all relevant legal and business requirements for data retrieval and provability?",
      "asvs": "BSI IT-Grundschutz CON.8 Archiving — CON.8.A22 Selection of suitable classification criteria for electronic archives.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Archiving_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any data store (`type: datastore`) that is explicitly identified as an archive via the `classification:archive` tag.",
      "riskAssessment": "The likelihood of this risk is considered 'Likely' for any system identified as an archive, as proper long-term classification is a complex requirement that is often overlooked.",
      "falsePositives": "This can be a false positive if a comprehensive and suitable archiving and classification strategy is defined and implemented for the asset but is not modeled (e.g., documented externally).",
      "cwe": "353",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "75_sec3.ts",
      "bsiCode": "OPS.1.2.2",
      "id": "insufficient-logging-of-archive-access",
      "title": "Insufficient Logging of Archive Access (based on BSI)",
      "description": "Unauthorized access to archives is typically detected using log files. However, if logging is not sufficiently comprehensive,",
      "impact": "If logging is insufficient, unauthorized access to archived data may not be detected. This can lead to a silent breach of confidentiality (data theft)",
      "action": "Implement Comprehensive and Tamper-Proof Logging for Archive Access",
      "mitigation": "Ensure that all access attempts (both successful and failed) to technical assets holding archive data are logged in detail.",
      "check": "Are all read and write access events to the archive asset logged? Are the logs protected against tampering and unauthorized access? Is there a process for regular review of these logs?",
      "asvs": "BSI IT-Grundschutz CON.8 (Detection of security-relevant events), OWASP ASVS V7 (Logging and Monitoring)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Detection_of_security-relevant_events_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies technical assets of type 'datastore' that store data assets classified with an integrity or availability level of 'archive'.",
      "riskAssessment": "The likelihood is considered 'likely' by default, as comprehensive logging for less-frequently accessed archives is often overlooked.",
      "falsePositives": "This risk is generated based on the architectural model and cannot verify the actual logging implementation.",
      "cwe": "778",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "75_sec4.ts",
      "bsiCode": "OPS.1.2.2",
      "id": "falsification-or-loss-during-scanning-con1",
      "title": "Falsification or Loss of Information during Document Scanning (BSI CON.1)",
      "description": "When documents are scanned or digitized, their appearance or the semantics of the captured data can be falsified. Documents or parts of them can also be lost during this process.",
      "impact": "This compromises the Integrity and Availability of the data. Incorrect business decisions may be made based on flawed data, business processes can be disrupted, and regulatory or contractual obligations might be violated if the original document information is not preserved correctly.",
      "action": "Implement Robust Scanning and Data Validation Processes",
      "mitigation": "Implement technical and organizational controls for the scanning/digitization process. This includes using high-quality software with error detection and correction features (e.g., OCR confidence scores, image quality checks). Implement checksums or other integrity checks for file transfers. For critical processes, incorporate a manual or semi-automated validation step where a human reviews the digitized output against the original document, especially for key data fields. Maintain detailed logs of all operations to trace any lost or incorrectly processed documents.",
      "check": "Does the digitization process have built-in quality and completeness checks? Are there procedures to validate the integrity of the captured data against the source? Are logs kept for all digitization activities to ensure traceability?",
      "asvs": "BSI IT-Grundschutz Baustein CON.1 (Data Acquisition and Preparation), especially CON.1.A19 (Error handling during data acquisition). Also relates to OWASP ASVS V5.2 (Data Validation Requirements).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Data_acquisition_and_preparation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "The risk is identified for technical assets of type 'process' that accept data in a generic 'file' format (`DataFormat.File`), as this often represents a digitization or scanning process where information can be lost or misinterpreted. The risk is considered higher for custom-developed components, as they may lack the sophisticated error-handling and reconciliation features of specialized COTS scanning solutions.",
      "riskAssessment": "The likelihood is higher if the component processing the files is custom-developed. The impact is directly related to the integrity and availability requirements of the data being processed. If mission-critical data is being scanned, the impact is very high.",
      "falsePositives": "The asset might be accepting files for a purpose other than digitization (e.g., a simple file share without processing). The risk can be considered a false positive if the process has strong, proven validation and reconciliation mechanisms that are not captured in the model.",
      "cwe": "20",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "75_sec5.ts",
      "bsiCode": "OPS.1.2.2",
      "id": "outdated-encryption-methods",
      "title": "Use of Outdated Encryption Methods (BSI OPS.1.2.2 context)",
      "description": "Cryptographic methods used for encryption must be regularly adapted to the state of the art to maintain their protective effect.",
      "impact": "An attacker could break the weak encryption, leading to the disclosure of sensitive or confidential information. This compromises confidentiality and can lead to data breaches, regulatory fines, and loss of trust.",
      "action": "Migrate to a state-of-the-art encryption algorithm",
      "mitigation": "Replace outdated encryption algorithms (like DES, 3DES, RC4, Blowfish) and modes (like ECB) with strong, modern alternatives (e.g., AES-256 with GCM or CCM mode).",
      "check": "Review source code, configuration files, and documentation to identify the encryption algorithms, modes, and key lengths in use. Use security scanners that detect weak cryptographic dependencies or configurations.",
      "asvs": "V6.2.3: Verify that strong, approved cryptographic algorithms and protocols are used.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
      "detectionLogic": "Triggers on technical assets explicitly tagged with `@Crypto:Weak-Encryption`. This tag indicates that the asset is known to use a broken, deprecated, or risky cryptographic algorithm for encryption purposes.",
      "riskAssessment": "The likelihood is high because the weakness is explicitly tagged. The impact is determined by the confidentiality requirements of the data processed or stored by the asset. A breach of 'Strictly Confidential' data has a very high impact.",
      "falsePositives": "This risk is unlikely to be a false positive if the tag is applied correctly. It might be considered a lower priority if the asset is only accessible within a highly trusted environment, but the underlying weakness still exists.",
      "cwe": "327",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "75_sec6.ts",
      "bsiCode": "OPS.1.2.2",
      "id": "insufficient-archive-review",
      "title": "Insufficient Review of Archiving Process (BSI-CON.1-style)",
      "description": "If the archiving process is checked too infrequently or imprecisely, malfunctions may not be detected.",
      "impact": "Failure to regularly and accurately review the archiving process can lead to undetected data corruption or manipulation.",
      "action": "Implement Regular Audits and Integrity Checks for Archiving Systems",
      "mitigation": "Establish a formal process for regularly reviewing and auditing the archiving system and its processes.",
      "check": "Is there a documented procedure for reviewing the archiving process? Are integrity checks performed on archived data?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Archivierung), Requirement CON.1.A5 (Prüfung des Archivs).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Archiving_Edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
      "detectionLogic": "This risk is raised for any datastore asset that stores data with high or mission-critical integrity requirements.",
      "riskAssessment": "The impact is directly derived from the integrity requirement of the most critical data asset stored in the archive.",
      "falsePositives": "This risk may be a false positive if a robust, regular, and effective review and audit process for the archiving system is already in place,",
      "cwe": "354",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "75_sec7.ts",
      "bsiCode": "OPS.1.2.2",
      "id": "non-compliance-with-legal-archiving-requirements",
      "title": "Non-Compliance with Legal Archiving Requirements",
      "description": "When archiving electronic documents and data, various legal and regulatory frameworks must be observed.",
      "impact": "Failure to comply with legal archiving and data retention requirements can lead to severe legal penalties, fines, and reputational damage.",
      "action": "Define and Implement Data Retention and Archiving Policies",
      "mitigation": "Establish and document clear data retention policies based on all applicable legal and business requirements.",
      "check": "Are there documented data retention policies for all relevant data types? Does the archiving solution technically enforce these policies? Is there a process for legal holds and eventual secure deletion?",
      "asvs": "This risk relates to legal and regulatory requirements, which are an overarching concern for applications. It aligns with the spirit of ASVS V14 (Configuration), as proper data retention is a critical configuration aspect.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_8_Loeschen_und_Vernichten.html",
      "detectionLogic": "This rule triggers risks for any 'datastore' technical asset that stores data classified with an 'archive' level of integrity or availability but does not have a tag indicating that a retention policy has been explicitly defined for it ('@retention-policy-defined').",
      "riskAssessment": "The likelihood of non-compliance is considered high if a policy is not defined for a system intended for archiving.",
      "falsePositives": "A policy might exist organizationally but may not be captured in the threat model via the specified tag. This risk should be verified with the system owner to confirm if a compliant retention policy is indeed missing.",
      "cwe": "16",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "76_sec1.ts",
      "bsiCode": "OPS.1.2.4",
      "id": "insufficient-telework-regulations-ops1.2.4",
      "title": "Insufficient Regulations for Telework (BSI OPS.1.2.4)",
      "description": "Using a telework setup requires supplementary organizational agreements and clear instructions for employees, especially regarding how to handle security incidents. Without communicated guidelines for events such as device loss or compromise at a remote location, incidents may not be reported or handled correctly, which significantly increases the risk of damage.",
      "impact": "If security incidents at a telework location (e.g., loss or theft of a device, unauthorized observation by third parties, malware infection) are not handled according to a defined process, confidential information can be compromised. This can lead to severe damage, including data breaches, reputational harm, and financial loss for the organization.",
      "action": "Establish and communicate clear telework security policies and incident response procedures",
      "mitigation": "Define, document, and communicate clear, actionable security policies and procedures specifically for telework. These policies must cover secure device handling (both corporate and BYOD), acceptable network usage, data storage and encryption requirements, and clear, mandatory procedures for immediately reporting any suspected security incidents. Ensure all personnel engaging in telework are trained on these procedures and know whom to contact and how. Regularly review and update these policies.",
      "check": "Are there documented and communicated security policies specifically for telework? Do employees know the exact procedure for reporting a security incident from their remote location? Is this process regularly tested or included in awareness campaigns?",
      "asvs": "BSI IT-Grundschutz Baustein OPS.1.2.4 (Telework), Section 2.1 (Insufficient or missing rules for telework)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Telework_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any technical asset that represents a telework endpoint. This includes client-type technologies (like browsers, mobile apps, desktops) that connect from the public internet or are explicitly marked as being used by a human client, and which process or store data with a sensitivity rating of 'restricted' or higher.",
      "riskAssessment": "The likelihood of this risk is considered 'likely' if telework capabilities are modeled, as specific telework incident response plans are a common oversight. The impact is directly dependent on the sensitivity (Confidentiality, Integrity, and Availability) of the data assets accessible from the telework asset. Accessing 'Strictly Confidential' data from a remote location without clear incident handling procedures poses a high-impact risk.",
      "falsePositives": "The threat model can only identify the technical presence of telework assets; it cannot verify the existence or effectiveness of organizational policies. This risk must be manually verified by reviewing the organization's documented telework security policies and incident response plans.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "76_sec2.ts",
      "bsiCode": "OPS.1.2.4",
      "id": "unauthorized-private-use-of-telework-client-bsi-ops-1-2-4",
      "title": "Unauthorized Private Use of Company Telework Client (BSI OPS.1.2.4)",
      "description": "In a home environment, users can more easily install unvetted or unapproved hardware or software on a company-provided telework client.",
      "impact": "If the telework client is infected, confidential information can be disclosed, altered, or exfiltrated.",
      "action": "Enforce endpoint security, clear usage rules, and least privilege.",
      "mitigation": "Introduce and enforce a strict policy prohibiting private use of company telework clients.",
      "check": "Is there a clearly communicated policy on private use of company devices? Are user accounts on telework clients configured without administrative privileges?",
      "asvs": "BSI IT-Grundschutz OPS.1.2.4: Telearbeit (e.g., 2.2 unauthorized private use; A2/A7 policy and technical safeguards).",
      "cheatSheet": "BSI IT-Grundschutz-Kompendium, Baustein OPS.1.2.4 \\",
      "detectionLogic": "This risk is raised for any technical asset identified as a client-type device (e.g., Desktop, Client-System) that is explicitly tagged as a telework client via the `telework-client` tag.",
      "riskAssessment": "Likelihood is high if no specific endpoint security controls or policies exist for telework clients.",
      "falsePositives": "This may be a false positive if robust, non-bypassable technical controls effectively prevent unauthorized software installation and private use, even if not explicitly modeled.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "76_sec3.ts",
      "bsiCode": "OPS.1.2.4",
      "id": "workflow-delay-due-to-uncoordinated-telework",
      "title": "Workflow Delay Due to Uncoordinated Telework (BSI OPS.1.2.4)",
      "description": "If employees do not have fixed working hours at the teleworkplace and no fixed times are agreed upon when they must be reachable, the workflow can be delayed as a result.",
      "impact": "Delayed workflows due to personnel unavailability directly compromise the Availability of business functions and processes. This can lead to missed deadlines, reduced productivity, and a failure to meet service level objectives.",
      "action": "Establish and Enforce Core Availability Hours for Telework",
      "mitigation": "Define and communicate a clear policy regarding telework, including core hours during which employees are expected to be available for collaboration and communication.",
      "check": "Is there a documented policy for telework that specifies core availability hours? Do team members know and adhere to these hours?",
      "asvs": "Not directly applicable. This is an organizational process risk related to human resource availability, not a technical application security vulnerability. It aligns with general business continuity management principles.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_4_Telearbeit.html",
      "detectionLogic": "This organizational risk is triggered for any technical asset tagged with '@Location:HomeOffice'.",
      "riskAssessment": "The likelihood of this risk materializing is considered 'Likely' in environments without formal telework policies. The impact is directly derived from the 'Availability' requirement of the tagged technical asset. A delay in a 'Mission-Critical' process has a much higher impact than a delay in an 'Archive' or 'Operational' one.",
      "falsePositives": "This risk might be a false positive if an organization has effective, albeit informal, communication and coordination practices for its remote workforce.",
      "cwe": "693",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "76_sec4.ts",
      "bsiCode": "OPS.1.2.4",
      "id": "delayed-information-for-remote-workers",
      "title": "Delayed Information for Remote Workers (BSI OPS.1.2.4)",
      "description": "Because employees are not always physically present in the organization, they have fewer opportunities to participate in ad-hoc, informal exchanges with managers and colleagues.",
      "impact": "Failure to learn about updated procedures or other important information in time can disrupt business processes and hinder task completion, affecting the availability (and in some cases integrity) of operations.",
      "action": "Establish formal and redundant communication channels for remote workers",
      "mitigation": "Ensure that all critical operational information is documented and communicated through formal, asynchronous channels (e.g., wikis, ticket systems, official chat channels, email summaries) that are accessible to all team members, regardless of their physical location.",
      "check": "Are there mandatory, documented procedures for disseminating important information to remote workers? Is critical information centrally archived and easily accessible?",
      "asvs": "Not directly covered by OWASP ASVS (organizational/process risk); related to ISO/IEC 27001 Annex A (e.g., A.6.2.1 Mobile device policy; A.11.2.6 Security of equipment and assets off-premises) and BSI OPS.1.2.4.A8.",
      "cheatSheet": "BSI IT-Grundschutz Kompendium – OPS.1.2.4 Telearbeit (German)",
      "detectionLogic": "This organizational risk is associated with assets that represent telework endpoints. In this model, it flags assets that are human-operated clients (`used_as_client_by_human`), are internet-facing (`internet`),",
      "riskAssessment": "Likelihood is considered 'likely' wherever remote work is supported, as informal communication gaps are common without explicit mitigation.",
      "falsePositives": "Can be a false positive if robust, formal, asynchronous communication processes exist (e.g., mandatory written decisions, centrally documented updates, inclusive meeting practices) that reliably reach all remote workers.",
      "cwe": "841",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "76_sec5.ts",
      "bsiCode": "OPS.1.2.4",
      "id": "insecure-telework-environment-con3",
      "title": "Insecure Telework Environment (BSI OPS.1.2.4)",
      "description": "At the teleworking location (e.g., home office), a lack of organizational control and monitoring can lead to employees not implementing recommended or mandated security measures fully. This can be due to insecure private networks, use of devices by unauthorized third parties (e.g., family members), or shoulder surfing. As a result, sensitive information handled on these remote devices can be compromised and fall into the hands of unauthorized individuals.",
      "impact": "If security measures are not enforced on remote clients, confidential information accessed or processed by them can be exposed. This can lead to data breaches, compliance violations, and reputational damage. The integrity of the system can also be affected if the insecure client is used as an entry point for further attacks.",
      "action": "Implement and enforce secure teleworking policies and technical controls",
      "mitigation": "Enforce a comprehensive security policy for all remote work. This includes hardening client devices (laptops, mobile phones) with full-disk encryption (FDE), endpoint detection and response (EDR) solutions, and Mobile Device Management (MDM). Mandate the use of a secure VPN for all access to internal company resources. Provide regular security awareness training focused on the specific risks of teleworking. Implement strong multi-factor authentication for all remote access.",
      "check": "Is there a defined and enforced policy for secure teleworking? Are client devices centrally managed and hardened? Is a VPN required for access? Do employees receive training on remote work security?",
      "asvs": "BSI IT-Grundschutz CON.3.A13: Protecting information when teleworking",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_use_of_ICT_Edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies technical assets that are used by humans as clients (e.g., browsers, desktop apps) and are connected to the internet, suggesting they operate in an uncontrolled environment such as a home office. A risk is raised if these clients access or transmit data with a confidentiality level of 'restricted' or higher.",
      "riskAssessment": "The likelihood of an incident is considered high for unmanaged clients in untrusted environments. The impact is directly proportional to the confidentiality of the data being accessed. A 'Strictly Confidential' document accessed from a home office poses a much higher risk than a 'Public' one. The risk can be mitigated by applying technical controls, which can be indicated by the '@Telework:Hardened' tag.",
      "falsePositives": "A risk might be flagged for an asset that is, in reality, well protected by endpoint security measures (EDR, MDM) that are not documented in the threat model. In such cases, the asset can be tagged with '@Telework:Hardened' to suppress this finding.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "77_sec1.ts",
      "bsiCode": "OPS.1.2.5",
      "id": "insecure-remote-maintenance-configuration",
      "title": "Insecure Configuration of Remote Maintenance (BSI CON.3.A4)",
      "description": "Administrators who set up and use remote maintenance rely on policies that define how it should be used. For example, it is necessary to specify how remote maintenance applications must be configured. Otherwise, remote maintenance can introduce additional risks to the internal network. If the regulations for remote maintenance are not communicated to the parties involved, risks to IT operations arise. For example, a remote maintenance interface could be configured to allow an authentication method with an insecure password instead of a secure, certificate-based procedure.",
      "impact": "If remote maintenance is not configured securely due to a lack of clear rules, it can create a major entry point for attackers into an otherwise protected internal network. This can lead to unauthorized access, privilege escalation, data breaches (loss of Confidentiality), system and data manipulation (loss of Integrity), and service disruptions (loss of Availability).",
      "action": "Define and Enforce Secure Remote Maintenance Policies",
      "mitigation": "Establish and enforce clear, documented policies for all remote maintenance access. These policies must specify mandatory security configurations, including the use of strong, multi-factor, or certificate-based authentication. The use of simple password-based credentials for remote access across network boundaries should be explicitly forbidden. Ensure all administrators are aware of and trained on these policies. Regularly audit remote access configurations for compliance.",
      "check": "Is there a documented policy for remote maintenance? Does it mandate strong authentication (MFA, certificates)? Is there a process to ensure administrators follow this policy? Are remote access links using weak authentication methods like simple credentials?",
      "asvs": "BSI IT-Grundschutz CON.3 Remote Access, Requirement CON.3.A4 Regulation of remote maintenance",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Remote_Access_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers on communication links that use typical remote maintenance protocols (like SSH) to cross a network trust boundary, but are configured with weak authentication methods (like 'credentials' instead of 'client-certificate'). This indicates a potential violation of secure remote maintenance policies.",
      "riskAssessment": "The likelihood is high if a remote maintenance protocol is used across a network boundary with weak authentication ('credentials' or 'none'). The impact is directly dependent on the confidentiality and integrity of the target asset. Accessing a mission-critical database via insecure remote maintenance has a very high impact.",
      "falsePositives": "The model might flag a connection using 'credentials' as weak, even if a compensating control like MFA is enforced by the target system but not modeled in Threagile. The risk is about the *policy* and its technical implementation, so it might be considered a valid finding even if other controls exist.",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "77_sec2.ts",
      "bsiCode": "OPS.1.2.5",
      "id": "insecure-remote-administration",
      "title": "Insecure Remote Administration (BSI OPS.1.2.5)",
      "description": "If remote administration is not carefully planned, configured, and regulated, the security of an institution's IT systems can be compromised.",
      "impact": "Using insecure protocols or authentication for remote administration can lead to unauthorized access, data breaches, system tampering, or denial of service.",
      "action": "Secure Remote Administration Channels",
      "mitigation": "Use strong, encrypted protocols (e.g., SSH, HTTPS, or any protocol tunneled through a VPN).",
      "check": "Are all remote administration connections using encrypted protocols? Is strong authentication enforced? Is access restricted by source IP? Are sessions logged and monitored?",
      "asvs": "BSI IT-Grundschutz OPS.1.2.5 Remote Administration",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_5_Remote_administration_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule scans for communication links identified for administrative purposes (`usage: devops`) that are configured insecurely.",
      "riskAssessment": "The likelihood of exploitation is high if unencrypted protocols or no authentication are used for remote administration, especially for internet-facing assets.",
      "falsePositives": "A risk might be a false positive if the `devops` usage tag is used for non-administrative purposes,",
      "cwe": "522",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "77_sec3.ts",
      "bsiCode": "OPS.1.2.5",
      "id": "weak-authentication-for-remote-maintenance",
      "title": "Weak Authentication for Remote Maintenance",
      "description": "Different authentication mechanisms can be used for remote maintenance. If an insecure authentication procedure is used,",
      "impact": "Successful exploitation can lead to a complete compromise of the target system, including unauthorized access, modification, or",
      "action": "Enforce Strong Authentication for all Remote Maintenance Connections",
      "mitigation": "Use multi-factor authentication (MFA / 'two-factor'), client certificates, or hardware tokens for all remote maintenance access.",
      "check": "Review all communication links with a usage of 'devops' or involving administrative protocols like SSH.",
      "asvs": "OWASP ASVS V4.0.3 - 2.1.1 (Authentication), 2.2.1 (Credential Strength)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
      "detectionLogic": "This rule checks all communication links that are likely used for remote maintenance. These are identified by the 'devops'",
      "riskAssessment": "The likelihood of exploitation is highest for connections directly exposed to the internet using no authentication.",
      "falsePositives": "A risk flagged for 'credentials'-based authentication might be a false positive if the password policy is very strong and enforced,",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "77_sec4.ts",
      "bsiCode": "OPS.1.2.5",
      "id": "inadequate-remote-maintenance-ops115",
      "title": "Inadequate Remote Maintenance (BSI OPS.1.2.5)",
      "description": "To ensure the security and functionality of IT systems and applications that are accessed remotely,",
      "impact": "Improper or insecure remote maintenance can lead to a loss of availability, system integrity violations,",
      "action": "Establish and Enforce Secure Remote Maintenance Procedures",
      "mitigation": "Define and enforce clear, secure procedures for all remote maintenance activities.",
      "check": "Are all remote administration connections forced to use encrypted protocols and strong authentication?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.2.5 (Remote Maintenance).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_Server_operation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI OPS.1.2.5)",
      "detectionLogic": "This risk is detected by analyzing incoming communication links to server-side technical assets.",
      "riskAssessment": "The likelihood is high if unencrypted protocols or no authentication is used for remote access across network boundaries.",
      "falsePositives": "A link might be miscategorized as 'maintenance' when it is not. The model might not fully capture",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "77_sec5.ts",
      "bsiCode": "OPS.1.2.5",
      "id": "insecure-communication-protocol",
      "title": "Insecure Communication Protocol (based on BSI recommendation)",
      "description": "Communication over public or internal networks using insecure protocols poses a significant threat.",
      "impact": "Using insecure protocols can lead to the compromise of confidentiality through eavesdropping (Information Disclosure) and the compromise of integrity through data modification (Tampering).",
      "action": "Enforce Secure Communication Protocols",
      "mitigation": "All communication links transmitting sensitive data across trust boundaries must use strong, state-of-the-art encryption protocols (e.g., HTTPS, WSS, FTPS, SFTP, SMTPS).",
      "check": "Review all communication links in the architecture. Are there any protocols that transmit data in cleartext across trust boundaries? For all encrypted protocols, are up-to-date and securely configured versions and ciphers used?",
      "asvs": "V4.3.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule automatically detects all communication links that use a protocol not considered encrypted (e.g., HTTP, FTP, Telnet).",
      "riskAssessment": "The likelihood of exploitation is higher for links exposed to the internet or crossing network boundaries. The impact is directly related to the sensitivity (confidentiality and integrity) of the data assets being transferred over the insecure link. Transmitting 'Strictly Confidential' data over HTTP poses a 'Critical' risk.",
      "falsePositives": "A risk might be flagged for a link that is protected by a separate, un-modeled compensating control, like a site-to-site VPN tunnel.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "77_sec6.ts",
      "bsiCode": "OPS.1.2.5",
      "id": "unregulated-remote-maintenance-by-third-party",
      "title": "Unregulated Remote Maintenance by Third Party (BSI OPS.1.2.5)",
      "description": "If IT systems are remotely maintained by third parties without a contractual basis, the responsibilities for remote maintenance may not be clearly regulated.",
      "impact": "This lack of regulation can result in unauthorized access, data tampering (Integrity), information disclosure (Confidentiality), or service disruption (Availability).",
      "action": "Establish Formal Agreements and Technical Controls for Remote Maintenance",
      "mitigation": "Ensure that all remote maintenance activities performed by third parties are governed by a formal, legally binding contract.",
      "check": "Is there a contract in place for every third party that performs remote maintenance? Does the contract specify security requirements for the remote access connection? Are remote access logs created and reviewed? Is access actively managed and revoked when no longer necessary?",
      "asvs": "BSI IT-Grundschutz Baustein OPS.1.2.5 (Remote Maintenance), specifically addressing threat G 0.35 (Insufficient regulations for remote maintenance).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_5_Remote_access_and_remote_maintenance_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for any communication link from a `third-party` technical asset (type `external-entity`) to an in-scope asset using a common remote maintenance protocol (like SSH, SCP, SFTP).",
      "riskAssessment": "The likelihood is considered high if an unregulated remote access path from a third party exists. The impact is determined by the CIA requirements of the target asset and the data it processes or stores.",
      "falsePositives": "A risk might be flagged if the modeler omitted the `@Service:RemoteMaintenance` tag, even though a valid contract exists. The existence of a formal agreement must be verified outside the threat model.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "77_sec7.ts",
      "bsiCode": "OPS.1.2.5",
      "id": "remote-maintenance-via-online-service-ops1.2.5",
      "title": "Remote Maintenance via Untrusted Online Service (BSI OPS.1.2.5)",
      "description": "When remote maintenance is performed via an intermediary online service, a data connection is established from the system to be administered to the service's servers. Administrators then access their systems through this service, for example via a web browser. If this communication is not end-to-end encrypted (i.e., the online service can decrypt the traffic), the service provider can read the entire data exchange. This creates a risk of information disclosure and tampering.",
      "impact": "A malicious or compromised online service provider could gain access to sensitive administrative commands and data. This could lead to unauthorized administration of systems, data manipulation (tampering), or theft of credentials and sensitive information, compromising the confidentiality and integrity of the managed systems. If the IT system automatically connects to the service on startup, it may be possible to access the system without the knowledge of the system's users or administrators.",
      "action": "Implement End-to-End Encrypted Remote Maintenance",
      "mitigation": "Prefer direct remote maintenance channels secured by VPN (`vpn: true` on the communication link). If an intermediary online service must be used, ensure that the communication is truly end-to-end encrypted, meaning the service provider cannot access the plaintext of the administrative session. This can be achieved through protocols that establish a secure tunnel through the intermediary. All connections must use strong, state-of-the-art transport encryption (e.g., HTTPS, SSH). The online service itself should be thoroughly vetted as a trusted provider. Monitor all remote maintenance connections.",
      "check": "Does any remote maintenance (`devops` usage) traffic pass through an internet-facing intermediary component? Is this communication protected by more than just standard HTTPS on each leg? Is there a mechanism (like a VPN or an end-to-end encrypted tunnel) that prevents the intermediary from reading the traffic?",
      "asvs": "BSI IT-Grundschutz OPS.1.2.5 Fernwartung (Remote Maintenance)",
      "cheatSheet": "",
      "detectionLogic": "This risk is raised for any internet-facing technical asset (of type Process or External-Entity) that acts as an intermediary for `devops` traffic. An intermediary is identified as an asset that has at least one incoming communication link and at least one outgoing communication link with the `devops` usage type.",
      "riskAssessment": "The impact is calculated based on the highest Confidentiality, Integrity, and Availability of all target assets being administered through the intermediary. The likelihood is 'Likely' due to the architectural pattern itself, which exposes traffic to the intermediary. If any of the communication links involved are unencrypted, the likelihood increases to 'Very-Likely'.",
      "falsePositives": "A false positive may occur if the model does not capture specific end-to-end encryption controls that prevent the intermediary from accessing plaintext (e.g., a custom-built secure tunneling protocol). The risk may be acceptable if the intermediary is a fully trusted, hardened, and monitored component, although the architectural weakness still exists.",
      "cwe": "300",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "77_sec8.ts",
      "bsiCode": "OPS.1.2.5",
      "id": "vulnerability-in-integrated-remote-maintenance-component",
      "title": "Vulnerability in Integrated Remote Maintenance Component",
      "description": "Many IT systems contain components that offer integrated remote maintenance functions (e.g., IPMI, iLO, iDRAC, Intel AMT).",
      "impact": "If an attacker gains control over an integrated remote maintenance component, they can usually take over the entire IT system with extensive privileges.",
      "action": "Harden and Isolate Remote Maintenance Interfaces",
      "mitigation": "Unused remote maintenance components should be deactivated (e.g., via BIOS/UEFI settings).",
      "check": "Is there a complete inventory of all hardware assets and their remote maintenance capabilities? Are unused remote maintenance functions verifiably deactivated?",
      "asvs": "BSI IT-Grundschutz SYS.1.1.A15 (Secure remote access)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_1_General_server_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all technical assets of the machine type 'physical' or 'virtual', as well as for 'IoT-Device' technology.",
      "riskAssessment": "The impact is directly derived from the confidentiality and integrity requirements of the asset itself, as a compromise of the management plane grants full control. The likelihood is considered higher if the asset is directly exposed to the internet.",
      "falsePositives": "This risk can be considered a false positive if the technical asset does not possess any hardware-based remote maintenance functionality (e.g., certain simple virtual machines without emulated management cards or simple IoT devices) or if the functionality has been verifiably and permanently disabled.",
      "cwe": "1189",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "78_sec1.ts",
      "bsiCode": "OPS.1.2.6",
      "id": "inadequate-time-sync-planning",
      "title": "Inadequate Planning of Time Synchronization (BSI INF.11.A1)",
      "description": "Insufficient planning can lead to IT systems failing to receive a sufficiently accurate system time.",
      "impact": "If time synchronization is not properly planned and implemented, it can lead to inconsistent or incorrect timestamps across systems.",
      "action": "Plan and Implement a Robust Time Synchronization Architecture",
      "mitigation": "Establish a clear time synchronization strategy. Designate primary, trusted time sources (e.g., dedicated internal NTP servers synchronized with a reliable external source).",
      "check": "Is there a defined time synchronization strategy? Are all systems configured to use a trusted NTP server? Is network connectivity between NTP clients and servers ensured across all network boundaries?",
      "asvs": "BSI IT-Grundschutz INF.11 Time Service, Requirement INF.11.A1 Planning of time supply",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_11_Time_service_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks for technical assets that are typically time-sensitive based on their technology type (e.g., databases, application servers, schedulers, identity providers).",
      "riskAssessment": "The likelihood is considered 'Likely' as time synchronization is a frequently overlooked aspect of infrastructure planning.",
      "falsePositives": "This risk may be a false positive if a robust time synchronization mechanism exists (e.g., provided by the underlying cloud platform or virtualization host) but is not explicitly modeled with a `@TimeSource` tag.",
      "cwe": "778",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "78_sec2.ts",
      "bsiCode": "OPS.1.2.6",
      "id": "ntp-failure-or-misinformation",
      "title": "NTP Server Failure or Misinformation (BSI SYS.1.6)",
      "description": "NTP servers can fail, become unreachable, or transmit incorrect time information. If an IT system cannot synchronize its clock correctly, its internal time can become inaccurate. This can lead to incorrect timestamps in applications and log data. Furthermore, incorrect time information can cause certificate-based services or services that use one-time passwords (TOTP) to fail, preventing users from authenticating.",
      "impact": "Inaccurate system time can lead to the failure of critical security services like authentication and encrypted communication (TLS), causing a Denial of Service. It also compromises the integrity of log data, which hinders forensic analysis and enables repudiation of actions. This can lead to operational disruptions, security breaches, and non-compliance with auditing requirements.",
      "action": "Ensure Redundant and Secure Time Synchronization",
      "mitigation": "Configure systems to use multiple, independent, and trusted NTP sources for redundancy. Whenever possible, use authenticated NTP (e.g., NTS) to prevent spoofing of time information. Monitor the availability and accuracy of the time service. If the NTP server is within the organization's control, it should be hardened and protected against unauthorized access.",
      "check": "Are systems configured with at least two independent NTP sources? Is the time service monitored? Is authenticated NTP used where supported and applicable? Are the configured NTP servers known to be reliable?",
      "asvs": "BSI IT-Grundschutz: SYS.1.6 Time Service, Requirement A5 (Synchronization of system time)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_Time_service_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified for any technical asset that has a communication link to another asset tagged as an 'ntp-server'. The risk is elevated if the asset relies on only a single NTP source, as this creates a single point of failure for time synchronization.",
      "riskAssessment": "The likelihood of an incident is higher for systems relying on a single NTP source ('Frequent'). The impact is determined by the availability and integrity requirements of the client system. Systems requiring accurate time for security functions (like certificate validation or TOTP) or for reliable transaction logging face a higher impact.",
      "falsePositives": "The model does not reflect the inherent reliability of the configured NTP sources. A system might use a single but highly reliable clustered NTP source, which is not distinguishable from a simple single server. Also, time synchronization might be handled by the underlying infrastructure (e.g., hypervisor) and might not be explicitly modeled.",
      "cwe": "295",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "78_sec3.ts",
      "bsiCode": "OPS.1.2.6",
      "id": "conflicting-ntp-servers-net.3.2",
      "title": "Conflicting Time Information from Multiple NTP Sources (BSI NET.3.2)",
      "description": "If an IT system uses multiple NTP servers to adjust its system clock, the time information from different NTP servers can vary.",
      "impact": "Incorrect system time can compromise authentication protocols (e.g., Kerberos), invalidate certificate checks, and corrupt logs and transaction records with false timestamps.",
      "action": "Establish a Hierarchical and Reliable Time Synchronization Strategy",
      "mitigation": "Configure a hierarchical time synchronization setup using a limited set of trusted, primary NTP sources. Other systems should synchronize with these internal primary sources.",
      "check": "Review the NTP configuration of the technical asset. Is it configured to use multiple, potentially conflicting, external NTP sources?",
      "asvs": "V14.4.1: Verify that all components have a common time source and that all logs have synchronized timestamps.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_NTP_time_service_edition_2023.pdf?__blob=publicationFile (BSI NET.3.2)",
      "detectionLogic": "This risk is raised for technical assets that are manually tagged with `@ntp-sources: >1`.",
      "riskAssessment": "The likelihood is considered 'Likely' if the tagged condition exists.",
      "falsePositives": "The system might have a sophisticated algorithm for selecting the best time source that is not reflected in the model, thereby handling potential conflicts gracefully.",
      "cwe": "829",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "78_sec4.ts",
      "bsiCode": "OPS.1.2.6",
      "id": "manipulation-of-time-information-ntp",
      "title": "Manipulation of Time Information (BSI Threat)",
      "description": "The Network Time Protocol (NTP) is susceptible to various attacks. An attacker could manipulate time information during transmission or redirect NTP requests to a malicious server. This could allow an attacker to manipulate the system time of NTP clients.",
      "impact": "Successful manipulation of system time can undermine time-based security controls. For example, an attacker could abuse expired time-limited access rights, bypass certificate validity checks, or falsify log entries, which complicates forensic analysis. This can compromise the confidentiality, integrity, and availability of the system and its data.",
      "action": "Implement Secure Time Synchronization",
      "mitigation": "Configure all systems to use a secure time synchronization mechanism. This can be achieved by using authenticated NTP (e.g., with symmetric keys) or a more secure protocol like Network Time Security (NTS). Ensure that configured time sources are trusted. For assets where this has been verified, apply the `@SecureTimeSync` tag to prevent this risk from being raised.",
      "check": "Are all systems configured to use authenticated NTP or NTS? Are the time sources trusted? Is the time synchronization traffic protected against manipulation, especially when crossing network boundaries?",
      "asvs": "V14.2.3: Verify that all components are configured to use a common, trusted, and reliable time source.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for sensitive server-side technical assets that are not explicitly tagged as using a secure time synchronization mechanism (`@SecureTimeSync`). The assumption is that these assets rely on a time source (like NTP) and are vulnerable if the protocol is not secured, especially when processing or storing sensitive information where time accuracy is critical for security controls.",
      "riskAssessment": "The likelihood of exploitation increases if the asset is internet-facing or communicates across untrusted network boundaries. The impact is determined by the CIA requirements of the asset and the data it handles. Manipulation of time on a system handling 'Strictly Confidential' data or performing 'Mission-Critical' functions has a very high impact.",
      "falsePositives": "This risk might be a false positive if time synchronization is secured by other means not visible in the model (e.g., network-level IPsec) or if the asset operates in a highly isolated environment where manipulation of NTP traffic is infeasible.",
      "cwe": "290",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "79_sec1.ts",
      "bsiCode": "OPS.2.2",
      "id": "lacking-cloud-strategy-ops.2.2.a1",
      "title": "Lacking or Inadequate Cloud Usage Strategy (BSI OPS.2.2.A1)",
      "description": "Using cloud services is a strategic decision for an institution. Without a clear and comprehensive strategy, there is a risk of selecting unsuitable cloud services or providers. The chosen services might be incompatible with the existing IT environment, internal business processes, or the required protection level for the data involved.",
      "impact": "An inadequate cloud strategy can lead to organizational, technical, and financial consequences. It may hinder business processes, prevent achievement of strategic goals, and significantly reduce overall security, potentially causing compliance violations, data breaches, and service disruptions.",
      "action": "Develop and document a comprehensive cloud strategy",
      "mitigation": "Define a formal strategy for cloud usage before adopting cloud services. This strategy should address provider selection criteria, data governance, security requirements (based on protection needs), integration with existing systems, exit strategies, and compliance obligations. Ensure the strategy is communicated to and understood by all relevant stakeholders, including architecture, development, and operations teams. The existence of such a strategy can be documented in the model by tagging the corresponding trust boundary with `@CloudStrategy:Defined`.",
      "check": "Is there a documented cloud usage strategy? Does it cover security, compliance, data classification, and provider vetting? Are the cloud services in use aligned with this strategy?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.2.2 Cloud-Nutzung, Requirement OPS.2.2.A1 (Creation of a strategy for cloud usage).",
      "cheatSheet": "https://www.bsi.bund.de",
      "detectionLogic": "This organizational risk is raised for each top-level cloud-based trust boundary found in the model (for example, types like 'network-cloud-provider' or 'network-cloud-security-group'). The presence of cloud services without a documented and validated strategy (indicated by the absence of the `@CloudStrategy:Defined` tag) is a potential architectural weakness.",
      "riskAssessment": "The likelihood is considered 'likely' if cloud services are used without explicit confirmation of a strategy via model tagging. The impact is determined by the highest sensitivity (CIA rating) of any technical asset located within the cloud trust boundary. Storing 'Mission-Critical' or 'Strictly-Confidential' assets in the cloud without a clear strategy results in a higher impact.",
      "falsePositives": "A risk might be flagged even if a robust cloud strategy exists but is not represented in the model. This risk can be considered a false positive or mitigated by applying the tag `@CloudStrategy:Defined` to the cloud trust boundary to indicate that a strategic review has been performed.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "79_sec2.ts",
      "bsiCode": "OPS.2.2",
      "id": "cloud-provider-dependency-ops-2-2",
      "title": "Dependency on External Cloud Provider (BSI OPS.2.2)",
      "description": "When an institution uses external cloud services, it becomes dependent on the cloud service provider.",
      "impact": "A failure or malicious act by the cloud provider can directly compromise the confidentiality, integrity, and availability (CIA) of the institution's data and services.",
      "action": "Manage Cloud Provider Dependency and Ensure Sufficient Oversight",
      "mitigation": "Implement a robust governance framework for cloud usage. This includes thorough vetting of providers (e.g., checking certifications like ISO 27001, C5),",
      "check": "Is there a formal vetting process for cloud providers? Are strong SLAs for security and availability contractually defined?",
      "asvs": "BSI IT-Grundschutz Baustein OPS.2.2 (Cloud-Nutzung)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_General_operation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI OPS.2.2)",
      "detectionLogic": "Detects technical assets operating within a cloud-based trust boundary (e.g., 'network-cloud-provider', 'network-cloud-security-group').",
      "riskAssessment": "The likelihood of being dependent is constant once a cloud service is used; therefore, it is rated 'Likely'.",
      "falsePositives": "This risk may be a false positive or significantly reduced if the asset in the cloud is non-critical and the organization has implemented",
      "cwe": "1277",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "79_sec3.ts",
      "bsiCode": "OPS.2.2",
      "id": "lacking-requirements-management-for-cloud-usage-ops115",
      "title": "Lacking Requirements Management for Cloud Usage (BSI OPS.2.2)",
      "description": "When an institution decides to use a cloud service, many expectations are usually attached. For example, employees hope for higher performance or a broader range of functions from the outsourced services, while management expects lower costs. However, a lack of requirements management before using the cloud can lead to these expectations not being met and the service not delivering the desired added value, for example in terms of availability, security, or compliance.",
      "impact": "If the selected cloud service does not meet the actual business, technical, and security requirements, it can lead to operational disruptions, failure to meet business objectives, unexpected costs, and a negative impact on the availability, performance, or security of dependent systems. This risk materializes as a failure to realize expected benefits and can cause potential financial loss or compliance violations.",
      "action": "Establish a Formal Cloud Adoption and Requirements Management Process",
      "mitigation": "Define and document clear business, technical, security, and compliance requirements before selecting and integrating a cloud service. Evaluate potential cloud providers and services against these defined requirements. The process should include a cost-benefit analysis, a risk assessment of the provider, and a review of the provider's service level agreements (SLAs). Document the decision and ensure all stakeholders (business, technical, security, legal) are involved. Use the 'cloud-requirements-defined' tag on assets where this process has been completed.",
      "check": "Is there a documented process for cloud service evaluation? Were specific availability, performance, and security requirements defined before adoption? Was a cost-benefit analysis performed and reviewed? Are SLAs from the cloud provider understood and accepted?",
      "asvs": "V1.1.4: Ensure that security requirements are defined and implemented for all application components, including those related to cloud services.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Cloud_usage_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This organizational risk is raised for any technical asset identified as being part of a cloud environment (i.e., located within a cloud-provider trust boundary or of a serverless machine type). The risk can be mitigated on a per-asset basis by applying the 'cloud-requirements-defined' tag, which signifies that a formal requirements and evaluation process was followed for that specific service.",
      "riskAssessment": "The impact is derived directly from the availability requirement of the technical asset using the cloud service. A service with 'mission-critical' availability that fails to meet its non-functional requirements will have a 'very-high' impact. The likelihood is considered 'likely' by default, as omitting a formal requirements process for cloud services is a common anti-pattern.",
      "falsePositives": "This risk may be a false positive if a thorough, albeit undocumented or untagged, requirements management process was indeed followed. The risk serves as a prompt to verify and document this process.",
      "cwe": "1035",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "79_sec4.ts",
      "bsiCode": "OPS.2.2",
      "id": "unclear-legal-framework-for-cloud",
      "title": "Unclear Legal Framework for International Cloud Providers (BSI-style)",
      "description": "Many providers offer their cloud services in an international environment, making them subject to different national legal systems.",
      "impact": "Using international cloud services without a clear understanding of the legal framework can lead to non-compliance with data protection laws (like @DataType:PII),",
      "action": "Perform Legal and Contractual Due Diligence for Cloud Services",
      "mitigation": "Thoroughly review the legal and data protection frameworks applicable to the cloud provider.",
      "check": "Has the cloud provider's contract been reviewed by legal experts? Is the data residency location contractually guaranteed?",
      "asvs": "BSI IT-Grundschutz OPS.2.2 Cloud-Nutzung (Cloud Usage), specifically Requirement OPS.2.2.A1 (Strategy for cloud usage) and OPS.2.2.A9 (Contract design with cloud providers).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_2_2_Cloud_usage_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any technical asset located within a cloud-based trust boundary (e.g., 'Network Cloud Provider').",
      "riskAssessment": "The likelihood is considered 'Likely' because major cloud providers are subject to international laws that may conflict with local regulations.",
      "falsePositives": "This risk might be a false positive if the modeled 'Cloud Provider' is a national or sovereign cloud not subject to foreign jurisdictions,",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "79_sec5.ts",
      "bsiCode": "OPS.2.2",
      "id": "insufficient-tenant-isolation-in-cloud-environment",
      "title": "Insufficient Tenant Isolation in Cloud Environment",
      "description": "In cloud computing, multiple tenants often share a common infrastructure, including IT systems, networks, and applications.",
      "impact": "A breach in tenant isolation can lead to severe data breaches, compromising the Confidentiality, Integrity, and Availability (CIA) of the affected tenant's data and services.",
      "action": "Ensure Strong Tenant Isolation and Segmentation",
      "mitigation": "Implement and verify strong logical and physical isolation controls between tenants. Use dedicated resources (e.g., VPCs, dedicated hosts) for highly sensitive workloads.",
      "check": "Is the technical asset configured for multi-tenancy? Are the isolation mechanisms provided by the cloud platform or application framework configured according to security best practices?",
      "asvs": "V14.2.5: Verify that cloud or containerization solutions are configured to ensure strong isolation between tenants or containers, preventing data leakage or unauthorized access.",
      "cheatSheet": "https://owasp.org/www-project-cloud-native-application-security-top-10/descriptions/cnapp-1-insecure-cloud-service-configuration",
      "detectionLogic": "The risk is triggered for any in-scope technical asset marked as `multi-tenant: true`. The severity of the risk is calculated based on the sensitivity (CIA ratings) of the asset itself and the data assets it processes or stores.",
      "riskAssessment": "The likelihood is higher for custom-developed multi-tenant platforms versus mature PaaS/SaaS offerings from major cloud providers. The impact is directly proportional to the highest confidentiality, integrity, and availability requirements of the data processed or stored by the multi-tenant asset. A multi-tenant database storing 'Strictly Confidential' data for multiple clients represents a 'Very High' impact if isolation fails.",
      "falsePositives": "This risk might be considered a false positive or of lower severity if the asset is a well-established and hardened SaaS/PaaS offering from a reputable provider where tenant isolation is a core, audited feature. However, even in these cases, misconfiguration by the consumer of the service can weaken isolation, so the risk often remains relevant.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "79_sec6.ts",
      "bsiCode": "OPS.2.2",
      "id": "inadequate-cloud-provider-contracts-con2",
      "title": "Inadequate Contractual Agreements with Cloud Service Providers (BSI OPS.2.2)",
      "description": "Inadequate contractual agreements with cloud service providers can lead to significant and severe security issues.",
      "impact": "This can lead to unimplemented or weak security controls, unclarified responsibilities in case of incidents, and risks from undisclosed sub-processors,",
      "action": "Review and Enhance Cloud Service Provider Contracts",
      "mitigation": "Ensure that contracts with cloud service providers clearly define all security requirements, responsibilities (including for sub-processors),",
      "check": "Are there formal, legally-reviewed contracts for all cloud services? Do these contracts explicitly state security responsibilities,",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.2.2 (Cloud Usage)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_2_Cloud_service_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organizational risk is triggered for any technical assets that are identified as being part of an external or cloud-based service offering.",
      "riskAssessment": "The likelihood is considered higher for services handling critical data or that are internet-facing, as the complexity of contractual requirements increases.",
      "falsePositives": "This risk can be considered a false positive if the organization has robust, well-defined contracts and supplier management processes in place for the identified cloud service.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "7_sec1.ts",
      "bsiCode": "APP.3.1",
      "id": "insufficient-logging-of-web-components",
      "title": "Insufficient Logging of Web Components (BSI APP.3.1)",
      "description": "If security-relevant events from a web application or web service are insufficiently logged,",
      "impact": "Without adequate logs, organizations cannot effectively detect, investigate, or respond to security incidents.",
      "action": "Implement Comprehensive Logging for Web Components",
      "mitigation": "Ensure that all security-relevant events are logged for web applications and web services. This includes, but is not limited to:",
      "check": "Are security events like logins, configuration changes, and errors logged? Are the logs protected from unauthorized access or modification?",
      "asvs": "BSI IT-Grundschutz APP.3.1 Webanwendungen und Webservices",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_1_Webanwendungen_und_Webservices_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all in-scope technical assets identified as web applications, web servers, or web services.",
      "riskAssessment": "The likelihood of this vulnerability is considered high for custom-developed parts, as security logging is frequently incomplete.",
      "falsePositives": "A technical asset might not perform logging itself but could forward all relevant information to a central logging component or SIEM.",
      "cwe": "778",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "7_sec2.ts",
      "bsiCode": "APP.3.1",
      "id": "information-leakage-about-backend-systems",
      "title": "Information Leakage about Backend Systems via HTTP Headers or Error Messages",
      "description": "Websites and data generated and delivered by a web application or web service can contain information about the underlying backend systems, such as details about databases, server types, or framework version numbers (e.g., in `Server` or `X-Powered-By` HTTP headers, or in verbose error messages). This information makes it significantly easier for attackers to launch targeted attacks by looking up known vulnerabilities for the identified technologies.",
      "impact": "The disclosure of technical details about the backend infrastructure (like server types, framework versions, or internal error details) provides attackers with a clear roadmap for finding known vulnerabilities and tailoring their exploits. This significantly lowers the effort required for a successful attack, increasing the likelihood of a compromise.",
      "action": "Harden Web Server and Application Configuration to Suppress Banners and Errors",
      "mitigation": "Configure web servers, application servers, and frameworks to suppress detailed version banners and other sensitive technical information in HTTP response headers (e.g., `Server`, `X-Powered-By`, `X-AspNet-Version`). Implement custom, generic error pages that do not leak internal stack traces, database errors, or other implementation details. Regularly scan the application to detect information leakage points.",
      "check": "Are HTTP response headers and error pages reviewed to ensure they do not leak backend technology details? Are server configurations set to hide version banners and other fingerprints? Are custom error pages used for all types of server-side exceptions?",
      "asvs": "V14.1.2: Verify that the application does not reveal sensitive information in HTTP response headers, such as detailed version information of the web or application server, or frameworks used.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any in-scope technical assets identified as a web server, web application, application server, or web service (typically REST-based). These types of assets are prone to leaking information through HTTP headers or error pages if not properly hardened.",
      "riskAssessment": "The likelihood is considered 'likely' for any unhardened web technology. The impact is directly related to the sensitivity of the asset and the data it processes or stores. An information leak on a system handling 'Strictly Confidential' data poses a 'High' impact because it directly aids attackers in compromising a high-value target.",
      "falsePositives": "The risk can be considered a false positive if the asset has already been properly hardened to suppress all unnecessary technical information in both HTTP headers and error messages. This requires manual verification of the asset's live configuration and behavior under error conditions.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "7_sec3.ts",
      "bsiCode": "APP.3.1",
      "id": "automated-threats-bsi-app3.1",
      "title": "Automated Threats (e.g., Brute Force, Enumeration, DoS)",
      "description": "When functions of a web application or web service are automated, numerous operations can be executed in a short time.",
      "impact": "Insufficient protection against automated attacks can lead to credential compromise through brute forcing, sensitive information disclosure via account enumeration, and degradation or complete loss of service availability (DoS). This can result in unauthorized access, data breaches, and disruption of business operations.",
      "action": "Implement Protection Against Unauthorized Automated Use",
      "mitigation": "Implement robust protection mechanisms against automated, high-frequency requests. Key controls include:",
      "check": "Are sensitive endpoints like login and registration protected by rate limiting? Is there an account lockout policy for failed authentication attempts? Are CAPTCHAs or similar bot-detection mechanisms in place? Is there monitoring for unusual request volumes?",
      "asvs": "BSI IT-Grundschutz APP.3.1.A7 (Protection against unauthorized automated use), OWASP Top 10 2021: A07 – Identification and Authentication Failures, OWASP Automated Threat Handbook (OAT-007 Credential Cracking, OAT-012 Account Enumeration, OAT-018 Denial of Service)",
      "cheatSheet": "https://www.bsi.bund.de/EN/Topics/ITGrundschutz/itgrundschutz_node.html",
      "detectionLogic": "This risk is raised for internet-facing or critical internal web applications, web services, and identity providers that are not explicitly marked as having protection against automated attacks (e.g., via the 'mitigation:automated-threat-protection' tag).",
      "riskAssessment": "The likelihood is significantly increased for assets exposed to the internet, especially identity providers. The impact is determined by the Confidentiality, Integrity, and Availability (CIA) requirements of the asset and the data it processes. An attack on an identity provider or a system handling strictly confidential data will have a very high impact.",
      "falsePositives": "This risk might be a false positive if protection mechanisms are in place but not documented in the model via the specified tag. Verification requires checking the application's configuration, source code, or the presence of external protection like a WAF.",
      "cwe": "307",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "7_sec4.ts",
      "bsiCode": "APP.3.1",
      "id": "weak-authentication",
      "title": "Weak or Missing Authentication for Web Application / Web Service",
      "description": "Often, special functions of a web application or web service should be reserved for specific groups of users.",
      "impact": "Bypassing authentication can lead to unauthorized access to data and functionality, resulting in data breaches, financial loss, and reputational damage.",
      "action": "Implement Strong Authentication and Session Management",
      "mitigation": "Enforce strong authentication for all sensitive endpoints of web applications and web services.",
      "check": "Is authentication enforced on all communication links to web applications and web services that are not explicitly public?",
      "asvs": "V2 Authentication Verification Requirements, V3 Identification and Authentication Failures",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for web applications and web services that have incoming communication links with weak or no authentication.",
      "riskAssessment": "The likelihood of exploitation is high if no authentication is present on an internet-facing or cross-boundary link.",
      "falsePositives": "Endpoints that are designed to be public (e.g., a login page itself, public data feeds) might be flagged.",
      "cwe": "287",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "80_sec1.ts",
      "bsiCode": "OPS.2.3",
      "id": "inadequate-outsourcing-security-strategy-con6",
      "title": "Inadequate Outsourcing Security Strategy (BSI OPS.2.3)",
      "description": "An inadequate strategy leads to information security not being properly considered in outsourcing projects.",
      "impact": "This can impair or cause business processes to fail and can lead to sensitive information leaking to unauthorized third parties,",
      "action": "Develop and Enforce a Comprehensive Outsourcing Security Strategy",
      "mitigation": "Establish and enforce a comprehensive security strategy for all outsourcing engagements. This strategy should include:",
      "check": "Is there a documented strategy for managing security in outsourcing? Are security requirements part of contracts with providers? Is the provider's compliance with security requirements monitored and regularly reviewed?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.2.3 (Nutzung von Outsourcing)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/CON_6_Management_of_external_IT_services_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any communication link from an in-scope asset to a technical asset of type 'external-entity'.",
      "riskAssessment": "The likelihood is considered 'likely' by default, assuming no formal strategy is in place if not explicitly modeled. The impact is calculated based on the highest Confidentiality, Integrity, and Availability ratings of the data assets being transferred to the external entity. Transfer of highly sensitive or critical data results in a higher impact.",
      "falsePositives": "The model might not capture the existence of a robust, real-world outsourcing governance process. If a proper strategy is in place for a specific outsourced service, this risk can be considered a false positive for that context.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "80_sec10.ts",
      "bsiCode": "OPS.2.3",
      "id": "improper-outsourcing-termination-process",
      "title": "Improper Outsourcing Termination Process (BSI DER.1.A15)",
      "description": "Inadequate or missing regulations for the termination of an outsourcing relationship can lead to hardware, data, and access rights not being properly transferred back to the commissioning entity. This can result in loss of data, continued unauthorized access by the former outsourcing partner, and disruption of business operations.",
      "impact": "Failure to properly manage the termination process can severely impact Confidentiality (if the outsourcer retains data/access), Integrity (if data is returned incomplete or corrupted), and Availability (if the business loses access to critical data or services required for its operations).",
      "action": "Define and Implement a Formal Offboarding Process for Outsourcing Partners",
      "mitigation": "Establish clear, contractual regulations for the termination of the outsourcing relationship. This must include procedures for the secure, certified deletion of data on the outsourcer's systems, the complete transfer of all business data back in a usable format, the immediate revocation of all access credentials and network connections, and the return or certified disposal of any physical hardware. Conduct a final audit to confirm all offboarding steps have been successfully completed.",
      "check": "Is there a documented and contractually agreed-upon offboarding plan for every outsourcing relationship? Does the plan cover data return, data deletion, access revocation, and hardware transfer? Are there procedures to verify the completion of the offboarding process?",
      "asvs": "BSI IT-Grundschutz DER.1.A15 (Regulations for contract termination)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Outsourcing_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any 'external-entity' technical asset marked with the '@Outsourcer' tag that does not also have a mitigating '@Offboarding-Plan-Exists' tag. The risk's severity is determined by the sensitivity of the data exchanged with the outsourcer.",
      "riskAssessment": "The impact is directly dependent on the highest Confidentiality, Integrity, and Availability ratings of all data assets exchanged with the outsourcing partner. If mission-critical systems or strictly confidential data are involved, the impact is considered very high. The likelihood is considered 'likely' by default if no explicit offboarding plan is documented for the relationship.",
      "falsePositives": "This risk is flagged based on the model's tags. It can be considered a false positive if a sufficient contractual offboarding plan exists but has not been marked in the model with the '@Offboarding-Plan-Exists' tag.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "80_sec11.ts",
      "bsiCode": "OPS.2.3",
      "id": "inadequate-emergency-management-for-outsourcing",
      "title": "Inadequate Emergency Management for Outsourced Services (BSI CON.1)",
      "description": "In the event of a disruption, emergency, or crisis, inadequate contingency management for outsourced services can lead to service failure.",
      "impact": "Failure to adequately plan for the unavailability of a critical outsourced service can lead to a significant denial of service for the dependent systems.",
      "action": "Establish and Verify Business Continuity Plans for Critical External Dependencies",
      "mitigation": "Identify all critical business processes and the technical assets they depend on, especially those involving external service providers.",
      "check": "Are critical external dependencies identified? Are there SLAs covering availability and recovery? Is there a documented and tested Business Continuity Plan for the failure of this dependency?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Contingency Management)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Contingency_Management_edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
      "detectionLogic": "This risk is raised for in-scope technical assets with 'Important', 'Critical', or 'Mission-Critical' availability requirements that have a communication link to an 'External Entity'.",
      "riskAssessment": "The impact of this risk is derived directly from the availability requirement of the technical asset that depends on the outsourced service.",
      "falsePositives": "A business continuity plan might exist at the organizational level but is not documented in the threat model via the `@BCP:Confirmed` tag. This risk should be confirmed with the system architect or operations team.",
      "cwe": "755",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "80_sec2.ts",
      "bsiCode": "OPS.2.3",
      "id": "uncontrolled-outsourcing-of-critical-processes",
      "title": "Uncontrolled Outsourcing of Critical Processes (BSI CON.1)",
      "description": "Processes that should remain within the institution due to their criticality or protection requirements are outsourced.",
      "impact": "Failure or disruption of a critical outsourced process can severely impact business continuity, leading to financial losses and reputational damage.",
      "action": "Establish a Formal Outsourcing Governance Process",
      "mitigation": "Implement a robust process for evaluating, selecting, and managing outsourcing providers.",
      "check": "Is there a formal policy governing the outsourcing of services? Are risk assessments performed before outsourcing critical processes?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Outsourcing), Requirement CON.1.A5 (Selecting suitable service providers) and CON.1.A6 (Drawing up outsourcing contracts).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_Edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
      "detectionLogic": "This risk is triggered when a technical asset explicitly marked as critical for in-house operation (`@Should-Not-Be-Outsourced` tag) has a communication link to an `External-Entity`.",
      "riskAssessment": "The impact is derived directly from the availability and integrity rating of the internal process being outsourced.",
      "falsePositives": "This risk may be a false positive if the `External-Entity` is not a typical outsourcing provider but, for example, a government regulatory body that the process must report to by law.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "80_sec3.ts",
      "bsiCode": "OPS.2.3",
      "id": "dependency-on-outsourcing-provider",
      "title": "Dependency on Outsourcing Provider",
      "description": "When an organization chooses to outsource, it becomes dependent on the outsourcing provider. This dependency can lead to a loss of internal knowledge and a loss of full control over the outsourced processes.",
      "impact": "A strong dependency on an outsourcing provider, coupled with a loss of control and insight, can lead to security vulnerabilities going undetected and unaddressed.",
      "action": "Establish clear outsourcing contracts, monitoring, and exit strategies",
      "mitigation": "Define clear, legally binding contracts with outsourcing providers that include specific security requirements (SLAs), audit rights, and data protection clauses.",
      "check": "Are there clear contracts defining security responsibilities? Are the provider's security measures regularly audited or certified?",
      "asvs": "BSI IT-Grundschutz-Kompendium: OPS.2.3 Nutzung von Outsourcing",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Outsourcing_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered by identifying internal technical assets that have communication links to assets of type 'external-entity'.",
      "riskAssessment": "The impact is determined by the criticality (integrity and availability) of the dependent internal asset and the confidentiality of the data sent to the external provider.",
      "falsePositives": "This rule might flag minor dependencies on non-critical external services (e.g., a public, non-essential API) as a risk.",
      "cwe": "829",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "80_sec4.ts",
      "bsiCode": "OPS.2.3",
      "id": "insufficient-outsourcing-security-standard-der.1",
      "title": "Insufficient Information Security Standard in Outsourcing (BSI DER.1)",
      "description": "An inadequate level of information security within the outsourcing customer's organization can lead to security being neglected in outsourcing projects.",
      "impact": "If an outsourcing provider fails to maintain adequate security, it can lead to data breaches, system compromises, and service unavailability.",
      "action": "Establish, enforce, and verify security requirements for outsourcing providers",
      "mitigation": "Define clear and robust information security requirements for all outsourcing providers. These requirements must be included in legally binding contracts.",
      "check": "Are information security requirements included in contracts with outsourcing providers? Is there a formal process for assessing the security posture of new providers?",
      "asvs": "BSI IT-Grundschutz DER.1: Supplier and service provider management; specifically DER.1.A5 (Monitoring information security for suppliers and service providers)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Supplier_and_service_provider_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk applies to all 'External-Entity' technical assets that handle sensitive data. The rule identifies external providers and raises a risk if they process or store",
      "riskAssessment": "The impact depends directly on the maximum confidentiality, integrity, and availability (CIA) requirements of the data handled by the external provider. The likelihood is 'likely' by default for any",
      "falsePositives": "This risk may be a false positive if a comprehensive supplier security management process is in place, including contractual requirements and regular audits,",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "80_sec5.ts",
      "bsiCode": "OPS.2.3",
      "id": "inadequate-outsourcing-management",
      "title": "Inadequate Outsourcing Management (based on BSI OPS.2.3)",
      "description": "When outsourcing management is non-existent or only partially implemented, the ongoing outsourced processes are managed inadequately.",
      "impact": "The inability to control and verify the security practices of an outsourcing provider can lead to compromises of Confidentiality, Integrity, and Availability (CIA) for all data assets sent to or received from the provider.",
      "action": "Establish and Maintain Outsourcing Management and Monitoring",
      "mitigation": "Implement a comprehensive outsourcing management process. This includes defining clear security requirements in contracts (SLAs), establishing regular monitoring and auditing procedures for the provider, and maintaining clear lines of communication.",
      "check": "Are there communication links to external entities that lack evidence of a managed relationship (e.g., missing the `@Outsourcing:Managed` tag)? Are contracts with these providers reviewed for security clauses? Are audits or reviews of the provider conducted regularly?",
      "asvs": "BSI IT-Grundschutz OPS.2.3 (Nutzung von Outsourcing)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_2_Outsourcing_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any communication link that targets an `External-Entity` and is not explicitly marked as managed via the `@Outsourcing:Managed` tag.",
      "riskAssessment": "The impact is directly proportional to the highest CIA requirements of the data assets being exchanged with the external provider. An unmanaged connection to a provider handling `Strictly-Confidential` data poses a `Very High` impact.",
      "falsePositives": "A false positive can occur if an outsourcing management process exists in reality, but the corresponding communication link in the model has not been tagged with `@Outsourcing:Managed`. The model accurately reflects the lack of documented assurance.",
      "cwe": "1395",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "80_sec6.ts",
      "bsiCode": "OPS.2.3",
      "id": "inadequate-contractual-agreements-bsi-con-1-g2",
      "title": "Inadequate Contractual Agreements with Outsourcing Providers (BSI CON.1.G2)",
      "description": "Inadequate contractual agreements with outsourcing providers can create information security vulnerabilities throughout the entire outsourcing lifecycle. Contracts define the overall process and form the basis for claims by users against providers. If tasks, performance parameters, or efforts are insufficiently or ambiguously described, security measures may not be implemented due to a lack of knowledge or resources.",
      "impact": "Failure to define security requirements in outsourcing contracts can lead to non-fulfillment of regulatory requirements, failure to comply with disclosure obligations and laws, and inadequate protection of the user's processes and data. This can result in security incidents, data breaches, financial losses, and reputational damage.",
      "action": "Establish Clear, Comprehensive, and Secure Outsourcing Contracts",
      "mitigation": "Ensure that all outsourcing contracts explicitly detail information security requirements, including data protection standards, security measures, incident response protocols, audit rights, and clear liability clauses. All relevant legal and regulatory requirements must be incorporated. Use a tag like `contract:reviewed` on the relevant technical asset in the model to signify that this has been done.",
      "check": "Is there a formal process for reviewing outsourcing contracts for security requirements? Do contracts with external providers include specific clauses for data handling, security controls, incident notification, and right to audit? Are the assets representing these outsourced services tagged appropriately (e.g., `provider:external` or `out_of_scope`)?",
      "asvs": "BSI IT-Grundschutz CON.1.A5 (Requirements for outsourcing contracts)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This organizational risk is triggered for any technical asset that is marked as `out_of_scope` or tagged as `provider:external`, as these typically represent services managed by third parties. The risk assumes that without explicit confirmation, the contractual basis for security may be insufficient.",
      "riskAssessment": "The likelihood is considered 'Likely' by default for any outsourced component. The impact is determined by the maximum Confidentiality, Integrity, and Availability (CIA) ratings of the asset itself and the data it processes or stores. High or critical CIA ratings lead to a higher impact.",
      "falsePositives": "This risk is a cautionary flag. A robust contract might be in place even if not reflected in the model. The risk can be marked as a false positive or mitigated by applying the `contract:reviewed` tag to the asset after confirming contractual adequacy.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "80_sec7.ts",
      "bsiCode": "OPS.2.3",
      "id": "inappropriate-rights-for-outsourced-personnel-con1",
      "title": "Inappropriate Access Rights for Outsourced Personnel (BSI CON.1)",
      "description": "When outsourcing, it is often necessary for the provider's employees to have access rights to the customer's IT systems, information, or premises.",
      "impact": "Failure to properly manage access rights for external personnel can lead to severe security incidents, including data breaches (Confidentiality), unauthorized data modification (Integrity), and service disruption (Availability). This can result in significant financial loss, reputational damage, and violation of legal or contractual obligations.",
      "action": "Implement and Enforce Least Privilege for Outsourced Access",
      "mitigation": "Enforce the principle of least privilege for all access granted to external personnel. Use strong, individual authentication methods (e.g., client certificates, multi-factor authentication) instead of shared credentials.",
      "check": "Are all access rights for external personnel documented? Is there a regular access review and recertification process? Is the principle of least privilege technically enforced? Is strong, non-shared authentication used for all external access?",
      "asvs": "BSI IT-Grundschutz-Kompendium: CON.1 Outsourcing (especially requirement CON.1.A15: Control of access options and rights)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule identifies communication links originating from technical assets representing an outsourcing provider (tagged with `@Role:ExternalServiceProvider`) that connect to in-scope assets.",
      "riskAssessment": "The likelihood of exploitation is high if authentication or authorization is missing. The impact is determined by the confidentiality, integrity, and availability requirements of the target asset.",
      "falsePositives": "A risk might be flagged for a legitimate, highly-controlled administrative access scenario where compensating controls (e.g., contractual agreements, continuous auditing, session recording) are not visible in the model.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "80_sec8.ts",
      "bsiCode": "OPS.2.3",
      "id": "lack-of-control-over-subcontractors",
      "title": "Lack of Control Over Subcontractors (BSI DER.1.A8)",
      "description": "Outsourcing providers may delegate parts of their services to subcontractors. This increases the complexity of the outsourcing process and reduces transparency for the customer.",
      "impact": "If security requirements are not passed down and enforced with subcontractors, it can lead to unmitigated vulnerabilities in the service chain.",
      "action": "Establish and Enforce Security Requirements for Subcontractors",
      "mitigation": "Contractually require the outsourcing provider to disclose the use of any sub-contractors.",
      "check": "Do contracts with service providers include clauses about sub-contractor management? Are we aware of all sub-contractors handling our data?",
      "asvs": "BSI IT-Grundschutz DER.1: General Service Provider Management (Requirement DER.1.A8: Managing sub-contractors)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_General_service_provider_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any 'External-Entity' technical asset tagged as an 'external-provider'.",
      "riskAssessment": "The likelihood of this risk is considered 'Likely' by default for any outsourced relationship where subcontractor controls are not explicitly verified.",
      "falsePositives": "A provider might have excellent and transparent subcontractor management in place. This cannot be determined from the threat model alone and requires reviewing contracts and audit reports.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "80_sec9.ts",
      "bsiCode": "OPS.2.3",
      "id": "insufficient-outsourcing-control-der1.a6",
      "title": "Insufficient Control and Monitoring of Outsourcing Providers (BSI DER.1.A6)",
      "description": "If an institution lacks adequate instruments, such as key performance indicators (KPIs) and audit rights, to monitor and control its outsourcing providers, it cannot effectively verify that the outsourced processes are implemented correctly and securely. This lack of control and steering mechanisms prevents the institution from ensuring that contractually agreed security requirements are met by the provider.",
      "impact": "The inability to detect and respond to poor performance or security deficiencies from an outsourcing provider can lead to a gradual degradation of security. This may result in confidentiality breaches, integrity loss, or availability issues for the services and data handled by the provider, often without the institution's knowledge. This can lead to compliance violations, financial loss, and reputational damage.",
      "action": "Establish and Implement a Supplier Review and Audit Process",
      "mitigation": "Define and contractually agree upon clear, measurable Key Performance Indicators (KPIs) and Service Level Agreements (SLAs) for security. Implement a regular review process, including rights to audit, performance reports, and regular meetings with the provider. Ensure that rights to audit and access to necessary information for verification are part of the contract. The results of these reviews must be documented, and any identified deficiencies must be tracked until resolved.",
      "check": "Are there formal, contractually defined KPIs and SLAs for security with the outsourcing provider? Does a regular review and audit process exist? Are the results of these reviews documented? Are there defined procedures for escalating and addressing non-performance?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein DER.1 (Supplier and Service Provider Management), specifically Requirement DER.1.A6 (Reviewing the services of suppliers and service providers).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Supplier_and_service_provider_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to technical assets of type 'external-entity' that are explicitly marked with the 'outsourcing-provider' tag. The model assumes that without specific evidence of controls (which is outside the model's scope), a risk of insufficient monitoring exists for any outsourced relationship.",
      "riskAssessment": "The likelihood is considered 'likely' if a critical service is outsourced. The impact is directly related to the CIA requirements of the data assets sent to and received from the provider, as well as the overall criticality of the service it provides. High-impact data or mission-critical services being outsourced lead to a higher risk rating.",
      "falsePositives": "The model can only identify the presence of an outsourced relationship via asset type and tags. It cannot know the contractual details or the real-world review processes. A risk will be flagged based on the model, but it is a false positive if a robust, real-world supplier management and review process is in place, even if not modeled with specific tags.",
      "cwe": "221",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "81_sec1.ts",
      "bsiCode": "OPS.3.2",
      "id": "deficient-ism-at-outsourcer-bsi-orp2-a5",
      "title": "Deficient Information Security Management at Outsourcing Provider (BSI ORP.2.A5)",
      "description": "A deficient information security management system (ISMS) at an outsourcing provider can lead to the inadequate fulfillment of information security objectives (Confidentiality, Integrity, Availability).",
      "impact": "Failure to meet contractually agreed security objectives can result in data breaches, service disruptions, financial losses, reputational damage, and non-compliance with legal or regulatory requirements (e.g., personal data (PII)).",
      "action": "Implement and Enforce Supplier Security Management",
      "mitigation": "Establish a robust supplier security management process. This includes thorough due diligence before onboarding, clear contractual security requirements (SLAs),",
      "check": "Are there formal contracts with security SLAs for all outsourcing providers? Is due diligence performed? Are security controls of the provider regularly reviewed or audited? Are data processing agreements in place?",
      "asvs": "BSI IT-Grundschutz ORP.2: Supplier and Service Provider Management, specifically Requirement ORP.2.A5: Monitoring of information security in the case of suppliers and service providers.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Supplier_and_service_provider_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is automatically raised for any 'External-Entity' technical asset that communicates with in-scope assets.",
      "riskAssessment": "The impact is directly proportional to the sensitivity (CIA ratings) of the data assets exchanged with the provider.",
      "falsePositives": "This risk may be considered a false positive or can be downgraded if a very strong, well-documented, and audited supplier management process is in place for the specific provider, even if not explicitly modeled.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "81_sec2.ts",
      "bsiCode": "OPS.3.2",
      "id": "inadequate-outsourcer-contingency-planning",
      "title": "Inadequate Contingency Planning by Outsourcing Provider (BSI CON.1, CON.8)",
      "description": "When disruptions or emergencies occur at an outsourcing provider, it can lead to operational failures that also affect the outsourced processes of the customer, impacting their regular business operations.",
      "impact": "A lack of effective emergency preparedness at the provider can render disruptions and crises unmanageable for the customer institution.",
      "action": "Verify and Ensure Supplier's Business Continuity and Contingency Plans",
      "mitigation": "Establish strong contractual requirements for the outsourcing provider's business continuity and emergency preparedness. Regularly review and audit the provider's contingency plans, test results, and recovery capabilities.",
      "check": "Are there contractual agreements regarding the provider's contingency planning? Have the provider's Business Continuity Management (BCM) plans been reviewed or audited? Are RTOs and RPOs defined and contractually agreed upon? Is there a plan for what happens if the provider is unavailable for an extended period?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium Baustein CON.1 (Outsourcing) and CON.8 (Contingency management).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_Edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
      "detectionLogic": "This risk is raised for any in-scope technical asset that has a communication link to an asset of type 'external-entity'.",
      "riskAssessment": "The likelihood of an outage causing impact is higher for dependencies on single, non-redundant external providers. The impact is directly proportional to the 'availability' rating of the internal asset that depends on the provider.",
      "falsePositives": "This risk may be a false positive if the outsourcing provider has demonstrably robust and audited contingency plans that meet or exceed the customer's requirements.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "81_sec3.ts",
      "bsiCode": "OPS.3.2",
      "id": "inadequate-outsourcing-contracts-der1.a5",
      "title": "Inadequate Outsourcing Contracts (BSI DER.1.A5)",
      "description": "Inadequacies in the contractual design for outsourced services can lead to insufficient information security for the outsourced processes.",
      "impact": "If security requirements are not contractually defined and enforced with an external service provider, it can lead to the compromise of confidentiality, integrity, or availability",
      "action": "Define, Enforce, and Verify Security Requirements in All Outsourcing Contracts",
      "mitigation": "Ensure that all contracts with external service providers include clear, comprehensive, and enforceable information security requirements.",
      "check": "Are all contracts with external service providers reviewed for security requirements? Do they include clauses covering data protection, incident handling, and audit rights?",
      "asvs": "BSI IT-Grundschutz Baustein DER.1: Outsourcing to external service providers, Requirement DER.1.A5: Defining and reviewing security requirements in contracts.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Outsourcing_to_external_service_providers_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is automatically raised for any technical asset of type `external-entity` that is in-scope and does not have the `contract:security-clauses-verified` tag.",
      "riskAssessment": "The impact of this risk is determined by the highest confidentiality, integrity, and availability requirements of the data assets exchanged with the external service provider.",
      "falsePositives": "This risk can be considered a false positive if a secure contract is in place but the corresponding asset in the model has not yet been tagged with `contract:security-clauses-verified`.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "81_sec4.ts",
      "bsiCode": "OPS.3.2",
      "id": "weak-outsourcing-interface",
      "title": "Weakness at the Outsourcing Interface (Technische/Organisatorische Schwachstellen an der Outsourcing-Schnittstelle)",
      "description": "The technical connection between outsourcing users and providers can introduce technical and organizational weaknesses at the interfaces.",
      "impact": "If technical or organizational weaknesses at an outsourcing interface are exploited, this can result in data breaches (Confidentiality), unauthorized data modification (Integrity), or service disruptions (Availability).",
      "action": "Strengthen and formalize the outsourcing interface",
      "mitigation": "Ensure all communication links to outsourcing providers are technically secured with strong encryption (e.g., VPN, TLS/HTTPS, SFTP) and robust authentication (e.g., mTLS, OAuth 2.0).",
      "check": "Is communication with the outsourcing provider encrypted? Is strong authentication enforced? Is the connection protected by a VPN or IP filtering?",
      "asvs": "OWASP Application Security Verification Standard (ASVS) V13 (Communications Security)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Third_Party_Security_Cheat_Sheet.html",
      "detectionLogic": "This rule checks for communication links to external entities designated as outsourcing providers.",
      "riskAssessment": "The impact is determined by the sensitivity (CIA ratings) of the data assets transferred over the communication link. A link carrying 'Strictly Confidential' data will have a 'Very High' impact.",
      "falsePositives": "This risk may be flagged if the model does not fully capture all compensating controls (e.g., application-layer encryption within a technically unencrypted channel).",
      "cwe": "319 // CWE-319: Cleartext Transmission of Sensitive Information",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "81_sec5.ts",
      "bsiCode": "OPS.3.2",
      "id": "critical-dependency-on-outsourcer-subcontractor",
      "title": "Critical Dependency on Outsourcer's Subcontractors",
      "description": "If an outsourcing provider delegates activities to subcontractors, there is a risk that these subcontractors may exploit their position to make demands or disregard contractual obligations. This creates a critical dependency on a third party to deliver the customer’s services. If the outsourcing provider is unable to compensate for disruption or failure by a subcontractor, the dependency becomes a hard dependency, putting the subcontractor in a favorable position. The subcontractor may then fail to maintain the contractually agreed quality and level of information security.",
      "impact": "This dependency can undermine the outsourcing relationship. For the direct customer (the modeled system), it may lead to service degradation or failure. For the outsourcing provider, it can result in legal and financial consequences, as well as reputational damage, further affecting service stability.",
      "action": "Manage and Mitigate Subcontractor Risks in Outsourcing Agreements",
      "mitigation": "Ensure that outsourcing contracts explicitly address the use of subcontractors. The agreement should grant rights to audit or assess subcontractors, or require the primary provider to enforce equivalent security standards on them. The primary provider must have a documented and tested business continuity plan to handle subcontractor failures. For critical services, consider contractual requirements for the provider to have redundant subcontractors or an in-house fallback solution. In the model, if a redundant setup exists, mark the corresponding technical asset as `redundant: true`.",
      "check": "Does the outsourcing agreement cover the use of subcontractors? Are there defined security requirements for subcontractors? Does the provider have a contingency plan for subcontractor failure? Is the provided service architected to be redundant?",
      "asvs": "BSI IT-Grundschutz: OPS.3.2 Anbieten von Outsourcing. This also relates to general supply chain security principles, such as those covered in NIST SP 800-161 (Supply Chain Risk Management) and OWASP Top 10 A06:2021 – Vulnerable and Outdated Components.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule triggers for technical assets of type 'external-entity' that are marked with the `@Outsourcing:has-subcontractors` tag but are not marked as redundant (`redundant: false`). The risk is elevated for services that handle data with high availability or integrity requirements.",
      "riskAssessment": "The likelihood of exploitation is considered 'Likely' for any non-redundant dependency on a service using subcontractors, as single points of failure in a supply chain are inherently risky. The impact is derived from the availability and integrity rating of the external service itself, as its failure would directly affect the system's core functions.",
      "falsePositives": "This risk might be a false positive if robust contractual controls, provider-side contingency plans, and subcontractor vetting processes are in place that adequately mitigate the risk of a single point of failure, even if the service is technically redundant.",
      "cwe": "1104",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "81_sec6.ts",
      "bsiCode": "OPS.3.2",
      "id": "improper-directory-service-config-for-outsourcing",
      "title": "Improper Directory Service Configuration for External Partners (BSI style)",
      "description": "An improperly or insufficiently configured central directory service—especially in scenarios involving external partners (e.g., outsourcing customers)—can result in users receiving excessive privileges. This can enable unauthorized access to sensitive or personal data belonging to the service provider or other customers, violating the principles of least privilege and tenant separation.",
      "impact": "If excessive permissions are granted or exploited, the integrity and confidentiality of data are at risk. This can lead to data breaches, contractual penalties, reputational damage to the provider and their customers, and failure to meet compliance requirements.",
      "action": "Harden directory service configuration and review access rights",
      "mitigation": "Implement a robust access control model based on the principle of least privilege. External partner access should be strictly segregated, ideally in a separate directory instance, domain, or organizational unit (OU). Regularly audit and review all user permissions, especially for external accounts. Enforce strong authentication (e.g., client certificates, MFA) for all administrative and remote access to the directory service. Log and monitor all access attempts and permission changes.",
      "check": "Are external partner accounts isolated from internal and other customer accounts? Are permissions for external users strictly limited to what is necessary? Is there a regular access review process? Is access to the directory service itself properly secured and monitored?",
      "asvs": "ASVS V4: Access Control",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for central directory services (such as LDAP servers or identity providers) that are configured for multi-tenancy or explicitly tagged for external partner access. The risk is identified when such a service receives communication from an external source (across a network trust boundary), indicating it is being used as described by the BSI.",
      "riskAssessment": "The likelihood is high if a directory service is multi-tenant and accessed by external parties, as misconfigurations are common and impactful in such complex setups. The impact is directly related to the sensitivity of the data assets managed by or accessible via the directory service. A breach of a directory service managing 'Strictly Confidential' data can have a very high impact.",
      "falsePositives": "The model might flag a correctly configured and hardened multi-tenant directory service. Consider this a false positive only if a thorough review confirms that strong tenant separation, least-privilege access controls, and regular audits are effectively in place.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "81_sec7.ts",
      "bsiCode": "OPS.3.2",
      "id": "insufficient-tenant-separation-in-outsourcing",
      "title": "Insufficient Tenant Separation in Outsourcing Environments (BSI APP.6.A9)",
      "description": "Outsourcing providers typically serve multiple customers (tenants) using the same shared resources like IT systems, networks, or personnel.",
      "impact": "This constitutes a direct breach of confidentiality for the affected tenant's data. The situation is particularly problematic when tenants are competitors.",
      "action": "Implement and Enforce Strict Tenant Isolation",
      "mitigation": "Ensure strict logical and/or physical separation of tenant data and processes on all shared resources.",
      "check": "Are multi-tenant assets explicitly designed with tenant separation in mind? Are there dedicated security controls to prevent cross-tenant access? Have penetration tests been conducted to validate tenant isolation? How is provider administrative access to tenant data controlled and audited?",
      "asvs": "BSI IT-Grundschutz APP.6.A9 (Separation of Clients)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_6_Outsourcing_and_cloud_services_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset marked as `multi-tenant` that has not been explicitly tagged as `tenant-isolation-verified`.",
      "riskAssessment": "The likelihood is considered high for any multi-tenant system that processes sensitive data without explicitly defined and validated isolation controls, especially if it involves custom-developed parts.",
      "falsePositives": "The model may not capture all specific isolation controls implemented (e.g., fine-grained application-level logic).",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "81_sec8.ts",
      "bsiCode": "OPS.3.2",
      "id": "inadequate-control-of-subcontractors-bsi-der.1",
      "title": "Inadequate Control of Subcontractors (BSI DER.1)",
      "description": "Outsourcing providers may subcontract parts or all of the outsourced services to other sub-service providers.",
      "impact": "If a subcontractor fails to meet security standards, it can lead to the compromise of confidentiality, integrity, or availability of the outsourced processes and data.",
      "action": "Enhance Vendor Due Diligence and Contractual Obligations for Subcontracting",
      "mitigation": "Ensure that contracts with outsourcing providers explicitly address subcontracting. The contract should require the provider to:",
      "check": "Does the contract with the external provider explicitly cover subcontracting? Are security requirements contractually passed down to all subcontractors?",
      "asvs": "BSI IT-Grundschutz DER.1.A5 (Checking the information security of the outsourcing service provider) and DER.1.A6 (Monitoring and reviewing the outsourcing service provider's services).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Outsourcing_edition_2023.pdf?__blob=publicationFile&v=2 (BSI DER.1)",
      "detectionLogic": "This risk is triggered for any 'External Entity' technical asset tagged as an external service provider ('@Role:ExternalServiceProvider').",
      "riskAssessment": "The likelihood of this risk materializing is higher for services where multi-level subcontracting is common (e.g., large cloud platforms, specialized processing services).",
      "falsePositives": "This risk can be considered a false positive or mitigated if the contract with the vendor explicitly forbids subcontracting, or if a thorough, successful, and recent audit of the subcontractor's security posture has been performed and documented.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "81_sec9.ts",
      "bsiCode": "OPS.3.2",
      "id": "inadequate-outsourcing-termination-plan",
      "title": "Inadequate Outsourcing Termination/Offboarding Plan",
      "description": "Inadequate regulations for the end of an outsourcing relationship can lead to hardware and data not being properly returned, transferred, or deleted.",
      "impact": "If there is no secure and comprehensive offboarding plan, sensitive data may be lost, stolen, or exposed.",
      "action": "Establish a Formal Offboarding and Termination Plan",
      "mitigation": "Define and contractually agree upon a detailed offboarding and termination plan with the outsourcing provider.",
      "check": "Is there a written, contractually binding termination clause for every outsourcing relationship? Does this clause detail the procedures for data return, transfer, and deletion?",
      "asvs": "BSI IT-Grundschutz CON.8.A23 (Planning the termination of the service)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Outsourcing_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for any 'External-Entity' technical asset that processes or stores data but is not tagged as having a contractually secured offboarding plan.",
      "riskAssessment": "The impact is rated based on the highest confidentiality of the data stored or processed by the external entity, as well as the highest integrity and availability requirements.",
      "falsePositives": "A plan might exist organizationally, but the corresponding technical asset in the model has not been tagged accordingly.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "82_sec1.ts",
      "bsiCode": "ORP.1",
      "id": "inadequate-or-missing-security-regulations",
      "title": "Inadequate or Missing Security Regulations (based on BSI)",
      "description": "Missing, outdated, impractical, or incomprehensible organizational regulations can lead to significant security gaps.",
      "impact": "The absence of effective regulations for critical assets or sensitive data can result in security incidents,",
      "action": "Establish and Maintain an Information Security Management System (ISMS)",
      "mitigation": "Define, document, and regularly review clear, practical, and understandable security regulations for all critical areas of information processing.",
      "check": "Is there a documented ISMS in place? Are key security regulations (e.g., for incident response, data handling) defined, up-to-date, and accessible? Are these regulations reviewed periodically for practicality and effectiveness?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (ISMS). Establishing an Information Security Management System is the primary way to ensure regulations are created, maintained, and effective.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_ISMS_organisation_and_personnel_edition_2022.pdf?__blob=publicationFile (BSI ORP.2)",
      "detectionLogic": "This organizational risk is difficult to detect automatically. This rule raises awareness by flagging in-scope technical assets with high or critical protection requirements.",
      "riskAssessment": "The likelihood is difficult to determine from the model alone but can be assumed 'likely' for any organization without a mature ISMS.",
      "falsePositives": "This risk is raised based on asset criticality, not direct evidence of missing regulations. Its existence must be verified by reviewing the organization's policies, procedures, and ISMS documentation.",
      "cwe": "668",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "82_sec2.ts",
      "bsiCode": "ORP.1",
      "id": "non-compliance-with-regulations-bsi-orp1",
      "title": "Non-Compliance with Organisational Regulations (BSI ORP.1)",
      "description": "Experience shows that simply defining security rules is not sufficient. Clear communication to employees is essential so that all those affected can apply the requirements in day-to-day work.",
      "impact": "Non-compliance with organisational regulations can lead to serious incidents, including compromise of confidential information, loss of data integrity, and unauthorized disclosure. This may result in reputational damage, financial loss, and legal or regulatory penalties.",
      "action": "Implement, communicate, and enforce security policies",
      "mitigation": "Ensure all security regulations are clearly documented, easily accessible, and effectively communicated to all employees.",
      "check": "Is there a security awareness program in place? Are policies easily accessible to all employees? Are there technical controls to enforce critical rules?",
      "asvs": "BSI IT-Grundschutz ORP.1: Information security organisation; related items in ORP.2: Information security policies and regulations.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This organisational risk is raised for any technical asset that processes or stores data with high confidentiality or integrity requirements, or for web applications that might publish information.",
      "riskAssessment": "The likelihood is set to 'Likely' by default, as perfect adherence to all rules at all times is unrealistic in any organization.",
      "falsePositives": "This can be a false positive in an organization with a very strong and mature security culture in which policies are deeply ingrained and consistently enforced.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "82_sec3.ts",
      "bsiCode": "ORP.1",
      "id": "insufficient-operational-resources",
      "title": "Insufficient Operational Resources for Availability and Integrity (BSI CON.3)",
      "description": "If required operational resources are available in insufficient quantity, are not provided in a timely manner, or are not properly maintained, disruptions can occur.",
      "impact": "Failure to provide adequate and redundant resources can severely compromise the Integrity and Availability of data and systems.",
      "action": "Ensure redundancy and implement a robust backup and recovery strategy",
      "mitigation": "Critical technical assets should be designed and deployed in a redundant configuration (e.g., clustered, load-balanced across availability zones) to prevent single points of failure.",
      "check": "Review technical assets with high Availability or Integrity requirements. Are they marked as 'redundant' in the model?",
      "asvs": "BSI IT-Grundschutz CON.3 (Data Backup Concept) & INF.5 (Server Room)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule automatically triggers for any in-scope, non-redundant technical asset that has 'Important' or higher Availability or Integrity requirements.",
      "riskAssessment": "The impact of this risk is directly derived from the asset's specified Availability and Integrity ratings.",
      "falsePositives": "An asset might have redundancy or backup mechanisms not captured in the threat model (e.g., hardware-level RAID for a server, or a cloud provider's managed backup service that isn't modeled as a separate communication link).",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "82_sec4.ts",
      "bsiCode": "ORP.1",
      "id": "physical-access-by-external-personnel",
      "title": "Unauthorised Physical Access by External Personnel (BSI INF.6)",
      "description": "External persons (e.g., visitors, cleaning staff, or maintenance workers) might not be familiar with the institution's security policies.",
      "impact": "Successful exploitation of unsupervised physical access can directly compromise the Confidentiality (espionage, theft), Integrity (damage, unauthorised modification),",
      "action": "Implement physical access controls and supervision policies",
      "mitigation": "Enforce a strict policy for external personnel, including registration, identification (badges), and escort requirements in sensitive areas.",
      "check": "Are there formal procedures for managing visitors and external personnel? Are sensitive assets located in physically secured zones?",
      "asvs": "BSI IT-Grundschutz INF.6: Protection against unauthorised physical access. This also relates to classic BSI threats such as G 0.14 (External Staff) and G 0.15 (Visitors and external persons).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_6_Protection_against_unauthorised_physical_access_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is triggered for technical assets located in physically less secure areas, identified by 'physical-access' tags like 'public' or 'office'.",
      "riskAssessment": "The likelihood is determined by the level of physical access (e.g., a public lobby is riskier than a general office).",
      "falsePositives": "A model might flag an asset in an 'office' area as at risk, but supplementary controls (such as a locked office door or a PC case lock) might exist that are not captured in the model.",
      "cwe": "732",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "83_sec1.ts",
      "bsiCode": "ORP.2",
      "id": "personnel-unavailability-orp-4-a17",
      "title": "Personnel Unavailability (BSI ORP.4.A17)",
      "description": "The absence of key personnel (e.g., due to illness, vacation, or departure) can delay essential operational, maintenance, or security tasks.",
      "impact": "Missing necessary tasks due to personnel unavailability directly threatens the availability of dependent services and systems.",
      "action": "Establish and maintain substitution policies for key roles",
      "mitigation": "Define, document, and communicate clear substitution rules (Vertretungsregelungen) for all key personnel.",
      "check": "Are there documented substitution plans for all key roles associated with critical assets? Are these plans tested periodically?",
      "asvs": "BSI IT-Grundschutz Kompendium 2023, Baustein ORP.4: Personal, Anforderung A17: Regelung für die Vertretung bei Ausfall von Mitarbeitern.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Personal_Edition_2023.pdf?__blob=publicationFile (BSI ORP.4 - German)",
      "detectionLogic": "This risk is raised for non-redundant technical assets with high availability or integrity requirements that are associated with specific personnel roles (via `role:*` tags).",
      "riskAssessment": "The likelihood is considered likely, as substitution planning is a common organizational challenge.",
      "falsePositives": "The model cannot verify the existence or effectiveness of an organization's internal substitution policies.",
      "cwe": "1127",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "83_sec2.ts",
      "bsiCode": "ORP.2",
      "id": "incomplete-asset-inventory-inf1.a1",
      "title": "Incomplete or Outdated IT Asset Inventory (BSI INF.1.A1)",
      "description": "Without a complete, correct, and up-to-date inventory of all hardware and software components, it is impossible to manage them securely. Unmanaged or 'shadow IT' assets are not patched, monitored, or configured according to security policies. This creates significant, undiscovered security gaps that attackers can exploit.",
      "impact": "Unmanaged assets can be exploited by attackers to gain a persistent foothold in the network, bypass security controls, and access sensitive data. This can lead to data breaches, malware propagation, and disruption of critical business services. An incomplete inventory undermines the effectiveness of nearly all other technical and organizational security measures, including vulnerability management, monitoring, and incident response.",
      "action": "Establish and maintain a comprehensive asset inventory program",
      "mitigation": "Implement a robust asset management program that includes automated discovery tools to continuously scan networks for new or changed devices and software. Establish and enforce clear processes for the procurement, deployment, and decommissioning of all IT assets. The inventory should be centralized, regularly audited against physical and network reality, and integrated with other security systems such as vulnerability scanners, configuration management databases (CMDBs), and Security Information and Event Management (SIEM) systems. Suppress this warning by tagging a central asset or trust boundary with 'asset-inventory:mature'.",
      "check": "Is there a centralized, up-to-date asset inventory? Does it cover all environments (on-premises, cloud, OT, development, production)? Are automated discovery tools in place? Are there formal processes to handle the life cycle of all assets?",
      "asvs": "Derived from the BSI IT-Grundschutz-Kompendium 2023, Baustein INF.1: Allgemeine Infrastruktur-Komponenten, requirement INF.1.A1 'Bestandsaufnahme der Hardware- und Software-Komponenten' (Inventory of hardware and software components).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_infrastructure_components_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This is a foundational organizational risk concerning the completeness of the threat model itself. It is impossible for an automated tool to detect assets that are not defined in the model. Therefore, this risk is raised once for the entire system, anchored to the most critical asset, to serve as a reminder that 'shadow IT' may exist. The risk is suppressed if any component in the model is tagged with 'asset-inventory:mature', indicating that a robust external asset management process is in place.",
      "riskAssessment": "The likelihood is considered high by default in any organization without a mature, automated asset management program. The impact is determined by the highest confidentiality, integrity, and availability requirements of the assets within the model, as an unknown asset could provide a path to compromise any of them.",
      "falsePositives": "This risk describes a potential gap in the modeling process itself and is therefore difficult to classify as a false positive without external verification. The finding is valid if the organization cannot provide evidence of a comprehensive and mature asset management program that ensures the threat model accurately reflects reality.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "83_sec3.ts",
      "bsiCode": "ORP.2",
      "id": "careless-handling-of-credentials",
      "title": "Careless Handling of Credentials / Circumvention of Security Measures",
      "description": "It is often observed that, although institutions have many organizational and technical security procedures, these are undermined by careless employee behavior. A typical example is a sticky note on a monitor with access passwords written on it. Such behavior weakens established security controls and creates a direct path for unauthorized access.",
      "impact": "If credentials are handled carelessly (e.g., written down and left in plain sight or shared with others), accounts can be compromised. An attacker who obtains these credentials could impersonate the user, access sensitive data, modify critical information, or escalate privileges within the system. This directly threatens the Confidentiality, Integrity, and Availability (CIA) of associated assets and can result in significant data breaches and operational disruption.",
      "action": "Enforce secure credential-handling policies and user awareness training",
      "mitigation": "Implement and enforce clear policies that prohibit writing down or sharing passwords. Provide secure alternatives, such as approved password managers. Conduct regular, mandatory security awareness training that covers the risks of careless credential handling and social engineering attacks. Use technical controls to enforce password complexity and multi-factor authentication where appropriate.",
      "check": "Is there a written policy for credential management? Are users trained on it? Are password managers available and their use encouraged or mandated? Are technical controls (e.g., MFA, password complexity) in place for critical systems?",
      "asvs": "Based on BSI IT-Grundschutz Baustein ORP.2 (Personnel), especially Section 2.3: Careless handling of information (e.g., passwords on sticky notes).",
      "cheatSheet": "See BSI IT-Grundschutz, ORP.2 Personnel (Sorglosigkeit im Umgang mit Informationen).",
      "detectionLogic": "This organizational risk applies to any technical asset requiring user authentication. The rule triggers on assets explicitly marked as being used by a human (`used_as_client_by_human: true`), client-type technologies, or assets associated with a specific user role via `role:*` tags. The assumption is that if a human interacts with the asset, there is a risk of careless credential handling.",
      "riskAssessment": "Likelihood is high in environments without strong credential policies, training, and technical enforcement (such as MFA). The impact is proportional to the CIA rating of the technical asset and the data it processes or stores. Compromising credentials for a mission-critical database administrator is a very high impact event.",
      "falsePositives": "This risk is organizational and relies on assumptions about user behavior. A model cannot verify actual credential handling practices. Treat this risk as a prompt to verify that appropriate policies, training, and technical controls are in place.",
      "cwe": "522",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "83_sec4.ts",
      "bsiCode": "ORP.2",
      "id": "insufficiently-qualified-personnel-bsi",
      "title": "Insufficiently Qualified or Trained Personnel (BSI-based)",
      "description": "In daily IT operations, many disruptions and errors can occur. If responsible personnel are not sufficiently qualified, sensitized, and trained,",
      "impact": "Errors by insufficiently qualified personnel in configuring, operating, or developing systems can directly introduce vulnerabilities.",
      "action": "Establish and Maintain Personnel Qualification and Training Standards",
      "mitigation": "Define clear qualification and experience requirements for all roles responsible for operating, administering, and developing IT systems.",
      "check": "Are there formally defined qualification requirements for IT roles? Is there an ongoing training plan?",
      "asvs": "Based on BSI IT-Grundschutz Baustein ORP.2 (Personal), in particular ORP.2.A15 (Personnel qualification) and related organizational measures such as ORP.2.A1/A2 (onboarding/offboarding) and ORP.2.A4 (rules for external personnel), as applicable.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile (BSI ORP.2)",
      "detectionLogic": "This is an organizational risk that materializes at the technical level. The risk is raised for any in-scope technical asset that is associated with a human role (via `role:*` tags).",
      "riskAssessment": "The likelihood is considered higher for complex, custom-developed systems as they require more specialized knowledge.",
      "falsePositives": "This risk is an abstraction of an organizational issue. The model cannot know the actual qualifications of the personnel.",
      "cwe": "732",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "84_sec1.ts",
      "bsiCode": "ORP.3",
      "id": "insufficient-knowledge-of-regulations",
      "title": "Insufficient Knowledge of Information Security Regulations",
      "description": "Simply defining information security regulations does not ensure they will be followed.",
      "impact": "Non-adherence to security regulations due to insufficient knowledge can lead to the creation or exploitation of security vulnerabilities,",
      "action": "Implement and maintain security awareness and training programs",
      "mitigation": "Implement a comprehensive, ongoing security awareness and training program tailored to roles and responsibilities.",
      "check": "Is there an established, ongoing security awareness and training program? Are security regulations easy to access and communicated effectively?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information Security Organisation), requirement ORP.1.A6 (Awareness training on information security).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This is an organizational risk concerning personnel awareness. It applies conceptually to the entire system where personnel interaction occurs.",
      "riskAssessment": "The likelihood is considered 'Likely' by default, assuming a baseline need for continuous awareness efforts.",
      "falsePositives": "This risk is inherently organizational and difficult to verify solely from a technical model.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "84_sec2.ts",
      "bsiCode": "ORP.3",
      "id": "insufficient-security-awareness",
      "title": "Insufficient Security Awareness",
      "description": "Experience shows that it is not enough to simply mandate security measures. Employees must understand the meaning and purpose of these measures; otherwise, they may ignore them in day-to-day work. If employees are not adequately made aware of information security topics, the institution's security culture, objectives, and strategy can be jeopardized.",
      "impact": "If employees ignore security measures due to lack of awareness, it can lead to the introduction of new vulnerabilities or the breakdown of existing controls. This can directly compromise the confidentiality, integrity, or availability of business processes and information, potentially resulting in security incidents, data breaches, and non-compliance.",
      "action": "Establish and maintain a continuous security awareness and training program",
      "mitigation": "Implement a comprehensive, role-based security awareness and training program that is continuously reinforced. Ensure that all personnel understand the purpose and importance of the security measures relevant to their tasks. The program should be supported by management and integrated into the company culture. Regularly communicate security topics and verify understanding.",
      "check": "Is there an established, ongoing security awareness and training program? Are employees able to explain the importance of key security measures for their roles? Is there visible management support for a security-minded culture?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, ORP.3 Sensibilisierung und Schulung zur Informationssicherheit (Awareness and training on information security).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This is an organizational risk that applies to all parts of the system where human interaction occurs. This rule triggers for all in-scope technical assets that are not exclusively backend systems, as these are the components employees are most likely to interact with, directly or indirectly. A lack of awareness in these interactions can lead to security controls being bypassed.",
      "riskAssessment": "The likelihood is considered 'likely' by default, reflecting a baseline potential for human error or lack of awareness in any organization. The impact is calculated based on the sensitivity (CIA ratings) of the technical asset in question. If an employee ignores a security measure on a mission-critical system, the impact is much higher than on a system handling public data.",
      "falsePositives": "This risk is organizational in nature and cannot be fully confirmed or denied by a technical model alone. An organization might have an effective security awareness and training program in place. Treat this risk as a prompt to verify the status and effectiveness of awareness activities and the security culture.",
      "cwe": "284",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "84_sec3.ts",
      "bsiCode": "ORP.3",
      "id": "ineffective-security-awareness-program",
      "title": "Ineffective Security Awareness Program (aligned with BSI ORP.3)",
      "description": "Security awareness and training activities are not always as successful as needed.",
      "impact": "If an institution conducts inadequate awareness and training activities for its employees, aspects of information security can be endangered, which directly restricts the fulfillment of tasks.",
      "action": "Ensure Effectiveness of Security Awareness and Training Programs",
      "mitigation": "Ensure strong management support for security awareness initiatives. Define clear, measurable goals for training programs. Plan activities carefully, allocating sufficient resources (financial and personnel).",
      "check": "Is there clear evidence of management support for the security awareness program? Are the program's goals documented and measurable? Is there a formal process for monitoring the success and impact of the training? Is the program ongoing and allocated sufficient resources?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.3 (Sensibilisierung und Schulung zur Informationssicherheit), particularly requirements ORP.3.A4, ORP.3.A6, and ORP.3.A8. This risk represents the failure to effectively implement these controls.",
      "cheatSheet": "BSI IT-Grundschutz Kompendium, Baustein ORP.3 (Sensibilisierung und Schulung zur Informationssicherheit).",
      "detectionLogic": "This is an organizational risk concerning the effectiveness of training programs. It applies conceptually to the entire system where personnel interaction occurs.",
      "riskAssessment": "The likelihood is considered HIGH if there is no success monitoring for awareness programs or if it is known to be ineffective. The likelihood is MEDIUM if success monitoring is sporadic or lacks depth.",
      "falsePositives": "This risk is inherently organizational. A model cannot determine the actual quality or effectiveness of a training program.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "84_sec4.ts",
      "bsiCode": "ORP.3",
      "id": "insufficient-training-on-new-software",
      "title": "Insufficient training on new software and security features",
      "description": "Employees often do not use newly introduced security programs and features because they do not know how to operate them or consider it too time-consuming to learn.",
      "impact": "Misoperation or incorrect configuration of software due to insufficient training can neutralize intended security benefits. This can lead to unpatched vulnerabilities, bypassed security controls, and exposure of sensitive data.",
      "action": "Establish role-based training for new software and security features",
      "mitigation": "Develop and enforce a mandatory training program for all new software, especially for security-related tools and critical business applications.",
      "check": "Is there a formal process for training employees on new software and systems before access is granted?",
      "asvs": "Derived from BSI IT-Grundschutz concepts. This threat aligns with ORP.3 (Awareness and training), and supports the principles in ORP.1 (Information security organization) and ORP.2 (Personnel), which emphasize competence and awareness.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.2)",
      "detectionLogic": "This organizational risk is triggered for technical assets that are either custom-developed, act as security controls, or handle highly critical data.",
      "riskAssessment": "The likelihood of this risk is higher for custom-developed parts and dedicated security components due to their complexity and non-standard nature.",
      "falsePositives": "This risk may be a false positive if the organization has a robust and effective training program for all new software deployments, even if this is not captured in the threat model.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "84_sec5.ts",
      "bsiCode": "ORP.3",
      "id": "failure-to-recognize-and-report-incidents",
      "title": "Failure to Recognize and Report Security Incidents (BSI ORP.3)",
      "description": "In daily operations, many disruptions and errors can occur with IT and ICS components. Security incidents might not be identified as such by personnel, and cyber-attacks or attempted attacks could go unnoticed.",
      "impact": "Failure to recognize and report security incidents in a timely manner can allow small security gaps to grow into critical threats, compromising the Confidentiality, Integrity, and Availability of information.",
      "action": "Establish and maintain an awareness and training program for recognizing, reporting, and escalating suspected security incidents across all roles.",
      "mitigation": "Create clear, accessible reporting procedures and train all personnel (users, admins, leadership) to recognize potential signs of a security incident (e.g., unusual system behavior, unexpected errors, performance degradation, suspicious messages).",
      "check": "Are awareness and training measures (ORP.3) defined, current, and role-specific? Do personnel know indicators of incidents and how to report them promptly? Is there a designated point of contact and an exercised reporting path?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.3 (Sensibilisierung und Schulung zur Informationssicherheit), esp. 2.5 (Nicht erkannte Sicherheitsvorfälle) and requirements ORP.3.A1, ORP.3.A3, ORP.3.A6, ORP.3.A8, ORP.3.A9.",
      "cheatSheet": "https://www.bsi.bund.de/grundschutzkurs",
      "detectionLogic": "Organizational risk focused on awareness and processes. It conceptually applies wherever human interaction is key.",
      "riskAssessment": "Likelihood is elevated where awareness programs and reporting processes are missing or ineffective. Impact scales with the asset’s CIA needs and the sensitivity of data processed or stored.",
      "falsePositives": "This is largely organizational and cannot be proven by the technical model alone. An institution may already run an effective program.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "84_sec6.ts",
      "bsiCode": "ORP.3",
      "id": "negligence-and-human-error",
      "title": "Negligence or Human Error Leading to Information Disclosure (BSI G 0.14)",
      "description": "Various factors, such as carelessness or haste, can lead to situations where, for example, confidential documents are left openly visible at workstations or emails are sent without encryption.",
      "impact": "If sensitive information is handled carelessly, it can lead to unauthorized disclosure, modification, or loss of data. This compromises confidentiality and integrity, potentially leading to financial loss, reputational damage, and legal or regulatory penalties.",
      "action": "Implement Technical Safeguards and Enhance Security Awareness",
      "mitigation": "Combine technical controls with organizational measures. Implement a 'clean desk' policy and provide regular security awareness training focusing on secure data handling practices.",
      "check": "Are there enforced policies for a 'clean desk' and for screen locking? Is email and data-at-rest encryption mandated and technically enforced for sensitive information? Do employees receive regular, practical security awareness training?",
      "asvs": "Derived from the BSI IT-Grundschutz Catalogues, 'G 0.14 Carelessness or Lack of Knowledge'. The current BSI IT-Grundschutz Kompendium addresses this in several modules, including ORP.2 (Personnel) and DER.1.1 (General Client).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_1_General_client_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is identified on in-scope technical assets that are used by humans (e.g., workstations, mobile devices). It triggers under two conditions:",
      "riskAssessment": "The likelihood is considered 'likely' for any system with direct human interaction handling sensitive data, as human error is common. The impact directly relates to the confidentiality, integrity, and availability requirements of the data being handled. A breach of 'strictly confidential' data has a much higher impact than 'internal' data.",
      "falsePositives": "This risk can be considered a false positive if technical controls are in place that fully prevent the identified scenario (e.g., a DLP solution that blocks unencrypted emails with sensitive attachments, or mandatory full-disk encryption). Such controls must be documented and verified.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "84_sec7.ts",
      "bsiCode": "ORP.3",
      "id": "careless-handling-of-information",
      "title": "Careless Handling of Information by Employees",
      "description": "Many organizations define numerous organizational and technical security measures, but they can be undermined by careless employee behavior.",
      "impact": "Careless handling of information can render security measures ineffective, allowing unauthorized individuals to access sensitive data.",
      "action": "Enforce secure information-handling policies and awareness",
      "mitigation": "Implement and enforce clear policies for secure information handling, such as a 'Clean Desk and Clear Screen' policy.",
      "check": "Are there established policies for clean desk/screen and secure document handling? Are employees regularly trained on these policies? Are privacy screens deployed on mobile devices? Is there a secure process for disposing of sensitive physical media?",
      "asvs": "BSI IT-Grundschutz CON.1.A8 Clean Desk and Clear Screen",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_handling_of_information_and_assets_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for all technical assets that are either used directly by humans (where screens can be shoulder-surfed or credentials left visible) or are tagged as having a physical presence where information could be mishandled (like printers or paper archives).",
      "riskAssessment": "The likelihood of this risk is generally considered 'likely' due to the human factor. The impact is determined by the maximum confidentiality and integrity of the data processed or stored by the affected asset. If highly sensitive data is handled on a device used in an insecure manner, the impact can be very high.",
      "falsePositives": "This risk is raised based on the potential for careless behavior. An organization might have a strong security culture and effective training programs that mitigate this risk in practice, which cannot be determined from the technical model alone.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "84_sec8.ts",
      "bsiCode": "ORP.3",
      "id": "disregard-of-security-regulations-ism2.2",
      "title": "Disregard of Security Regulations (BSI ISM.2.2)",
      "description": "Employees might not adhere to information security requirements for various reasons, such as a weak security culture,",
      "impact": "Disregarding security regulations can lead to the bypass of security controls, compromising the Confidentiality, Integrity, and Availability (CIA) of assets.",
      "action": "Foster a Strong Security Culture and Review Security Policies for Practicality",
      "mitigation": "Management must actively promote a positive security culture and lead by example. Security policies should be practical, well-justified, and not overly burdensome to avoid rejection by employees.",
      "check": "Is there evidence of a strong, top-down security culture? Are security policies reviewed for practicality? Is there a feedback mechanism for employees regarding security controls? Are permissions allocated based on need-to-know and business justification?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information security organisation), Requirement ORP.1.A1 (Management tasks for information security), which emphasizes the importance of management commitment and fostering a security culture.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
      "detectionLogic": "This is an organizational risk related to employee behavior and security culture. It applies conceptually to the entire system.",
      "riskAssessment": "The likelihood is considered 'Likely' if there is reason to believe the security culture is weak or policies are impractical. The impact is directly related to the CIA requirements of the assets and data that could be affected by bypassed controls.",
      "falsePositives": "This is an organizational risk. Its presence cannot be confirmed from the technical model alone.",
      "cwe": "284",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "84_sec9.ts",
      "bsiCode": "ORP.3",
      "id": "social-engineering",
      "title": "Social Engineering",
      "description": "Social engineering is a method of gaining unauthorized access to information or IT systems by manipulating employees. Attackers often make direct contact via phone, email, or social networks, sometimes in multi-stage campaigns. By feigning insider knowledge (e.g., posing as a colleague, superior, or IT support) and appealing to the victim's helpfulness or urgency, attackers can trick employees into performing unauthorized actions.",
      "impact": "If employees are not sufficiently sensitized to this type of attack, they can be manipulated into disclosing internal information, infecting their IT systems with malware, or even transferring money to fraudulent accounts (e.g., 'CEO fraud'). This can lead to severe financial loss, data breaches (confidentiality), system compromise (integrity), service disruption (availability), and reputational damage.",
      "action": "Conduct regular, targeted security awareness training and implement technical controls",
      "mitigation": "Implement a robust security awareness program that specifically addresses social engineering tactics (phishing, pretexting, CEO fraud, etc.). Use simulated phishing campaigns to train and test employees. Enforce technical controls that limit the impact of a compromised user account, such as the principle of least privilege, multi-factor authentication (MFA), and strict, out-of-band validation for sensitive actions like financial transfers or password resets. Establish clear, well-known channels for employees to report suspected social engineering attempts without fear of reprisal.",
      "check": "Are employees regularly trained to identify social engineering attacks? Are technical controls like MFA enforced for all users? Is there a formal, out-of-band verification process for unusual or urgent requests? Is there a clear process for reporting suspicious activity?",
      "asvs": "ASVS V1.10.1: Security Awareness Training",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Social_Engineering_Cheat_Sheet.html",
      "detectionLogic": "This risk is generated for any technical asset that is directly used by a human (`used_as_client_by_human: true`), is a client-type technology (`browser`, `desktop`, etc.), or is tagged with a `role:*` tag. The assumption is that the human user of this asset is the primary target of social engineering.",
      "riskAssessment": "The likelihood is considered at least `Likely` due to the prevalence of social engineering attacks. It is elevated to `VeryLikely` for assets associated with high-privilege roles (e.g., `role:administrator`) or those handling highly sensitive data. The impact is derived from the CIA ratings of the technical asset and the data it processes. A successful attack against a user with access to 'Strictly Confidential' data or 'Mission Critical' systems results in a 'High' or 'VeryHigh' impact.",
      "falsePositives": "The model correctly identifies human interaction points as vulnerable. However, the actual risk level depends on the effectiveness of the organization's security awareness training and technical countermeasures, which may not be fully represented in the model. This risk should be validated against the organization's security posture.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "85_sec1.ts",
      "bsiCode": "ORP.4",
      "id": "inadequate-iam-processes",
      "title": "Inadequate Identity & Access Management (IAM) Processes",
      "description": "If Identity & Access Management (IAM) processes are poorly defined or inconsistently implemented,",
      "impact": "Weak IAM lifecycle controls enable unauthorized access, escalate blast radius after compromises, and drive regulatory non-compliance.",
      "action": "Institutionalize IAM: define, automate, and audit joiner-mover-leaver (JML) processes; enforce least privilege; and recertify access regularly.",
      "mitigation": "Establish a formal IAM lifecycle with clear ownership (joiner, mover, leaver).",
      "check": "Is there a documented, measured JML process? Are admin and service accounts inventoried and reviewed?",
      "asvs": "ASVS V4: Access Control (Identity & Session Management touchpoints)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "Detection flags technical assets where robust IAM is most critical, using three signals:",
      "riskAssessment": "Likelihood is set to Likely due to the prevalence of process gaps in JML and recertification.",
      "falsePositives": "Model-only evidence cannot prove process weakness. Organizations with mature IAM/JML may still trigger.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "85_sec2.ts",
      "bsiCode": "ORP.4",
      "id": "lack-of-centralized-account-management",
      "title": "Lack of Centralized Account Management",
      "description": "In many organizations, employees have accounts on various IT systems (e.g., production, test, and quality assurance systems)",
      "impact": "Failure to centrally manage and deprovision user accounts can lead to unauthorized access via orphaned accounts.",
      "action": "Implement Centralized Identity and Access Management (IAM)",
      "mitigation": "Establish a central identity provider (IdP) (e.g., Active Directory, LDAP, or a cloud-based IdP) as the single source of truth for user identities.",
      "check": "Is there a central identity provider in the model? Do applications that require user authentication use externalized authentication and link to the central IdP?",
      "asvs": "V4.3.2: Verify that there is a process for revoking access to all associated accounts, resources, and credentials in a timely manner when a user's access is no longer required.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Identity_and_Access_Management_Cheat_Sheet.html",
      "detectionLogic": "This risk is identified when multiple technical assets that typically require user authentication (like web applications or databases)",
      "riskAssessment": "The likelihood is considered high if multiple decentralized user stores exist, as this makes it very probable that account deprovisioning will be incomplete.",
      "falsePositives": "A system might use 'credentials' for a technical user or API key, not an end-user account.",
      "cwe": "404",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "85_sec3.ts",
      "bsiCode": "ORP.4",
      "id": "poorly-regulated-access-rights-orp4",
      "title": "Poorly Regulated Assignment of Access Rights (BSI ORP.4)",
      "description": "If the assignment of access rights is poorly regulated, it can lead to serious security vulnerabilities, for example through permission sprawl.",
      "impact": "Excessive or uncontrolled permissions can allow unauthorized users, or attackers who have compromised an account, to access, modify, or delete sensitive information,",
      "action": "Implement a Formal and Auditable Authorization Process",
      "mitigation": "Establish and enforce a formal process for managing access rights based on the principle of least privilege.",
      "check": "Is there a documented policy for access control? Are roles and responsibilities for granting access clearly defined?",
      "asvs": "Derived from the BSI IT-Grundschutz Compendium 2023, module ORP.4 Identity and Access Management; specifically requirements ORP.4.A5 (Granting of authorizations), ORP.4.A6 (Management of authorizations), and ORP.4.A15 (Regular review of access rights).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is identified when a communication link between two in-scope technical assets lacks a defined authorization mechanism (`authorization: none`).",
      "riskAssessment": "The impact is determined by the highest confidentiality and integrity of the data assets transferred over the link and the target asset itself. A link to a database storing 'Strictly Confidential' data without authorization has a very high impact.",
      "falsePositives": "A risk might be a false positive if authorization is handled by an out-of-scope component not present in the model or through an implicit mechanism not captured by the `authorization` attribute (e.g., a network firewall rule that allowlists all traffic from a trusted zone).",
      "cwe": "285",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "86_sec1.ts",
      "bsiCode": "ORP.5",
      "id": "'violation-of-legal-and-contractual-requirements'",
      "title": "Violation of Legal and Contractual Requirements (BSI ORP.5; see also ORP.2 / ORP.3)",
      "description": "If information security is implemented incorrectly or inadequately, organizations may violate legal regulations or contractual agreements. This is especially relevant when using external services, such as cloud providers, which operate in international environments with complex and different legal frameworks (e.g., for data protection, liability, or government access). A failure to perform adequate due diligence, sometimes driven by a focus on low costs, can lead to unintentional but severe compliance violations.",
      "impact": "Violating legal or contractual requirements can lead to significant financial penalties, reputational damage, and loss of customer trust. It may also result in the forced suspension of business processes or compromise the confidentiality, integrity, and availability of data assets hosted with non-compliant providers.",
      "action": "Implement a due-diligence and compliance management process for all external services",
      "mitigation": "Establish and enforce a formal process for evaluating and approving all external services, especially cloud providers. This process must include a thorough assessment of all applicable legal, regulatory, and contractual requirements. Involve legal, data protection, and information security officers in the review. Ensure that contracts include clear clauses regarding data handling, security measures, liability, jurisdiction, and audit rights. Maintain an inventory of all external services and the legal frameworks that apply to them.",
      "check": "Is there a documented process for vetting external suppliers for legal and security compliance? Are legal and data protection experts part of the approval workflow? Are cloud service contracts reviewed for specific compliance and security clauses before signing? Is there an up-to-date inventory of applicable laws and regulations?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.5 (Compliance Management – Requirements Management); see also ORP.2 (Compliance) and ORP.3 (Information security in supplier relationships).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Compliance_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any technical asset located within a trust boundary of type \"Network Cloud Provider\" or \"Network Cloud Security Group\". The use of public cloud infrastructure inherently introduces risks related to jurisdiction and cross-border data flows, which must be carefully managed to ensure compliance.",
      "riskAssessment": "Impact is determined by the sensitivity (CIA ratings) of the data processed or stored by the cloud-based asset. Likelihood increases for assets handling sensitive data, as complexity and the potential for oversight in legal due diligence are higher. A cost-only focus without adequate compliance checks, as described in the source context, is considered a plausible scenario.",
      "falsePositives": "This risk may be a false positive if the organization has already performed a thorough legal and compliance assessment for the specific cloud service and documented that all requirements are met. The risk serves as a prompt to confirm that due diligence has been completed.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "86_sec2.ts",
      "bsiCode": "ORP.5",
      "id": "improper-handling-of-information-by-employees",
      "title": "Improper Handling of Information by Employees (BSI ORP.5)",
      "description": "Due to improper behavior by employees, sensitive information can be disclosed without authorization.",
      "impact": "This can lead to serious breaches of confidentiality, compromising sensitive business data, personal information (potential GDPR violations), or trade secrets.",
      "action": "Establish clear policies and enforce separation of duties / dual control",
      "mitigation": "Define and enforce clear, practical policies for handling sensitive information in all forms (digital, verbal, written). Implement the 'four-eyes principle' (dual control) for critical administrative actions.",
      "check": "Are there clear, accessible policies for handling sensitive information? Is there a formal, enforced process for granting access to sensitive user data (such as emails)? Is the four-eyes principle applied to critical administrative tasks?",
      "asvs": "Aligned with BSI IT-Grundschutz, module ORP.5 Compliance Management (Requirements Management), e.g., ORP.5.A1 (Identification of framework conditions), ORP.5.A2 (Observance of framework conditions), and ORP.5.A8 (Regular reviews of the compliance management system).",
      "cheatSheet": "https://www.bsi.bund.de/",
      "detectionLogic": "This risk is raised when a technical asset representing a privileged role (e.g., 'role:administrator') has a communication link to a data store (such as a mail server, database, or file server) that contains highly confidential data.",
      "riskAssessment": "The likelihood is considered 'likely' because bypassing formal procedures ('auf dem kleinen Dienstweg') is a common organizational weakness.",
      "falsePositives": "The model identifies the technical capability for misuse based on access paths. It cannot verify the existence or effectiveness of external procedural controls such as a mandatory ticketing system or a formal 'four-eyes' approval process.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "86_sec3.ts",
      "bsiCode": "ORP.5",
      "id": "social-engineering-pretexting-bsi-con1",
      "title": "Social Engineering via Pretexting (BSI CON.1)",
      "description": "In personal conversations, on the phone, or via email, many employees are willing to disclose far more information than they would in writing or in a larger group. In addition, the identity of communication partners is often not questioned, as this is perceived as impolite. Likewise, authorizations are frequently not verified sufficiently but are implicitly derived from the asserted role. For example, an employee may receive an email from an alleged acquaintance of their manager requesting the quick transfer of an outstanding amount. Or a stranger in work clothes with a tool case gains access to the data center after mentioning something about 'water pipes'.",
      "impact": "An attacker could trick an employee into performing unauthorized actions, such as making fraudulent financial transfers, disclosing sensitive information (credentials, customer data), or granting unauthorized physical or logical access. This can lead to significant financial loss, data breaches, system compromise, and reputational damage.",
      "action": "Establish Strict Verification Procedures and Security Awareness Training",
      "mitigation": "Implement and enforce strict, non-bypassable verification procedures for all sensitive requests (e.g., financial transfers, password resets, access grants), requiring out-of-band confirmation (such as a phone call to a known number). Provide regular, mandatory security awareness training for all employees that focuses on recognizing social engineering tactics like pretexting, phishing, and CEO fraud. Foster a security culture in which questioning unusual or urgent requests is encouraged and rewarded, not considered impolite or obstructive.",
      "check": "Are there formal, multi-channel verification processes for sensitive requests? Does security awareness training cover pretexting, phishing, and CEO fraud? Are employees aware of and following these procedures? Are technical controls in place to flag suspicious external emails (e.g., banners)?",
      "asvs": "BSI IT-Grundschutz CON.1: Social Engineering and Phishing",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Social_Engineering_and_phishing_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This organizational risk is triggered for any in-scope technical asset that is a high-value target, because human operators are the primary attack vector. The risk is raised for assets with high confidentiality (>= 'confidential'), integrity (>= 'critical'), or availability (>= 'critical'), as these are attractive targets for attackers manipulating employees.",
      "riskAssessment": "The likelihood is considered 'very likely' by default due to the prevalence and effectiveness of social engineering. The impact is calculated based on the maximum CIA rating of the targeted technical asset and the data it processes or stores. For example, tricking an administrator of a mission-critical database has a 'very high' impact.",
      "falsePositives": "The technical model can only indicate where a social engineering attack would be damaging; it cannot assess the effectiveness of an organization's security awareness program or its internal verification procedures. Treat this risk as a starting point for a manual review of related human processes and controls.",
      "cwe": "290",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "86_sec4.ts",
      "bsiCode": "ORP.5",
      "id": "unintentional-information-disclosure",
      "title": "Unintentional Information Disclosure (per BSI description)",
      "description": "During information transfer, there is a risk that unintended additional data is disclosed along with the intended content.",
      "impact": "The disclosure of unintended or confidential information can lead to severe breaches of confidentiality, legal and regulatory violations (e.g., GDPR),",
      "action": "Implement Data Loss Prevention (DLP) measures and strict data-handling/sanitization procedures.",
      "mitigation": "Ensure all data transmissions contain only the explicitly intended information. Implement controls to prevent sending data to incorrect recipients.",
      "check": "Are there automated checks (such as DLP or content filters) on outbound data streams? Is data sanitized before being sent over communication links?",
      "asvs": "Derived from BSI IT-Grundschutz, module CON.1 (General data protection), in particular requirement CON.1.A17 (Rules for transferring information).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_data_protection_edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
      "detectionLogic": "This risk is identified on communication links that transfer sensitive data.",
      "riskAssessment": "The likelihood increases if the target is external or the communication crosses a trust boundary, especially if the source component is custom-developed.",
      "falsePositives": "False positives can occur if the model does not fully represent the data sanitization or filtering logic (e.g., use of DTOs) that happens within the source asset before transmission.",
      "cwe": "200",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "87_sec2.ts",
      "bsiCode": "SYS.1.1",
      "id": "configuration-drift-due-to-inadequate-knowledge",
      "title": "Configuration Drift from Insufficient Knowledge of OS Changes (BSI SYS.1.1)",
      "description": "New versions of server operating systems regularly introduce new features and modify existing ones, including parameters and default settings.",
      "impact": "Configuration drift can lead to undocumented and untested security weaknesses, inconsistent application of security policies, and an overall degradation of the security posture. This can result in unauthorized access, privilege escalation, or service disruption, compromising the confidentiality, integrity, and availability of affected servers and the data they handle.",
      "action": "Implement centralized configuration management and continuous training",
      "mitigation": "Establish and enforce security baselines for all server operating systems using a centralized configuration management system (e.g., Ansible, Puppet, Chef, SaltStack, or GPOs).",
      "check": "Is a centralized configuration management tool in use? Are security baselines for server operating systems defined, documented, and enforced? Are regular audits performed to detect configuration drift? Do administrators receive regular training on deployed OS versions?",
      "asvs": "BSI IT-Grundschutz SYS.1.1 General Server — especially A11 (Server security policy), A16 (Secure installation and baseline configuration), A23 (System monitoring), and A39 (Central management of security policies).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_1_General_server_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk is raised for all in-scope technical assets that are identified as server-like technologies (e.g., web servers, application servers, databases, backend services). The risk is inherent to manually managed or inconsistently managed environments.",
      "riskAssessment": "The likelihood is considered 'Likely' as manual configuration and lack of continuous training are common operational challenges. The impact is determined by the CIA requirements of the server asset itself and the data it processes or stores. Servers handling critical or highly sensitive data will have a higher impact rating.",
      "falsePositives": "This risk may be a false positive if a mature, automated configuration management system and a robust training program are in place, even if not explicitly modeled. The risk serves as a strong recommendation to verify these operational processes.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "87_sec3.ts",
      "bsiCode": "SYS.1.1",
      "id": "regular-work-with-admin-privileges-bsi-ops115-a6",
      "title": "Regular Work with Administrative Privileges (BSI OPS.1.1.5 A6)",
      "description": "Performing regular user tasks (e.g., email, web browsing) with administrative privileges—especially on server systems—poses a significant security risk because it violates the principle of least privilege. When a user is logged in with elevated rights, any malicious code they encounter (via phishing, malicious websites, etc.) also runs with those same elevated rights. This practice dramatically increases the attack surface for compromising the asset and the entire network.",
      "impact": "If an administrative account used for daily tasks is compromised, an attacker gains extensive privileges on the server and potentially other connected systems. This can lead to complete system takeover, data theft or destruction, and lateral movement across the network using techniques like Pass-the-Hash. Abuse of these far-reaching privileges by legitimate administrators acting maliciously is also a significant threat scenario.",
      "action": "Enforce Strict Separation of User and Administrative Accounts",
      "mitigation": "Strictly enforce the principle of least privilege. Administrators must use a standard, non-privileged user account for all regular tasks. A separate, dedicated administrative account must be used only for performing administrative tasks. This administrative access should be further protected by multi-factor authentication and session monitoring (e.g., via a Privileged Access Management (PAM) solution). Server systems should be hardened to prevent standard user activities like web browsing.",
      "check": "Are administrative and standard user accounts strictly separated? Is there a policy preventing the use of administrative accounts for non-administrative tasks? Is the `usedAsClientByHuman` flag in the model set to `true` on any server-like technical assets? This flag indicates a potential violation.",
      "asvs": "BSI IT-Grundschutz / BSI 200-2, Baustein OPS.1.1.5 Identity and Access Management, Requirement A6: Restrictive assignment of authorizations (Least-Privilege Principle).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is detected for any non-client technical asset (e.g., servers, backends, databases) that has the `usedAsClientByHuman` property set to `true`. This property indicates that a human is using a server-like component for interactive tasks, which strongly indicates this antipattern.",
      "riskAssessment": "The likelihood is considered high if the condition is met, as this creates a direct and well-known attack vector. The impact is derived from the CIA rating of the affected technical asset. A compromise of an administrative session on a mission-critical asset will have a very high impact.",
      "falsePositives": "A false positive might occur if a system is legitimately a server but also has a dedicated, sandboxed client interface for a specific, justified purpose. In such cases, the risk should be accepted with justification or the model updated to better reflect the architecture (e.g., by splitting the asset into a server and a client component).",
      "cwe": "250",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "87_sec4.ts",
      "bsiCode": "SYS.1.1",
      "id": "data-loss-on-servers",
      "title": "Data Loss on Servers (BSI SYS.1.1)",
      "description": "The loss of data on servers can have significant consequences for business processes and the entire organization.",
      "impact": "If institutionally relevant information is destroyed or falsified, business processes can be delayed or completely halted.",
      "action": "Implement a robust data backup and recovery strategy and/or a high-availability architecture",
      "mitigation": "To mitigate the risk of data loss, implement a comprehensive data backup and recovery plan. This should include regular, automated backups of all critical data.",
      "check": "Are regular data backups performed for all critical server systems? Is the data recovery process documented and tested periodically?",
      "asvs": "BSI IT-Grundschutz SYS.1.1 General Server; see availability and redundancy measures (e.g., SYS.1.1.A28).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_1_General_server_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for in-scope technical assets of type `datastore` (or technologies that typically store data) that are not marked as `redundant: true`.",
      "riskAssessment": "The impact of data loss is directly proportional to the `availability` and `integrity` ratings of the technical asset. A `mission-critical` asset will result in a very high impact.",
      "falsePositives": "A risk might be flagged for an asset that has an out-of-band backup solution not captured in the model.",
      "cwe": "755",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "87_sec5.ts",
      "bsiCode": "SYS.1.1",
      "id": "denial-of-service-on-resources",
      "title": "Denial of Service against Data and System Resources (BSI)",
      "description": "A Denial of Service (DoS) attack targets the availability of data assets, systems, or functions to prevent authorized use.",
      "impact": "A successful DoS attack can render services or resources completely unusable, disrupting business operations. Due to the strong interdependence of modern IT systems, a resource shortage on one server can quickly cause cascading failures that affect dependent systems and services.",
      "action": "Implement multi-layer DoS protection and resource management",
      "mitigation": "Employ a combination of defenses:",
      "check": "Are DoS mitigation services (WAF, CDN protection) in place for internet-facing assets? Are critical services redundant? Is resource utilization actively monitored with alerting? Is rate limiting implemented on public-facing APIs?",
      "asvs": "ASVS V1.4.4 (Business Logic DoS), V12.5.1 (Resource Exhaustion)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
      "detectionLogic": "This risk is generated for in-scope technical assets exposed to potential DoS attacks. Prime candidates are internet-facing assets, especially those providing web applications or services. Non-redundant assets with high availability requirements are particularly vulnerable because their failure has significant impact.",
      "riskAssessment": "The likelihood of a DoS attack is very high for any internet-facing service. Impact correlates with the asset’s availability requirement and the data it handles. A non-redundant, mission-critical asset represents a very high-impact risk. Impact increases further if many other assets depend on the target (cascading failure).",
      "falsePositives": "This risk may be partially mitigated by external services (e.g., Cloudflare, Akamai, AWS Shield) that are not explicitly modeled. The rule raises the risk to ensure such protections are considered and verified.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "87_sec6.ts",
      "bsiCode": "SYS.1.1",
      "id": "unnecessary-services-on-server-sys1-1-a12",
      "title": "Unnecessary Applications and Services on Servers (BSI SYS.1.1.A12)",
      "description": "During OS installation or subsequent operation, applications and services are often installed that are not actually required for the asset’s purpose.",
      "impact": "Exploiting vulnerabilities in unpatched, unnecessary services can lead to system compromise, allowing attackers to tamper with data, disclose sensitive information, or use the server as a pivot point for further attacks. This compromises the confidentiality, integrity, and availability of the server and the data it processes.",
      "action": "Implement system hardening and configuration management",
      "mitigation": "Establish a hardening baseline for all servers that applies the principle of least functionality. Deactivate or uninstall all services, applications, and features that are not explicitly required for the server’s business purpose. Regularly audit servers against this baseline to identify and remove unnecessary software. Integrate this check into the server provisioning process. In the threat model, tag the asset with `Hardening:Standard` or `Hardening:Minimal` to indicate this.",
      "check": "Are server configurations based on a documented hardening standard? Is there a process to review and approve all installed software? Are servers regularly scanned for open ports and running services to identify deviations from the baseline?",
      "asvs": "BSI IT-Grundschutz-Kompendium: SYS.1.1 Allgemeiner Server, Requirement SYS.1.1.A12 (Deaktivierung nicht benötigter Dienste). This also closely relates to OWASP Top 10 A06:2021 - Vulnerable and Outdated Components.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_1_Allgemeiner_Server_Edition_2023.html",
      "detectionLogic": "This is an operational hygiene risk. The tool cannot definitively determine which services are “unnecessary.”",
      "riskAssessment": "The likelihood is high for any server asset without a documented hardening process in place. The impact is directly related to the CIA requirements of the server and the data it handles. A compromised server handling 'Strictly Confidential' data has a very high impact.",
      "falsePositives": "This risk can be considered a false positive if a strong, automated configuration management and hardening process is in place but has not been documented in the threat model by applying the appropriate `Hardening` tag to the asset.",
      "cwe": "1390",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "87_sec7.ts",
      "bsiCode": "SYS.1.1",
      "id": "server-overload-due-to-insufficient-capacity",
      "title": "Server Overload Due to Insufficient Capacity (BSI CON.8)",
      "description": "If servers are not properly sized, they may fail to meet the organization's performance or capacity requirements. Depending on the affected IT systems, negative effects can include temporary service unavailability or data loss. In complex IT landscapes, overloading a single server can also cause problems or outages in dependent systems. Triggers can include misconfigured applications consuming excessive resources, exceeding storage limits, handling too many concurrent requests, high CPU demand, or processing an excessive number of messages simultaneously.",
      "impact": "Non-redundant servers that fail due to overload directly jeopardize availability. If the failure leads to data corruption or loss, integrity is also affected. This can disrupt business processes, cause financial losses, and damage the organization's reputation.",
      "action": "Implement capacity management and monitoring",
      "mitigation": "Continuously monitor key performance indicators (KPIs) for servers and services, including CPU, memory, storage, and network utilization. Implement automated alerts to notify administrators when predefined thresholds are exceeded. Design critical systems for high availability and scalability using redundancy, such as load balancers, failover clusters, or cloud-based auto-scaling groups. Perform regular capacity planning based on historical trends and expected business growth to proactively provision resources.",
      "check": "Are performance and capacity metrics for critical systems monitored? Are alerting mechanisms in place for high-load scenarios? Are critical systems designed with redundancy or scalability in mind? Is there a documented capacity management process?",
      "asvs": "N/A (derived from BSI)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Capacity_management_edition_2022.pdf?__blob=publicationFile (BSI CON.8: Capacity Management)",
      "detectionLogic": "This risk is identified for technical assets that are critical for business operations but lack redundancy. The risk is raised for non-redundant assets with high or mission-critical availability requirements. The likelihood increases if the asset is a central component with many incoming data flows, indicating high potential load and a significant impact on dependent systems.",
      "riskAssessment": "The impact of this risk correlates with the availability and integrity requirements of the affected asset and the data it handles. A non-redundant, mission-critical database poses a very high risk. The likelihood is higher for such systems, especially if they serve as a hub for many other components, as indicated by a high number of incoming communication links.",
      "falsePositives": "This risk might be a false positive if redundancy is achieved through mechanisms not modeled in Threagile, such as high-availability (HA) features of virtualization platforms or underlying hardware that are not explicitly detailed in the model.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "88_sec2.ts",
      "bsiCode": "SYS.1.2.2",
      "id": "uncontrolled-use-of-integrated-cloud-services",
      "title": "Uncontrolled Use of Integrated Cloud Services",
      "description": "Modern server operating systems (e.g., Windows Server), databases, and other backend applications often include built-in options to use public cloud services—for example, online backup, recovery key storage, or data synchronization. While this can improve availability, using such features without a defined governance framework introduces significant risks.",
      "impact": "If data is transferred to external cloud providers without appropriate controls (such as strong, centrally managed encryption), confidentiality can be compromised through unauthorized access by criminal or state actors. It also creates a strong dependency on the provider; service disruption or discontinuation can severely affect the availability of business processes.",
      "action": "Establish and enforce a cloud governance policy",
      "mitigation": "A clear policy must govern the use of any external cloud services, including those integrated into operating systems or applications. For sensitive data, such features should be disabled by default via configuration management or group policies. If their use is permitted, all data must be encrypted with organization-controlled keys before transfer to the cloud. A contingency and exit plan should be in place to mitigate vendor dependency and ensure business continuity if the cloud service becomes unavailable.",
      "check": "Is there a corporate policy for the use of integrated cloud services? Are these features disabled by default on sensitive systems? Is all data sent to external cloud storage strongly encrypted with organization-managed keys? Are contingency and exit plans defined for provider failure?",
      "asvs": "BSI IT-Grundschutz OPS.1.2.5 Cloud-Nutzung (Cloud usage)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_Cloud_usage_edition_2022.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule triggers for non-client, non-security-control technical assets that process or store data with at least restricted confidentiality or important availability. These assets are likely candidates for integrated cloud backup or storage features, and their use can pose a risk to sensitive data.",
      "riskAssessment": "Impact is determined by the highest confidentiality and availability rating of the data processed or stored by the asset. Likelihood is 'likely' if the asset resides within a public cloud environment and 'unlikely' otherwise, assuming on-premises systems are less prone to using public cloud integrations without explicit consideration. Severity is calculated based on this impact and likelihood.",
      "falsePositives": "This risk may be a false positive if the organization has enforced technical controls to disable integrated cloud features across systems, or if their use is governed and secured by a robust policy (e.g., via a Cloud Access Security Broker or client-side encryption with corporate keys). Manual verification of system configuration is required.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "88_sec3.ts",
      "bsiCode": "SYS.1.2.2",
      "id": "insecure-windows-server-2012-configuration",
      "title": "Insecure or Inconsistent Configuration of Windows Server 2012/R2",
      "description": "Windows Server 2012 and 2012 R2 introduced new security features and modified existing ones.",
      "impact": "Misconfigurations can create exploitable vulnerabilities, compromising the confidentiality, integrity, and availability of the server and the data it handles.",
      "action": "Implement hardening and centralized configuration management for Windows Server 2012/R2",
      "mitigation": "Establish and enforce a mandatory hardening baseline for all Windows Server 2012/R2 instances, based on security best practices (e.g., from CIS Benchmarks or Microsoft).",
      "check": "Are configurations for Windows Server 2012/R2 instances centrally managed and documented?",
      "asvs": "Derived from BSI IT-Grundschutz. Related to ASVS V14.2.1 (Component Hardening).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Hardening_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for all in-scope technical assets identified as Windows Server 2012 or Windows Server 2012 R2 via tags.",
      "riskAssessment": "The likelihood of exploitation is increased if the server is internet-facing or uses legacy protocols like unencrypted SMB or LDAP.",
      "falsePositives": "This risk might be a false positive if the identified server, despite its OS, is confirmed to be fully hardened, consistently managed via a central tool, and regularly audited. Manual verification of operational security practices is required to confirm mitigation.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "88_sec4.ts",
      "bsiCode": "SYS.1.2.2",
      "id": "gpo-misconfiguration",
      "title": "Risk of GPO Misconfiguration on Windows Systems",
      "description": "Group Policy Objects (GPOs) are a powerful mechanism for configuring security settings of Windows systems, particularly within a domain. However, due to the large number of options, an unsystematic approach can easily lead to contradictory or incompatible configurations, or entire security areas being overlooked. Misunderstood inheritance rules and filters can even cause GPOs to fail to apply at all, leaving systems in a default, potentially insecure state.",
      "impact": "Improper GPO management can lead to severe vulnerabilities on servers and connected clients, operational disruptions, and a general weakening of the security posture. Failure to apply intended security settings can compromise the confidentiality, integrity, and availability of the managed systems and the data they process.",
      "action": "Implement Systematic GPO Management and Review",
      "mitigation": "Adopt a structured approach to GPO management. Use security baselines (e.g., from Microsoft or CIS) as a foundation. All GPO changes should be documented, tested in a non-production environment, and reviewed before deployment. Regularly audit GPOs for conflicts, redundancies, and unexpected results using tools such as 'gpresult' or Microsoft Advanced Group Policy Management (AGPM). Restrict permissions to modify GPOs to authorized administrators.",
      "check": "Is there a documented process for creating, testing, and deploying GPOs? Are GPOs regularly reviewed against security baselines? Is an audit trail of GPO changes maintained? Are tools used to check for conflicts and whether settings are effectively applied?",
      "asvs": "This is a platform-level control. Its principle relates to ASVS V14.1 (Configuration), which requires security configuration to be defined, implemented, and maintained.",
      "cheatSheet": "https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-security-baselines",
      "detectionLogic": "This risk is raised for technical assets that are typically managed by GPOs in a Windows environment, such as LDAP servers (domain controllers), identity providers (AD FS), and file servers. The risk can also be triggered by explicitly tagging any asset with `@gpo-managed:true`.",
      "riskAssessment": "The likelihood is considered 'Likely' because GPO misconfiguration is common without a strict, formalized management process. The impact is determined by the criticality of the asset. A misconfigured domain controller (`LDAPServer`) has a systemic, high impact, while other servers' impact depends on their specific CIA rating.",
      "falsePositives": "This risk is flagged based on the asset's technology type, assuming it is managed by GPOs. The organization may have a robust GPO management process or may use alternative configuration management tools. Manual verification of the GPO management lifecycle is required to confirm or dismiss this risk.",
      "cwe": "732",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "88_sec5.ts",
      "bsiCode": "SYS.1.2.2",
      "id": "insufficient-server-hardening",
      "title": "Insufficient Hardening or Misconfiguration of the Server OS",
      "description": "Server operating systems like Windows Server offer numerous security features to protect the integrity of processed information. However, these features can themselves contain vulnerabilities or, more commonly, be inconsistently configured for convenience. Insufficient security hardening can allow unauthorized individuals to tamper with information and system processes, hide their tracks, or deploy malware to manipulate data remotely.",
      "impact": "Successful exploitation can lead to severe integrity loss of data and system processes. Attackers could alter critical business data, install backdoors, disrupt services (denial of service), and escalate privileges within the network. This can result in financial loss, reputational damage, and operational failure.",
      "action": "Implement and Enforce Secure Baseline Configurations (Hardening)",
      "mitigation": "Define, implement, and regularly audit a security baseline (hardening guide) for all server operating systems. This should include disabling unnecessary services and ports, enforcing strong access controls and logging, applying security patches promptly, and using configuration management tools to prevent configuration drift. Regularly use vulnerability scanners and integrity monitoring tools (e.g., a file integrity monitor) to detect deviations from the baseline and potential compromises.",
      "check": "Are there documented, version-controlled hardening guides for all server operating systems in use? Is there a process to ensure new systems are built according to these guides? Are systems regularly audited against the baseline? Is automated configuration management in place to enforce the secure state?",
      "asvs": "BSI IT-Grundschutz: SYS.1.1 (General Server), OWASP ASVS v4.0.3: 1.1.1 (Secure Configuration)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Hardening_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for technical assets representing server-side technologies that are common targets for misconfiguration (e.g., web servers, application servers, databases). The risk is higher for assets directly exposed to the internet or those handling highly critical or confidential data, as they are more attractive targets.",
      "riskAssessment": "The impact is determined by the integrity and confidentiality requirements of the asset itself and the data it handles. The likelihood is considered 'Likely' by default for susceptible technologies, as maintaining a secure configuration is a persistent operational challenge. The likelihood increases to 'Very Likely' for internet-facing assets, which are subject to constant automated scanning and attack attempts.",
      "falsePositives": "This risk might be a false positive if a robust, automated configuration management and hardening process (e.g., using Ansible, Puppet, or similar tools with audited playbooks) is in place, even if not explicitly modeled. This must be verified by reviewing operational security processes.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "88_sec6.ts",
      "bsiCode": "SYS.1.2.2",
      "id": "abuse-of-administrative-functions",
      "title": "Abuse of Administrative Functions",
      "description": "Routine work under standard permissions is now common practice. However, administrators still need to elevate privileges at certain times, creating opportunities for attackers to gain privileged access. Abuse of privileges by legitimate administrators is also a relevant threat scenario. Attackers can leverage compromised administrative credentials to move laterally within the network, for example by using Pass-the-Hash or similar techniques.",
      "impact": "Because administrative roles are highly privileged, compromise typically has significant impact, especially for domain administrators. This can result in the complete loss of confidentiality, integrity, and availability of all systems managed by that role, enabling attackers to exfiltrate data, destroy systems, or deploy ransomware across the infrastructure.",
      "action": "Enforce Least Privilege and Monitor Privileged Access",
      "mitigation": "Strictly implement the principle of least privilege. Use separate, dedicated accounts and hardened workstations (Privileged Access Workstations - PAWs) for administrative tasks. Enforce strong multi-factor authentication (MFA) for all administrative access. Log, monitor, and regularly audit all privileged activities. Employ Privileged Access Management (PAM) solutions to control, vault, and rotate credentials. Use modern credential protection mechanisms such as Windows Credential Guard to prevent credential theft attacks like Pass-the-Hash.",
      "check": "Are administrative tasks performed from dedicated, hardened systems? Is MFA enforced for all administrative access? Is all privileged activity logged and regularly reviewed? Are PAM solutions used to manage and secure administrative credentials?",
      "asvs": "V4.0.3-4.1.2: Least Privilege",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for technical assets that are managed by administrative roles. These roles are identified by tags such as `role:administrator`, `role:fachadministrator`, or the highly critical `role:domain-administrator`. The risk is particularly high for assets that represent identity stores or central management components (e.g., identity provider, LDAP server).",
      "riskAssessment": "The likelihood is considered 'Likely' because administrative accounts are high-value targets. The impact is directly related to the power of the administrative role and the criticality of the managed asset. For a `role:domain-administrator`, the impact is rated 'Very High' by default. For other administrative roles, the impact is derived from the highest CIA rating of the technical asset itself or the data it processes or stores.",
      "falsePositives": "The risk might be lower if strong compensating controls such as a mature PAM solution, comprehensive EDR/SIEM monitoring, and regular auditing are in place but not explicitly modeled. This requires manual verification of the organization's operational security practices.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "88_sec7.ts",
      "bsiCode": "SYS.1.2.2",
      "id": "insecure-remote-administration",
      "title": "Insecure Remote Administration (BSI-derived)",
      "description": "Servers such as Windows Server provide a variety of remote administration capabilities that can be misused.",
      "impact": "Successful exploitation allows an attacker to gain administrative control over the server, leading to a complete loss of confidentiality, integrity, and availability for the asset and its data.",
      "action": "Harden remote administration interfaces",
      "mitigation": "Secure all remote administration channels by enforcing the use of encrypted protocols (e.g., RDP with TLS, SSH, HTTPS-based management).",
      "check": "Are remote administration protocols (such as RDP, WinRM, or SSH) exposed to untrusted networks? Is strong authentication (e.g., MFA or client certificates) enforced on all administrative access points?",
      "asvs": "V14.2.1 (Secure Configuration), V14.4.4 (Restricted Remote Access)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any in-scope technical asset tagged with '@os:windows-server' that has an incoming communication link representing a potential remote administration channel with security weaknesses.",
      "riskAssessment": "The likelihood is high if an administrative port is exposed to the internet, especially with weak password-based authentication. The impact is determined by the business criticality (CIA) of the server asset itself. A compromise of a mission-critical server has a very high impact.",
      "falsePositives": "This risk might be a false positive if compensating controls exist outside the model, such as a separate, unmodeled Web Application Firewall (WAF), an Intrusion Prevention System (IPS), or an out-of-band management network that provides strong segregation not reflected in the diagram.",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "89_sec1.ts",
      "bsiCode": "SYS.1.2.3",
      "id": "'unmanaged-cloud-integration-in-os'",
      "title": "Unmanaged or Unapproved Integrated Cloud Features on Windows Server",
      "description": "Windows Server ships with built-in hooks to Microsoft cloud services (e.g., Azure Backup, online BitLocker key escrow, telemetry upload). If these integrations are used without policy, review, or explicit hardening, they can bypass established data handling and supplier controls.",
      "impact": "Unmanaged cloud integrations can leak sensitive information (e.g., credentials, recovery keys, crash dumps) and create hidden third-party dependencies. Termination or outage of the external service may break backup/restore or administrative workflows and degrade availability of business processes.",
      "action": "Govern OS-integrated cloud features via policy, tagging, and configuration baselines",
      "mitigation": "Mandate a corporate policy for OS-integrated cloud features. Enforce via Group Policy/Intune baselines to disable unapproved options by default. Allow only reviewed use cases and tag such assets as `@cloud-integration:managed`; tag hardened/disabled hosts as `@cloud-integration:disabled`. Monitor egress to public cloud endpoints and review telemetry/diagnostic settings (set minimum practical level). Perform risk assessment before enabling features like Azure Backup or online key escrow.",
      "check": "Verify a written policy exists, baseline settings are deployed, assets are consistently tagged (`managed` or `disabled`), and network monitoring alerts on unexpected cloud endpoints. Confirm that recovery keys and diagnostics are not sent to external tenants without approval.",
      "asvs": "ASVS V14.2.5 (Configuration: External Behavior), V1.14 (Secure Defaults)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Third_Party_Security_Cheat_Sheet.html",
      "detectionLogic": "Implementation detail: The rule flags any in-scope technical asset tagged `@os:windows-server` that is NOT also tagged with either `@cloud-integration:managed` or `@cloud-integration:disabled`. Missing explicit governance implies default OS behavior may enable cloud ties (backup, key escrow, telemetry), elevating data-exfiltration and supplier-lock risks.",
      "riskAssessment": "Likelihood: Likely (features tend to be enabled/usable out of the box and often overlooked during hardening). Impact scales with the asset’s Confidentiality and Availability requirements: servers processing Restricted/Confidential data or providing Important/Critical services face greater impact.",
      "falsePositives": "May be a false positive if network egress to relevant cloud services is centrally blocked or if the OS tag is incorrect. Also consider cases where governance exists but tags are missing; update tags rather than suppressing the rule.",
      "cwe": "200",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "89_sec2.ts",
      "bsiCode": "SYS.1.2.3",
      "id": "insecure-remote-administration-windows",
      "title": "Insecure Remote Administration of Windows Server (BSI SYS.1.2.3)",
      "description": "Windows Server provides several remote administration capabilities (e.g., RDP, WinRM) that can be misused if not properly secured.",
      "impact": "An attacker exploiting insecure remote access can gain extensive control over the server, compromising the confidentiality, integrity, and availability of its data and services.",
      "action": "Secure remote administration channels and authentication",
      "mitigation": "Ensure all remote administration protocols use strong, encrypted channels (e.g., via a secure VPN or an SSH tunnel). Enforce strong, multi-factor authentication (MFA) instead of relying solely on passwords.",
      "check": "Are all remote administration connections encrypted? Is strong authentication (MFA) enforced for all administrative access? Are access lists (IP filtering) in place for remote management interfaces? Are unnecessary remote services disabled?",
      "asvs": "BSI IT-Grundschutz SYS.1.2.3 Windows Server, Requirements A5 (Secure authentication and authorization) and A6 (Security for Remote Desktop access).",
      "cheatSheet": "BSI IT-Grundschutz Kompendium: SYS.1.2.3 Windows Server",
      "detectionLogic": "This risk is raised for technical assets tagged as `os:windows-server` that have incoming communication links using remote administration protocols (e.g., RDP or WinRM) with weak authentication (`none` or `credentials`).",
      "riskAssessment": "The likelihood of exploitation is HIGH, especially if weak authentication is combined with internet exposure. The impact is VERY HIGH if the server processes or stores high-value data (high CIA ratings) or is connected to other critical systems, as a compromise allows for widespread damage and potential lateral movement.",
      "falsePositives": "This risk can be a false positive if compensating controls exist outside the model, such as a mandatory corporate VPN with MFA that protects the entire network segment, which is not explicitly modeled on the communication link itself.",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "89_sec3.ts",
      "bsiCode": "SYS.1.2.3",
      "id": "uncontrolled-windows-telemetry",
      "title": "Uncontrolled Transmission of Diagnostic and Telemetry Data from Windows Server",
      "description": "By default, Windows Server sends diagnostic data to the manufacturer, Microsoft.",
      "impact": "If sensitive data (such as information from memory dumps or system event logs) is transmitted to Microsoft via telemetry services,",
      "action": "Harden Telemetry Service Configuration",
      "mitigation": "The telemetry and diagnostic data services on all Windows Server systems should be explicitly configured to a level that aligns with the organization's security and data protection policies.",
      "check": "Are all Windows Server assets configured to a minimal, policy-compliant telemetry level? Is there a Group Policy or other configuration management tool in place to enforce this setting?",
      "asvs": "BSI IT-Grundschutz SYS.1.2.3 Windows Server; related requirement: SYS.1.2.3.A3 Telemetry and usage data under Windows Server. Related threats include G 0.40 Eavesdropping and G 0.14 Misuse of administrative and maintenance functions.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_2_2_Windows_Server_2019_Edition_2021.html",
      "detectionLogic": "This rule triggers for any technical asset tagged with '@os:windows-server' that is not also tagged with '@telemetry:configured'.",
      "riskAssessment": "The likelihood is considered 'very likely' as telemetry is enabled by default on Windows Server. The impact is determined by the confidentiality of the data processed or stored by the server.",
      "falsePositives": "A false positive can occur if the telemetry settings have been hardened using a mechanism that is not reflected in the model's tags (e.g., an external configuration management system).",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "89_sec4.ts",
      "bsiCode": "SYS.1.2.3",
      "id": "forensic-investigation-hindered-by-vsm",
      "title": "Forensic investigation hindered by Virtual Secure Mode (VSM) (BSI-based)",
      "description": "Using Virtual Secure Mode (VSM) can significantly hinder or even prevent forensic investigations, for example during incident response. Processes protected by the Secure Kernel or Isolated User Mode (IUM)—such as Credential Guard—are no longer accessible for analysis. For instance, memory dumps of these protected processes cannot be examined due to cryptographic protections.",
      "impact": "If a security incident occurs on a system using VSM, it may be impossible to determine the root cause, the scope of the breach, or the attacker’s actions. This prevents effective remediation, accountability, and lessons learned, potentially allowing attackers to maintain persistence or repeat the attack. It directly degrades incident response capabilities.",
      "action": "Evaluate and document the trade-off between proactive hardening and reactive forensics",
      "mitigation": "Acknowledge the trade-off between the preventive security of VSM and the reactive needs of forensic analysis. If memory forensics are critical for compliance or operational security, consider disabling VSM/IUM features on systems where detailed incident analysis is required. Alternatively, ensure that other logging and monitoring mechanisms (e.g., EDR, advanced logging) unaffected by VSM can provide sufficient visibility for incident response. Document this decision in the system’s security concept and have it approved by the incident response team.",
      "check": "Does the system use Virtual Secure Mode (VSM), Credential Guard, or other IUM-based technologies? Has the incident response team approved this configuration and confirmed they have alternative, sufficient investigation methods?",
      "asvs": "Derived from BSI IT-Grundschutz DER.1 Incident Detection and Handling, specifically DER.1.A4 Performing a forensic analysis, which VSM can impede.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Incident_Detection_and_Handling_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Triggers on technical assets explicitly tagged with `@VSM-Enabled`, indicating they use technologies like Virtual Secure Mode or Credential Guard that impede memory analysis.",
      "riskAssessment": "The likelihood is based on the probability of a security incident occurring that requires deep forensic analysis. The impact is determined by the criticality (CIA rating) of the asset; the inability to investigate a compromise of a mission-critical asset is a high-impact event.",
      "falsePositives": "This risk is valid if VSM or a similar technology is enabled. A false positive might be claimed if the organization has formally accepted this risk or implemented compensating controls (e.g., extensive, immutable external logging) that make direct memory forensics unnecessary for their specific incident response procedures.",
      "cwe": "778",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "8_sec1.ts",
      "bsiCode": "APP.3.2",
      "id": "uncontrolled-webserver-admin-access",
      "title": "Uncontrolled Administrative Access to a Web Server",
      "description": "If an attacker gains administrative access to a web server, they can deliver a manipulated website (defacement), publish false information, or exfiltrate data processed or stored by the server.",
      "impact": "A successful attack can lead to significant reputational damage if the website is defaced or used to spread misinformation.",
      "action": "Harden the web server and strictly control administrative access",
      "mitigation": "Implement the principle of least privilege for all server and application accounts. Administrative access (e.g., via SSH, RDP, or an admin panel) must be strictly controlled, logged, and monitored.",
      "check": "Are administrative interfaces exposed directly to the Internet? Is MFA enforced for all administrative access?",
      "asvs": "Based on BSI IT-Grundschutz concepts for securing web servers (APP.3.2 Webserver) and general servers (SYS.1.1). Aligns with OWASP ASVS V14.2 (Configuration) and V1.5 (Architecture, Design and Threat Modeling Requirements).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
      "detectionLogic": "This risk applies to all technical assets functioning as web servers, web applications, or application servers, as they are common targets for such attacks.",
      "riskAssessment": "The likelihood of exploitation is elevated for any Internet-facing web server due to constant automated scanning and targeted attacks.",
      "falsePositives": "This risk might be considered a false positive for web servers that are hosted in a highly restricted environment (e.g., an isolated network segment) with strong, layered access controls that are not fully described in the model.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "8_sec2.ts",
      "bsiCode": "APP.3.2",
      "id": "unauthorized-web-server-file-manipulation",
      "title": "Unauthorized Manipulation of Web Server Files (BSI APP.3.2)",
      "description": "During an attack, unauthorized persons could gain access to a web server and manipulate its files.",
      "impact": "Successful manipulation of web server files can lead to significant damage. Altering configuration could cause service outages (Availability).",
      "action": "Harden Web Server and Implement Integrity Monitoring",
      "mitigation": "Implement strong access controls and apply the principle of least privilege for all file and directory permissions on the server.",
      "check": "Are file and directory permissions on the web server properly restricted? Is a patch management process in place and followed?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.3.2 Webserver, focusing on protecting the integrity of web content and configurations.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_Web_applications_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is generated for all assets identified as web servers, web applications, or web services.",
      "riskAssessment": "The impact of this risk is determined by the integrity and availability requirements of the technical asset and the data it processes.",
      "falsePositives": "A risk might be considered a false positive if the identified 'web server' is only accessible within a highly restricted network segment with strong compensating controls,",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "8_sec3.ts",
      "bsiCode": "APP.3.2",
      "id": "denial-of-service-against-web-services-app4-t35",
      "title": "Denial-of-Service against Web Servers (BSI APP.3.2)",
      "description": "DoS attacks can specifically impair the availability of a web service, for example, by locking individual accounts through repeated failed login attempts.",
      "impact": "For many institutions, such a failure can quickly become business-critical, for example, for online shops.",
      "action": "Implement Anti-DoS/DDoS Measures",
      "mitigation": "Employ a multi-layered defense strategy. This includes using a Web Application Firewall (WAF) or a specialized anti-DDoS service provider to filter malicious traffic.",
      "check": "Is the asset protected by a WAF or an upstream anti-DDoS service? Are there rate limits on resource-intensive endpoints? Is the infrastructure designed to be scalable to handle traffic peaks?",
      "asvs": "BSI IT-Grundschutz-Kompendium: APP.3.2 Webserver (Denial of Service)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_Web_server_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to all internet-facing technical assets providing web-based services (e.g., Web Servers, Web Applications, REST/SOAP Services, Reverse Proxies).",
      "riskAssessment": "The likelihood is considered **very high** for any unprotected, internet-facing web service due to the prevalence of automated scanning and attack tools. The impact is directly related to the **Availability** rating of the asset and its data. A 'Mission-Critical' service will suffer a 'Very High' impact, while a less critical 'Operational' service will have a lower impact.",
      "falsePositives": "A risk might be incorrectly flagged if comprehensive anti-DoS measures are in place but are not modeled. This is common when protection is provided by an upstream infrastructure component (e.g., a cloud provider's standard DDoS protection) that is not explicitly shown as a WAF asset in the diagram.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "8_sec4.ts",
      "bsiCode": "APP.3.2",
      "id": "weak-or-outdated-cryptography-on-link",
      "title": "Weak or Outdated Cryptography on Communication Link",
      "description": "Many web servers still use outdated cryptographic methods like RC4 or SSL.",
      "impact": "If communication is not properly encrypted using strong, modern cryptographic standards, sensitive data can be disclosed to attackers (e.g., session cookies, credentials, personal data).",
      "action": "Enforce strong, modern encryption for all communication",
      "mitigation": "Ensure that all communication links, especially those crossing trust boundaries or involving sensitive data, use a strong, encrypted protocol (e.g., HTTPS, WSS, JDBC-encrypted, FTPS).",
      "check": "Review all communication links in the architecture. Is the protocol for each link an encrypted variant?",
      "asvs": "V9.1.1, V9.2.1",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule checks all communication links in the model. It triggers a risk if a communication link uses an unencrypted protocol",
      "riskAssessment": "The exploitation likelihood is determined by whether the unencrypted communication crosses a trust boundary and if either endpoint is exposed to the internet.",
      "falsePositives": "A risk might be a false positive if the link operates entirely within a physically secured, isolated network segment where interception is considered impossible,",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "8_sec5.ts",
      "bsiCode": "APP.3.2",
      "id": "violation-of-regulatory-requirements-for-web-content",
      "title": "Regulatory Non-Compliance for Web Content (BSI APP.3.2 · CON.3 · DER.1)",
      "description": "Publishing web content is subject to multiple legal requirements. In addition to telemedia and data protection laws (e.g., @DataType:PII), copyright and consumer-protection rules apply.",
      "impact": "Non-compliance may lead to fines, injunctions, takedown orders, litigation, and reputational damage.",
      "action": "Establish and enforce legal & regulatory compliance checks for all published web content and services.",
      "mitigation": "Introduce a documented pre-publish review including legal sign-off. Ensure an accurate, easily accessible imprint and privacy policy.",
      "check": "Is there a formal pre-publication legal review? Are imprint and privacy policy complete, up-to-date, and visible on every page?",
      "asvs": "BSI IT-Grundschutz: APP.3.2 (Webserver), CON.3 (Web Applications), DER.1 (Data Protection)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Web_applications_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Raise this risk for technical assets identified as web servers/applications/CMS/report engines that are internet-facing,",
      "riskAssessment": "Likelihood: Likely, as legal oversights are common without explicit processes.",
      "falsePositives": "May be a false positive for purely internal, informational, or static pages with no tracking, or when strong, provable legal review processes exist that are not visible in the model.",
      "cwe": "200",
      "function": "RiskFunction.BusinessSide",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "8_sec6.ts",
      "bsiCode": "APP.3.2",
      "id": "inadequate-error-handling-bsi-app-3-2",
      "title": "Missing or Inadequate Error Handling (BSI APP.3.2)",
      "description": "If errors occur during the operation of a web server, this can affect its availability, cause content to be displayed incompletely, or lead to the failure of security mechanisms.",
      "impact": "Improper error handling can lead to denial of service and, more critically, the disclosure of sensitive system information (e.g., stack traces, database queries, internal file paths) that attackers can use to plan further attacks. It may also cause security controls to fail open, bypassing authentication or authorization checks.",
      "action": "Implement robust and secure error and exception handling.",
      "mitigation": "Implement comprehensive error handling (e.g., try-catch-finally blocks) across application logic.",
      "check": "Is there a global exception handler? Are user-facing error pages generic and free of technical details?",
      "asvs": "BSI IT-Grundschutz APP.3.2: Webserver, Requirement APP.3.2.A12: Appropriate handling of errors and error messages.",
      "cheatSheet": "",
      "detectionLogic": "This risk is raised for any web application or web server, especially those with custom-developed parts, where error handling is often implemented incorrectly.",
      "riskAssessment": "The likelihood is considered 'Likely' for any custom-developed web component. The impact is determined by the sensitivity (CIA) of the asset and the data it handles.",
      "falsePositives": "Possible false positive if the application uses a modern, mature framework that enforces secure error handling by default and this has been verified.",
      "cwe": "209",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "90_sec1.ts",
      "bsiCode": "SYS.1.3",
      "id": "user-enumeration-via-system-tools-bsi-t4.19",
      "title": "User Enumeration and Activity Profiling via System Tools (BSI T 4.19)",
      "description": "Various Unix-like programs (e.g., 'who', 'finger', 'ruser') can be used by any user to query data that the IT system stores about its users and system state.",
      "impact": "Attackers can build detailed usage profiles for specific accounts (such as system administrators) by periodically evaluating this information.",
      "action": "System Hardening and Access Control Configuration",
      "mitigation": "Harden the operating system by disabling or removing unnecessary network services such as 'finger' and 'ruser'.",
      "check": "Are legacy services such as 'finger' and 'ruser' disabled on multi-user systems? Can a non-privileged user run commands like 'who', 'w', or 'users' and see information about other users, especially administrative ones? Are file permissions on system directories (e.g., /var/log/wtmp) and process information (in /proc) appropriately restricted?",
      "asvs": "ASVS V14.2.2: The application has been hardened to remove all unnecessary functionality, files, and services from the application server.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
      "detectionLogic": "This risk is generated for technical assets explicitly marked as `multi_tenant` or for technology types that typically support multiple users (e.g., application servers, databases, mainframes, or general-purpose server OS). The risk is considered more severe if the asset handles highly sensitive data, as the value of the reconnaissance increases.",
      "riskAssessment": "The likelihood is considered 'Likely' on any multi-user system that has not been explicitly hardened, as the required tools are standard on most Unix-like operating systems.",
      "falsePositives": "This risk can be a false positive if the system is properly hardened (e.g., services are disabled, permissions are strict, mandatory access control is used), but the model only indicates that it is a multi-user technology. Verification requires checking the actual system configuration and hardening measures.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "90_sec2.ts",
      "bsiCode": "SYS.1.3",
      "id": "abuse-of-scripting-on-unix",
      "title": "Abuse of Scripting Languages on Unix-like Systems (BSI OPS.1.1.5.A1)",
      "description": "Unix-like operating systems often utilize powerful scripting languages. Scripts, which are text files containing a series of commands, can be executed from the command line. Due to the extensive functionality of these scripting environments, attackers can misuse scripts for a wide range of malicious purposes. Furthermore, once activated, it is very difficult to contain or restrict the capabilities of these scripting languages.",
      "impact": "If an attacker can execute or modify scripts on a compromised system, they can escalate privileges, install malware, exfiltrate data, tamper with system files, or cause a denial of service. This compromises the confidentiality, integrity, and availability of the system and the data it processes.",
      "action": "Harden System and Restrict Script Execution",
      "mitigation": "Apply the principle of least privilege. Disable unnecessary scripting interpreters (like Perl, Python, Bash if not needed). Use mandatory access control systems (like AppArmor or SELinux) to restrict which scripts can run, from where, and by whom. Ensure file permissions on scripts and directories are secure to prevent unauthorized modification. Regularly monitor for suspicious script execution via EDR or logging.",
      "check": "Are scripting languages not essential for the application's function disabled? Are there execution controls (like AppArmor, SELinux) in place to limit script execution? Are file permissions on system directories and scripts hardened? Is there active monitoring for command line and script execution?",
      "asvs": "Derived from BSI IT-Grundschutz Catalog (e.g., OPS.1.1.5 Linux and Unix Servers). While not a direct match, this relates to OWASP ASVS V14.2 (Validation, Sanitization and Encoding) and V1.10 (Hardening and Configuration).",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for all in-scope technical assets tagged as a Unix-like operating system (`os:unix`). The risk is generic to the OS platform and its potential for misuse if not properly hardened.",
      "riskAssessment": "The likelihood is elevated for internet-facing systems. The impact is directly related to the CIA rating of the technical asset and the data it processes or stores. A compromise of a mission-critical database server via scripting abuse has a very high impact.",
      "falsePositives": "The risk might be considered a false positive if the system, despite being Unix-like, has mature and robust hardening measures (e.g., SELinux in enforcing mode with a strict policy, minimal packages installed) that are not captured in the threat model.",
      "cwe": "78",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "90_sec3.ts",
      "bsiCode": "SYS.1.3",
      "id": "ld-preload-hijacking",
      "title": "Dynamic-Linker Hijacking via LD_PRELOAD (BSI Recommendation)",
      "description": "The LD_PRELOAD environment variable on Unix-like systems forces a specified dynamic library to be loaded before any other standard libraries required by an application.",
      "impact": "Successful exploitation of this vulnerability allows an attacker to execute arbitrary code with the permissions of the hijacked application.",
      "action": "Harden Execution Environments and Sanitize Inputs",
      "mitigation": "To mitigate this risk, apply defense-in-depth at the operating system level. Restrict write permissions on system directories and application paths to prevent unauthorized library placement.",
      "check": "Are file and directory permissions on the host system appropriately hardened? Are mandatory access control systems (SELinux, AppArmor) configured and enforced?",
      "asvs": "MITRE ATT&CK: T1574.006 - Hijack Execution Flow: Dynamic Linker Hijacking",
      "cheatSheet": "https://attack.mitre.org/techniques/T1574/006/",
      "detectionLogic": "This risk is raised for technical assets of type Process or Datastore that run on machine types where attackers could gain local access and control environment variables (Physical, Virtual, Container).",
      "riskAssessment": "The likelihood of exploitation is considered 'Likely' for any qualifying asset, assuming an attacker can gain local user access to the host system. The likelihood increases if the asset is internet-facing, as this provides more avenues for an attacker to gain initial access.",
      "falsePositives": "This risk is generated assuming a standard, insufficiently hardened operating system. It may be a false positive if the underlying execution environment is strongly hardened with technologies like SELinux, restricted permissions, and secure loader configurations that prevent LD_PRELOAD abuse.",
      "cwe": "427",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "90_sec4.ts",
      "bsiCode": "SYS.1.3",
      "id": "uncontrolled-software-source-bsi-sys-1-2",
      "title": "Uncontrolled Software Installation from Unvetted Sources (BSI SYS.1.2)",
      "description": "On Unix-like IT systems, users sometimes download and compile software source code themselves or install pre-compiled packages from third-party sources instead of using official, vetted package repositories. Each of these alternative methods of software installation carries additional risks, as it can lead to the installation of faulty, incompatible, or malicious software.",
      "impact": "Installing software from untrusted sources can introduce malware, leading to a compromise of confidentiality, integrity, and availability. It can also cause system instability and disrupt business operations due to faulty or incompatible software components.",
      "action": "Enforce Use of Vetted Software Sources and Repositories",
      "mitigation": "Establish and enforce a strict policy that all software must be installed from official, trusted, and signed package repositories. Use configuration management tools (e.g., Ansible, Puppet, Chef) to automate and control software installations. Implement an allow-list for software sources and repositories. Regularly scan systems for unauthorized or manually installed software. If compiling from source is absolutely necessary, it must be done in a controlled, isolated build environment after a rigorous source code review and security assessment.",
      "check": "Is there a documented policy for software installation? Are system configurations managed by an automated tool? Are package repositories restricted to a trusted allow-list? Are systems scanned for unauthorized software packages?",
      "asvs": "V14.2.1: Verify that all third-party components are from a trusted source, and have a secure and verifiable delivery mechanism.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
      "detectionLogic": "This risk is triggered for in-scope technical assets running on container, virtual, or physical machines, particularly those of a type where administrative or developer access is common (e.g., application servers, build pipelines). The likelihood of this risk is considered higher if the asset has custom developed parts or is explicitly tagged with `@Control:unvetted-software-sources`.",
      "riskAssessment": "The impact is determined by the CIA requirements of the technical asset and the data it processes or stores. A compromise of a mission-critical system has a very high impact. The likelihood is high if the practice is known to occur (indicated by the tag) or if no preventive controls are in place on susceptible system types. Without the explicit tag, a general risk is raised for relevant asset types to encourage verification of operational controls.",
      "falsePositives": "This risk might be acceptable in isolated sandboxes or development environments where experimentation is required, provided that these environments cannot affect production systems and are regularly wiped or reimaged. It can also be a false positive if strong compensating controls (like strict AppArmor/SELinux policies, network segmentation, and regular audits) are proven to be in place and effective.",
      "cwe": "829",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "91_sec1.ts",
      "bsiCode": "SYS.1.5",
      "id": "unclear-responsibilities-on-virtualization-platform",
      "title": "Unclear Responsibilities and Rights Separation on Virtualization Platform (BSI APP.4.4)",
      "description": "If the technical and organizational integration of virtualization servers into the existing infrastructure is not adequately planned,",
      "impact": "Failure to properly separate administrative responsibilities and access rights on a shared virtualization platform can allow an attacker or malicious insider to escalate privileges.",
      "action": "Define and Enforce a Granular Roles and Rights Concept for the Virtualization Platform",
      "mitigation": "Implement a detailed roles and rights concept that enforces separation of duties for different administrative areas (e.g., hypervisor admin, network admin, storage admin, and individual guest/application admins).",
      "check": "Is there a documented roles and rights concept for the virtualization platform? Are administrative accesses separated based on roles (e.g., hypervisor admin vs. guest admin)? Is this enforced using technical controls like RBAC? Are access logs for the platform reviewed regularly?",
      "asvs": "Derived from BSI IT-Grundschutz Kompendium APP.4.4 Virtualization, especially requirements A1 (Planning the use of virtualization), A4 (Administration of the virtualization solution), and A6 (Separation of administrative roles).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/bausteine/APP/APP_4_4_Virtualisierung.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for any 'Shared Runtime' that hosts two or more technical assets. The risk is considered higher if the co-located assets belong to different trust boundaries, indicating a mix of security domains on a single platform. The risk can be mitigated by tagging the 'Shared Runtime' with `rbac-enforced`.",
      "riskAssessment": "The likelihood is 'Likely' for any multi-tenant platform and increases to 'Very Likely' if tenants from different trust boundaries are mixed. The impact is determined by the highest confidentiality and integrity requirements of any asset on the platform, as a compromise of the platform or one tenant could affect all others.",
      "falsePositives": "The model cannot verify the actual implementation quality of the RBAC on the virtualization platform. The risk is generated based on shared tenancy, but the platform might have excellent, non-modeled controls that effectively separate tenants.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "91_sec2.ts",
      "bsiCode": "SYS.1.5",
      "id": "incorrect-placement-of-high-value-virtual-asset",
      "title": "Incorrect Placement of High-Value Virtualized Asset in a Public Network Zone (BSI APP.3.2.A5)",
      "description": "Virtualization simplifies and accelerates the provisioning of IT systems. Resources like CPU, RAM, and network connections are typically configured via a central management system, removing hardwired constraints.",
      "impact": "If a high-value virtualized asset is incorrectly exposed to the internet, it bypasses perimeter security controls and becomes a direct target for a wide range of attacks.",
      "action": "Implement and Enforce Strict Network Configuration and Deployment Processes for Virtualized Environments",
      "mitigation": "Establish strict change management and a 'four-eyes principle' for any network configuration changes within the virtualization management platform.",
      "check": "Is there a documented and enforced process for assigning virtual machines to network zones? Are changes to virtual network configurations subject to review and approval?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.3.2 (Virtualisierung). Requirement APP.3.2.A5 (Zuordnung von VMs zu virtuellen Netzen) directly addresses the need for correct network assignment.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_2_Virtualisierung_Edition_2023.pdf?__blob=publicationFile (BSI APP.3.2)",
      "detectionLogic": "This rule checks for technical assets that are virtualized (`virtual` or `container`) and have at least a medium sensitivity rating.",
      "riskAssessment": "The impact is directly derived from the confidentiality and integrity rating of the misplaced asset. A 'Strictly Confidential' database exposed to the internet has a much higher impact than a moderately sensitive internal application.",
      "falsePositives": "This risk might be a false positive if an asset is intentionally and securely designed to be internet-facing, despite its technology type (e.g., a specialized, hardened API gateway built on a technology not typically used for that purpose).",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "91_sec3.ts",
      "bsiCode": "SYS.1.5",
      "id": "inadequate-resources-on-virtualization-host-g-0-4",
      "title": "Inadequate Resources on Virtualization Host (BSI G 0.4)",
      "description": "Virtualization servers require resources like disk space, CPU power, RAM, and network bandwidth to operate the virtual IT systems they host. If these resources are not adequately planned or provisioned, significant risks to the availability of the virtual systems and the integrity of the information processed within them can arise. This is especially true when features like snapshots or resource over-commitment (overbooking) are used. Resource bottlenecks can cause virtual systems to interfere with each other, malfunction, or fail entirely.",
      "impact": "Resource exhaustion on a virtualization host can lead to a Denial-of-Service (DoS) condition where hosted virtual systems become unresponsive or crash. This can also result in data corruption (loss of Integrity) if systems cannot write data correctly during a failure. The overall effect is the disruption of business processes that rely on these virtual systems.",
      "action": "Implement Capacity Planning and Resource Monitoring for Virtualization Platforms",
      "mitigation": "Implement a robust capacity planning and management process for all virtualization platforms, considering the peak resource needs of all hosted systems. Use monitoring tools to track resource utilization (CPU, RAM, storage, network I/O) and configure alerts for when predefined thresholds are approached. Avoid excessive over-commitment of resources unless the workload characteristics are well-understood and actively managed. If a comprehensive capacity management or auto-scaling solution is in place, tag the corresponding `Shared-Runtime` component in the model with `mitigation:capacity-management-in-place` or `mitigation:auto-scaling-resources` to acknowledge this mitigation.",
      "check": "Is there a documented capacity management process for virtualization platforms? Are resource utilization levels actively monitored with alerting? Is there a policy regarding resource over-commitment?",
      "asvs": "BSI IT-Grundschutz G 0.4 (Unzureichende Ressourcen) in Baustein OPS.1.1.2 (Virtualisierung)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_2_Virtualisierung_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for every `Shared-Runtime` component identified in the model, as it represents a virtualization host or platform where multiple technical assets share common underlying physical resources, creating a potential for resource contention. The risk's severity increases with the number and criticality of the assets running on the shared platform.",
      "riskAssessment": "The likelihood is considered 'Likely' and increases with the number of systems sharing a runtime, as this increases complexity and the potential for unforeseen resource contention. The impact is determined by the highest availability and integrity requirements of all virtual systems running on the host. If a mission-critical system is hosted, the impact is considered 'Very High'.",
      "falsePositives": "This risk might be considered a false positive if the underlying virtualization platform is a managed service with effectively limitless, auto-scaling resources (e.g., a large-scale cloud provider) or if a very robust capacity management process is in place, which might not be fully captured in the threat model. In such cases, applying a mitigation tag is recommended.",
      "cwe": "770",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "91_sec4.ts",
      "bsiCode": "SYS.1.5",
      "id": "improper-vm-snapshot-handling",
      "title": "Risks of Improper Virtual Machine Snapshot Handling",
      "description": "A snapshot can freeze and save the state of a virtual machine. If such a snapshot is restored at a later point in time, all changes made in the meantime are lost. This can also reopen security vulnerabilities that have already been patched. Furthermore, inconsistent data can arise from open files, file transfers, or database transactions at the time of the snapshot. In addition, snapshots can be misused in attacks to gain unauthorized access to the data of a virtual IT system, because if the snapshot was created during operation, the contents of the main memory were also saved to the hard disk and can be restored and analyzed in a virtual environment outside the original IT infrastructure. Likewise, snapshots can become very large, causing available storage capacity to become scarce.",
      "impact": "Improper handling of VM snapshots can lead to severe security incidents. Restoring old snapshots can re-introduce critical vulnerabilities, undoing security patches and exposing the system to known exploits (Integrity loss). Snapshots of running systems capture memory contents, which can be analyzed offline by an attacker to extract secrets like keys, passwords, and sensitive data (Confidentiality loss). The process can also lead to data corruption if taken during active transactions (Integrity loss). Finally, an accumulation of large snapshots can exhaust storage resources, leading to a denial of service (Availability loss).",
      "action": "Implement and Enforce a Snapshot Lifecycle Management Policy",
      "mitigation": "Implement a formal snapshot management policy that treats snapshots as temporary, short-term mechanisms (i.e., not as backups). Delete snapshots promptly after their purpose is fulfilled (e.g., post-patch validation). Use automation to enforce snapshot lifecycle policies (creation, deletion, and alerting). Secure the underlying datastore where snapshots reside with strict access controls and consider encryption-at-rest for the snapshot files. To prevent data inconsistency, applications and filesystems should be quiesced before a snapshot is taken. To mitigate data leakage from memory dumps, avoid storing long-lived secrets in the memory of virtual machines where possible. Continuously monitor storage capacity to prevent availability issues.",
      "check": "Is there a formal policy for VM snapshot lifecycle management? Are snapshots regularly audited and deleted? Is the storage for snapshots secured and monitored? Are applications quiesced before snapshots are created for data consistency?",
      "asvs": "BSI IT-Grundschutz CON.6 Virtualization",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Virtualization_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for all technical assets configured to run on virtual machines (`machine: virtual`). The risk is especially high for VMs that process or store sensitive data, as their memory contents (captured in snapshots) and data state are valuable targets.",
      "riskAssessment": "The likelihood of exploitation is considered 'likely' by default, as snapshot mismanagement is a common operational oversight. The impact is directly derived from the Confidentiality, Integrity, and Availability ratings of the virtualized asset and the data it handles. A VM handling 'strictly-confidential' data will have a 'high' or 'very-high' impact, as an attacker could extract this data from a snapshot's memory dump.",
      "falsePositives": "The risk may be overstated if the organization has strong, externally enforced snapshot management policies (e.g., via a cloud provider's governance tools) that are not reflected in the model tags. Some virtualization platforms also offer features to create snapshots without including memory content, which would reduce the confidentiality risk.",
      "cwe": "524",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "91_sec5.ts",
      "bsiCode": "SYS.1.5",
      "id": "single-point-of-failure-virtualization-management-server",
      "title": "Single Point of Failure: Virtualization Management Server (BSI)",
      "description": "Since all functions of a virtual infrastructure are controlled and administered via the management server, a failure of this management system means that no configuration changes can be made to the virtual infrastructure.",
      "impact": "A failure of the central management server leads to a significant degradation of operational capabilities. While existing virtual systems may continue to run, the inability to manage, reconfigure, or recover them can quickly escalate into major service disruptions, especially in dynamic environments. This directly impacts the overall availability of the services hosted on the virtual infrastructure.",
      "action": "Ensure High Availability for the Virtualization Management Server",
      "mitigation": "The virtualization management server should be designed for high availability. This can be achieved through clustering, failover mechanisms, or redundant instances. The asset should be marked as `redundant: true` in the model to reflect this mitigation. Regularly test failover procedures to ensure they work as expected.",
      "check": "Review the architecture of the virtualization management components. Is the technical asset responsible for managing the virtual infrastructure (e.g., a 'container-platform') configured redundantly? Is the `redundant` flag set to `true` for this asset in the model?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.4 Redundancy",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_4_Redundancy_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for technical assets that act as a central management component for a virtualized environment (e.g., technology 'container-platform') and are not marked as redundant (`redundant: false`). These assets represent a Single Point of Failure (SPOF) for the operational management of the infrastructure they control.",
      "riskAssessment": "The likelihood of failure for a non-redundant critical system is considered 'Likely' over its operational lifetime. The impact is 'High' or 'Very High' if the managed virtual systems have high availability requirements, as a failure of the management plane directly compromises the ability to ensure service continuity and disaster recovery.",
      "falsePositives": "The risk might be a false positive if redundancy is achieved through external means not captured in the model (e.g., a cloud provider's managed service that guarantees high availability implicitly) and the `redundant` flag was not set.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "91_sec6.ts",
      "bsiCode": "SYS.1.5",
      "id": "guest-tool-privilege-risk",
      "title": "High Privileges of Guest Tools in Virtual Machines",
      "description": "Guest tools (e.g., VMware Tools, VirtualBox Guest Additions) often run with very high privileges (SYSTEM/root) inside virtual machines.",
      "impact": "If this vulnerability is exploited, it can lead to a Denial-of-Service of the affected virtual machine. The most severe impact is a complete takeover of the virtualization host, which compromises the confidentiality, integrity, and availability of all other assets running on the same host.",
      "action": "Harden Virtualization Components and Keep Them Updated",
      "mitigation": "Regularly update both the guest tools within the virtual machine and the virtualization host platform itself to patch known vulnerabilities.",
      "check": "Are guest tools and the virtualization platform kept up-to-date with security patches? Is the virtual machine modeled as being part of a 'shared_runtime' representing the hypervisor?",
      "asvs": "BSI IT-Grundschutz SYS.1.3 Virtualisierung",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_3_Virtualization_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Finds all technical assets configured with `machine: virtual`. The risk is inherent to using virtualization with guest tools, as they require deep integration with the guest OS kernel.",
      "riskAssessment": "The impact is considered 'High' if the virtual machine itself processes or stores highly sensitive data. It escalates to 'Very High' if other critical assets are running on the same virtualization host (modeled as a shared_runtime), due to the risk of a host compromise.",
      "falsePositives": "This risk can be considered a false positive or of lower severity if strong compensating controls are in place, such as advanced EDR/sandboxing technologies within the guest, or if using virtualization technologies that do not rely on traditional privileged guest tools (e.g., certain micro-VM implementations).",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "91_sec7.ts",
      "bsiCode": "SYS.1.5",
      "id": "compromise-of-hypervisor",
      "title": "Compromise of Hypervisor (based on BSI)",
      "description": "The virtualization software (hypervisor) is the central component of a virtualization server.",
      "impact": "A successful compromise of the hypervisor grants an attacker full control over all hosted virtual machines.",
      "action": "Harden and Secure the Hypervisor Platform",
      "mitigation": "Apply security patches to the hypervisor promptly. Use a dedicated and isolated management network for the hypervisor.",
      "check": "Are hypervisor security patches applied in a timely manner? Is the hypervisor management interface isolated from production and user networks?",
      "asvs": "Derived from concepts in BSI IT-Grundschutz, particularly related to virtualization security (e.g., APP.3.1 Virtualisation). The core risk is about platform integrity.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Virtualization_Security_Cheat_Sheet.html",
      "detectionLogic": "Detects `shared_runtime` components tagged with `@Hypervisor` that run one or more `technical_asset`(s) of machine type `virtual`.",
      "riskAssessment": "The impact is determined by the highest Confidentiality, Integrity, and Availability of any virtual machine running on the hypervisor, as a compromise of the hypervisor compromises all running VMs.",
      "falsePositives": "This risk might be considered a false positive or accepted if the hypervisor is part of a fully managed service from a major cloud provider (e.g., AWS Nitro, Azure Hypervisor) where the customer has no direct control over patching or configuration.",
      "cwe": "653",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "92_sec1.ts",
      "bsiCode": "SYS.1.6",
      "id": "vulnerable-or-malicious-container-images",
      "title": "Vulnerable or Malicious Components in Container Images (based on BSI CON.8)",
      "description": "Containers are primarily created from pre-built images, which can be sourced from the internet or created in-house.",
      "impact": "Exploitation of vulnerabilities within a container can lead to a complete compromise of that asset. This can result in the loss of Confidentiality, Integrity, and Availability (CIA) for all data processed or stored by the container.",
      "action": "Implement Image Scanning and Lifecycle Management",
      "mitigation": "Use a dedicated container image vulnerability scanner within the CI/CD pipeline to detect known vulnerabilities in base images and application dependencies.",
      "check": "Are container images scanned for vulnerabilities before being deployed? Is there a defined policy for trusted image sources? Are base images regularly updated and applications rebuilt?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.8 (Containerisierung), particularly requirement CON.8.A4 (Prüfung von Images auf Schwachstellen).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_8_Containerisierung.html",
      "detectionLogic": "This risk is triggered for any technical asset running as a container (`machine: container`).",
      "riskAssessment": "The likelihood of this risk is considered high, especially for images based on third-party components (`custom_developed_parts: false`).",
      "falsePositives": "A risk might be flagged even if an effective image scanning process exists but is not documented in the model via the `@Control:image-vulnerability-scanner` tag.",
      "cwe": "937",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "92_sec2.ts",
      "bsiCode": "SYS.1.6",
      "id": "unprotected-container-administration",
      "title": "Unprotected Container Administration Interface (BSI CON.7.A12)",
      "description": "To manage container services on a host, administrative access is required. This access is often realized as services that can be addressed either locally (e.g., via sockets) or over the network.",
      "impact": "Successful exploitation allows an attacker to gain full administrative control over the container platform. This can lead to executing arbitrary commands, deploying malicious containers, stealing or modifying data within all containers, and causing a denial-of-service for all applications running on the host. This constitutes a complete compromise of the host and all its workloads.",
      "action": "Secure Container Administration Interfaces",
      "mitigation": "Enable strong authentication and authorization for all container management interfaces (e.g., Docker daemon API, Kubernetes API server).",
      "check": "Are all container platform management interfaces protected with strong, mandatory authentication? Is all administrative network traffic encrypted? Is network access to management interfaces restricted to a minimal set of trusted sources? Are file permissions on local management sockets properly restricted?",
      "asvs": "BSI IT-Grundschutz CON.7 Containerization, Requirement CON.7.A12 'Securing the management interfaces of containers and container images'",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_7_Containerisation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule targets technical assets of type 'Container Platform'. It identifies risks in two ways:",
      "riskAssessment": "The impact is rated 'Very High' as a compromise affects all containers and applications on the host. The likelihood is 'Very Likely' for unprotected network interfaces and 'Likely' for risks from co-located assets, as this requires an initial compromise of a neighboring container.",
      "falsePositives": "A risk might be generated for a container platform that has compensating controls (e.g., a hardware firewall) not modeled in Threagile. The distinction between a management node and a worker node might not be clear from the model, potentially leading to a risk being raised for a worker node where local access is less critical.",
      "cwe": "306",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "92_sec3.ts",
      "bsiCode": "SYS.1.6",
      "id": "container-resource-exhaustion-on-host",
      "title": "Container Resource Exhaustion on Host (BSI CON.7)",
      "description": "An individual container, if not properly resource-constrained, can consume an excessive amount of the host's resources (CPU, memory, I/O, PIDs). This can lead to a denial-of-service condition affecting other containers running on the same host, or even compromising the stability and availability of the host system itself (a 'Noisy Neighbor' attack).",
      "impact": "A successful exploitation of this vulnerability leads to a Denial of Service. This impacts the availability of all services running in containers on the affected host, as well as potentially the host system itself. Business processes depending on these services will be disrupted, potentially leading to financial loss.",
      "action": "Enforce Container Resource Limits",
      "mitigation": "Define and enforce strict resource quotas (CPU, memory, PID limits, I/O) for each container. This should be implemented at the container orchestrator level (e.g., Kubernetes LimitRanges, pod resource requests/limits) or via the container runtime configuration. Monitor resource usage continuously to detect and alert on abnormal consumption before it impacts the host. Consider using a tag like `resource-limits-applied` on the shared runtime or containers to denote mitigation.",
      "check": "Are resource limits (CPU, memory, PIDs) defined and enforced for all containerized assets running on a shared host? Is there active monitoring of container resource usage against their defined quotas?",
      "asvs": "BSI IT-Grundschutz CON.7.A12 Ressourcenbegrenzung von Containern (Resource limitation of containers).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_7_Containerisation_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is automatically detected whenever a 'Shared Runtime' hosts more than one technical asset of machine type 'Container'. In such a multi-tenant environment, one container can impact the availability of others if resource limits are not enforced.",
      "riskAssessment": "The impact is determined by the highest availability requirement of any containerized asset running on the shared host. A host running 'mission-critical' assets will result in a higher impact. The likelihood is considered 'likely' by default, as unconstrained resource usage is a common configuration oversight.",
      "falsePositives": "This risk might be a false positive if the underlying host or orchestrator implements strong resource isolation between tenants by default. The risk can be marked as mitigated or a false positive if explicit resource limits are confirmed to be in place for all containers on the host.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "92_sec4.ts",
      "bsiCode": "SYS.1.6",
      "id": "unrestricted-container-communication-con5",
      "title": "Unrestricted Container Communication (BSI CON.5)",
      "description": "All containers on a host are generally able to communicate with each other, with the host, and with any other hosts.",
      "impact": "Failure to restrict container communication can lead to lateral movement within the infrastructure, allowing a compromise to spread from one container to others or to the host system.",
      "action": "Implement Network Segmentation and Egress/Ingress Filtering for Containers",
      "mitigation": "For inter-container communication on the same host, implement fine-grained network policies to enforce a 'least privilege' communication model, ensuring containers can only communicate with intended endpoints. In a Threagile model, this can be represented by placing communicating containers inside a 'Network Policy Namespace Isolation' trust boundary.",
      "check": "Are containers running on the same host isolated from each other via network policies? Are internal-only container services prevented from being accessed externally? Is there a default-deny policy for container ingress and egress traffic?",
      "asvs": "BSI IT-Grundschutz CON.5 Containerisation",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Containerisation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks for two conditions based on BSI CON.5:",
      "riskAssessment": "The likelihood of exploitation is considered 'likely' for unsegmented hosts and 'very-likely' for exposed internal services, as they are often less hardened. The impact is calculated based on the highest Confidentiality, Integrity, and Availability (CIA) ratings of the affected container assets. A compromise of a host running mission-critical services will result in a high-impact risk.",
      "falsePositives": "A model might not explicitly include a `NetworkPolicyNamespaceIsolation` trust boundary even if one exists in the real implementation, leading to a false positive. Similarly, a service tagged as `@Visibility:internal` might be intentionally exposed for a specific, justified reason not captured in the model.",
      "cwe": "923",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "92_sec5.ts",
      "bsiCode": "SYS.1.6",
      "id": "container-breakout",
      "title": "Container Breakout (BSI)",
      "description": "If it is possible to execute custom code within a container, an attacker may be able to overcome the container's isolation",
      "impact": "A successful attack could allow an attacker to gain control of the host system or other systems in the infrastructure.",
      "action": "Harden Container Host, Runtime, and Images",
      "mitigation": "Harden the host system by using a minimal, container-optimized OS and keeping the kernel and all system components patched.",
      "check": "Are host systems and kernels regularly patched? Are minimal host OS images used? Are security profiles like Seccomp and AppArmor enforced?",
      "asvs": "BSI IT-Grundschutz APP.4.4.A12 (Hardening the host operating system) and APP.4.4.A13 (Hardening the container engine).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_Containerisation_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is generated for every technical asset modeled to run inside a 'container' (`machine: container`).",
      "riskAssessment": "The impact is calculated based on the highest Confidentiality, Integrity, and Availability (CIA) ratings of *all* assets running on the same host",
      "falsePositives": "The risk might be mitigated by advanced sandboxing technologies (e.g., gVisor, Kata Containers) or exceptional host hardening and runtime",
      "cwe": "668",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "92_sec6.ts",
      "bsiCode": "SYS.1.6",
      "id": "improper-container-shutdown",
      "title": "Improper Container Shutdown (BSI CON.6)",
      "description": "When managing containers, they can be shut down without giving the software running inside an opportunity to complete its current processes, such as writing data (i.e., a non-graceful shutdown). If data is being processed by the container at that moment, it will be lost. Data stored persistently within the container can also be permanently lost or corrupted this way.",
      "impact": "A non-graceful shutdown of a container can lead to data loss or corruption, directly impacting the Availability and Integrity of the information being processed or stored. This can cause inconsistent application states, disrupt business processes, and lead to the permanent loss of critical data.",
      "action": "Ensure Graceful Container Shutdown",
      "mitigation": "Applications running within containers must be designed to handle termination signals (like SIGTERM) gracefully. This involves saving state, finishing critical operations, and closing connections before exiting. The container orchestration platform (e.g., Kubernetes) must be configured with an adequate `terminationGracePeriodSeconds` to allow applications enough time to shut down cleanly. Avoid using forceful termination commands (like `kill -9` or `docker kill`) in automated scripts or manual operations unless absolutely necessary.",
      "check": "Does the application inside the container handle SIGTERM signals to perform a graceful shutdown? Is the container platform's grace period configured appropriately for the application's needs? Are operational procedures in place to avoid forceful container termination?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Containerization). Also relates to Kubernetes best practices for Pod termination lifecycle.",
      "cheatSheet": "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-termination",
      "detectionLogic": "This risk is raised for any technical asset identified as a container (`machine: container`) that processes or stores data. The risk is higher for custom-developed applications, as they are more likely to overlook implementing graceful shutdown procedures.",
      "riskAssessment": "The impact of this risk is determined by the highest Availability and Integrity rating of the data assets processed or stored by the container. A higher rating leads to a higher impact. The likelihood is considered higher for custom-developed parts, as off-the-shelf software often has more robust lifecycle handling. An improper shutdown of a container processing mission-critical data constitutes a very high-impact risk.",
      "falsePositives": "A model cannot determine if the application code within a container correctly handles termination signals. Therefore, this risk may be flagged even if the application is implemented correctly. This must be verified by a code review or by checking the application's documentation and operational behavior.",
      "cwe": "404",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "92_sec7.ts",
      "bsiCode": "SYS.1.6",
      "id": "hardcoded-credentials-in-container-environment",
      "title": "Hard-coded or Insecurely Stored Credentials in Container Environment",
      "description": "The principles of building and creating images for containers require that access data, such as database credentials, are available in the container. This access data can fall into unauthorized hands through the images themselves, the scripts used to create the images (e.g., Dockerfiles), the version control of the scripts, or unencrypted runtime environment variables. This poses a significant risk of confidentiality loss for these sensitive credentials.",
      "impact": "If credentials for sensitive systems like databases are compromised, an attacker can gain unauthorized access. This can lead to the theft of sensitive data (confidentiality breach), unauthorized modification or deletion of data (integrity breach), and potential disruption of dependent services (availability impact).",
      "action": "Use a Secure Secrets Management Solution for Containers",
      "mitigation": "Do not hard-code credentials or other secrets in container images, Dockerfiles, or any files checked into version control. Avoid passing secrets as plaintext environment variables. Instead, use a dedicated secrets management solution (like HashiCorp Vault, AWS Secrets Manager, Azure Key Vault) to inject secrets securely into containers at runtime. Utilize the native secret management capabilities of your container orchestrator (e.g., Kubernetes Secrets, Docker Swarm Secrets) and ensure they are properly configured for production use (e.g., with RBAC, encryption at rest).",
      "check": "Review Dockerfiles and related build scripts for hard-coded credentials. Check source code repositories for committed secrets. Verify that secrets are not passed as plaintext environment variables in deployment configurations. Confirm that a secrets management tool or a platform-native secret object is used to provide credentials to the container at runtime.",
      "asvs": "V6.4.2: Verify that credentials and other secrets are not hard-coded in the source code but are stored in a secure location, such as a managed secrets store.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for any technical asset of type 'container' that has a communication link to a 'database' (or similar data-store technology) and does not show evidence of using a secure secrets management solution. Evidence for mitigation is either a communication link to a 'vault' or 'HSM' asset, or the container asset being tagged with `@secrets-management:injected`.",
      "riskAssessment": "The likelihood of this vulnerability is considered high if a containerized application requires database credentials, as it's a common anti-pattern to handle them insecurely without explicit controls. The impact is directly derived from the confidentiality and integrity rating of the data stored in the target database. A breach of credentials for a database holding 'Strictly Confidential' data results in a 'Very High' impact.",
      "falsePositives": "This risk can be a false positive if secrets are securely managed and injected at runtime through a mechanism not modeled, such as a custom sidecar injector or an external process not represented by a 'vault' asset. In such cases, the risk can be mitigated by adding the tag `@secrets-management:injected` to the container asset.",
      "cwe": "798",
      "function": "RiskFunction.Development",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "92_sec8.ts",
      "bsiCode": "SYS.1.6",
      "id": "loss-of-control-via-cicd",
      "title": "Loss of Control over Deployed Components in Container Environments",
      "description": "In contrast to traditional installations managed by IT operations, where control over deployed applications, components, and services lies entirely with the operations team, this control is lost in automated environments like CI/CD pipelines deploying to container platforms.",
      "impact": "If developers can deploy unvetted components and their dependencies directly into a production or production-like environment, there is a high risk of introducing vulnerabilities, malware, or non-compliant software. This can lead to data breaches, system instability, and a loss of the overall security posture, compromising the confidentiality, integrity, and availability of the services running on the platform.",
      "action": "Implement Governance and Security Gates in CI/CD Pipelines",
      "mitigation": "To mitigate the loss of control, implement robust security gates within the CI/CD pipeline. This includes Static Application Security Testing (SAST), Software Composition Analysis (SCA) to check for vulnerable dependencies, and container image scanning.",
      "check": "Is there a CI/CD pipeline that can deploy directly to a container platform? Are security checks like SAST, SCA, and image scanning integrated as mandatory gates in the pipeline? Does the container platform use an admission controller to enforce security policies (e.g., block images with critical vulnerabilities)? Are all deployed images cryptographically signed and verified before deployment?",
      "asvs": "V11.3 Build Pipeline Security",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/CI_CD_Security_Cheat_Sheet.html",
      "detectionLogic": "This risk is detected when a development-related asset (like a 'Build Pipeline') has a direct communication link to a 'Container Platform'. This indicates a CI/CD process where developers can push components directly, bypassing traditional operational controls.",
      "riskAssessment": "The likelihood is considered high by default, as this deployment model intentionally cedes control to development teams. The impact is determined by the highest sensitivity (CIA ratings) of all containerized applications that are running on the affected platform, as a compromise could affect any or all of them.",
      "falsePositives": "A model might show a direct deployment link, but in reality, the CI/CD pipeline or container platform has strong, non-bypassable security gates (like mandatory vulnerability scans or admission controllers) that are not represented in the model. Such cases can be considered false positives if the controls are deemed effective.",
      "cwe": "1127",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "93_sec1.ts",
      "bsiCode": "SYS.1.7",
      "id": "insecure-zos-configuration",
      "title": "Insecure z/OS Configuration (BSI APP.4.4)",
      "description": "The configuration of a z/OS operating system is highly complex and requires intervention by system administrators in many areas.",
      "impact": "An insecurely configured z/OS system can allow attackers to bypass essential security controls, leading to unauthorized access,",
      "action": "Secure Configuration and Hardening of z/OS",
      "mitigation": "Implement and enforce a strict security baseline for the z/OS configuration based on vendor best practices and established hardening guides.",
      "check": "Is the z/OS system configured according to a documented security baseline? Is access to critical system datasets tightly controlled?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein APP.4.4 (z/OS) Requirement APP.4.4.A19 (Secure Configuration of z/OS).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Bausteine/APP_4_4_z_OS.pdf?__blob=publicationFile",
      "detectionLogic": "This risk applies to any technical asset identified as a mainframe, as the complexity of z/OS configuration is inherent.",
      "riskAssessment": "The likelihood is considered high due to the inherent complexity of z/OS, which makes manual configuration error-prone.",
      "falsePositives": "This risk might be considered a false positive if the organization can demonstrate mature, well-documented, and automated processes",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "93_sec2.ts",
      "bsiCode": "SYS.1.7",
      "id": "insecure-racf-default-configuration",
      "title": "Insecure Default RACF Configuration on z/OS (BSI-Style)",
      "description": "On a z/OS operating system, a specialized security system like RACF is responsible for user authentication and resource authorization.",
      "impact": "If unauthorized users can execute privileged system commands due to a weak RACF configuration, they can disrupt system stability (Availability),",
      "action": "Harden RACF Configuration",
      "mitigation": "The default RACF configuration must be comprehensively reviewed and hardened according to the principle of least privilege.",
      "check": "Is the technical asset a mainframe running z/OS? Has its RACF configuration been reviewed and hardened beyond the default state?",
      "asvs": "BSI IT-Grundschutz SYS.2.2 z/OS, specifically Requirement SYS.2.2.A25 (Appropriate Configuration of the Security System under z/OS)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_2_2_z_OS_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset of technology type 'Mainframe' that is also tagged with `racf-unhardened`.",
      "riskAssessment": "The likelihood is considered 'Likely' if the default configuration is in use, as default weaknesses are often well-documented and targeted.",
      "falsePositives": "This risk can be considered a false positive if the 'racf-unhardened' tag has been applied incorrectly to an already hardened system, or if there are",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "93_sec3.ts",
      "bsiCode": "SYS.1.7",
      "id": "mainframe-maloperation-risk",
      "title": "Mainframe Maloperation Risk due to Complexity",
      "description": "Due to the inherent complexity of a z/OS operating system and its components, operational errors or misconfigurations by personnel cannot be entirely eliminated.",
      "impact": "A failure on a mainframe system due to maloperation or resource contention can lead to a significant denial-of-service for all dependent business applications.",
      "action": "Implement Robust Mainframe Monitoring, Training, and Operational Procedures",
      "mitigation": "Mitigation involves a combination of skilled personnel and technical controls: 1. Ensure mainframe operators are highly trained and have access to ongoing education.",
      "check": "Is there a dedicated, experienced mainframe operations team? Are operational runbooks available and regularly updated? Is automated monitoring for resource usage and contention in place?",
      "asvs": "Derived from BSI IT-Grundschutz methodology (related to operational reliability of complex systems). This risk is not directly covered by a single ASVS item but relates to operational security principles.",
      "cheatSheet": "https://www.ibm.com/docs/en/zos/latest?topic=zos-problem-management",
      "detectionLogic": "This risk is automatically raised for any technical asset identified as a 'Mainframe' (`TechnicalAssetTechnology.Mainframe`).",
      "riskAssessment": "The likelihood is considered 'Likely' due to the inherent complexity of the platform, as noted in the source text.",
      "falsePositives": "The risk might be overstated if the organization has a highly mature mainframe operations team with extensive experience, robust automation, and well-tested recovery procedures.",
      "cwe": "833",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "93_sec4.ts",
      "bsiCode": "SYS.1.7",
      "id": "unprotected-mainframe-interfaces",
      "title": "Unprotected Mainframe Interfaces",
      "description": "z/OS systems can be influenced and managed via a wide variety of interfaces, such as the Hardware Management Console (HMC), local and remote MCS consoles, automation processes, and remote maintenance access. If, for example, physical or logical access to these interfaces is insufficiently protected, unauthorized parties could manipulate the z/OS systems.",
      "impact": "Unauthorized manipulation of mainframe interfaces can directly compromise the integrity and availability of the entire system. This can lead to unauthorized system commands, shutdown of critical services, data tampering, or full system takeover, resulting in catastrophic business disruption and potential data breaches.",
      "action": "Secure All Mainframe Management and Access Interfaces",
      "mitigation": "Ensure all communication links to mainframe systems, especially those for management, automation, or remote access, use strong, state-of-the-art authentication (e.g., multi-factor authentication) and encrypted protocols (like SSH, FTPS, or HTTPS). Access should be strictly controlled and restricted via network segmentation, VPNs, or IP filtering where applicable. Authorization must be fine-grained and adhere to the principle of least privilege. Disable or remove any unused or legacy interfaces.",
      "check": "Review all incoming communication links for assets with `technology: mainframe`. Verify that each link uses an encrypted protocol and has an authentication method stronger than `none`. Check if access is further restricted by `vpn: true` or `ip_filtered: true` where the connection crosses a trust boundary.",
      "asvs": "Derived from the BSI IT-Grundschutz Catalog threat for z/OS systems (SYS.1.6 z/OS, Threat T 5.14 Manipulation of z/OS systems via unprotected interfaces).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_z_OS_edition_2022.html",
      "detectionLogic": "This rule inspects all incoming communication links to technical assets identified as mainframes (`technology: mainframe`). It triggers a risk if any link uses an unencrypted protocol or has authentication set to `none`, as these represent insufficiently protected interfaces.",
      "riskAssessment": "The likelihood of exploitation is significantly increased if there is no authentication. The impact is directly derived from the integrity and availability rating of the mainframe asset itself. A `mission-critical` mainframe that can be manipulated constitutes a `very-high` impact risk.",
      "falsePositives": "This risk can be considered a false positive if compensating controls that are not modeled (e.g., a physically separate and secured management network) are in place. However, the lack of encryption and authentication on the link itself remains a significant weakness.",
      "cwe": "306",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "93_sec5.ts",
      "bsiCode": "SYS.1.7",
      "id": "network-attack-on-zos",
      "title": "Network-based Attacks on z/OS Systems (BSI G 0.21)",
      "description": "z/OS mainframe systems connected to TCP/IP networks, especially those using Unix System Services, are exposed to common network-based attacks.",
      "impact": "Successful attacks can lead to Denial-of-Service (DoS) against critical mainframe services, unauthorized access to or manipulation of sensitive data in transit (Information Disclosure, Tampering),",
      "action": "Secure Network Communication and Access to Mainframe",
      "mitigation": "Enforce the use of encrypted protocols for all data exchange (e.g., HTTPS, SFTP, FTPS, LDAPS, JDBC-encrypted). Segment the network to isolate the mainframe from untrusted zones.",
      "check": "Review all communication links to the mainframe. Are unencrypted protocols like HTTP, FTP, LDAP, or plain JDBC used? Is the mainframe accessible from networks with lower trust levels without VPN or IP filtering?",
      "asvs": "BSI IT-Grundschutz: APP.4.4 z/OS, Threat G 0.21 Netz-Angriffe auf z/OS-Systeme",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_z_OS_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies assets with 'Mainframe' technology. It then inspects all incoming communication links for two primary weaknesses:",
      "riskAssessment": "The likelihood is high if unencrypted protocols are used across network boundaries or if access is not properly segmented.",
      "falsePositives": "A risk might be a false positive if compensating controls exist that are not modeled, such as a separate hardware encryption appliance securing the link, or if an 'unencrypted' protocol is running inside a secure,",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "93_sec6.ts",
      "bsiCode": "SYS.1.7",
      "id": "incorrect-character-set-translation-ebcdic-ascii",
      "title": "Incorrect Character Set Translation (EBCDIC-ASCII/Unicode)",
      "description": "EBCDIC, ASCII, and Unicode are character sets that define how letters, numbers, and other characters are represented using bits.",
      "impact": "Data corruption due to faulty character set translation compromises the integrity of the information. This can lead to incorrect data processing,",
      "action": "Ensure Correct and Validated Code Page Translation",
      "mitigation": "Ensure that all data exchange channels between EBCDIC-based systems (e.g., Mainframes) and ASCII/Unicode-based systems use correctly configured and validated code page translation tables.",
      "check": "Are code page translation tables explicitly defined and tested for all communication links between mainframes and other systems? Is there a process to validate data integrity after transfer? Are special characters handled correctly in test cases?",
      "asvs": "Derived from BSI IT-Grundschutz Catalog text concerning z/OS data exchange. This can be mapped to application security requirements like ASVS V4.0.3: 13.2.3",
      "cheatSheet": "https://www.ibm.com/docs/en/zos/2.5.0?topic=services-character-conversion",
      "detectionLogic": "This risk is raised for any communication link between a technical asset of technology 'Mainframe' and another asset that is not a 'Mainframe'.",
      "riskAssessment": "The likelihood is considered 'Likely' as this is a common and often overlooked interoperability problem. The impact is determined by the integrity requirement (criticality) of the data assets being exchanged. A high integrity requirement leads to a high impact.",
      "falsePositives": "This risk can be a false positive if the specific communication protocol or application layer transparently and correctly handles character set translation by default, or if the data exchanged is purely binary and does not require character translation.",
      "cwe": "176",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "94_sec1.ts",
      "bsiCode": "SYS.1.8",
      "id": "insecure-default-configuration-of-storage-components",
      "title": "Insecure Default Configuration of Storage Components (based on BSI guidance)",
      "description": "Storage components are often shipped with default configurations optimized for ease of use and broad functionality, not for security.",
      "impact": "Using storage components with insecure factory settings allows for easier unauthorized access. This can lead to service unavailability (Denial of Service),",
      "action": "Harden and Secure Storage Component Configuration",
      "mitigation": "Review and harden the configuration of all storage components before production use. Disable all unnecessary protocols and services (e.g., HTTP, Telnet, FTP).",
      "check": "Are storage components configured according to a security hardening baseline? Are all incoming communication links to datastores using encrypted protocols? Are default credentials changed?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.1.2: Databases, specifically requirements like SYS.1.2.A11 (Protection of management and administration interfaces) and SYS.1.2.A16 (Secure configuration of the database).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_Databases_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule checks for technical assets of type 'datastore' (like databases, file servers, block storage) that have incoming communication links using insecure, unencrypted network protocols.",
      "riskAssessment": "The likelihood is very high if an insecure protocol is actively used for access, as it allows for trivial interception of data and credentials.",
      "falsePositives": "The risk might be a false positive only if the communication occurs within a completely isolated, physically secured network segment where sniffing is considered impossible and other strong compensating controls are in place.",
      "cwe": "1188",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "94_sec2.ts",
      "bsiCode": "SYS.1.8",
      "id": "improper-san-segmentation-bridging-networks",
      "title": "Improper SAN Segmentation Bridging Networks (based on BSI)",
      "description": "A misconfigured Storage Area Network (SAN) can unintentionally bridge different network segments.",
      "impact": "This type of breach can bypass security and monitoring measures, such as firewalls or Intrusion Detection Systems (IDS),",
      "action": "Implement Strict SAN and Network Segmentation (Zoning)",
      "mitigation": "Ensure that Storage Area Networks are properly segmented using techniques like zoning (hardware-based) and LUN masking.",
      "check": "Is there a documented network architecture showing segmentation? Is SAN zoning and LUN masking implemented and regularly reviewed?",
      "asvs": "BSI IT-Grundschutz NET.1.1 Network architecture and design, particularly Requirement NET.1.1.A7 Requirements for network segmentation.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_1_Network_architecture_and_design_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is identified by finding data stores of type 'block-storage' (representing a SAN) that are connected to multiple assets.",
      "riskAssessment": "The likelihood of exploitation is considered high if an internet-facing component is connected to a shared SAN, as these components are primary targets for attackers.",
      "falsePositives": "The model might not differentiate between proper logical SAN zoning and a flat, unsegmented SAN fabric.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "94_sec3.ts",
      "bsiCode": "SYS.1.8",
      "id": "unencrypted-storage-replication",
      "title": "Unencrypted Storage Replication Traffic (based on BSI)",
      "description": "Storage-based replication methods are used to duplicate stored or archived data in real-time across a storage network for redundancy and to prevent data loss.",
      "impact": "If replication traffic is intercepted, the confidentiality of the duplicated data assets is compromised. This can lead to severe data breaches, regulatory fines, and loss of customer trust, especially if the data is sensitive.",
      "action": "Encrypt Replication Traffic",
      "mitigation": "Ensure that all communication links used for data replication between storage systems use a protocol that provides strong, state-of-the-art encryption.",
      "check": "Review all communication links between assets of type datastore, database, file server, block storage, etc. Verify that the protocol used is encrypted or the connection is flagged as being protected by a VPN.",
      "asvs": "V6.2.1 (Data-in-Transit Protection)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers for any communication link between two technical assets that typically store data (e.g., Database, FileServer, BlockStorage) if the link sends data and the protocol is not encrypted.",
      "riskAssessment": "The impact of this risk is determined by the highest confidentiality level of the data assets being sent over the unencrypted link.",
      "falsePositives": "This risk might be a false positive if the network link is physically isolated and secured (e.g., dedicated dark fiber) in a way that is not captured by the threat model's trust boundaries or VPN flags.",
      "cwe": "311",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "94_sec4.ts",
      "bsiCode": "SYS.1.8",
      "id": "wwn-iqn-spoofing-on-block-storage",
      "title": "Identifier Spoofing on Block Storage (WWN/IQN-Spoofing)",
      "description": "Storage Area Networks (SANs), especially Fibre Channel (FC) based ones, often use World Wide Names (WWNs) to manage and assign access rights, similar to how MAC addresses are used in Ethernet networks.",
      "impact": "Successful identifier spoofing leads to unauthorized access to sensitive data stored on the block storage system. This compromises data confidentiality and integrity. In a multi-tenant environment, the impact is magnified as it could lead to a cross-tenant data breach, causing significant financial, reputational, and legal damage.",
      "action": "Implement Strong Authentication for SAN/Block Storage Access",
      "mitigation": "Do not rely solely on identifiers like WWN or IQN for access control. Implement a strong, cryptographically-backed authentication protocol like Challenge-Handshake Authentication Protocol (CHAP) for all connections to the block storage system.",
      "check": "Are connections to block storage systems authenticated with methods stronger than just a plain identifier (e.g., is CHAP or a similar protocol used)? Are access controls within the SAN (zoning, LUN masking) configured to prevent unauthorized cross-system access?",
      "asvs": "BSI IT-Grundschutz CON.3.A12 (Zoning in a SAN). While zoning is a primary defense, it is vulnerable to WWN spoofing if not combined with stronger authentication.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_SAN_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule triggers on 'block-storage' datastores that have incoming communication links with authentication set to 'none'. Such a configuration implies that access control might rely solely on a spoofable identifier (like a WWN or IQN), which is a significant vulnerability.",
      "riskAssessment": "The impact of this risk is rated higher if the block storage system is multi-tenant or processes/stores data with high confidentiality or integrity requirements. The likelihood is considered 'likely' because the means to perform this attack are well-documented, and the lack of proper authentication in the model is a direct indicator of the vulnerability.",
      "falsePositives": "This risk might be a false positive if other, non-modeled controls are in place, such as strict port security on the SAN fabric switches that prevent identifier spoofing. However, relying on such controls without cryptographic authentication is not a robust defense.",
      "cwe": "287",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "94_sec5.ts",
      "bsiCode": "SYS.1.8",
      "id": "inadequate-vsan-separation-for-multi-tenancy",
      "title": "Inadequate Separation of Multi-Tenant Storage Networks (BSI NET.3.2.A5)",
      "description": "When the network structures of different tenants are separated by virtual storage area networks (VSANs) instead of physically separate networks, the information security of the institution can be compromised.",
      "impact": "A successful exploit of this weakness could allow an attacker who has compromised one tenant's environment to access, modify, or disrupt the data and services of other tenants. This violates tenant separation and can lead to major confidentiality and integrity breaches, service disruptions, and potential legal and contractual violations.",
      "action": "Implement Strong Logical and Cryptographic Tenant Separation",
      "mitigation": "Ensure that multi-tenant storage systems enforce strict separation between tenants at the network and data level. Use separate VLANs, network security groups, or similar network segmentation controls for each tenant's access path to the shared storage.",
      "check": "Is a multi-tenant storage system in use? How are the connecting client systems of different tenants logically separated from each other? Does the shared storage system have direct connections from assets in different trust boundaries? Are tenant-specific encryption keys being used?",
      "asvs": "BSI IT-Grundschutz NET.3.2: Separation and Partitioning of Networks, Requirement A5 (Logical network separation)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Separation_and_partitioning_of_networks_edition_2022.pdf?__blob=publicationFile",
      "detectionLogic": "This rule triggers on multi-tenant datastores (especially Block Storage or File Servers). It checks for incoming connections from client assets. A risk is identified if the client assets connecting to the same shared storage reside in different trust boundaries, as this indicates the storage is bridging distinct security zones without guaranteed separation, posing a cross-tenant access risk.",
      "riskAssessment": "The impact is determined by the highest confidentiality and integrity requirements of the data stored on the shared asset.",
      "falsePositives": "This rule might generate a false positive if the virtual storage system itself implements robust, cryptographically-enforced tenant separation that is not visible in the model's architecture. It can also be a false positive if the different trust boundaries are purely for organizational purposes and do not represent different levels of security or trust.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "94_sec6.ts",
      "bsiCode": "SYS.1.8",
      "id": "component-failure-in-storage-solution-sys1.6.t5",
      "title": "Component Failure in Complex Storage Solution (BSI SYS.1.6 T5)",
      "description": "Complex network-based storage solutions often consist of many interconnected components (e.g., Fibre-Channel switches, storage controllers, virtualization appliances). The failure of a single, non-redundant component can lead to the entire storage solution becoming unavailable or malfunctioning, threatening dependent applications.",
      "impact": "If a critical component of a storage solution fails, important applications relying on it may no longer work correctly. This can lead to significant disruptions in business operations, data corruption, or permanent data loss, thus compromising the Availability and Integrity of the stored information.",
      "action": "Implement Redundancy and High-Availability for Storage Components",
      "mitigation": "Ensure that the storage solution is designed for high availability by using redundant components (e.g., redundant controllers, power supplies, network paths) and robust failover mechanisms. The 'redundant' flag for the technical asset should be set to 'true'. Regularly test failover procedures. Implement and test robust backup and recovery strategies to mitigate the risk of data loss. Monitor the health of all storage components to predict and prevent failures.",
      "check": "Is the technical asset representing the storage solution marked as 'redundant: true' in the model? Is the solution designed with redundant components and tested failover mechanisms? Is there a comprehensive and tested backup and recovery plan?",
      "asvs": "BSI IT-Grundschutz SYS.1.6 Storage, Threat T 5.150 Failure of the storage solution.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_6_Storage_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for any technical asset identified as a storage solution that is not marked as redundant (`redundant: false`). Storage solutions include databases, file servers, block storage, data lakes, and other similar technologies.",
      "riskAssessment": "The likelihood of a service-impacting failure is considered 'Likely' for any complex, non-redundant system. The impact is directly related to the availability and integrity requirements of the asset and the data it stores. A failure of a storage system holding mission-critical data will have a 'Very High' impact.",
      "falsePositives": "This risk might be a false positive if redundancy is implemented at a higher level not captured in the model (e.g., application-level replication) or if the asset's `redundant` flag is incorrectly set to `false`.",
      "cwe": "755",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "94_sec7.ts",
      "bsiCode": "SYS.1.8",
      "id": "insufficient-physical-access-control-for-storage",
      "title": "Insufficient Physical Access Control for Storage System Components (BSI-style)",
      "description": "If there are insufficient or no physical access controls for the components of a storage system, an attacker could gain physical access to existing Fibre Channel (FC) SAN switches or connect additional unauthorized switches to the network.",
      "impact": "The goal of such an attack could be to access and modify the distributed zoning database, which controls storage access. This would allow the attacker to bypass logical access controls and gain unauthorized access to storage systems, compromising the confidentiality and integrity of the stored data.",
      "action": "Implement and Enforce Strict Physical Access Controls",
      "mitigation": "Ensure all storage system components, including SAN switches and storage arrays, are located in physically secure areas (e.g., locked server rooms, secure racks). Implement strict physical access controls with logging and monitoring. Network ports in unsecured areas should be disabled. Regularly audit physical security measures.",
      "check": "Are storage components in a locked, access-controlled room? Is physical access logged and monitored? Are unused physical network ports on switches disabled? Is there a formal procedure for authorizing physical access to the data center or server room?",
      "asvs": "BSI IT-Grundschutz INF.5.A6 (Zutrittskontrolle)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_and_cabinet_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for physical datastore assets (i.e., machine type 'physical') that are located in an environment with insufficient physical security. This is indicated by the custom tag '@PhysicalSecurity:insufficient' on the asset or its containing trust boundary. The risk is especially relevant for block-storage, file servers, and databases.",
      "riskAssessment": "The likelihood is high if the components are in an accessible or poorly monitored area. The impact is directly related to the confidentiality and integrity of the data stored on the system. Unauthorized physical access to a storage system holding strictly confidential data constitutes a very high impact.",
      "falsePositives": "The risk might be a false positive if the tag '@PhysicalSecurity:insufficient' is applied incorrectly, or if compensating controls (like data-at-rest encryption with key management that is physically and logically separate from the storage host) are in place but not modeled.",
      "cwe": "269",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "95_sec1.ts",
      "bsiCode": "SYS.1.9",
      "id": "usability-impairment-due-to-latency-or-overload",
      "title": "Usability Impairment due to Latency or Overload (BSI)",
      "description": "Applications provided by a central server (such as a terminal server or VDI environment) are used in real time. If the server's response to user input is noticeably delayed or the visual quality is poor, usability can be so limited that it equates to a service outage. This can be caused by constant high latency, unpredictable performance spikes, or insufficient network bandwidth leading to compression artifacts.",
      "impact": "High latency or server overload can prevent users from working efficiently with the provided applications, or at all. This constitutes a Denial-of-Service, directly impacting business continuity and productivity. It can lead to missed deadlines and financial loss if the affected applications are critical for business operations.",
      "action": "Implement Capacity Planning, Performance Monitoring, and Network Quality Assurance",
      "mitigation": "Ensure the server (CPU, RAM, storage) is adequately sized for the expected peak user load. Use load balancing for high numbers of users. Guarantee low-latency, high-bandwidth network paths between clients and the server. All intermediary components (e.g., VPN gateways, firewalls, reverse proxies) must be sized and configured to handle the traffic without introducing significant delay. Continuously monitor server resource utilization, network latency, and application responsiveness to proactively identify and resolve bottlenecks.",
      "check": "Are performance and capacity requirements for the service defined and tested? Is the server and network infrastructure monitored for performance bottlenecks (latency, packet loss, CPU/memory usage)? Are intermediary security gateways verified not to be a performance bottleneck under load?",
      "asvs": "Derived from BSI IT-Grundschutz Catalog threat descriptions for terminal servers (e.g., former `SYS.3.2.1 Terminal-Server`) and general threats like `G 0.35 Failure or disruption of communication networks` and `G 0.26 Failure of devices or systems`. This is primarily an operational availability risk.",
      "cheatSheet": "https://www.bsi.bund.de/EN/Topics/ITGrundschutz/itgrundschutz_node.html",
      "detectionLogic": "This risk is raised for server-type technical assets with high availability requirements that receive a significant number of connections from client-type assets. The likelihood increases if the server is not marked as redundant, is of a smaller size (e.g., 'component'), or if connections traverse network trust boundaries or VPNs, which can introduce latency.",
      "riskAssessment": "The impact is derived directly from the availability rating of the technical asset (from Medium for 'important' assets to Very High for 'mission-critical' ones). The likelihood is calculated based on a combination of factors: the number of concurrent clients, the server's specified size and redundancy, and the network complexity of the connections.",
      "falsePositives": "The risk can be a false positive if the architectural model does not accurately capture the real-world capacity of the server or the performance of the network. A component might be modeled with a small 'size' but run on highly performant, dedicated hardware. The model does not contain quantitative data on network bandwidth or latency.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "95_sec2.ts",
      "bsiCode": "SYS.1.9",
      "id": "terminal-server-availability-failure",
      "title": "Availability Failure in Terminal Server Environments",
      "description": "In a terminal server-based environment, applications are executed centrally, and their output is transmitted to the corresponding clients. If the terminal server is unavailable, no input can be processed, and the applications provided by it fail immediately. If clients receive their entire user interface from the terminal server, the IT system appears to have completely failed from the user's perspective.",
      "impact": "Failures of the network or the terminal server generally affect more than just individual clients. In many cases, numerous or even all clients of an institution depend on the terminal server. If the terminal server fails, a large number of clients are affected simultaneously, leading to widespread operational disruption.",
      "action": "Ensure High Availability for Central Components",
      "mitigation": "To mitigate the risk of a single point of failure, implement redundancy for the central terminal server asset. This can be achieved through clustering, load balancing, and failover mechanisms. Ensure that the network paths between clients and servers are also redundant. The technical asset in the model representing the terminal server should be marked as `redundant: true` to reflect these measures. Continuous monitoring of server health, resource utilization, and network connectivity is crucial for early detection of potential availability issues.",
      "check": "Is the technical asset acting as a terminal server designed for high availability (e.g., clustered, load-balanced)? Are network connections to the server redundant? Is the asset's `redundant` flag set to `true` in the model? Is there monitoring and alerting in place for availability events?",
      "asvs": "BSI IT-Grundschutz SYS.1.4 Terminalserver (classic)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/kompendium_archiv/kompendium_15_0.pdf?__blob=publicationFile (Classic BSI Compendium featuring SYS.1.4)",
      "detectionLogic": "This rule identifies non-redundant central technical assets (like Application Servers or virtual Desktops) that serve multiple clients. A failure of such an asset would constitute a single point of failure, causing a denial of service for all dependent clients.",
      "riskAssessment": "The impact of the risk is determined by the availability requirement of the central server asset itself. A 'mission-critical' server failure has a 'very-high' impact. The likelihood is considered 'likely' for any non-redundant central component, as hardware, software, or network failures are common operational occurrences. The risk is not generated if the server asset is marked as 'redundant'.",
      "falsePositives": "The rule might identify a standard application server as a 'terminal server' if it serves many clients, even if it's not used for desktop virtualization. However, the availability risk is still valid for any central, non-redundant component. The risk can be considered a false positive if high-availability measures are in place but not documented in the model via the `redundant: true` property.",
      "cwe": "400",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "95_sec3.ts",
      "bsiCode": "SYS.1.9",
      "id": "terminal-server-as-pivot-point-for-lateral-movement",
      "title": "Terminal Server as a Pivot Point for Lateral Movement (based on BSI T 5.150)",
      "description": "Terminal servers often host client-like applications (e.g., web browsers, office suites) for end users, giving them a lower level of intrinsic trust, similar to a standard client machine.",
      "impact": "An attacker gaining control over a terminal server can launch further attacks on other servers within the same network segment. This can lead to unauthorized access to sensitive data and critical backend services, potentially causing data breaches, service disruption, and compromise of the entire server environment.",
      "action": "Isolate Terminal Servers in a Dedicated, Restricted Network Segment",
      "mitigation": "Place terminal servers in their own dedicated network segment (DMZ or a specific 'Terminal Server Zone').",
      "check": "Review the network architecture diagram and firewall rule sets. Is the technical asset acting as a terminal server located in the same network trust boundary as other backend servers (e.g., databases, application services)? Are outbound connections from the terminal server restricted to only what is absolutely necessary?",
      "asvs": "ASVS V14.2.1: Verify that the system is deployed in an environment that has security controls to protect it from other applications on the same server and other servers in the same environment.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
      "detectionLogic": "This rule identifies technical assets tagged with `stereotype:terminal-server`.",
      "riskAssessment": "The likelihood of exploitation is considered 'Likely' because using a compromised system as a pivot point is a standard attacker technique.",
      "falsePositives": "This might be a false positive if strong, un-modeled compensating controls are in place, such as host-based firewalls on the terminal server or micro-segmentation at the hypervisor level that effectively isolates the assets despite them being in the same logical network zone.",
      "cwe": "923",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "95_sec4.ts",
      "bsiCode": "SYS.1.9",
      "id": "weak-isolation-in-shared-environment",
      "title": "Weak Isolation in Shared Environment (Terminal-Server-Style Risk)",
      "description": "When multiple applications or dedicated instances for different clients/tenants run on the same underlying operating system without strong isolation, there is a risk of security boundary traversal. This is common in classic terminal server or other multi-tenant environments where resources like the kernel, libraries, and file systems are shared.",
      "impact": "A successful exploit can lead to unauthorized information disclosure (e.g., reading data from another session's memory), tampering with data or system files, elevation of privilege by hijacking a higher-privileged session, and denial of service by exhausting shared resources (CPU, RAM). This compromises the Confidentiality, Integrity, and Availability of all assets hosted on the shared environment.",
      "action": "Enforce Strong Isolation and Hardening for Shared Environments",
      "mitigation": "Prefer using environments with strong kernel-level isolation, such as modern container platforms (e.g., Docker, Podman) or full virtualization (separate VMs), over simple shared-OS multi-tenancy. Apply the principle of least privilege to all user sessions and application service accounts, strictly limiting filesystem and resource access.",
      "check": "Are multiple applications from different tenants or trust levels running on a single shared OS? What isolation mechanisms are in place (e.g., containers, sandboxing, virtualization)? Are session permissions minimized? Is the host environment and all hosted software kept up-to-date with security patches?",
      "asvs": "V14.4 Configuration",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any 'Shared Runtime' that hosts more than one technical asset. The severity increases significantly if the assets have different sensitivity levels (CIA ratings) or if the environment is explicitly marked as multi-tenant, as a compromise of the weakest asset could lead to a breach of the most sensitive one.",
      "riskAssessment": "The impact is determined by the most sensitive data or critical function of any asset within the shared runtime. A breach of isolation affects the most valuable target.",
      "falsePositives": "This risk might be a false positive if the shared runtime technology, though abstractly modeled, implements strong, effective isolation that is not visible in the model (e.g., advanced SELinux policies, AppArmor profiles, or other sandboxing technologies).",
      "cwe": "668",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "95_sec5.ts",
      "bsiCode": "SYS.1.9",
      "id": "insecure-terminal-server-communication",
      "title": "Insecure Terminal Server Communication",
      "description": "Many terminal server protocols offer authenticated and encrypted communication. However, this is not always sufficient to secure the communication. If the protocol uses outdated and vulnerable mechanisms or if important security functions are disabled due to misconfigurations, the communication between clients and the terminal server can be intercepted. Additionally, vulnerabilities in the protocol implementation within the terminal server or client software may directly expose the server to attacks.",
      "impact": "Information transmitted between the terminal server and clients can be intercepted or altered. This includes authentication details, user input, screen content, clipboard data, and file transfers. This can lead to data breaches, session hijacking, and direct attacks on the terminal server itself, compromising confidentiality, integrity, and availability.",
      "action": "Ensure Secure Communication for Terminal Services",
      "mitigation": "Use strong, encrypted protocols (such as RDP with NLA, SSH, or HTTPS-based solutions) for all terminal service communication. Ensure protocols are configured to use modern, strong ciphers and algorithms. Disable legacy protocols and features (e.g., Telnet, unencrypted RDP). Keep both terminal server and client software up to date to patch implementation vulnerabilities. Consider adding security via VPNs or IP filtering as an extra layer of protection.",
      "check": "Is the communication protocol used for terminal access encrypted by default? Are outdated protocols disabled? Is the communication protected by a VPN? Are both server and client components regularly patched?",
      "asvs": "OWASP ASVS V4.0.3 - 8.1.1 (Verify that all communications to external services, or third-party services, are sent over a trusted and encrypted channel.)",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
      "detectionLogic": "Checks for communication links between client-type assets and terminal-server-like assets (e.g., Application Server, Desktop, Mainframe) that use an unencrypted protocol and are not protected by other means like a VPN.",
      "riskAssessment": "The likelihood is high if an unencrypted protocol is used across a network boundary. The impact depends on the sensitivity (CIA rating) of the terminal server and the data it processes. A server handling 'Strictly Confidential' data poses a much higher risk than one handling 'Public' data.",
      "falsePositives": "This risk might be a false positive if the communication is secured by an underlying mechanism not modeled, such as a separate hardware VPN tunnel or network-level IPSec that is not represented by the 'vpn: true' flag on the communication link.",
      "cwe": "319",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "95_sec6.ts",
      "bsiCode": "SYS.1.9",
      "id": "use-of-group-accounts-on-terminal-server",
      "title": "Use of Group Accounts on Terminal Server (based on BSI)",
      "description": "If multiple individuals need to use an application on a terminal server at different times, shared or group accounts are often set up.",
      "impact": "The inability to trace user actions (lack of non-repudiation) can hinder incident response, violate legal and compliance requirements (like GDPR), and obscure malicious or erroneous activities.",
      "action": "Enforce Individual User Account Authentication",
      "mitigation": "Ensure that every user accessing the terminal server authenticates with a unique, individual account.",
      "check": "Are group accounts used for interactive access to the terminal server? Can all actions performed on the server be unambiguously traced back to a specific individual?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Identity and Access Management), specifically Requirement ORP.4.A13 (Use of group accounts), which recommends avoiding group accounts where personal authentication is necessary.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
      "detectionLogic": "This risk is detected by identifying technical assets tagged as a `@Service:TerminalServer`.",
      "riskAssessment": "The likelihood is considered high because the model explicitly shows a lack of individual user identity propagation.",
      "falsePositives": "A false positive can occur if the model is inaccurate, for example, if an `enduser-identity-propagation` mechanism is in place but not correctly documented in the communication link's `authorization` field.",
      "cwe": "288",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "95_sec7.ts",
      "bsiCode": "SYS.1.9",
      "id": "overly-restrictive-terminal-server-config",
      "title": "Overly Restrictive Terminal Server Configuration Leading to Insecure Workarounds",
      "description": "A terminal server, or similar multi-user application host, can function as both a server and, for the applications running on it, a client.",
      "impact": "When essential tasks are blocked by overly restrictive policies, users may resort to insecure and unmonitored workarounds.",
      "action": "Balance Terminal Server Security Restrictions with User Experience and Functionality",
      "mitigation": "Review the configuration of terminal servers and similar application hosts to ensure that security restrictions do not impede essential business functions.",
      "check": "Are the access control policies on terminal-server-like assets reviewed for usability? Are there sanctioned and easy-to-use methods for data import/export that meet user needs?",
      "asvs": "Derived from BSI IT-Grundschutz principles for secure system operation. While not a direct ASVS web application requirement, it relates to the broader security principle of proper access control (ASVS V4.0.3 Chapter 4) and secure configuration.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for technical assets that function as multi-user application hosts (e.g., `application-server`, `desktop`) and are used directly by human clients.",
      "riskAssessment": "The likelihood is considered higher when sensitive data is being handled, as the pressure on users to complete their tasks may lead them to take greater risks.",
      "falsePositives": "This risk may be a false positive if the asset's configuration strikes a well-documented and effective balance between security and usability, or if all required user workflows are fully supported by secure, integrated features, obviating the need for workarounds.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "95_sec8.ts",
      "bsiCode": "SYS.1.9",
      "id": "insufficient-testing-of-terminal-server-compatibility",
      "title": "Insufficient Testing of Application Compatibility on Terminal Server / VDI (BSI SYS.3.2.2)",
      "description": "Not all applications can be deployed on any terminal server or virtual desktop infrastructure (VDI).",
      "impact": "Failure to ensure compatibility for hardware-dependent applications on a shared or virtualized platform can lead to a significant or total loss of availability for that application.",
      "action": "Thorough Compatibility Testing Before Deployment",
      "mitigation": "Before deploying an application with special hardware requirements (like GPU acceleration or specific peripherals) onto a terminal server, VDI, or other shared runtime,",
      "check": "Has the application been fully tested on the target terminal server or shared runtime environment?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.2.2 Terminalserver. This risk deals with ensuring the operational fitness of applications in a terminal server environment.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_Archiv/kompendium_15_0/sys/sys_3_2_2_pdf.pdf?__blob=publicationFile (BSI SYS.3.2.2)",
      "detectionLogic": "This risk is identified when a technical asset (the 'application') is modeled to run on a shared runtime (the 'terminal server' or 'VDI')",
      "riskAssessment": "The impact of this risk is directly related to the availability requirement of the application in question. If a 'Mission-Critical' application is unavailable, the impact is 'Very High'.",
      "falsePositives": "This risk can be considered a false positive if comprehensive compatibility testing has already been successfully completed and documented for the specific application on the specific target environment.",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "96_sec1.ts",
      "bsiCode": "SYS.2.1",
      "id": "malware-on-client-systems",
      "title": "Malware Infection on Client Systems (BSI DER.1)",
      "description": "Malware is designed to execute unwanted and malicious functions on IT systems, often operating covertly without the user's knowledge or consent. According to the BSI, clients are particularly vulnerable as they are often the primary entry point for malicious content via web browsing, emails, or removable media. Once a client is infected, malware can exfiltrate data, gain control of the system, and spread to other systems within the internal network.",
      "impact": "A successful malware infection on a client can lead to the compromise of confidentiality (e.g., theft of credentials and sensitive data), integrity (e.g., data manipulation, ransomware encryption), and availability (e.g., system crashes, denial-of-service). The infection can also serve as a beachhead for further attacks into the corporate network, escalating the potential damage significantly.",
      "action": "Implement Multi-Layered Endpoint Protection and User Awareness",
      "mitigation": "Employ a defense-in-depth strategy for clients. This includes centrally managed and up-to-date endpoint protection software (antivirus/EDR), application whitelisting, host-based firewalls, and regular security patching. Restrict user permissions to the minimum necessary. Implement web and email filtering to block malicious content at the gateway. Control the use of removable media. Complement technical measures with a continuous security awareness program for all users.",
      "check": "Are all client systems equipped with managed and updated endpoint security software? Are operating systems and applications regularly patched? Is the principle of least privilege enforced for user accounts? Are there technical controls for web, email, and removable media? Is there an active security awareness program?",
      "asvs": "BSI IT-Grundschutz: DER.1 Bedrohungen durch Schadprogramme, SYS.2.1 Allgemeiner Client",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Kompendium_Einzel_PDFs_2023/10_DER_Detektion_und_Reaktion/DER_1_Bedrohungen_durch_Schadprogramme_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is automatically detected for all technical assets identified as client systems (e.g., Browser, Desktop, Mobile App). The risk's likelihood and impact are elevated based on the client's internet connectivity and the sensitivity of the systems it communicates with.",
      "riskAssessment": "The likelihood of infection is considered high for internet-facing clients operated by humans. The impact is determined by the CIA requirements of the client itself, the data it processes, and the criticality of the backend systems it connects to. A client used to administer mission-critical systems poses a very-high impact risk.",
      "falsePositives": "The risk may be overestimated if the model does not capture specific hardening measures or compensating controls like a fully restrictive VDI environment or kiosk mode. Manual verification of the client's security posture is recommended.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "96_sec2.ts",
      "bsiCode": "SYS.2.1",
      "id": "exclusive-local-data-storage",
      "title": "Exclusive Local Data Storage",
      "description": "Despite contrary recommendations, important data is often stored exclusively locally, for example, in local file directories or email archives instead of on a central file server.",
      "impact": "Storing important data exclusively on local systems poses a significant risk to its availability and integrity.",
      "action": "Implement and Enforce Centralized Data Storage and Backup",
      "mitigation": "Establish and enforce a clear policy for storing all important institutional data on central, managed systems (e.g., file servers, databases, enterprise cloud storage).",
      "check": "Is there a policy mandating central storage for important data? Are suitable central storage systems available, known to users, and actively used?",
      "asvs": "Derived from BSI IT-Grundschutz CON.3 (Data Backup Concept) and APP.4.5 (Notebooks).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies client-type technical assets (e.g., desktops, mobile apps) that store important data locally but lack a modeled communication link to a central datastore (like a database or file server).",
      "riskAssessment": "The likelihood of a hardware failure or other loss event is considered 'Likely' over the lifecycle of a device.",
      "falsePositives": "A risk might be flagged if a backup or synchronization mechanism (e.g., a cloud sync client like OneDrive or Dropbox) is active on the client system but not represented as a communication link in the model.",
      "cwe": "668",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "96_sec3.ts",
      "bsiCode": "SYS.2.1",
      "id": "physical-damage-to-client-devices",
      "title": "Physical Damage to Client Devices (BSI T 0.15, T 0.16)",
      "description": "Unlike central IT systems like servers, users interact directly with client devices. This proximity means users might, intentionally or unintentionally, damage the device.",
      "impact": "If a client device is damaged, lost, or stolen, it cannot be used as intended until it is repaired or replaced, which directly impacts availability.",
      "action": "Implement Physical and Environmental Protection for Client Devices",
      "mitigation": "Use protective cases and screen protectors for mobile devices. Implement robust cable management to reduce tripping hazards.",
      "check": "Are there physical protection measures in place for client devices (e.g., laptop cases, secure workstations)? Is full-disk encryption enforced?",
      "asvs": "Derived from BSI IT-Grundschutz Threats T 0.15 (Failure or disruption of devices or systems) and T 0.16 (Destruction of devices or data media), often discussed in modules like OPS.1.2.2 (Laptops).",
      "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/IT-Grundschutz/IT-Grundschutz-Kompendium/it-grundschutz-kompendium_node.html",
      "detectionLogic": "This risk is triggered for all in-scope technical assets identified as client-type technologies using the 'isTechnologyClient' helper function.",
      "riskAssessment": "The impact is directly proportional to the Availability requirement of the asset and the work performed by its user.",
      "falsePositives": "This risk might be considered a false positive or have a lower likelihood if the client device is located in a highly controlled environment where user-induced physical damage is extremely improbable (e.g., a kiosk in a locked, protected enclosure).",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "96_sec4.ts",
      "bsiCode": "SYS.2.1",
      "id": "unauthorized-client-access-sys3.1",
      "title": "Unauthorized Client Access (BSI SYS.3.1)",
      "description": "Identification and authentication are intended to prevent unauthorized use of a client. However, IT systems requiring user ID and password authentication can still be used without authorization if an attacker manages to spy on or guess the credentials. If a screen lock is not activated, the client can also be used without authorization during brief absences.",
      "impact": "Unauthorized access to a client system can lead to theft of sensitive data (compromising confidentiality), manipulation of data or system functions (compromising integrity), and misuse of the system for further attacks within the network. This can result in financial loss, reputational damage, and breaches of legal or contractual obligations.",
      "action": "Enforce Strong Client Authentication and Automatic Screen Locking",
      "mitigation": "Enforce strong authentication mechanisms on all client systems, preferably Multi-Factor Authentication (MFA). Implement and enforce a strict password policy for complexity, rotation, and history where passwords are used. Configure all clients to automatically lock the screen after a short period of inactivity. Educate users about the risks of weak credentials, shoulder surfing, and social engineering attacks.",
      "check": "Is MFA required for client login? Is there a password policy in place and is it enforced? Are all client devices configured to auto-lock after a short period of inactivity? Are users trained on credential security?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.1 (Client under Windows), specifically Requirements SYS.3.1.A5 (Authentication at the client) and SYS.3.1.A6 (Screen lock).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_1_Client_under_Windows_Edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This risk applies to all in-scope technical assets identified as human-operated clients (e.g., technology types 'browser', 'desktop', 'mobile-app' and where the 'used_as_client_by_human' flag is set). The likelihood is determined by the authentication strength, which can be specified using the '@ClientAuthentication' tag. In the absence of this tag, a default risk of standard password-based authentication is assumed.",
      "riskAssessment": "The likelihood is HIGH for clients with no authentication or just a simple password. It is MEDIUM for clients with strong passwords but no MFA. It is LOW for clients enforcing MFA or biometric authentication. The impact is determined by the CIA rating of the client asset itself and the sensitivity of the data it processes or stores.",
      "falsePositives": "This rule might generate a false positive if the client authentication method is managed by an external Identity Provider and this is not reflected in the model via tags. The risk should be manually verified against the actual client configuration.",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "96_sec5.ts",
      "bsiCode": "SYS.2.1",
      "id": "unnecessary-software-on-client",
      "title": "Unnecessary Software on Client (BSI-Style Hardening Principle)",
      "description": "When installing an operating system, there is usually the option to install optional software.",
      "impact": "Exploiting a vulnerability in unnecessary and unpatched software can lead to a full compromise of the client system.",
      "action": "Implement Strict Software Installation Policies and Hardening",
      "mitigation": "Enforce a strict policy that only essential, approved software is installed on client systems.",
      "check": "Is there an application whitelisting solution in place on clients? Is there a formal process for approving and installing software?",
      "asvs": "Derived from general system hardening best practices, similar to CIS Benchmarks. It aligns with the principle of minimizing the attack surface.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
      "detectionLogic": "This risk applies to all in-scope technical assets identified as clients (e.g., desktops, mobile apps, developer clients).",
      "riskAssessment": "The likelihood of exploitation is higher for clients with internet access.",
      "falsePositives": "This risk can be a false positive if the organization has strong, enforced hardening policies that are not reflected in the model via tags.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "96_sec6.ts",
      "bsiCode": "SYS.2.1",
      "id": "unauthorized-eavesdropping-via-client-devices",
      "title": "Unauthorized Eavesdropping via Client Device Peripherals",
      "description": "Many client systems, including desktops, mobile devices, and IoT devices like Intelligent Personal Assistants (IPAs), are equipped with microphones and cameras.",
      "impact": "Unauthorized activation of microphones or cameras leads to a direct breach of confidentiality.",
      "action": "Harden Client Endpoints and Enforce Strict Access Control on Peripherals",
      "mitigation": "Implement a robust endpoint security policy for all client devices. This should include OS hardening, using endpoint detection and response (EDR) solutions, and strictly managing application permissions to access hardware like microphones and cameras.",
      "check": "Is there an endpoint security solution in place for all client devices? Are application permissions to use microphones and cameras regularly audited?",
      "asvs": "Derived from BSI IT-Grundschutz; similar concepts in OWASP MASVS (Mobile App Security) V8.1: 'The app does not use the microphone or camera for purposes not obvious to the user.'",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Mobile_App_Security_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any in-scope technical asset classified as a client-type technology (e.g., ClientSystem, MobileApp, IoTDevice) that is tagged as having a microphone or camera.",
      "riskAssessment": "The impact of this risk is directly proportional to the confidentiality of the information in the physical environment where the device is located. A device in a public area has a low impact, while one in a boardroom has a very high impact.",
      "falsePositives": "The risk might be a false positive if the device is located in a non-sensitive environment where no confidential information is ever discussed, or if the peripherals are verifiably physically disconnected.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "96_sec7.ts",
      "bsiCode": "SYS.2.1",
      "id": "misconfiguration-or-improper-use-of-client-system",
      "title": "Misconfiguration or Improper Use of Client System (BSI-Style)",
      "description": "Modern client operating systems are highly complex. Misconfigurations of components can significantly impair security, leading to system malfunctions or compromises.",
      "impact": "If this risk is exploited, an attacker could gain unauthorized access to the client system and any connected resources. This can lead to the compromise of",
      "action": "Harden and Secure Client System Configurations and Promote Secure User Practices",
      "mitigation": "Implement and enforce hardened standard configurations (baselines) for all client systems using configuration management tools like GPO or MDM.",
      "check": "Are there documented, hardened security baselines for all client operating systems in use? Is a centralized configuration management system (like GPO or MDM) in place to enforce these baselines?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.1 (Clients under Windows), SYS.3.2.1 (Clients under Linux), and SYS.3.3 (Clients under macOS). This risk consolidates the general threat of misconfiguration applicable to all client systems.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_1_Clients_under_Windows_edition_2023.pdf?__blob=publicationFile (BSI SYS.3.1 as an example)",
      "detectionLogic": "This risk is raised for all in-scope technical assets identified as client systems (e.g., desktops, mobile apps, browsers, etc.).",
      "riskAssessment": "The likelihood is considered high for internet-facing clients and medium for internal-only clients, assuming no specific hardening measures are modeled.",
      "falsePositives": "This risk might be a false positive if the client systems are already managed and hardened by robust, out-of-model processes (e.g., a mature corporate GPO/MDM environment).",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "97_sec1.ts",
      "bsiCode": "SYS.2.2.3",
      "id": "high-risk-profile-for-windows-systems",
      "title": "High Risk Profile for Windows Systems (BSI-based)",
      "description": "Due to the high prevalence of Windows operating systems and the backward compatibility often present between system generations,",
      "impact": "If this risk materializes, malware or unauthorized access can compromise the confidentiality, integrity, and availability of the system and the data it processes.",
      "action": "Implement Robust Hardening, Patch Management, and Endpoint Protection for Windows Systems",
      "mitigation": "Apply a defense-in-depth strategy for all Windows systems. This includes:",
      "check": "Are all Windows systems covered by a patch management process with defined SLAs? Is there a documented hardening standard for Windows systems that is actively enforced and audited?",
      "asvs": "BSI IT-Grundschutz: SYS.1.2 Windows Server, SYS.1.3 Windows Clients",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_Windows_Server_2019_Edition_2021.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for all in-scope technical assets identified as a Windows system via the `@OS:Windows` tag.",
      "riskAssessment": "The likelihood is considered high due to the large attack surface and the constant barrage of attacks targeting Windows vulnerabilities.",
      "falsePositives": "This generalized risk is rarely a complete false positive, as the external threat landscape for Windows is a given.",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "97_sec2.ts",
      "bsiCode": "SYS.2.2.3",
      "id": "uncontrolled-use-of-integrated-cloud-services",
      "title": "Uncontrolled Use of Integrated Cloud Services",
      "description": "Modern client operating systems like Windows often include deeply integrated cloud services (e.g., via a Microsoft Account) for data storage and synchronization.",
      "impact": "The uncontrolled use of integrated cloud services can lead to a breach of confidentiality and non-compliance with data protection regulations (like GDPR).",
      "action": "Restrict or Control Integrated Cloud Services via Central Management",
      "mitigation": "Use central management tools like Group Policy (GPO) or a Mobile Device Management (MDM) solution to disable or strictly control the use of integrated cloud services.",
      "check": "Are there GPO or MDM policies in place to control integrated cloud service usage? Are users prevented from using personal cloud accounts on corporate systems? Is the backup of sensitive information like BitLocker keys to unmanaged cloud accounts disabled?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Mobile Devices) and CON.3 (Clients under Windows 10/11), which recommend restrictive configuration of cloud services.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Clients_unter_Windows_10_und_11_Edition_2023.html",
      "detectionLogic": "This risk is inherent to many modern client operating systems. It is automatically detected for any 'Client System' or 'Desktop' technical assets that are not explicitly marked as having this risk mitigated.",
      "riskAssessment": "The likelihood is considered high for any unmanaged client system, as these cloud integrations are often default settings.",
      "falsePositives": "A risk might be flagged for a client system where the organization intentionally uses these cloud services under a managed corporate tenant with appropriate security controls.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "97_sec3.ts",
      "bsiCode": "SYS.2.2.3",
      "id": "software-incompatibility-on-os-upgrade",
      "title": "Software Incompatibility on OS Upgrade (based on BSI)",
      "description": "Software, especially older applications that were successfully operated on previous versions of an operating system, may not be compatible with current OS versions.",
      "impact": "If an application is incompatible with an OS upgrade, it can lead to a partial or complete loss of its functionality.",
      "action": "Establish and Execute an Application Compatibility Testing Process",
      "mitigation": "Before deploying major OS updates to production environments, critical applications must be tested for compatibility in a representative staging environment.",
      "check": "Is there a formal process for testing application compatibility before OS upgrades? Is there an up-to-date inventory of critical applications and their supported operating systems?",
      "asvs": "This is a platform-level configuration and lifecycle management issue, not directly covered by OWASP ASVS which focuses on web application security. The closest concept is ensuring a secure and stable operating environment.",
      "cheatSheet": "https://learn.microsoft.com/en-us/windows/deployment/planning/windows-10-deployment-plan",
      "detectionLogic": "This risk is raised for technical assets that are likely to be sensitive to underlying OS changes.",
      "riskAssessment": "The likelihood of this risk materializing is higher for applications explicitly marked as legacy or for older, complex COTS software.",
      "falsePositives": "This risk may be a false positive if the organization has a robust, consistently executed pre-deployment testing process or if the specific application is already confirmed to be compatible by the vendor. The risk serves as a prompt to verify that these operational controls are in place.",
      "cwe": "477",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "97_sec4.ts",
      "bsiCode": "SYS.2.2.3",
      "id": "windows-telemetry-data-leakage",
      "title": "Undesired Windows Telemetry Data Transmission",
      "description": "By default, Windows sends diagnostic data to the manufacturer, Microsoft. Additionally, Microsoft can specifically query information from a client via the integrated telemetry service.",
      "impact": "If sensitive data is exfiltrated via the telemetry service, it constitutes a confidentiality breach. This could lead to the exposure of business secrets, personal data, or other protected information, potentially resulting in legal, financial, or reputational damage.",
      "action": "Configure or Disable Windows Telemetry",
      "mitigation": "As part of the client hardening process, the level of diagnostic data sent to Microsoft should be explicitly configured and restricted.",
      "check": "Are Windows clients hardened to restrict telemetry data collection? Is the diagnostic data level explicitly set to a minimal required level (e.g., 'Security', 'Basic') via Group Policy or MDM? Are telemetry endpoints blocked at the network perimeter?",
      "asvs": "This is a platform/OS-level configuration risk, not directly covered by OWASP ASVS. It relates to secure system configuration and hardening, similar in spirit to BSI IT-Grundschutz's APP.4.4 (Clients).",
      "cheatSheet": "https://learn.microsoft.com/en-us/windows/privacy/manage-connections-from-windows-operating-system-components-to-microsoft-services",
      "detectionLogic": "This rule triggers for in-scope technical assets identified as Windows clients (e.g., technology 'desktop' or 'client-system' with the '@OperatingSystem: Windows' tag).",
      "riskAssessment": "The likelihood of data transmission is 'Frequent' as it is a default, continuous behavior of the operating system.",
      "falsePositives": "This risk can be a false positive if telemetry is controlled by other means not represented in the model (e.g., a network-level proxy blocking all telemetry endpoints), or if the specific Windows edition used (e.g., Enterprise LTSC) has different, more secure defaults.",
      "cwe": "200",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "97_sec5.ts",
      "bsiCode": "SYS.2.2.3",
      "id": "impaired-forensics-due-to-vsm",
      "title": "Impaired Forensics Due to Virtual Secure Mode (VSM)",
      "description": "The use of Virtual Secure Mode (VSM) restricts or complicates forensic investigations, for example, during security incident response. Processes protected by the Secure Kernel or Isolated User Mode (IUM) become inaccessible. For instance, memory dumps of these processes cannot be analyzed due to cryptographic measures, impeding the ability to investigate security incidents on the asset.",
      "impact": "This severely hinders the ability to conduct effective security incident response and forensic analysis. It can be impossible to determine the root cause of an incident, the extent of a compromise, or the actions taken by an attacker. This can lead to prolonged system downtime, incomplete remediation, and an inability to meet legal or compliance requirements for incident reporting and analysis.",
      "action": "Assess and Document Forensic Implications of VSM",
      "mitigation": "Before enabling VSM or similar hardware-based isolation technologies, perform a risk assessment. The benefits of process isolation must be weighed against the operational cost of impaired forensic capabilities. Ensure that alternative monitoring, logging, and detection mechanisms are in place to compensate for the loss of direct memory access (e.g., enhance application-level logging, network traffic analysis, or EDR solutions aware of VSM). Document the accepted risk and the compensatory controls.",
      "check": "Is VSM or a similar technology in use on the asset? If so, is there a documented risk assessment acknowledging the impact on forensics? Are there enhanced, alternative logging and monitoring controls in place for the protected components?",
      "asvs": "Derived from BSI IT-Grundschutz CON.8 (Incident Management and Response). The inability to perform forensics directly impacts the analysis and handling phase of an incident.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/CON_8_Incident_Management_and_Response_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "Detects technical assets that are explicitly tagged as having Virtual Secure Mode (VSM) enabled. The presence of this technology inherently complicates or blocks standard forensic procedures like memory analysis.",
      "riskAssessment": "The likelihood of forensic impairment is considered 'very-likely' if an incident occurs on a VSM-enabled system, as the impairment is a direct technical consequence. The impact is determined by the criticality (CIA rating) of the asset itself and the data it processes or stores. An inability to investigate a compromise of a mission-critical asset has a very high impact.",
      "falsePositives": "This risk can be considered a false positive if the organization has specific, VSM-aware forensic tools and documented procedures that provide equivalent visibility into protected processes, effectively mitigating the risk.",
      "cwe": "221",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Repudiation"
    },
    {
      "file": "98_sec1.ts",
      "bsiCode": "SYS.2.3",
      "id": "unauthorized-software-on-unix-systems",
      "title": "Unauthorized Software Installation on Unix-like Systems",
      "description": "On Unix-like IT systems, users might download and compile source code themselves or install pre-compiled packages from unverified third-party sources, bypassing official distribution repositories.",
      "impact": "The installation of untrusted software can introduce malware, leading to a complete compromise of the system's confidentiality, integrity, and availability.",
      "action": "Enforce Strict Software Installation and Sourcing Policies",
      "mitigation": "Restrict software installation privileges to authorized administrators only. Configure package managers to use only trusted, official repositories and verify package signatures.",
      "check": "Are user permissions configured to prevent unauthorized software installation? Are package manager repositories restricted to official, signed sources?",
      "asvs": "V14.2.5: Verify that third-party components are from a trusted source, have been securely transported, and have not been modified.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Software_Component_Verification_Cheat_Sheet.html",
      "detectionLogic": "This risk applies to technical assets identified as Unix-like systems, which are often targets for this type of compromise.",
      "riskAssessment": "The likelihood is high if non-administrative users have shell access and write permissions in their home directories on a multi-user system.",
      "falsePositives": "This risk might be a false positive if the model does not capture strong compensating controls.",
      "cwe": "829",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "98_sec2.ts",
      "bsiCode": "SYS.2.3",
      "id": "misuse-of-scripting-languages-on-unix-like-systems",
      "title": "Misuse of Scripting Languages on Unix-like Systems",
      "description": "On Unix-like operating systems, scripting languages (bash, sh, Python, Perl, Ruby, etc.) are powerful and deeply integrated.",
      "impact": "If an attacker can execute unauthorized scripts, they may compromise confidentiality, integrity, and availability of the entire client and surrounding infrastructure.",
      "action": "Lock Down Script Interpreters and Execution Paths",
      "mitigation": "Apply least privilege end-to-end. Remove or disable interpreters that are not strictly needed.",
      "check": "Are unnecessary interpreters removed? Are SELinux/AppArmor profiles enforcing and allow-listing script execution?",
      "asvs": "OWASP ASVS V14.2.1 (Command Injection) / BSI SYS.2.3 §2.2",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html | https://wiki.archlinux.org/title/Security | https://wiki.debian.org/Hardening | https://wiki.ubuntu.com/Security/Features",
      "detectionLogic": "Raised for in-scope technical assets tagged '@os:unix-like'. Likelihood is increased for internet-exposed assets.",
      "riskAssessment": "Likelihood is higher for internet-facing systems and unmanaged endpoints. Impact derives from the asset criticality and the sensitivity of processed/stored data.",
      "falsePositives": "May be a false positive if strong controls are demonstrably enforced (e.g., SELinux/AppArmor enforcing with minimal policy, 'sudo' with auditing/MFA, 'noexec/nodev/nosuid' on writable mounts,",
      "cwe": "78",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "98_sec3.ts",
      "bsiCode": "SYS.2.3",
      "id": "ld-preload-hijacking",
      "title": "Dynamic Linker Hijacking via LD_PRELOAD (BSI style)",
      "description": "On Unix-like systems, the LD_PRELOAD environment variable can force a user-specified shared library to load before any other library required by an application.",
      "impact": "Successful exploitation allows an attacker to execute arbitrary code with the permissions of the targeted application. This can lead to a complete compromise of the asset, including theft or manipulation of all data it processes (loss of Confidentiality and Integrity), disruption of its function (loss of Availability), and it can be used as a powerful mechanism for privilege escalation and persistence within the system.",
      "action": "Harden the Execution Environment and Use Process Execution Controls",
      "mitigation": "Restrict write permissions on directories where application binaries reside. Use security modules such as SELinux or AppArmor to create strict policies for which processes can execute and what environment variables they can use. Disable LD_PRELOAD system-wide if it is not required for any legitimate purpose (e.g., via /etc/ld.so.preload). Monitor process creation and associated environment variables for suspicious use of LD_PRELOAD. For critical applications, consider using statically linked binaries to avoid reliance on dynamic libraries.",
      "check": "Are file permissions on application binaries and system library paths properly restricted? Are mandatory access control systems (SELinux, AppArmor) in use to confine application behavior? Is process execution being monitored for unauthorized use of environment variables like LD_PRELOAD?",
      "asvs": "This is primarily a host-level configuration and security issue rather than a web application vulnerability as covered by OWASP ASVS. It relates to the principles in V14 Configuration, specifically V14.2.5 (Filesystem Permissions) and V14.4 (Dependency Integrity).",
      "cheatSheet": "https://www.netspi.com/blog/technical/linux-hacking/linux-privilege-escalation-using-ld_preload/",
      "detectionLogic": "This risk is relevant for any process-based technical asset running on a machine type that is susceptible to this attack (i.e., not serverless). The rule identifies assets running on physical, virtual, or containerized machines, as these environments can potentially be manipulated by an attacker with a foothold.",
      "riskAssessment": "The impact is directly proportional to the sensitivity of the asset and the data it handles. Code execution on an asset processing 'Strictly Confidential' data is a critical incident. The likelihood assumes an attacker has already gained initial access to the host system to set the environment variable. Internet-facing assets increase this likelihood as they represent a larger attack surface for gaining that initial foothold.",
      "falsePositives": "The risk might be flagged on an asset where the host operating system has other mitigating controls (e.g., a hardened kernel, strict AppArmor profiles) that are not visible in the threat model. Some specific developer or profiling tools might use LD_PRELOAD for legitimate purposes, which may need to be accepted.",
      "cwe": "506",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "98_sec3_openai.ts",
      "bsiCode": "SYS.2.3",
      "id": "ld-preload-hijacking",
      "title": "Dynamic Linker Hijacking via LD_PRELOAD (BSI style)",
      "description": "On Unix-like systems, the LD_PRELOAD environment variable can force a user-specified shared library to load before any other library required by an application.",
      "impact": "Successful exploitation allows an attacker to execute arbitrary code with the permissions of the targeted application. This can lead to a complete compromise of the asset, including theft or manipulation of all data it processes (loss of Confidentiality and Integrity), disruption of its function (loss of Availability), and it can be used as a powerful mechanism for privilege escalation and persistence within the system.",
      "action": "Harden the Execution Environment and Use Process Execution Controls",
      "mitigation": "Restrict write permissions on directories where application binaries reside. Use security modules such as SELinux or AppArmor to create strict policies for which processes can execute and what environment variables they can use. Disable LD_PRELOAD system-wide if it is not required for any legitimate purpose (e.g., via /etc/ld.so.preload). Monitor process creation and associated environment variables for suspicious use of LD_PRELOAD. For critical applications, consider using statically linked binaries to avoid reliance on dynamic libraries.",
      "check": "Are file permissions on application binaries and system library paths properly restricted? Are mandatory access control systems (SELinux, AppArmor) in use to confine application behavior? Is process execution being monitored for unauthorized use of environment variables like LD_PRELOAD?",
      "asvs": "This is primarily a host-level configuration and security issue rather than a web application vulnerability as covered by OWASP ASVS. It relates to the principles in V14 Configuration, specifically V14.2.5 (Filesystem Permissions) and V14.4 (Dependency Integrity).",
      "cheatSheet": "https://www.netspi.com/blog/technical/linux-hacking/linux-privilege-escalation-using-ld_preload/",
      "detectionLogic": "This risk is relevant for any process-based technical asset running on a machine type that is susceptible to this attack (i.e., not serverless). The rule identifies assets running on physical, virtual, or containerized machines, as these environments can potentially be manipulated by an attacker with a foothold.",
      "riskAssessment": "The impact is directly proportional to the sensitivity of the asset and the data it handles. Code execution on an asset processing 'Strictly Confidential' data is a critical incident. The likelihood assumes an attacker has already gained initial access to the host system to set the environment variable. Internet-facing assets increase this likelihood as they represent a larger attack surface for gaining that initial foothold.",
      "falsePositives": "The risk might be flagged on an asset where the host operating system has other mitigating controls (e.g., a hardened kernel, strict AppArmor profiles) that are not visible in the threat model. Some specific developer or profiling tools might use LD_PRELOAD for legitimate purposes, which may need to be accepted.",
      "cwe": "506",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "98_sec4.ts",
      "bsiCode": "SYS.2.3",
      "id": "conflicting-configurations-on-complex-systems",
      "title": "Conflicting Configurations on Unix-like Clients (BSI-based)",
      "description": "On Unix-like client systems, numerous applications are installed, each with its own configuration files.",
      "impact": "Conflicting configurations can cause unintended behavior, creating security vulnerabilities and operational issues.",
      "action": "Implement centralized configuration management and regular audits",
      "mitigation": "Utilize configuration management and infrastructure-as-code tools (e.g., Ansible, Puppet, Chef, Terraform) to enforce a consistent, conflict-free, and version-controlled configuration state.",
      "check": "Is a centralized configuration management system in use? Is there a documented, secure baseline configuration for the client?",
      "asvs": "Inspired by BSI IT-Grundschutz. Related to OWASP ASVS v4.0.3: 14.1 Configuration.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for technical assets that represent complex systems likely to have multifaceted configurations (e.g., application servers, databases, container platforms).",
      "riskAssessment": "The likelihood is higher for systems with a large number of applications or complex integration patterns (many communication links).",
      "falsePositives": "This risk may be a false positive if the system, despite its complexity, is managed by a robust, fully automated configuration management system designed to prevent or immediately detect such conflicts. Manual verification of operational practices is required.",
      "cwe": "16",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "99_sec1.ts",
      "bsiCode": "SYS.2.4",
      "id": "inadequate-nac-planning-net-3-1",
      "title": "Inadequate NAC Planning and Implementation (BSI NET.3.1)",
      "description": "If planning for a Network Access Control (NAC) solution is inadequate, for example due to an incomplete IT asset inventory or insufficient requirements analysis, significant security gaps can arise.",
      "impact": "A poorly implemented NAC solution can lead to Elevation of Privilege, allowing unauthorized access to sensitive network segments and data. It can also cause denial of service for legitimate users and systems.",
      "action": "Implement and validate a comprehensive Network Access Control (NAC) solution",
      "mitigation": "Ensure a complete and up-to-date IT asset inventory is maintained. Perform a thorough requirements analysis for the NAC solution, considering all relevant systems, protocols, and user roles.",
      "check": "Is there a complete inventory of all assets that require network access? Are strong, standardized authentication and authorization methods enforced for all connections that cross trust boundaries?",
      "asvs": "V14.2.3: Network-Layer Access Controls",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_1_Network_Access_Control_Edition_2023.pdf?__blob=publicationFile (BSI NET.3.1)",
      "detectionLogic": "This risk is identified by analyzing communication links that cross network trust boundaries. The risk is triggered when such a connection uses weak or no authentication or authorization, a strong indicator of an inadequate or misconfigured NAC.",
      "riskAssessment": "The likelihood of exploitation is high if authentication is missing entirely on a boundary-crossing link. The impact is determined by the Confidentiality, Integrity, and Availability (CIA) rating of the target asset and the data it processes or stores.",
      "falsePositives": "A risk might be flagged for a link that is protected by an intermediate security component (such as a WAF or IPS) not explicitly modeled in Threagile.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "99_sec2.ts",
      "bsiCode": "SYS.2.4",
      "id": "inadequate-endpoint-orchestration-for-nac",
      "title": "Inadequate Endpoint Orchestration for NAC (BSI NET.3.2)",
      "description": "A lack of—or inadequately implemented—endpoint orchestration tools, security policies, and resources can lead to poor integration of devices into a Network Access Control (NAC) solution.",
      "impact": "If unmanaged or poorly configured endpoints connect to the network, they can bypass security controls. This may lead to unauthorized access to sensitive network segments, the use of weak authentication credentials, and potential data breaches. It also increases the risk of compromised devices gaining a foothold in the internal network, potentially leading to elevation of privilege, information disclosure, and denial of service.",
      "action": "Implement centralized endpoint management and NAC integration policies",
      "mitigation": "Use a centralized orchestration tool (such as UEM or MDM) to manage all endpoints. Define and enforce security policies for different endpoint groups (e.g., corporate, BYOD, IoT).",
      "check": "Is a centralized endpoint orchestration tool (UEM/MDM) in use? Are security policies defined for different endpoint types? Is there a standardized onboarding process for new devices that includes NAC registration? Does the NAC enforce network segmentation based on endpoint identity and compliance status? Is strong authentication required for access to critical resources?",
      "asvs": "Derived from the BSI IT-Grundschutz Baustein NET.3.2 (Network Access Control)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Network_Access_Control_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is triggered for client-type technical assets (e.g., Desktop, MobileApp, IoTDevice) that are not explicitly marked as managed (e.g., via an `@EndpointManaged` tag).",
      "riskAssessment": "The likelihood is considered high if numerous unmanaged client devices can connect to the network. The impact is determined by the sensitivity (CIA ratings) of the assets they can reach. Access to mission-critical systems or strictly confidential data from an unmanaged device constitutes a very high impact.",
      "falsePositives": "The model might not include the endpoint management or orchestration system as a technical asset. An organization may have a robust endpoint management solution in place that is not reflected in the diagram, making this risk a false positive. Verification of operational processes and tools is required.",
      "cwe": "284",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "99_sec3.ts",
      "bsiCode": "SYS.2.4",
      "id": "insecure-wlan-or-nac-authentication",
      "title": "Insecure WLAN or Network Access Control (NAC) Authentication",
      "description": "If secure authentication methods for network access (such as EAP-TLS in an 802.1X environment) are not supported or enforced,",
      "impact": "An attacker could impersonate a legitimate client device and gain an initial foothold on an internal network segment.",
      "action": "Enforce Strong Network Authentication Protocols",
      "mitigation": "For 802.1X-based network access (wired or wireless), enforce strong EAP types such as EAP-TLS, which require both client and server certificates.",
      "check": "Is 802.1X deployed for network access? If so, which EAP types are permitted by the RADIUS server configuration?",
      "asvs": "Derived from BSI IT-Grundschutz Baustein NET.3.2 (WLAN Usage) and NET.1.1 (Network Architecture).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_WLAN_usage_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk triggers for communication links originating from client-type assets (e.g., mobile apps, desktops, IoT devices) that cross a network trust boundary",
      "riskAssessment": "The likelihood of exploitation is high when a weak authentication protocol is used for network access, as tools for such attacks are widely available.",
      "falsePositives": "A model might simply specify 'Credentials' as the authentication method even when a strong, password-based EAP protocol (like EAP-TTLS with a secure inner method)",
      "cwe": "290",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Spoofing"
    },
    {
      "file": "99_sec4.ts",
      "bsiCode": "SYS.2.4",
      "id": "misconfigured-nac-ruleset",
      "title": "Misconfigured NAC Ruleset",
      "description": "Due to human error, inadequate processes, or insufficient staffing that leads to time constraints,",
      "impact": "A misconfigured NAC solution can lead to two primary outcomes. First, it can cause a denial of service, where legitimate endpoints",
      "action": "Implement the four-eyes principle and auditing for NAC configuration changes",
      "mitigation": "All changes to the NAC ruleset (on RADIUS servers, access switches, etc.) must follow a documented change management process,",
      "check": "Is there a documented process for managing changes to NAC configurations? Are all changes subject to peer review? Are NAC configurations and access logs regularly audited?",
      "asvs": "BSI IT-Grundschutz: NET.3.2 RADIUS",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/NET/NET_3_2_RADIUS_Edition_2023.html",
      "detectionLogic": "Identifies technical assets that are central components of a Network Access Control system, such as RADIUS servers or enforcing access switches.",
      "riskAssessment": "The likelihood is considered 'Likely' due to the complexity of NAC systems and the high potential for human error in manual configurations.",
      "falsePositives": "This risk is reported for any asset tagged as a core NAC component. It may be considered a false positive if the organization has exceptionally robust,",
      "cwe": "284",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "99_sec5.ts",
      "bsiCode": "SYS.2.4",
      "id": "inadequate-change-validation-process",
      "title": "macOS Clients: Inadequate Change & Configuration Validation (BSI SYS.2.4 + OPS.1.1.5)",
      "description": "macOS client configurations (e.g., SIP, Gatekeeper, XProtect, FileVault, Personal Firewall, iCloud, Wi-Fi/Bluetooth/AirDrop/Continuity settings) require",
      "impact": "Poorly validated changes can lead to data exposure (e.g., iCloud sync of sensitive data), integrity issues (malicious content executed via preview features),",
      "action": "Harden macOS clients and enforce gated change validation with testing/approval before rollout.",
      "mitigation": "Define a formal change/configuration management workflow for macOS and related infrastructure: document every change; require peer/IS review; test in a",
      "check": "Is there a documented macOS baseline (SIP, Gatekeeper, XProtect, FileVault, firewall) and a policy for iCloud usage? Are changes tracked, reviewed, tested, and",
      "asvs": "BSI IT-Grundschutz: SYS.2.4 Clients unter macOS (A1, A2, A4–A12) and OPS.1.1.5 Change Management (esp. A5: testing/acceptance of changes).",
      "cheatSheet": "References: BSI SYS.2.4 (macOS hardening), BSI OPS.1.1.5 (Change Management), and NIST SP 800-179 Rev.1 (Securing Apple macOS).",
      "detectionLogic": "Organizational/process risk surfaced where configuration errors would have high impact. The rule flags in-scope technical assets that are either",
      "riskAssessment": "Likelihood defaults to 'Likely' due to common gaps in change validation. Impact scales with the asset’s CIA: assets with Confidential or Mission-Critical",
      "falsePositives": "If a robust, audited change process exists (e.g., enforced via MDM baselines, peer reviews, dedicated staging, full rollback, and evidence of approvals)",
      "cwe": "668",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "99_sec6.ts",
      "bsiCode": "SYS.2.4",
      "id": "insufficient-network-access-control-bsi-net-3-2",
      "title": "Insufficient Network Access Control (BSI NET.3.2)",
      "description": "If Network Access Control (NAC) is disabled—temporarily or permanently—or not implemented at network boundaries (e.g., switch ports), network access is insufficiently protected.",
      "impact": "Unauthorized network access can compromise the confidentiality, integrity, and availability of information assets.",
      "action": "Implement and enforce strong network access control",
      "mitigation": "Ensure that all network access points—especially those crossing trust boundaries—are protected by a robust NAC solution that authenticates and authorizes every device or user attempting to connect.",
      "check": "Do any communication links in the model cross a network trust boundary without authentication? Are VPNs or IP filtering used as compensating controls?",
      "asvs": "BSI IT-Grundschutz NET.3.2 Network Access Control, especially requirement NET.3.2.A2 (use of a NAC system). Also related to NET.1.1.A5 (controlling access to a LAN).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Network_Access_Control_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is detected by identifying communication links that cross a network trust boundary without any authentication (`authentication: none`).",
      "riskAssessment": "Likelihood is high whenever an unprotected entry point into a sensitive network exists.",
      "falsePositives": "A false positive may occur if a compensating control exists but is not modeled (e.g., a physical stateful firewall between the assets).",
      "cwe": "287",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "99_sec7.ts",
      "bsiCode": "SYS.2.4",
      "id": "nac-component-failure",
      "title": "Failure of Network Access Control (NAC) Components",
      "description": "An inadequately designed or implemented NAC architecture, malfunctioning NAC components, network disruptions, or denial-of-service (DoS) attacks can cause the failure or unavailability of central NAC components. This directly affects the ability of endpoints to communicate and can result in two critical failure modes, depending on how network enforcement points (e.g., switches, wireless access points) are configured.",
      "impact": "If an enforcement point is configured to 'fail-open', failure of the NAC component will grant unrestricted network access to connecting devices, bypassing segmentation controls. This can lead to severe Confidentiality and Integrity violations. If configured to 'fail-closed', failure will deny all network access, causing a denial of service that impacts the Availability of all dependent systems and business processes.",
      "action": "Implement a resilient NAC architecture and define failure modes",
      "mitigation": "Ensure high availability for all central NAC components (e.g., RADIUS servers) through redundancy (e.g., clustered servers). Explicitly define and implement the desired failure mode (fail-open vs. fail-closed) on all NAC enforcement points based on a thorough risk assessment for each network segment. Harden NAC components against DoS attacks. Continuously monitor the health and availability of all NAC components and the underlying network infrastructure.",
      "check": "Are central NAC components designed and deployed in a highly available, redundant configuration? Is the failure mode (fail-open/fail-closed) explicitly configured on all network enforcement devices? Is the health of all NAC components actively monitored with alerting?",
      "asvs": "V14.2.1: Verify that all networked components—including servers, workstations, and network devices—are securely configured.",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_1_Switches_and_routers_edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This rule identifies technical assets tagged `@NAC-Component:true` that are non-redundant. It then checks for direct communication links to network devices tagged with `@NAC-Enforcement-Point:fail-open` or `@NAC-Enforcement-Point:fail-closed`. Based on the enforcement point's configuration, it generates a specific risk for either Elevation of Privilege (unrestricted access) or Denial of Service (loss of access).",
      "riskAssessment": "The likelihood is considered high if a critical NAC component is not configured redundantly. The impact is determined by the failure mode. For 'fail-open', impact is based on the highest Confidentiality/Integrity of assets within the compromised network zone. For 'fail-closed', impact is based on the highest Availability requirement of the assets that would lose connectivity.",
      "falsePositives": "This risk may be a false positive if redundancy is achieved through mechanisms not represented in the model (e.g., cloud-native load balancing, DNS failover) or if the tagged component is not actually critical for network access.",
      "cwe": "285 // CWE-285: Improper Authorization (for fail-open). The risk for fail-closed (DoS) is better described by CWE-703.",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "99_sec8.ts",
      "bsiCode": "SYS.2.4",
      "id": "inadequate-protection-of-log-data",
      "title": "Inadequate Protection of Personally Identifiable Log Data",
      "description": "An inadequate administrative concept, poor implementation, excessively long data retention periods, or insufficient coordination with the works council and the data protection officer can lead to inadequate protection of personally identifiable log data. These conditions increase the risk of data misuse.",
      "impact": "If personally identifiable log data is not adequately protected or is stored for too long without a clear policy, it could be misused to create detailed user profiles. This enables tracking of employee activities and behavior over time, leading to significant privacy violations. Such incidents can result in legal and financial penalties (e.g., under the GDPR), reputational damage, and loss of trust from employees and customers.",
      "action": "Implement Data Minimization and Retention Policies for Log Data",
      "mitigation": "Define and enforce strict data-retention policies for all log data, especially where personal information is involved. Ensure that logs are deleted or anonymized automatically after the defined retention period. Access to raw log data must be tightly controlled and restricted to authorized personnel with a legitimate need. Consult the data protection officer and, where applicable, the works council to ensure compliance with legal requirements such as the GDPR. Use the `@RetentionPolicy:Defined` tag on technical assets to indicate that such a policy exists and is enforced for the data stored there.",
      "check": "Are data-retention policies for logs clearly defined and documented? Is there an automated process for deleting or anonymizing old logs? Is access to log management systems properly secured and audited? Has the data protection officer (and, where applicable, the works council) approved the logging and retention strategy?",
      "asvs": "V8.3.4: All sensitive data at rest is encrypted, using a recommended and proven algorithm and a strong encryption key.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html",
      "detectionLogic": "This rule triggers on technical assets likely to store or process log data (e.g., databases, monitoring systems, data lakes) that handle data assets identified as sensitive, personally identifiable logs. A risk is generated if such a technical asset is not explicitly tagged with `@RetentionPolicy:Defined`, indicating a potential lack of required data-lifecycle management.",
      "riskAssessment": "The likelihood is considered 'Likely' if a system stores sensitive logs without a declared retention policy, as this represents a significant governance gap. The impact is determined by the confidentiality level of the stored log data; 'Strictly Confidential' personal data results in a 'High' impact due to the severe privacy and legal consequences of a breach.",
      "falsePositives": "A risk may be flagged even if a retention policy exists but is managed outside the system documented in the threat model. In such cases, update the model by applying the `@RetentionPolicy:Defined` tag to the relevant technical asset to suppress this finding.",
      "cwe": "532",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.InformationDisclosure"
    },
    {
      "file": "9_sec1.ts",
      "bsiCode": "APP.3.3",
      "id": "file-server-availability-failure",
      "title": "Availability Failure of a Fileserver (BSI-based)",
      "description": "If a fileserver fails, the entire information system—including key business processes and institutional tasks—can be affected. Not only users but also applications may depend on data from the fileserver to operate correctly. The BSI warns that such failures can cause serious operational disruptions.",
      "impact": "If the availability of data and services on the fileserver is not ensured, deadlines may be missed and essential business processes interrupted. Without an emergency management plan, restart times can increase further. In many cases, this results in financial losses, and the outage may also affect other institutions.",
      "action": "Implement redundancy, backup and recovery, and disaster recovery plans",
      "mitigation": "Fileservers, especially those storing critical data, should be designed for high availability. This can be achieved through redundant hardware, clustering, or load balancing. A robust backup and recovery strategy must be in place and regularly tested. For mission-critical systems, a comprehensive disaster recovery plan should be established to ensure business continuity. The `redundant` flag on the technical asset should be set to `true` to reflect such a setup.",
      "check": "Is the fileserver asset marked as 'redundant'? Are backup and disaster recovery plans documented? Are Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO) defined and tested?",
      "asvs": "V6.1: Verify all application components have sufficient availability to handle application load, and can gracefully handle failures in integrated systems.",
      "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Availability_Cheat_Sheet.html",
      "detectionLogic": "This risk is raised for any technical asset of type 'FileServer' that is not marked as `redundant: true` in the model. The impact is determined by the highest availability requirement of the server or the data it stores.",
      "riskAssessment": "The likelihood is considered 'Likely' for any non-redundant fileserver, as it represents a single point of failure. The impact is rated based on the highest `availability` classification of the server or its stored data assets: 'Mission-Critical' leads to 'Very-High' impact, 'Critical' to 'High' impact, 'Important' to 'Medium' impact, and lower classifications to 'Low' impact.",
      "falsePositives": "This risk may be a false positive if redundancy is handled by an underlying platform (e.g., cloud storage backend, SAN with failover) that is not explicitly modeled, but which effectively makes the fileserver component highly available. In such cases, the `redundant: true` flag should be set on the asset.",
      "cwe": "703",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "9_sec2.ts",
      "bsiCode": "APP.3.3",
      "id": "insufficient-fileserver-resources-con1-a15",
      "title": "Insufficient File Server Resources (BSI CON.1.A15)",
      "description": "If the network connection or storage capacity of the file server is insufficient, access times can increase or storage bottlenecks can occur.",
      "impact": "Inadequate resources for a file server can directly impact availability and can lead to integrity issues if applications fail.",
      "action": "Implement Capacity and Performance Management for File Servers",
      "mitigation": "Regularly monitor the file server's storage utilization, CPU, memory, and network throughput.",
      "check": "Are performance and capacity metrics for the file server actively monitored? Is there a documented process for capacity planning?",
      "asvs": "BSI IT-Grundschutz CON.1.A15 (Sufficient dimensioning of the file server)",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_File_server_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for all technical assets of the 'File Server' technology type.",
      "riskAssessment": "The likelihood is determined by factors indicating high load, such as the number of incoming connections and the volume of data stored.",
      "falsePositives": "This risk might be a false positive if the file server, even under high load, is adequately sized, properly monitored, and supported by a well-managed capacity plan.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "9_sec3.ts",
      "bsiCode": "APP.3.3",
      "id": "malware-on-fileserver",
      "title": "Unprotected File Server Spreading Malware",
      "description": "If a file server is insufficiently integrated into the organization's malware protection strategy, malware can be stored on it without detection.",
      "impact": "Widespread malware infection can compromise the Confidentiality, Integrity, and Availability (CIA) of data across numerous systems.",
      "action": "Integrate the File Server into the Malware Protection Strategy",
      "mitigation": "Ensure that the file server is covered by the central malware protection strategy. This includes installing and regularly updating anti-malware software on the file server itself,",
      "check": "Is the file server asset in the threat model tagged with `@Protected:Anti-Malware`? Does this reflect reality, i.e., is the server equipped with an effective, up-to-date anti-malware solution that scans file shares?",
      "asvs": "BSI IT-Grundschutz OPS.1.1.4 Protection against malware",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_4_Protection_against_malware_edition_2022.html",
      "detectionLogic": "This risk is raised for any in-scope technical asset of type 'File Server' that is not explicitly tagged as having malware protection (`@Protected:Anti-Malware`).",
      "riskAssessment": "The likelihood is considered higher if the file server is exposed to the internet. The impact is determined by the highest CIA rating of the file server itself or the data it stores.",
      "falsePositives": "A file server might have malware protection in place, but this is not documented in the model using the `@Protected:Anti-Malware` tag.",
      "cwe": "509",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "9_sec4.ts",
      "bsiCode": "APP.3.3",
      "id": "improper-access-control-orp4",
      "title": "Improper Access Control (BSI ORP.4)",
      "description": "If access rights and permissions are not properly designed, assigned, and enforced, unauthorized parties may gain access to data. This could allow them to read, modify, or delete sensitive information, compromising confidentiality, integrity, and availability.",
      "impact": "Failing to enforce proper access control can lead to data breaches, unauthorized manipulation or deletion of data, and elevation-of-privilege attacks. Consequences can include financial loss, reputational damage, operational disruption, and non-compliance with legal or contractual obligations.",
      "action": "Implement and enforce strong access control",
      "mitigation": "Ensure that all communication links, especially those accessing data stores or processing sensitive information, enforce strong authentication and authorization mechanisms (e.g., using tokens, client certificates, or identity propagation rather than 'none'). Access should be granted based on the principle of least privilege ('need-to-know'). Regularly review and audit assigned permissions. Do not use 'none' for authentication or authorization on any link that handles non-public data.",
      "check": "Are there any communication links in the model with `authentication` or `authorization` set to `none`? Do these links transmit or receive data assets? What is the sensitivity of the data and the target asset?",
      "asvs": "BSI IT-Grundschutz ORP.4 Identity and Access Management, particularly ORP.4.A6 (Definition of authorisations) and ORP.4.A7 (Setting up users and authorisations).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "This rule triggers when a communication link has its `authentication` or `authorization` property set to `none`. The risk is raised against the target asset of that link, as it is the component failing to enforce access control, especially if it handles sensitive data or is otherwise critical.",
      "riskAssessment": "The likelihood of exploitation is considered very high when no access controls are present on a communication channel. The impact is calculated based on the highest Confidentiality, Integrity, and Availability ratings of both the data assets transferred over the link and the target asset itself. Higher CIA ratings lead to higher impact.",
      "falsePositives": "This risk might be a false positive if the data being transferred is explicitly intended for public, unauthenticated access and its integrity is not a concern (e.g., a public status page with no user data). It is more likely to be a modeling error where access controls exist but were not documented in the threat model.",
      "cwe": "269",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.ElevationOfPrivilege"
    },
    {
      "file": "9_sec5.ts",
      "bsiCode": "APP.3.3",
      "id": "disorganized-data-storage-con1",
      "title": "Unstructured Data Storage (BSI CON.1)",
      "description": "If a storage structure is not specified, or if employees do not adhere to it,",
      "impact": "Unstructured data storage can compromise the confidentiality, integrity, and availability of information.",
      "action": "Define and Enforce Data Storage Structures and Policies",
      "mitigation": "Establish and document a clear, well-structured, and mandatory directory and file structure for all relevant data stores.",
      "check": "Is there a documented and enforced policy for file and directory structures? Are access permissions regularly reviewed?",
      "asvs": "BSI IT-Grundschutz CON.1.A1: Definition of a Directory Structure",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_data_and_file_storage_Edition_2023.pdf?__blob=publicationFile",
      "detectionLogic": "This risk is raised for technical assets of type 'datastore' that use technologies prone to unstructured data storage,",
      "riskAssessment": "The likelihood is considered higher for multi-tenant assets or those with a large number of users, as this increases the potential for disorganization.",
      "falsePositives": "This risk is generated based on the type of technology used. A model cannot verify the existence or enforcement of strong",
      "cwe": "552",
      "function": "RiskFunction.Architecture",
      "stride": "STRIDE.Tampering"
    },
    {
      "file": "9_sec6.ts",
      "bsiCode": "APP.3.3",
      "id": "data-loss-on-fileserver",
      "title": "Data Loss on File Server due to Missing Redundancy or Backup",
      "description": "If a file server fails completely or individual components fail, important information can be lost without file synchronization or a functioning backup. The same applies if employees accidentally delete files. If sufficient redundancy (e.g., a suitable Redundant Array of Independent Disks (RAID)) is not employed, further problems can arise. The failure of a single storage device can directly disrupt operations because the files are no longer available.",
      "impact": "A failure without proper redundancy or backup leads to data loss, compromising Integrity (data is lost or incomplete) and Availability (data is not accessible). This can severely disrupt operations, cause permanent loss of valuable information, and result in significant operational and financial damage.",
      "action": "Implement Redundancy and Backup Measures",
      "mitigation": "Ensure the file server asset is configured with hardware redundancy (e.g., a RAID system). This can be modeled by setting the 'redundant' attribute to true on the technical asset. Additionally, implement a robust, regularly tested backup and recovery strategy for all data stored on the server. To reflect this in the model, add the tag 'mitigation:backup' to the file server asset.",
      "check": "Is the 'redundant' flag set to true for the file server asset? Does the asset have a 'mitigation:backup' tag? Are the backup and recovery procedures documented and tested regularly?",
      "asvs": "BSI IT-Grundschutz: APP.3.3 Fileserver (Section 2.6 – loss of data); see also CON.3 Datensicherungskonzept and SYS.1.8 Speicherlösungen",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_3_Linux_and_Unix_servers_edition_2023.pdf?__blob=publicationFile&v=2",
      "detectionLogic": "Triggers for all in-scope technical assets of the 'file-server' technology type that are either not marked as 'redundant' or lack a 'mitigation:backup' tag. The risk impact is determined by the file server asset's availability and integrity ratings.",
      "riskAssessment": "The impact of data loss is driven by the file server's 'availability' and 'integrity' ratings. A server hosting 'mission-critical' data leads to a 'very-high' impact. The likelihood is 'likely' because hardware failures and human errors are common over a server's lifecycle.",
      "falsePositives": "The model may not include a separate, network-based backup solution. If such a solution exists and protects the file server, treat this as a false positive or mark it as mitigated by adding the 'mitigation:backup' tag.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.DenialOfService"
    },
    {
      "file": "9_sec7.ts",
      "bsiCode": "APP.3.3",
      "id": "ransomware-infection-via-lateral-movement",
      "title": "Ransomware Infection via Lateral Movement",
      "description": "Ransomware is malware that encrypts data on infected systems, making it inaccessible, and attackers demand a ransom for decryption keys.",
      "impact": "If ransomware spreads from a less critical asset (e.g., a user workstation) to a central data store, it can encrypt large volumes of shared data.",
      "action": "Implement network segmentation, the principle of least privilege, and robust backup and recovery strategies",
      "mitigation": "To mitigate this risk, apply a defense-in-depth strategy:",
      "check": "Are write permissions to shared data stores strictly limited based on business need? Are client networks segmented from server/storage networks? Are regular, tested, offline/immutable backups in place for all critical data?",
      "asvs": "Aligned with BSI IT-Grundschutz, especially APP.3.3 Fileserver threat scenarios involving malware/ransomware and the need for controls such as CON.3 (Malware Protection), CON.4 (Data Backup), and OPS.1.1.4 (Network Segmentation and Filtering).",
      "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Malware_protection_edition_2023.pdf?__blob=publicationFile (BSI CON.3)",
      "detectionLogic": "This risk is identified when a less protected technical asset (e.g., a client or web application) has a non-read-only communication link to a high-value data store (such as a fileserver). This creates a potential path for ransomware to spread from a common infection point to critical data storage, bypassing protections on the data store itself.",
      "riskAssessment": "The likelihood is driven by the exposure of the initial asset (clients and internet-facing systems are more likely to be compromised). The impact depends on the availability and integrity requirements of the data on the target data store. A successful attack on a data store with mission-critical data has a very high impact.",
      "falsePositives": "A risk might be flagged as a false positive if compensating controls that are not modeled exist, such as an advanced EDR/XDR solution that effectively blocks ransomware's lateral movement behavior, or if write access is restricted in ways not captured by the model.",
      "cwe": "400",
      "function": "RiskFunction.Operations",
      "stride": "STRIDE.Tampering"
    }
  ],
  "groupedByBSI": {
    "SYS.2.5": [
      {
        "file": "100_sec1.ts",
        "bsiCode": "SYS.2.5",
        "id": "inadequate-network-performance-for-virtual-clients",
        "title": "Network Capacity and Latency Risks for Virtualized Clients and Critical Links (BSI SYS.2.5)",
        "description": "Missing or insufficient network capacity and latency planning for connections to and from virtual clients (or other critical components) can break functionality and business flows. In BSI’s context, terminal/remote-desktop-style workloads are especially sensitive to latency and jitter; under-provisioned links to users or backend services (file services, databases, directory services, and conferencing) cause freezes, timeouts, and service disruption.",
        "impact": "Limited or unstable access to services, sluggish UI, increased error rates, and timeouts—ultimately harming availability. For end users, this appears as slow, unresponsive, or unusable applications; for backend systems it can cascade into stuck threads, queue buildups, and partial outages.",
        "action": "Document, provision, and verify bandwidth/latency/QoS for all critical links.",
        "mitigation": "Identify and document bandwidth, latency, jitter, and packet-loss SLOs for end-user and backend paths. Provide adequate capacity and QoS (including DSCP/class-based queuing where applicable). Avoid oversubscription. Test with synthetic load and real user journeys before go-live. Continuously monitor (APM/NPM) and alert on SLO breaches. For links flagged by this rule, explicitly record evidence that the network meets expected peak demand.",
        "check": "Do critical connections have defined bandwidth/latency/jitter SLOs and sizing calculations? Is QoS configured and validated end-to-end (including WAN/Cloud edges)? Are performance dashboards/alerts in place and reviewed, with action runbooks for degradation?",
        "asvs": "Based on BSI IT-Grundschutz SYS.2.5 Client-Virtualisierung and SYS.1.6 Virtualisierung; related to threat \\",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_6_Virtualisierung_Edition_2023.pdf?__blob=publicationFile (German BSI Module on Virtualization)",
        "detectionLogic": "Raised for any non-local communication link that is either (1) explicitly tagged @Latency:Critical or (2) transports at least one data asset with Mission-Critical availability. Local, non-network interactions (in-process calls or local file access) are excluded. Impact is derived from the highest availability of the link or target; if a client technology participates, impact is minimally escalated due to user-facing effects.",
        "riskAssessment": "Likelihood: Likely by default for latency-sensitive or mission-critical flows, as performance regressions are common without explicit capacity planning. Impact: derived from the maximum availability of the target asset and the link; Mission-Critical flows map to High impact. User-facing (client) involvement raises the floor to at least Medium.",
        "falsePositives": "Acceptable if you can point to current capacity plans, QoS configs, load/latency test results, and live monitoring that demonstrate headroom under peak and failure scenarios. In such cases, record the evidence and consider marking the instance as mitigated.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "100_sec2.ts",
        "bsiCode": "SYS.2.5",
        "id": "insufficient-virtual-client-resources",
        "title": "Insufficient Resources for Virtual Clients (BSI SYS.2.5 — Threat 2.2, Requirement A10)",
        "description": "Virtual desktop/client workloads (VDI) require adequate CPU, RAM, storage IOPS, GPU and network throughput. If a virtual client is under-provisioned or competes for shared resources, user-facing applications slow down or fail to start, directly impacting business operations.",
        "impact": "Performance collapse on virtual clients degrades availability of user workflows: longer login times, frozen apps, failed rendering, and timeouts to downstream services. For high-availability roles, this can halt critical processes and productivity across teams.",
        "action": "Right-size and guarantee resources for virtual clients (VDI).",
        "mitigation": "Define per-persona resource profiles; reserve minimum CPU/RAM/IOPS; enable dynamic rightsizing with monitored ceilings; allocate/virtualize GPUs only where required; baseline and alert on CPU, RAM, IOPS, GPU and network saturation; use resource pools, reservations, limits and shares; prevent nested virtualization; keep templates updated and hardened.",
        "check": "Are per-role CPU/RAM/IOPS/GPU/network baselines documented? Are reservations/limits/shares configured on the virtualization platform? Is monitoring with thresholds and alerts active for VDI sessions and hosts? Are users educated about concurrent heavy usage?",
        "asvs": "BSI mapping: SYS.2.5 Client-Virtualisierung — 2.2 Ressourcenknappheit; SYS.2.5.A10 Bedarfsgerechte Zuweisung von Ressourcen.",
        "cheatSheet": "See BSI IT-Grundschutz Kompendium, Baustein SYS.2.5 Client-Virtualisierung (sections 2.2 and A10).",
        "detectionLogic": "Raise a finding for every in-scope technical asset where machine === Virtual AND technology ∈ {ClientSystem, Desktop}. Excludes out-of-scope assets. Impact is scaled by the asset’s availability requirement. Intended for VDI/virtual desktop/client systems that may suffer from resource contention or under-provisioning.",
        "riskAssessment": "Likelihood: Likely — resource contention and mis-sizing are common in virtual desktop estates. Impact: derived from the asset’s availability (MissionCritical → High; Critical/Important → Medium; otherwise Low).",
        "falsePositives": "Low risk where strict reservations and dedicated resource pools guarantee minimum performance (e.g., vCPU/Memory reservations, dedicated GPUs, proven headroom) and continuous performance monitoring shows no saturation under peak load.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "100_sec3.ts",
        "bsiCode": "SYS.2.5",
        "id": "resource-exhaustion-on-virtualization-platform",
        "title": "Resource Exhaustion on Virtualization Platform (BSI CON.5)",
        "description": "Virtualization hosts consolidate many clients on shared CPU, RAM, storage and I/O. Without careful capacity planning and limits, concurrent tenants can contend for resources, causing unpredictable slowdowns or outages of virtual clients, especially with dynamic allocation or bursty workloads.",
        "impact": "Exhausted host resources degrade or halt all VMs on that host/cluster. This results in service slowdown or Denial of Service for dependent applications, primarily affecting availability and, indirectly, integrity (e.g., timeouts, failed writes).",
        "action": "Introduce host capacity planning, per-VM quotas/reservations, and proactive monitoring/alerting.",
        "mitigation": "Size hosts for peak load with headroom; configure per-VM CPU/memory reservations and hard limits; control noisy-neighbor effects (shares/limits); continuously monitor host and VM utilization with alerts; test failover and live-migration; isolate or dedicate hosts for critical tenants; prefer HA clusters for resilience.",
        "check": "Are CPU/memory reservations/limits set per VM? Is cluster/host utilization monitored with alerts and SLOs? Are HA/live migration features enabled and tested? Are critical workloads isolated from general tenants? Is there a documented capacity plan with periodic reviews and stress tests?",
        "asvs": "ASVS V13.2.1: Verify the application is resilient to resource exhaustion attacks.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Virtualization_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "Raised for any Shared Runtime that runs more than one in-scope Technical Asset (out-of-scope assets are ignored). Likelihood scales with tenant count: ≤3 ⇒ Unlikely, 4–7 ⇒ Likely, >7 ⇒ Very-Likely. Impact is the maximum availability requirement among tenants: Important ⇒ Medium, Critical ⇒ High, Mission-Critical ⇒ Very-High. The most critical tenant is highlighted as most relevant. Single-tenant shared runtimes do not raise this risk.",
        "riskAssessment": "More tenants on a host increase the chance of contention; few tenants make it unlikely, many tenants make it very likely. Impact mirrors the highest availability need among the co-tenants, so the presence of a mission-critical VM elevates impact to very high even if others are less critical.",
        "falsePositives": "May be a false positive where hard reservations/limits guarantee capacity, hosts are dedicated to a single critical tenant, or an HA/autoscaling cluster maintains ample headroom validated by stress tests and SLOs. Such assurances typically require operational evidence beyond the model.",
        "cwe": "770",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "100_sec4.ts",
        "bsiCode": "SYS.2.5",
        "id": "improper-virtual-network-segmentation-on-shared-host",
        "title": "Improper Virtual Network Segmentation on a Shared Host (BSI SYS.2.5 §2.4)",
        "description": "Virtual clients with differing protection needs are co-located on the same virtualization host. If virtual network components (vSwitches/port groups/VLANs/uplinks) are misconfigured, client traffic may traverse unintended segments, undermining the intended network separation.",
        "impact": "Breakdowns in virtual network segmentation can expose sensitive server networks to client segments, enabling unauthorized access, data disclosure, tampering, and lateral movement. Co-locating an internet-facing client with high-security internal networks significantly increases the institution’s attack surface.",
        "action": "Enforce, verify, and continuously monitor strict network segmentation at the virtualization layer.",
        "mitigation": "Configure vSwitches/port groups/VLAN tags to enforce the modeled boundaries. For mixed trust zones on one host, use separate virtual switches or strong, verified isolation (e.g., micro-segmentation). Regularly audit the hypervisor networking against the target architecture. In the model, apply '@hardening:hardened-virtual-networking' to Shared Runtimes where robust separation is assured.",
        "check": "Are technical assets from different network trust boundaries running on the same Shared Runtime? If so, is there robust, audited separation at the hypervisor layer (correct vSwitch/VLAN placement, no unintended bridging/uplinks) and—if applicable—documented hardening ('@hardening:hardened-virtual-networking')?",
        "asvs": "Aligned with BSI IT-Grundschutz: SYS.2.5 Client Virtualization (esp. Section 2.4: Network separation), SYS.2.1 General Client, SYS.1.5 Virtualization, and NET.1.1 Network Architecture & Design.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_1_General_client_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "For each Shared Runtime without the tag '@hardening:hardened-virtual-networking', collect all in-scope technical assets running on it. Resolve each asset’s nearest network-level Trust Boundary by walking up parent boundaries until a network boundary is found (using isTrustBoundaryNetworkBoundary). If more than one distinct network boundary is present on the same runtime, flag a risk. The generated title lists the boundary names to aid investigation. Likelihood defaults to 'Likely'; impact is derived from the most sensitive co-located asset and is further elevated if any internet-facing asset is present.",
        "riskAssessment": "Impact scales with the sensitivity and criticality of the mixed assets; mixing internet-facing clients with confidential or critical backends yields a very high impact. Likelihood is 'Likely' by default due to the inherent complexity and error-proneness of hypervisor networking. Runtimes explicitly tagged as hardened are excluded.",
        "falsePositives": "Possible when out-of-band micro-segmentation or dedicated per-zone hosts (SYS.2.5.A4) exist but are not modeled. Mark as mitigated or accepted with justification, or add the '@hardening:hardened-virtual-networking' tag to the runtime.",
        "cwe": "668",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "100_sec5.ts",
        "bsiCode": "SYS.2.5",
        "id": "loss-of-virtual-client-sys3.3",
        "title": "Loss of Virtual Client Due to Misconfiguration or Deletion (BSI SYS.2.5)",
        "description": "In client virtualization environments, virtual client images are centrally stored and managed.",
        "impact": "If a virtual client is lost or damaged, it directly affects the integrity of stored data (because it may be deleted) and the availability of the client and its processing functions.",
        "action": "Implement Redundancy and @Backup:Target/Restore Procedures for Virtual Clients",
        "mitigation": "Ensure that virtual client images are regularly backed up and that a documented and tested restore process is in place.",
        "check": "Are virtual client images and their data regularly backed up? Is there a documented and tested recovery procedure?",
        "asvs": "Based on the BSI IT-Grundschutz module SYS.2.5 Client Virtualization, addressing threats such as incorrect planning/configuration and operator error.",
        "cheatSheet": "See the BSI IT-Grundschutz Compendium, module SYS.2.5 Client Virtualization.",
        "detectionLogic": "Triggers for any technical asset that is a non-redundant virtual client system.",
        "riskAssessment": "The likelihood of operator error or misconfiguration is generally considered 'likely' in complex environments.",
        "falsePositives": "The risk might be overestimated if robust, out-of-model compensating controls exist, such as a separate, highly effective @Backup:Target and recovery system that makes client restoration straightforward.",
        "cwe": "404",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "100_sec6.ts",
        "bsiCode": "SYS.2.5",
        "id": "unavailability-of-virtual-clients-bsi-con-3",
        "title": "Unavailability of Virtual Clients (BSI CON.3)",
        "description": "Virtual clients—unlike physical machines—are often centrally managed by IT operations administering the virtualization infrastructure.",
        "impact": "The unavailability of a virtual client prevents users from performing their tasks, which can lead to business process disruptions and loss of productivity.",
        "action": "Implement High-Availability and Recovery Procedures for the Virtualization Infrastructure",
        "mitigation": "Use high-availability (HA) features of the virtualization platform, such as failover clustering and live migration, to minimize downtime.",
        "check": "Is the virtualization platform configured as a high-availability cluster? Are there automated alerts when a virtual client becomes unresponsive? Are there documented and tested procedures for restarting clients after maintenance or a host failure? Is the 'redundant' flag set for critical virtual assets in the model?",
        "asvs": "BSI IT-Grundschutz CON.3: Virtualisierung (related to threat G 0.14 Ausfall von IT-Komponenten)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/bausteine/con/CON_3_Virtualisierung_Edition_2023.html",
        "detectionLogic": "This risk is raised for any technical asset configured as a virtual machine (`machine: virtual`) that runs on a shared runtime representing the virtualization host. The risk highlights the inherent availability dependency on the underlying shared runtime.",
        "riskAssessment": "The likelihood of this risk materializing depends on the stability, redundancy, and maintenance procedures of the virtualization platform. The impact is determined by the availability requirement (criticality) of the virtual client and the data it handles. A mission-critical virtual client will have a very high impact if it becomes unavailable.",
        "falsePositives": "This risk can be considered a false positive if the virtualization platform is already configured with robust high-availability and automated recovery mechanisms that are not fully represented in the threat model.",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "100_sec7.ts",
        "bsiCode": "SYS.2.5",
        "id": "compromise-of-virtual-client-from-outdated-template",
        "title": "Compromise of Virtual Clients due to Outdated Templates (BSI SYS.2.5 – Threat 2.7, Req. A9)",
        "description": "Virtual clients are typically provisioned from templates (virtual hardware profile and base image). If these templates are not regularly refreshed, newly created clients may ship with software that already contains known vulnerabilities (see SYS.2.5 §2.7). As soon as such clients are reachable by other IT systems, automated exploitation becomes feasible and can result in client compromise.",
        "impact": "Successful exploitation can yield full control over the virtual client, enabling credential theft, lateral movement, and data exfiltration. This threatens the client’s Confidentiality, Integrity, and Availability and may extend to adjacent systems and data processed or stored by the client.",
        "action": "Establish Template Lifecycle & Patch Governance for Virtual Clients",
        "mitigation": "Maintain a formal lifecycle for virtual client templates: version, patch, test, and deprecate on schedule. Automate image rebuilds and security updates; retire superseded templates. If intentionally deploying legacy/vulnerable clients (e.g., for compatibility testing), confine them to isolated segments with strict access controls and continuous monitoring. Use the tag '@Mitigation:TemplatePatching' on assets where an effective, automated update process is in place.",
        "check": "Are templates centrally managed, versioned, and regularly rebuilt? When was the last update? Is there evidence of automated patching and removal of end-of-life (EOL) templates? For test/legacy clients, is isolation enforced and documented? Is the '@Mitigation:TemplatePatching' tag applied where appropriate?",
        "asvs": "Mapped to BSI IT-Grundschutz SYS.2.5 (A9 templates kept up to date; A16/A17 enhanced logging and monitoring) and SYS.1.5 Virtualization, where applicable.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_Virtualization_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Flags any technical asset that (1) runs on a virtual machine (machine type 'virtual'), (2) is a client technology (e.g., desktop/VDI/terminal client), (3) is in scope, and (4) is not tagged with '@Mitigation:TemplatePatching'. This aligns with SYS.2.5 §2.7 and A9: if no explicit mitigation is modeled, templates are assumed to drift out of date.",
        "riskAssessment": "Likelihood defaults to 'Likely' because template drift is a common operational lapse. Impact scales with the asset’s CIA ratings: high or mission-critical confidentiality, integrity, or availability elevates the impact up to Very High, especially when mission-critical data is processed.",
        "falsePositives": "This may be a false positive if automated template rebuilds/patching exist but are not modeled via '@Mitigation:TemplatePatching'. Intentional legacy/test clients can also be flagged; risk may be acceptable if they are tightly isolated and continuously monitored.",
        "cwe": "1191",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "100_sec8.ts",
        "bsiCode": "SYS.2.5",
        "id": "compromised-virtual-client-on-shared-infrastructure-con3",
        "title": "Client Virtualization: Co-tenancy Risk on Shared Infrastructure (BSI CON.3 / SYS.2.5)",
        "description": "Interactive virtual clients that run on shared virtualization hosts can endanger colocated workloads.",
        "impact": "Compromise of a single virtual client can lead to loss of confidentiality/integrity or denial of service for",
        "action": "Avoid co-tenancy of untrusted or easily compromised clients with sensitive/critical workloads; enforce strong separation.",
        "mitigation": "Enforce strict logical separation between VMs on the same host; do not colocate general-purpose user desktops with",
        "check": "Inspect all Shared Runtimes: is there at least one virtual client (desktop/browser/client-type or human-operated VM) running together with",
        "asvs": "BSI IT-Grundschutz-Bausteine: CON.3 Virtualisierung und SYS.2.5 Client-Virtualisierung; insbesondere CON.3.A17 (Trennung virtueller IT-Systeme).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Virtualisierung_Edition_2023.pdf?__blob=publicationFile (German original, PDF)",
        "detectionLogic": "Trigger when a Shared Runtime hosts ≥1 technical asset with machine='virtual' that is a client (client-technology or usedAsClientByHuman)",
        "riskAssessment": "Likelihood is derived from client exposure (internet access increases it) and the weakest client's RAA. Impact is based on the most sensitive co-tenant",
        "falsePositives": "Lower severity or exceptions may apply when the platform provides certified strong isolation that is correctly configured and patched,",
        "cwe": "668",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "SYS.2.6": [
      {
        "file": "101_sec1.ts",
        "bsiCode": "SYS.2.6",
        "id": "resource-overbooking-in-vdi",
        "title": "Resource Overbooking in VDI",
        "description": "A Virtual Desktop Infrastructure (VDI) is commonly used to optimize resources. However, when many virtual clients are consolidated on single virtualization hosts, or when the number of users is underestimated, available resources can be overbooked. This can cause severe resource contention among virtual clients and unpredictable performance degradation.",
        "impact": "Overbooking of resources can lead to the temporary unavailability of virtual clients (denial of service). Performance degradation is often non-transparent to users, which can result in data loss or unintentional data modification, compromising integrity and availability.",
        "action": "Implement VDI capacity planning and performance monitoring",
        "mitigation": "Establish a robust capacity planning and management process for the VDI environment. Continuously monitor resource utilization (CPU, memory, I/O, network) on virtualization hosts. Use load balancing and define clear thresholds for the number of clients per host. Set resource limits and reservations for critical virtual clients to guarantee their performance. Avoid consolidating too many resource-intensive clients on a single physical host.",
        "check": "Is there an established capacity management process for the VDI? Is resource utilization being actively monitored against defined thresholds? Are performance and availability SLAs defined and met for virtual clients?",
        "asvs": "Aligned with BSI IT-Grundschutz for virtualization and client management, in particular SYS.2.6 Virtual Desktop Infrastructure and APP.1.1 Office Products.",
        "cheatSheet": "BSI IT-Grundschutz Compendium: SYS.2.6 Virtual Desktop Infrastructure; APP.1.1 Office Products.",
        "detectionLogic": "This risk is indicated when a shared runtime, representing a VDI host, runs a large number of virtual clients (e.g., assets with 'Desktop' or 'Client-System' technology). A high count of such assets within a single shared runtime suggests potential resource contention and overbooking, leading to performance degradation and unavailability.",
        "riskAssessment": "The likelihood increases with the number of virtual clients per host. The impact is determined by the highest availability and integrity requirements of the virtual clients and the data they process. If clients are used for mission-critical tasks, the impact is high, because performance degradation can halt business processes.",
        "falsePositives": "A high number of clients on a single host may not pose a risk if the underlying hardware is exceptionally powerful and managed by effective resource schedulers. This rule is a heuristic and should be validated against the actual hardware specifications and monitoring data of the VDI environment.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "101_sec2.ts",
        "bsiCode": "SYS.2.6",
        "id": "faulty-vdi-profile-assignment",
        "title": "Incorrect VDI Profile Assignment (BSI SYS.2.6)",
        "description": "In a Virtual Desktop Infrastructure (VDI), virtual clients and their resources are centrally assigned to users via profiles.",
        "impact": "An incorrect VDI profile assignment can directly lead to privilege escalation, where users gain access to data and systems beyond their permissions.",
        "action": "Implement and Enforce Least-Privilege VDI Profiles",
        "mitigation": "Design and implement VDI profiles according to the principle of least privilege, ensuring users have access only to the resources required for their roles.",
        "check": "Are VDI profiles strictly configured according to the principle of least privilege? Are there separate, hardened profiles for users with different security requirements?",
        "asvs": "BSI IT-Grundschutz SYS.2.6 Virtual Desktop Infrastructure, in particular requirements SYS.2.6.A4 (Network segmentation of VDI components) and SYS.2.6.A5 (Standardized access to virtual clients).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Virtual_Desktop_Infrastructure_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies VDI management servers (tagged with `@System:VDI`).",
        "riskAssessment": "The impact is determined by the confidentiality, integrity, and availability rating of the backend system the virtual client can access.",
        "falsePositives": "A detected connection from a virtual client to a backend system might be legitimate for a specific power user or administrative role.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "101_sec3.ts",
        "bsiCode": "SYS.2.6",
        "id": "bypassed-network-segmentation-vdi",
        "title": "VDI: Bypassed Network Segmentation (BSI SYS.2.6)",
        "description": "VDI deployments often operate many virtual clients for different user groups, ideally isolated by network segmentation. When a single VDI management component assigns or controls clients across security zones, a misconfiguration can undermine that separation and enable unintended cross-zone communication.",
        "impact": "Successful bypass of segmentation enables lateral movement from lower- to higher-trust networks, potential privilege escalation, and compromise of sensitive systems or data governed by the most critical client managed by the VDI component.",
        "action": "Harden VDI management & enforce independent network segmentation",
        "mitigation": "Harden and securely configure the VDI management plane. Enforce strict RBAC for client-to-user/group assignments. Implement deny-by-default segmentation in the network (firewalls, VLANs, cloud security groups/microsegmentation) so the VDI cannot override it. Regularly audit group mappings, templates, and network rules; apply change control and peer review for assignment logic.",
        "check": "Does a single VDI manager control clients in multiple network zones? Are DevOps/management links allowed to traverse zones? Are segmentation controls independent of VDI logic and verified (e.g., policy-as-code, firewall baselines, microsegmentation)? Are assignments and templates reviewed and monitored for drift?",
        "asvs": "BSI IT-Grundschutz SYS.2.6 / CON.5.A13 – Secure network configuration for virtualized IT systems",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Virtualization_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "Flags any technical asset tagged @System:VDI that has DevOps/management communication links to ≥2 virtual clients which resolve (via parent trust boundaries) to ≥2 distinct network-type trust boundaries. Group clients by their resolved network boundary; if more than one unique boundary exists, attach one risk to the VDI manager and reference all managed clients.",
        "riskAssessment": "Likelihood is set to Likely because a single control plane spanning zones is a common source of misconfiguration. Impact is derived from the maximum confidentiality/integrity/availability level across the VDI manager and all managed clients: higher levels yield Medium/High/VeryHigh impact. Data breach probability is set to Possible when impact exceeds Medium.",
        "falsePositives": "Strong, independently enforced segmentation (e.g., microsegmentation with deny-by-default and verified policies) may prevent cross-zone traffic even if one VDI component manages multiple zones. Compensating controls (separate admin planes, dedicated infrastructure, immutable assignments with approvals) can reduce risk; verify their effectiveness before suppressing this finding.",
        "cwe": "668",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "101_sec4.ts",
        "bsiCode": "SYS.2.6",
        "id": "@System:VDI-corruption-or-reset",
        "title": "Data Loss on a VDI Client Due to Template Corruption or Reset",
        "description": "A key strength of Virtual Desktop Infrastructure (VDI) is the ease of managing many virtual clients through a few central templates.",
        "impact": "This scenario directly affects the integrity and availability of user data and system configurations.",
        "action": "Implement data-persistence and backup strategies for the VDI environment.",
        "mitigation": "Ensure that user data is not stored exclusively on non-persistent or volatile virtual desktops.",
        "check": "Are VDI clients used in the architecture? If so, is user data stored exclusively on these clients?",
        "asvs": "Derived from the BSI IT-Grundschutz module SYS.2.6 (Virtual Desktop Infrastructure/Virtualisation). This is an architectural and operational risk specific to virtualization environments and does not map directly to OWASP ASVS, which focuses on application-layer security.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_6_Virtualisation_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any technical asset tagged with '@System:VDI' that also has data assets listed in its 'dataAssetsStored' property.",
        "riskAssessment": "The likelihood is assessed as 'Likely' because accidental deletion, misconfiguration, or corruption of central VDI templates is a known operational risk.",
        "falsePositives": "A false positive can occur if the model indicates data is stored on the VDI client, but an unmodeled external persistence mechanism (such as a profile management solution that redirects folders to a network share) is in use.",
        "cwe": "732",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "101_sec5.ts",
        "bsiCode": "SYS.2.6",
        "id": "@System:VDI-failure-con-5",
        "title": "VDI Component Single Point of Failure (BSI SYS.2.6 / CON.5)",
        "description": "A Virtual Desktop Infrastructure (VDI) is built from interdependent core components (Access, Control, Management). If any one of these components lacks high availability and fails—due to hardware/software faults or misconfiguration—the overall VDI availability is endangered. Even a loss of the management tier can halt provisioning, resets, or capacity adjustments and severely slow recovery.",
        "impact": "Unplanned downtime of a core VDI component blocks users from reaching their desktops or administrators from restoring service, degrading productivity and business continuity. Severity scales with the availability requirement of the affected service.",
        "action": "Design VDI core components for high availability and remove single points of failure.",
        "mitigation": "Model critical VDI components (Access/Control/Management) as redundant (e.g., failover clusters, load balancers, active/active pairs). In Threagile, set `redundant: true` on those technical assets. Implement health checks, configuration management, regular failover tests, and consider site-level and network redundancy.",
        "check": "Are all technical assets representing VDI components (tagged `@System:VDI`) modeled with `redundant: true`? Is monitoring in place to detect component loss and cluster degradation?",
        "asvs": "BSI SYS.2.6.A15 Hochverfügbare Bereitstellung der VDI-Komponenten; BSI IT-Grundschutz CON.5.A5 High availability of the virtualization solution",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Virtualization_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Flag every in-scope technical asset tagged `@System:VDI` where `redundant !== true`. Out-of-scope assets are ignored. Such assets are treated as potential single points of failure.",
        "riskAssessment": "Likelihood is Likely when a critical component lacks redundancy. Impact is derived from the asset’s availability requirement (MissionCritical → VeryHigh, Critical → High, Important → Medium).",
        "falsePositives": "High availability may exist but not be modeled (e.g., active/active behind a load balancer, managed cloud HA, or external site-failover). Verify the real architecture and update the model with `redundant: true` where appropriate.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "101_sec6.ts",
        "bsiCode": "SYS.2.6",
        "id": "kompromittierung-vdi-managementkomponente",
        "title": "Compromise of the VDI Management Component (BSI SYS.2.6 / APP.3.2)",
        "description": "A VDI management component administers virtual desktops/clients and the policies that assign users to them. If it is compromised (e.g., via vulnerabilities, misconfiguration, or credential theft), an attacker can pivot into most or all connected virtual clients and related infrastructure, degrading confidentiality, integrity, and availability at scale. Because the manager and its agents orchestrate provisioning and in-session controls, it is both a high-value target and a single point of failure.",
        "impact": "Compromising the central manager enables mass account and session takeover, remote code execution on clients, bulk data exfiltration or destruction, and widespread denial of service, disrupting business processes that depend on the VDI platform.",
        "action": "Harden and isolate the VDI management plane; enforce strong authentication and least privilege; monitor aggressively.",
        "mitigation": "Isolate management interfaces on dedicated admin/VPN networks; require MFA for all administrators (including emergency break-glass accounts) and use RBAC/least privilege; patch OS, manager, and agent software promptly; disable or restrict risky agent features; enable tamper protection and code signing for templates/agents; log all admin actions centrally (SIEM) with alerting; keep offline/immutable backups and tested recovery for manager configuration and golden images; avoid exposing the manager directly to the internet; deploy redundant manager nodes if supported.",
        "check": "• Are management interfaces reachable only from a dedicated admin network/VPN and never directly from the internet? • Is MFA enforced for all admin accounts (including emergency accounts) and are roles least-privileged? • Are the manager software, OS, and VDI agents fully patched and hardened? • Are administrative actions centrally logged and monitored (SIEM) with alerting? • Are templates/golden images signed, updated, and protected; are resets/provisioning controlled? • Is the management component deployed redundantly and regularly backed up/recovered in tests?",
        "asvs": "BSI IT-Grundschutz: SYS.2.6 Virtual Desktop Infrastructure (e.g., A11 Monitoring, A15 High Availability, A16 SIEM); as well as APP.3.2 Virtualisierung and SYS.2.5 Client-Virtualisierung.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_Virtualization_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Flags a likely VDI management plane when a central in-scope technical asset with technology in {ApplicationServer, WebServer, Gateway, Management} has outbound communication links to more than Quantity.Few distinct client endpoints whose technology is {Desktop, ClientSystem}. The more desktop/client links, the stronger the signal. Likelihood is further increased when the asset is internet-facing or has custom-developed parts (single instance, no redundant peers). Excludes out-of-scope assets. Heuristics mirror: count = manager.communicationLinks → unique targets filtered by client tech; threshold = getQuantityFactor(Quantity.Few).",
        "riskAssessment": "Impact scales with the number of governed clients (Many ⇒ High, VeryMany ⇒ VeryHigh) and is elevated to High/VeryHigh when any client handles Confidential/StrictlyConfidential data. Likelihood starts Unlikely, becomes Likely if the manager has custom-developed parts, and VeryLikely if it is internet-reachable. Data breach probability rises from Improbable → Possible (Restricted) → Probable (Confidential+).",
        "falsePositives": "Other central systems with many desktop connections (e.g., software deployment/patching, endpoint management/MDM, monitoring, remote assistance, directory services) can match the pattern. Confirm the role by name/description/tags, network placement (admin network), and presence of VDI agents/templates before triaging. If noise is high, tag true VDI managers accordingly and suppress non-VDI managers via model metadata.",
        "cwe": "732",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "101_sec7.ts",
        "bsiCode": "SYS.2.6",
        "id": "vdi-outdated-template",
        "title": "Outdated VDI Template Enables Known Vulnerabilities (BSI SYS.2.6 §2.7, A9)",
        "description": "In a Virtual Desktop Infrastructure (VDI), virtual clients are provisioned from master images (templates).",
        "impact": "A compromised desktop provisioned from an outdated template can provide initial access, enable lateral movement, and lead to unauthorized data access or service disruption.",
        "action": "Place all VDI master templates under formal patch management with regular, documented recompose cycles.",
        "mitigation": "Maintain a hardened, versioned golden image; scan it routinely for vulnerabilities; apply vendor and OS patches;",
        "check": "Is there a schedule and evidence for rebuilding and patching VDI golden images?",
        "asvs": "BSI IT-Grundschutz: SYS.2.6 Virtual Desktop Infrastructure — Section 2.7 (Use of templates with software vulnerabilities) and Requirement A9 (Patch and Change Management).",
        "cheatSheet": "Ensure golden images are patch-managed, regularly rebuilt/recomposed, and that existing pools are refreshed/reprovisioned after image updates.",
        "detectionLogic": "Marks technical assets of type 'datastore' tagged with @System:VDI that are not also tagged with patch-managed.",
        "riskAssessment": "Likelihood is very likely because outdated images accumulate known, widely exploitable issues.",
        "falsePositives": "Staging or isolated lab templates that cannot be accessed by other systems may be flagged if they lack the mitigation tag.",
        "cwe": "1119",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "SYS.3.1": [
      {
        "file": "102_sec1.ts",
        "bsiCode": "SYS.3.1",
        "id": "mobile-client-in-untrusted-environment",
        "title": "Mobile Clients on Untrusted Networks (aligned with BSI SYS.3.1 Laptops)",
        "description": "Laptops and other mobile clients are used in diverse, often untrusted environments.",
        "impact": "Connecting a mobile client to an untrusted network without proper safeguards can lead to device compromise.",
        "action": "Require a secure tunnel (VPN or ZTNA) and harden endpoints for mobile use",
        "mitigation": "Route all traffic from mobile clients on external networks through a mandatory, system-enforced VPN or ZTNA tunnel.",
        "check": "Is a system-enforced VPN/ZTNA required off-premises? Is there a technical control preventing bypass (no split tunneling for sensitive apps)?",
        "asvs": "BSI IT-Grundschutz SYS.3.1 (Laptops); OWASP MASVS-NETWORK; OWASP ASVS V9 (Communications); CIS Safeguards 12 & 13.",
        "cheatSheet": "",
        "detectionLogic": "Flags any communication link where: (1) the source is a client technology marked as internet-facing (`internet: true`),",
        "riskAssessment": "Likelihood is very high for clients on public networks. Impact scales with the sensitivity of data stored on the client and sent over the link.",
        "falsePositives": "May be a false positive when an always-on, system-level VPN/ZTNA is enforced outside the model; when a secure gateway is modeled elsewhere;",
        "cwe": "319",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "102_sec2.ts",
        "bsiCode": "SYS.3.1",
        "id": "laptop-theft-or-loss-con1",
        "title": "Theft or Loss of Laptops (BSI CON.1)",
        "description": "Employees often use their laptops outside the institution's premises. The devices are transported in private vehicles or on public transport, left unattended in external offices during breaks, or kept in hotel rooms.",
        "impact": "If an unencrypted laptop containing sensitive data is lost or stolen, it can lead to a severe data breach (Confidentiality), permanent data loss if not backed up (Availability), and significant financial and reputational damage.",
        "action": "Enforce Full-Disk Encryption on Laptops",
        "mitigation": "All laptops that may store or process sensitive data must have full-disk encryption (FDE) enabled (e.g., BitLocker for Windows, FileVault for macOS). This should be enforced via technical policy (e.g., MDM, GPO).",
        "check": "Are all laptops, especially those used by mobile workers, confirmed to have full-disk encryption enabled and enforced by policy? Are there regular backups of important data stored on these laptops?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1: Laptops. This risk directly corresponds to the threats CON.1.G1 (Theft of a laptop) and CON.1.G2 (Loss of a laptop). The primary mitigation is covered by requirement CON.1.A5 (Hard disk encryption on laptops).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Laptops_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset identified as a client-type system (e.g., technology 'client-system', 'desktop', 'mobile-app') that stores data but does not have data-at-rest encryption enabled ('encryption: none').",
        "riskAssessment": "The likelihood of theft or loss for a mobile device like a laptop is inherently high. The exploitation of this (i.e., accessing the data) is trivial if the disk is unencrypted. Therefore, the likelihood is considered 'Very Likely'.",
        "falsePositives": "This risk might be considered a false positive for an asset that, while modeled as a 'desktop', is a stationary machine in a physically secure location (e.g., a locked office or data center) that never moves.",
        "cwe": "311",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "102_sec3.ts",
        "bsiCode": "SYS.3.1",
        "id": "uncontrolled-shared-device-handover",
        "title": "Uncontrolled Handover of Shared Laptops (BSI SYS.3.1, Section 2.3)",
        "description": "Sharing laptops as pool devices without a formal process creates a persistent risk of data remanence and cross-user contamination.",
        "impact": "Potential confidentiality breaches (exposure of another user’s data), integrity violations (malware/tampering), and availability impacts (device quarantined or re-imaged).",
        "action": "Define and enforce a check-in/check-out and sanitization process for pool laptops",
        "mitigation": "Enforce an MDM-driven wipe or re-imaging from a golden image between users; require full-disk encryption with pre-boot authentication;",
        "check": "Is there a documented policy for pool devices? Is an MDM policy enforcing wipe/re-image between users? Are custody logs complete and auditable?",
        "asvs": "BSI IT-Grundschutz: SYS.3.1.A7 Geregelte Übergabe und Rücknahme; SYS.3.1.A13 Verschlüsselung von Laptops; CON.3.A13 Reissuing and returning mobile devices",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_devices_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Flags in-scope client assets explicitly tagged 'shared-device'. Impact is derived from the asset’s highest confidentiality or integrity;",
        "riskAssessment": "Likelihood: Likely for any asset tagged as shared. Impact tiers: Medium if confidentiality ≥ Restricted or integrity ≥ Important;",
        "falsePositives": "Possible if a robust, enforced wipe/re-image process (via MDM), ephemeral profiles, and custody logging exist but are not modeled.",
        "cwe": "212",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "SYS.3.2.1": [
      {
        "file": "103_sec1.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "unsupported-mobile-os",
        "title": "Risk from Outdated or Unsupported Mobile Operating Systems",
        "description": "Mobile operating systems receive frequent updates, but device manufacturers (OEMs) must first integrate and distribute them, often leading to delays.",
        "impact": "Exploiting an unpatched vulnerability in a mobile OS can lead to a full compromise of the device.",
        "action": "Enforce Mobile OS Version and Patch Level Management",
        "mitigation": "Implement a Mobile Device Management (MDM) solution to enforce security policies on all mobile devices accessing corporate data or systems.",
        "check": "Is there a Mobile Device Management (MDM) solution in use? Does it enforce minimum OS and patch-level policies?",
        "asvs": "BSI IT-Grundschutz SYS.3.2.1 Allgemeine Smartphones und Tablets, requirement A5 (Updates von Betriebssystem und Apps), and SYS.3.2.2 Mobile Device Management (MDM).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/sys/SYS_3_2_1_Allgemeines_Mobiltelefon_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Triggers for any technical asset of technology type 'mobile-app' that is not explicitly tagged as being managed by an MDM solution",
        "riskAssessment": "The likelihood is very high for unmanaged mobile fleets, as users often delay or ignore updates, and older devices remain in use.",
        "falsePositives": "This risk can be considered a false positive if an effective MDM or a similar compensating control for OS patch management is in place but has not been documented in the model by applying the 'mobile-os-patch-management-mdm' tag to the asset.",
        "cwe": "937",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "103_sec10.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "privilege-escalation-on-mobile-os-sys3.1.a5",
        "title": "Privilege Escalation on Mobile Devices via OS Vulnerabilities (Jailbreaking/Rooting)",
        "description": "Vulnerabilities are frequently discovered in smartphone and tablet operating systems that allow attackers to bypass established security controls. This enables unauthorized access to system processes and protected memory areas. Attackers can exploit these weaknesses, often using techniques similar to user-initiated 'jailbreaking' or 'rooting', to install malware or execute other malicious actions.",
        "impact": "Successful exploitation allows an application to gain unintended privileges (Elevation of Privilege), enabling it to execute unauthorized actions. This could include accessing sensitive data from the OS or other apps, installing malware, or manipulating the device. This compromises the confidentiality and integrity of data on the device and can lead to a complete takeover of the asset.",
        "action": "Implement Jailbreak/Root Detection and Use Mobile Device Management",
        "mitigation": "For mobile applications handling sensitive data, implement robust jailbreak/root detection mechanisms to prevent the app from running on a compromised device or to operate it in a limited-functionality mode. Keep mobile operating systems and all applications up to date with the latest security patches. Employ Mobile Device Management (MDM) solutions to enforce security policies, such as disallowing rooted/jailbroken devices from accessing corporate resources. The risk can be marked as mitigated by tagging the mobile-app asset with `@root-detection:implemented`.",
        "check": "Does the mobile application implement root/jailbreak detection? Are mobile devices managed by an MDM solution that enforces policies against compromised devices? Is there a process for ensuring mobile OS and app updates are applied promptly?",
        "asvs": "BSI IT-Grundschutz SYS.3.1.A5 (Bypassing security mechanisms through jailbreaking or rooting)",
        "cheatSheet": "https://www.owasp.org/index.php/Mobile_Top_10_2016-M1-Improper_Platform_Usage",
        "detectionLogic": "This risk is generated for all in-scope technical assets of technology 'Mobile App'. The risk is assumed to be present unless explicitly mitigated via the `@root-detection:implemented` tag on the asset.",
        "riskAssessment": "The likelihood is considered 'likely' due to the frequent discovery of OS vulnerabilities and the widespread availability of exploitation tools. The impact is directly proportional to the sensitivity (confidentiality and integrity) of the data processed or stored by the application on the mobile device. An application handling 'Strictly Confidential' data is likely to have a 'High' or 'Very High' impact.",
        "falsePositives": "This risk might be considered a false positive if the application handles only non-sensitive, public data, or if it has exceptionally strong, state-of-the-art anti-tampering and root/jailbreak-detection controls that are not captured by the simple mitigation tag.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "103_sec2.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "@Maintenance:Unmaintained-preinstalled-or-third-party-software",
        "title": "@Maintenance:Unmaintained Preinstalled or Third-Party Software",
        "description": "Preinstalled or third-party applications may contain vulnerabilities exploitable via local or network attacks.",
        "impact": "If vulnerabilities in such components are exploited, it can lead to a full compromise of the technical asset, resulting in unauthorized access to or modification of data (Confidentiality, Integrity), Denial of Service (Availability), or the asset being used as a pivot point for further attacks within the architecture.",
        "action": "Manage Third-Party Component Lifecycle",
        "mitigation": "Maintain a complete inventory of all third-party and preinstalled software components (a 'Software Bill of Materials' or SBOM).",
        "check": "Is there a complete inventory of all third-party software components? Are SCA tools used to scan for vulnerabilities? Is there a defined process for handling vulnerable or @Maintenance:Unmaintained components?",
        "asvs": "OWASP ASVS V14: Software Component Verification Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for technical assets explicitly tagged as `@Maintenance:Unmaintained`.",
        "riskAssessment": "The likelihood is **Very Likely** if an asset is explicitly tagged as @Maintenance:Unmaintained. It is **Likely** for other non-custom components where the maintenance status is unknown.",
        "falsePositives": "This risk might be a false positive if an asset is not tagged but is flagged due to its technology type, yet a robust vulnerability and patch management process is demonstrably in place for all its third-party components.",
        "cwe": "1104",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "103_sec3.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "unauthorized-manipulation-of-mobile-devices",
        "title": "Unauthorized Manipulation of Mobile Devices (Smartphones & Tablets)",
        "description": "Attackers may gain access to smartphones or tablets and manipulate them by changing configurations, starting unauthorized services,",
        "impact": "Manipulation can degrade the integrity and confidentiality of data on the device and in transit; enable credential or session theft;",
        "action": "Harden mobile endpoints and apps: enforce MDM, use a strong lock screen, minimize permissions, encrypt communications, disable sideloading and debugging,",
        "mitigation": "Use an MDM to enforce policies (screen lock, biometric policies, encryption, VPN, app allowlists/denylists).",
        "check": "Is MDM enrollment mandatory and compliant? Are OS and app updates automated and timely? Are developer options and sideloading disabled?",
        "asvs": "OWASP MASVS v2: MASVS-STORAGE, MASVS-NETWORK, MASVS-PLATFORM",
        "cheatSheet": "OWASP MSTG & MASVS: https://owasp.org/www-project-mobile-app-security/ | https://mas.owasp.org/",
        "detectionLogic": "Triggers for every in-scope TechnicalAsset with technology 'MobileApp'. Likelihood is derived from internet exposure:",
        "riskAssessment": "Internet-accessible mobile apps that process sensitive data (e.g., PII/health/location) have higher severity.",
        "falsePositives": "May be less relevant for tightly locked-down, single-purpose devices (e.g., kiosk devices) operating in isolated environments",
        "cwe": "284",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "103_sec4.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "malware-on-mobile-devices",
        "title": "Mobile Malware on Smartphones & Tablets",
        "description": "Mobile devices are attractive targets for malware. While overall infection rates may be lower than on desktop systems, the ubiquity of apps, always-on connectivity (cellular, Wi-Fi, Bluetooth, NFC), and user-driven installation patterns create a meaningful attack surface. Obtaining apps from untrusted sources, lagging OS/app updates, or using rooted/jailbroken devices significantly increases risk.",
        "impact": "Compromise can lead to loss of confidentiality, integrity, and availability of data on the device, credential theft, session hijacking, unauthorized transactions, and lateral movement into backend services. Attackers may impersonate users and exfiltrate sensitive organizational information.",
        "action": "Deploy and enforce MDM/MAM; restrict app sources to official stores; ensure timely OS/app patching; use app vetting for sensitive use cases.",
        "mitigation": "Use MDM/MAM to enforce: store-only app installation, timely OS/app updates, device encryption, screen-lock policies, and disabling unused radios/interfaces; monitor app permissions (camera, mic, location, health data) per data-protection policy; implement strong authN/Z on backends to limit impact of compromised clients; consider app attestation and runtime protections for high-risk apps.",
        "check": "Is MDM/MAM in place and enforced? Are non-store app installs blocked? Are OS/app updates mandated and verifiable? Are sensitive permissions restricted by policy? Do backend systems require strong, device-agnostic authentication and least privilege to withstand a compromised mobile client?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.5 — Schutz vor Schadprogrammen",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Protection_against_malware_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "Automatically flags every in-scope technical asset with technology 'Mobile App'. Impact is raised when the app processes or stores sensitive data (Confidentiality ≥ Confidential, Integrity/Availability ≥ Critical). Impact escalates to High if the app handles Strictly Confidential data, is Mission-Critical, or communicates with in-scope, backend-only systems that have high confidentiality or integrity requirements.",
        "riskAssessment": "Baseline likelihood is set to 'Likely' due to the prevalence of mobile malware. Impact scales with the app’s highest confidentiality/integrity/availability and is further elevated when connecting to sensitive backend services. Data breach probability is 'Probable' if the app handles confidential data; otherwise 'Possible'.",
        "falsePositives": "Risk may be reduced if a mature, enforced MDM/MAM is deployed (store-only installs, rapid patching, encryption, strict permission controls), devices are not rooted/jailbroken, sensitive apps use attestation and runtime protections, and backends strictly enforce authentication/authorization to contain compromised clients.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "103_sec5.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "web-based-attacks-on-mobile-clients",
        "title": "Web-Based Attacks on Mobile Clients",
        "description": "Mobile browsers, as well as many other apps, can display web pages and web content.",
        "impact": "A successful attack can lead to the installation of malware (violating Integrity),",
        "action": "Secure Client-Side Web Content Handling",
        "mitigation": "Ensure that components rendering web content (e.g., WebViews) are kept up-to-date and configured securely,",
        "check": "Are mobile applications and browsers kept up-to-date? Are secure configurations for WebViews enforced?",
        "asvs": "OWASP MASVS v8.1 (MSTG-CODE-1): The app is vulnerable to WebView-related issues.",
        "cheatSheet": "https://mas.owasp.org/MASTG/tests/android/MASTG-TEST-0050/",
        "detectionLogic": "This risk is raised for technical assets identified as internet-facing mobile clients",
        "riskAssessment": "The likelihood is high for any mobile client that browses the general internet.",
        "falsePositives": "This risk can be considered a false positive if the application only renders fully static, trusted,",
        "cwe": "829",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "103_sec6.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "unauthorized-access-to-mobile-health-location-data",
        "title": "Mobile: Exposure of Health, Fitness, and Location Data (BSI SYS.3.2.1 §2.6)",
        "description": "Smartphones and tablets often aggregate highly sensitive health, fitness, and location data.",
        "impact": "Exploitation can disclose special category personal data, causing severe privacy violations, identity-theft risks, potential physical safety issues, and major regulatory and reputational harm to the organization.",
        "action": "Enforce at-rest encryption and TLS-only communication for mobile apps; manage devices via MDM and harden app permissions.",
        "mitigation": "Encrypt sensitive data at rest with strong, user- or device-bound keys (e.g., OS Keychain/Keystore, file-based encryption).",
        "check": "Verify that mobile apps do not store sensitive data unencrypted and that all communication links use TLS (e.g., HTTPS).",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.2.1 §2.6 'Missbrauch von Gesundheits-, Fitness- und Ortungsdaten' and aligned with measures such as A11 (storage encryption), A22 (VPN), A32 (MDM), and A33 (security apps).",
        "cheatSheet": "Prioritize at-rest encryption using platform keystores, TLS-only transport (HTTPS/WSS), strong authentication, least-privilege data access, MDM-enforced policies, and disable sensitive lock screen previews.",
        "detectionLogic": "Detects in-scope technical assets of technology 'MobileApp' that process data assets tagged with @PiiType:Health, @PiiType:Fitness, or @PiiType:Location.",
        "riskAssessment": "Impact is 'Very High' due to strictly confidential personal data (health/location). Likelihood becomes 'Very Likely' when encryption at rest or in transit is missing, producing a critical severity.",
        "falsePositives": "Possible if OS-level storage encryption is active but not modeled, or if compensating controls (e.g., an always-on, enforced enterprise VPN with strict split-tunneling restrictions) are mandated.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "103_sec7.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "lock-screen-information-disclosure-on-mobile-devices",
        "title": "Lock-Screen Information Disclosure on Smartphones and Tablets",
        "description": "Most mobile operating systems can display notifications from widgets and push messages on the lock screen. This may expose confidential information to unauthorized persons who can exploit it. Voice assistants may allow access to phone functions and contact data even when the device is locked, potentially exposing confidential information. Furthermore, interfaces such as Wi-Fi or Bluetooth are often configurable while the device is locked. For example, an attacker with physical access could enable Bluetooth, creating an additional attack vector.",
        "impact": "Unauthorized persons with physical access to the device can view confidential information (e.g., message previews, calendar entries, one-time authentication codes) without unlocking it. This can cause privacy violations, data leakage, and follow-on attacks based on the disclosed information. Enabling interfaces like Bluetooth can also expose the device to additional remote attacks.",
        "action": "Implement Secure Notification Handling and User Guidance",
        "mitigation": "Applications should handle notifications securely by default. Use platform APIs to mark notifications that contain sensitive data as private so their content is not shown on the lock screen (e.g., Android `Notification.VISIBILITY_PRIVATE`). Avoid placing sensitive details in notification titles, which may still be visible. In addition, provide clear guidance to users on configuring lock-screen notification settings for maximum privacy. For any voice-assistant integration, require user authentication for sensitive actions or data retrieval.",
        "check": "Are notifications that may contain sensitive data configured to hide their content on the lock screen? Does the application's security documentation advise users on device settings for privacy? Is any voice-assistant integration designed to prevent unauthenticated access to sensitive functions or data?",
        "asvs": "OWASP MASTG: MSTG-PLATFORM-9 (Remove sensitive data from views when the app moves to the background)",
        "cheatSheet": "https://mas.owasp.org/MASTG/tests/android/MASTG-TEST-0045/",
        "detectionLogic": "This risk applies to all in-scope technical assets with technology 'MobileApp' or 'IoTDevice' that process or store data. It assumes these applications may send notifications related to the data they handle. The impact is determined by the highest confidentiality level of the data assets associated with the mobile component.",
        "riskAssessment": "The likelihood is 'Likely' for interactive mobile or IoT applications, as sending notifications is common. The impact depends on the sensitivity of information that could be exposed. If the application handles 'Strictly Confidential' data, the impact is 'High'; for 'Confidential' data, 'Medium'; otherwise 'Low'. Physical access to the device is a prerequisite for exploitation.",
        "falsePositives": "This risk may be a false positive if the application never sends notifications, or if all notifications are generic and contain no sensitive or user-specific content. The risk may also be mitigated at the OS level, but the application should still implement secure defaults.",
        "cwe": "200",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "103_sec8.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "private-use-of-company-mobile-devices",
        "title": "Private Use of Company-Owned Mobile Devices (BSI CON.3)",
        "description": "When employees use company-owned smartphones and tablets for private purposes, multiple information-security risks can arise.",
        "impact": "Allowing private use of company devices without proper controls can lead to data breaches, malware infections, and compliance violations.",
        "action": "Implement controls for the private use of company mobile devices",
        "mitigation": "The most effective mitigation is to implement a Mobile Device Management (MDM) solution.",
        "check": "Is there a policy for the private use of company mobile devices? Is a Mobile Device Management (MDM) or Mobile Application Management (MAM) solution in place?",
        "asvs": "Derived from the BSI IT-Grundschutz Baustein CON.3 'Mobile Device Management'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_Device_Management_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers on technical assets of technology type 'Mobile App' that are explicitly tagged with `private-use-allowed`.",
        "riskAssessment": "The likelihood of exploitation is very high if private use is allowed without any central management or security controls. The presence of an MDM solution reduces the likelihood but does not eliminate it entirely.",
        "falsePositives": "The model might not capture the full extent of security policies enforced by an MDM. A risk might be flagged even if specific compensating controls (such as a very restrictive app allowlist) exist but are not modeled with a tag.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "103_sec9.ts",
        "bsiCode": "SYS.3.2.1",
        "id": "insecure-private-device-usage-con3",
        "title": "BYOD: Insecure Use of Private Mobile Devices (BSI CON.3)",
        "description": "When privately owned mobile devices are used for business (BYOD), organizations face reduced control over platform hardening and lifecycle, increasing the chance of policy violations, insecure configurations, and data leakage. Repairs, resale, or loss of such devices can expose corporate data to unauthorized parties. Licensing issues, accidental corporate data wipes via MDM, and unclear offboarding procedures further amplify risk.",
        "impact": "Compromise of confidentiality and integrity of corporate data (e.g., @DataType:PII), regulatory non-compliance, legal exposure (licensing, privacy), operational disruption, and reputational damage. Loss, theft, or improper device decommissioning may cause irreversible data exposure or loss.",
        "action": "Define, implement, and enforce a comprehensive BYOD policy with technical enforcement (e.g., MDM/EMM).",
        "mitigation": "Publish a formal BYOD policy that mandates minimum device security (OS version/support window, screen lock, full-disk encryption, anti-malware where feasible), clarifies data ownership and user responsibilities, and restricts app sources. Enforce via MDM/EMM with device compliance checks, containerization/work profiles, remote wipe, and certificate-based network access. Establish strict onboarding/offboarding to ensure corporate data is removed upon role changes or departure.",
        "check": "Is there a documented BYOD policy with minimum device baselines? Are private devices enrolled in MDM/EMM and measured for compliance (encryption, lock, OS patch level)? Are data separation and approved app sources enforced? Are offboarding and remote-wipe procedures tested?",
        "asvs": "Reference: BSI IT-Grundschutz Baustein CON.3 (Mobile device concept), esp. CON.3.A5 (Regulations for the use of private mobile devices/BYOD).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_device_concept_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.3)",
        "detectionLogic": "Raised for each in-scope technical asset that (1) is a client technology (e.g., mobile app, browser, desktop) and (2) carries the tag '@device-owner:private'. Impact scales with the asset’s highest confidentiality/integrity classification. Each qualifying asset yields a synthetic risk id '<categoryId>@<assetId>' and points to the device (and its trust boundary) as the affected element.",
        "riskAssessment": "Likelihood is set to Likely for private devices used in business contexts due to common policy gaps and weaker control. Impact scales with data sensitivity: handling restricted/ confidential or mission-critical information increases impact. Breach probability grows with the same factors.",
        "falsePositives": "May be reduced or inapplicable if a robust, enforced BYOD program exists with device compliance checks, containerization, and continuous monitoring that demonstrably meets organizational requirements—even though the model contains a private device.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "SYS.3.2.2": [
      {
        "file": "104_sec1.ts",
        "bsiCode": "SYS.3.2.2",
        "id": "mdm-synchronization-gap",
        "title": "MDM Synchronization Gap (BSI SYS.3.2.2)",
        "description": "Mobile devices must regularly check in with the MDM to receive policies, enforce them, and allow remote actions (e.g., remote wipe).",
        "impact": "Missing synchronization leaves devices out of compliance and vulnerable. The inability to trigger a remote wipe on a lost or stolen device can cause severe data exposure, harming confidentiality and integrity and potentially causing financial, legal, and reputational damage.",
        "action": "Model and monitor regular MDM synchronization",
        "mitigation": "Configure all managed devices to synchronize with the MDM server on a defined cadence (e.g., at least daily). Monitor check-in status centrally and alert when devices miss that threshold. Define procedures for long-offline devices (temporary access suspension, user notification, escalation). Explicitly model the communication link between mobile clients and the MDM server.",
        "check": "Does every modeled mobile device have a communication link to at least one asset tagged '@System:MDM'? Is a central MDM server modeled and tagged? In practice, is a sync interval/SLA defined and monitored with alerting for missed check-ins?",
        "asvs": "BSI IT-Grundschutz SYS.3.2.2 Mobile Device Management (MDM), especially threat 2.1 'Keine ausreichende Synchronisation mit dem MDM' and requirements A22 (Remote wipe) and A20 (Regular review).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_3_Mobile_Device_Management_MDM_Edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "For each in-scope mobile client (technology 'mobile-app' or tagged '@System:MDM'), check for a direct communication link to at least one technical asset tagged '@System:MDM' (treated as the MDM server). If no such direct link exists, raise this risk because policy synchronization and remote administration are not modeled as possible.",
        "riskAssessment": "Likelihood is high whenever the model lacks an MDM link, since synchronization cannot occur. Impact scales with the maximum confidentiality and integrity of data on the device—devices handling 'Strictly Confidential' data have a very high impact if they cannot be wiped.",
        "falsePositives": "Possible if the MDM server or its connectivity is not modeled (e.g., managed by an external service) or if synchronization is implicit. Ensure all mobile endpoints and the MDM server are modeled and linked explicitly.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "104_sec2.ts",
        "bsiCode": "SYS.3.2.2",
        "id": "misconfiguration-of-@System:MDM",
        "title": "Misconfiguration of Mobile Device Management (MDM)",
        "description": "MDM platforms orchestrate policies, apps, certificates, and device posture across fleets of smartphones and tablets. Their rule sets are large and interdependent; even small mistakes can ripple through thousands of devices. This risk captures misconfigurations that weaken the protection of managed endpoints and the MDM itself.",
        "impact": "A single faulty policy can propagate instantly to many devices, enabling unauthorized access, disabling essential controls (e.g., screen lock, encryption), breaking compliance, or preventing remote wipe. Consequences include data exfiltration, malware spread, service outages, and regulatory penalties with financial and reputational damage.",
        "action": "Harden the MDM, baseline its configuration, and enforce change control with peer review and automated drift detection.",
        "mitigation": "Define a vendor-aligned hardening baseline and apply least privilege. Gate all rule changes via formal change management with dual control. Continuously audit for drift and unsupported OS versions; automate checks where possible. Ensure administrators are trained and use separate, MFA-protected accounts.",
        "check": "Is there a documented, approved hardening baseline for the MDM? Are policy changes peer-reviewed and tracked? Are configurations automatically audited for drift and unsupported OS versions? Are admin roles least-privileged and protected with MFA?",
        "asvs": "V14.2.1 Secure Configuration; V1.14 Configuration Management",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Mobile_App_Security_Testing_Cheat_Sheet.html",
        "detectionLogic": "Triggers for any in-scope technical asset tagged '@System:MDM' (the MDM server/tenant). Managed endpoints are derived from the MDM’s outgoing communication links: every in-scope client-technology asset and any asset explicitly tagged '@System:MDM' are considered managed. Impact is based on the maximum Confidentiality/Integrity/Availability across the MDM and all managed endpoints. Impact tiers elevate to Medium if Confidentiality ≥ Confidential or Integrity/Availability ≥ Critical; to High if Confidentiality ≥ StrictlyConfidential or Integrity/Availability ≥ MissionCritical; and to VeryHigh when more than five endpoints are managed and sensitive/critical levels apply. Data breach probability is Possible if at least one managed endpoint exists; otherwise, Improbable. The risk lists the MDM and all managed endpoints as affected assets.",
        "riskAssessment": "Likelihood: Likely, given the complexity and change frequency of MDM deployments. Impact scales with the most sensitive data and criticality present on managed devices; environments handling Strictly Confidential data or Mission-Critical services drive High to VeryHigh impact, especially with many endpoints.",
        "falsePositives": "Lower risk where the MDM scope is minimal (few devices, non-sensitive data) and there is strong evidence of mature configuration management, automated compliance checks, continuous auditing, and rapid drift detection. Sandbox or read-only pilots may also reduce relevance.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "104_sec3.ts",
        "bsiCode": "SYS.3.2.2",
        "id": "incorrect-mdm-role-assignment-sys-3-2-2",
        "title": "Incorrect Role Assignment in MDM (BSI SYS.3.2.2)",
        "description": "The permission management of a Mobile Device Management (MDM) system controls which users can change settings on mobile devices and who can access which data (see BSI SYS.3.2.2, section 2.3).",
        "impact": "Incorrectly assigned roles in an MDM can lead to unauthorized access to sensitive data, modification of critical device configurations, installation of malicious or unapproved software, data leakage, and violations of legal or regulatory data-protection requirements. Impact scales with the confidentiality, integrity, and availability (CIA) of the managed devices and the data they process.",
        "action": "Implement and enforce a least-privilege, role-based access control (RBAC) model for the MDM, with change approvals and regular reviews.",
        "mitigation": "Design and implement a detailed RBAC model for the MDM based on the principle of least privilege.",
        "check": "Is there a documented, approved RBAC concept for the MDM? Are user-to-role assignments and admin privileges reviewed at least quarterly (A20)?",
        "asvs": "Based on the BSI IT-Grundschutz module SYS.3.2.2 Mobile Device Management (MDM) (especially section 2.3 and requirement A20) and related to ORP.4 Identity and Access Management.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_2_Mobile_Device_Management_MDM_Edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "Raised for any technical asset tagged '@System:MDM'. The rule inspects outgoing communication links from the MDM to assets with the technology 'MobileApp' and aggregates the highest Confidentiality/Integrity/Availability across those devices to scale impact.",
        "riskAssessment": "Likelihood is 'Likely' by default, reflecting the complexity and error-prone nature of role management without mature processes.",
        "falsePositives": "May be flagged even when robust IAM processes exist (e.g., strong segregation of duties, change approvals, periodic recertification, and automated compliance).",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "104_sec4.ts",
        "bsiCode": "SYS.3.2.2",
        "id": "unauthorized-location-tracking-mdm-sys321",
        "title": "Unauthorized Location Tracking and Misuse via MDM (BSI SYS.3.2.2)",
        "description": "Most Mobile Device Management (MDM) products can determine a device's current location and use it for 'geofencing' to grant or deny access to data and applications.",
        "impact": "If sensitive location data and movement profiles are leaked or misused, it can lead to severe privacy violations, compromise the personal safety of individuals, and result in significant legal and financial penalties for the organization due to non-compliance with data protection laws. Illicit surveillance can also damage employee trust and lead to legal disputes.",
        "action": "Implement Strict Controls, Policies, and Transparency for Location Services",
        "mitigation": "Disable location tracking capabilities within the MDM system by default. Only enable them if there is a compelling, documented, and lawful business purpose.",
        "check": "Is location tracking enabled in the MDM system? If so, is there a documented, legitimate business need? Are users explicitly informed and have they provided consent? Are there strict access controls and a formal policy governing the use of this data?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.2.2 Mobile Device Management (MDM)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Mobile_Device_Management_MDM_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any technical asset identified as a Mobile Device Management (MDM) system via the '@System:MDM' tag.",
        "riskAssessment": "The likelihood is considered 'Likely' because location tracking is a standard feature in most MDM products. The impact is rated as 'High' by default due to the sensitivity of personal location data.",
        "falsePositives": "This risk can be considered a false positive if location tracking features are technically disabled and cannot be re-enabled, or if the system is used exclusively for tracking non-personal assets (e.g., logistics vehicles) where privacy regulations for individuals do not apply.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "SYS.3.2.3": [
      {
        "file": "105_sec1.ts",
        "bsiCode": "SYS.3.2.3",
        "id": "unauthorized-apple-id-access",
        "title": "Unauthorized Access to an Insufficiently Secured Apple ID (BSI SYS.3.2.3)",
        "description": "An Apple ID is the central account for Apple services (iMessage, FaceTime, iCloud, App Store, Find My, etc.). If attackers gain access to a weakly protected Apple ID used for enterprise purposes, they can disrupt services, locate or remotely erase iOS devices, and access iCloud data and backups—including potentially cloning device data to another device.",
        "impact": "A compromise can breach confidentiality (iCloud data, messages, location), undermine integrity (remote wipe or device control), and harm availability (service disruption). Consequences include data exposure, operational impact, financial loss, and reputational damage.",
        "action": "Secure Apple IDs with strong authentication and management controls",
        "mitigation": "Protect any Apple ID used for business with a strong, unique password and mandatory two-factor authentication (2FA). Prefer Managed Apple IDs via Apple Business Manager for organizational control. Tag the relevant asset with '@AppleID-2FA-Enabled' to indicate 2FA is enforced.",
        "check": "Does the asset require an Apple ID? Is 2FA verifiably enabled for that Apple ID (ideally a Managed Apple ID)? Are passwords unique and strong per policy?",
        "asvs": "Derived from BSI IT-Grundschutz and best practices; aligns with OWASP ASVS (Authentication Verification Requirements).",
        "cheatSheet": "https://support.apple.com/en-us/102652",
        "detectionLogic": "Flags every in-scope technical asset tagged '@AppleIDRequired'. If the same asset is tagged '@AppleID-2FA-Enabled', the likelihood is lowered. Impact is derived from the asset’s highest CIA levels and the most sensitive processed or stored data asset is referenced. Out-of-scope assets are ignored.",
        "riskAssessment": "Likelihood: Likely without 2FA; Unlikely with 2FA. Impact: Medium by default; High if the asset handles ≥ Confidential data or has ≥ Critical integrity/availability; Very High if Strictly Confidential data or Mission-Critical integrity/availability. Data breach probability: Improbable with 2FA; Probable when impact ≥ High without 2FA; otherwise Possible.",
        "falsePositives": "May be overreported if the Apple ID is constrained to non-critical, isolated use (e.g., VPP-only app assignment) without access to sensitive data or device management capabilities.",
        "cwe": "306",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "105_sec2.ts",
        "bsiCode": "SYS.3.2.3",
        "id": "elevated-privileges-of-preinstalled-ios-apps",
        "title": "Elevated Privileges of Preinstalled iOS Apps",
        "description": "Apple ships iOS with preinstalled apps (e.g., Mail, Safari) that often run with higher privileges than apps downloaded from the App Store. This increases the device's attack surface, as vulnerabilities in these apps can have a greater impact.",
        "impact": "If a vulnerability in one of these preinstalled, high-privilege apps is exploited, an attacker could gain elevated access to device resources, data, or functions. This could bypass security controls, enable unauthorized data access, or lead to a full device compromise.",
        "action": "Harden device configurations and limit the use of preinstalled apps for sensitive tasks.",
        "mitigation": "Because these privileges are built-in, direct mitigation is limited. However, risk can be reduced by: 1. Keeping iOS and all apps regularly updated to patch known vulnerabilities. 2. Using a Mobile Device Management (MDM) solution to enforce security policies and restrict app functionality. 3. For highly sensitive operations, consider dedicated, hardened third-party apps with a smaller, more auditable feature set instead of default apps like Mail or Safari. 4. Educate users about the risks of opening suspicious links or attachments in these applications.",
        "check": "Are the devices running iOS? Are default, preinstalled apps such as Safari and Mail used to process or access sensitive data? Is an MDM solution in place to manage and restrict these applications? Are devices and apps kept consistently up to date?",
        "asvs": "Not applicable. This is a platform-level risk inherent to the iOS ecosystem. Related concepts are covered in the OWASP Mobile Security Testing Guide (MSTG), particularly around platform interaction and privilege models (MSTG-PLATFORM-1, MSTG-PLATFORM-2).",
        "cheatSheet": "https://developer.apple.com/support/security/",
        "detectionLogic": "This risk triggers for any technical asset representing an iOS-based client device. It checks for assets with client-side technologies (e.g., 'mobile-app', 'mobile-device') that are tagged to indicate the iOS platform (e.g., '@Platform:iOS').",
        "riskAssessment": "The likelihood of exploitation is generally 'Unlikely' for a fully patched device against unknown vulnerabilities but can increase if patches are not applied promptly. The impact is directly related to the sensitivity of the data processed by the device. A compromise of a device handling 'Strictly Confidential' data can have a 'High' or 'Very High' impact.",
        "falsePositives": "This risk may be treated as a false positive or 'Accepted' if the device is used in a completely isolated, low-sensitivity environment where a compromise would have no significant impact, or if an MDM solution severely restricts preinstalled applications to the point that they cannot access sensitive data.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "105_sec3.ts",
        "bsiCode": "SYS.3.2.3",
        "id": "dependency-on-apple-infrastructure",
        "title": "Reliance on Apple Cloud Services for iOS/iPadOS Features (BSI SYS.3.2.3 §2.3)",
        "description": "A broad set of iOS/iPadOS capabilities routes data through Apple-operated infrastructure: iCloud Keychain and backups, iMessage, FaceTime, Siri, Continuity/Handoff, Spotlight Suggestions, document collaboration, and Apple Push Notification service (APNs). Even when used only for notifications, metadata and payloads may traverse Apple infrastructure. This introduces an inherent dependency and exposure outside the organization’s direct control.",
        "impact": "Compromise, lawful access, misconfiguration, or outage within Apple infrastructure can expose or alter sensitive data synchronized or transported by these features. This primarily threatens confidentiality and integrity and can also affect availability if services are disrupted.",
        "action": "Define and enforce a policy for Apple cloud features via MDM; minimize or disable non-essential iCloud/Continuity/Siri usage; keep push payloads non-sensitive; prefer E2EE apps for confidential communications.",
        "mitigation": "Use MDM to: (1) disable or restrict iCloud backups, iCloud Drive, iCloud Keychain, Continuity/Handoff, Siri, Spotlight Suggestions; (2) require anonymous/managed Apple IDs via Apple Business Manager; (3) enforce 2FA for any permitted Apple ID usage; (4) ensure push notifications contain no sensitive content (server-side redaction); (5) mandate end-to-end encrypted communication channels for sensitive exchanges; (6) document when and why any Apple cloud feature is allowed.",
        "check": "Is MDM deployed and enforcing restrictions on iCloud, Siri, Continuity, Spotlight, and APNs payload content? Are Apple Business Manager and managed Apple IDs used? Is 2FA required where Apple IDs are permitted? Is there a documented policy explicitly approving or prohibiting Apple cloud features by data classification?",
        "asvs": "BSI SYS.3.2.3.A14 (Verwendung der iCloud-Infrastruktur), SYS.3.2.3.A15 (Continuity-Funktionen); APP.4.5 (Smartphones/Tablets unter iOS/iPadOS).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_5_Smartphones_and_tablets_under_iOS_iPadOS_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Flags any in-scope client technology asset tagged 'os:ios'. Severity is then scaled by the asset’s highest confidentiality/integrity needs and by the sensitivity of processed/stored data assets. Non-client or out-of-scope assets are ignored.",
        "riskAssessment": "Devices processing data of higher confidentiality or integrity requirements escalate impact from Low → Medium → High → Very High. Likelihood is set to 'Likely' because these features are integrated by default and commonly used unless centrally restricted.",
        "falsePositives": "Low risk if an effective MDM baseline verifiably disables iCloud/Continuity/Siri and notification payloads are sanitized, or if the device handles only public, non-sensitive data (e.g., kiosk/demo devices).",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "SYS.3.2.4": [
      {
        "file": "106_sec1.ts",
        "bsiCode": "SYS.3.2.4",
        "id": "unlocked-bootloader-on-android-device",
        "title": "Unlocked Bootloader on an Android Device (per BSI guidance)",
        "description": "The boot process of modern mobile devices (such as Android) is secured by a chain of trust, typically anchored by a manufacturer's certificate. This process, often called 'Verified Boot' or 'Secure Boot', ensures that each stage of the startup sequence is cryptographically verified, guaranteeing that the operating system starts in an unmodified and trusted state.",
        "impact": "An unlocked bootloader compromises the fundamental integrity of the device. This can lead to the installation of malware with root privileges, a complete bypass of application-level security controls, and unauthorized access to sensitive data stored on or processed by the device (e.g., credentials, personal information, corporate data). The compromised device could also be used as a pivot point to attack other systems. The confidentiality, integrity, and availability of all assets on the device are at high risk.",
        "action": "Enforce device integrity and implement runtime tamper detection",
        "mitigation": "For corporate-managed devices, ensure they are provisioned with a locked bootloader using a Mobile Device Management (MDM) solution (see BSI CON.8). For applications handling sensitive data, implement robust runtime checks to detect compromised environments. This includes using platform-specific APIs like Android's Play Integrity API (formerly SafetyNet) to verify device integrity. If a compromised environment (unlocked bootloader, root access) is detected, the application should refuse to run, operate with significantly reduced functionality, or terminate the session after securely notifying the user and/or a backend monitoring system.",
        "check": "Are devices required to have a locked bootloader per policy? Does the application incorporate runtime checks to detect a compromised OS environment and react appropriately? Are these detection events logged for security monitoring?",
        "asvs": "OWASP MASVS V8.1: The app is not running on a rooted or jailbroken device.",
        "cheatSheet": "https://mas.owasp.org/MASVS/8-Resilience/#v81-the-app-is-not-running-on-a-rooted-or-jailbroken-device",
        "detectionLogic": "This risk is identified for any in-scope technical asset of technology type 'Mobile App' or 'IoT Device' that is explicitly tagged as having an unlocked bootloader (e.g., using the '@Bootloader:unlocked' tag). The presence of this tag signifies that the core security promise of the device's operating system cannot be trusted.",
        "riskAssessment": "The likelihood of exploitation is very high, as the primary security barrier (Verified Boot) has been removed. The impact is directly related to the sensitivity of the technical asset and the data it processes or stores. An unlocked bootloader on a device handling 'Strictly Confidential' data will result in a critical risk.",
        "falsePositives": "This risk is generally not a false positive if the asset is correctly tagged. A business decision might be made to accept this risk (e.g., for development or testing devices), but the vulnerability and its potential consequences remain and must be formally acknowledged and accepted.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "106_sec2.ts",
        "bsiCode": "SYS.3.2.4",
        "id": "malware-on-android-devices",
        "title": "Malware on Android Devices (Sideloading and Untrusted Stores)",
        "description": "Android’s popularity and openness make it a prime target for mobile malware. Beyond the official Google Play Store, users can also install apps from alternative stores, direct APK downloads, or enterprise distribution channels. Attackers frequently repackage legitimate apps with malicious code and trick users into installing them from untrusted sources. This risk models the exposure of corporate devices and apps running on Android.",
        "impact": "Compromised Android devices can leak credentials and tokens; exfiltrate data at rest and in use; tamper with app logic; pivot into backend APIs; or disable device protections. Such breaches can affect confidentiality (data theft/spyware), integrity (transaction or configuration tampering), and availability (e.g., ransomware or DoS against MDM/EMM policies) across any data the device or app can access.",
        "action": "Adopt and enforce MDM/EMM with strict app controls; block \\",
        "mitigation": "Enforce device management (MDM/EMM) with: 1) Installation restricted to managed Google Play (allowlist only), 2) \\",
        "check": "Are Android devices enrolled in MDM/EMM with allowlisted apps only? Is installation from \\",
        "asvs": "OWASP MASVS v2.0 – V8: Resilience",
        "cheatSheet": "https://mas.owasp.org/MASVS/0x14-V8-Resiliency_Requirements/",
        "detectionLogic": "Triggered for any in-scope technical asset that is a client-type technology (e.g., MobileApp, ClientSystem) AND is explicitly tagged with '@Platform:Android'. Out-of-scope assets and non-client technologies are ignored.",
        "riskAssessment": "Likelihood is set to 'Likely' given widespread social engineering and the ease of sideloading. Impact scales with the asset’s CIA profile: handling confidential or mission-critical data, or powerful tokens, makes impact High to Very High; strictly confidential data and mission-critical connectivity can drive Very High impact.",
        "falsePositives": "May be a false positive if MDM/EMM fully enforces managed Google Play allowlists, blocks unknown sources and Developer mode, and the device runs in a locked-down kiosk/work-profile-only mode with Play Integrity enforced and no sensitive tokens present.",
        "cwe": "506",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "106_sec3.ts",
        "bsiCode": "SYS.3.2.4",
        "id": "outdated-mobile-os",
        "title": "Use of Outdated Mobile Operating System Components (BSI SYS.3.2.1)",
        "description": "Some manufacturers ship smartphones and tablets with outdated versions of their operating system (such as Android) or do not provide regular, or any, updates.",
        "impact": "Exploitation of known vulnerabilities can lead to a complete compromise of the device, resulting in theft of sensitive data (violating Confidentiality), manipulation of device functions or data (violating Integrity), and rendering the device unusable (violating Availability). This can expose all data assets processed or stored on the device.",
        "action": "Implement a Mobile Device Management (MDM) and patch management policy",
        "mitigation": "Ensure that all mobile devices used to access corporate data are managed by an MDM solution. The MDM policy should enforce minimum OS version requirements and automatically apply security patches. Devices that cannot be updated or fall out of compliance should be blocked from accessing enterprise resources. Procure devices from manufacturers with a proven track record of providing timely and long-term security updates.",
        "check": "Is there an MDM solution in place? Does the MDM enforce OS version and patch level policies? Are there logs to verify that devices are being updated regularly? Is there a list of approved devices from reputable manufacturers?",
        "asvs": "BSI IT-Grundschutz: SYS.3.2.1.A5 Regular updates of mobile devices",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Mobile_devices_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "The risk is raised for any technical asset identified as a mobile client (e.g., technology 'mobile-app' or 'iot-device'). The likelihood and impact are increased if the asset handles sensitive data.",
        "riskAssessment": "The likelihood is 'Very Likely' for unmanaged devices, as public exploits for known vulnerabilities are common. The impact is directly related to the CIA requirements of the data assets processed or stored by the mobile device. A device handling 'Strictly Confidential' data poses a 'Very High' impact risk.",
        "falsePositives": "The risk might be considered a false positive if a robust MDM solution is in place that effectively manages and patches the identified device types, even if not explicitly modeled. The model lacks insight into the organization's specific patch management and MDM policies.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "106_sec4.ts",
        "bsiCode": "SYS.3.2.4",
        "id": "compromise-of-central-identity-provider",
        "title": "Compromise of Central Identity Provider (e.g., Google ID)",
        "description": "Many services use a central identity provider, such as a Google ID, for user authentication. This creates a single point of failure. If an attacker gains control over this central identity, they can access all connected services under the stolen identity.",
        "impact": "A compromised central identity can lead to unauthorized access to a wide range of services, including cloud storage, device management, communication platforms, and third-party applications. Attackers could access or steal stored data (files, bookmarks, passwords), impersonate the user, or even remotely locate and wipe devices linked to the account.",
        "action": "Enforce strong authentication for central identities",
        "mitigation": "Ensure that all communication with central identity providers requires strong, multi-factor authentication (MFA/2FA). Model this requirement explicitly on the communication link. Educate users about phishing and credential theft. Regularly review and revoke access for unused or suspicious third-party applications connected to the central identity.",
        "check": "Is communication with the central identity provider protected by multi-factor authentication? Are assets using the identity provider configured to enforce this? Are there monitoring and alerting mechanisms for suspicious login activities?",
        "asvs": "V2 Authentication Verification Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for technical assets that communicate with an external 'Identity Provider'. The risk is raised if the authentication method on the communication link is weaker than 'Two-Factor' (e.g., None, Credentials, Token, or SessionId), indicating that strong authentication is not enforced for this critical dependency.",
        "riskAssessment": "The likelihood of compromise is high if weak authentication methods (like only passwords) are used. The impact is determined by the sensitivity of the technical asset using the identity and the data it processes or stores. Access to an asset managing 'Strictly Confidential' data via a compromised central identity poses a very high risk.",
        "falsePositives": "The model might already reflect that the identity provider enforces MFA on its end, even if the link in the model is not explicitly marked as 'Two-Factor'. However, the risk highlights a modeling gap where the strong-authentication dependency is not explicitly documented.",
        "cwe": "287",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "106_sec5.ts",
        "bsiCode": "SYS.3.2.4",
        "id": "preinstalled-apps-on-android-devices",
        "title": "Non-removable Preinstalled Apps on Android Devices (Bloatware)",
        "description": "Android device manufacturers often ship devices with preinstalled, non-removable applications and integrations with third-party services (e.g., social media or manufacturer utilities).",
        "impact": "The increased attack surface from bloatware increases the risk of malware infection or unauthorized access to confidential information.",
        "action": "Restrict, control, or remove preinstalled applications",
        "mitigation": "Use a Mobile Device Management (MDM) solution to disable or restrict unnecessary preinstalled applications on all corporate devices.",
        "check": "Is there an inventory of preinstalled applications on corporate Android devices? Is a Mobile Device Management (MDM) system in place to control these applications?",
        "asvs": "Derived from BSI SYS.3.2.1 Mobile Device Management (MDM) and OWASP MASVS-PLATFORM-1: 'The app is not vulnerable to any publicly known vulnerabilities in third-party libraries and components.'",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2022/Bausteine/SYS/SYS_3_2_1_MDM_EN.pdf?__blob=publicationFile (BSI SYS.3.2.1)",
        "detectionLogic": "This risk is raised for any technical asset representing a client device (e.g., technologies such as 'Mobile App' or 'Client System') that is specifically tagged as Android (e.g., using a tag like '@Platform:Android').",
        "riskAssessment": "The likelihood is considered 'Likely' by default for standard consumer-grade Android devices due to common manufacturer practices. The likelihood can be reduced if it is confirmed that devices with minimal bloatware are in use or if an effective MDM disables such apps.",
        "falsePositives": "This risk might be a false positive if the device is confirmed to be running a clean, AOSP-based custom ROM without any third-party bloatware, or if an effective and audited MDM configuration is in place that successfully disables all nonessential preinstalled applications.",
        "cwe": "1049",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "SYS.3.3": [
      {
        "file": "107_sec1.ts",
        "bsiCode": "SYS.3.3",
        "id": "unsuitable-mobile-asset-procurement-sys321-g04",
        "title": "Unsuitable Mobile Phone Procurement (BSI SYS.3.3: Inadequate Planning)",
        "description": "If relevant properties of mobile phones are not properly evaluated during planning and procurement, essential functions may be unavailable. This can occur if the device or its operating system lacks support for required standards (e.g., communication protocols, security features) or is unsuitable for the intended operational environment (e.g., specific countries or particular corporate networks).",
        "impact": "The primary impact is a loss of Availability, as the asset may be partially or completely unusable for its intended purpose, disrupting business processes. Furthermore, unforeseen limitations in security features can lead to Confidentiality or Integrity risks if the asset is used despite its shortcomings.",
        "action": "Establish detailed procurement and onboarding requirements for mobile phones.",
        "mitigation": "Define and document clear technical and security requirements for any mobile phone before procurement. This includes required communication standards, supported security functions (e.g., encryption, SIM lock), and operational constraints. Perform a proof-of-concept or pilot phase to validate that the chosen device meets all requirements in the target environment. Maintain an approved list of device models and firmware versions.",
        "check": "Are there documented requirements for mobile phones? Is there a formal evaluation process before a new type of mobile phone is introduced? Is the device's functionality and security posture validated in a test environment before rollout?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.3 (Mobiltelefon), Section 2.1 'Unzureichende Planung bei der Anschaffung von Mobiltelefonen'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/bausteine/sys/SYS_3_3_Mobiltelefon.html",
        "detectionLogic": "This organizational risk is triggered for any in-scope technical asset representing a mobile client (e.g., technology types 'Mobile App' or 'IoT Device'). The risk is that the selection process for this asset was flawed, resulting in a component that is unfit for its purpose.",
        "riskAssessment": "The likelihood is considered 'Likely' as a baseline, reflecting a common organizational weakness in procurement processes. The impact is derived from the Availability and Confidentiality ratings of the mobile phone itself and the data it processes or stores. An unsuitable mission-critical mobile client has a very high impact.",
        "falsePositives": "This risk can be considered a false positive if a thorough and documented evaluation and procurement process for mobile assets exists within the organization, even if this process is not captured in the threat model.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "107_sec2.ts",
        "bsiCode": "SYS.3.3",
        "id": "lost-or-stolen-mobile-device",
        "title": "Lost or Stolen Mobile Device (BSI)",
        "description": "Mobile devices are generally small and constantly transported, making them easy to lose, forget, or steal.",
        "impact": "If a mobile device is lost or stolen, it can lead to a direct breach of confidentiality and integrity for all data stored on it, and a loss of service availability for the user.",
        "action": "Implement Strong Device Security and Remote Management",
        "mitigation": "Enforce strong device-level authentication (passcode or biometric authentication).",
        "check": "Is there a policy requiring strong passcodes on mobile devices? Are all devices encrypted by default?",
        "asvs": "OWASP MASVS V2.0.0: V8.1 - Users are required to set a device-level passcode.",
        "cheatSheet": "https://mas.owasp.org/MASVS/10-v8-resilience_requirements/",
        "detectionLogic": "This risk is triggered for any in-scope technical asset identified as a mobile application client,",
        "riskAssessment": "The likelihood of a mobile device being lost or stolen during its lifecycle is very high.",
        "falsePositives": "This risk might be considered a false positive if the asset model represents a backend service for a mobile app rather than the client application running on the physical device. The risk only applies to assets on a portable physical device.",
        "cwe": "311 // CWE-311: Missing Encryption of Sensitive Data",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "107_sec3.ts",
        "bsiCode": "SYS.3.3",
        "id": "careless-mobile-usage",
        "title": "Information Disclosure Through Careless Mobile Usage",
        "description": "Careless or negligent use of mobile devices by employees can allow third parties to access sensitive information.",
        "impact": "If sensitive information is compromised due to careless handling of mobile devices, it can lead to a breach of confidentiality.",
        "action": "Implement user awareness training and promote secure usage habits for mobile devices",
        "mitigation": "Establish a security policy for mobile device usage that advises employees on secure practices.",
        "check": "Are users trained on the risks of using mobile devices in public? Are there policies regarding the discussion of sensitive information on mobile phones? Are privacy screens available and used for company devices?",
        "asvs": "BSI IT-Grundschutz SYS.3.2.1.A6 (Unauthorised eavesdropping on mobile phones)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/sys/SYS_3_2_1_Mobile_phone_en.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is relevant for all human-operated mobile clients (e.g., mobile apps, handheld IoT devices) that process or transmit data with any level of confidentiality.",
        "riskAssessment": "The likelihood is considered high due to the commonality of mobile device usage in public areas.",
        "falsePositives": "This risk can be considered a false positive if the mobile device is exclusively operated within a physically secure and controlled environment (e.g., a handheld scanner used only inside a secure warehouse with no external visitors).",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "107_sec4.ts",
        "bsiCode": "SYS.3.3",
        "id": "unauthorized-private-use-of-mobile-devices",
        "title": "Unauthorized Private Use of Company Mobile Devices",
        "description": "Company-owned mobile devices may be used for private purposes without authorization.",
        "impact": "If company mobile devices are used for private purposes, this can lead to a breach of confidentiality of internal data.",
        "action": "Implement and Enforce a Mobile Device Management (MDM) Policy",
        "mitigation": "Enforce a clear policy regarding the private use of company devices.",
        "check": "Is there a documented policy for mobile device usage? Is a Mobile Device Management (MDM) solution in place and configured to separate business and private data?",
        "asvs": "BSI IT-Grundschutz SYS.3.2.2 Mobile Device Management (MDM), specifically referencing requirement SYS.3.2.2.A4 'Separation of private and business data'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_2_Mobile_Device_Management_MDM_edition_2022.html",
        "detectionLogic": "This risk is raised for any in-scope technical assets that are human-operated clients (especially mobile apps or devices) that are not explicitly marked as being managed by an MDM solution.",
        "riskAssessment": "The likelihood of private use is considered 'likely' for unmanaged mobile devices provided to employees.",
        "falsePositives": "This risk can be a false positive if an effective MDM solution is in place but the corresponding technical asset in the model has not been tagged with `@System:MDM`.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "107_sec5.ts",
        "bsiCode": "SYS.3.3",
        "id": "mobile-phone-unavailability",
        "title": "Mobile Phone Unavailability (BSI-based)",
        "description": "The unavailability of a mobile phone can have several causes. Users may have neglected to charge the device's battery, or the battery may have lost its ability to store energy. Users may also forget the device password or PIN and be unable to use the device, as it can lock after multiple incorrect code entries. If the phone is not handled carefully, it can be damaged—for example, by being dropped.",
        "impact": "In all these cases, the user is not reachable and, in turn, cannot reach others via the mobile phone. This results in a denial of service for all business processes and data assets that depend on the availability of the mobile device.",
        "action": "Ensure Mobile Device Availability",
        "mitigation": "To mitigate these risks, users should be trained on proper device care, including regular charging. Organizations should consider providing @Backup:Target power sources (e.g., power banks) for critical roles. The use of protective cases can reduce the risk of physical damage. Clear, efficient procedures must be in place for resetting forgotten PINs or passwords to regain access without prolonged downtime. For mission-critical scenarios, consider providing redundant @Backup:Target devices.",
        "check": "Do users receive guidance and training on mobile device maintenance? Are @Backup:Target power options or redundant devices available for critical users? Is there an efficient, documented process for handling locked devices or forgotten credentials?",
        "asvs": "This risk aligns with the general IT security principle of ensuring availability. It is not tied to a specific ASVS requirement but reflects a fundamental operational threat.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
        "detectionLogic": "This risk applies to all in-scope technical assets with the technology type 'Mobile App' or 'IoT Device', as these often represent mobile phones or other single-user-dependent devices.",
        "riskAssessment": "The likelihood is generally considered 'Likely' due to the high probability of human error (forgetting to charge), hardware degradation (battery aging), or accidents (physical damage). The impact is derived from the availability requirement of the mobile device itself and the data it handles. A mission-critical device failure has a very high impact.",
        "falsePositives": "This risk can be considered a false positive if the model represents a non-critical device or if robust, unmodeled redundancy measures (such as a second company phone per employee) are in place.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "107_sec6.ts",
        "bsiCode": "SYS.3.3",
        "id": "eavesdropping-and-location-tracking-of-mobile-communication",
        "title": "Eavesdropping and Location Tracking of Mobile Communication",
        "description": "By design, mobile communication signals can be intercepted and recorded by attackers with sufficient resources.",
        "impact": "If mobile communication is not properly secured, the confidentiality and integrity of transmitted data can be compromised.",
        "action": "Enforce strong encryption for all mobile communications",
        "mitigation": "All data transmitted from mobile devices must be protected with strong, up-to-date encryption protocols (e.g., HTTPS, WSS, or a VPN tunnel).",
        "check": "Do all communication links originating from mobile clients use encrypted protocols? Is a VPN enforced for mobile access? Are sensitive credentials or data transmitted?",
        "asvs": "BSI IT-Grundschutz: SYS.3.2.2.A11 (Protection of communications for smartphones), NET.3.2.A4 (WLAN encryption).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_2_Smartphones_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This rule is triggered for all communication links originating from technical assets identified as mobile clients (e.g., technologies 'mobile-app' or 'iot-device') that use an unencrypted network protocol.",
        "riskAssessment": "The likelihood of interception is high for unencrypted wireless traffic. The impact depends on the confidentiality and integrity requirements of the transmitted data.",
        "falsePositives": "The risk may be flagged for communication within a physically secured, private wireless network (e.g., a dedicated on-premises Wi-Fi for warehouse scanners) where the eavesdropping risk is considered low.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "107_sec7.ts",
        "bsiCode": "SYS.3.3",
        "id": "covert-eavesdropping-via-mobile-device",
        "title": "Covert Eavesdropping via Mobile Devices",
        "description": "Mobile devices, such as smartphones, can be used to covertly record or transmit conversations without notice. During sensitive meetings or in secure areas, a compromised or maliciously used mobile device can establish a connection to an unauthorized third party, effectively bugging the room. Features like the speakerphone can capture audio from the entire vicinity, and it is often difficult to visually determine if a device is actively recording or transmitting.",
        "impact": "If confidential conversations (e.g., about business strategy, trade secrets, personal data, or system architecture) are eavesdropped upon, it leads to a severe breach of confidentiality. This can result in significant financial loss, reputational damage, loss of competitive advantage, and potential legal or regulatory penalties.",
        "action": "Establish and Enforce a 'Clean Room' Policy for Sensitive Areas",
        "mitigation": "For meetings or work areas where highly sensitive information is discussed, enforce a strict policy prohibiting personal or untrusted mobile devices. Consider providing secure lockers for device storage. Alternatively, use technical countermeasures like RF jammers or detectors (where legally permissible) or hold discussions in specially secured rooms (SCIFs). Raise awareness among all personnel about this specific threat.",
        "check": "Is there a policy regarding mobile devices in sensitive meeting areas? Are employees aware of this policy and the risks of eavesdropping? Are there physical controls in place to enforce the policy?",
        "asvs": "Derived from BSI IT-Grundschutz principles, particularly related to CON.3 (Physical and Environmental Security). This threat highlights risks that bridge the gap between cyber and physical security domains.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Physical_and_environmental_security_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered by the presence of technical assets like mobile apps or IoT devices within a trust boundary that also contains other assets processing or storing confidential data. The model proxy for a 'sensitive meeting room' is a trust boundary containing both the listening device and the source of sensitive information.",
        "riskAssessment": "The likelihood is considered 'Likely' due to the ubiquity of mobile phones. The impact is directly proportional to the maximum confidentiality of data handled by other assets within the same trust boundary. If meetings in the scope of the model discuss 'Strictly Confidential' data, the impact is 'Very High'.",
        "falsePositives": "The model may not accurately represent physical locations. A 'mobile-app' asset might be part of the system but never physically brought into sensitive areas. This risk requires contextual knowledge of physical security procedures, which cannot be fully captured in a data-flow diagram.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "107_sec8.ts",
        "bsiCode": "SYS.3.3",
        "id": "outdated-mobile-devices-bsi",
        "title": "Use of Outdated Mobile Devices (BSI)",
        "description": "The use of outdated mobile phones (n@SystemType:OT modern smartphones) poses a significant risk. These devices often run on unsupported operating systems, meaning security vulnerabilities are no longer patched.",
        "impact": "Exploitation of unpatched vulnerabilities can lead to the compromise of any data stored on or transmitted by the device, impacting its confidentiality and integrity.",
        "action": "Phase Out Unsupported Mobile Devices",
        "mitigation": "Establish and enforce a policy that prohibits the use of unsupported mobile devices for business purposes. Maintain an inventory of all mobile devices and their OS versions to track support lifecycles.",
        "check": "Is there an inventory of all mobile devices used in the organization? Are all devices and their operating systems actively supported by the manufacturer with security updates?",
        "asvs": "V14.2.5: Verify that all components are patched and up-to-date.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/sys/SYS_3_2_1_Allgemeine_Aspekte_bei_mobilen_Endgeraeten_Edition_2023.html",
        "detectionLogic": "This risk is triggered for any technical asset explicitly identified as an outdated mobile device using the '@legacy-mobile-device' tag.",
        "riskAssessment": "The likelihood of exploitation is considered very high for a device with known, unpatched vulnerabilities connected to any network.",
        "falsePositives": "A false positive may occur if the tagged device is used in a completely isolated, offline environment where software vulnerabilities cann@SystemType:OT be remotely exploited, and its potential for hardware failure is an accepted operational risk.",
        "cwe": "937",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "SYS.4.1": [
      {
        "file": "108_sec1.ts",
        "bsiCode": "SYS.4.1",
        "id": "unattended-printouts-at-@AssetType:Printer",
        "title": "Unattended Output at @AssetType:Printer — Sichere Ausgabe (BSI CON.3.A21)",
        "description": "Printed documents, faxes, and transmission reports are frequently left unattended in output trays of central, departmental, or home-office printers and multifunction devices.",
        "impact": "Unattended sensitive printouts can breach confidentiality and expose personal or business secrets.",
        "action": "Enforce secure/pull printing, prompt pickup, and controlled shredding or disposal.",
        "mitigation": "Introduce pull-printing requiring user authentication at the @AssetType:Printer.",
        "check": "Is pull-printing enforced with user authentication? Are printers in controlled areas?",
        "asvs": "BSI IT-Grundschutz CON.3.A21 Sichere Ausgabe auf Druckern (Secure output on printers).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Datentraeger-_und_Daten-Handling.pdf?__blob=publicationFile (BSI CON.3)",
        "detectionLogic": "Trigger for any technical asset tagged '@AssetType:@AssetType:Printer'. For each incoming communication link:",
        "riskAssessment": "Impact derives from the most sensitive property of data sent to the @AssetType:Printer.",
        "falsePositives": "May flag a @AssetType:Printer in a strictly controlled, single-occupant room with enforced pull-printing and monitored disposal.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "108_sec2.ts",
        "bsiCode": "SYS.4.1",
        "id": "data-leakage-from-print-@AssetType:Fax-jobs",
        "title": "Confidential data leakage from print and @AssetType:Fax jobs and output (based on BSI threat G 0.15)",
        "description": "Printers, @AssetType:Fax machines, and multifunction devices (MFDs) often handle sensitive information and metadata, creating multiple pathways for data leakage.",
        "impact": "The exposure of print and @AssetType:Fax metadata and tracking information can lead to severe breaches of confidentiality and privacy. It allows unauthorized parties to gain insights into sensitive business operations, personal data, and internal documents. This can result in non-compliance with data protection regulations when handling @DataType:PII, reputational damage, and the compromise of trade secrets.",
        "action": "Implement secure printing/faxing policies and device hardening",
        "mitigation": "Deploy a secure printing solution that requires user authentication at the device before a job is released (pull printing). Configure printers and print servers to anonymize or suppress print job metadata in queues. Harden devices by disabling unnecessary services, securing the administrative web interface, and restricting access to control panels and logs. Evaluate devices for tracking features such as 'Yellow Dots' and disable them where possible. Ensure @AssetType:Fax logs are access-controlled and regularly purged.",
        "check": "Is pull printing implemented for sensitive data? Are print queues on servers and devices configured to hide sensitive metadata? Are device web interfaces and control panels secured? Are @AssetType:Fax logs protected against unauthorized access? Has the use of tracking watermarks by printers been assessed?",
        "asvs": "BSI IT-Grundschutz, Threat G 0.15 'Offenlegung schützenswerter Informationen durch Peripheriegeräte' (Disclosure of sensitive information by peripheral devices)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/Gefaehrdungen/G_Gefaehrdungen_Edition_2023.pdf?__blob=publicationFile (Search for 'G 0.15')",
        "detectionLogic": "This rule triggers on technical assets tagged as `@AssetType:Printer` or `@AssetType:Fax`. It identifies risks from (1) sensitive data being sent to these devices, indicating metadata leakage, (2) the inherent risk of physical document tracking ('Yellow Dots') for any @AssetType:Printer, and (3) the risk of exposed @AssetType:Fax logs for any device with @AssetType:Fax capabilities.",
        "riskAssessment": "The impact is determined by the confidentiality of the data being processed by the device. The likelihood of metadata leakage is considered high for standard print jobs, as many devices are insecure by default. The likelihood for exploiting 'Yellow Dots' is lower as it requires specific knowledge and tools, but the impact can be high. Exposed @AssetType:Fax logs are a likely risk on unhardened MFDs.",
        "falsePositives": "The risk might be mitigated by organizational policies or specific device configurations not captured in the model. For example, a device might be physically secured in a locked room, or a secure pull-printing solution might be in place that is not modeled explicitly. Verification requires checking the actual device and print server configurations.",
        "cwe": "200 // CWE-200: Exposure of Sensitive Information to an UnauthorizedActor",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "108_sec3.ts",
        "bsiCode": "SYS.4.1",
        "id": "unprotected-data-on-mfd-storage",
        "title": "Unprotected data on @AssetType:Printer/MFD storage",
        "description": "Printers, copiers, and multifunction devices (MFDs) are often equipped with non-volatile storage",
        "impact": "Unauthorized access to sensitive data stored on the device results in a breach of confidentiality.",
        "action": "Harden MFD configuration and implement secure decommissioning",
        "mitigation": "Enable built-in storage encryption on the MFD. Configure the device to use secure data overwriting/wiping for deleted jobs.",
        "check": "Is storage encryption enabled on all MFDs? Are secure deletion methods configured and active?",
        "asvs": "BSI IT-Grundschutz SYS.4.1 Printers, Copiers, and Multifunction Devices",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_General_printers_and_copiers_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "Triggers for technical assets identified as multifunction devices (MFDs) via the '@AssetType:Printer' tag.",
        "riskAssessment": "The impact is determined by the highest confidentiality and integrity rating of the data assets",
        "falsePositives": "This risk might be a false positive if the identified asset, despite the tag, has no persistent storage, or if compensating controls",
        "cwe": "212",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "108_sec4.ts",
        "bsiCode": "SYS.4.1",
        "id": "unencrypted-printing-scanning-data",
        "title": "Unencrypted Transmission of Printing, Scanning, and Administrative Data",
        "description": "Print and scan data are often transmitted without encryption over the network. This allows sent documents to be intercepted and read.",
        "impact": "Interception of unencrypted print or scan data leads to a breach of confidentiality. If administrative interfaces are also unencrypted,",
        "action": "Enforce Encrypted Communication Channels",
        "mitigation": "Use encrypted protocols for all printing, scanning, and administrative traffic (e.g., use IPPS instead of LPR/IPP, HTTPS instead of HTTP, SSH instead of Telnet).",
        "check": "Review all communication links to and from assets handling printing, scanning, or document management. Verify that all protocols used for data transmission and administration are encrypted.",
        "asvs": "Derived from BSI IT-Grundschutz principles. Aligns with OWASP Proactive Controls C8 (Protect Data Everywhere) and ASVS V4.1 (Communication Security Requirements).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This risk is identified by finding communication links that use unencrypted protocols and target technical assets likely to handle printing,",
        "riskAssessment": "The exploitation likelihood is considered higher for traffic crossing trust boundaries. The impact is determined by the confidentiality of the data assets being transferred.",
        "falsePositives": "This risk might be a false positive if the unencrypted communication occurs exclusively within a physically secured, isolated network segment (e.g., a dedicated printer VLAN) where network interception is not considered a credible threat. Such scenarios should be explicitly documented and accepted.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "108_sec5.ts",
        "bsiCode": "SYS.4.1",
        "id": "insecure-multifunction-device-handling-sys-3-2-1",
        "title": "Insecure Handling of Printers, Copiers, and Multifunction Devices (BSI SYS.4.1)",
        "description": "Many multifunction devices (MFDs) can send digitized documents via email and fax. Without specific security measures,",
        "impact": "Misconfigured MFDs can lead to severe data breaches (loss of confidentiality), enable spoofing attacks that damage trust and facilitate fraud (loss of integrity),",
        "action": "Secure Configuration and Usage Policies for Multifunction Devices",
        "mitigation": "Implement strict configuration management for all MFDs. Disable unnecessary functions like printing from the internet via email.",
        "check": "Are MFD configurations hardened and regularly audited? Is printing from the internet disabled? Are email/fax destinations restricted?",
        "asvs": "BSI IT-Grundschutz SYS.3.2.1: Printers, Copiers, and Multifunction Devices",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Printers_copiers_and_multifunction_devices_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset identified as a multifunction device. This can be done by assigning the asset the 'IoT device' technology type",
        "riskAssessment": "The likelihood is considered 'Likely' because MFDs are frequently deployed with default, insecure configurations.",
        "falsePositives": "A device might be correctly identified as an MFD but may have already been hardened and secured according to policy.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "108_sec6.ts",
        "bsiCode": "SYS.4.1",
        "id": "uncontrolled-mfd-storage-interfaces-con3",
        "title": "Uncontrolled Use of MFD Storage Interfaces (BSI CON.3)",
        "description": "Multi-Function Devices (MFDs) often have physical interfaces like USB or SD card slots.",
        "impact": "The uncontrolled use of MFD interfaces can lead to severe breaches of confidentiality (theft of sensitive documents) and integrity (introduction of malware).",
        "action": "Implement Physical and Logical Controls for MFD/Peripheral Interfaces",
        "mitigation": "Physically or logically disable all unused ports (USB, SD card slots) on MFDs and similar peripheral devices.",
        "check": "Are unused physical ports on MFDs disabled? Is user authentication required to use storage interfaces? Are MFDs located on a dedicated, restricted network segment? Is firmware updated regularly?",
        "asvs": "BSI IT-Grundschutz CON.3 Peripheriegeräte (Peripheral Devices). Addresses threats like G 0.22 (Misuse of devices), G 0.29 (Eavesdropping), and G 0.40 (Introduction of malware).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Peripheriegeraete_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Identifies networked IoT devices, which often represent Multi-Function Devices (MFDs) in a model. The risk is that their physical interfaces (like USB/SD ports) can be used to exfiltrate data (e.g., scanning confidential documents to a USB drive) or introduce malware into the connected network.",
        "riskAssessment": "The likelihood is considered high if the device is in a physically accessible area and connected to the network. The impact is determined by the highest confidentiality and integrity of the data handled by the MFD itself or any IT systems it is directly connected to, as the MFD can act as an uncontrolled bridge to the network.",
        "falsePositives": "The rule may flag any networked IoT device. The actual risk depends on physical security and device configuration, which may not be fully captured in the model. Verification of physical and logical controls on the device is required.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "108_sec7.ts",
        "bsiCode": "SYS.4.1",
        "id": "uncontrolled-internet-access-for-peripherals",
        "title": "Uncontrolled Internet Access for Peripheral or Less-Secure Devices in a Shared Network Segment",
        "description": "Peripheral devices (like printers, copiers, IoT devices) or other less-secure systems are often placed in the same network segment as more critical assets like clients and servers.",
        "impact": "A compromised device with internet access can be used as a gateway for attacks. Attackers could use it to exfiltrate sensitive data from other systems on the same network segment, violating Confidentiality.",
        "action": "Implement Strict Network Segmentation and Egress Filtering",
        "mitigation": "Place all peripheral devices (printers, IoT devices, etc.) and other non-critical systems into a separate, isolated network segment (e.g., a dedicated VLAN).",
        "check": "Are peripheral devices like printers and IoT devices located in a different network segment than standard clients and servers?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium threats related to network design and firewalls, such as in Bausteine NET.1.1 (Network architecture and design) and NET.3.2 (Firewall). The described scenario is a classic example of insufficient network segmentation.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_1_Network_architecture_and_design_edition_2023.pdf?__blob=publicationFile (BSI NET.1.1)",
        "detectionLogic": "This rule identifies peripheral or less-secure technical assets (like IoT devices, clients) that have internet access and reside in the same network trust boundary as other assets processing or storing sensitive data.",
        "riskAssessment": "The likelihood is considered high if a typically insecure device has internet access within a mixed-trust network.",
        "falsePositives": "The model might not capture micro-segmentation or host-based firewall rules that could mitigate this risk in reality, even if assets appear in the same network boundary.",
        "cwe": "552",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "108_sec8.ts",
        "bsiCode": "SYS.4.1",
        "id": "insecure-@AssetType:Printer-credential-management",
        "title": "Insecure Credential Management for Networked Printers/MFDs (BSI INF.4)",
        "description": "Networked printers, copiers, and multifunction devices (MFDs) are often delivered with no password or a default password for their management interfaces (e.g., a built-in web server).",
        "impact": "Unauthorized access to a @AssetType:Printer's management interface can lead to configuration changes, interception of print jobs (compromising confidentiality), modification of stored jobs (compromising integrity), and denial of service.",
        "action": "Enforce Strong and Unique Credentials for All Devices",
        "mitigation": "Ensure that every networked @AssetType:Printer and MFD has a strong, unique administrator password. Change default passwords immediately upon deployment.",
        "check": "Are there any communication links for administrative access to @AssetType:Printer/MFD assets that have authentication set to 'none'? Are default passwords changed on all devices during setup?",
        "asvs": "BSI IT-Grundschutz INF.4.A5 (Absicherung der Administrationsoberfläche)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_4_Drucker_Kopierer_und_Multifunktionsgeraete.html",
        "detectionLogic": "This rule checks for technical assets tagged as printers. It then inspects all incoming communication links.",
        "riskAssessment": "The impact is determined by the highest confidentiality of data processed or stored by the @AssetType:Printer. A lack of authentication presents a 'likely' exploitation scenario for internal attackers.",
        "falsePositives": "The model might not distinguish between a print-job submission protocol (which might not require authentication) and a management protocol. The risk should be validated to ensure the unauthenticated link is indeed for administrative purposes.",
        "cwe": "521",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "SYS.4.3": [
      {
        "file": "109_sec1.ts",
        "bsiCode": "SYS.4.3",
        "id": "neglected-security-in-embedded-development",
        "title": "Neglected Security in Embedded System Development",
        "description": "For cost reasons, information security often plays a less important role in the development of embedded systems than, for example, performance or reliability.",
        "impact": "If security requirements are neglected during development, resulting vulnerabilities in embedded systems can be exploited by attackers to tamper with device functionality,",
        "action": "Integrate Security into the Development Lifecycle for Embedded Systems",
        "mitigation": "A secure development lifecycle (SDL) must be implemented and enforced for all custom-developed embedded components. This includes performing threat modeling early in the design phase,",
        "check": "Is there a formal, enforced secure development lifecycle for embedded components? Are threat models created and maintained? Are security tests, including penetration tests, part of the release cycle?",
        "asvs": "V1: Architecture, Design and Threat Modeling Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/IoT_Security_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for custom-developed technical assets representing embedded systems (e.g., embedded devices, libraries) that are part of the model.",
        "riskAssessment": "The likelihood of vulnerabilities is considered high for custom-developed embedded components due to market pressures (time-to-market, cost) often overriding security concerns.",
        "falsePositives": "This risk can be a false positive if a robust secure development lifecycle is followed for the component, but the corresponding `Mitigation:SecureSDLC:Embedded` tag has not been applied to the asset in the model.",
        "cwe": "284",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "109_sec2.ts",
        "bsiCode": "SYS.4.3",
        "id": "unprotected-embedded-system-interfaces",
        "title": "Unprotected Interfaces on Embedded Systems (BSI SYS.4.3)",
        "description": "The interfaces of embedded systems are potential attack vectors. This applies to interfaces at all layers of the OSI model and across all transmission media.",
        "impact": "Successful exploitation of unprotected interfaces can lead to unauthorized system intrusion, manipulation of safety-critical processes, theft of sensitive data, and system outages (denial-of-service).",
        "action": "Secure and control access to embedded system interfaces",
        "mitigation": "Implement robust physical security for the device (e.g., locked enclosures, tamper-evident seals) to prevent unauthorized physical access.",
        "check": "Are embedded systems physically secured against tampering? Are all network interfaces and APIs protected with strong authentication? Are all communication channels encrypted?",
        "asvs": "BSI IT-Grundschutz, SYS.4.3: Eingebettete Systeme (Embedded Systems)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_Allgemeine_Embedded_Systeme_Edition_2023.html",
        "detectionLogic": "This rule triggers for all technical assets of the type 'IoT device' ('iot-device').",
        "riskAssessment": "The likelihood of exploitation is significantly increased if the device is physically accessible to potential attackers or exposed to untrusted networks (such as the internet).",
        "falsePositives": "The risk may be a false positive if robust physical security measures or compensating network controls (like a separate firewall) are in place but are not explicitly modeled.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "109_sec3.ts",
        "bsiCode": "SYS.4.3",
        "id": "physical-access-to-embedded-systems",
        "title": "Physical Access to Embedded Systems (OT Devices)",
        "description": "If embedded systems (like OT devices) are physically accessible, attackers can destroy, damage, or access their electronic components (e.g., IC pins, ports).",
        "impact": "Successful physical attacks can lead to a complete compromise of the Confidentiality, Integrity, and Availability of information stored on and processed by the embedded system.",
        "action": "Implement Physical Protection Measures for Embedded Systems",
        "mitigation": "Physically secure embedded systems based on their deployment environment. Use tamper-resistant or tamper-evident enclosures.",
        "check": "Is the device located in a physically secure environment? Does it have a tamper-resistant/evident casing? Are unused physical debug ports disabled in production firmware? Is data at rest encrypted? Does the device use a secure boot process?",
        "asvs": "BSI IT-Grundschutz SYS.3.2.1.A5: Protection against unauthorised physical access (Schutz vor unbefugtem physischem Zugriff)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Embedded_systems_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers for technical assets of type 'IoT Device'. The risk is considered present if the device is not located within a trust boundary that implies physical security (like 'Network On-Prem' or 'Network Dedicated Hoster'), or if it has no trust boundary assigned at all.",
        "riskAssessment": "The likelihood is considered 'Likely' for any physically exposed IoT device, and 'Very Likely' if it is also connected to the internet, increasing its exposure. The impact is determined by the highest Confidentiality, Integrity, and Availability ratings of the device and the data it handles. A device controlling critical operations or storing strictly confidential data will have a 'High' or 'Very High' impact.",
        "falsePositives": "A device might be located in a physically secure location (e.g., a locked cabinet in a public area) that is not modeled as a specific trust boundary. The risk must be evaluated based on the actual physical deployment context, which might not be fully captured in the model.",
        "cwe": "1260",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "109_sec4.ts",
        "bsiCode": "SYS.4.3",
        "id": "environmental-failure-of-embedded-systems",
        "title": "Environmental Influences Causing Failures in Embedded Systems",
        "description": "Environmental factors such as electromagnetic interference, temperature fluctuations, unstable power supplies, dust, sand, or dirt can cause embedded systems (like IoT devices) to fail.",
        "impact": "A failure of an embedded system primarily impacts its Availability. If the device controls or monitors physical processes or provides data to other critical systems,",
        "action": "Implement Physical and Environmental Protection for Embedded Systems",
        "mitigation": "Ensure that embedded systems, especially IoT devices, are suitable for their deployment environment. Use hardware with an appropriate IP rating for protection against dust and moisture.",
        "check": "Are embedded systems and IoT devices deployed in environments for which they are certified (e.g., temperature range, IP rating)?",
        "asvs": "This risk is related to physical and environmental protection, which is covered in standards like IEC 60529 (IP Code) and is a foundational aspect of physical security in frameworks like ISO 27001 (Annex A.11) or BSI IT-Grundschutz (INF modules). It falls outside the scope of the OWASP Application Security Verification Standard (ASVS), which focuses on software.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_and_cabinet_security_edition_2023.pdf?__blob=publicationFile&v=2 (Related BSI Topic: INF.5 Room and cabinet security)",
        "detectionLogic": "This risk is triggered for all technical assets of type 'IoT Device', as they are, by definition, embedded systems often deployed outside controlled data center environments.",
        "riskAssessment": "The likelihood of failure is considered higher in harsh or uncontrolled environments. The impact is determined by the Availability requirement (criticality) of the device itself and, more importantly, of any other assets that communicate with it and depend on its function. The lack of redundancy significantly increases the impact of a single device failure.",
        "falsePositives": "This risk might be rated too high for an IoT device that is deployed within a physically secure, climate-controlled environment (e.g., a server room). In such cases, the asset should be tagged with `@environment:controlled` to suppress this risk.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "109_sec5.ts",
        "bsiCode": "SYS.4.3",
        "id": "manipulated-firmware-update-on-embedded-systems",
        "title": "Manipulated Firmware Update on Embedded Systems",
        "description": "Many embedded systems store their software on persistent storage (such as Flash or EEPROMs) and provide a mechanism to update this firmware, either via a physical data interface or a network connection. Attackers can abuse this mechanism to install manipulated software updates, thereby modifying the system's function. As a result, the system's intended tasks can be interrupted or tampered with.",
        "impact": "If an attacker successfully installs malicious firmware, they can gain full control over the embedded system. This can lead to a severe loss of integrity (manipulating system behavior and data) and availability (disrupting or disabling system functions). This could compromise business processes, facilitate further attacks, and cause physical or operational damage.",
        "action": "Implement Secure Firmware Update Mechanism",
        "mitigation": "The firmware/software update process must be secured. All firmware updates should be digitally signed, and the embedded system must verify this signature before applying the update. Access to the update interface (both physical and network-based) should be strictly controlled and authenticated. Employing a secure boot process helps establish a hardware root of trust, ensuring that only trusted code is executed from the initial boot sequence.",
        "check": "Is all firmware/software for the embedded system cryptographically signed? Does the device verify the signature before installation? Is access to the update mechanism (e.g., network port, JTAG/serial interface) authenticated and access-controlled? Is a secure boot mechanism in place?",
        "asvs": "V14.2.5: Verify the integrity of application components, including frameworks, libraries, and dependencies during development, and before deployment or use.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Firmware_Security_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for technical assets representing embedded systems (e.g., IoT devices) that could have an updatable firmware. The risk is mitigated if the asset is tagged with `@Mitigation:firmware-update-secured`. The likelihood is considered higher for devices that are internet-facing or have network-based communication links, as these present remote attack vectors.",
        "riskAssessment": "The exploitation impact is determined by the integrity and availability requirements of the embedded system. A system controlling critical physical processes will have a very high impact. The likelihood is higher for remotely accessible systems (via network) compared to those requiring physical access for updates. Without signed firmware, a successful attack is significantly more likely.",
        "falsePositives": "The risk may be a false positive if the embedded system has no field-update mechanism at all, or if the update mechanism is already secured through measures not captured in the model (e.g., a physically separate, air-gapped update environment).",
        "cwe": "494",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "109_sec6.ts",
        "bsiCode": "SYS.4.3",
        "id": "side-channel-attack",
        "title": "Side-Channel Attack on Cryptographic Implementation",
        "description": "Attackers could break encryption or digital signatures by exploiting observable properties of the physical implementation of a cryptosystem.",
        "impact": "A successful side-channel attack can lead to the complete compromise of cryptographic keys. This would allow an attacker to decrypt sensitive data (violating Confidentiality) and forge digital signatures (violating Integrity and leading to Repudiation issues). The impact is directly related to the value of the data protected by the compromised cryptosystem.",
        "action": "Use Hardened Cryptographic Implementations and Hardware",
        "mitigation": "Prefer using certified hardware security modules (HSMs) for all critical cryptographic operations. For software implementations, use cryptographic libraries that have been vetted and are known to implement constant-time algorithms to resist timing attacks.",
        "check": "Are cryptographic operations performed on certified hardware (e.g., FIPS 140-2/3 validated HSMs)? Are constant-time cryptographic libraries used in custom-developed code? For virtual environments, what cross-tenant side-channel protections are in place?",
        "asvs": "V6.2.5: Verify that cryptographic algorithms are implemented correctly and used according to their specification, including avoiding known insecure options.",
        "cheatSheet": "https://cwe.mitre.org/data/definitions/208.html",
        "detectionLogic": "This risk is raised for technical assets that perform cryptographic operations, especially those running on physical, virtual, or containerized machines where side-channels could be observed. The likelihood is increased for assets with custom-developed parts and decreased for dedicated hardware like HSMs.",
        "riskAssessment": "The impact is determined by the Confidentiality and Integrity requirements of the asset and the data it handles. A compromise of an Identity Provider or a system handling strictly confidential data has a very high impact.",
        "falsePositives": "The model cannot verify whether a software library is implemented in constant time or whether a specific virtualization platform is hardened against side-channel attacks. This risk may be flagged as a false positive if the underlying implementation is robust despite the model's indications (e.g., a custom-developed component that correctly uses a hardened library).",
        "cwe": "208",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "109_sec7.ts",
        "bsiCode": "SYS.4.3",
        "id": "insecure-embedded-systems",
        "title": "Insecure Communication in Embedded Systems (based on BSI SYS.4.3)",
        "description": "Embedded systems are often constrained in resources (power, cost, size), which can lead to insufficient security features such as strong cryptography. When networked using standard protocols, these devices become vulnerable to attack. This risk covers the misuse of insecure communication interfaces (e.g., unencrypted protocols, missing authentication) to manipulate data or software, hijack connections, or penetrate the system.",
        "impact": "Successful exploitation can lead to data and software tampering, spoofing of messages, and unauthorized system access. This compromises the Confidentiality, Integrity, and Availability of the embedded system and the data it handles, potentially enabling larger-scale attacks on the connected infrastructure.",
        "action": "Secure All Communication Interfaces",
        "mitigation": "Use encrypted communication protocols (e.g., HTTPS, WSS, MQTTS, FTPS) for all network links. Enforce strong, non-default authentication mechanisms for all connections. Where possible, use network segmentation, IP filtering, or VPNs to protect the communication channel. Disable unused physical ports (like USB) and harden those in use.",
        "check": "Are all communication links from embedded devices using encrypted protocols? Is authentication enforced on all links? Are sensitive data assets protected in transit? Are physical ports secured?",
        "asvs": "Based on BSI IT-Grundschutz Baustein SYS.4.3 (Eingebettete Systeme)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_6_Embedded_systems_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Scans for technical assets representing embedded devices. It then inspects all outgoing communication links from these devices. A risk is flagged if a communication link uses an unencrypted protocol or has no authentication, especially when transmitting sensitive data or connecting across trust boundaries to the internet.",
        "riskAssessment": "The likelihood is high if both encryption and authentication are missing on a network connection. The impact is determined by the sensitivity (CIA) of the data transmitted and the criticality of the source and target assets. Impact and likelihood increase if the connection crosses a trust boundary, especially towards the internet.",
        "falsePositives": "The risk might be a false positive if the unencrypted communication occurs exclusively on a physically secured and isolated network segment where interception is not considered a credible threat.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "109_sec8.ts",
        "bsiCode": "SYS.4.3",
        "id": "counterfeit-hardware-components",
        "title": "Counterfeit or Manipulated Hardware Components (BSI G 0.46)",
        "description": "Counterfeit or manipulated components may be installed in embedded systems or other physical hardware during production or service. This can happen unintentionally due to the prevalence of fakes, or intentionally by an attacker.",
        "impact": "The use of counterfeit or manipulated hardware compromises the system's integrity and availability. It can lead to system failures, incorrect processing, and denial of service.",
        "action": "Implement Hardware and Supply Chain Verification Processes",
        "mitigation": "Source all hardware components from trusted, vetted suppliers. Implement a receiving process to verify the authenticity of components (e.g., checking for physical signs of tampering, using hardware scanners).",
        "check": "Is there a formal process for vetting hardware suppliers? Are components physically and/or electronically verified upon receipt? Is access to hardware components controlled during storage, assembly, and maintenance? Are tamper-evident seals used?",
        "asvs": "BSI IT-Grundschutz Threat G 0.46 Sabotage of Hardware, Software, or Data. See also: NIST SP 800-161 (Supply Chain Risk Management for Federal Information Systems and Organizations).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2022/Threats/G_0_46_Sabotage_of_hardware_software_or_data_EN.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for physical assets, especially operational technology (OT) devices, which are common targets for component-level attacks. The risk is considered higher for assets explicitly marked as sensitive to supply chain issues via tags.",
        "riskAssessment": "The likelihood increases for assets that are physically accessible or part of a complex, less-controlled supply chain (for example, many OT devices). The impact is directly related to the confidentiality, integrity, and availability (CIA) requirements of the asset itself and the data it processes or stores. Compromising a mission-critical asset can have a very high impact.",
        "falsePositives": "The risk may be a false positive if the organization has strong, proven supply chain and physical security controls that are not captured in the model. Verification requires auditing procurement and hardware handling procedures.",
        "cwe": "354",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "APP.3.4": [
      {
        "file": "10_sec1.ts",
        "bsiCode": "APP.3.4",
        "id": "unprotected-smb-communication",
        "title": "Unprotected SMB Communication (BSI APP.3.4.A15 – Encrypt SMB traffic)",
        "description": "Unencrypted or weakly protected Samba/SMB communication can be eavesdropped, allowing interception of credentials and sensitive files.",
        "impact": "Cleartext SMB traffic can expose credentials and confidential data (Confidentiality) and enable lateral movement.",
        "action": "Enforce SMB3 encryption and disable SMBv1",
        "mitigation": "Require SMB 3.0+ with encryption enabled end-to-end (prefer AES-GCM where available).",
        "check": "Search all communication links modeled with protocol 'smb'. Verify they have been switched to 'smb-encrypted' or are explicitly protected by a VPN/tunnel.",
        "asvs": "OWASP ASVS 4.0 – V9: Communication Security (e.g., verify confidential data is encrypted in transit).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "Triggers for any communication link using the unencrypted 'smb' protocol.",
        "riskAssessment": "Likelihood increases to 'very-likely' if the link crosses a trust boundary and to 'frequent' if an internet-facing asset participates.",
        "falsePositives": "Traffic may be on a physically isolated network segment, or encryption may be provided at a lower layer (e.g., IPsec/VPN) not modeled on the link.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "10_sec2.ts",
        "bsiCode": "APP.3.4",
        "id": "insecure-samba-default-configuration",
        "title": "Insecure Default Configuration of Samba Server",
        "description": "To facilitate a quick start, Samba server installations often generate a default 'smb.conf' configuration file.",
        "impact": "If unwanted file shares are active due to an unreviewed default configuration, sensitive data stored on the server can be exposed, violating confidentiality.",
        "action": "Harden Samba Server Configuration",
        "mitigation": "Never use the default 'smb.conf' file in a production environment without a thorough review.",
        "check": "Is the Samba server's 'smb.conf' file reviewed and hardened? Are there any default, example, or unintended shares active?",
        "asvs": "V14.2.1: Configuration",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for any 'File Server' technical asset that receives traffic over SMB or SMB-encrypted protocols.",
        "riskAssessment": "The likelihood is considered 'Likely' as using default configurations is a common administrative oversight.",
        "falsePositives": "A model can correctly identify a file server using SMB, but cannot verify its live configuration.",
        "cwe": "1188",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "10_sec3.ts",
        "bsiCode": "APP.3.4",
        "id": "outdated-admin-tools",
        "title": "Use of Outdated Administration Tools (BSI-based)",
        "description": "Unauthorized individuals can gain access to confidential information, manipulate it, or cause disruptions by using applications or IT systems.",
        "impact": "Successful exploitation can lead to unauthorized administrative control over the managed system (e.g., a file server), resulting in Elevation of Privilege.",
        "action": "Phase Out and Replace Outdated Components",
        "mitigation": "Regularly inventory all administrative tools and software components. Identify any tools that are no longer supported or updated by the vendor (End-of-Life).",
        "check": "Is there an inventory of administrative software? Are components checked for their support lifecycle status? Are there known outdated tools like Samba's SWAT in use?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Software and system lifecycle), specifically Requirement CON.1.A15 (Patch and change management), which covers the handling of components and their lifecycle.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_application_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
        "detectionLogic": "This risk is triggered for any technical asset explicitly tagged as an `outdated-admin-tool` or a specific known-vulnerable tool like `samba-swat-tool`.",
        "riskAssessment": "The likelihood of exploitation for a publicly known obsolete tool is considered VERY LIKELY.",
        "falsePositives": "The risk might be a false positive if the tool, despite being tagged as outdated, is heavily firewalled, accessible only from a secure management network, and has other compensating controls in place.",
        "cwe": "937",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "10_sec4.ts",
        "bsiCode": "APP.3.4",
        "id": "samba-misconfiguration-due-to-insufficient-knowledge",
        "title": "Samba Misconfiguration due to Insufficient Administrator Knowledge",
        "description": "If administrators are insufficiently familiar with the extensive components, functions, options, and configuration settings of Samba,",
        "impact": "Misconfiguration of a file server like Samba can directly compromise the confidentiality, integrity, and availability of the data it stores and serves.",
        "action": "Ensure Samba Administrators Receive Specialized Training",
        "mitigation": "Administrators responsible for Samba servers must be adequately trained on its configuration, security features, and potential pitfalls.",
        "check": "Are Samba administrators formally trained or can they demonstrate equivalent expertise? Are configuration changes reviewed and logged? Are Samba configurations regularly audited against a secure baseline?",
        "asvs": "BSI IT-Grundschutz SYS.1.2.2 Linux and Unix-Servers; ORP.1 Information security organisation",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_2_Linux_and_Unix_Server_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for technical assets identified as file servers, either by their technology type (`file-server`) or by being the target of SMB/CIFS communication protocols.",
        "riskAssessment": "The likelihood is rated as 'likely' by default, as Samba is a complex system with many security-critical settings. The impact is calculated based on the CIA requirements of the file server itself and the data assets it stores and processes. A server handling 'Strictly Confidential' or 'Mission-Critical' data will result in a higher impact.",
        "falsePositives": "This risk is based on the general complexity of the technology and does not assess the specific skill level of the organization's administrators.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "10_sec5.ts",
        "bsiCode": "APP.3.4",
        "id": "data-loss-on-incompatible-filesystems-bsi",
        "title": "Data Loss or Corruption due to Incompatible Filesystem Semantics",
        "description": "When files are shared between different operating systems (e.g., Windows and Unix/Linux) via services like Samba, differences in filesystem capabilities can lead to data loss or corruption.",
        "impact": "If business-relevant information is destroyed or altered, business processes and tasks can be delayed or fail entirely.",
        "action": "Ensure Filesystem Compatibility and Data Integrity Preservation",
        "mitigation": "When using file sharing services across different platforms, ensure the service is configured to preserve file metadata and permissions as much as possible (e.g., using Samba's `vfs_streams_xattr` module to save ADS).",
        "check": "Is a file server used to share files between clients of different operating systems (e.g., Windows and Linux)? Are applications using the share dependent on platform-specific file attributes (like ADS or extended POSIX ACLs)? How is the file sharing service (e.g., Samba) configured to handle metadata and permission incompatibilities?",
        "asvs": "Derived from BSI IT-Grundschutz principles, particularly concerning system interoperability as seen in modules like SYS.1.3 (Windows Server) and SYS.2.1 (Linux and Unix Servers). There is no single direct control, but the risk arises from their interaction.",
        "cheatSheet": "https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html",
        "detectionLogic": "Triggers on technical assets with 'FileServer' technology that store data with more than minimal integrity requirements. The risk is inherent in such setups, as preserving file semantics across different operating systems is complex and a common source of data loss if not explicitly configured and verified.",
        "riskAssessment": "The likelihood is considered 'Likely' for any cross-platform file sharing scenario due to the complexity of maintaining perfect semantics.",
        "falsePositives": "This risk can be a false positive if the file server is used exclusively by clients of the same operating system family, if the server is explicitly configured to handle metadata incompatibilities (e.g., via Samba VFS modules), or if the stored data and associated applications do not use any platform-specific filesystem features.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "10_sec6.ts",
        "bsiCode": "APP.3.4",
        "id": "samba-tdb-inconsistency",
        "title": "Samba TDB Inconsistency on an Unreliable File System",
        "description": "Samba stores critical operational data—such as user mappings, share definitions, and session information—in Trivial Database (TDB) files. If the underlying operating system or file system does not handle these database files with sufficient performance and consistency (e.g., when placed on network shares like NFS/SMB without proper locking guarantees), the TDBs can become corrupted. This can lead to instability or complete failure of Samba services.",
        "impact": "Corruption of Samba's TDB databases can lead to severe service degradation or complete unavailability (Denial of Service). It may also cause silent data integrity loss for Samba's internal state, potentially affecting security controls and access rights.",
        "action": "Ensure Samba TDBs Are Stored on a Reliable, Local File System",
        "mitigation": "Store Samba's TDB files on a local, high-performance, and consistent file system (e.g., ext4, XFS). Avoid placing TDB files on network file systems (NFS, SMB/CIFS) unless the storage solution explicitly guarantees the required consistency and locking semantics for database-like workloads. Regularly back up TDB files as part of the system's backup strategy.",
        "check": "Review the Samba configuration (smb.conf) to identify the location of database directories (e.g., 'private dir', 'state directory'). Verify that these locations map to a local filesystem on the host server. Check monitoring for I/O errors or performance issues on the volume where TDBs are stored.",
        "asvs": "N/A - This is a specific infrastructure and configuration risk not directly covered by OWASP ASVS.",
        "cheatSheet": "https://wiki.samba.org/index.php/TDB_files",
        "detectionLogic": "This risk is identified when a technical asset representing a 'File Server' (as a proxy for Samba) communicates with a 'Datastore' over a network file system protocol such as NFS or SMB. This pattern suggests that the server's operational data, including TDBs, might be stored on network-attached storage, which is a known anti-pattern that can lead to database corruption.",
        "riskAssessment": "The likelihood of this risk is considered 'Likely' if the architectural pattern is detected, as it's a known cause of instability. The impact is determined by the Availability and Integrity requirements of the File Server asset. A 'Mission-Critical' server suffering from this issue would result in a 'Very High' impact.",
        "falsePositives": "The model might incorrectly represent the storage topology. The identified network storage might be used exclusively for user data shares, while the TDBs are correctly located on a local disk. This risk requires manual verification of the Samba server's configuration on the target system.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "SYS.4.4": [
      {
        "file": "110_sec1.ts",
        "bsiCode": "SYS.4.4",
        "id": "insecure-iot-components-sys-4-4",
        "title": "Insecure IoT Components (BSI SYS.4.4)",
        "description": "During the development of IoT devices, information security aspects are often not considered or are given low priority. This has repeatedly led to IoT devices being misused to gather information about users or their environment. The BSI provides examples such as hijacked surveillance cameras and baby monitors due to missing authentication, or backdoors in room sensors allowing unauthorized data exfiltration.",
        "impact": "A successful attack can lead to the takeover of the IoT device's control functions and the compromise of processed data (e.g., video streams, sensor data). This can result in espionage and the leakage of confidential information such as user credentials or infrastructure details, which can facilitate further, more sophisticated attacks on the network.",
        "action": "Implement Secure IoT Lifecycle Management",
        "mitigation": "Procure IoT devices from reputable manufacturers with a track record of security updates. Change all default credentials immediately upon deployment. Segment the network to isolate IoT devices from critical systems (e.g., using a dedicated VLAN or trust boundary). Disable all unnecessary services and ports. Implement a process for monitoring and applying firmware updates. Monitor network traffic from IoT devices for suspicious outbound connections.",
        "check": "Are default credentials changed on all IoT devices? Are IoT devices located in a separate, isolated network segment? Is there a process to keep firmware up to date? Are unnecessary features and services disabled? Is the network traffic from these devices monitored?",
        "asvs": "BSI IT-Grundschutz SYS.4.4 Allgemeines IoT-Gerät (General IoT Device)",
        "cheatSheet": "https://www.bsi.bund.de",
        "detectionLogic": "Triggers for all in-scope technical assets of the technology type 'IoT Device'. The risk is inherent to this class of devices due to widespread vulnerabilities like missing authentication, hardcoded credentials, and infrequent updates, unless explicitly hardened and managed.",
        "riskAssessment": "The likelihood is considered 'Very Likely' for internet-facing IoT devices and 'Likely' for internal ones, due to the prevalence of vulnerabilities. The impact scales with the confidentiality and integrity of the data processed or the environment controlled by the device. For example, a camera in a server room (processing 'Strictly Confidential' data) results in a 'Very High' impact.",
        "falsePositives": "Can be considered a false positive if the specific device has been through a thorough security assessment, is fully hardened, and managed according to best practices. This would typically be documented and validated outside the model.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "110_sec2.ts",
        "bsiCode": "SYS.4.4",
        "id": "uncontrolled-i@SystemType:OT-internet-exposure",
        "title": "Uncontrolled Internet Exposure of LAN-integrated I@SystemType:OT Devices",
        "description": "I@SystemType:OT devices integrated into local area networks (LANs) often attempt to independently establish a connection to the internet. They may use protocols like UPnP (Universal Plug and Play) to automatically configure routers for port forwarding. This makes the I@SystemType:OT devices, which may have unpatched vulnerabilities, visible and accessible from outside the trusted LAN. An attacker can exploit such a device to compromise it, incorporate it into a botnet, or use it as a piv@SystemType:OT point to inject malware into the internal network, leading to further malicious activities.",
        "impact": "If an externally exposed I@SystemType:OT device is compromised, it can serve as an entry point into an otherwise protected internal network. This could lead to widespread malware infection, data breaches of sensitive internal systems, and the disruption of critical business processes. The compromised device itself can be used for malicious purposes like participating in DDoS attacks as part of a botnet.",
        "action": "Segment I@SystemType:OT Devices and Implement Egress Filtering",
        "mitigation": "Disable UPnP on all network infrastructure devices within the LAN. Segment I@SystemType:OT devices into a separate, isolated network zone (VLAN/subnet) with strict firewall rules. Implement a default-deny egress filtering policy for the I@SystemType:OT network segment, only allowing connections to specific, required external endpoints. All traffic from the I@SystemType:OT segment to the internal corporate network should be blocked by default and only allowed on a case-by-case basis if absolutely necessary, typically through a proxy or gateway.",
        "check": "Are I@SystemType:OT devices deployed on the same network segment as critical internal assets? Is UPnP disabled on all routers and firewalls? Are there strict egress firewall rules in place for network segments containing I@SystemType:OT devices? Is traffic between the I@SystemType:OT segment and internal corporate networks monitored and restricted?",
        "asvs": "OWASP I@SystemType:OT Top 10: I5 - Lack of Network Hardening",
        "cheatSheet": "https://owasp.org/www-project-internet-of-things-project/assets/OWASP_IoT_Top_10_2018_final.pdf",
        "detectionLogic": "This rule checks for technical assets of technology type 'I@SystemType:OT-Device' that are located within an on-premise or LAN-like trust boundary but also have a direct communication link to an asset on the internet or are themselves marked as internet-facing. This configuration suggests a lack of proper network segmentation and control over the I@SystemType:OT device's external communications.",
        "riskAssessment": "The likelihood of exploitation is considered high due to the often-poor security posture of I@SystemType:OT devices and default-enabled features like UPnP. The impact is determined by the sensitivity of other assets located in the same network segment as the I@SystemType:OT device. If the I@SystemType:OT device shares a network with assets processing or storing highly confidential or critical data, a compromise could have a very high impact.",
        "falsePositives": "This risk can be a false positive if the modeled connection to the internet is intentional and secured through a dedicated, properly configured firewall with strict egress rules that is n@SystemType:OT explicitly modeled. The model might simply show a logical connection without capturing the network controls in place.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "SYS.4.5": [
      {
        "file": "111_sec1.ts",
        "bsiCode": "SYS.4.5",
        "id": "careless-handling-of-removable-media",
        "title": "Careless Handling of Removable Media",
        "description": "In many organizations, organizational regulations and technical security procedures for removable media exist,",
        "impact": "If removable media containing sensitive or critical data is lost, it can lead to a significant breach of confidentiality, especially if the data is unencrypted.",
        "action": "Enforce Secure Handling and Encryption Policies for Removable Media",
        "mitigation": "A comprehensive policy for the use of removable media must be created and enforced. All removable media used to store sensitive company data must be encrypted (e.g., using full-disk encryption).",
        "check": "Is there a policy for the secure use of removable media? Is strong encryption mandatory for all removable media containing sensitive data? Are users aware of the risks and trained in secure handling procedures?",
        "asvs": "BSI IT-Grundschutz CON.3 Removable Media",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Removable_media_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any technical asset identified as removable media (via the '@RemovableMedia' tag).",
        "riskAssessment": "The likelihood of careless handling of physical media is inherently high. The impact depends directly on the sensitivity (CIA rating) of the data stored on the media and whether effective encryption is used.",
        "falsePositives": "The model might n@SystemType:OT capture specific compensating controls, such as a strictly enforced organizational policy that only allows company-issued, pre-encrypted USB drives.",
        "cwe": "311",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "111_sec2.ts",
        "bsiCode": "SYS.4.5",
        "id": "insecure-handling-of-removable-media",
        "title": "Insecure Handling of Removable Media (BSI CON.3)",
        "description": "If the regulations for the correct handling of removable media (e.g., USB sticks, external hard drives) are n@SystemType:OT sufficiently known or followed, they cann@SystemType:OT be complied with.",
        "impact": "A system compromised by malicious removable media can lead to a loss of confidentiality, integrity, and availability for the system and the data it processes.",
        "action": "Establish and Enforce a Strict Policy for Removable Media Usage",
        "mitigation": "Define and enforce a clear policy for the use of removable media. This policy should include measures such as: disabling autorun features, scanning all media for malware before use, restricting the use of removable media to authorized personnel and devices only, and encrypting sensitive data stored on them.",
        "check": "Is there a formal policy for removable media? Are users trained on this policy? Are technical controls in place to enforce the policy (e.g., port blocking, mandatory scanning)? Are physical ports on servers in data centers secured?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Wechseldatenträger / Removable Media).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Removable_data_media_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is generated for any in-scope technical asset designated as a physical machine (`machine: physical`).",
        "riskAssessment": "The likelihood is considered `Likely` as it depends on user behavior, which can be unpredictable without strong technical and organizational controls.",
        "falsePositives": "This risk can be considered a false positive if all physical ports on the asset are verifiably disabled by technical controls (e.g., GPO, MDM) or are physically secured and inaccessible.",
        "cwe": "506",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "111_sec3.ts",
        "bsiCode": "SYS.4.5",
        "id": "data-loss-on-removable-media",
        "title": "Data Loss on Unencrypted Removable or Portable Media (BSI SYS.4.5)",
        "description": "The risk of data loss due to theft or physical loss is significantly higher for removable media (such as USB drives, external hard drives, optical media, or memory cards) than for stationary IT systems. If such media are lost or stolen and the storage is not encrypted, the information can be irretrievably lost (availability impact) and may be exposed to unauthorized third parties (confidentiality impact).",
        "impact": "This can lead to a severe breach of confidentiality if sensitive data is exposed, and a loss of availability if the data is not backed up elsewhere. This may result in financial loss, reputational damage, and non-compliance with data protection regulations like @DataType:PII.",
        "action": "Enforce Full-Disk and Removable Media Encryption",
        "mitigation": "All data stored at rest on removable media (USB drives, external hard drives, memory cards, optical media) must be encrypted using strong, industry-standard algorithms (e.g., via BitLocker, FileVault, LUKS). Implement policies that enforce encryption for all such media. Additionally, maintain regular backups of critical data to mitigate availability risks from device loss.",
        "check": "Are all technical assets representing portable systems or removable media configured with an `encryption` style other than `none`? Is there a policy enforcing encryption for data at rest on these types of assets?",
        "asvs": "BSI IT-Grundschutz SYS.4.5 Wechseldatenträger, particularly SYS.4.5.A10 (Data carrier encryption) and SYS.4.5.A12 (Protection against malware).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_Mobile_workstation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset that is inherently portable (e.g., `technology: client-system` or `desktop`) or represents removable storage (e.g., `type: datastore` with `technology: local-file-system` or `block-storage`). The risk is triggered if the asset stores data (`data_assets_stored` is not empty) but has its `encryption` property set to `none`.",
        "riskAssessment": "The likelihood of physical loss or theft of removable media is considered 'Likely'. The impact is calculated based on the Confidentiality and Availability of the data stored on the asset. If the data is highly sensitive or critical, the impact is high. The absence of encryption makes a data breach 'Probable' if the device is lost.",
        "falsePositives": "The risk can be considered a false positive if the asset, despite being removable or portable, is used exclusively within a highly secure physical environment (e.g., media that never leave a secure data center) and this is strictly enforced. Such exceptions must be documented and justified.",
        "cwe": "311",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "111_sec4.ts",
        "bsiCode": "SYS.4.5",
        "id": "physical-damage-to-removable-media",
        "title": "Physical Damage to Removable Media (BSI SYS.4.5)",
        "description": "Removable media, such as USB drives or external hard disks, are susceptible to damage, errors, or failures due to their size, portability, and physical nature.",
        "impact": "Failure or damage to removable media directly impacts the Availability and Integrity of the data stored on them.",
        "action": "Implement secure handling, encryption, and @Backup:Target policies for removable media",
        "mitigation": "To mitigate the risk of data loss from physical damage, enforce mandatory backups for any critical or important information stored on removable media.",
        "check": "Is there a policy governing the use of removable media? Is data encryption enforced for removable media that store sensitive information?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.4.5 (Wechseldatenträger), specifically the scenario 'Defekte Datenträger' (Defective data carriers).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Removable_data_media_edition_2023.pdf?__blob=publicationFile&v=2 (BSI SYS.4.5)",
        "detectionLogic": "This rule triggers for any 'datastore' technical asset that is explicitly marked with the `@RemovableMedia` tag. The risk is inherent to the physical nature of such devices.",
        "riskAssessment": "The likelihood of physical failure or damage is considered 'Likely' for portable media. The impact is calculated based on the Availability and Integrity requirements of the data stored on the asset.",
        "falsePositives": "The risk might be considered partially mitigated if strong physical controls, mandatory encryption, and robust @Backup:Target procedures are demonstrably in place.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "111_sec5.ts",
        "bsiCode": "SYS.4.5",
        "id": "removable-media-risk-con5",
        "title": "Risks of Using Removable Media (BSI SYS.4.5)",
        "description": "Removable media are used in very different environments and are therefore exposed to many threats.",
        "impact": "If removable media are not handled securely, it can lead to the loss of confidentiality, integrity, and availability of the data stored on them and the systems they connect to.",
        "action": "Implement Secure Handling Procedures for Removable Media",
        "mitigation": "A comprehensive policy for the use of removable media must be created and enforced.",
        "check": "Is there a documented and enforced policy for the use of removable media? Are technical controls like mandatory encryption and antivirus scanning in place?",
        "asvs": "BSI IT-Grundschutz SYS.4.5: Removable media",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Removable_media_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all in-scope technical assets that are classified as clients or other physically accessible device types (e.g., desktops, laptops, IoT devices).",
        "riskAssessment": "The impact of this risk is determined by the highest confidentiality, integrity, and availability requirements of the data processed or stored by the affected technical asset.",
        "falsePositives": "The risk may be a false positive if an organization has implemented effective technical controls that are not visible in the model, such as disabling all relevant physical ports via hardware settings or central management policies (MDM/GPO).",
        "cwe": "552",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "111_sec6.ts",
        "bsiCode": "SYS.4.5",
        "id": "malware-via-removable-media-sys-4-5",
        "title": "Malware Propagation via Removable Media (BSI SYS.4.5)",
        "description": "Removable media (e.g., USB drives, external hard disks) are often used to exchange data between different devices and workstations.",
        "impact": "If malware is introduced via removable media, it can lead to compromise of confidentiality (data theft), integrity (data manipulation),",
        "action": "Implement Strict Controls for Removable Media Usage",
        "mitigation": "Disable autorun/autoplay features for all media using endpoint management policies. Implement an endpoint protection solution (antivirus/antimalware)",
        "check": "Are endpoint protection systems configured to scan removable media? Are autorun features disabled via group policy or similar mechanisms?",
        "asvs": "BSI IT-Grundschutz Baustein SYS.4.5 Wechseldatenträger, e.g., Requirements SYS.4.5.A12 Schutz vor Schadsoftware and SYS.4.5.A4 Richtlinie zum sicheren Umgang mit Wechseldatenträgern.",
        "cheatSheet": "BSI IT-Grundschutz Kompendium – Baustein SYS.4.5 \\",
        "detectionLogic": "This risk is generated for any in-scope technical asset identified as a client system (e.g., `desktop`, `client-system`, `mobile-app`, `devops-client`)",
        "riskAssessment": "The likelihood is considered 'Likely' for general-purpose workstations without specific controls, as this is a common attack vector.",
        "falsePositives": "The risk might be a false positive if the asset is in a highly controlled physical environment where no external media can be introduced,",
        "cwe": "506",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "APP.3.6": [
      {
        "file": "11_sec1.ts",
        "bsiCode": "APP.3.6",
        "id": "dns-failure-bsi-app-3-6",
        "title": "DNS Server Failure (BSI APP.3.6)",
        "description": "If a DNS server fails, it can disrupt the entire IT operation. Because clients and other servers of the institution are then no longer able to resolve internal or external hostnames to addresses, data connections cannot be established. This risk identifies DNS servers that are not configured for high availability and therefore constitute a single point of failure (SPOF).",
        "impact": "A failure of a central DNS server leads to widespread service outages. External IT systems, such as those of mobile employees, customers, and business partners, cannot access the institution's servers. This typically disrupts essential business processes, leading to significant operational and financial losses.",
        "action": "Implement Redundant and Resilient DNS Infrastructure",
        "mitigation": "Ensure high availability of DNS services by implementing redundant DNS servers (e.g., a primary/secondary setup). The `redundant: true` flag should be set on the technical asset in the model to reflect this. Use multiple, geographically distributed DNS servers for critical operations. Implement active monitoring to quickly detect DNS server failures and trigger failover mechanisms. Ensure DNS server configurations are regularly backed up.",
        "check": "Is the technical asset tagged with '@Service:DNSServer' also marked as `redundant: true`? Are there multiple assets providing DNS services in a failover configuration? Is the availability of the DNS service actively monitored?",
        "asvs": "Derived from the BSI IT-Grundschutz-Kompendium 2023, Baustein APP.3.6: DNS-Server, specifically requirement APP.3.6.A2 'Einsatz redundanter DNS-Server' (Use of redundant DNS servers).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_DNS_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any in-scope technical asset that is tagged with `@Service:DNSServer` and is not marked as `redundant: true` in the model. The absence of the `redundant` flag on a critical infrastructure component such as a DNS server indicates a Single Point of Failure (SPOF).",
        "riskAssessment": "The likelihood is considered **Likely** for any non-redundant DNS server, as it represents a single point of failure. The impact is derived directly from the availability rating of the DNS server asset itself. A `Mission-Critical` DNS server leads to `Very-High` impact, `Critical` to `High` impact, and so on. The overall risk severity is a function of this likelihood and impact.",
        "falsePositives": "This risk can be a false positive if the DNS service's redundancy is managed by an underlying platform (e.g., a cloud provider's managed DNS service or a load balancer) even if the asset in the model is not explicitly marked as `redundant: true`.",
        "cwe": "0",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "11_sec2.ts",
        "bsiCode": "APP.3.6",
        "id": "insufficient-dns-capacity",
        "title": "Insufficient DNS Server Capacity (DoS Risk)",
        "description": "The BSI notes: 'If the network capacity for a DNS server is insufficient, access times to internal and external services can increase. As a result, these services may be only partially available or not available at all. The DNS server also becomes more susceptible to a Denial-of-Service (DoS) attack.' This risk applies to assets identified as DNS servers, especially those lacking redundancy.",
        "impact": "A successful Denial-of-Service attack or capacity overload on a central DNS server can render dependent services and applications unusable, severely impacting business operations. This directly threatens the availability of all IT infrastructure components that rely on it for name resolution.",
        "action": "Ensure DNS Server Redundancy and Capacity Planning",
        "mitigation": "Deploy DNS servers in a redundant, highly-available configuration (e.g., a cluster). Use load balancing to distribute requests. For internet-facing DNS servers, implement robust DoS protection measures (e.g., via a WAF, specialized provider, or cloud service features). Regularly monitor server load and network capacity, and scale resources proactively. The asset in the model should be marked as `redundant: true` to reflect these measures.",
        "check": "Is the technical asset configured for high availability (e.g., clustered, redundant instances)? Is it monitored for performance and load? Are there DoS protection mechanisms in place, especially if it's internet-facing?",
        "asvs": "Derived from a general BSI threat description regarding DNS availability. This aligns with high-availability architecture principles.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for technical assets tagged with `@Service:DNSServer`. The risk is generated if the asset is not marked as redundant (`redundant: false`). The severity is elevated if the asset is internet-facing and/or serves a large number of clients, as these factors increase its exposure and the potential impact of an outage.",
        "riskAssessment": "The likelihood of an outage is significantly increased by a lack of redundancy. Internet exposure makes the asset a more likely target for external attacks. The impact is derived from the availability requirement of the DNS server itself, as it is a critical infrastructure component for many other assets.",
        "falsePositives": "This rule may generate a false positive if an asset is modeled as a single component but is, in reality, a managed, highly-available DNS service (e.g., from a cloud provider) where redundancy is implicit. In such cases, the asset should be marked as `redundant: true` in the model to suppress this risk.",
        "cwe": "770",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "11_sec3.ts",
        "bsiCode": "APP.3.6",
        "id": "inadequate-dns-planning-bsi-net2.2",
        "title": "Insufficient or Missing Planning of DNS Deployment (BSI NET.2.2)",
        "description": "Planning errors often have particularly serious effects, as they can easily create widespread security vulnerabilities.",
        "impact": "If firewall rules controlling DNS traffic are too permissive, they can enable attacks such as DNS tunneling for data exfiltration (loss of Confidentiality) or DNS spoofing (loss of Integrity).",
        "action": "Develop and implement a comprehensive DNS security concept and firewall rule set",
        "mitigation": "A documented DNS concept should be created and maintained. Firewall rules for DNS traffic must be defined on a strict 'allow-list' basis, only permitting necessary queries from specific sources to authorized servers.",
        "check": "Is there a documented DNS concept? Are firewall rules for DNS traffic based on an 'allow-list' principle? Is DNS traffic monitored for anomalies? Is a Protective DNS service in use? Is DNSSEC validated?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein NET.2.2 (@Service:DNSServer), specifically relating to threat NET.2.2.A2 (Unplanned or improper connection of a DNS server to the Internet).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_2_2_DNS_server_edition_2023.pdf?__blob=publicationFile (BSI NET.2.2)",
        "detectionLogic": "This risk is triggered for any network-level trust boundary (such as on-premises networks, cloud providers, or security groups) that has traffic crossing it and is not explicitly marked with the '@DNS-Concept-Applied' tag.",
        "riskAssessment": "The likelihood is considered 'likely' if no documented DNS concept exists for a network boundary. The impact is derived from the highest sensitivity (CIA ratings) of the assets located inside the trust boundary.",
        "falsePositives": "This risk can be a false positive if a robust DNS security concept is in place but the corresponding trust boundary has not been tagged in the model.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "11_sec4.ts",
        "bsiCode": "APP.3.6",
        "id": "incorrect-dns-information",
        "title": "Incorrect DNS Information",
        "description": "Even if the use of DNS has been carefully planned and all security-relevant points have been taken into account, this is not sufficient if semantically and syntactically incorrect domain information is created.",
        "impact": "Incorrect or maliciously altered DNS information can lead to severe service disruptions (Availability), as applications may be unable to connect to required backends, databases, or external services.",
        "action": "Implement and Enforce DNS Data Integrity and Consistency Checks",
        "mitigation": "Ensure that access to DNS server configuration and zone files is strictly controlled. Implement a four-eyes principle for changes to critical DNS records.",
        "check": "Are there processes to verify the correctness of DNS records before and after they are deployed? Is access to manage DNS records restricted to authorized personnel?",
        "asvs": "BSI IT-Grundschutz NET.1.1 @Service:DNSServer, specifically Requirement NET.1.1.A5 'Konsistente Zonendaten' (Consistent zone data).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_1_DNS_server_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset explicitly marked as a DNS server via the '@Service:DNSServer' tag.",
        "riskAssessment": "The likelihood of misconfiguration is considered 'Likely' due to the manual nature and complexity of DNS management. The impact scales with the highest Confidentiality, Integrity, and Availability requirements of all dependent client systems.",
        "falsePositives": "This rule might generate a false positive if the tagged asset is merely a caching or forwarding DNS resolver and not authoritative for any zones. The risk primarily applies to authoritative DNS servers where incorrect data can originate.",
        "cwe": "20",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "11_sec5.ts",
        "bsiCode": "APP.3.6",
        "id": "misconfigured-@Service:DNSServer",
        "title": "Misconfigured DNS Server (BSI APP.3.6)",
        "description": "Security-critical default settings, custom security-critical settings, or incorrect configurations can cause a DNS server to malfunction. This includes issues such as operating as an open resolver or permitting unrestricted zone transfers.",
        "impact": "An open resolver configuration can severely impair the server's availability due to increased load and expose it to DNS reflection attacks, leading to denial of service. Additionally, unrestricted zone transfers allow unauthorized hosts to read complete domain information (zone data), which contains valuable network topology details that can facilitate subsequent attacks.",
        "action": "Secure DNS Server Configuration",
        "mitigation": "Configure the DNS server to accept recursive queries only from trusted internal networks (disable open recursion). Restrict DNS zone transfers (e.g., AXFR/IXFR queries) strictly to the IP addresses of authorized secondary DNS servers. Ensure the DNS server software is kept up to date and patched against known vulnerabilities.",
        "check": "Is recursion for external queries disabled? Are zone transfers restricted to specific, authorized IP addresses? Is the DNS server software regularly patched?",
        "asvs": "BSI IT-Grundschutz APP.3.6 DNS-Server, e.g., A4 (Secure base configuration of a DNS server: restrict recursion and zone transfers) and A18 (Enhanced protection of zone transfers).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_DNS-Server_Edition_2023.html",
        "detectionLogic": "This rule identifies assets tagged as DNS servers. It then checks for two distinct misconfiguration risks: 1. If the DNS server receives any communication from an asset marked as 'internet', it raises a Denial-of-Service risk due to potential abuse as an open resolver. 2. If the DNS server receives communication from an asset outside its own network trust boundary (and that source is not a DNS server), it raises an Information Disclosure risk due to potential unrestricted zone transfers.",
        "riskAssessment": "The likelihood for both risks is considered high if the respective exposure exists, as these are common and well-known attack vectors. The impact of the 'open resolver' vulnerability is rated based on the 'availability' requirement of the DNS server asset. The impact of the 'unrestricted zone transfer' vulnerability is rated based on the 'confidentiality' of the data stored and the network information that would be revealed.",
        "falsePositives": "A connection from the internet might be intended for an authoritative-only server, which is less risky than a recursive one; the model cannot distinguish query types. A connection from another network might be for a legitimate, authorized secondary server that happens to be in a different network trust boundary. Manual verification of the server's specific configuration is required.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "11_sec6.ts",
        "bsiCode": "APP.3.6",
        "id": "dns-cache-poisoning-app4.4",
        "title": "DNS Cache Poisoning (BSI APP.3.6)",
        "description": "A DNS cache poisoning attack aims to make the attacked IT system store incorrect mappings of IP addresses and names.",
        "impact": "Successful DNS cache poisoning attacks are often conducted with the goal of redirecting requests to malicious servers (e.g., for phishing or malware distribution).",
        "action": "Implement Secure DNS Resolution Mechanisms",
        "mitigation": "Use trusted, security-aware DNS resolvers that support DNSSEC. For clients and applications making outbound calls, enable DNSSEC validation to ensure the authenticity and integrity of DNS responses.",
        "check": "Are all clients and servers configured to use a trusted, corporate DNS resolver? Is DNSSEC validation enforced for external lookups?",
        "asvs": "V14.2 Communication Security Verification Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/DNS_Security_Cheat_Sheet.html",
        "detectionLogic": "This risk is flagged for any technical asset that communicates with an asset on the internet from within a trusted network boundary.",
        "riskAssessment": "The likelihood is considered higher for client-type technologies (browsers, mobile apps, IoT devices) which may operate on less trusted networks.",
        "falsePositives": "This risk is triggered based on the modeled network topology. It may be a false positive if the target domain is non-critical, or if the client application has other built-in protections against redirection (e.g., certificate pinning, which is not modeled here).",
        "cwe": "290",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "11_sec7.ts",
        "bsiCode": "APP.3.6",
        "id": "dns-hijacking",
        "title": "DNS Hijacking",
        "description": "DNS Hijacking is a Man-in-the-Middle (MITM) attack method used to intercept and redirect communication by compromising the Domain Name System (DNS) resolution process. An attacker can route communication between a client's resolver and a DNS server through their own system. This allows them to eavesdrop on, record, and arbitrarily modify the traffic. A successful attack enables the attacker to change the IP address associated with a domain name, redirecting users to malicious sites.",
        "impact": "Successful DNS hijacking can lead to phishing attacks, credential theft, and malware distribution by redirecting users to fraudulent websites. It fundamentally undermines the trust in domain names, compromising the integrity of communications. This can result in significant financial loss, reputational damage, and the compromise of sensitive data (violating Confidentiality and Integrity).",
        "action": "Enforce Encrypted Communication Protocols and Secure DNS",
        "mitigation": "All communication, especially across trust boundaries to the internet, must use encrypted protocols (e.g., HTTPS, LDAPS, FTPS). This prevents MITM attacks, including those facilitated by DNS hijacking. Additionally, utilize secure DNS protocols like DNS-over-HTTPS (DoH) or DNS-over-TLS (D@SystemType:OT) to encrypt the DNS queries themselves. Implementing DNSSEC validation at the resolver ensures the authenticity and integrity of DNS responses. If unencrypted protocols are unavoidable, ensure they are protected by a mandatory, trusted VPN, which should be modeled with the 'vpn: true' property on the communication link.",
        "check": "Review all communication links that cross trust boundaries to external or internet-facing assets. Verify that they exclusively use strongly encrypted protocols. Check client and server configurations for the use of secure DNS (DoH/D@SystemType:OT) and DNSSEC validation.",
        "asvs": "BSI IT-Grundschutz: SYS.1.2.2 DNS Server. OWASP: ASVS V4.0.3 - 9.1.1 (Verify that all connections to external systems are authenticated and encrypted in transit).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any unencrypted communication link from an in-scope asset to an external, internet-facing asset. Such connections rely on DNS for resolution, and without transport-layer encryption, they are vulnerable to MITM attacks initiated via DNS hijacking.",
        "riskAssessment": "The likelihood is considered 'Likely' for any unencrypted channel to the internet, as the means for MITM attacks are widespread. The impact is determined by the sensitivity (Confidentiality and Integrity) of the data assets transferred over the communication link and the criticality of the communicating technical assets. Transferring 'Confidential' data over an unencrypted link results in a 'High' impact.",
        "falsePositives": "A risk might be a false positive if the communication protocol, while technically unencrypted, is protected by other compensating controls like a mandatory, trusted VPN that encrypts all traffic between the two endpoints. This must be modeled explicitly (e.g., using the `vpn: true` property on the communication link).",
        "cwe": "345",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "11_sec8.ts",
        "bsiCode": "APP.3.6",
        "id": "dos-on-@Service:DNSServer",
        "title": "Denial-of-Service Attack on a DNS Server",
        "description": "In a Denial-of-Service (DoS) attack on a DNS server, a vast number of requests, typically from a botnet, are sent to the server.",
        "impact": "A successful DoS attack against a DNS server will lead to a loss of availability for all systems and applications that depend on it.",
        "action": "Implement Volumetric DoS Protection and Ensure DNS Redundancy",
        "mitigation": "Protect DNS servers with a specialized DoS mitigation service (e.g., from a CDN or cloud provider).",
        "check": "Is the DNS server protected by a professional anti-DoS service? Are there redundant, geographically separate DNS servers?",
        "asvs": "OWASP ASVS V4.0.3: 11.1.1 (Verify that the application is able to handle requests and gracefully fail when under a denial of service attack.)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any technical asset identified as a DNS server (via the '@Service:DNSServer' tag) that is exposed to untrusted networks.",
        "riskAssessment": "The likelihood of an attack is high for any public-facing DNS server. The impact is directly proportional to the availability requirement",
        "falsePositives": "This risk might be a false positive if the DNS service is provided by a major cloud provider (e.g., AWS Route 53, Google Cloud DNS)",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "APP.4.2": [
      {
        "file": "12_sec1.ts",
        "bsiCode": "APP.4.2",
        "id": "insecure-sap-erp-configuration-bsi-app2.1",
        "title": "Insecure SAP ERP Configuration (BSI APP.2.1)",
        "description": "If an SAP ERP system is set up without adhering to the recommended security guides from SAP, it can lead to serious security vulnerabilities.",
        "impact": "Failure to follow SAP hardening guides can compromise the confidentiality, integrity, and availability of the entire ERP system.",
        "action": "Apply SAP Security Hardening Guides",
        "mitigation": "The SAP ERP system must be configured and hardened according to the official SAP security recommendations and best practices.",
        "check": "Has the SAP ERP system been configured according to SAP's security best practices and hardening guides? Has a security audit of the SAP configuration been performed?",
        "asvs": "BSI IT-Grundschutz APP.2.1 SAP-ERP-System",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_2_1_SAP_ERP_System_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all in-scope technical assets of the 'ERP' technology type, as these are assumed to be SAP systems in the context of this rule.",
        "riskAssessment": "The likelihood is considered high by default due to the complexity of SAP systems, making misconfigurations common. The impact is derived from the",
        "falsePositives": "This risk might be a false positive if the system is confirmed to be fully hardened according to SAP guidelines, but this information is n@SystemType:OT captured in the threat model.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "12_sec2.ts",
        "bsiCode": "APP.4.2",
        "id": "missing-sap-patches-or-security-notes",
        "title": "Missing SAP Patches or Security Notes",
        "description": "SAP ERP systems are complex and typically process sensitive data. SAP regularly publishes patches and security advisories to fix software bugs and known vulnerabilities.",
        "impact": "Failure to apply SAP patches promptly can lead to the exploitation of known vulnerabilities. This can compromise the confidentiality of sensitive data, the integrity of business-critical processes, and the availability of the entire ERP system, potentially causing significant financial and reputational damage.",
        "action": "Implement and Enforce a Timely Patch Management Process for SAP Systems",
        "mitigation": "Establish a formal patch management process for all SAP systems. This process should include regularly monitoring for new SAP security notes and patches, assessing their relevance and criticality, testing them in a non-production environment, and deploying them to production systems within a defined timeframe. Automate monitoring and deployment where possible and maintain an audit trail of all applied patches.",
        "check": "Is there a documented patch management policy for SAP systems? Are SAP security notes actively monitored? Is there a defined process for testing and deploying patches within a specified timeframe? Are patch levels regularly audited?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.1.1 (General Server), Requirement SYS.1.1.A20 (Timely application of security updates).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_1_General_server_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is automatically raised for any technical asset identified as an SAP ERP system (technology: 'erp'). The risk's severity is calculated based on the CIA ratings of the asset and of the data it processes or stores.",
        "riskAssessment": "The likelihood is considered 'likely' by default, as patch management is an ongoing operational task requiring constant diligence. The impact escalates from 'low' to 'very high' depending on the confidentiality, integrity, and availability requirements of the ERP system and the data it handles. For systems critical to business operations, the impact can be very high.",
        "falsePositives": "This risk can be considered a false positive if a robust, audited, and timely patch management process for SAP systems is verifiably in place. This cannot be determined from the model alone and requires reviewing operational security procedures and records.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "12_sec3.ts",
        "bsiCode": "APP.4.2",
        "id": "inadequate-sap-authorization-concept",
        "title": "Inadequate SAP Authorization Concept (BSI APP.4.2)",
        "description": "SAP authorization concepts are technically and functionally complex. Due to this complexity, they are often poorly planned or implemented. Without a well-thought-out concept, accounts are frequently assigned excessive permissions (violating the principle of least privilege), which could be used to intentionally manipulate or accidentally damage the SAP ERP system, thus compromising its integrity, confidentiality, and availability.",
        "impact": "These issues can lead to unauthorized access, data manipulation, fraud, and exposure of sensitive business data. In S/4HANA systems, misaligned permissions between ABAP, HANA, and NetWeaver Gateway components can create conflicting and insecure access states. Poor documentation prevents effective maintenance and access reviews, allowing former employees or those in new roles to retain unnecessary privileges.",
        "action": "Design, implement, and document a role-based SAP authorization concept",
        "mitigation": "Develop and enforce a detailed, role-based authorization concept based on the principle of least privilege. For S/4HANA, ensure permissions are synchronized across ABAP, HANA, and NetWeaver Gateway. Thoroughly document the concept and all assigned privileges. Implement regular, periodic access reviews (user access recertification) to ensure permissions are aligned with current job roles and to remove obsolete access for movers and leavers. Use specialized tools to analyze and manage SAP authorizations to identify and remediate excessive privileges. Mark the asset with the `@Mitigation:sap-authorization-concept-reviewed` tag once this has been verified.",
        "check": "Is there a documented, role-based SAP authorization concept? Are permissions regularly reviewed? Is there a process to handle movers and leavers in a timely manner? Are permissions across different S/4HANA components synchronized and consistent?",
        "asvs": "BSI IT-Grundschutz APP.4.2 SAP-ERP-System",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_4_2_SAP_ERP_System_Edition_2022.html",
        "detectionLogic": "This risk is raised for any in-scope technical asset of technology type 'ERP', as these systems are complex and prone to having inadequate authorization concepts if not explicitly and carefully designed and maintained. The risk can be mitigated by verifying a robust authorization concept is in place and tagging the asset with `@Mitigation:sap-authorization-concept-reviewed`.",
        "riskAssessment": "The likelihood is considered high by default due to the inherent complexity of SAP systems. The impact is derived from the CIA rating of the ERP system itself. An ERP system handling 'Strictly Confidential' data or rated as 'Mission-Critical' will result in a very high impact, leading to a critical overall risk.",
        "falsePositives": "The risk is a generic best-practice check for SAP systems. It may be a false positive if a robust, well-documented, and regularly reviewed authorization concept already exists. This must be confirmed by manual review.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "12_sec4.ts",
        "bsiCode": "APP.4.2",
        "id": "lack-of-erp-documentation-and-contingency-plan",
        "title": "Lack of SAP/ERP System Documentation and/or Contingency Plan",
        "description": "If documentation for an SAP/ERP system is non-existent or not maintained, it becomes impossible to track how the system was configured and built.",
        "impact": "Failure to document the system and prepare contingency plans can severely impact the system's availability. In a failure scenario, recovery efforts will be slow and disorganized,",
        "action": "Create and Maintain System Documentation and Contingency Plans",
        "mitigation": "Create comprehensive technical and operational documentation for the SAP/ERP system, covering all configurations, customizations, and dependencies. Keep this documentation up-to-date with any changes.",
        "check": "Is there up-to-date, comprehensive documentation for the SAP/ERP system? Does a detailed, tested contingency plan for the system exist? Are the responsible personnel aware of and trained on the plan?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.4.2 (SAP-ERP-System), notably section 2.4 (Missing SAP documentation and emergency plans) and requirement APP.4.2.A28 (Creation of an emergency plan).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_4_2_SAP_ERP_System_Edition_2023.pdf?__blob=publicationFile (German BSI Reference)",
        "detectionLogic": "Triggers on in-scope technical assets with the 'ERP' technology type. The risk is raised if the asset is business-critical (in terms of availability) and lacks the `@documentation-present` or `@contingency-plan-present` tags.",
        "riskAssessment": "The impact is directly tied to the availability rating of the ERP system. For a 'mission-critical' system, the impact is 'very-high' as its failure would halt core business functions.",
        "falsePositives": "This risk may be a false positive if the required documentation and plans exist in reality but have not been tagged accordingly in the threat model. The purpose of this risk is to prompt verification.",
        "cwe": "755",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "APP.4.3": [
      {
        "file": "13_sec1.ts",
        "bsiCode": "APP.4.3",
        "id": "insufficient-hardware-resources-for-database",
        "title": "Insufficient Hardware Resources for Database System (BSI-based)",
        "description": "If the hardware of a database system does n@SystemType:OT have sufficient system resources (CPU, memory, storage I/O),",
        "impact": "A lack of sufficient hardware resources for a database directly threatens its Integrity and Availability.",
        "action": "Implement and Monitor Capacity Management",
        "mitigation": "Ensure the database system is provisioned with adequate hardware resources (CPU, memory, I/O, storage) to handle peak loads, based on a capacity plan (BSI OPS.1.1.5.A1).",
        "check": "Is there a capacity plan for the database? Is performance and resource utilization being monitored?",
        "asvs": "BSI IT-Grundschutz: OPS.1.1.5 Capacity management (especially A1 Planning, A2 Monitoring)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Capacity_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for all technical assets of the 'Database' technology type.",
        "riskAssessment": "The impact is determined by the availability and integrity requirements of the database asset and the data it stores.",
        "falsePositives": "This risk can be a false positive if the database is already well-provisioned and monitored, which cann@SystemType:OT be determined from the model alone.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "13_sec2.ts",
        "bsiCode": "APP.4.3",
        "id": "default-database-accounts",
        "title": "Default Accounts on Database Management Systems (BSI APP.4.4.A6)",
        "description": "Upon initial installation or in its delivery state, a Database Management System (DBMS) often has default accounts (for users and administrators) that are either unsecured or protected only by publicly known passwords.",
        "impact": "Successful exploitation allows unauthorized access to the database with potentially administrative privileges. This can lead to a complete compromise of the confidentiality, integrity, and availability of all data stored in the database, as well as manipulation of the DBMS configuration.",
        "action": "Secure or Remove Default Database Accounts",
        "mitigation": "All default passwords for pre-configured accounts on the DBMS must be changed to strong, unique values immediately after installation. Unnecessary or unused default accounts should be disabled or deleted. Access to administrative accounts must be tightly controlled and monitored.",
        "check": "Verify that no default accounts exist on the database with their initial, publicly known passwords. Check if unused default accounts have been disabled or removed. Review the database hardening guide and confirm its application.",
        "asvs": "BSI IT-Grundschutz APP.4.4.A6 (Secure administration account for the DBMS)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_Database_management_system_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all technical assets of technology type 'Database' or 'Identity-Store-Database' that are not explicitly tagged as hardened or as having their default accounts secured. These systems are prime targets for attacks using default credentials.",
        "riskAssessment": "The likelihood of exploitation is very high, as scanning for default credentials is a common automated attack vector. The impact is directly related to the sensitivity (Confidentiality and Integrity) of the data stored within the database. A database containing 'Strictly Confidential' data will result in a 'Very High' impact.",
        "falsePositives": "This risk can be a false positive if the database was installed from a pre-hardened 'golden image' or if automated configuration management tools have secured the default accounts, but the corresponding tags (`hardened`, `default-accounts-secured`) have not been applied in the model.",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "13_sec3.ts",
        "bsiCode": "APP.4.3",
        "id": "unencrypted-database-communication",
        "title": "Unencrypted Communication to Database (BSI-derived)",
        "description": "In their default configuration, many database management systems (DBMS) connect to applications without encryption.",
        "impact": "Eavesdropping on the communication can lead to the disclosure of sensitive business data, personal data, or technical credentials.",
        "action": "Enforce Encrypted Database Connections",
        "mitigation": "Configure all communication links between applications and database systems to use strong, state-of-the-art encryption protocols (e.g., via TLS).",
        "check": "Review the connection strings and configuration for all application-to-database links. Verify that an encrypted protocol is used.",
        "asvs": "V9.1 Data Protection",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule identifies communication links where the target is a 'Database' technology and the protocol used is n@SystemType:OT recognized as encrypted.",
        "riskAssessment": "The impact is determined by the highest Confidentiality and Integrity of the data assets transferred over the link.",
        "falsePositives": "Can occur if a custom or non-standard protocol that includes encryption is used but n@SystemType:OT recognized by the tool.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "13_sec4.ts",
        "bsiCode": "APP.4.3",
        "id": "data-loss-in-database-due-to-failures",
        "title": "Data Loss in a Database due to Technical or Human Failure (BSI APP.4.3)",
        "description": "Data can be lost in a database due to hardware or software errors, as well as human misconfiguration or mistakes.",
        "impact": "Since databases typically store information critical for applications, the loss or unavailability of data can cause services to fail or",
        "action": "Implement and regularly test backup and recovery procedures and/or high availability.",
        "mitigation": "Regularly create backups of the database. Store backups securely and in a separate location (ideally off-site or in a different availability zone).",
        "check": "Are regular backups of the database being created? Are backups stored securely and separately? Is there a documented and tested recovery plan? Is the database asset marked as 'redundant' in the model to reflect a high-availability setup?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.4.3: Relationale Datenbanken.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_5_Datenbanken.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is generated for all in-scope technical assets of type 'datastore' with the technology 'database' that are not marked as redundant. The assumption is that a non-redundant database represents a single point of failure regarding data availability and integrity.",
        "riskAssessment": "The likelihood is considered 'likely' for any non-redundant critical system over its lifetime, as hardware, software, or human errors are inevitable. The impact is directly tied to the availability and integrity ratings of the technical asset and the data it stores. A database supporting mission-critical processes will have a 'very-high' impact if it fails.",
        "falsePositives": "This risk might be a false positive if high-availability or backup and recovery mechanisms exist but are not modeled. To mitigate this, mark the corresponding database asset as 'redundant: true' in the model file if such controls are in place.",
        "cwe": "755",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "13_sec5.ts",
        "bsiCode": "APP.4.3",
        "id": "data-integrity-violation-in-database-con-4-a19",
        "title": "Violation of Data Integrity in a Database (BSI CON.4.A19)",
        "description": "The integrity of information in a database can be violated due to misconfigurations, software errors, or direct data manipulation.",
        "impact": "If data integrity is compromised and not detected promptly, it can lead to incorrect business decisions, financial loss (e.g., due to faulty billing or tax data),",
        "action": "Implement and Enforce Data Integrity Controls",
        "mitigation": "Utilize database-native integrity constraints like primary keys, foreign keys (referential integrity), UNIQUE, NOT NULL, and CHECK constraints.",
        "check": "Review the database schema for the use of integrity constraints (foreign keys, check constraints, etc.). Analyze application code for strict server-side validation logic before database writes. Are there auditing or monitoring mechanisms in place to detect unauthorized or unexpected data changes?",
        "asvs": "V7.1.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html",
        "detectionLogic": "Triggers on in-scope technical assets of type 'datastore' with database-related technologies (e.g., 'database', 'identity-store-database', 'data-lake', 'big-data-platform').",
        "riskAssessment": "The impact is determined by the highest 'integrity' and 'availability' classification of the data assets stored within the database.",
        "falsePositives": "This risk might be a false positive if data integrity is enforced entirely and robustly at the application layer, but this is not documented in the model via the mitigation tag.",
        "cwe": "353",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "13_sec6.ts",
        "bsiCode": "APP.4.3",
        "id": "sql-injection-bsi",
        "title": "SQL Injection",
        "description": "A common attack method on database systems is SQL Injection. When an application accesses data from an SQL database, commands are transmitted to the DBMS as SQL statements. If input data is insufficiently validated within the application, attackers can inject their own SQL commands, which are then processed with the permissions of the application's service account.",
        "impact": "Attackers can read, manipulate, delete, or add data, and potentially execute system commands. While SQL injections primarily target applications, they have a significant impact on the database system itself and the associated infrastructure, potentially leading to complete data compromise (Confidentiality, Integrity), system unavailability (Availability), and further infrastructure compromise.",
        "action": "Implement Input Validation and Use Parameterized Queries",
        "mitigation": "The primary defense is to use parameterized queries (prepared statements) for all database access. All user-supplied input must be validated, filtered, or sanitized on the server side. Enforce the principle of least privilege for the database service account. Use an ORM (Object-Relational Mapping) framework that correctly handles parameterization. Avoid dynamic SQL query construction with unvalidated data.",
        "check": "Is all user-supplied input strictly validated? Are parameterized queries or prepared statements used for all database interactions? Does the database service account have the minimum necessary permissions? Is dynamic SQL construction with unvalidated data avoided?",
        "asvs": "V5.3.3: Verify that the application protects against SQL injection attacks.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for technical assets (like Web Applications or Web Services) that are custom-developed and have a direct communication link to a database using a SQL-based protocol. The risk is heightened if the asset is exposed to the internet or processes data from untrusted sources, as this provides a vector for malicious input.",
        "riskAssessment": "Likelihood is HIGH for custom-developed applications that are exposed to the internet and do n@SystemType:OT use a modern, secure ORM. Impact is directly related to the Confidentiality and Integrity of the data in the connected database. If the database contains 'Strictly Confidential' or 'Mission-Critical' data, the impact is Very High.",
        "falsePositives": "The risk may be a false positive if the application uses a modern, secure framework (like a well-configured ORM) that prevents SQLi by default, even if the model shows the vulnerable pattern. Verification requires code review or dynamic/static application security testing (DAST/SAST).",
        "cwe": "89",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "13_sec7.ts",
        "bsiCode": "APP.4.3",
        "id": "unhardened-database-defaults",
        "title": "Insecure Default Configuration of Database System (BSI-DB-STD-CFG)",
        "description": "In the default configuration of a database management system (DBMS), unnecessary functions are often enabled. This can make it easier for attackers to read or manipulate data in the database. For example, due to an unchanged default installation, attackers might connect to an unused administrative programming interface without authenticating. This could allow unauthorized access to the institution's databases.",
        "impact": "If this vulnerability is exploited, an attacker could gain unauthorized administrative access to the database. This would allow them to read, modify, or delete sensitive data, leading to a breach of confidentiality and integrity. It could also lead to a denial of service by altering or deleting database components.",
        "action": "Harden Database Configuration",
        "mitigation": "Review the default configuration of the DBMS and disable all unnecessary features, services, and programming interfaces. Ensure that all administrative interfaces require strong authentication and are not exposed to untrusted networks. Apply security configuration hardening guides from the vendor or trusted third parties (e.g., CIS Benchmarks). The application of a `@Hardened:Database` tag on the asset can signify that this review and hardening process has been completed.",
        "check": "Is the database configuration regularly reviewed and hardened against a security baseline (like CIS Benchmarks)? Are all unused features and interfaces disabled? Is strong authentication enforced on all administrative access points?",
        "asvs": "V14.2.1 (Secure Configuration), V14.2.3 (Unnecessary Features Disabled)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Secure_Configuration_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for any technical asset of type `database` that has not been explicitly marked as hardened. The absence of a `@Hardened:Database` tag is used as the indicator. It assumes that without explicit confirmation, a database might retain insecure default settings.",
        "riskAssessment": "The likelihood is considered 'likely' for unhardened databases, as default configurations are a well-known attack vector. The impact relates directly to the sensitivity (CIA ratings) of the data stored in the database. A database holding `strictly-confidential` data will have a 'very high' impact, while one with only `public` data will have a 'low' impact.",
        "falsePositives": "Can occur if the database *is* hardened in reality but has not been tagged accordingly in the threat model. Verification requires checking the actual configuration of the database instance.",
        "cwe": "1188",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "13_sec8.ts",
        "bsiCode": "APP.4.3",
        "id": "unchecked-or-malicious-database-scripts",
        "title": "Unchecked or Malicious Database Scripts (BSI APP.4.3.A19)",
        "description": "Database management systems often allow actions to be automated via scripts executed within the database context (e.g., PL/SQL, triggers). If used without proper review by responsible personnel, these scripts may not meet the institution's software development requirements. Furthermore, core database functions, such as data dictionary tables, can be manipulated by attackers using malware or database scripts. Such attacks are difficult to detect. Quality defects in these scripts and embedded malware can compromise the confidentiality, integrity, and availability of data stored in the databases.",
        "impact": "Successful exploitation can lead to data tampering, unauthorized data disclosure, or denial of service for the database. This compromises the confidentiality, integrity, and availability (CIA) of stored data, potentially leading to significant business disruption, financial loss, and reputational damage.",
        "action": "Implement strict change control and secure coding practices for database scripts",
        "mitigation": "Establish a formal process for developing, reviewing, and deploying all database scripts, including stored procedures, triggers, and automated jobs. This process should include peer reviews and security testing to identify vulnerabilities and quality issues. Access to create or modify these scripts should be highly restricted. Regularly monitor for unauthorized changes to database schemas and core functions. Ensure developers are trained in secure database programming practices.",
        "check": "Is there a mandatory code review process for all database scripts? Are permissions to create stored procedures and triggers limited to authorized administrators? Is there active monitoring for changes to the database's core components and active scripts?",
        "asvs": "BSI IT-Grundschutz APP.4.3.A19 Schutz vor schädlichen Datenbank-Skripten",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Database_management_system_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for all in-scope technical assets of type 'datastore' with the 'database' technology. The likelihood of this risk increases if the database is marked as having custom-developed parts, as this implies a higher probability of using custom scripts.",
        "riskAssessment": "The impact is determined by the highest confidentiality, integrity, and availability requirements of the database and the data it stores. The likelihood is considered 'Likely' by default for databases and 'Very Likely' if they involve custom-developed parts, reflecting the inherent risk of complex, unaudited code running with high privileges.",
        "falsePositives": "This risk may be a false positive if the organization has robust, out-of-band controls for database script management (e.g., all database changes managed via a GitOps workflow with mandatory approvals) that are not reflected in the Threagile model.",
        "cwe": "506",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      }
    ],
    "APP.4.4": [
      {
        "file": "14_sec1.ts",
        "bsiCode": "APP.4.4",
        "id": "unprotected-administrative-access",
        "title": "Unprotected Administrative Access",
        "description": "To manage runtimes, nodes, and container platforms like Kubernetes, administrators and automated tools require administrative access.",
        "impact": "Successful exploitation allows an attacker to gain administrative control over the affected component. This can lead to arbitrary code execution,",
        "action": "Enforce Authentication and Encryption on Administrative Interfaces",
        "mitigation": "Ensure that all administrative access points (network ports, APIs, sockets) for infrastructure components (like Kubernetes, databases, application servers)",
        "check": "Review the configuration of all relevant infrastructure components. Are all administrative network ports and APIs configured with mandatory authentication?",
        "asvs": "V14.2.1: Secure Component Configuration",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for incoming communication links configured for 'DevOps' usage that target critical infrastructure components.",
        "riskAssessment": "The impact is determined by the CIA rating of the target asset and the data it processes or stores. A high-value asset leads to a high or very high impact.",
        "falsePositives": "The risk might be a false positive if the administrative interface is protected by other compensating controls not modeled in detail,",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "14_sec2.ts",
        "bsiCode": "APP.4.4",
        "id": "stolen-kubernetes-access-token",
        "title": "Stolen Kubernetes Access Token from Pod",
        "description": "Pods often require access tokens (associated with a Service Account) to interact with the Kubernetes API server (Control Plane).",
        "impact": "With a stolen token, an attacker can perform authenticated actions against the Control Plane.",
        "action": "Apply the principle of least privilege to Service Accounts and Pods",
        "mitigation": "Ensure that Kubernetes Service Accounts have the minimum required permissions (RBAC).",
        "check": "Review the permissions of all Service Accounts. Are they overly permissive? Do pods that don't need API access still have tokens mounted?",
        "asvs": "OWASP Kubernetes Top 10: K01 - Insecure Workload Configurations",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Kubernetes_Security_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for any technical asset running as a container (`machine: container`) that is not the container platform itself.",
        "riskAssessment": "The likelihood of exploitation is considered higher for custom-developed parts, as they present a larger attack surface than off-the-shelf software.",
        "falsePositives": "This risk may be a false positive if the specific service account used by the pod has no permissions at all, or if the token is verifiably not mounted within the pod's filesystem.",
        "cwe": "522",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "14_sec3.ts",
        "bsiCode": "APP.4.4",
        "id": "pod-resource-exhaustion-on-node",
        "title": "Pod Resource Exhaustion on Node (Denial of Service)",
        "description": "Individual pods (containers) can overload the node (host system) or the orchestration platform by consuming excessive resources such as CPU or memory.",
        "impact": "If a container consumes all available resources on a node, it can cause the node to become unresponsive. This leads to a Denial of Service (DoS) for all other applications and services hosted on that node.",
        "action": "Enforce Resource Quotas and Limits on Containers",
        "mitigation": "Define and enforce resource requests and limits for both CPU and memory on all container specifications.",
        "check": "Review container definitions to ensure that `resources.requests` and `resources.limits` are specified for CPU and memory.",
        "asvs": "V13.2.3: Verify that resource utilization limits are in place to prevent denial of service attacks, such as CPU, memory, number of threads, or disk space.",
        "cheatSheet": "https://kubernetes.io/docs/concepts/policy/resource-quotas/",
        "detectionLogic": "This rule iterates through all 'Shared Runtimes' that host containerized assets.",
        "riskAssessment": "The impact is determined by the highest availability requirement of any asset running on the shared runtime. A node hosting mission-critical components will have a very high impact if it goes down.",
        "falsePositives": "A risk might be flagged if resource limits are enforced by a cluster-wide admission controller or policy engine that is not reflected in the Threagile model via tags.",
        "cwe": "770",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "14_sec4.ts",
        "bsiCode": "APP.4.4",
        "id": "unauthorized-deployment-via-cicd-pipeline",
        "title": "Unauthorized Deployment or Host Compromise via CI/CD Pipeline",
        "description": "The automation inherent in CI/CD pipelines requires granting these tools privileged access to deployment targets such as container clusters. This creates a risk of unauthorized changes. For example, an application version that has not been sufficiently tested or has bypassed the official release process could be deployed. Furthermore, misconfigurations or vulnerabilities in the CI/CD environment itself could allow malware to infiltrate the cluster, leading to data exfiltration, modification, or deletion.",
        "impact": "A compromised CI/CD pipeline can lead to the deployment of malicious or faulty software, potentially causing service disruptions (Availability), data breaches (Confidentiality), or data corruption (Integrity). It bypasses quality assurance and security gates, effectively giving an attacker a trusted path into the production environment.",
        "action": "Secure CI/CD Pipeline and Deployment Process",
        "mitigation": "Implement the principle of least privilege for CI/CD service accounts; they should only have the permissions necessary to deploy and manage applications, not full cluster-admin rights. Enforce protected branches and require multiple approvals for merges into release branches. Integrate security scanning (SAST, DAST, SCA) into the pipeline to detect vulnerabilities before deployment. Regularly audit CI/CD configurations, access permissions, and logs. Use signed commits and signed container images to ensure the integrity of the code and artifacts from development to deployment.",
        "check": "Are CI/CD service account permissions minimized? Are there mandatory review/approval steps for production deployments? Are container images scanned for vulnerabilities and their signatures verified before deployment? Are CI/CD environment access logs monitored for suspicious activity?",
        "asvs": "BSI IT-Grundschutz CON.6.A6 (Control of the software development and release process) and CON.6.A21 (Secure provision of development environments)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Software_development_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered by communication links from development-relevant assets (such as Build Pipeline, Source Code Repository, Artifact Registry) to runtime environments (such as Container Platform, Application Server, Web Server). The existence of such a deployment path forms the basis of this risk.",
        "riskAssessment": "The likelihood is considered 'Likely' for any automated deployment path. The impact is determined by the sensitivity (CIA ratings) of the target asset and the data it processes or stores. A pipeline deploying to a critical production system has a much higher impact than one deploying to a staging environment.",
        "falsePositives": "The model may not capture fine-grained permissions or compensating controls (such as mandatory manual approvals, image signing, etc.) that mitigate this risk. The risk should be verified by examining the actual CI/CD pipeline configuration and RBAC policies on the target cluster.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "14_sec5.ts",
        "bsiCode": "APP.4.4",
        "id": "unrestricted-container-communication",
        "title": "Unrestricted Container Communication (BSI CON.1.A21)",
        "description": "All pods in a cluster are generally able to communicate with each other, with the nodes in their own cluster, and with any other IT systems.",
        "impact": "If communication between containerized assets is not restricted, a single compromised container can be used for lateral movement to attack other containers, the underlying host nodes, or even the cluster's control plane. This can lead to a full cluster takeover, data breaches of all applications running on the cluster, and widespread denial-of-service.",
        "action": "Implement Network Segmentation for Containers",
        "mitigation": "Enforce fine-grained network segmentation between containerized assets using technologies like Kubernetes Network Policies, Istio Authorization Policies, or other service mesh/CNI features.",
        "check": "Are all container assets located within a trust boundary of type 'network-policy-namespace-isolation'? Are 'default-deny' network policies in place for all container environments? Is inter-container communication restricted to only what is functionally necessary?",
        "asvs": "BSI IT-Grundschutz CON.1.A21 (Restricting network access for containers)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/con/CON_1_General_container_usage_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies technical assets of machine type 'container' that are not located inside a 'network-policy-namespace-isolation' trust boundary.",
        "riskAssessment": "The likelihood of exploitation is considered 'Likely' in an environment without network segmentation, as a single container vulnerability can be leveraged for lateral movement.",
        "falsePositives": "This risk can be a false positive if network segmentation is achieved by means not represented in the model, such as a service mesh with strict mTLS authorization policies that is not modeled with dedicated trust boundaries, or strict host-based firewalling on the nodes.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "APP.4.6": [
      {
        "file": "15_sec1.ts",
        "bsiCode": "APP.4.6",
        "id": "missing-sap-authorization-check",
        "title": "Missing SAP Authorization Check in Custom Code",
        "description": "In SAP systems, authorizations are checked only if developers implement an explicit authorization check (e.g., `AUTHORITY-CHECK` in ABAP) in the program code. Without such a check, the system does not verify whether a user is truly authorized to perform an action. In custom-developed code, these essential security checks are frequently forgotten.",
        "impact": "This failure bypasses the entire SAP authorization concept, allowing unauthorized users to access, modify, or delete data stored in the SAP system. This can lead to severe compliance violations, data breaches, and significant negative findings during financial or security audits.",
        "action": "Enforce Authorization Checks in Custom Code",
        "mitigation": "Ensure that all custom-developed SAP programs and functions that handle sensitive data or perform critical actions include explicit authorization checks. Use static application security testing (SAST) tools configured for ABAP to find missing checks. Conduct regular code reviews focusing on access control. Mandate developer training on secure SAP development practices, including the correct use of the authorization concept.",
        "check": "Are there processes (like mandatory SAST scans or peer reviews) in place to verify that custom SAP code includes necessary authorization checks before deployment? Are developers adequately trained on SAP secure coding standards?",
        "asvs": "V4.1.1: Verify that the application enforces access control rules on each request from a trusted source, except for public resources.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any technical asset that is marked as a custom-developed part (`custom_developed_parts: true`) and is identified with a technology 'ERP', which is commonly used for SAP systems. The risk's severity increases based on the sensitivity of the data the component processes or stores.",
        "riskAssessment": "The likelihood is considered high for any custom SAP component, as this is a very common and well-known development error. The impact is directly proportional to the confidentiality and integrity of the data assets handled by the component. A missing check on a component processing financial data ('strictly-confidential', 'mission-critical') will result in a critical risk.",
        "falsePositives": "The risk might be a false positive if the custom component does not perform any sensitive actions or access protected data, or if it is a simple wrapper that delegates all actions to standard, secure SAP transactions that do have proper checks. Manual verification of the code's function is required to confirm the risk.",
        "cwe": "862",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "15_sec2.ts",
        "bsiCode": "APP.4.6",
        "id": "bypass-sap-security-via-custom-abap",
        "title": "Bypassing SAP Security Mechanisms via Custom ABAP Code",
        "description": "SAP systems often contain institution-critical information protected by various standard security mechanisms.",
        "impact": "Faulty custom ABAP programs can lead to unauthorized manipulation (tampering) of critical data or the exfiltration (information disclosure)",
        "action": "Secure code review and static/dynamic analysis for custom ABAP developments",
        "mitigation": "All custom ABAP code must undergo a mandatory and rigorous security review before deployment into production environments.",
        "check": "Is there a formal, enforced process for reviewing all custom ABAP code for security vulnerabilities before deployment? Are SAST/DAST tools utilized for ABAP analysis? Do developers receive specific ABAP secure coding training?",
        "asvs": "ASVS V4.1.1: Verify that the application enforces access control rules on a trusted service layer, especially if client-side access control is present and could be bypassed.",
        "cheatSheet": "https://pages.sap.com/abap-secure-programming/index.html",
        "detectionLogic": "This risk is raised for any technical asset identified as an ERP system (or tagged with 'sap' or 'erp') where custom-developed parts are present (`customDevelopedParts: true`).",
        "riskAssessment": "The likelihood is considered high if custom ABAP code is present, as the potential for human error or lack of security awareness during development is significant.",
        "falsePositives": "This risk can be considered a false positive if the `customDevelopedParts` flag is set, but the custom code is verifiably non-security-relevant, minimal, or has already undergone a thorough and documented security audit that confirms its robustness against common ABAP vulnerabilities.",
        "cwe": "288",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "15_sec3.ts",
        "bsiCode": "APP.4.6",
        "id": "injection-vulnerability-in-custom-code",
        "title": "Injection Vulnerability in Custom-Developed Code (BSI-based)",
        "description": "Injection vulnerabilities arise when attackers can inject control characters or commands into an application, often through data input fields.",
        "impact": "A successful injection attack can lead to complete system compromise, unauthorized data access (confidentiality), data modification (integrity), or denial of service (availability).",
        "action": "Implement Robust Input Validation and Use Safe APIs",
        "mitigation": "Treat all input from external sources as untrusted. Implement strong, allow-list-based input validation for all data.",
        "check": "Are all external inputs validated against a strict schema or allow-list? Is parameterized query API used for all database interactions?",
        "asvs": "V5 Input Validation and Encoding",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for all in-scope, custom-developed technical assets that accept potentially complex data formats (like JSON, XML, files).",
        "riskAssessment": "The likelihood of this vulnerability is significant in custom code. It increases if the asset is a web application or service communicating with a database.",
        "falsePositives": "This risk might be a false positive if the application is built with a modern, secure framework that provides strong, default protection against injection flaws (e.g., ORMs with non-concatenated queries, templating engines with auto-escaping), and this architectural choice is n@SystemType:OT captured in the model.",
        "cwe": "89",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "15_sec4.ts",
        "bsiCode": "APP.4.6",
        "id": "bypass-of-sap-security-in-custom-code",
        "title": "Bypass of Standard SAP Security in Custom ABAP Code (BSI APP.4.6)",
        "description": "Standard SAP systems (and other ERPs) provide various data protection mechanisms such as client separation, identity and access management (IAM), and roles/permissions.",
        "impact": "Bypassing these controls can lead to severe security incidents, including unauthorized access across business clients (in multi-tenant environments), elevation of privileges, data tampering, and information disclosure.",
        "action": "Secure Code Review and Static Analysis for Custom ABAP Code",
        "mitigation": "Enforce mandatory, security-focused code reviews for all custom developments and modifications.",
        "check": "Are all custom developments subject to a security code review before deployment? Is a SAST tool integrated into the development lifecycle for the ERP?",
        "asvs": "BSI IT-Grundschutz APP.4.6 SAP ABAP-Programmierung, e.g., A1–A4, A6, A9, A10, A12, A20; OWASP Top 10 2021: A01-Broken Access Control",
        "cheatSheet": "https://help.sap.com/doc/abapdocu_750_index_htm/7.50/en-US/abensecure_coding_guidl.htm (SAP ABAP Secure Programming Guide)",
        "detectionLogic": "This risk is automatically detected for any in-scope Technical Asset of technology type 'ERP' that is marked as having 'custom developed parts'.",
        "riskAssessment": "The likelihood is considered high for any custom code on an ERP system, as developer error or oversight in complex authorization landscapes is common.",
        "falsePositives": "Can occur if the custom code is trivial and does not interact with authorization checks or data access logic.",
        "cwe": "284",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "APP.5.2": [
      {
        "file": "16_sec1.ts",
        "bsiCode": "APP.5.2",
        "id": "insufficient-exchange-outlook-regulations",
        "title": "Insufficient Regulations for Exchange and Outlook (BSI APP.5.2)",
        "description": "Overarching regulations and specifications for Exchange and Outlook are necessary to ensure the security of the information they process.",
        "impact": "A lack of clear security regulations for the mail system can lead to misconfigurations that compromise the confidentiality, integrity, or availability of email data.",
        "action": "Define and enforce security policies for the mail system",
        "mitigation": "Establish and enforce comprehensive security policies for the entire lifecycle of the Exchange/Outlook environment. This must include:",
        "check": "Are client-to-server connections for mail services always encrypted and authenticated? Is the connection from the mail server to the identity provider (e.g., Active Directory) encrypted?",
        "asvs": "BSI IT-Grundschutz: APP.5.2 Microsoft Exchange und Outlook",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_1_Exchange_Server_und_Outlook_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified by detecting specific technical misconfigurations that indicate a lack of overarching security policy for the mail system. The rule checks for:",
        "riskAssessment": "The likelihood of exploitation is high if cleartext protocols or missing authentication are used for sensitive access. The impact is directly related to the sensitivity of the data transmitted over the insecure channel and the criticality of the mail server itself. For example, unencrypted access to a mail server handling 'Strictly Confidential' data constitutes a very high impact.",
        "falsePositives": "The rule might flag connections within a highly secured, physically isolated network segment where encryption is deemed unnecessary by policy. However, this is generally not a recommended practice. Such cases should be reviewed, justified, and formally accepted.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "16_sec2.ts",
        "bsiCode": "APP.5.2",
        "id": "faulty-exchange-migration",
        "title": "Faulty Exchange Server Migration (BSI-Style)",
        "description": "Exchange systems are frequently migrated rather than newly installed. Migrating to a new version often requires underlying operating system upgrades, which in turn can impact the existing domain concept and directory services.",
        "impact": "A faulty migration can severely impact business productivity by disrupting mail services. Failures in configuration, authentication, or encryption can lead to data integrity issues, unauthorized access, and information disclosure, compromising the Confidentiality, Integrity, and Availability of all communication handled by the server.",
        "action": "Implement a Secure and Tested Migration Process",
        "mitigation": "Develop a comprehensive migration plan that includes all dependencies (OS, directory services).",
        "check": "Is there a documented migration plan that includes testing and rollback procedures?",
        "asvs": "BSI IT-Grundschutz: OPS.1.1.5 Change Management, SYS.3.2.1 Mail server",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Mail_server_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies any technical asset with 'MailServer' technology, as migrations are a common and high-risk operational activity for such systems.",
        "riskAssessment": "The likelihood is considered 'Likely' due to the complexity and frequency of such migrations. The impact is directly related to the availability and integrity rating of the mail server asset.",
        "falsePositives": "This risk may be a false positive if a very mature and robust, but un-modeled, change management and migration process is in place.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "16_sec3.ts",
        "bsiCode": "APP.5.2",
        "id": "insecure-mail-server-web-access-bsi-app-3-2",
        "title": "Insecure Web Access to Mail Server (BSI APP.3.2)",
        "description": "When users can access their email accounts via a browser, components like Internet Information Services (IIS) are often used. If this function is improperly planned and incorrectly configured, it can potentially lead to uncontrolled access to the internal network from the outside, creating a significant security risk.",
        "impact": "If e-mails are accessed via the Internet with a browser, this harbors great potential for danger. Without direct access to the institution's network, attackers could access the e-mails and thus, among other things, spy on e-mail addresses and content, misuse e-mail functions to send spam, and gain access to sensitive internal information.",
        "action": "Secure Configuration and Hardening of Web-Facing Mail Components",
        "mitigation": "Harden the web server (e.g., IIS) and the mail server's web application (e.g., OWA) according to security best practices. Disable unnecessary features and apply security patches promptly. Place web-facing components in a properly configured Demilitarized Zone (DMZ) to segment them from the internal network. Enforce strong authentication (ideally multi-factor) and ensure all communication is encrypted using up-to-date TLS (HTTPS). Consider using a Web Application Firewall (WAF) as an additional layer of protection.",
        "check": "Is the web server providing mail access properly hardened and patched? Is it located in a DMZ? Is access protected by strong authentication and encrypted via HTTPS? Is a WAF in use?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.3.2 Exchange Server und Outlook Web Access. Relevant OWASP ASVS chapters include V4 (Configuration) and V14 (Access Control).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2022/APP_Anwendungen.pdf?__blob=publicationFile&v=5#page=110",
        "detectionLogic": "This risk is triggered when a technical asset identified as a 'Mail Server', or an asset directly connected to it (like a 'Web Server' or 'Reverse Proxy'), receives traffic from the internet over a web protocol (HTTP/HTTPS). The logic checks for a direct or one-hop connection path from an internet-facing asset to a mail server.",
        "riskAssessment": "The likelihood is high if an unencrypted connection is used or if the exposed asset is n@SystemType:OT within a well-secured trust boundary (like a DMZ). The impact is determined by the confidentiality and integrity requirements of the data handled by the mail server, which is typically high to very high due to the sensitive nature of email communications.",
        "falsePositives": "This risk may be a false positive if compensating controls like a Web Application Firewall (WAF), strict network segmentation (DMZ), and mandatory multi-factor authentication are in place but are n@SystemType:OT fully represented in the threat model.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "16_sec4.ts",
        "bsiCode": "APP.5.2",
        "id": "improper-foreign-system-connection-to-exchange",
        "title": "Improper Connection of Third-Party Systems to Exchange Server",
        "description": "Microsoft Exchange systems are tightly integrated with the Windows operating system and often use connectors to interoperate with third-party systems. These connectors allow other email systems to send or retrieve emails using standard protocols like SMTP, POP3, or IMAP. However, several risks arise from these integrations.",
        "impact": "If third-party systems are connected insecurely to an Exchange server, it can lead to the loss of confidentiality and integrity of emails and other sensitive data. Attackers might intercept, read, or modify emails transmitted over unencrypted connections. Lack of proper authentication can allow unauthorized systems to connect. This can also result in a denial-of-service, blocking the mail system and disrupting critical business communication. Overall, it can cause data breaches, financial loss, and reputational damage.",
        "action": "Securely Configure and Manage Third-Party System Connectors",
        "mitigation": "Ensure that all connectors to third-party systems are documented, actively managed, and verified for compatibility with the current Exchange version, especially after migrations. Enforce strong security settings on all connections to external systems, including mandatory use of encrypted protocols (e.g., SMTPS, POP3S, IMAPS with STARTTLS) and robust authentication mechanisms. Avoid using unencrypted protocols or anonymous access. Administration of connected systems should be consistent and follow the same security baseline. Regularly audit these connections for compliance with security policies.",
        "check": "Are all connections to third-party systems from the Exchange server documented? Is the use of encrypted protocols and strong authentication enforced for all external mail connections? Has compatibility of all connectors been verified? Are there regular audits of these external connection security settings?",
        "asvs": "BSI IT-Grundschutz APP.4.2.A11 Connection of third-party systems to the Exchange Server",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_2_Exchange_Server_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks for technical assets identified as Microsoft Exchange servers (via technology type 'mail-server' and the 'product:exchange' tag). It then inspects all incoming communication links from assets *n@SystemType:OT* tagged as being from the same vendor ('vendor:microsoft'). A risk is raised if these connections use standard mail protocols (SMTP, POP3, IMAP) without encryption or without authentication.",
        "riskAssessment": "The likelihood of exploitation is high if unencrypted protocols are used, as this allows for trivial eavesdropping or modification attacks. The impact is directly related to the sensitivity (CIA ratings) of the Exchange server and the data assets (emails) it handles. A mission-critical Exchange server handling strictly confidential data will result in a very high impact.",
        "falsePositives": "This risk might be a false positive if the connected 'third-party' system is located within the same trusted security zone and managed under identical security policies, even without being a Microsoft product. Compensating controls, such as a mandatory VPN for all connections, could also mitigate the risk, though protocol-level encryption is still recommended.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "16_sec5.ts",
        "bsiCode": "APP.5.2",
        "id": "excessive-permissions-on-mail-server",
        "title": "Excessive Permissions on Mail Server (based on BSI APP.5.2)",
        "description": "If access rights for an email client or to data stored on an email server (e.g., Exchange) are created or administered improperly, significant security vulnerabilities can arise. This is especially true when permissions exceed the necessary scope (violating the principle of least privilege), potentially allowing unauthorized individuals to access, modify, or delete sensitive information.",
        "impact": "The primary impact is the unauthorized disclosure of confidential information (loss of Confidentiality). It can also lead to data tampering (loss of Integrity) or unauthorized deletion of emails/mailboxes (loss of Availability). This can result in data breaches, non-compliance with data protection regulations (like @DataType:PII), and reputational damage.",
        "action": "Enforce Principle of Least Privilege for Mailbox and Data Access",
        "mitigation": "Implement a strict, role-based access control (RBAC) model for all mail-related data. Access permissions must be granted based on the 'need-to-know' principle. Use end-user identity propagation for authentication and authorization wherever possible, instead of shared technical user accounts. Conduct regular access rights reviews and audits for all mailboxes, especially for those with delegated access. Ensure a formal process exists for requesting, approving, and revoking access rights.",
        "check": "Is there a documented RBAC model for the mail server? Are permissions regularly reviewed? Is access granted based on documented and approved requests? Is end-user identity used for authorization checks instead of generic service accounts?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.5.2 'Microsoft Exchange und Outlook', specifically requirement APP.5.2.A3 'Berechtigungsmanagement und Zugriffsrechte'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_5_2_Microsoft_Exchange_und_Outlook_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified when a technical asset of type 'Mail Server' receives communication that does not enforce fine-grained, user-specific authorization. The rule checks for incoming communication links to 'mail-server' assets. A risk is raised if the authorization method on the link is not 'End-User Identity Propagation', as this implies coarser, less secure access control mechanisms are in place, increasing the likelihood of excessive permissions being exploitable.",
        "riskAssessment": "The impact is determined by the confidentiality and integrity of the data assets being sent to or from the mail server. If highly sensitive data is involved, the impact is high. The likelihood is considered 'likely' if authorization is based on a 'technical-user' and 'very likely' if there is no authorization ('none') specified on the communication link.",
        "falsePositives": "This risk may be a false positive if a compensating access control mechanism exists outside of the modeled system, such as a sophisticated permissions system within the mail server application itself that is not represented by the 'authorization' property in the model. However, the lack of end-user identity propagation on the communication link itself remains a potential weakness.",
        "cwe": "272",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "16_sec6.ts",
        "bsiCode": "APP.5.2",
        "id": "faulty-exchange-migration",
        "title": "Faulty Exchange Migration",
        "description": "Exchange systems are often migrated rather than newly installed. Upgrading to a new version may require an operating system upgrade, which can affect the existing domain design and directory services.",
        "impact": "A faulty migration can significantly reduce productivity by disrupting mail services. Misconfigurations in authentication, encryption, or general settings can lead to integrity issues, unauthorized access, and information disclosure, compromising the confidentiality, integrity, and availability of communications handled by the server.",
        "action": "Implement a secure, tested migration process",
        "mitigation": "Develop a comprehensive migration plan that accounts for all dependencies (operating system, directory services).",
        "check": "Is there a documented migration plan that includes testing and rollback procedures?",
        "asvs": "BSI IT-Grundschutz: OPS.1.1.5 Change Management, SYS.3.2.1 Mail server",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Mail_server_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule flags any technical asset with the 'MailServer' technology, as migrations are a common, high-risk operational activity for such systems.",
        "riskAssessment": "The likelihood is set to 'Likely' due to the complexity and frequency of such migrations. The impact depends on the availability and integrity classification of the mail server.",
        "falsePositives": "This risk can be a false positive if a mature and robust, but unmodeled, change-management and migration process exists.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "16_sec7.ts",
        "bsiCode": "APP.5.2",
        "id": "incorrect-email-client-configuration",
        "title": "Incorrect Email Client Configuration (aligned with BSI APP.5.2)",
        "description": "The email client (e.g., Outlook) is a critical part of an Exchange-based email system. For the security of the entire system, clients must be configured correctly. Choosing an inappropriate communication protocol can introduce serious security weaknesses. Misconfiguration can cause issues such as a loss of confidentiality through unauthorized access and can render network-level encryption (e.g., TLS) ineffective.",
        "impact": "If an email client uses unencrypted protocols to communicate with the mail server, all transmitted data, including credentials and email content, can be intercepted and read by an attacker on the network. This leads to a direct loss of confidentiality and can enable further attacks like account takeover and impersonation.",
        "action": "Enforce Secure Outlook/Email Client Configuration Standards",
        "mitigation": "Define and enforce secure configuration baselines for all Outlook/email clients. This must include the mandatory use of encrypted communication protocols (e.g., IMAPS, SMTP with STARTTLS, POP3S) for all connections to the Exchange/mail server. Use configuration management tools (e.g., GPO, MDM/Intune) to deploy and lock down these settings. Block unencrypted email protocols at the network or mail server level where possible. If client-side encryption (e.g., S/MIME) is used, ensure the secure storage and handling of private keys on the client device.",
        "check": "Are client configurations managed centrally? Is the use of unencrypted email protocols blocked or monitored? Are all communication links from clients to Exchange/mail servers configured to use encryption (TLS)?",
        "asvs": "BSI IT-Grundschutz APP.5.2 Microsoft Exchange and Outlook",
        "cheatSheet": "BSI IT-Grundschutz Kompendium – APP.5.2 Microsoft Exchange und Outlook",
        "detectionLogic": "This rule checks for technical assets identified as clients (e.g., desktop, mobile app) that communicate with a mail server. It triggers a risk if the communication link between them uses an unencrypted email protocol (SMTP, IMAP, POP3) instead of its secure, TLS-wrapped variant.",
        "riskAssessment": "The likelihood of exploitation is very high when unencrypted protocols are used, as sniffing network traffic is a standard attack vector. The impact depends directly on the sensitivity of the data transmitted via email. If data assets with 'Confidential' or 'Strictly Confidential' ratings are sent or received over such a link, the impact is considered 'High' or 'Very High', leading to a severe overall risk.",
        "falsePositives": "This risk is unlikely to be a false positive if the conditions are met. A potential exception could be a scenario where the connection is entirely contained within a physically secure, trusted network segment where sniffing is not a credible threat, or if another compensating control like a mandatory, system-wide VPN is strictly enforced for all client connections (which should be modeled with the 'vpn: true' property on the communication link).",
        "cwe": "319",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "16_sec8.ts",
        "bsiCode": "APP.5.2",
        "id": "abuse-of-api-and-macros",
        "title": "Abuse of APIs and Macros in Outlook (BSI-based)",
        "description": "Many software products, including Outlook, provide Application Programming Interfaces (APIs) and macro capabilities to extend functionality or integrate with other programs.",
        "impact": "Successful exploitation can lead to the unauthorized disclosure (Confidentiality), modification (Integrity), or deletion (Availability) of data.",
        "action": "Harden and Restrict API and Macro Execution",
        "mitigation": "Disable APIs and macro execution by default where not required for business-critical functions.",
        "check": "Are macro and scripting capabilities disabled by default on end-user systems?",
        "asvs": "BSI module: APP.5.2 Microsoft Exchange und Outlook",
        "cheatSheet": "https://owasp.org/www-community/attacks/Code_Injection",
        "detectionLogic": "This risk is generated for technical assets that support powerful, potentially abusable scripting or macro functionalities, especially those with custom-developed parts or handling sensitive data.",
        "riskAssessment": "The likelihood of exploitation is higher for general-purpose client systems (desktops, browsers) and applications with custom-coded extensions.",
        "falsePositives": "The risk may be a false positive if the asset has strong, model-invisible compensating controls, such as a mandatory, enforced code-signing policy for all scripts and a robust EDR solution that are not documented in the threat model.",
        "cwe": "358",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      }
    ],
    "APP.5.4": [
      {
        "file": "18_sec1.ts",
        "bsiCode": "APP.5.4",
        "id": "limited-availability-of-ucc-services",
        "title": "Limited Availability of UCC Services (BSI UCC.2.1)",
        "description": "UCC services often have high availability requirements, yet their functionality depends on other IT systems and applications. If underlying components such as data networks, internet connections, or authentication services fail or are not fully functional, the availability of the UCC services can be severely impaired. This can lead to cascading failures, especially if the UCC platform is required to coordinate recovery of the failed network.",
        "impact": "Compromised availability of UCC services disrupts communication and business processes. This can manifest as poor quality (latency, artifacts), dropped connections, or complete service outages, hindering task completion and potentially violating service-level agreements.",
        "action": "Ensure Redundancy and Resilience of Critical Dependencies",
        "mitigation": "Identify all critical dependencies for UCC services (e.g., networks, authentication services, cloud infrastructure). Ensure these dependencies are engineered for high availability with redundancy and failover mechanisms. Develop and test recovery plans that account for these dependencies. For cloud-based services, review the provider's SLA and resilience measures.",
        "check": "Are critical dependencies for UCC services identified and documented? Are they designed for high availability? Is the UCC service itself redundant? Is there a tested recovery plan?",
        "asvs": "BSI IT-Grundschutz: APP.1.A26 (Failure and Emergency Management), NET.1.1.A4 (Redundant Design of Active Network Components)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_1_General_applications_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Identifies UCC services with high availability requirements that rely on non-redundant technical assets. The risk is raised against the UCC service itself and highlights the fragile dependency.",
        "riskAssessment": "The impact is derived from the availability requirement of the UCC service and the data it handles. A 'Mission-Critical' service becoming unavailable has a very high impact. The likelihood is assessed as high if a critical dependency is identified as a single point of failure (i.e., not modeled as redundant).",
        "falsePositives": "The model may not capture all redundancy measures, especially those implemented at the infrastructure or cloud provider level that are not explicitly modeled as a redundant technical asset.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "18_sec2.ts",
        "bsiCode": "APP.5.4",
        "id": "inadequate-planning-of-ucc",
        "title": "Inadequate UCC Planning (BSI APP.5.4, Section 2.2)",
        "description": "If UCC solutions are not planned according to their actual use, this can negatively impact functionality. This includes underprovisioning network capacity for required services (e.g., video) or using client hardware with insufficient performance (e.g., thin clients) for resource-intensive UCC applications.",
        "impact": "Inadequate planning can lead to poor service quality—such as audio/video delay and artifacts—or render services unusable. This directly affects the availability of the communication services.",
        "action": "Conduct capacity and performance planning for UCC infrastructure and clients",
        "mitigation": "Analyze and forecast usage patterns to provision adequate network bandwidth. Define and enforce minimum hardware specifications for client devices. Perform load and performance testing before rollout, especially when using thin clients or VDI solutions for UCC.",
        "check": "Was capacity planning performed for the UCC network traffic? Are client hardware specifications sufficient for the intended services? Has performance been tested under realistic load conditions?",
        "asvs": "BSI IT-Grundschutz: APP.5.4.A1 (Planning of UCC), APP.5.4.A2 (Network planning), APP.5.4.A3 (Initial and regular testing)",
        "cheatSheet": "See BSI IT-Grundschutz: APP.5.4 Unified Communications and Collaboration (UCC).",
        "detectionLogic": "Detects risk in two scenarios: 1) Thin clients or other low-power clients connecting to UCC services may struggle with processing demands. 2) A large number of users connect to a non-redundant, small-scale UCC service, indicating potential server-side capacity issues.",
        "riskAssessment": "Impact is derived from the availability rating of the UCC service. Likelihood is high if underpowered clients are used, or if a non-redundant service supports a large number of users.",
        "falsePositives": "The model's concept of a 'thin client' via a tag is an abstraction. A well-designed VDI environment might offload processing effectively, mitigating the risk, which wouldn't be visible from the tag alone.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "18_sec3.ts",
        "bsiCode": "APP.5.4",
        "id": "incorrect-configuration-of-ucc",
        "title": "Misconfiguration of UCC (BSI APP.5.4, 2.3)",
        "description": "The complexity of UCC services provides numerous configuration options, increasing the risk of misconfiguration. This can occur at the user level (e.g., incorrect audio device selection), the administrative level (e.g., routing errors), or due to a weak identity and access management (IAM) model (e.g., granting external participants excessive permissions).",
        "impact": "Misconfigurations can lead to denial of service (users being inaudible or invisible), information disclosure (auto-accepting calls on a room system, data leakage to guests), or data tampering.",
        "action": "Implement secure configuration management and robust IAM",
        "mitigation": "Provide secure default configurations and limit risky user-configurable options. Enforce a strong Identity and Access Management (IAM) model, especially for guest and external access, based on the principle of least privilege. Audit administrative changes to critical settings.",
        "check": "Are secure configuration baselines used? Is there a robust IAM policy for the UCC service? Are permissions for external users appropriately restricted?",
        "asvs": "BSI IT-Grundschutz: OPS.1.1.4 (Secure system configuration), ORP.4 (Identity and access management)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Detects UCC services that allow communication from external entities without strong authorization, which is a key risk highlighted in the BSI text regarding misconfigured permissions for external participants.",
        "riskAssessment": "Impact is high if the UCC service handles confidential data. Likelihood is high if external communication is permitted without a strong authorization mechanism such as identity propagation or token-based authentication.",
        "falsePositives": "The model might not reflect compensating controls, such as network-level isolation or specific application-level guest policies that are not captured in the authorization model.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "18_sec4.ts",
        "bsiCode": "APP.5.4",
        "id": "misuse-of-ucc-admin-privileges",
        "title": "Misuse of UCC Administrative Privileges (BSI APP.5.4, Section 2.4)",
        "description": "Administrators of UCC services can make far-reaching changes to the system. If these privileges are used improperly—whether accidentally or maliciously—the consequences can be significant. Examples include changing permissions to expose private data, altering routing to cause denial of service, or tampering with system data.",
        "impact": "Misuse of administrative privileges can lead to severe information disclosure, data tampering, and denial of service, compromising the entire UCC environment.",
        "action": "Enforce least privilege and auditing for administrators",
        "mitigation": "Implement Role-Based Access Control (RBAC) for administrators to enforce least privilege. Use dual control (four-eyes principle) for critical configuration changes. Log all administrative actions and review logs regularly for suspicious activity.",
        "check": "Are administrative privileges based on the principle of least privilege? Are administrative actions logged and regularly reviewed? Are critical changes subject to an approval process (e.g., the four-eyes principle)?",
        "asvs": "BSI IT-Grundschutz: ORP.4.A6 (Management of privileged accounts), ORP.4.A20 (Logging and monitoring of access)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Flags any UCC service with administrative access, which inherently carries a risk of privilege misuse. Detection is based on a DevOps-style communication link or when the asset is explicitly tagged with an administrator role.",
        "riskAssessment": "The impact of this risk is directly proportional to the highest sensitivity of the data handled by the UCC service, as a malicious admin could compromise all of it. The likelihood is considered 'likely' as a baseline for any system with administrative access, assuming no specific compensating controls are modeled.",
        "falsePositives": "This is a fundamental risk for any administered system. An organization may have strong out-of-band controls (such as rigorous staff vetting and auditing) that are not visible in the threat model.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "18_sec6.ts",
        "bsiCode": "APP.5.4",
        "id": "accidental-disclosure-of-personal-information-in-ucc",
        "title": "Disclosure of Personal Data in UCC (BSI APP.5.4 Section 2.6)",
        "description": "UCC services collect and display various user data—such as availability status, timestamps, and profile details—which may enable unintended monitoring. In addition, video calls during remote work can inadvertently expose private information from a user’s home environment (e.g., background objects, other people, or sounds).",
        "impact": "Unintentional disclosure of personal data can lead to privacy violations (e.g., GDPR non-compliance), employee dissatisfaction, and the creation of detailed, sensitive user profiles without consent.",
        "action": "Implement Privacy-Enhancing Features and Policies",
        "mitigation": "Provide users with granular controls over presence and profile information. Offer and encourage privacy features such as virtual backgrounds. Define data-retention policies for metadata and logs. Perform a Data Protection Impact Assessment (DPIA) and be transparent about which data is collected and displayed to others.",
        "check": "Does the UCC solution provide privacy controls (e.g., presence, background blur)? Are users aware of them? Is there a DPIA and a clear privacy policy for the service?",
        "asvs": "BSI IT-Grundschutz: CON.6 (Data Protection)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Data_protection_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Identifies UCC services that handle data assets tagged as containing personally identifiable information (@DataType:PII). This risk is inherent to such services due to the nature of metadata and video communication.",
        "riskAssessment": "Impact depends on the sensitivity and volume of PII processed. Likelihood is very high for modern UCC systems, as metadata collection and video are standard features.",
        "falsePositives": "The organization may have strong data-protection policies and user training that effectively mitigate this risk, which may not be visible in the technical model.",
        "cwe": "359",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "18_sec7.ts",
        "bsiCode": "APP.5.4",
        "id": "negative-interactions-between-ucc-services",
        "title": "Negative Interactions Between UCC Services (BSI APP.5.4, Section 2.7)",
        "description": "UCC services can interfere with each other. This can occur on the server side, where services are integrated into a single user interface, creating a single point of failure. It can also occur on the client side, where multiple UCC applications compete for exclusive resources such as headsets or consume excessive CPU and memory, making the system unstable or causing crashes.",
        "impact": "Negative interactions between services or applications can lead to partial or complete loss of service, reducing user productivity and disrupting business operations.",
        "action": "Manage service dependencies and client-side resource consumption",
        "mitigation": "On the server side, decouple services where possible or ensure the integrating platform is highly available. On the client side, test for resource conflicts on standard client hardware builds, establish policies for running multiple UCC applications simultaneously, and provide user guidance.",
        "check": "Are service dependencies identified and managed for availability? Are client-side resource conflicts tested and documented?",
        "asvs": "BSI IT-Grundschutz: SYS.1.1.A4 (Planning of server resources)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_General_Server_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Identifies client assets that connect to multiple distinct UCC services, indicating a risk of client-side resource contention between different UCC applications.",
        "riskAssessment": "Impact is medium because it typically affects a single user's client, but it can be higher for critical roles. Likelihood is high when a client is expected to run multiple UCC applications from different vendors.",
        "falsePositives": "A user may have multiple UCC applications installed but only run one at a time, or the client machine may have sufficient resources to handle them concurrently.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "18_sec8.ts",
        "bsiCode": "APP.5.4",
        "id": "uncontrolled-access-via-remote-control-feature",
        "title": "Uncontrolled Access via Remote-Control Feature (BSI APP.5.4, section 2.8)",
        "description": "UCC platforms often include a feature that allows a participant to take remote control of another user's desktop. Because this feature is used infrequently, many users are unfamiliar with it. They may accidentally accept a control request and not know how to revoke it, thereby losing control of their client device to another participant in the conversation.",
        "impact": "An attacker gaining remote control of a user's device constitutes a full compromise of that client, leading to elevation of privilege, information disclosure, and tampering with any data or systems accessible to that user.",
        "action": "Restrict or disable remote-control features and train users",
        "mitigation": "If the remote-control feature is not required for business purposes, disable it by default. If it is required, ensure the user interface for granting and revoking control is extremely clear and provides persistent, visible feedback. Train all users on the risks of this feature and how to use it safely.",
        "check": "Is the remote-control feature enabled in the UCC client? Is it necessary? Are users trained in its safe operation?",
        "asvs": "BSI IT-Grundschutz: CON.3 – Security awareness and training",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Security_awareness_and_training_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to any UCC client that offers a remote-control capability. The risk is raised against the client asset itself, as it is the component that would be compromised.",
        "riskAssessment": "The impact can be very high because it can lead to a full compromise of the client device. The likelihood is considered 'likely' because the feature is common and user unfamiliarity is a frequent issue.",
        "falsePositives": "The specific UCC product in use may not have this feature, or it may be disabled by a global policy not reflected in the model.",
        "cwe": "284",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "18_sec9.ts",
        "bsiCode": "APP.5.4",
        "id": "identity-spoofing-in-ucc",
        "title": "Identity Spoofing in UCC (BSI APP.5.4, 2.9)",
        "description": "Attackers can exploit UCC platforms for social engineering by impersonating trusted parties. Users may perceive UCC as a trusted internal platform and therefore be less suspicious of malicious links or requests. The risk increases when external users can contact internal users without strong authentication, and when attackers can manipulate display names, voice, or video.",
        "impact": "Identity spoofing can lead to significant information disclosure, credential theft, and financial fraud.",
        "action": "Strengthen authentication and implement anti-spoofing measures",
        "mitigation": "Require strong authentication for all users, especially those joining from external networks. Implement clear visual indicators in the UI to distinguish external participants from internal colleagues. Prevent users from setting display names that could be used for impersonation. Train users to stay vigilant against social engineering attacks over UCC channels.",
        "check": "Is strong authentication required for all participants, including external users? Are external users clearly identified in the UI? Are users trained on UCC-based social engineering tactics?",
        "asvs": "OWASP ASVS: Authentication verification requirements. BSI IT-Grundschutz: ORP.4.A4 (Identity and access management)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Detects communication links from an external entity to a UCC service. The risk is significantly higher if the communication channel lacks authentication, as this makes spoofing trivial.",
        "riskAssessment": "Impact is high if the UCC service handles sensitive data that could be exfiltrated via a social engineering attack. Likelihood is very high if unauthenticated external users can initiate contact with internal users.",
        "falsePositives": "The platform may have other anti-spoofing controls (e.g., email domain validation for guests) not captured in the authentication property of the communication link.",
        "cwe": "290",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Spoofing"
      }
    ],
    "APP.6": [
      {
        "file": "19_sec1.ts",
        "bsiCode": "APP.6",
        "id": "unsuitable-software-selection",
        "title": "Unsuitable Software Selection (based on BSI APP.6, Section 2.1)",
        "description": "Many different software solutions are available for various applications and purposes. If unsuitable software is selected that does not meet the organization's requirements, operations can be significantly disrupted. For example, data formats might be incompatible with existing programs, or new products may have insufficient functionality. This can lead to performance degradation, disruptions, or errors within business processes.",
        "impact": "Particularly if the software fails to meet the organization's security requirements, the data processed by it could be disclosed or tampered with. A common example is when the software's authentication mechanisms are not designed for the intended deployment environment, such as an open data network or the public internet. This can lead to unauthorized access (Elevation of Privilege), data breaches (Information Disclosure), and manipulation of critical information (Tampering).",
        "action": "Formalize Software Evaluation and Procurement",
        "mitigation": "Establish a formal software procurement and evaluation process. Define clear security requirements for all new software, based on the intended use case, deployment environment, and the sensitivity of the data it will handle. Before deployment, verify that the software meets these requirements, especially concerning authentication, access control, data encryption, and logging. For internet-facing systems or services handling sensitive data, ensure strong authentication is enforced on all exposed interfaces.",
        "check": "Is there a formal process for evaluating the security of new software? Are security requirements for authentication and access control verified before deployment? Are all communication links to sensitive components properly authenticated?",
        "asvs": "V4.0.3-2.1.1, V4.0.3-2.1.2, V4.0.3-4.1.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for technical assets that are targets of unauthenticated communication, especially when those links cross trust boundaries or originate from the internet. The rule identifies assets (like web applications, services, or databases) that lack authentication on incoming data flows, which is a sign of software being unsuitable for its deployment context.",
        "riskAssessment": "The impact is determined by the confidentiality and integrity requirements of the data processed or stored by the vulnerable asset. A higher data classification leads to a higher impact. The likelihood is considered higher for assets exposed to the internet compared to those only accessible on an internal network. The overall severity is a combination of this calculated impact and likelihood.",
        "falsePositives": "A risk might be a false positive if other compensating controls that are not modeled exist, such as a web application firewall (WAF) or a reverse proxy that enforces authentication before traffic reaches the target asset.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "19_sec2.ts",
        "bsiCode": "APP.6",
        "id": "misconfiguration-information-disclosure",
        "title": "Information Disclosure via Misconfigured Software (BSI APP.6)",
        "description": "If software is configured insecurely or with unnecessary features enabled, sensitive information can be unintentionally exposed.",
        "impact": "Disclosure of sensitive or personal data (e.g., @DataType:PII) can cause financial loss, regulatory penalties, and reputational damage,",
        "action": "Harden software configurations and disable unnecessary features",
        "mitigation": "Establish hardened baselines per component and vendor guidance; disable unnecessary services, features, and ports; apply least functionality and least privilege;",
        "check": "Are secure baselines defined and reviewed? Are unnecessary features/services disabled by default? Is configuration drift monitored with alerts?",
        "asvs": "BSI IT-Grundschutz APP.6 (esp. 2.2 Offenlegung durch fehlerhafte Konfiguration) and CON.1 A15 (Secure basic configuration); OWASP ASVS V19: Configuration.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_component_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule flags assets that are (1) data stores with confidentiality ≥ Restricted that communicate across a trust boundary, to the Internet, or to an ExternalEntity —",
        "riskAssessment": "Impact scales with the highest confidentiality and integrity of the affected asset. Likelihood increases for custom-developed parts and for assets with outbound links",
        "falsePositives": "Connections to external parties might be intentional and tightly controlled (e.g., encrypted managed replication, well-audited DLP-approved exports).",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "19_sec3.ts",
        "bsiCode": "APP.6",
        "id": "software-from-unreliable-sources",
        "title": "Software from Unreliable Sources (BSI CON.3.A13)",
        "description": "If software is obtained from unreliable sources, it cannot be guaranteed that an unchanged, original version is being used.",
        "impact": "Installing compromised software can impair the integrity and availability of IT systems, leading to system downtime, data corruption, or the execution of malicious functions.",
        "action": "Establish and Enforce Policies for Trusted Software Acquisition and Integrity Verification",
        "mitigation": "Define and enforce strict policies for software acquisition, permitting installations only from vetted, trustworthy sources (e.g., official vendor sites, curated internal artifact repositories).",
        "check": "Is there a defined policy for trusted software sources? Are all software components, including dependencies and libraries, sourced from verified locations? Is there a process to verify the integrity of new software before deployment (e.g., signature checking)? Is a secure software supply chain (e.g., CI/CD pipeline with an artifact registry) used for custom-developed components?",
        "asvs": "Derived from BSI IT-Grundschutz-Kompendium CON.3, Requirement A13 'Obtaining software from trustworthy sources'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Protection_against_malicious_programs_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for custom-developed technical assets that execute code but do not appear to be sourced from a controlled software supply chain.",
        "riskAssessment": "The likelihood is considered 'Likely' if no secure supply chain is modeled, as this indicates a lack of controls over how software and its dependencies are sourced and built.",
        "falsePositives": "The model may not fully represent the software supply chain. An organization might have strong offline processes for vetting and deploying software that are not modeled as explicit data flows. This risk should be confirmed by reviewing the actual software development, dependency management, and deployment processes.",
        "cwe": "829",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "19_sec4.ts",
        "bsiCode": "APP.6",
        "id": "@Maintenance:Unmaintained-dependencies",
        "title": "@Maintenance:Unmaintained Dependencies or Components",
        "description": "Security vulnerabilities and software weaknesses can be discovered throughout the software lifecycle. This can jeopardize the information security of the data processed with the software, for example by allowing login functions to be bypassed or encryption to be broken. Security vulnerabilities and weaknesses cannot be remedied in a timely manner if no suitable maintenance contract has been concluded with the manufacturer or supplier or if the software is simply used beyond the maintenance period. Violations of the license conditions can also lead to (auto-)update mechanisms being deactivated and the software therefore no longer being maintained.",
        "impact": "If @Maintenance:Unmaintained components with known vulnerabilities are used, attackers can exploit them to compromise the confidentiality, integrity, or availability of the entire system or the data processed by it. This can lead to a complete takeover of the component, data breaches, or denial of service.",
        "action": "Patch or Upgrade Vulnerable Component",
        "mitigation": "Establish a process for managing third-party and open-source components, including maintaining a complete inventory (e.g., a Software Bill of Materials (SBOM)). Use Software Composition Analysis (SCA) tools to regularly scan for known vulnerabilities in all dependencies. Ensure that all commercial software has an active maintenance and support contract. Components that are end-of-life (i.e., '@Maintenance:Unmaintained') must be replaced in a timely manner. The CI/CD pipeline should include automated checks to prevent the introduction of new vulnerable dependencies.",
        "check": "Are all third-party components and their versions inventoried? Is there an automated process (SCA) to scan for vulnerable dependencies? Is there a documented procedure for patching or replacing vulnerable or @Maintenance:Unmaintained components?",
        "asvs": "V14.2.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
        "detectionLogic": "This risk is automatically raised for any technical asset explicitly tagged '@Maintenance:Unmaintained'.",
        "riskAssessment": "The likelihood of exploitation is considered very high for any component that is no longer receiving security patches, as new vulnerabilities are constantly being discovered by researchers. If the component is exposed to the internet, the likelihood is considered frequent. The impact of successful exploitation depends directly on the sensitivity (Confidentiality, Integrity, and Availability) of the technical asset itself and the data assets it processes or stores.",
        "falsePositives": "This risk is based on the presence of the '@Maintenance:Unmaintained' tag. A false positive can occur only if this tag is applied to a component that is actually still maintained through a process not documented in the model.",
        "cwe": "1104 // Use of @Maintenance:Unmaintained Third Party Components",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "19_sec5.ts",
        "bsiCode": "APP.6",
        "id": "accidental-data-loss-or-corruption-by-misuse",
        "title": "Accidental Data Loss or Corruption by Software Misuse (BSI APP.6 – 2.5)",
        "description": "Incorrect or careless use of software can lead to unintended deletion, overwriting, or corruption of information.",
        "impact": "Integrity and Availability are primarily affected. Consequences include halted processes, recovery costs, loss of critical records, breach of business objectives, and—in regulated contexts—potential non-compliance.",
        "action": "Introduce safeguards to prevent accidental deletion/corruption and ensure robust recovery.",
        "mitigation": "Apply least-privilege permissions, confirmation dialogs for destructive actions, clear UI copy, and safe defaults. Provide undo/versioning where feasible. Train users on correct handling.",
        "check": "Are destructive actions confirmed and reversible? Are privileges constrained to the minimum needed? Are users trained? Do tested backups exist for stored/processed data?",
        "asvs": "Mapped to BSI APP.6 (section 2.5: Datenverlust durch fehlerhafte Nutzung von Software) and OPS.1.2.2 (Operating Personnel) for backup/restore responsibilities.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_Operating_personnel_edition_2023.pdf?__blob=publicationFile&v=2 (BSI OPS.1.2 reference)",
        "detectionLogic": "Raise when a non-out-of-scope technical asset is likely to be misused by humans AND handles sensitive availability/integrity or involves complex encryption.",
        "riskAssessment": "Likelihood is higher for custom-developed components due to potentially less mature UX and guardrails. Impact scales with the asset’s highest Integrity/Availability ratings:",
        "falsePositives": "May be a false positive if the application has exceptional error-prevention UX, strict read-only defaults, four-eyes (dual-control) on destructive actions,",
        "cwe": "284",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "19_sec6.ts",
        "bsiCode": "APP.6",
        "id": "insufficient-system-resources",
        "title": "Insufficient System Resources for Critical Operations (BSI CON.3.A5)",
        "description": "If IT systems have insufficient resources (e.g., CPU, memory, disk I/O) to execute the required software,",
        "impact": "A lack of system resources directly impacts service availability. This can render services unusable,",
        "action": "Implement Resource Monitoring and Capacity Planning",
        "mitigation": "Implement robust monitoring for key system resources (CPU, memory, disk space, network bandwidth).",
        "check": "Are key system resources being monitored? Is there a capacity plan? Is the asset configured to be redundant or to auto-scale?",
        "asvs": "ASVS V14.1.1: Verify the application or system is able to handle requests and gracefully fail when under a denial of service attack.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
        "detectionLogic": "This rule identifies technical assets that have a high or critical availability requirement but are not modeled as redundant.",
        "riskAssessment": "The impact is derived directly from the availability rating of the technical asset.",
        "falsePositives": "The model may not capture all forms of redundancy. For example, an asset might be part of an external high-availability cluster,",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "19_sec7.ts",
        "bsiCode": "APP.6",
        "id": "poor-usability-leads-to-shadow-it",
        "title": "Poor Usability Leading to Shadow IT",
        "description": "If software fulfills its functional requirements but is awkward or complicated to use, it may not be accepted by users.",
        "impact": "When users create insecure workarounds due to poor usability, it can lead to data exfiltration to uncontrolled environments (e.g., private laptops, public cloud services),",
        "action": "Improve application usability and prohibit unsanctioned workarounds",
        "mitigation": "Involve end-users in the design and testing phases of an application to ensure high usability (UX/UI).",
        "check": "Was formal usability testing conducted with target users? Is there a feedback channel for user experience issues?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (General Client), Requirement CON.1.A23 (Use of private IT equipment).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_client_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for technical assets that are explicitly tagged as having poor usability (`@Usability:Poor`).",
        "riskAssessment": "The impact is determined by the sensitivity of the data processed by the poorly usable application. If users export 'Strictly Confidential' data to an",
        "falsePositives": "A system might be complex but have well-trained users who do not resort to workarounds. This risk is best validated by",
        "cwe": "200",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "APP.1.1": [
      {
        "file": "1_sec1.ts",
        "bsiCode": "APP.1.1",
        "id": "inadequate-office-product-procurement",
        "title": "Inadequate Office Product Procurement & Adaptation",
        "description": "If office products are procured or adapted without a documented requirements baseline, operations may be disrupted: existing templates and documents can become incompatible, integrations with partner systems may fail, and performance or usability can degrade. Tailoring the software to institutional needs is essential to avoid process interruptions and errors.",
        "impact": "Primary impact on Integrity and Availability due to broken processes, incompatible formats, or workflow failures; secondary impact on Confidentiality may occur when documents are mishandled across boundaries.",
        "action": "Introduce and enforce a formal software requirements and procurement process for office products.",
        "mitigation": "Define a repeatable procurement process including requirements elicitation (functional, interoperability, template/format compatibility), non-functional criteria (performance, usability), and integration checks. Pilot on representative workloads and validate against existing macros/templates before rollout.",
        "check": "Is there a documented procurement and adaptation process? Does it verify compatibility with existing assets and partner systems? Are pilot tests and performance/usability checks executed before deployment?",
        "asvs": "Grounded in BSI IT-Grundschutz APP.1.1 Office-Produkte; related to APP.4.4 Allgemeine Anwendungssoftware and modern application lifecycle practices.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_General_applications_Edition_2023.pdf?__blob=publicationFile (BSI APP.4 General Applications)",
        "detectionLogic": "Multi-signal scoring: office context tags, acceptance of document-like formats, communication across trust boundaries (and whether internet-facing), presence of document/‘doc-ish’ protocols, data transfer on links, VDI/terminal-server hints, and macro indicators. OT/ICS assets are hard-excluded. Email-only stacks are explicitly set to ‘Unlikely’ regardless of score. Assets meeting the minimum score threshold are flagged.",
        "riskAssessment": "Likelihood is derived from the evidence score. Impact is mapped from the asset’s highest Availability/Integrity ratings and is increased when StrictlyConfidential data traverses a network trust boundary. Mission-critical processes raise impact to VeryHigh.",
        "falsePositives": "May be reduced (but not eliminated) where a robust procurement/test process exists. Assets tagged ‘procurement-process-followed’ receive a lower score. Confirmation should involve architecture and procurement owners.",
        "cwe": "770",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "1_sec2.ts",
        "bsiCode": "APP.1.1",
        "id": "malicious-content-in-office-documents",
        "title": "Malicious Content in Office Documents",
        "description": "Office documents can contain active content or macros that are useful for automation but can also conceal malicious code.",
        "impact": "Successful exploitation can lead to data tampering, information disclosure, and system compromise. This can disrupt business functions,",
        "action": "Implement content security for document processing",
        "mitigation": "Disable active content (e.g., macros) in Office documents by default, especially for documents from untrusted sources.",
        "check": "Is active content disabled by default for incoming documents? Are all processed files scanned for malware?",
        "asvs": "BSI IT-Grundschutz: CON.3 Malware protection; APP.4.4 Filtering of data and information.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Malware_protection_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "Identifies technical assets that are configured to accept file-based data formats and use technology types that commonly process",
        "riskAssessment": "The likelihood is considered higher for internet-facing assets that directly receive files from external sources.",
        "falsePositives": "This risk might be a false positive if the asset, despite accepting files, has other effective, non-modeled mitigations in place,",
        "cwe": "434",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "1_sec3.ts",
        "bsiCode": "APP.1.1",
        "id": "unauthorized-modification-of-office-documents",
        "title": "Unauthorized Modification of Office Documents (aligned with BSI APP.1.1, Section 2.3)",
        "description": "The integrity of documents (such as Office files, PDFs, etc.) can be compromised through unintentional or intentional content changes.",
        "impact": "If business processes rely on, or decisions are based on, undetected falsified documents, it can lead to incorrect strategic outcomes, process failures, financial loss, and significant reputational damage to the organization.",
        "action": "Implement and Enforce Document Integrity Controls",
        "mitigation": "Use technical mechanisms such as digital signatures to ensure document integrity and authenticity.",
        "check": "Are digital signatures or similar integrity mechanisms used for critical documents? Are file permissions on storage systems appropriately restricted to prevent unauthorized modifications? Is user awareness training conducted on this topic? Is a FIM solution in place?",
        "asvs": "BSI IT-Grundschutz Baustein APP.1.1 Office-Produkte, Abschnitt 2.3 (Integritätsverlust von Office-Dokumenten)",
        "cheatSheet": "BSI IT-Grundschutz Kompendium – APP.1.1 Office-Produkte (Edition 2023)",
        "detectionLogic": "This risk is raised for in-scope technical assets of type Datastore or Process that accept file-based data (`DataFormat.File`) and are responsible for data assets with 'important', 'critical', or 'mission-critical' integrity requirements.",
        "riskAssessment": "The impact of this risk is derived directly from the integrity requirement of the data being handled ('important' -> Medium, 'critical' -> High, 'mission-critical' -> Very High).",
        "falsePositives": "This risk might be a false positive if the handled files are not business-critical (e.g., temporary log files) despite a high integrity rating, or if robust compensating controls exist that are not explicitly modeled (e.g., a separate, secure document management system).",
        "cwe": "353",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "APP.7": [
      {
        "file": "20_sec1.ts",
        "bsiCode": "APP.7",
        "id": "inadequate-contractual-agreements-with-service-providers",
        "title": "Inadequate or Missing Contractual Security Requirements for External Service Providers",
        "description": "If contracts with external service providers (ESPs) lack clear, enforceable information-security clauses, responsibilities, and performance parameters, essential safeguards may be overlooked or under-implemented. This is especially risky when ESPs develop, integrate, or maintain systems that process sensitive data or underpin critical business services.",
        "impact": "Weak or ambiguous supplier contracts can lead to non-compliance with laws and regulations, data protection violations, unclear accountability, and insufficient auditability. Consequences include confidentiality breaches, integrity loss, service outages, financial penalties, and reputational damage.",
        "action": "Define, contract, and verify security requirements for all external providers handling your data or systems.",
        "mitigation": "Ensure every ESP contract specifies: security responsibilities and SLAs; data handling and protection (incl. personal data/PII); secure development and change control; incident reporting/notification timelines; vulnerability management and patch SLAs; right-to-audit and evidence provision; sub-processor controls; data location and sovereignty; exit/transition assistance (e.g., escrow); and compliance with relevant standards and laws.",
        "check": "Before signing, do security/legal review of ESP contracts. Do they include explicit clauses for information security, data protection, incident response, vulnerability/patch SLAs, audit rights, and subcontractor control? Is there a documented supplier risk assessment and continuous monitoring process?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Supplier Relationship Management), specifically requirement CON.1.A4 (Determining information security requirements for supplier relationships).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Supplier_relationship_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
        "detectionLogic": "Auto-detected when a Technical Asset represents an external entity (type = ExternalEntity) or is tagged with @ExternalServiceProvider. Impact is derived from the highest CIA ratings of data the provider processes or stores. If the provider is multi-tenant, the model increases the impact. The rule also highlights the most sensitive referenced data asset to aid review.",
        "riskAssessment": "Likelihood defaults to Likely (governance gaps are common). Impact scales with the sensitivity and criticality of processed/stored data: Restricted/Important ⇒ Medium, Confidential/Critical ⇒ High, StrictlyConfidential/MissionCritical ⇒ VeryHigh. Multi-tenant providers bump impact one level up to a maximum of VeryHigh. Overall severity is CalculateSeverity(Likely, Impact).",
        "falsePositives": "Flagging can occur even if contracts are robust—this is by design to prompt verification. Mark as 'mitigated' or 'accepted' if strong contractual controls (incl. audit evidence) are confirmed.",
        "cwe": "284",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "20_sec2.ts",
        "bsiCode": "APP.7",
        "id": "conceptual-flaws-from-component-reuse",
        "title": "Conceptual Flaws from Component Reuse (BSI APP.2.2)",
        "description": "When applications, programs, and protocols are designed, security-relevant conceptual flaws can arise.",
        "impact": "Reusing components in an unintended security context can bypass fundamental security assumptions, leading to vulnerabilities.",
        "action": "Review and Harden Reused Components for New Deployment Contexts",
        "mitigation": "Ensure that any component reused in a new security context (e.g., exposing an internal service to the internet) undergoes a thorough security review and threat model update.",
        "check": "Is there a formal review process for components when their deployment context changes?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.2 (Webanwendungen). This risk addresses fundamental architectural design flaws.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_2_Web_applications_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is detected by identifying communication links from internet-facing technical assets to assets that are not internet-facing,",
        "riskAssessment": "The impact is determined by the Confidentiality, Integrity, and Availability (CIA) rating of the internal component being exposed.",
        "falsePositives": "A risk might be flagged if a connection is heavily restricted by other means not fully captured in the model (e.g., strict network ACLs, mTLS with short-lived certificates).",
        "cwe": "501",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "20_sec3.ts",
        "bsiCode": "APP.7",
        "id": "undocumented-functions",
        "title": "Undocumented Functions (Backdoors)",
        "description": "Many applications contain undocumented functions built in by the manufacturer, often for development or support purposes. These are usually unknown to users and are not part of the official documentation.",
        "impact": "If these functions allow bypassing essential security mechanisms, such as access control, the confidentiality, integrity, and availability of processed data can be significantly compromised. This can lead to unauthorized access, data manipulation, or service disruption.",
        "action": "Code Review, Component Analysis, and Penetration Testing",
        "mitigation": "Thoroughly review and test all custom-developed or third-party components for undocumented features. This includes static and dynamic code analysis (SAST/DAST) and penetration testing specifically targeting backdoors or hidden administrative interfaces. For third-party software, require vendors to document all features, including those intended for support and maintenance. Implement strong network segmentation and monitoring to limit the impact and increase the chance of detection if such a function is discovered and exploited.",
        "check": "Is there a process for reviewing third-party and custom-developed code for hidden functionality? Has the application undergone penetration testing that includes searching for backdoors? Do vendor contracts require full disclosure of all application features, including diagnostic and support endpoints?",
        "asvs": "V14.2.1: Verify that the application does not contain any backdoors or other intentionally malicious code.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk applies to technical assets that are custom-developed or contain custom-developed parts, as indicated by the `custom_developed_parts` flag. The presence of custom code increases the likelihood that undocumented features, whether intentional or accidental, might exist.",
        "riskAssessment": "The likelihood is higher for complex, custom-developed systems, especially those with a long history or multiple development teams. The impact is directly proportional to the CIA rating of the asset and the data it processes or stores. A backdoor in a system handling 'Strictly Confidential' data is a critical risk.",
        "falsePositives": "The risk might be a false positive if the custom-developed parts have been rigorously vetted and tested, and no such features were found. The `custom_developed_parts` flag is a strong indicator of potential risk but not definitive proof of a backdoor. This risk should be verified through targeted security testing.",
        "cwe": "912",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "20_sec4.ts",
        "bsiCode": "APP.7",
        "id": "weak-or-missing-security-controls",
        "title": "Weak or Missing Security Controls (BSI CON.2)",
        "description": "Security mechanisms or functions within an application are intended to ensure that the confidentiality, integrity, and availability of information are guaranteed to the required extent during processing.",
        "impact": "If critical security controls are weak or absent, they cannot adequately protect information and systems. This can lead to unauthorized access, data manipulation, information disclosure, or denial of service.",
        "action": "Implement Security by Design and Defense-in-Depth",
        "mitigation": "For all custom-developed components, ensure that security is a core requirement throughout the development lifecycle.",
        "check": "Are all communication links carrying sensitive data across trust boundaries encrypted?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.2 (Software development and manufacturing), Requirement CON.2.A5 (Security by Design in software development).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_2_Software_development_and_manufacturing_edition_2023.pdf?__blob=publicationFile (BSI CON.2)",
        "detectionLogic": "This risk is raised for custom-developed technical assets that have incoming communication links with weak or missing security controls.",
        "riskAssessment": "The impact is determined by the highest CIA requirement of the data assets transferred over the insecure communication link or processed by the target asset.",
        "falsePositives": "This risk might be a false positive if there are other compensating controls that are not modeled, such as a Web Application Firewall (WAF) or an API Gateway that terminates TLS and handles authentication centrally.",
        "cwe": "693",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "20_sec5.ts",
        "bsiCode": "APP.7",
        "id": "insufficient-development-control",
        "title": "Insufficient Control of Custom Software Development",
        "description": "If software development is not adequately controlled and directed by the commissioning party,",
        "impact": "Missing, weak, or improperly prioritized security functions in custom-developed software can lead to a wide range of vulnerabilities,",
        "action": "Establish Clear Security Requirements and Governance for Development Projects",
        "mitigation": "The client must define clear and testable security requirements before and during the development of custom software.",
        "check": "Are there documented security requirements for this custom component? Is there a defined process for project governance involving the client/product owner?",
        "asvs": "ASVS V1.1 (Architecture, Design and Threat Modeling Requirements), ASVS V1.3 (Architecture and Design Requirements)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for any in-scope technical asset marked as having 'custom developed parts'.",
        "riskAssessment": "The likelihood is considered 'Likely' as a baseline for any custom-developed software, as process deficiencies are common.",
        "falsePositives": "This risk can be a false positive if the custom software was developed under a strong, security-aware governance model",
        "cwe": "284",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "20_sec6.ts",
        "bsiCode": "APP.7",
        "id": "inadequate-developer-expertise",
        "title": "Inadequate Developer Expertise or Resources",
        "description": "Commissioning unsuitable software developers can lead to various threats. A lack of technical expertise",
        "impact": "If developers lack the required security expertise or resources, it can lead to the introduction of critical vulnerabilities.",
        "action": "Ensure Developer Suitability and Enforce Secure Development Practices",
        "mitigation": "Vet developers for the required technical and security expertise before and during projects.",
        "check": "Is there a formal process for vetting developer skills, including security? Is a Secure SDLC documented and followed?",
        "asvs": "Derived from BSI IT-Grundschutz CON.1 (General Software Development and Acquisition). Also relates to OWASP Top 10 A05:2021 - Security Misconfiguration and general secure coding practices.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_software_development_and_acquisition_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all in-scope technical assets marked as having 'custom developed parts'.",
        "riskAssessment": "The impact of this risk is determined by the Confidentiality, Integrity, and Availability (CIA) requirements of the technical asset and the data it handles.",
        "falsePositives": "This risk might be a false positive if the development team has proven, strong security expertise and follows a robust Secure SDLC,",
        "cwe": "284",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "CON.10": [
      {
        "file": "21_sec1.ts",
        "bsiCode": "CON.10",
        "id": "flawed-authorization-in-web-applications",
        "title": "Flawed Authorization in Web Applications (BSI-based)",
        "description": "In an attack, attempts are often made to access functions or data of web applications that are only available with specific access rights.",
        "impact": "If authorization checks are missing or flawed, attackers can elevate their privileges, leading to unauthorized access to sensitive data and critical functionalities.",
        "action": "Implement and Enforce Correct Authorization Logic",
        "mitigation": "Ensure that every request to a protected resource on the server-side re-validates the user's authorization and permissions.",
        "check": "Are server-side authorization checks performed for every request to a protected resource? Is it possible to bypass these checks by manipulating request parameters, URLs, or headers?",
        "asvs": "V4.1: Verify that the application enforces access control rules on each request from a client, and that it does not expose any sensitive data or functionality to unauthorized users.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is identified for web-facing assets (like Web Applications, Web Services) that have incoming communication links with no authorization mechanism specified (`authorization: 'none'`).",
        "riskAssessment": "The impact is determined by the highest confidentiality and integrity rating of the data processed or stored by the web application.",
        "falsePositives": "A risk might be a false positive if the endpoint is intentionally public (e.g., a login page or a public-facing API with no sensitive data).",
        "cwe": "285",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "21_sec2.ts",
        "bsiCode": "CON.10",
        "id": "improper-input-validation-and-output-encoding-bsi-app-4-a7",
        "title": "Improper Input Validation and Output Encoding (XSS) (BSI APP.4.A7)",
        "description": "If a web application processes unvalidated input data, protective mechanisms can be bypassed. This risk increases if, at the same time, the output data of the web application is transmitted without sufficient encoding directly to the web browser, the calling application, or downstream IT systems. Such output data can contain malicious code (e.g., JavaScript) that is then interpreted or executed on the target systems, leading to a Cross-Site Scripting (XSS) attack.",
        "impact": "Successful exploitation can lead to the execution of unauthorized scripts in a user's browser, enabling session hijacking, theft of sensitive information (e.g., credentials, personal data), website defacement, or redirection to malicious sites. If the tainted data is consumed by other backend systems, it could lead to further compromise.",
        "action": "Implement Robust Input Validation and Context-Aware Output Encoding",
        "mitigation": "All input data must be validated against a strict allow-list of expected characters, formats, and lengths. Crucially, all data must be encoded immediately before being rendered in the output, using a context-aware approach (e.g., for HTML bodies, HTML attributes, JavaScript, CSS, or URLs). Use standard, trusted libraries for encoding. Implement a strong Content Security Policy (CSP) as a defense-in-depth measure to restrict the execution of untrusted scripts.",
        "check": "Are all user-supplied inputs validated against a strict allow-list? Is context-aware output encoding applied to all data before it is rendered in the browser or sent to other systems? Is a Content Security Policy (CSP) in place?",
        "asvs": "OWASP ASVS V4.0.3: 5.1 Input Validation, 5.2 Sanitization and Sandboxing, 5.3 Output Encoding and Injection Prevention",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for web applications or web services, especially those with custom-developed parts, that receive data and then send data to a client-side component (like a browser). The risk is considered present unless the asset is explicitly tagged as having both input validation and output encoding controls.",
        "riskAssessment": "The likelihood is high for internet-facing, custom-developed applications. The impact is determined by the sensitivity (Confidentiality and Integrity) of the data being transferred over the affected communication link. An attack on a system handling strictly confidential data or enabling critical operations will have a high impact.",
        "falsePositives": "This risk can be a false positive if the application employs effective input validation and output encoding, but this is not reflected by tags in the model.",
        "cwe": "79",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "21_sec3.ts",
        "bsiCode": "CON.10",
        "id": "improper-error-handling-web-app",
        "title": "Improper Error Handling in Web Application",
        "description": "If errors that occur during the operation of a web application are not handled correctly, both the operation of the web application and the protection of its functions and data can be impaired. For example, an error can cause the web application to no longer run correctly and become unreachable for clients. In addition, actions may be performed only partially, cached actions and data may be lost, or security mechanisms may fail.",
        "impact": "Improper error handling can lead to various security threats. Verbose error messages can leak sensitive system information (Information Disclosure). An unhandled exception might cause a Denial of Service. If an application fails to a non-secure state, it might allow for bypassing security controls (Elevation of Privilege) or data corruption (Tampering).",
        "action": "Implement Robust and Secure Error Handling",
        "mitigation": "Implement a centralized and robust error handling mechanism for the entire application. All exceptions should be caught and handled gracefully. Ensure that user-facing error messages are generic and do not reveal any internal system details, stack traces, or database errors. Log detailed error information securely on the server-side for debugging and analysis. The application should fail to a secure state, preventing any potential bypass of security controls.",
        "check": "Review the source code for consistent use of try-catch blocks or a global exception handler. Check that user-facing error pages are generic. Trigger errors in the application to verify that no sensitive information is leaked in the HTTP response. Ensure that the application remains in a secure and consistent state after an error occurs.",
        "asvs": "V7.1.1: Verify that all application components handle errors and exceptions in a way that preserves the security and integrity of the application, including by not revealing sensitive information in error responses.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html",
        "detectionLogic": "This risk is automatically identified for all in-scope, custom-developed technical assets that are web applications, web servers, or web services. The use of custom code significantly increases the likelihood of programming flaws such as improper error handling.",
        "riskAssessment": "The likelihood of this risk is considered high for any custom-developed web component, as error handling is a common area for mistakes. The impact depends directly on the CIA requirements of the asset and the data it processes. A failure in an application handling 'Strictly Confidential' data has a much higher impact than one handling 'Public' data. The failure of security mechanisms as a consequence can also lead to very high impacts.",
        "falsePositives": "This risk can be considered a false positive if the development team can demonstrate a mature, consistently applied, and secure error handling framework that is used throughout the entire application.",
        "cwe": "755",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "21_sec4.ts",
        "bsiCode": "CON.10",
        "id": "insufficient-logging-in-web-application",
        "title": "Insufficient Logging in Web Application (based on BSI)",
        "description": "If security-relevant events are not sufficiently logged by a web application, it becomes difficult or impossible to reconstruct security incidents later. The root cause of an incident may no longer be determinable. For example, configuration errors can be overlooked if they do not result in error messages in the log files. Vulnerabilities are also difficult or impossible to detect and fix with inadequate logging.",
        "impact": "Lack of proper logging prevents or hinders incident response, forensic analysis, and effective auditing. It allows attackers to operate with a lower chance of detection, cover their tracks more easily, and makes it difficult to assess the scope of a compromise. This can lead to prolonged system compromises, undetected data breaches, and failure to meet compliance requirements for auditing and accountability.",
        "action": "Implement Comprehensive and Structured Security Logging",
        "mitigation": "Ensure the web application logs all security-relevant events, including authentication attempts (success and failure), access control decisions, significant server-side errors, session management events, and input validation failures. Logs should be in a structured format (e.g., JSON), include sufficient context (timestamps, source IP, user ID, event correlation ID), and be protected from unauthorized access or modification. It is best practice to forward logs to a centralized and secured log management system for aggregation, monitoring, and alerting.",
        "check": "Review the application's source code and configuration to verify which events are being logged. Inspect the running application's logs during security testing to confirm that events are captured as expected. Check if a centralized logging solution (e.g., a 'Monitoring' asset) receives logs from this component.",
        "asvs": "OWASP ASVS V7: Error Handling and Logging",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for all in-scope technical assets identified as web applications or web services (e.g., using technologies like 'web-application', 'web-server', 'web-service-rest'). The risk is heightened for custom-developed parts. Its severity increases based on the sensitivity (CIA ratings) of the asset and the data it handles. The check assumes that without an explicitly modeled and connected logging system, logging is likely insufficient by default.",
        "riskAssessment": "The likelihood is considered higher for custom-developed applications, as comprehensive logging is often an overlooked requirement. The impact is directly related to the confidentiality and integrity requirements of the data processed or stored by the application. An application handling 'Strictly Confidential' data with poor logging capabilities represents a much higher impact than one handling only 'Public' data, as a potential breach cannot be properly investigated.",
        "falsePositives": "This risk might be a false positive if a robust, centralized logging mechanism is in place and collects logs from the asset but is not explicitly modeled as a `Monitoring` or `IDS`/`IPS` asset with a communication link from the web application. This generic risk should always be verified against the actual implementation details.",
        "cwe": "778",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "21_sec5.ts",
        "bsiCode": "CON.10",
        "id": "information-leakage-via-web-application",
        "title": "Information Leakage of Technical Details via a Web Application",
        "description": "Websites and data generated and delivered by a web application may contain information about backend systems,",
        "impact": "If an attacker learns about the specific technologies and versions used by the web application, they can more easily find and exploit known vulnerabilities.",
        "action": "Configure the Web Server and Application to Prevent Information Leakage",
        "mitigation": "Configure the web server and application framework to avoid disclosing specific software versions and other technical details.",
        "check": "Are HTTP response headers sanitized to remove version information? Do error messages avoid showing technical details like stack traces or internal server data?",
        "asvs": "V6.2.5 (ASVS 4.0.3), V14.2.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html",
        "detectionLogic": "This risk is automatically checked for all in-scope technical assets of type Web Server, Web Application, Application Server, or Web Service (REST/SOAP).",
        "riskAssessment": "The likelihood is considered 'Likely' as many frameworks and servers expose this information by default.",
        "falsePositives": "This might be a false positive if a security control in front of the application (like a WAF or a reverse proxy) is configured to strip this information from all responses.",
        "cwe": "200",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "21_sec6.ts",
        "bsiCode": "CON.10",
        "id": "automated-threats-against-web-application",
        "title": "Automated Threats against Web Applications (based on BSI APP.3.1)",
        "description": "When web application functions are used in an automated fashion, numerous operations can be executed in a short amount of time.",
        "impact": "A lack of protection against automated attacks can lead to account takeovers (via brute-force), sensitive data disclosure (via enumeration),",
        "action": "Implement Protection Against Automated and High-Frequency Attacks",
        "mitigation": "Implement technical controls to detect and block automated attacks. This includes rate-limiting on sensitive endpoints (e.g., login, search, API calls),",
        "check": "Are there mechanisms like rate limiting, CAPTCHAs, or temporary account lockouts on sensitive functions (login, password reset, complex searches)?",
        "asvs": "BSI IT-Grundschutz APP.3.1 (Web Applications), particularly A11 (Hardening), A17 (Protection against DoS), and A19 (Error Handling). Also relates to OWASP ASVS V4.3 (Authentication) and V10.4 (Availability).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Blocking_Brute_Force_Attacks_Cheat_Sheet.html",
        "detectionLogic": "This risk applies to internet-facing technical assets that are web applications or web services.",
        "riskAssessment": "The likelihood is considered high for any public-facing web application lacking these protections. The impact is determined by the CIA rating of the asset.",
        "falsePositives": "This risk can be a false positive if automated attack protection is implemented by an underlying component (e.g., a WAF, API Gateway, or Cloud Armor/Shield)",
        "cwe": "770",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "21_sec7.ts",
        "bsiCode": "CON.10",
        "id": "insufficient-session-management",
        "title": "Insufficient Session Management",
        "description": "Insufficient session management can allow an attacker, without special access rights, to determine the session ID of an account with extensive privileges. This ID can then be used to access protected functions and resources of the web application, for example, in a session fixation attack. In such an attack, an attacker first obtains a session ID with limited rights from the web application. This ID is then sent to a higher-privileged user, for example, via a link in an email. If the higher-privileged user follows this link and authenticates to the web application under that session ID, the attacker can subsequently use the application with the full access rights of the legitimate account.",
        "impact": "If an attacker successfully takes over a legitimate user's session (session hijacking), they can perform all actions and access all data that the user is authorized for. This can lead to unauthorized data disclosure, modification, or deletion, as well as fraudulent transactions, depending on the compromised account's privileges. This constitutes a full elevation of privilege to the victim's level.",
        "action": "Strengthen Session Management Mechanisms",
        "mitigation": "Implement robust session management. Key measures include: 1. Generating a new, high-entropy session ID upon successful user authentication to prevent session fixation. 2. Invalidating the session ID after logout or a reasonable period of inactivity. 3. Using the `Secure` and `HttpOnly` flags for session cookies. 4. Avoid exposing session IDs in URLs. 5. Implementing strict timeout mechanisms for all sessions.",
        "check": "Review the application's authentication and session handling logic. Does the application issue a new session token after a user logs in? Are session tokens transmitted securely over encrypted channels and protected from client-side script access (HttpOnly)? Are sessions properly invalidated on logout and timeout?",
        "asvs": "V3 Session Management, especially V3.3.1 and V3.4.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html",
        "detectionLogic": "This risk is generated for technical assets identified as web applications or services. It triggers when an incoming communication link from a client-like asset (e.g., Browser) uses session-based authentication ('session-id' or 'token'). The model assumes that without explicit countermeasures (which cannot be modeled), a risk of session fixation exists, as the framework cannot verify if the application correctly regenerates session IDs upon login.",
        "riskAssessment": "The likelihood is considered 'Likely' for custom-developed applications where secure session handling might be overlooked. The impact is directly proportional to the sensitivity of the data assets processed and the privileges of the users who authenticate. Hijacking an administrator's session on a system handling 'Strictly Confidential' data results in a 'Very High' impact.",
        "falsePositives": "The risk can be considered a false positive if the application correctly implements session management best practices (e.g., renewing session IDs after successful authentication). This cannot be verified from the architectural model alone and requires a code review or a dynamic application security test (DAST).",
        "cwe": "384",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "CON.11.1": [
      {
        "file": "22_sec1.ts",
        "bsiCode": "CON.11.1",
        "id": "unauthorized-disclosure-of-classified-information",
        "title": "Unauthorized Disclosure of Classified Information (VS-NfD / Geheimschutz)",
        "description": "A significant threat to classified information (German: 'Verschlusssache' or 'VS') is unauthorized access or disclosure. This can occur when the governing security regulations (e.g., 'Verschlusssachenanweisung' - VSA) are not followed.",
        "impact": "If classified information is disclosed to unauthorized parties, it can be harmful to the organization or the state. Leaked information (e.g., network plans, security concepts) can be exploited to facilitate further intrusions.",
        "action": "Enforce Data-at-Rest Encryption and Secure Data Handling on Non-Ephemeral Systems",
        "mitigation": "Ensure all assets storing classified data (equivalent to 'Confidential' or 'Strictly-Confidential') use data-at-rest encryption (i.e., set the asset's `encryption` property to `transparent` or a data-level encryption style).",
        "check": "Are all datastores handling 'Confidential' or 'Strictly-Confidential' data configured with an `encryption` style other than `none`?",
        "asvs": "OWASP ASVS V4.0.3: 6.2.2 (Data-at-rest encryption) and 6.2.5 (Securely purge temporary files)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for technical assets that handle highly sensitive data without adequate built-in protection mechanisms modeled in Threagile.",
        "riskAssessment": "The impact is derived directly from the confidentiality level of the affected data asset ('High' for 'Confidential', 'Very High' for 'Strictly-Confidential').",
        "falsePositives": "The risk might be a false positive if there are compensating controls not modeled in Threagile, such as mandatory OS-level full-disk encryption on all servers, which would mitigate the 'unencrypted at rest' scenario. This must be verified outside the model.",
        "cwe": "312",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "22_sec2.ts",
        "bsiCode": "CON.11.1",
        "id": "covert-espionage-attack-bsi",
        "title": "Covert Espionage Attack (Konspirativer Angriff)",
        "description": "A covert espionage attack is a form of espionage where information is secretly obtained from non-public sources by foreign intelligence services, organized crime, or other sophisticated attackers. The primary goal is to remain undetected while accessing valuable or classified information, often by exploiting technical vulnerabilities (like backdoors or malware) or using human sources (social engineering).",
        "impact": "If successful, attackers can access sensitive or classified information, gaining a strategic, financial, or political advantage. This can lead to severe reputational damage, financial loss, and compromise of national or corporate security. It represents a critical breach of confidentiality.",
        "action": "Implement Layered, Defense-in-Depth Security for High-Value Assets",
        "mitigation": "Protect high-value assets through multiple layers of security. This includes strict network segmentation to create highly secured zones, enforcing the principle of least privilege and need-to-know for access control, and using strong encryption for data at rest and in transit. Implement advanced monitoring and anomaly detection, especially for data exfiltration patterns. All systems must be hardened, and a rigorous vulnerability management and patching process must be in place. Personnel security, including awareness training against social engineering, is also crucial.",
        "check": "Are high-value data and the assets processing it clearly identified? Are these assets isolated in dedicated, hardened security zones? Is access to these assets and data strictly limited and monitored? Is all communication involving these assets encrypted? Is there an advanced threat detection and response capability (e.g., a SOC) monitoring these assets?",
        "asvs": "This describes a general threat ('Gefährdung') from the BSI context, not a specific control. It relates to protecting high-value assets against advanced persistent threats (APTs).",
        "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Unternehmen-und-Organisationen/Informationen-und-Empfehlungen/Lageberichte/lageberichte_node.html",
        "detectionLogic": "This risk is raised for any technical asset that processes or stores highly sensitive data (Confidential or Strictly Confidential). The likelihood of the risk is increased if the asset is exposed to less trusted environments, such as being directly internet-facing or receiving unencrypted traffic from other zones.",
        "riskAssessment": "The impact is directly derived from the confidentiality level of the data processed or stored by the asset. The likelihood is considered 'Likely' for any such high-value target and increases to 'Very Likely' if aggravating factors like internet exposure exist. These attackers are assumed to be skilled and motivated.",
        "falsePositives": "The model might not be aware of advanced, non-technical, or out-of-band security controls like physical air-gapping, 24/7 human-led security operations center (SOC) monitoring, or counter-intelligence programs that could significantly mitigate this threat.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "22_sec3.ts",
        "bsiCode": "CON.11.1",
        "id": "insider-threat-theft-of-classified-information",
        "title": "Insider Threat: Theft of Classified Information (BSI-Gefährdung: Insider)",
        "description": "Malicious insiders (internal or external employees with legitimate access) intentionally steal confidential or classified information. These individuals possess extensive knowledge of internal processes and have authorized access rights, which they can abuse to increase the likelihood of a successful attack. They may also time their attacks to coincide with periods of low monitoring, such as maintenance windows, to avoid detection.",
        "impact": "Successful theft of information by an insider leads to unauthorized third parties gaining access to sensitive or classified data. This can result in severe damage to the organization, including financial loss, reputational harm, loss of competitive advantage, and potential legal or regulatory penalties. For government entities, it can be detrimental to national interests.",
        "action": "Implement Layered Defense, Monitoring, and Access Control for Insider Threats",
        "mitigation": "Mitigation requires a multi-layered approach. Enforce the Principle of Least Privilege (PoLP) and Separation of Duties (SoD) to limit the potential scope of damage. Implement comprehensive logging and monitoring of access to critical assets and sensitive data, utilizing anomaly detection (e.g., UEBA) to identify suspicious behavior. Employ Data Loss Prevention (DLP) solutions to control data exfiltration channels. Conduct regular access reviews to ensure permissions are current and necessary. The 'four-eyes principle' should be applied to critical administrative tasks.",
        "check": "Are the principles of least privilege and separation of duties strictly enforced? Is all access to sensitive data and systems logged and regularly audited? Are there anomaly detection or UEBA systems in place? Is there a DLP solution? Are user access rights reviewed periodically?",
        "asvs": "BSI ORP.4 (Identity and Access Management), OPS.1.1.5 (Logging); OWASP ASVS V1.4 (Access Control - Least Privilege), V7.1 (Logging and Monitoring)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is generated for any technical asset that processes or stores data with a Confidentiality rating of 'Confidential' or 'Strictly Confidential'. The presence of authorized access to such high-value data inherently creates an opportunity for malicious insider activity. The risk is elevated for assets with a high number of incoming data flows, as this can increase the number of potential insiders with legitimate access.",
        "riskAssessment": "The impact is directly derived from the confidentiality rating of the data at risk ('High' for Confidential, 'Very High' for Strictly Confidential). The likelihood is considered 'Likely' by default due to the inherent difficulty in preventing abuse of legitimate access, and can be elevated if many users or systems have access.",
        "falsePositives": "This risk can be considered a false positive or accepted if comprehensive, specific insider threat countermeasures (like dedicated User and Entity Behavior Analytics (UEBA), robust DLP, and strict, audited PoLP) are in place for the identified asset and are confirmed to be effective. A generic 'we do logging' statement is insufficient to mitigate this risk.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "CON.1": [
      {
        "file": "23_sec1.ts",
        "bsiCode": "CON.1",
        "id": "inadequate-key-management",
        "title": "Inadequate Key Management (BSI CON.1.G1)",
        "description": "Inadequate key management can lead to the exposure of unencrypted information during an attack.",
        "impact": "If cryptographic keys are not managed properly, it can lead to a loss of confidentiality for encrypted data. It can also cause a denial of service if expired keys or certificates render critical system functions unusable.",
        "action": "Establish and Enforce a Key Management Policy",
        "mitigation": "A comprehensive key management lifecycle process must be established. This includes secure key generation, distribution, storage, rotation, and destruction.",
        "check": "Is there a documented key management policy? Are keys and data stored separately? Are key management systems like a Vault or HSM in use? Is there a process to monitor and handle key/certificate expiration?",
        "asvs": "BSI IT-Grundschutz CON.1: Cryptographic Concept (CON.1.G1 Inadequate key management)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Cryptographic_concept_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is detected in two primary ways.",
        "riskAssessment": "The impact on Availability is determined by the availability rating of the affected asset. The impact on Confidentiality is determined by the confidentiality rating of the data at risk.",
        "falsePositives": "The model may not explicitly show the use of a cloud-provider-managed key service (like AWS KMS or Azure Key Vault), which might be used correctly but not modeled as a 'Vault' asset. This could lead to a false positive.",
        "cwe": "320",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "23_sec2.ts",
        "bsiCode": "CON.1",
        "id": "legal-crypto-restrictions",
        "title": "Legal and Regulatory Restrictions on Cryptography",
        "description": "When institutions use hardware or software with cryptographic functions, they must comply with various legal frameworks.",
        "impact": "A conflict between legal requirements—where one country mandates strong encryption (e.g., for data protection) while another prohibits it without a permit—can make legal communication impossible.",
        "action": "Verify and Comply with Jurisdictional Cryptography Regulations",
        "mitigation": "Conduct a thorough legal review for all jurisdictions where encrypted data is sent or processed. Use cryptographic modules that are compliant with the regulations in all relevant countries.",
        "check": "Is encrypted data being transferred across national borders? Have the cryptographic laws of the source and destination countries been reviewed?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Kryptokonzept), especially section 2.2, and data protection regulations like the GDPR (Art. 32, 44-50) governing data security and international transfers.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Cross-border_cloud_usage_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule flags communication links that are (a) encrypted (e.g., HTTPS/TLS), (b) use a VPN, or (c) carry data with Confidentiality ≥ Restricted, and that cross national borders.",
        "riskAssessment": "Likelihood is 'Likely' if the target jurisdiction requires a permit ('crypto-requires-permit:true'); otherwise 'Unlikely'.",
        "falsePositives": "A risk might be a false positive if a specific legal agreement or permit is in place that allows the transfer but is not captured in the model.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "23_sec3.ts",
        "bsiCode": "CON.1",
        "id": "improper-or-missing-use-of-cryptography",
        "title": "Improper or Missing Use of Cryptography",
        "description": "If cryptographic functions are not used or are used incorrectly, they cannot provide the intended protection for information.",
        "impact": "Failure to correctly encrypt sensitive data, both in transit and at rest, can lead to unauthorized disclosure of information, violating its confidentiality.",
        "action": "Ensure Correct and Enforced Use of Cryptography",
        "mitigation": "Ensure that all communication channels transmitting sensitive data utilize strong, state-of-the-art encryption protocols (e.g., TLS 1.2/1.3).",
        "check": "Are all communication links carrying sensitive data encrypted? Is data-at-rest encryption applied for all data stores holding sensitive information? Are the cryptographic protocols and algorithms in use considered strong and are they configured correctly?",
        "asvs": "V7: Communication Security Verification Requirements, V6: Stored Cryptography Verification Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for two primary conditions:",
        "riskAssessment": "The likelihood of exploitation is higher for assets and links connected to the internet.",
        "falsePositives": "This risk might be flagged for communication links within a highly secure and isolated environment where encryption is considered unnecessary overhead.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "23_sec4.ts",
        "bsiCode": "CON.1",
        "id": "flaw-in-crypto-implementation",
        "title": "Flaw in Cryptographic Implementation",
        "description": "Vulnerabilities or errors in hardware or software with cryptographic functions can compromise the security of the cryptographic methods used.",
        "impact": "If an implementation flaw in a cryptographic function is exploited, it can lead to a complete loss of confidentiality for the data protected by it.",
        "action": "Validate and Verify Cryptographic Implementations",
        "mitigation": "Use well-vetted, standard, and up-to-date cryptographic libraries and algorithms from trusted sources.",
        "check": "Are cryptographic implementations based on standard, up-to-date libraries? Is there a process for patching cryptographic components?",
        "asvs": "BSI IT-Grundschutz CON.1 Cryptographic Concept; OWASP Top 10 2021 A02: Cryptographic Failures.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for technical assets that use cryptography, either for data at rest or for data in transit.",
        "riskAssessment": "The likelihood is higher for custom-developed cryptography and lower for standard, patched components. The impact is directly",
        "falsePositives": "This risk might be a false positive if a component marked as 'custom-developed' does not actually contain custom cryptographic code",
        "cwe": "327",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "23_sec5.ts",
        "bsiCode": "CON.1",
        "id": "hardware-crypto-failure-con8-a23",
        "title": "Failure of Non-Redundant Cryptographic Hardware (BSI CON.8.A23)",
        "description": "Hardware with cryptographic functions (e.g., Hardware Security Modules (HSM) or hardware-backed vaults) can fail due to technical defects, power outages, or physical damage.",
        "impact": "A failure of non-redundant cryptographic hardware can cause entire business process chains to halt, especially when other applications or services depend on the now-inaccessible information.",
        "action": "Ensure Redundancy and Disaster Recovery for Critical Cryptographic Hardware",
        "mitigation": "Critical hardware components with cryptographic functions, such as HSMs, should be designed with redundancy (e.g., in a cluster configuration).",
        "check": "Is the technical asset configured with the `redundant: true` flag? Are there documented and tested disaster recovery plans for this hardware component?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.8 (Cryptography), Requirement CON.8.A23 (Redundancy of cryptographic components).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Cryptography_edition_2023.pdf?__blob=publicationFile (BSI CON.8)",
        "detectionLogic": "This risk is triggered for any in-scope technical assets of technology type 'HSM' or 'Vault' that are not marked as redundant (`redundant: false`).",
        "riskAssessment": "The likelihood of a single hardware component failing over its operational lifetime is considered 'Likely'.",
        "falsePositives": "This risk might be a false-positive if the component is not used for business-critical real-time operations or if alternative, effective, and tested recovery procedures exist that are not captured by the `redundant` flag in the model.",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "23_sec6.ts",
        "bsiCode": "CON.1",
        "id": "insecure-cryptographic-algorithms",
        "title": "Use of Insecure or Outdated Cryptographic Algorithms",
        "description": "Insecure or outdated cryptographic algorithms can be broken with little effort. For encryption algorithms, this means that an attacker can derive the original plaintext from the encrypted text without needing additional information, such as the cryptographic key.",
        "impact": "Failure to use strong, up-to-date cryptography can lead to the compromise of confidentiality and integrity of data, both in transit and at rest. This can result in data breaches, unauthorized access, and tampering, leading to financial loss, reputational damage, and non-compliance with regulations.",
        "action": "Use Strong, State-of-the-Art Cryptography",
        "mitigation": "Ensure all data-in-transit is protected by strong, state-of-the-art encryption protocols (e.g., TLS 1.2+ with modern cipher suites). Ensure all sensitive data-at-rest is encrypted using vetted, industry-standard algorithms and strong key management practices.",
        "check": "Are all communication links carrying sensitive data using an encrypted protocol? Are all data stores holding sensitive information configured for encryption-at-rest? Is there a defined policy for cryptographic standards that is regularly reviewed and updated?",
        "asvs": "V6 Cryptography, V13 Transport Layer Security",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule detects two primary conditions:",
        "riskAssessment": "The likelihood of exploitation increases significantly when unencrypted communication crosses network trust boundaries or involves internet-facing assets. The impact is determined by the confidentiality and integrity requirements of the data being transmitted or stored. A data breach is considered probable if highly sensitive data is left unprotected.",
        "falsePositives": "This rule may flag unencrypted communication within a physically secure network or inside an outer encrypted tunnel (like a VPN or IPsec) that is not explicitly modeled. It also might not recognize application-level encryption if the data is sent over an unencrypted protocol, as this requires deeper model details.",
        "cwe": "327",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "23_sec7.ts",
        "bsiCode": "CON.1",
        "id": "corruption-of-encrypted-data-or-keys",
        "title": "Corruption of Encrypted Data or Keys Leading to Data Loss",
        "description": "If encrypted information (ciphertext) or the associated cryptographic key is altered, even slightly, it may become impossible to decrypt the original data.",
        "impact": "The primary impact is a loss of availability for all data that was encrypted with the compromised key or whose ciphertext was corrupted.",
        "action": "Implement Robust Data @Backup:Target, Key Management, and Integrity Verification",
        "mitigation": "Maintain regular, automated backups of all critical data. Crucially, ensure that cryptographic keys are also securely backed up, for example in a Hardware Security Module (HSM), a vault, or another key management system.",
        "check": "Is there a regularly tested @Backup:Target and recovery process for encrypted data stores? Are cryptographic keys securely stored and backed up in a separate, resilient system (e.g., Vault, HSM)?",
        "asvs": "Derived from BSI IT-Grundschutz Bausteine CON.1 (Cryptographic Concept) and CON.8 (Key Management). Also relates to OWASP Top 10 A02:2021 - Cryptographic Failures.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Cryptographic_concept_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule targets data stores that use encryption but lack explicit confirmation of a tested @Backup:Target process.",
        "riskAssessment": "The impact of this risk is directly proportional to the availability requirement of the data being stored.",
        "falsePositives": "A risk might be flagged if the @Backup:Target and recovery process exists but is not documented in the model via the '@Mitigation:@Backup:Target-verified' tag. This is an organizational control that may not be visible in the architecture diagram alone.",
        "cwe": "345",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "23_sec8.ts",
        "bsiCode": "CON.1",
        "id": "compromise-of-cryptographic-keys",
        "title": "Compromise of Cryptographic Keys (BSI)",
        "description": "The security of cryptographic mechanisms depends critically on the confidentiality of the cryptographic keys used.",
        "impact": "If an attacker gains access to cryptographic keys, all data encrypted with these keys must be considered compromised. This leads to a severe loss of confidentiality and can undermine the integrity and authenticity of data if the keys are also used for signing.",
        "action": "Implement secure key management and storage",
        "mitigation": "Store cryptographic keys in a secure, dedicated location, such as a Hardware Security Module (HSM) or a trusted key vault service.",
        "check": "Are cryptographic keys stored in a dedicated secure management system (HSM, Vault)? Are keys ever stored in plaintext in configuration files, source code, or unsecured backups? Is there a key rotation policy?",
        "asvs": "BSI IT-Grundschutz: CON.1 Cryptographic Concept",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Cryptographic_controls_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies technical assets that use application-level encryption but are not specialized key management systems (like Vaults or HSMs) and do not appear to be communicating with one.",
        "riskAssessment": "The likelihood is high for custom-developed components that perform their own encryption without integrating a dedicated key management system.",
        "falsePositives": "A risk might be a false positive if an asset uses a secure, but un-modeled, key management mechanism (e.g., using secure OS key stores or a key management service that is not represented as a separate asset in the model).",
        "cwe": "522",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "23_sec9.ts",
        "bsiCode": "CON.1",
        "id": "forged-certificates",
        "title": "Forgery of Certificates (BSI CON.4)",
        "description": "Certificates are used to bind a public cryptographic key to an identity (person, IT system, or institution).",
        "impact": "If a forged certificate is accepted, an attacker can impersonate a legitimate system or user, leading to Man-in-the-Middle (MITM) attacks.",
        "action": "Implement Robust Certificate and Trust Chain Validation",
        "mitigation": "The client application connecting to a service must perform strict validation of the presented TLS certificate. This includes:",
        "check": "Is the application code validating the full certificate chain of every communication partner? Does it perform hostname verification? Is revocation checking implemented? Are self-signed or expired certificates rejected?",
        "asvs": "V14.2.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for every communication link that uses a certificate-based protocol (e.g., HTTPS, LDAPS) or requires client-certificate authentication.",
        "riskAssessment": "The likelihood of exploitation is higher for communication crossing network trust boundaries, as this increases the opportunity for MITM attacks.",
        "falsePositives": "This can be a false positive if the application has been explicitly developed to perform all required certificate validation steps correctly.",
        "cwe": "295",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Spoofing"
      }
    ],
    "CON.2": [
      {
        "file": "24_sec1.ts",
        "bsiCode": "CON.2",
        "id": "fundamental-rights-interference",
        "title": "Insufficiently Mitigated Interference with Fundamental Rights (BSI Risk Type A)",
        "description": "This risk addresses scenarios where the processing of personal data interferes with the fundamental rights of individuals in a way that is not sufficiently mitigated or minimized ('nicht hinreichend milde gestaltet').",
        "impact": "Failure to adequately mitigate the impact of data processing on fundamental rights can lead to severe legal and financial consequences, including substantial fines under the GDPR (DSGVO) and other data protection laws.",
        "action": "Implement Data Protection by Design and by Default (DPbDD)",
        "mitigation": "Strictly adhere to the principles of data minimization and purpose limitation. Only collect, process, and store personal data that is absolutely necessary for a clearly defined and legitimate purpose.",
        "check": "Has a Data Protection Impact Assessment (DPIA) been conducted? Is all processed personal data strictly necessary for the defined business purpose?",
        "asvs": "This concept is central to legal frameworks like the GDPR, particularly Article 5 (Principles relating to processing of personal data) and Article 25 (Data protection by design and by default). It is also a core principle of the BSI's 'Standard-Datenschutzmodell' (SDM).",
        "cheatSheet": "https://gdpr-info.eu/art-25-gdpr/",
        "detectionLogic": "This risk is raised for technical assets that process or store a significant quantity of highly sensitive personal data.",
        "riskAssessment": "The impact is directly derived from the confidentiality and criticality rating of the data asset, as this reflects the potential harm to the individual. 'Strictly-Confidential' data leads to a 'Very High' impact.",
        "falsePositives": "This rule can trigger for systems that legitimately and lawfully process large amounts of sensitive personal data (e.g., a hospital's patient management system).",
        "cwe": "359",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "24_sec10.ts",
        "bsiCode": "CON.2",
        "id": "inherent-risk-of-processing-@DataType:PII-gdpr75",
        "title": "Inherent Risk of Processing Personal Data (GDPR Recital 75)",
        "description": "Processing personal data inherently creates risks to the rights and freedoms of natural persons, with varying likelihood and severity. These risks can result in physical, material, or immaterial harm if data is compromised, for example through unauthorized access, processing, or disclosure.",
        "impact": "A breach involving personal data can cause severe consequences, including discrimination, identity theft or fraud, financial loss, reputational damage, loss of confidentiality of data subject to professional secrecy, unauthorized reversal of pseudonymization, or other significant economic or social disadvantages. Individuals may lose control over their personal data, particularly when special categories of data (e.g., health, ethnic origin, political opinions) are involved, when profiling is performed, or when vulnerable persons are affected.",
        "action": "Implement Appropriate Technical and Organizational Measures (TOMs)",
        "mitigation": "Implement a defense-in-depth strategy based on a Data Protection Impact Assessment (DPIA). Key measures include strong access control, data minimization, pseudonymization, and encryption (both in transit and at rest). Apply security-by-design and security-by-default principles. Regularly test, assess, and evaluate the effectiveness of the implemented measures. Ensure that data processing is limited to what is necessary for the specified purpose.",
        "check": "Is there a Data Protection Impact Assessment (DPIA) for processing this data? Are the data assets correctly classified? Is access strictly controlled on a 'need-to-know' basis? Is sensitive personal data encrypted at rest and in transit? Are measures such as pseudonymization used where possible? Are systems regularly patched and securely configured?",
        "asvs": "GDPR Recital 75",
        "cheatSheet": "https://gdpr-info.eu/recitals/no-75/",
        "detectionLogic": "This risk is raised for any in-scope technical asset that processes or stores data assets identified as containing personal information (via tags or high confidentiality). The risk level is adjusted based on the sensitivity and quantity of the data and the exposure of the technical asset (e.g., internet-facing).",
        "riskAssessment": "The impact is directly related to the confidentiality and quantity of the personal data being processed or stored. Special categories of data (e.g., health data) or data concerning vulnerable subjects significantly increase the impact. The likelihood of exploitation increases if the asset is internet-facing, custom-developed, or part of a less-controlled environment (such as a client device), as these factors increase the attack surface.",
        "falsePositives": "The risk might be flagged even if strong, non-modeled compensating controls are in place. A formal DPIA may have assessed the risk and deemed it acceptable with the existing controls. This generated risk should serve as a prompt to verify that such assessments and controls exist and are effective.",
        "cwe": "359",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "24_sec11.ts",
        "bsiCode": "CON.2",
        "id": "incorrectly-assessed-protection-requirement-for-@DataType:PII",
        "title": "Incorrectly Assessed Protection Requirement for Personal Data (BSI-Style)",
        "description": "An institution might incorrectly assess the protection requirements for personal data, typically setting them too low. This can occur if the extended data protection goals (beyond standard CIA) are ignored, if there's a failure to distinguish between risks to the data subject and risks to the institution, or if processes are intentionally biased against the data subject. This risk identifies data assets tagged as containing personal data but modeled with suspiciously low CIA ratings, indicating a potential violation of data protection by design principles.",
        "impact": "Incorrectly assessing the protection requirement for personal data can lead to insufficient safeguards. This increases the risk of data breaches, violating the fundamental rights and freedoms of data subjects. Consequences can include significant legal and financial penalties (e.g., under the GDPR/DSGVO), reputational damage, and loss of customer trust.",
        "action": "Review and Correct CIA Ratings for Personal Data",
        "mitigation": "Ensure all data assets containing personal information are correctly identified and tagged (e.g., with `@DataType:PII`). Conduct a proper Data Protection Impact Assessment (DPIA) to determine the true risk to data subjects. Adjust the confidentiality, integrity, and availability ratings within the threat model to reflect the results of the DPIA, ensuring that protection levels are adequate and comply with legal requirements like the GDPR/DSGVO. The justification for the rating should be documented.",
        "check": "Are all data assets containing personal information tagged appropriately (e.g., `@DataType:PII`)? Do the CIA ratings of these assets reflect the potential impact of a breach on the data subjects, in compliance with data protection laws like the GDPR/DSGVO?",
        "asvs": "Derived from data protection principles such as those in the GDPR/DSGVO (Art. 5, Art. 25, Art. 32) and the BSI's perspective on data protection risk assessment.",
        "cheatSheet": "https://www.bsi.bund.de/EN/Topics/Topics_node.html",
        "detectionLogic": "This rule scans for data assets tagged as containing personal data (`@DataType:PII`) but having suspiciously low confidentiality, integrity, or availability ratings. A risk is then raised for each technical asset that processes or stores this inadequately protected data, as this indicates a failure in data protection by design.",
        "riskAssessment": "The likelihood is considered high if a misconfiguration is detected, as it represents a permanent weakness. The impact on the data subject from a breach of personal data is intrinsically high. The model calculates severity based on this, and the risk is flagged as a potential model failure because the model's own data (the low CIA rating) is being questioned.",
        "falsePositives": "This risk might be considered a false positive if the data has been effectively pseudonymized or anonymized, significantly lowering the risk to the data subject, but this nuance is not captured in the model's tags. Verification requires reviewing the Data Protection Impact Assessment (DPIA) for the specific data asset.",
        "cwe": "359",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "24_sec2.ts",
        "bsiCode": "CON.2",
        "id": "insufficient-or-ineffective-controls-bsi-type-b",
        "title": "Insufficient or Ineffective Controls (BSI Risk Type B)",
        "description": "This risk describes a scenario where the security measures intended to protect a system and its data (i.e., reduce the 'intensity of intervention') are either incomplete, not operated effectively, or are not continuously monitored, audited, and assessed. It represents a failure or gap in the overall security posture, leaving the system vulnerable even if specific controls are thought to be in place.",
        "impact": "Failure to implement and maintain effective controls directly undermines the protection goals of Confidentiality, Integrity, and Availability. This can lead to unauthorized access, data tampering, service disruption, data breaches, and non-compliance with legal/contractual obligations, resulting in significant financial, reputational, and legal damage.",
        "action": "Implement a Robust Security Control Lifecycle",
        "mitigation": "Ensure a defense-in-depth strategy where controls are layered. All security controls (e.g., authentication, authorization, encryption, input validation, network filtering) must be explicitly designed, correctly implemented, and thoroughly tested. Establish a continuous monitoring and auditing process, including regular vulnerability scanning, penetration testing, and log analysis, to verify that all security controls are operating effectively and have not degraded over time.",
        "check": "Are all security controls for the asset documented? Is there a process for regularly testing the effectiveness of these controls (e.g., audit, pentest)? Is there active security monitoring (e.g., SIEM, IDS/IPS) to detect control failures or bypass attempts? Are security logs regularly reviewed?",
        "asvs": "BSI IT-Grundschutz DER.1.A7 (Checking the functionality of security functions) and the broader concepts of CON.1 (Security testing).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Security_monitoring_and_detection_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This is a meta-risk that is difficult to detect automatically. It is raised for any in-scope technical asset with a non-trivial CIA rating (i.e., above public/archive level). The presence of the risk serves as a mandatory checkpoint to manually verify that the documented and implemented security controls for the asset are complete, effective, and continuously monitored.",
        "riskAssessment": "The likelihood is considered 'Likely' as control failures or gaps are a common issue in complex systems. The impact is directly proportional to the highest CIA rating of the technical asset and the data it processes or stores. An asset with 'Strictly Confidential' data will have a 'Very High' impact, while an asset with 'Restricted' data will have a 'Medium' impact.",
        "falsePositives": "This risk may be a false positive if an asset has robust, effective, and well-monitored controls that are not fully detailed in the threat model. The risk should be accepted or marked as a false positive after a manual review and confirmation of the control landscape's effectiveness.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "24_sec3.ts",
        "bsiCode": "CON.2",
        "id": "incomplete-or-ineffective-security-measures",
        "title": "Incomplete or Ineffective Security Measures (BSI Risk Type C)",
        "description": "This risk arises when the security measures required by information security policies (e.g., as per BSI IT-Grundschutz) are not completely implemented, are not operated with sufficient effectiveness, or are not continuously monitored, audited, and assessed. A lack of monitoring and control over critical system components is a primary indicator of this weakness, as it prevents the detection of attacks and operational failures, leaving vulnerabilities exposed.",
        "impact": "Failure to implement, operate, and control security measures effectively can lead to the compromise of confidentiality, integrity, and availability of critical assets. Without proper monitoring, security incidents may go unnoticed, allowing attackers extended time to pivot, escalate privileges, and exfiltrate data. This can result in severe data breaches, system downtime, financial loss, and reputational damage.",
        "action": "Implement and Operate Comprehensive Security Monitoring",
        "mitigation": "Establish a robust security monitoring and detection capability. Key components should send relevant security and operational logs to a central, protected logging system (e.g., SIEM). Define and monitor events that indicate potential security incidents for all critical assets. Ensure monitoring systems themselves are secure and that there are defined processes for analyzing events and responding to alerts. Regularly review and audit the effectiveness of monitoring controls.",
        "check": "Are all critical technical assets configured to send logs to a central monitoring system? Are there alerts configured for suspicious activities? Is there a defined process for incident detection and response based on monitoring events? Are monitoring logs protected against tampering?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein DER.1: Security monitoring and detection. This risk directly relates to requirements like DER.1.A2 (Networked logging) and DER.1.A4 (Selecting suitable log-worthy events).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Security_monitoring_and_detection_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies critical technical assets that lack a modeled communication link to a monitoring system. It flags in-scope assets that are considered sensitive (due to high CIA ratings) or are of a critical technology type (like web applications, databases, or identity providers) but do not appear to be sending data to any asset with the 'Monitoring' technology type. This suggests a gap in continuous control and visibility.",
        "riskAssessment": "The impact is derived directly from the confidentiality and integrity rating of the unmonitored technical asset. The likelihood of an undetected compromise is considered 'Very Likely' if a critical asset has no monitoring link at all, as any attack against it would have a low probability of being detected in a timely manner. The data breach probability is 'Probable' for assets storing or processing sensitive data, as a successful compromise is likely to lead to data exposure.",
        "falsePositives": "A false positive can occur if the monitoring architecture is not fully represented in the model. For example, monitoring may be performed by an agent on a shared host or via network-level taps that are not modeled as explicit communication links from each asset. This risk should be validated against the actual monitoring implementation.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "24_sec4.ts",
        "bsiCode": "CON.2",
        "id": "inadequate-data-protection-in-security-measures-bsi-d",
        "title": "Inadequate Data Protection in Security Measures (BSI Risk Type D)",
        "description": "Information security measures, such as logging, monitoring, or traffic inspection systems (WAF, IDS/IPS), are not always operated in a way that sufficiently complies with data protection principles.",
        "impact": "If security measures improperly handle sensitive or personal data, this can lead to severe data protection violations and data breaches.",
        "action": "Ensure Security Measures Adhere to Data Protection Principles",
        "mitigation": "Review the configuration of all security-related components (e.g., WAFs, IDS/IPS, APM, monitoring/logging systems) to ensure strict data minimization.",
        "check": "Do security components process only the minimum data required for their function? Is sensitive data (credentials, tokens, @DataType:PII) redacted or masked in logs and traces?",
        "asvs": "BSI IT-Grundschutz CON.1.A5 Data minimisation",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_data_protection_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This generator runs only when the selected threat standard is 'BSI'. It identifies in-scope technical assets that function as security controls (e.g., WAF, IDS/IPS, Monitoring, Reverse Proxy or other forwarding components).",
        "riskAssessment": "Impact scales with the confidentiality of the data processed by the security component: processing 'Strictly Confidential' data yields a very high impact; otherwise the impact is high.",
        "falsePositives": "A finding can be a false positive if the security component has been explicitly configured and verified to be privacy-compliant (e.g., it redacts all sensitive fields before processing or logging and enforces minimal retention).",
        "cwe": "359",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "24_sec5.ts",
        "bsiCode": "CON.2",
        "id": "inadequate-consideration-of-privacy-risks",
        "title": "Inadequate Consideration of Privacy Risk Types",
        "description": "The BSI notes: 'If one or more risk types are not considered or not sufficiently differentiated, there is a danger that the informational self-determination of the affected person cannot be guaranteed in a legally compliant manner.'",
        "impact": "Failure to adequately assess privacy risks for systems handling personal data can lead to violations of data subjects' rights, resulting in significant legal penalties (e.g., GDPR fines), reputational damage, and loss of customer trust. It may lead to a formal data breach if sensitive information is exposed or misused.",
        "action": "Conduct a Data Protection Impact Assessment (DPIA)",
        "mitigation": "For all components processing personal or sensitive data, conduct and document a Data Protection Impact Assessment (DPIA). This process should go beyond standard threat modeling to explicitly identify and evaluate risks to data subjects' rights and freedoms. Ensure the principles of Privacy by Design and by Default are implemented. Consider the use of Privacy-Enhancing Technologies (PETs) like anonymization, pseudonymization, or data minimization.",
        "check": "Is there a documented DPIA for systems processing personal data? Does the risk inventory for these systems consider privacy-specific threats? Have data minimization and purpose limitation principles been applied?",
        "asvs": "Derived from the principles of GDPR Article 35 (Data Protection Impact Assessment - DPIA), which requires assessing risks to the rights and freedoms of natural persons.",
        "cheatSheet": "https://www.enisa.europa.eu/publications/data-protection-engineering",
        "detectionLogic": "This rule heuristically identifies technical assets that handle highly sensitive data (based on confidentiality rating or @DataType:PII tags) but have a surprisingly low number of identified risks or only low-severity risks. This suggests that the specific, often complex, privacy risks associated with the data might have been overlooked during the threat modeling process.",
        "riskAssessment": "The likelihood of this governance failure is considered high if a component processes sensitive personal data without a corresponding high-severity risk being identified, suggesting an incomplete analysis. The impact is directly proportional to the sensitivity and quantity of the personal data being processed, as this determines the potential harm to data subjects and the legal liability for the organization.",
        "falsePositives": "A system might be genuinely well-designed and secure, resulting in few identified risks. This risk is intended to trigger a manual verification: 'Have we performed a dedicated privacy risk assessment for this component?' The model might not capture all organizational controls (like a completed offline DPIA).",
        "cwe": "359",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "24_sec6.ts",
        "bsiCode": "CON.2",
        "id": "non-compliant-data-processing-purpose-limitation",
        "title": "Non-Compliant Data Processing (Purpose Limitation & Transparency)",
        "description": "Processing of personal data is non-compliant when purposes are undefined, overstretched, or detached from the original lawful basis (GDPR Art. 5). This includes opaque processing or missing integrity safeguards, particularly where auxiliary/dev/monitoring systems touch production data without a documented, legitimate purpose.",
        "impact": "Violations can trigger regulatory penalties (e.g., GDPR), damages, loss of trust, and misuse of sensitive data. Impact grows with the data’s confidentiality and integrity requirements and with the distance between the system’s purpose and the data’s intended use.",
        "action": "Document lawful purposes and enforce technical purpose limitation",
        "mitigation": "Define and record specific, explicit, legitimate purposes per data asset (e.g., in RoPA/DPIA). Enforce least-privilege and purpose-bound access paths so that auxiliary/dev/monitoring tools cannot process production personal data by default. Minimize, pseudonymize, or use synthetic/test data for non-production uses. Regularly review data flows to prevent purpose creep and revoke unused accesses.",
        "check": "Is each data asset’s purpose documented and linked to a legal basis? Are auxiliary/dev/monitoring tools prevented (by design) from accessing production personal data? Are RoPA/DPIA entries current, and are logging/monitoring controls transparent and justified? Is there periodic review for purpose creep and non-essential data access?",
        "asvs": "Derived from GDPR Article 5(1)(b) 'Purpose Limitation' and related principles of lawfulness, fairness, transparency, and integrity.",
        "cheatSheet": "https://gdpr-info.eu/art-5-gdpr/",
        "detectionLogic": "Flag technical assets with auxiliary, development, or monitoring functions that process or store sensitive or business-critical data assets. The rule considers technology hints (development relevance or tolerance of unnecessary data) and data attributes (confidentiality/integrity). Likelihood increases when modeled data flows show these assets handling production or business-usage data.",
        "riskAssessment": "Impact scales with confidentiality/integrity of the involved data: high for strictly confidential or critical integrity data, medium for restricted/important, low otherwise. Likelihood is set to 'Likely' when the model shows auxiliary/dev/monitoring assets processing such data, indicating an architectural pattern that may breach purpose limitation.",
        "falsePositives": "May be acceptable where a documented legal basis and technical safeguards exist (e.g., authorized security inspection of sensitive streams, tightly scoped troubleshooting with pseudonymized data, or synthetic data in non-production). Mark as false positive only with clear justification in RoPA/DPIA and access logs.",
        "cwe": "840",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "24_sec7.ts",
        "bsiCode": "CON.2",
        "id": "inherent-risk-of-processing-personal-data",
        "title": "Inherent Risk of Processing Personal Data (based on BSI Data Protection View)",
        "description": "From a data protection perspective, any institution that processes personal data (e.g., collects, stores, transmits, or deletes) fundamentally represents a risk to the affected data subjects. This risk is inherent to the act of data processing itself and exists even if all operations are designed to be legally compliant (e.g., under GDPR). It is the baseline risk that security measures aim to manage and mitigate.",
        "impact": "Should this inherent risk materialize into a data breach, the compromise of personal data can lead to significant harm for individuals, including identity theft, financial loss, discrimination, and reputational damage. For the institution, consequences can include severe legal penalties, loss of customer trust, and major financial repercussions.",
        "action": "Acknowledge, Manage, and Minimize Inherent Data Processing Risk",
        "mitigation": "While this inherent risk cannot be entirely eliminated, it must be managed by implementing a multi-layered 'Defense-in-Depth' security strategy. This includes robust Technical and Organizational Measures (TOMs), conducting Data Protection Impact Assessments (DPIAs) for high-risk processing, and strictly adhering to principles of data minimization and purpose limitation. The goal is to continuously reduce the likelihood and potential impact of this inherent risk materializing into an actual data breach. Every other identified and mitigated risk contributes to managing this fundamental risk.",
        "check": "Does the organization acknowledge the inherent risks of processing personal data? Are Data Protection Impact Assessments (DPIAs) performed where required? Are principles like data minimization and 'privacy by design' actively followed? Is there a comprehensive and effective security program in place to protect the data throughout its lifecycle?",
        "asvs": "This concept is a foundational principle of data protection frameworks like the GDPR (Arts. 5, 24, 25, 32) and is not covered by a single ASVS item. It relates to the overall responsibility of the data controller.",
        "cheatSheet": "https://gdpr-info.eu/art-5-gdpr/",
        "detectionLogic": "This risk is generated for any technical asset that processes or stores data assets classified with high sensitivity (i.e., 'Confidential' or 'Strictly-Confidential'). This classification serves as a proxy for identifying the processing of personal or otherwise sensitive data, which carries inherent risk.",
        "riskAssessment": "The likelihood is considered 'Likely' because the risk is an intrinsic and ever-present consequence of handling sensitive data. The impact is directly proportional to the confidentiality level and quantity of the data being processed or stored. Processing large volumes of 'Strictly Confidential' data results in a 'Very High' impact.",
        "falsePositives": "This risk can only be considered a 'false positive' if a data asset has been misclassified as 'Confidential' or 'Strictly-Confidential' but does not, in fact, contain personal or sensitive data. Otherwise, it represents a fundamental risk that should be acknowledged.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "24_sec8.ts",
        "bsiCode": "CON.2",
        "id": "data-access-beyond-original-purpose",
        "title": "Unauthorized Data Access Beyond Original Purpose",
        "description": "A frequently occurring risk in practice is access to data that does not serve the purpose of the original data processing.",
        "impact": "Accessing data beyond its intended and legally justified purpose can lead to severe data privacy violations (such as personal data/PII), resulting in significant fines, reputational damage, and loss of customer trust. It directly compromises the confidentiality and integrity of the data assets involved.",
        "action": "Enforce Purpose Limitation and Strict Access Control",
        "mitigation": "Implement strict, role-based access controls based on the principle of least privilege ('need-to-know').",
        "check": "Is there a documented inventory of data processing purposes? Are all data flows, especially to external entities or across different usage contexts (Business, DevOps), justified by a documented purpose and legal basis? Is access to sensitive data logged and audited for anomalies?",
        "asvs": "ASVS V13.1 (Data Protection)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/GDPR_Compliance_Cheat_Sheet.html",
        "detectionLogic": "This rule identifies communication links where data flows between different contexts, which indicates a potential for purpose violation.",
        "riskAssessment": "The impact is determined by the sensitivity (confidentiality and integrity) of the data being transferred. The higher the sensitivity, the higher the impact of a purpose violation.",
        "falsePositives": "Legitimate and well-documented data transfers to partners or service providers might be flagged.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "24_sec9.ts",
        "bsiCode": "CON.2",
        "id": "lack-of-standardized-process-for-third-party-access",
        "title": "Lack of Standardized Process for Third-Party Access",
        "description": "A risk exists for both individuals and the responsible institution if there are no standard processes for legitimate access to IT services or data transmission by third parties. The risk is compounded if the legitimacy of these actions cannot be proven through logs and documentation.",
        "impact": "This can lead to unauthorized or untraceable access, making it impossible to hold third parties accountable for their actions. It facilitates Repudiation, where a third party can deny their actions. This may result in data breaches, unauthorized modifications, or service disruption, with significant legal, financial, and reputational consequences.",
        "action": "Define and Enforce Standard Access Procedures for Third Parties",
        "mitigation": "Establish clear, documented procedures for granting, monitoring, and revoking third-party access. All communication links from external entities must enforce strong authentication (e.g., tokens, client certificates) and authorization. Ensure that all access is logged with sufficient detail to provide an audit trail, identifying the external entity, the time of access, and the actions performed. Consider using VPN or strict IP filtering as compensating controls.",
        "check": "Is there a documented process for third-party access? Do all communication links from external entities require authentication and authorization? Are access logs generated and regularly reviewed?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Supplier management), specifically requirements like ORP.2.A5 (Defining and implementing rules for information exchange) and ORP.2.A8 (Monitoring, reviewing, and auditing supplier services).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Supplier_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is detected by analyzing communication links originating from an 'External-Entity'. The rule checks for links that lack proper authentication (i.e., 'none') and authorization (i.e., 'none'). The risk is associated with the internal asset being accessed. Links with VPN or IP filtering are considered mitigated for this rule.",
        "riskAssessment": "Likelihood is high if no authentication is used. Impact depends on the sensitivity (CIA ratings) of the data assets being transferred and the criticality of the target technical asset. Access to mission-critical systems or strictly-confidential data without auditable proof is a high-impact event.",
        "falsePositives": "The risk may be a false positive if compensating controls exist outside the model that are not documented on the communication link itself.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "CON.3": [
      {
        "file": "25_sec1.ts",
        "bsiCode": "CON.3",
        "id": "data-loss-without-@Backup:Target",
        "title": "Risk of Permanent Data Loss due to Missing @Backup:Target Strategy (BSI)",
        "description": "If data is lost and it was not backed up beforehand, this can have existential consequences for an institution.",
        "impact": "The permanent loss of data compromises its Availability and Integrity. Depending on the criticality of the affected data, this can",
        "action": "Implement a Resilient @Backup:Target and Recovery Strategy",
        "mitigation": "Implement a comprehensive data @Backup:Target and recovery strategy for all critical systems storing data.",
        "check": "Is there a documented and regularly tested @Backup:Target and recovery plan for the asset? Are backups stored in a separate, secure location?",
        "asvs": "BSI IT-Grundschutz CON.3 (Data @Backup:Target Concept). While not a direct OWASP ASVS item, this aligns with general principles of operational resilience and data protection.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2022.pdf?__blob=publicationFile (BSI CON.3)",
        "detectionLogic": "This rule identifies technical assets that typically store significant data (e.g., databases, file servers, data lakes)",
        "riskAssessment": "The likelihood of an event causing data loss (e.g., hardware failure, human error, malware) is considered 'Likely' over the lifecycle of any system.",
        "falsePositives": "A @Backup:Target and recovery strategy might exist for the asset, but it has not been documented in the model using the '@Backup:Target:resilient' tag.",
        "cwe": "1189",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "25_sec10.ts",
        "bsiCode": "CON.3",
        "id": "ransomware-attack",
        "title": "Ransomware Attack (BSI OPS.1.1.5)",
        "description": "A specialized form of malware is ransomware, which encrypts data on infected IT systems. After encryption, a ransom is demanded for the victim to be able to decrypt the data.",
        "impact": "If this risk is exploited, data on affected systems will be encrypted and become unavailable, leading to a massive disruption of business and IT operations.",
        "action": "Implement Multi-Layered Ransomware Defense",
        "mitigation": "Implement a robust, multi-layered defense strategy. This includes: 1. Maintaining regular, automated, and tested backups. 2. Ensuring that primary @Backup:Target copies are stored offline, air-gapped, or in immutable storage, making them inaccessible to ransomware spreading across the network.",
        "check": "Are backups regularly created and tested? Are the @Backup:Target datastores protected from write access from the regular network (i.e., offline or immutable)? Are file share permissions on datastores reviewed and restricted based on the principle of least privilege?",
        "asvs": "BSI IT-Grundschutz Baustein OPS.1.1.5 Malicious Code Protection (related to Threat T 5.143 Ransomware)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Malicious_code_protection_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks for datastores that have incoming communication links which are not 'readonly'. Such a configuration allows a potentially compromised source asset to write to the datastore, which is the primary mechanism for ransomware to encrypt data on network shares and backups.",
        "riskAssessment": "The likelihood of a successful attack is significantly increased if the writeable connection originates from a client-type asset (e.g., desktop, browser), as these are common initial infection vectors.",
        "falsePositives": "This risk can be a false positive if write access is strictly controlled by other mechanisms not modeled in Threagile (e.g., application-level logic, specific OS-level user permissions) or if the source system is exceptionally hardened and isolated.",
        "cwe": "732",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "25_sec2.ts",
        "bsiCode": "CON.3",
        "id": "untested-backups",
        "title": "Untested Backups Leading to Restore Failure (BSI CON.3)",
        "description": "If data is backed up regularly, this does not automatically guarantee that it can be restored without issues.",
        "impact": "Failure to restore from backups leads to a loss of data availability and potentially integrity. This can disrupt business operations,",
        "action": "Implement and regularly test a backup and recovery procedure",
        "mitigation": "Establish a formal backup and recovery plan for all critical systems. Regularly test the restore process for critical data stores to ensure data integrity and timeliness of recovery.",
        "check": "Is there a documented backup and recovery plan? Are restore procedures tested on a regular schedule? Are the results of these tests documented and reviewed? Can the team demonstrate a successful restore from a recent backup?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein CON.3: Datensicherungskonzept.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Contingency_Management_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for technical assets that store data (e.g., type 'datastore' or technologies like 'database', 'file-server')",
        "riskAssessment": "The impact is directly proportional to the Availability and Integrity requirements of the asset and the data it stores. A datastore for 'Mission-Critical' data faces a 'Very High' impact.",
        "falsePositives": "This risk may be a false positive if recovery testing is performed but not documented in the threat model via the '@Recovery:Tested' tag.",
        "cwe": "754",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "25_sec3.ts",
        "bsiCode": "CON.3",
        "id": "unsafe-storage-of-@Backup:Target-media",
        "title": "Unsafe Storage of @Backup:Target Media",
        "description": "@Backup:Target media, whether traditional tapes or modern storage systems, contain sensitive information.",
        "impact": "Compromise of @Backup:Target media can lead to severe breaches of Confidentiality (data theft), Integrity (data manipulation), and Availability (data loss).",
        "action": "Ensure Secure Physical and Environmental Storage for @Backup:Target Media",
        "mitigation": "Store all @Backup:Target media in a secure, access-controlled location (e.g., a locked room, a fire-proof safe).",
        "check": "Are @Backup:Target media stored in a locked, environmentally controlled, and access-restricted location? Is the data on the @Backup:Target media encrypted? Is there a documented policy for handling, storing, and transporting @Backup:Target media?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium, specifically Baustein OPS.1.1.4 (Datensicherung). This addresses threats like G 0.25 (Theft of devices or data carriers) and G 0.14 (Failure of backup media), and relates to requirements like OPS.1.1.4.A7 (Protection of @Backup:Target media against unauthorized access) and OPS.1.1.4.A8 (Proper storage of @Backup:Target media).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_4_Data_backup_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is automatically raised for any technical asset of type 'datastore' that is tagged with `@Backup:Target`.",
        "riskAssessment": "The impact of this risk is calculated based on the highest Confidentiality, Integrity, and Availability ratings of the data stored on the @Backup:Target asset.",
        "falsePositives": "This risk can be considered a false positive if the asset, despite being tagged, is already subject to robust physical and environmental controls that meet or exceed the mitigation requirements. Such controls are outside the scope of a typical threat model and must be confirmed through an audit or review of operational procedures.",
        "cwe": "530",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "25_sec4.ts",
        "bsiCode": "CON.3",
        "id": "inadequate-backup-and-recovery-documentation-con3",
        "title": "Inadequate Backup and Recovery Documentation (BSI CON.3)",
        "description": "If data backups and especially recovery measures are not, or are only inadequately, documented, this can significantly delay restoration after an incident like a hardware failure or ransomware attack.",
        "impact": "Failure to restore systems in a timely manner due to poor or inaccessible documentation directly impacts business continuity. It can cause significant financial loss from operational downtime, reputational damage, and permanent loss of critical or sensitive data, which violates integrity and availability principles.",
        "action": "Establish, document, and regularly test a recovery plan",
        "mitigation": "Create a detailed and clear recovery plan for all critical data-storing assets. This documentation should be tested regularly via recovery drills to ensure its accuracy and effectiveness.",
        "check": "Is there a documented recovery plan for the asset? Is it regularly tested? Is a copy stored securely offline and accessible in a disaster scenario?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Backup and Recovery Concept), specifically requirements CON.3.A5 (Recovery tests) and CON.3.A6 (Documentation of data backups).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Datensicherungskonzept_Edition_2023.pdf?__blob=publicationFile (German BSI CON.3)",
        "detectionLogic": "This rule targets in-scope technical assets that are of type 'datastore' or use technologies typically meant for storing data (e.g., databases, file servers).",
        "riskAssessment": "The impact is determined by the availability and integrity rating of the affected asset and its data. An asset with 'mission-critical' data will result in a 'very-high' impact risk.",
        "falsePositives": "A recovery plan might exist but may not be tagged in the model. This rule serves to highlight the absence of this assertion in the model, prompting verification.",
        "cwe": "755 // CWE-755: Improper Handling of Exceptional Conditions (a disaster recovery scenario is an exceptional condition)",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "25_sec5.ts",
        "bsiCode": "CON.3",
        "id": "non-compliance-in-data-@Backup:Target-con3",
        "title": "Non-Compliance with Legal Requirements in Data @Backup:Target (BSI CON.3)",
        "description": "If legal and regulatory requirements (e.g., @DataType:PII, industry-specific data protection laws) are not observed during the data @Backup:Target process, the organization is exposed to significant risks. This includes failing to apply necessary security controls like encryption, access control, and defined retention policies to @Backup:Target data. An unencrypted @Backup:Target of sensitive data is a direct violation of the security principles mandated by most data protection laws.",
        "impact": "Failure to comply with legal requirements for data backups can lead to severe consequences. Regulators can impose heavy fines, and affected parties may file for damages. This can result in significant financial loss, legal battles, and severe reputational damage. Furthermore, improperly secured backups are a prime target for attackers, and their compromise can lead to a major data breach, violating the confidentiality and integrity of sensitive information.",
        "action": "Ensure @Backup:Target Strategy Complies with Legal and Regulatory Requirements",
        "mitigation": "The data @Backup:Target strategy must incorporate all applicable legal, regulatory, and contractual requirements. Sensitive data within backups must be protected by strong encryption at rest. Access to @Backup:Target media and systems must be strictly controlled and logged. Implement and enforce data retention and deletion policies for backups to ensure data is not kept longer than necessary. Regularly test the @Backup:Target and restore process to verify both technical functionality and compliance.",
        "check": "Are all legal requirements for data backups identified and documented? Are backups containing sensitive data encrypted at rest? Are access controls for backups strictly enforced and audited? Are there defined and enforced retention/deletion policies for backups?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Data @Backup:Target Concept)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies datastore assets that appear to be used for backups but lack encryption. A @Backup:Target is identified by the '@Backup:Target' tag, or heuristically by having an 'archive' integrity rating. The risk is raised if such an asset stores sensitive data (Restricted/Important or higher) and has its encryption property set to 'none'.",
        "riskAssessment": "The impact is directly rated based on the highest sensitivity (confidentiality and integrity) of the data stored in the @Backup:Target. The likelihood is considered high because the absence of a fundamental control like encryption on a @Backup:Target of sensitive data makes a compliance violation and a potential data breach very likely.",
        "falsePositives": "An asset might be misidentified as a @Backup:Target if it has an 'archive' rating for other reasons. The most reliable method is to use the '@Backup:Target' tag. The risk might also be a false positive if encryption is handled by an underlying platform in a way not visible to the model (e.g., full-disk encryption on the host).",
        "cwe": "311",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "25_sec6.ts",
        "bsiCode": "CON.3",
        "id": "risk-outsourced-@Backup:Target",
        "title": "Risks of Outsourced Data Backups (BSI-based)",
        "description": "When data backups are outsourced to a third-party institution, attacks on the provider can affect the organization's own data, leading to data leakage (Confidentiality breach).",
        "impact": "A confidentiality breach at the @Backup:Target provider can lead to the exposure of sensitive or critical data. An availability failure can lead to extended downtime during a recovery scenario, impacting business continuity and potentially causing mission failure if data is permanently lost.",
        "action": "Secure and Verify Outsourced @Backup:Target Solution and Contracts",
        "mitigation": "For Confidentiality: Ensure data is encrypted *before* being sent to the provider (client-side encryption) and is also stored encrypted-at-rest by the provider. Use strong, unique encryption keys managed by the organization. Vet the provider's security posture, certifications (e.g., ISO 27001), and contractual obligations regarding data protection. In the model, the target asset's `encryption` should be set to a form of `data-with...-key`.",
        "check": "Is data encrypted in transit and at rest at the @Backup:Target provider? Does the organization control the encryption keys? Are there contractually defined RTO/RPO SLAs? Are restore procedures tested regularly? Is the provider's infrastructure redundant?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein CON.1 (Redundancy), particularly the requirement for analyzing dependencies on external providers (CON.1.A5) and ensuring information for restoration is available (CON.1.A11).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Redundancy_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies communication links that appear to be sending backups to an external entity. It triggers on data flows from an in-scope asset to a `datastore` or `external-entity` across a network trust boundary. The risk is significantly higher if the data has high CIA requirements and mitigations like at-rest encryption or redundancy on the target asset are not modeled.",
        "riskAssessment": "The impact is derived directly from the Confidentiality and Availability ratings of the data assets being backed up. A high impact is assigned for 'confidential'/'critical' data, and a very high impact for 'strictly-confidential'/'mission-critical' data. The likelihood is considered 'likely' by default due to the inherent risks of outsourcing, but is reduced to 'unlikely' if specific mitigations (like data-level encryption for confidentiality or redundancy for availability) are modeled.",
        "falsePositives": "A generic 'External Entity' in the model might represent a highly secure, certified provider in reality, making the generated risk seem higher than it is. The model also cannot verify contractual SLAs. This risk should always prompt a manual review of the provider's contract and security posture.",
        "cwe": "200 // CWE-200: Exposure of Sensitive Information to an Unauthorized Actor. Also relates to CWE-400 (DoS) for the availability part.",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "25_sec7.ts",
        "bsiCode": "CON.3",
        "id": "insufficient-@Backup:Target-storage-capacity",
        "title": "Insufficient Backup Storage Capacity (BSI CON.3.G5)",
        "description": "If storage media for data backups lack sufficient free capacity, recent data may not be backed up.",
        "impact": "This can lead to a partial or complete loss of data integrity and availability. In a recovery scenario, the inability to restore",
        "action": "Implement Capacity Planning and Monitoring for Backup Storage",
        "mitigation": "Implement robust capacity planning and monitoring for all backup storage systems. Configure monitoring to send alerts when capacity reaches predefined thresholds (e.g., 80%, 90%).",
        "check": "Is there active capacity monitoring for backup datastores? Are alerting mechanisms in place for low storage capacity? Is there a documented process for handling capacity alerts and managing data retention on backup media?",
        "asvs": "BSI IT-Grundschutz CON.3 Data Backup Concept",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for datastore assets tagged with `@Backup:Target`. The risk is considered higher if the asset is not connected to a 'Monitoring' component.",
        "riskAssessment": "The likelihood is high if no monitoring is in place to warn about capacity limits. The impact depends on the availability and integrity requirements of the data being backed up.",
        "falsePositives": "A risk might be generated for a datastore that is monitored by an external system not represented in the model. This risk is primarily organizational and operational, and its actual status depends on implemented monitoring processes.",
        "cwe": "755",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "25_sec8.ts",
        "bsiCode": "CON.3",
        "id": "inadequate-data-@Backup:Target-concept-con3",
        "title": "Inadequate Data @Backup:Target Concept (BSI CON.3)",
        "description": "If an adequate concept for data @Backup:Target measures is not created, the technical requirements of the affected business processes may be overlooked.",
        "impact": "Failure to restore data from backups due to an inadequate concept can lead to severe business disruption, permanent data loss, and failure to meet business, legal, and contractual obligations.",
        "action": "Develop, Implement, and Test a Robust Data @Backup:Target and Recovery Concept",
        "mitigation": "Establish a comprehensive @Backup:Target and recovery concept that meets business requirements for Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).",
        "check": "Is there a documented @Backup:Target concept? Are RTOs/RPOs defined and met? Are encrypted backups used? If so, where are the decryption keys stored? Is the key store isolated from the primary systems? Are restore procedures regularly and successfully tested?",
        "asvs": "BSI IT-Grundschutz-Kompendium: CON.3 Datensicherungskonzept (@Backup:Target and Recovery Concept)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Backup_and_recovery_concept_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks for critical flaws in the modeled @Backup:Target strategy, focusing on key management for encrypted backups.",
        "riskAssessment": "The likelihood is considered 'Likely' if a configuration is found where @Backup:Target keys are potentially co-located with source data, as this is a common and serious oversight.",
        "falsePositives": "The rule assumes that a key management system (like a Vault) located in the same trust boundary as a data source might store the keys for that source's @Backup:Target.",
        "cwe": "522",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "25_sec9.ts",
        "bsiCode": "CON.3",
        "id": "@Backup:Target-process-time-exceeds-window",
        "title": "@Backup:Target Process Time Exceeds Allotted Window (BSI CON.1)",
        "description": "In addition to the storage space required for data @Backup:Target, the time required to perform a data @Backup:Target also increases with data volume.",
        "impact": "If @Backup:Target jobs are incomplete or the @Backup:Target system fails, the ability to restore data is severely compromised. This directly threatens the integrity and availability of business-critical information in a disaster recovery scenario, potentially leading to significant data loss and extended downtime.",
        "action": "Review and Optimize @Backup:Target Strategy and Resources",
        "mitigation": "Regularly monitor @Backup:Target job runtimes and set alerts for when they approach the @Backup:Target window limit.",
        "check": "Are @Backup:Target job runtimes continuously monitored? Is there a clearly defined and respected @Backup:Target window? Does the @Backup:Target strategy account for data growth? Are regular data cleanup or archiving processes in place?",
        "asvs": "BSI IT-Grundschutz CON.1: Data @Backup:Target concept",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Data_backup_concept_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for data stores that hold a large quantity of data. The assumption is that any data store is subject to some form of @Backup:Target procedure.",
        "riskAssessment": "The likelihood of this risk materializing increases with the quantity of data stored. A 'very-many' quantity suggests a 'very-likely' chance of extended @Backup:Target times, while a 'many' quantity suggests a 'likely' chance.",
        "falsePositives": "The model does not know the specific @Backup:Target strategy (e.g., incremental backups might be very fast) or the performance of the @Backup:Target infrastructure. An organization might have a powerful @Backup:Target system and a large time window, which would mitigate this risk.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "CON.6": [
      {
        "file": "26_sec1.ts",
        "bsiCode": "CON.6",
        "id": "insecure-data-deletion-con8",
        "title": "Insecure Deletion of Information and Data Carriers (BSI CON.8)",
        "description": "If there are no secure processes and procedures for deleting and destroying information and data carriers, or if they are not applied correctly, it is not guaranteed that confidential information will be securely deleted or destroyed. It is therefore impossible to predict where this information will remain and whether it will be accessible to third parties. This risk is particularly high for digital data carriers and IT systems that are to be decommissioned, as it is not always immediately apparent what (residual) information is on them. This information could be read by unauthorized third parties. If this involves particularly sensitive information, such as personal data requiring special protection under Article 9 of the GDPR or trade secrets, this can result in heavy fines.",
        "impact": "Failure to securely delete data from decommissioned assets can lead to data remanence, where sensitive information is left accessible to unauthorized individuals who gain access to the hardware. This directly compromises confidentiality and can lead to severe data breaches, regulatory fines (e.g., under GDPR), loss of trade secrets, and significant reputational damage.",
        "action": "Establish and Enforce Secure Deletion Procedures",
        "mitigation": "Define and implement a formal policy for the secure deletion and destruction of data and data carriers. The policy should specify different procedures based on data classification and media type (e.g., cryptographic erasure for SSDs, multi-pass overwriting for HDDs, physical destruction for highly sensitive data or damaged media). Maintain a documented chain of custody for all media designated for disposal or reuse. Ensure personnel are trained on these procedures. Use the '@Deletion:secure-process-defined' tag on assets for which such a process is in place and audited.",
        "check": "Is there a documented policy for data deletion and media destruction? Are the methods used compliant with standards like NIST SP 800-88? Is there an inventory of decommissioned assets and proof of their secure sanitization or destruction?",
        "asvs": "BSI IT-Grundschutz Baustein CON.8 (Löschen und Vernichten)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_8_Loeschen_und_Vernichten_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all in-scope technical assets that store data (i.e., asset type is 'datastore', technology is a storage type, or the asset has 'data_assets_stored'). The risk is considered mitigated if the asset is tagged with '@Deletion:secure-process-defined'.",
        "riskAssessment": "The impact of this risk is directly proportional to the confidentiality of the data stored on the asset. A higher confidentiality level results in a higher impact. The likelihood is considered 'Likely' by default, assuming that without a specific, enforced process, insecure or incomplete deletion methods will be used. A data breach is considered 'Probable' if confidential or strictly confidential data is involved.",
        "falsePositives": "This risk might be a false positive if a robust, organization-wide decommissioning and data destruction process exists but is not explicitly modeled with a tag on the specific asset. The model cannot verify physical off-band processes.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "26_sec2.ts",
        "bsiCode": "CON.6",
        "id": "insecure-data-deletion-con6",
        "title": "Insecure Data Deletion (BSI CON.6)",
        "description": "Most applications and operating systems do not securely and irreversibly delete files by default.",
        "impact": "If data is not securely deleted, sensitive information such as passwords, cryptographic keys, and confidential data can be accessed by unauthorized individuals.",
        "action": "Implement and Enforce Secure Deletion Policies and Tools",
        "mitigation": "Use specialized tools to securely wipe data from media before disposal or repurposing.",
        "check": "Are secure deletion methods (e.g., data shredding software) used for all data carriers before disposal or transfer? Is full-disk encryption enabled on assets storing sensitive data? Are temporary files and swap partitions configured to be wiped on shutdown?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Deletion and Destruction), specifically Requirement CON.6.A1 (Rules for secure deletion and destruction).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Deletion_and_destruction_edition_2023.pdf?__blob=publicationFile (BSI CON.6)",
        "detectionLogic": "This rule triggers on all in-scope technical assets that are of a type that stores data (e.g., datastores, file systems, clients) or are modeled to store data assets.",
        "riskAssessment": "The likelihood of this vulnerability being present is high by default on most standard systems. The likelihood of exploitation depends on the asset's lifecycle (e.g., disposal, theft).",
        "falsePositives": "The risk might be a false positive if secure deletion is handled by platform-level controls modeled in detail (e.g., a cloud provider's physical media destruction policy for which the user has contractual guarantees).",
        "cwe": "212",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "26_sec3.ts",
        "bsiCode": "CON.6",
        "id": "improper-media-sanitization-by-supplier",
        "title": "Improper Media Sanitization by External Service Provider (BSI CON.8, DER.1)",
        "description": "When data media (e.g., datastores, hard drives) are deleted or destroyed by external service providers, the information contained on them can be disclosed if the process for involving the service provider is not sufficiently regulated and secured.",
        "impact": "Failure to properly sanitize media before disposal or transfer to an external party can lead to the disclosure of all data stored on it. This can result in a severe breach of confidentiality, leading to reputational damage, financial loss, and legal or regulatory penalties, especially if sensitive personal or business data is involved.",
        "action": "Establish and Enforce Secure Media Sanitization Procedures with Third Parties",
        "mitigation": "Implement a robust, contractually-enforced process for media sanitization and destruction with external service providers. This must include clear responsibilities, secure transport and storage of media, defined sanitization methods (e.g., compliant with NIST SP 800-88), and a requirement for the provider to issue a verifiable certificate of destruction for each item. The process should be audited periodically.",
        "check": "Are there formal contracts with external service providers that explicitly detail secure media sanitization and destruction requirements? Is there a documented process for handling, transporting, and verifying the destruction of media? Are certificates of destruction collected and archived?",
        "asvs": "Derived from BSI IT-Grundschutz Bausteine CON.8 (Deletion and Destruction) and DER.1 (General Service Provider Management).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Deletion_and_destruction_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any 'datastore' asset that has a communication link to an 'external-entity' asset, which represents an external service provider. The assumption is that such a link might be used for management or decommissioning activities. The risk is heightened if the datastore contains highly sensitive data.",
        "riskAssessment": "The impact is determined by the highest confidentiality and integrity of the data stored on the asset. The likelihood is considered 'likely' if a data transfer or management connection to an external entity exists without explicit modeling of security controls for media disposal (which is the default assumption).",
        "falsePositives": "This risk can be a false positive if the communication link is used for purposes completely unrelated to system or data lifecycle management (e.g., only consuming a public API from the external entity). It is also a false positive if a robust, audited, and contractually-obligated deletion process exists, which cannot be fully represented in the threat model.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "26_sec4.ts",
        "bsiCode": "CON.6",
        "id": "improper-media-disposal-or-repair",
        "title": "Improper Disposal or Handling of Defective Data Media",
        "description": "If defective data carriers or IT devices are disposed of or sent for repair without the data on them having been securely erased or destroyed, the data could be disclosed during the disposal or repair process.",
        "impact": "The unauthorized disclosure of sensitive information stored on the media. This constitutes a confidentiality breach and can lead to non-compliance with legal or contractual requirements,",
        "action": "Establish and Enforce a Secure Media Sanitization and Disposal Policy",
        "mitigation": "Implement a formal policy for handling defective or end-of-life data media that contain sensitive information.",
        "check": "Is there a documented and enforced policy for handling defective or end-of-life data media? Are personnel trained on this policy?",
        "asvs": "V14.3.1 (Verify that all sensitive data is securely erased when it is no longer needed.)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for data stores on physical or virtual machines that handle sensitive data. The risk is considered mitigated if the asset is tagged with '@Mitigation:SecureMediaDisposalProcess'.",
        "riskAssessment": "The impact is determined by the highest confidentiality and integrity of the data stored on the asset.",
        "falsePositives": "This risk can be a false positive if a robust, enforced disposal process exists but is documented in the threat model via the mitigation tag.",
        "cwe": "459",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "CON.7": [
      {
        "file": "27_sec1.ts",
        "bsiCode": "CON.7",
        "id": "espionage-during-foreign-travel",
        "title": "Espionage During Foreign Travel (BSI Threat)",
        "description": "Espionage refers to attacks aimed at collecting, evaluating, and processing information about institutions, individuals, or products.",
        "impact": "Successful espionage during foreign travel leads to a breach of confidentiality and integrity of sensitive data.",
        "action": "Implement Secure Travel Policies and Device Hardening",
        "mitigation": "Establish a clear information security policy for foreign travel. Use dedicated, hardened 'travel devices' with minimal necessary data and applications.",
        "check": "Is there a security policy for foreign travel? Are employees trained on these risks? Are portable devices used for travel hardened and encrypted?",
        "asvs": "This threat scenario is described by the BSI IT-Grundschutz Compendium but does not map to a single Baustein. It's a cross-cutting threat ('Gefährdung') relevant to assets used outside of controlled environments.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/scenarios/sg_3_2_mobile_working_and_teleworking_edition_2023.pdf?__blob=publicationFile (Related BSI Scenario)",
        "detectionLogic": "This risk is triggered for portable technical assets (e.g., laptops, mobile phones) tagged as being used for foreign travel.",
        "riskAssessment": "The likelihood of an espionage attempt is considered likely for any international travel, especially when high-value data is involved.",
        "falsePositives": "The risk might be considered a false positive if the travel is to a demonstrably low-risk country and no sensitive data is on the device.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "27_sec2.ts",
        "bsiCode": "CON.7",
        "id": "unsafe-handling-of-information-during-travel",
        "title": "Unsafe Handling of Information during Business Travel (BSI CON.1-Scenario)",
        "description": "During business travel, there is an increased risk of unintentional disclosure or compromise of sensitive information.",
        "impact": "A compromise during travel can lead to the theft, manipulation, or destruction of data stored on the device, violating its Confidentiality and Integrity.",
        "action": "Implement Secure Travel Policies and Technical Controls",
        "mitigation": "Establish a clear security policy for business travel. Mandate the use of technical controls such as Full-Disk Encryption (FDE) for all travel devices.",
        "check": "Are all travel devices equipped with FDE? Is a corporate VPN enforced for remote connections?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Mobile Device Management), especially Requirement CON.1.A5 (Use of mobile devices in public spaces).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Mobile_device_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any in-scope client-type technical asset (e.g., laptop, mobile device)",
        "riskAssessment": "The likelihood of an incident is high if a travel device lacks basic controls like encryption. The impact is directly related to the",
        "falsePositives": "A model cannot confirm actual user behavior. An organization may have strong, enforced travel security policies that mitigate this risk in practice,",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "27_sec3.ts",
        "bsiCode": "CON.7",
        "id": "spoofing-in-untrusted-environments-con3",
        "title": "Spoofing and Identity Theft during Communication in Untrusted Environments (BSI CON.3)",
        "description": "During communication in untrusted environments (e.g., while traveling, in foreign facilities), there is an increased risk of identity theft and spoofing attacks.",
        "impact": "Successful spoofing or identity theft attacks can lead to the unauthorized disclosure of sensitive information and compromise data integrity.",
        "action": "Implement Strong Authentication and Encrypted Communication Channels",
        "mitigation": "All communication, especially across trust boundaries or from untrusted locations, must be protected by strong, end-to-end encryption (e.g., TLS 1.2+).",
        "check": "Are all communication links, especially those crossing trust boundaries, using encrypted protocols (e.g., HTTPS, SFTP, WSS)? Is strong, multi-factor, or certificate-based authentication used? Are assets used in high-risk locations explicitly managed with heightened security controls?",
        "asvs": "V4.1: Communication Security Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule checks all communication links. It flags links that cross a trust boundary without using both encryption and strong authentication.",
        "riskAssessment": "The likelihood of exploitation is high for unencrypted or non-authenticated communication across trust boundaries. The impact is determined by the sensitivity (Confidentiality and Integrity) of the data assets transmitted over the link. A link carrying 'Strictly Confidential' data without proper protection will result in a critical risk.",
        "falsePositives": "This risk might be a false positive if compensating controls exist outside the model, such as a mandatory, always-on corporate VPN that protects all traffic from a travel laptop, even if the direct link is modeled as HTTP.",
        "cwe": "295",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "27_sec5.ts",
        "bsiCode": "CON.7",
        "id": "risk-of-data-leakage-during-international-travel-con3",
        "title": "Risk of Data Leakage During International Travel (BSI CON.3)",
        "description": "When traveling abroad, personnel must consider differing laws and regulations at the destination, which can vary significantly from national laws.",
        "impact": "Failure to adhere to foreign legal requirements or to secure IT assets during international travel can lead to unauthorized access, data theft, or forced disclosure of sensitive information.",
        "action": "Implement Policies and Technical Controls for International Travel",
        "mitigation": "Establish a clear security policy for international travel. Technical assets used for travel must have full-disk encryption (FDE) enabled.",
        "check": "Is there a specific policy for international travel? Are mobile devices used for travel equipped with FDE and mandatory VPN?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Mobile Workplace), which addresses the protection of IT systems and data used outside the organization's premises.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_workplace_edition_2023.pdf?__blob=publicationFile (BSI CON.3)",
        "detectionLogic": "This risk is identified for any technical assets representing mobile or client systems (e.g., Laptops, Mobile Phones) that are tagged as being used for international travel.",
        "riskAssessment": "The likelihood of exploitation is considered high due to increased threats like unsecured networks, physical theft, or legal coercion at borders.",
        "falsePositives": "A risk might be considered a false positive if the organization can demonstrate robust, enforced technical controls and mandatory, destination-specific training for all international travel,",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "27_sec6.ts",
        "bsiCode": "CON.7",
        "id": "coercion-during-foreign-travel-con4",
        "title": "Coercion, Bribery, or Blackmail During Foreign Travel (BSI CON.4)",
        "description": "When traveling abroad, personnel may face elevated security risks due to varying political and social circumstances.",
        "impact": "Successful coercion or bribery of an employee can lead to the circumvention of established information security controls.",
        "action": "Develop and enforce a secure travel policy and provide pre-travel security briefings.",
        "mitigation": "Establish a comprehensive security policy for international travel. This policy should include pre-travel security briefings tailored to the destination's risk level.",
        "check": "Is there a formal security policy for international travel? Are employees, especially those in high-risk roles or traveling to high-risk destinations, given security briefings?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.4 (Dienstreisen und mobile Endgeräte / Business trips and mobile devices) and ORP.4 (Personal / Personnel).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_4_Dienstreisen_und_mobile_Endgeraete.pdf?__blob=publicationFile (BSI CON.4 German)",
        "detectionLogic": "This organizational and physical risk is detected by identifying technical assets likely used during international travel and associated with personnel in sensitive roles.",
        "riskAssessment": "Likelihood is considered HIGH if a sensitive role is traveling internationally, as they are a prime target. The potential for coercion is significant.",
        "falsePositives": "The risk might be lower if the travel is to a low-risk country or if the organization has strong, untracked compensating controls (e.g., rigorous real-world travel security protocols).",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "27_sec7.ts",
        "bsiCode": "CON.7",
        "id": "disinformation-during-business-travel-con-6-a22",
        "title": "Disinformation During Business Travel (BSI CON.6.A22)",
        "description": "During business travel abroad, personnel may be intentionally fed false or misleading information to deceive them.",
        "impact": "If deception is successful, false statements can be incorporated into business-critical reports and systems.",
        "action": "Implement Verification and Corroboration Procedures for Information Gathered Abroad",
        "mitigation": "Personnel traveling abroad must be trained on the risks of disinformation. Establish clear procedures for verifying and corroborating critical information gathered from external or untrusted sources during travel.",
        "check": "Are travelers aware of disinformation risks? Are there defined processes for validating information from untrusted sources abroad? Is there an approval or review step for critical data gathered during travel?",
        "asvs": "BSI IT-Grundschutz Kompendium: CON.6 Auslandseinsatz (Deployment in foreign countries), Requirement A22",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/con/con_6_auslandseinsatz.pdf?__blob=publicationFile (German)",
        "detectionLogic": "This risk is triggered for technical assets that process or store high-integrity data and are tagged as being used in a business travel context (e.g., via a `@Context:BusinessTravel` tag).",
        "riskAssessment": "The likelihood is considered 'Likely' given the targeted context of foreign travel where adversaries may operate with more freedom.",
        "falsePositives": "This risk can be considered a false positive if the asset, despite being used abroad, only consumes pre-vetted information from trusted internal sources and does not allow for the input of new, unverified information.",
        "cwe": "915",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.Tampering"
      }
    ],
    "CON.8": [
      {
        "file": "28_sec1.ts",
        "bsiCode": "CON.8",
        "id": "loss-or-theft-of-mobile-devices-con1",
        "title": "Loss or Theft of Mobile Devices (BSI CON.1)",
        "description": "Mobile devices, especially when used outside of secured company premises or while traveling, are highly susceptible to being lost or stolen. The smaller and more desirable the device, the higher the risk.",
        "impact": "The loss of a mobile device can lead to a breach of confidentiality if sensitive data is not adequately protected. This can result in financial loss, reputational damage to the institution, and violation of legal or contractual obligations (e.g., @DataType:PII).",
        "action": "Implement and Enforce Mobile Device Security Policies",
        "mitigation": "All mobile devices must have data-at-rest encryption enabled (e.g., full-disk encryption).",
        "check": "Are all mobile devices that handle company data managed by an MDM? Is data-at-rest encryption enforced?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Mobile device). Specifically relates to Threat G 0.14 (Loss of mobile IT systems).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Mobile_device_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
        "detectionLogic": "This risk is raised for all in-scope technical assets of technology 'mobile-app' or 'IoT-device'.",
        "riskAssessment": "The impact is determined by the highest sensitivity (Confidentiality, Integrity, and Availability) of the data assets processed or stored by the mobile device.",
        "falsePositives": "A device might be classified as mobile but used in a fixed, physically secure location (e.g., a tablet in a kiosk). In such cases, the risk of loss or theft might be significantly lower and could be considered a false positive or accepted with justification.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "28_sec2.ts",
        "bsiCode": "CON.8",
        "id": "unsuitable-development-environment",
        "title": "Unsuitable or Individual Development Environment",
        "description": "If an unsuitable development environment is used, or if employees choose their own environments individually,",
        "impact": "Using non-standardized or unsuitable development tools can inject vulnerabilities or defects into the final software product,",
        "action": "Standardize and Vet Development Toolchain",
        "mitigation": "Define a standardized, mandatory development and build environment (toolchain) for all custom-developed components.",
        "check": "Is there a defined, mandatory development toolchain for all developers? Are the tools within this toolchain vetted for security and kept up-to-date?",
        "asvs": "V14.3.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Secure_Software_Development_Lifecycle_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for in-scope technical assets marked as 'custom-developed parts'.",
        "riskAssessment": "The likelihood is considered high if the development process is modeled or if a component appears to be built outside the modeled process.",
        "falsePositives": "The organization might have a well-defined and secure development process that is simply not fully represented in the threat model.",
        "cwe": "937",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "28_sec3.ts",
        "bsiCode": "CON.8",
        "id": "insufficient-software-development-qa",
        "title": "Insufficient Quality Assurance in Software Development",
        "description": "Due to a missing or insufficient quality assurance (QA) process during software development, vulnerabilities can be introduced into the delivered software. If security QA is not firmly anchored in the development process, errors, vulnerabilities, and manipulations in the design or implementation may not be detected. This risk applies to both custom-developed code and the use of third-party or open-source components, which may contain known vulnerabilities.",
        "impact": "Unchecked vulnerabilities in software can be exploited by attackers, leading to a compromise of Confidentiality (data breaches), Integrity (unauthorized data modification), and Availability (denial of service). This can result in significant financial loss, reputational damage, and failure to meet compliance requirements.",
        "action": "Integrate Security-Focused Quality Assurance into the Development Lifecycle",
        "mitigation": "Establish a robust quality assurance process within the Secure SDLC. This includes using Static Application Security Testing (SAST) and Dynamic Application Security Testing (DAST) tools, as well as Software Composition Analysis (SCA) to identify vulnerabilities in third-party libraries. Integrate these checks into the CI/CD pipeline (e.g., by linking a 'build-pipeline' or 'sourcecode-repository' asset to a 'code-inspection-platform' asset in the model). Complement automated scanning with manual code reviews and regular penetration testing for critical components. Track and remediate all identified vulnerabilities in a timely manner.",
        "check": "Is there a 'code-inspection-platform' asset in the model connected to development assets? Are custom-developed assets tagged with 'sast-scanned', 'dast-scanned', 'dependency-scan-ok', or 'pentest-covered'? Is there a formal process for tracking and fixing vulnerabilities found during QA?",
        "asvs": "ASVS V4.0.3 - 14.2 Software Component Verification Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for any in-scope, custom-developed technical asset that is tagged with a relevant QA-mitigation tag (e.g., 'sast-scanned', 'dependency-scan-ok') and has no communication link to a 'code-inspection-platform' asset.",
        "riskAssessment": "The likelihood is high for internet-facing or other exposed assets built with less protected technologies (like web applications). The impact is determined by the maximum CIA requirements of the asset and the data it processes or stores. An asset handling 'strictly-confidential' data without any QA process poses a critical risk.",
        "falsePositives": "A risk might be a false positive if the QA process exists but is not modeled (e.g., QA is performed by a third party and not represented by an asset or tag in the model).",
        "cwe": "937",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "28_sec4.ts",
        "bsiCode": "CON.8",
        "id": "insufficient-software-documentation",
        "title": "Insufficient Software Documentation (BSI APP.4.4)",
        "description": "If software is not properly documented, or is documented inadequately, during the conception or development phase, it can lead to delayed or impossible diagnosis and resolution of potential errors.",
        "impact": "Incorrect operation or administration due to poor documentation can disrupt IT services, cause incorrect work results, delay workflows, and lead to security vulnerabilities (e.g., through misconfiguration).",
        "action": "Create and Maintain Comprehensive Software Documentation",
        "mitigation": "Ensure that comprehensive documentation is created and maintained throughout the software lifecycle. This includes:",
        "check": "Is there up-to-date documentation for developers, administrators, and users? Is the documentation comprehensive and clear enough to allow for secure operation, maintenance, and future development? Are secure configuration options clearly documented?",
        "asvs": "ASVS V1.1.2 (Architecture) - Verify that security-related documentation is created for each component or service in a system, including secure configuration, and API security.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk applies to all in-scope technical assets that are marked as having custom-developed parts (`custom_developed_parts: true`).",
        "riskAssessment": "The impact is determined by the criticality (Confidentiality, Integrity, and Availability) of the custom-developed asset. An asset with poor documentation that handles mission-critical data poses a much higher risk.",
        "falsePositives": "This is a process-related risk. An asset might be marked as custom-developed, but the project may have excellent and thorough documentation.",
        "cwe": "1035",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "28_sec5.ts",
        "bsiCode": "CON.8",
        "id": "insecure-development-environment",
        "title": "Insecure Development Environment (BSI CON.1)",
        "description": "If the development environment is insufficiently secured, the software being produced can be manipulated.",
        "impact": "Manipulation of the software supply chain can lead to backdoors or vulnerabilities in production systems, compromising the confidentiality, integrity, and availability of all data they process.",
        "action": "Secure the Development Lifecycle and Environment",
        "mitigation": "Implement strong access controls for all development systems (source code repositories, build pipelines, artifact registries).",
        "check": "Are all development-related assets (repositories, pipelines) identified? Is access to them restricted and logged?",
        "asvs": "BSI IT-Grundschutz CON.1: Software Development",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Software_development_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule checks for technical assets relevant to software development (e.g., 'SourcecodeRepository', 'BuildPipeline', 'ArtifactRegistry').",
        "riskAssessment": "The impact is determined by the criticality of the assets that are built or deployed by the development environment. Manipulating a pipeline that deploys a mission-critical service has a 'Very High' impact.",
        "falsePositives": "The risk might be flagged as 'accepted' if compensating controls exist outside the model (e.g., network-level IPS/IDS, strict physical access controls for on-premise servers).",
        "cwe": "829",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "28_sec6.ts",
        "bsiCode": "CON.8",
        "id": "conceptual-software-flaws",
        "title": "Conceptual Software Flaws (historically grown, hard to maintain)",
        "description": "As software grows in functionality, its code often becomes more complex. If the code is not properly structured based on a sound software architecture, it can be very difficult to maintain.",
        "impact": "The primary impact is an increased likelihood of unpatched or unpatchable vulnerabilities, which can be exploited to compromise the confidentiality, integrity, or availability of the system and its data.",
        "action": "Refactor or Replace Complex/Legacy Components",
        "mitigation": "For new development, establish and enforce a clear software architecture that emphasizes modularity, separation of concerns, and maintainability.",
        "check": "Is the software architecture for custom-developed components clearly documented? Is the code modular and testable?",
        "asvs": "V1 Architecture, Design and Threat Modeling Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for all in-scope, custom-developed technical assets.",
        "riskAssessment": "The impact is determined by the confidentiality and criticality of the asset and the data it processes or stores. An unmaintainable system handling mission-critical data poses a very high risk.",
        "falsePositives": "This risk might be a false positive if a 'legacy' or complex custom-developed system has been maintained exceptionally well, with up-to-date documentation, a modular internal structure, and a strong test suite.",
        "cwe": "1125",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "28_sec7.ts",
        "bsiCode": "CON.8",
        "id": "insufficient-software-testing-and-release-procedures",
        "title": "Insufficient Software Testing and Release Procedures (related to BSI CON.1/CON.3)",
        "description": "If new software is not sufficiently tested and formally released, critical errors and security vulnerabilities may go undetected.",
        "impact": "Failure to adequately test software can lead to the disclosure, manipulation, or destruction of sensitive information.",
        "action": "Implement and Enforce a Secure Software Development Lifecycle (SSDLC)",
        "mitigation": "Establish a formal process for testing and releasing all custom-developed software components. This process should include mandatory security testing, such as Static Application Security Testing (SAST),",
        "check": "Is there a documented testing strategy for custom-developed software? Are security testing tools integrated into the CI/CD pipeline?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (General Software Development) and CON.3 (Software Tests).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_software_development_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for all in-scope, custom-developed technical assets that are of a type that typically contains complex business logic (e.g., web applications, web services, application servers).",
        "riskAssessment": "The likelihood of exploitation is directly related to the complexity of the custom code and the lack of a structured testing process.",
        "falsePositives": "A risk might be flagged for a component that is covered by a comprehensive, organization-wide testing process that is explicitly modeled.",
        "cwe": "287",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "28_sec8.ts",
        "bsiCode": "CON.8",
        "id": "testing-with-production-data",
        "title": "Testing with Production Data (BSI CON.1.A15)",
        "description": "When new software is tested using production data, unauthorized individuals (e.g., developers, testers) may gain access to confidential information, such as sensitive personal data.",
        "impact": "If this risk materializes, it can lead to severe data breaches (Confidentiality), data corruption (Integrity), and service outages (Availability).",
        "action": "Use Anonymized, Pseudonymized, or Synthetic Data for Testing",
        "mitigation": "Strictly separate test and production environments. Establish and enforce a policy that prohibits the use of real production data in test environments.",
        "check": "Is there a documented policy for test data management? Are test and production environments logically and physically separated? What processes are in place to generate safe test data (anonymization, synthesis)? How is access to test environments controlled and monitored?",
        "asvs": "BSI IT-Grundschutz CON.1.A15 (Separation of test and production data)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_application_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified when a technical asset that appears to be in a test or development context processes or stores sensitive production-grade data.",
        "riskAssessment": "The impact is directly related to the confidentiality and integrity rating of the production data asset being used. A high impact is assumed if 'strictly-confidential' or 'mission-critical' data is involved.",
        "falsePositives": "A 'devops' communication link might be used for legitimate administrative access to a production system, not for application testing. This rule may flag such cases as false positives.",
        "cwe": "200",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "CON.9": [
      {
        "file": "29_sec1.ts",
        "bsiCode": "CON.9",
        "id": "interruption-of-data-transmission-con1",
        "title": "Interruption of Data Transmission (BSI CON.1)",
        "description": "Information exchange can be disturbed, delayed, or completely interrupted due to technical failures or performance bottlenecks in communication links or their connected components.",
        "impact": "If information is not delivered on time, is incomplete, or is not delivered at all, business processes that depend on this data can be significantly impaired or fail completely.",
        "action": "Implement Resilient and Performant Communication Channels",
        "mitigation": "Ensure that data with high-availability requirements is transmitted over resilient communication channels.",
        "check": "Are communication links for critical systems designed for high availability? Are the technical assets involved in the data transmission (source and target) marked as redundant? Is there active monitoring of link performance and error rates?",
        "asvs": "Related to OWASP ASVS V1 Architectural Requirements, particularly V1.11 for availability and resiliency design.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Redundancy_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for communication links that are critical for availability but show signs of being a single point of failure.",
        "riskAssessment": "The impact is determined by the highest availability requirement of the data being transferred or the assets involved. The likelihood is based on the lack of redundancy of the participating assets. A non-redundant component handling mission-critical data poses a significant availability risk.",
        "falsePositives": "The model may not capture all forms of physical or network-level redundancy (e.g., BGP, diverse fiber paths) that are not explicitly modeled as separate components.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "29_sec2.ts",
        "bsiCode": "CON.9",
        "id": "missing-confidentiality-agreement-con7",
        "title": "Risk of Data Misuse due to Missing or Inadequate Confidentiality Agreement (related to BSI CON.7)",
        "description": "Sensitive information can fall into the hands of unauthorized persons if a confidentiality agreement (e.g., an NDA) was not concluded or was poorly formulated before an information exchange with an external party. This lack of a formal agreement increases the risk of data misuse, as there are no binding rules on how the external party can handle the received information.",
        "impact": "Without a clear and binding confidentiality agreement, sensitive data exchanged with external parties can be misused, disclosed, or handled improperly. This can lead to a breach of confidentiality, reputational damage, competitive disadvantage, and potential legal or financial penalties, especially if personal or business-critical data is involved.",
        "action": "Establish and Enforce Confidentiality Agreements for External Data Exchange",
        "mitigation": "For any communication link with an external entity that involves the transfer of sensitive data (rated 'restricted' or higher), ensure a formal, legally-reviewed confidentiality agreement or Non-Disclosure Agreement (NDA) is in place. Once confirmed, add the tag `@nda-signed` to the respective communication link in the threat model to mark this risk as mitigated.",
        "check": "Review all communication links to/from assets of type 'external-entity'. If sensitive data is exchanged, verify that a binding confidentiality agreement exists. Check if the communication link is tagged with `@nda-signed`.",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.7 (Exchange of information). Requirement CON.7.A3 (Agreements on information transfer) requires establishing formal transfer policies, procedures, and controls.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_7_Exchange_of_information_edition_2023.pdf?__blob=publicationFile (BSI CON.7)",
        "detectionLogic": "This rule checks all communication links that connect to a technical asset of type `external-entity`. If such a link transfers data with a confidentiality rating of 'restricted' or higher and is not tagged with `@nda-signed`, a risk is generated.",
        "riskAssessment": "The impact of this risk is directly proportional to the confidentiality level of the data being exchanged. The likelihood is considered high if no agreement is in place, as there is no formal barrier to misuse. The highest confidentiality level of the data assets transferred over the communication link determines the impact.",
        "falsePositives": "A risk might be flagged if a confidentiality agreement exists but has not been documented in the model using the `@nda-signed` tag. It can also be a false positive if the data exchange is covered by a broader Master Service Agreement (MSA) specific to this individual link.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "29_sec3.ts",
        "bsiCode": "CON.9",
        "id": "accidental-data-leakage",
        "title": "Accidental Data Leakage (based on BSI Threat Description)",
        "description": "Sensitive information can be inadvertently sent to unauthorized recipients due to human error, insufficient training, or a lack of clear procedures. Examples include sending data to the wrong email address, or transmitting documents that contain hidden residual information (like internal comments or insufficiently deleted data).",
        "impact": "This can lead to a breach of confidentiality for sensitive data, resulting in non-compliance with legal or contractual requirements (like @DataType:PII), reputational damage, and financial loss.",
        "action": "Implement Controls for Data in Transit",
        "mitigation": "Use Data Loss Prevention (DLP) tools to monitor and block unauthorized transmission of sensitive information. Enforce strong authorization on communication channels, especially for external-facing protocols like email. Implement data sanitization to strip metadata and comments from files before they are sent. Provide regular, targeted training to all personnel on secure data handling procedures and how to identify and protect sensitive information.",
        "check": "Are data-in-transit controls (like DLP) in place for sensitive data flows? Are file-sharing and email protocols properly secured and access-controlled? Does the organization provide mandatory, regular training on data handling and classification?",
        "asvs": "Related to concepts in BSI IT-Grundschutz CON.1 (General data protection) and DER.1 (Detection of security-related events).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_data_protection_Print_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified by analyzing communication links that transfer sensitive data (Confidentiality of 'restricted' or higher). The risk is elevated for protocols prone to human error (like SMTP, FTP, SMB) or those with weak or missing authentication/authorization, especially if they cross trust boundaries.",
        "riskAssessment": "The impact is directly rated based on the confidentiality of the data being transferred (e.g., 'strictly-confidential' data leads to 'very-high' impact). The likelihood increases with weaker protocols (like unencrypted SMTP/FTP) and the absence of authentication or other compensating controls like VPN or IP filtering.",
        "falsePositives": "This risk might be a false positive if there are out-of-band compensating controls in place, such as a separate, mandatory DLP gateway that scans all outgoing email, or if the specific data flow is highly proceduralized and automated, reducing the chance of human error.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "29_sec4.ts",
        "bsiCode": "CON.9",
        "id": "unprotected-data-in-transit-or-at-rest-bsi",
        "title": "Unprotected Data In-Transit or At-Rest (BSI CON.1, SYS.1.6)",
        "description": "Information and data can be surreptitiously intercepted (Information Disclosure) or altered (Tampering) if not adequately protected.",
        "impact": "Successful exploitation leads to the loss of confidentiality and/or integrity of the affected data. Attackers can steal sensitive information (e.g., credentials, personal data, business secrets), inject malicious content (like malware into file transfers), or manipulate critical data. This can result in data breaches, financial loss, reputational damage, and legal consequences.",
        "action": "Enforce Encryption for Data In-Transit and At-Rest",
        "mitigation": "All communication links transmitting data across trust boundaries MUST use a strong, encrypted protocol (e.g., TLS 1.3+, HTTPS, SFTP, WSS, encrypted database protocols).",
        "check": "Review all communication links in the architecture. Do they use an encrypted protocol, especially when crossing trust boundaries or transmitting sensitive data?",
        "asvs": "BSI IT-Grundschutz: CON.1 (General data transmission), SYS.1.6 (Servers under Windows and Linux). Maps to OWASP ASVS V5: V9.1 (Communications) and V7.2 (Cryptographic Storage).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule identifies risks in two scenarios:",
        "riskAssessment": "The likelihood of exploitation is higher for data in-transit over untrusted networks (like the internet). The impact is directly proportional to the sensitivity (CIA rating) of the data being transmitted or stored. Transmitting 'Strictly Confidential' data over an unencrypted link poses a very high impact. Storing 'Mission Critical' data on an unencrypted database is similarly severe.",
        "falsePositives": "A communication link might be part of a physically secured, isolated network where the risk of interception is considered acceptable.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "29_sec5.ts",
        "bsiCode": "CON.9",
        "id": "unencrypted-transmission",
        "title": "Unencrypted Transmission of Sensitive Data",
        "description": "The protection of information during transmission using cryptographic methods can be undermined by attacks. If cryptographic methods are not applied correctly, an attacker can intercept and access the transmitted data. This is especially true if sensitive data is sent over an unencrypted communication channel across a trust boundary. The BSI warns that inadequately protected communication can lead to data interception and manipulation.",
        "impact": "If sensitive data is transmitted unencrypted, it can be intercepted and read (loss of confidentiality) or modified (loss of integrity) by an attacker with access to the communication path. This can lead to data breaches, unauthorized access to systems, financial loss, and reputational damage.",
        "action": "Enforce Encrypted Communication",
        "mitigation": "Ensure that all communication links carrying sensitive data across trust boundaries use strong, encrypted protocols (e.g., HTTPS, TLS, SFTP, JDBC-encrypted). Disable weak cipher suites. Use a VPN as a compensating control if the native protocol cannot be encrypted. Ensure keys are managed securely and separately from the data they protect.",
        "check": "Are all communication links between different trust boundaries using an encrypted protocol? Is a VPN used for unencrypted protocols? Are there any links carrying confidential or critical data that are unencrypted?",
        "asvs": "V9.1: Verify that all communications between components are encrypted in transit.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for communication links that cross trust boundaries and are not encrypted (i.e., do not use a protocol like HTTPS, TLS, etc.) and are not protected by a VPN. The risk is raised if these links transmit data with a confidentiality level higher than 'Public' or an integrity level higher than 'Operational'.",
        "riskAssessment": "The likelihood is influenced by the network exposure (e.g., internet vs. internal) and compensating controls like IP filtering. The impact is determined by the highest confidentiality and integrity of the data assets transmitted over the link.",
        "falsePositives": "The risk might be a false positive if other, un-modeled compensating controls are in place (e.g., a hardware-based network encryptor). It can also be considered a false positive for certain monitoring or security protocols that intentionally operate on unencrypted traffic within a controlled environment.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "APP.1.2": [
      {
        "file": "2_sec1.ts",
        "bsiCode": "APP.1.2",
        "id": "malicious-code-execution-in-browser",
        "title": "Malicious Code Execution in Web Browser",
        "description": "Web browsers regularly load data from untrusted sources. Such data can contain executable malicious code that exploits vulnerabilities and infects the user's IT system without their knowledge.",
        "impact": "If malicious code is executed via the browser, an attacker can compromise the client system. This can lead to theft of sensitive data (Information Disclosure), manipulation of data or system files (Tampering), or installation of ransomware (Denial of Service).",
        "action": "Implement and Enforce Browser and Endpoint Security Hardening",
        "mitigation": "Ensure browsers are kept up-to-date with the latest security patches through a managed process. Disable or restrict unnecessary or risky plugins and extensions.",
        "check": "Are all client web browsers centrally managed and automatically updated? Is there a policy for allowed/disallowed browser extensions? Are security configurations for browsers enforced? Is an endpoint protection solution with browser security features active?",
        "asvs": "BSI IT-Grundschutz SYS.3.2.1 Web Browser",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_Web_browser_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any in-scope technical asset identified with the 'Browser' technology type. Browsers, by their nature, process untrusted content from the internet, making them a primary vector for client-side attacks.",
        "riskAssessment": "The likelihood is considered 'Very-Likely' due to the constant exposure of web browsers to untrusted internet content. The impact is directly related to the CIA requirements of the client system and the data it processes or can access.",
        "falsePositives": "This risk is fundamental to using a web browser for general internet access. It can be considered a false positive only in rare cases where the browser is used in an extremely restricted 'kiosk' mode, limited to a small, fully trusted set of internal-only websites, and is unable to download any external content or files.",
        "cwe": "94",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "2_sec2.ts",
        "bsiCode": "APP.1.2",
        "id": "exploitation-of-client-side-vulnerabilities",
        "title": "Exploitation of Client-Side Vulnerabilities",
        "description": "Vulnerability lists and exploit kits significantly simplify the development of custom malware.",
        "impact": "If client-side vulnerabilities are successfully exploited, attackers can install malware (like ransomware, spyware, or keyloggers) on the client system.",
        "action": "Implement Client Hardening, Patch Management, and Endpoint Protection",
        "mitigation": "Keep client operating systems, browsers, and all extensions/plugins up-to-date with the latest security patches.",
        "check": "Are client systems and browsers centrally managed and kept up-to-date with security patches? Is a modern EDR/antivirus solution deployed and active on all clients?",
        "asvs": "BSI IT-Grundschutz: SYS.2.1 Web Browser, SYS.1.2.2 Client under Windows, SYS.1.3 Client under macOS",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_1_Web_browser_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for all in-scope technical assets identified as client systems (e.g., technology types: Browser, Desktop, Mobile App, etc.).",
        "riskAssessment": "The likelihood of exploitation is very high for unmanaged client systems connected to the internet, as they are exposed to automated scanning and drive-by attacks.",
        "falsePositives": "This risk may be a false positive if robust, centrally-managed compensating controls (like a comprehensive EDR, strict application whitelisting, or a non-persistent VDI environment) are in place but n@SystemType:OT modeled.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "2_sec3.ts",
        "bsiCode": "APP.1.2",
        "id": "insecure-communication-over-internet",
        "title": "Insecure Communication over the Internet",
        "description": "The fundamental security of communication over the internet depends significantly on the authentication methods used and the encryption of data in transit.",
        "impact": "If communication is not effectively secured, sensitive information can be intercepted (violating Confidentiality) or modified in transit (violating Integrity).",
        "action": "Enforce Strong Authentication and Encryption for Communication",
        "mitigation": "All communication links, especially those crossing trust boundaries or carrying sensitive data, must use strong, state-of-the-art encrypted protocols (e.g., using TLS 1.2/1.3, SSH).",
        "check": "Review all communication links in the model. Verify that any link carrying sensitive data or crossing a trust boundary uses an encrypted protocol (e.g., HTTPS, FTPS, WSS, LDAPS, etc.).",
        "asvs": "V4: Communication Security",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule checks all communication links in the model. It triggers a risk if a link uses an unencrypted protocol, especially when it crosses a trust boundary, involves an internet-facing asset, or is not protected by a VPN.",
        "riskAssessment": "The impact is determined by the highest Confidentiality and Integrity requirements of the data assets transmitted over the link.",
        "falsePositives": "A risk might be a false positive if the communication occurs over a completely isolated and physically secured network segment where interception is considered impossible.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "2_sec4.ts",
        "bsiCode": "APP.1.2",
        "id": "malicious-browser-components-from-untrusted-sources",
        "title": "Malicious Browser Components from Untrusted Sources (BSI SYS.1.2.1)",
        "description": "If web browsers, plug-ins, or extensions are obtained from untrusted sources, malicious functions can be executed unintentionally and unnoticed.",
        "impact": "Compromise of client systems through malicious browser components can lead to phishing, unauthorized data access and exfiltration (breach of confidentiality),",
        "action": "Enforce Secure Software Sourcing and Client Hardening",
        "mitigation": "Only obtain browsers, plugins, and extensions from trusted, official sources (e.g., official vendor websites, corporate software portals).",
        "check": "Are there effective technical controls and policies that prevent users from installing software from untrusted sources? Is there a central, vetted software repository for users? Are client systems regularly scanned for unauthorized software?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.1.2.1 (Allgemeiner Client). The described threat aligns with fundamental secure configuration principles.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html",
        "detectionLogic": "This risk applies to any client-side technical asset used by a human to interact with the internet or other systems. The rule identifies assets configured as human-operated clients (e.g., browsers, desktops) which, without proper controls, are susceptible to this threat.",
        "riskAssessment": "The likelihood is considered high in environments without strict controls on software installation. The impact is directly related to the sensitivity of the data accessed or processed by the user via the compromised client. Accessing mission-critical systems with a compromised browser results in a very high impact.",
        "falsePositives": "This risk might be a false positive in environments where, despite the technical possibility, strong organizational policies and user training effectively prevent the installation of untrusted software. Verifying the effectiveness of such non-technical controls is required to dismiss the risk.",
        "cwe": "829",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "2_sec5.ts",
        "bsiCode": "APP.1.2",
        "id": "insecure-browser-configuration",
        "title": "Insecure Web Browser Configuration (BSI APP.3.2)",
        "description": "If web browsers are configured insecurely, confidential data can be accidentally or maliciously exposed to unauthorized third parties. Passwords can also be unintentionally shared. If cookies, passwords, history, form data, and search queries are stored, or unnecessary extensions are enabled, data can be more easily read and misused by third parties or malware.",
        "impact": "This can lead to the theft of credentials, session hijacking, disclosure of sensitive personal or business data, and unauthorized access to other systems, compromising the confidentiality and integrity of information.",
        "action": "Secure Browser Configuration and Management",
        "mitigation": "Enforce a secure baseline configuration for all browsers used to access corporate resources. This includes disabling password saving, clearing history/cookies on exit, restricting or auditing browser extensions, and using privacy-enhancing features. Use Mobile Device Management (MDM) or Group Policies (GPO) to enforce these settings. Educate users on the risks of insecure browser settings and extensions.",
        "check": "Are there centrally managed, enforced security policies for web browsers? Is password saving disabled in the browser? Is the installation of unapproved extensions blocked or monitored? Are users trained on secure browser usage?",
        "asvs": "BSI IT-Grundschutz Baustein APP.3.2 Web-Browser",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_Web_browser_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Triggers for any client-type technical assets (e.g., Browser, Desktop, Mobile App) that communicate with other assets handling sensitive data (rated 'Restricted'/'Important' or higher). The risk assumes that unmanaged or insecurely configured clients pose a threat to the data they access.",
        "riskAssessment": "The likelihood is considered higher for clients that are external or directly exposed to the internet, as they are less likely to be under strict corporate control. The impact is determined by the maximum confidentiality and integrity ratings of the assets the client connects to. Accessing a 'Strictly Confidential' system from an insecure browser has a very high impact.",
        "falsePositives": "This risk can be considered a false positive if endpoint security measures (like browser isolation/virtualization) are in place but n@SystemType:OT modeled, or if the client asset is used in a context (e.g., public kiosk) where it never accesses sensitive systems or data.",
        "cwe": "522",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "DER.1": [
      {
        "file": "30_sec4.ts",
        "bsiCode": "DER.1",
        "id": "unintentional-data-leakage-on-mobile-device-app4.4",
        "title": "Unintentional Data Leakage on Mobile End-Device (BSI APP.4.4)",
        "description": "Data is transferred to and from a mobile application through various channels provided by the mobile operating system.",
        "impact": "If sensitive data is not properly protected on the mobile device, it can be exfiltrated by other malicious applications,",
        "action": "Implement Secure Data Handling and Storage on Mobile Devices",
        "mitigation": "Sensitive data should not be stored on the mobile device unless absolutely necessary. If storage is required, use platform-provided secure,",
        "check": "Is sensitive data stored locally on the device? If so, is it encrypted using platform-provided secure storage mechanisms?",
        "asvs": "BSI IT-Grundschutz APP.4.4.A5 (Protection of local data). Also relates to OWASP MASVS V2 (Data Storage and Privacy Requirements).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_Mobile_applications_edition_2022.pdf?__blob=publicationFile (BSI APP.4.4)",
        "detectionLogic": "This risk is triggered for all in-scope technical assets of type 'Mobile App' that process or store data with a confidentiality rating of 'Restricted' or higher.",
        "riskAssessment": "The likelihood and impact of this risk are determined by the highest confidentiality level of the data processed or stored by the mobile application.",
        "falsePositives": "This risk is raised based on the potential for data leakage. A model cannot verify the implementation details of specific controls like disabled clipboard access",
        "cwe": "922",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "30_sec5.ts",
        "bsiCode": "DER.1",
        "id": "inadequate-monitoring-of-network-boundaries",
        "title": "Inadequate Monitoring of Network Boundaries (BSI DER.1.A4)",
        "description": "If no detection systems are used and the detection functions available in IT systems and applications are not used, attackers can more easily penetrate the institution's network without being noticed.",
        "impact": "Successful exploitation can lead to undetected attackers persisting in the network, accessing or exfiltrating sensitive data, and potentially escalating privileges to compromise further systems. This directly threatens the confidentiality and integrity of information.",
        "action": "Implement Intrusion Detection/Prevention Systems (IDS/IPS)",
        "mitigation": "Deploy IDS/IPS solutions to monitor traffic at critical network boundaries, especially where trust levels change.",
        "check": "Are network communications, especially those crossing trust boundaries, monitored by an IDS/IPS? Are alerts from these systems reviewed and acted upon? Are logs from relevant assets collected and analyzed?",
        "asvs": "BSI IT-Grundschutz DER.1.A4 Use of systems for attack detection (IDS)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Detection_of_security-relevant_events_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers for all communication links that cross a trust boundary.",
        "riskAssessment": "The likelihood of an undetected intrusion is considered very likely for unmonitored network boundary crossings.",
        "falsePositives": "Can occur if monitoring solutions (e.g., host-based or agent-based IDS) are not represented in the threat model.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "30_sec6.ts",
        "bsiCode": "DER.1",
        "id": "insufficient-personnel-for-log-analysis-orp4",
        "title": "Insufficient Personnel for Log Analysis and Monitoring (related to BSI ORP.4)",
        "description": "If there is not enough personnel to evaluate log data, security-relevant events cannot be fully detected. This can lead to attacks remaining hidden for extended periods or only being discovered after significant damage, such as data exfiltration, has already occurred.",
        "impact": "A failure to detect security incidents in a timely manner can compromise the confidentiality, integrity, and availability of critical systems and data. It may allow attackers prolonged unauthorized access, leading to severe data breaches, system disruption, and a delayed incident response, which magnifies the overall business impact.",
        "action": "Ensure Sufficient Staffing for Security Monitoring and Analysis",
        "mitigation": "Allocate adequate and qualified personnel for the regular analysis of log data and the evaluation of security-relevant events. Establish clear processes and responsibilities for monitoring activities, including reviewing logs from critical assets. Utilize security automation and tooling (e.g., SIEM) to support the security team and ensure that alerts are managed effectively. Also, maintain a process for evaluating external threat intelligence to proactively identify vulnerabilities.",
        "check": "Are there dedicated personnel or a team (e.g., a SOC) responsible for security monitoring? Is there a defined and followed process for log review? Is the workload for security analysis considered manageable for the current staff? Is there tooling in place to aggregate and analyze logs from critical systems?",
        "asvs": "BSI IT-Grundschutz ORP.4: Detection of Security-Relevant Events, specifically Requirement ORP.4.A5 (Personnel resources for the detection of security-relevant events).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Detection_of_security-relevant_events_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This organizational risk is raised for critical, in-scope technical assets that are not client-side technologies. The assumption is that these assets produce valuable log data that requires monitoring. The risk is heightened for assets with high confidentiality, integrity, or availability requirements, as the impact of an undetected incident would be greater. Monitoring and security control platforms themselves are excluded.",
        "riskAssessment": "The likelihood is considered 'Likely' as understaffed security teams are a common organizational challenge. The impact is calculated based on the CIA ratings of the technical asset in question. A highly critical asset with sensitive data will result in a high-impact risk, while a less critical asset will result in a lower impact.",
        "falsePositives": "This risk is organizational and cannot be fully verified by the technical model alone. The organization may have a well-staffed 24/7 SOC and robust monitoring processes, which would render this risk a false positive. Confirmation requires discussion with the operations and security teams about their monitoring capabilities and resources.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "DER.2.1": [
      {
        "file": "31_sec1.ts",
        "bsiCode": "DER.2.1",
        "id": "inadequate-incident-handling-con1",
        "title": "Inadequate Handling of Security Incidents (BSI CON.1)",
        "description": "In practice, security incidents can never be completely ruled out, even with many security measures in place.",
        "impact": "Without a proper procedure for handling security incidents, wrong decisions can be made under pressure.",
        "action": "Establish and Maintain a Formal Incident Response Process",
        "mitigation": "Define and implement a comprehensive incident response plan. This includes clear procedures for detection, reporting, analysis, containment, eradication, and recovery.",
        "check": "Is there a documented incident response plan? Are roles and responsibilities for incident handling clearly defined?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Security Incident Management). Specifically relates to requirements like CON.1.A4 (Preparation for handling security incidents) and CON.1.A5 (Reporting and handling security incidents).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Security_incident_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
        "detectionLogic": "This is an organizational risk. The model identifies technical assets where effective and timely incident response is most critical.",
        "riskAssessment": "Likelihood is HIGH if no formal incident response plan exists or is tested. Likelihood is MEDIUM if a plan exists but is not well-communicated or regularly practiced.",
        "falsePositives": "This risk is organizational. The model can only identify assets where incident response is *critical*.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "31_sec2.ts",
        "bsiCode": "DER.2.1",
        "id": "improper-incident-handling-and-evidence-destruction",
        "title": "Improper Incident Handling and Evidence Destruction (BSI DER.2)",
        "description": "If personnel react improperly or fail to follow established procedures after a security incident,",
        "impact": "The primary impact is the loss of forensic evidence, which prevents a proper investigation into the incident's cause, scope, and damage.",
        "action": "Establish and Train Formal Incident Response Procedures with Evidence Preservation.",
        "mitigation": "Develop a formal, documented incident response plan that includes clear procedures for evidence preservation (e.g., isolating systems instead of shutting them down, creating forensic images of disks and memory before performing remediation).",
        "check": "Is there a formal incident response plan? Does it include specific steps for evidence preservation? Are IT and security personnel trained on this plan? Are roles and responsibilities for incident handling clearly defined?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein DER.2 (Security Incident Management).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/DER_2_Behandlung_von_Sicherheitsvorfaellen_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This is an organizational risk that applies to critical systems where an incident would require a formal response.",
        "riskAssessment": "The likelihood is considered 'Likely' by default, assuming a lack of a formal, trained incident response process. This should be adjusted based on the organization's actual maturity.",
        "falsePositives": "This risk is inherently organizational. An organization might have excellent incident response procedures in place that are not visible in the threat model.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "DER.2.2": [
      {
        "file": "32_sec1.ts",
        "bsiCode": "DER.2.2",
        "id": "improper-handling-of-@DataType:PII-during-forens@SystemType:ICS",
        "title": "Improper Handling of Personal Data during IT Forensic Investigations (BSI-Style)",
        "description": "During IT forensic investigations, it is common to copy, secure, and analyze all data deemed necessary. This data frequently includes personal data of employees, partners, or customers. If this data is accessed without a valid legal basis or without the involvement of the Data Protection Officer (DPO), the institution may violate legal regulations (e.g., @DataType:PII's purpose limitation principle). Furthermore, there is a risk that employee behavior can be inferred from the collected data or that a direct link to individuals can be established, leading to violations of both internal and external regulations.",
        "impact": "Violating data protection laws and internal policies can lead to significant legal fines, reputational damage, and loss of trust. Improper access to personal data compromises its confidentiality and can disrupt business processes if forensic activities are challenged or halted due to non-compliance.",
        "action": "Establish and Enforce Data Handling Procedures for Forensic Investigations",
        "mitigation": "Define and document clear procedures for all IT forensic investigations. These procedures must:",
        "check": "Are there documented, formally approved procedures for conducting IT forensic investigations? Do these procedures explicitly address the handling of personal data and mandate the involvement of the DPO? Are access controls for forensic evidence stores implemented and audited?",
        "asvs": "Derived from BSI IT-Grundschutz principles in DER.1 (Data Protection) and CON.8 (Handling of security incidents). Forensic processes must adhere to fundamental data protection principles like purpose limitation, data minimization, and lawful processing.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Data_protection_edition_2023.pdf?__blob=publicationFile (BSI DER.1)",
        "detectionLogic": "This risk is raised for any technical assets identified as part of the forens@SystemType:ICS workflow (tagged with `@forens@SystemType:ICS-tool` or `@forensic-datastore`) that process or store sensitive data (Confidentiality of 'Restricted' or higher, or tagged with `@DataType:PII`). The presence of such a workflow without assured procedural safeguards represents a significant risk.",
        "riskAssessment": "The likelihood of this risk is considered 'Likely' if formal, audited procedures for forensic data handling are not in place. The impact is determined by the highest confidentiality level of the personal data being handled by the forensic asset, ranging from 'Medium' for restricted data to 'Very High' for strictly confidential data.",
        "falsePositives": "This risk may be a false positive if robust, audited, and enforced procedures for handling personal data during forens@SystemType:ICS are already in place. The technical model alone cannot verify the existence or effectiveness of such organizational controls.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "32_sec2.ts",
        "bsiCode": "DER.2.2",
        "id": "improper-evidence-handling-bsi",
        "title": "Improper Handling and Securing of Digital Evidence (BSI-based)",
        "description": "If digital evidence is secured incorrectly or not quickly enough, important data can be lost that cannot be recovered later.",
        "impact": "The loss or corruption of digital evidence compromises the integrity of post-incident investigations.",
        "action": "Establish and Regularly Practice Forensic Readiness and Evidence Handling Procedures",
        "mitigation": "Develop and document clear, step-by-step procedures for evidence collection, including the preservation of volatile data (e.g., memory, network state) and non-volatile data (e.g., disk images).",
        "check": "Are there documented procedures for digital evidence collection? Are personnel trained on these procedures and the use of forensic tools? Are drills conducted to test forensic readiness?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein DER.4 (Incident Management), specifically requirement DER.4.A19 (Forensic analysis of IT systems).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_4_Incident_Management_edition_2023.pdf?__blob=publicationFile (BSI DER.4)",
        "detectionLogic": "This organizational risk is raised against technical assets that are critical for security and incident analysis.",
        "riskAssessment": "The likelihood is considered high for critical systems if no explicit forensic readiness measures are in place, as mistakes are common under the pressure of a real incident.",
        "falsePositives": "This risk is procedural and organizational. The model identifies assets where this weakness would have the greatest impact.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "DER.2.3": [
      {
        "file": "33_sec1.ts",
        "bsiCode": "DER.2.3",
        "id": "apt-firmware-persistence",
        "title": "APT Persistence via Firmware/Hardware Manipulation",
        "description": "Advanced Persistent Threats (APTs) aim for long-term infiltration of target networks. A sophisticated technique is to install persistent backdoors by manipulating low-level, hardware-near components like system firmware (e.g., UEFI/BIOS). Such modifications are extremely difficult to detect and can survive traditional incident response measures like reinstalling the operating system or replacing hard drives. The BSI warns that attackers might even compromise firmware update routines, ensuring their malicious code persists even after a legitimate update is applied. This grants the attacker a permanent, stealthy foothold inside the IT infrastructure.",
        "impact": "Successful exploitation results in a complete and persistent compromise of the affected asset's integrity and confidentiality. Attackers can exfiltrate data, tamper with critical processes, pivot to other systems, and maintain long-term, virtually undetectable access to the corporate network.",
        "action": "Implement Hardware and Firmware Integrity Verification and Control",
        "mitigation": "For critical assets, implement a defense-in-depth strategy for hardware security. Use platforms with a hardware-based root of trust (e.g., TPM). Enforce Secure Boot to ensure only signed and trusted firmware, bootloaders, and operating systems can execute. Where possible, use remote attestation to continuously verify the integrity of platforms before granting them access to sensitive parts of the network. Maintain a secure supply chain for hardware procurement to prevent tampering before deployment.",
        "check": "Are critical systems equipped with TPMs? Is Secure Boot enabled and actively enforced? Is there a process for remote attestation to verify platform integrity? Is the hardware supply chain managed and trusted?",
        "asvs": "This advanced threat exceeds the scope of most standard ASVS checks. However, it relates to the principles of system integrity verification, such as in section V14. Related NIST guidelines like SP 800-193 (Platform Firmware Resiliency) are highly relevant.",
        "cheatSheet": "https://csrc.nist.gov/publications/detail/sp/800-193/final",
        "detectionLogic": "This rule triggers on high-value technical assets that are attractive targets for APTs. The risk is raised for assets that are either explicitly tagged as high-value targets or are internet-facing systems processing or storing sensitive data. The risk is considered for physical, virtual, and containerized machines, as they all rely on underlying host firmware.",
        "riskAssessment": "The impact of such a compromise is always considered 'Very High'. The likelihood is adjusted based on the asset's value and exposure. For an internet-facing, mission-critical system, the likelihood of being targeted with such an attack is considered 'Very Likely'. For other high-value systems, it is 'Likely'. The resulting severity is typically 'High' or 'Critical'.",
        "falsePositives": "A risk might be flagged on an asset where this attack vector is deemed non-viable. This can be considered a false positive if the organization can demonstrate robust and actively monitored hardware-level security controls (e.g., strictly enforced Secure Boot, remote attestation) that effectively mitigate this specific threat.",
        "cwe": "494",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "33_sec2.ts",
        "bsiCode": "DER.2.3",
        "id": "destruction-of-forensic-evidence-after-apt",
        "title": "Destruction of Forensic Evidence after an APT Incident (BSI CON.3)",
        "description": "After an Advanced Persistent Threat (APT) incident, IT systems are often reinstalled or decommissioned to remove the threat.",
        "impact": "Destroying forensic evidence prevents a thorough analysis of the security incident. This can make it impossible to determine the full scope of the compromise,",
        "action": "Establish and Adhere to a Forensic-Ready Incident Response Plan",
        "mitigation": "A formal incident response plan must be in place that explicitly mandates the creation of forensic images (disk and memory) of affected systems *before* any recovery or re-installation procedures begin.",
        "check": "Is there a documented incident response plan? Does the plan explicitly require forensic imaging before system recovery?",
        "asvs": "BSI IT-Grundschutz CON.3 Security Incident Management, specifically CON.3.A15 Forensic investigations.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Security_incident_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organizational risk is raised for all in-scope technical assets that are client systems or external entities.",
        "riskAssessment": "The likelihood of this risk materializing during a real incident is considered 'Likely' if a formal, tested incident response plan with forensic procedures is in place.",
        "falsePositives": "This risk is procedural and organizational. A model cannot verify the existence or quality of an incident response plan.",
        "cwe": "223",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "33_sec3.ts",
        "bsiCode": "DER.2.3",
        "id": "apt-premature-cleanup-detection",
        "title": "Premature Detection of APT Remediation (BSI-OPS.1.2.5)",
        "description": "During the response to an Advanced Persistent Threat (APT), attackers who are still active within the infrastructure might detect the analysis and cleanup activities.",
        "impact": "If attackers detect the remediation efforts, they can actively work to undermine them. This can lead to a failed cleanup, prolonged attacker presence, installation of deeper and more resilient backdoors, destruction of evidence, and intentional sabotage of critical systems. The result is a more severe and costly incident, potentially compromising the integrity, availability, and confidentiality of the entire IT infrastructure.",
        "action": "Establish and Use Secure Out-of-Band (OOB) Channels for Incident Response",
        "mitigation": "All communication and coordination for responding to critical incidents like APTs MUST be conducted over a separate, trusted infrastructure (OOB channel) that is isolated from the compromised network. Remediation activities should be planned as a coordinated, simultaneous operation to prevent tipping off the attacker. Tag communication links used for this purpose in the model with `@out-of-band-management` to signify they use a secure OOB channel.",
        "check": "Is there a documented incident response plan that mandates OOB channels for high-impact incidents? Are technical assets used for these channels modeled and isolated? Are remediation plans designed for simultaneous, coordinated execution?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.2.5 (Incident Handling). This risk describes a specific threat during the remediation phase of an APT incident, where attackers detect the cleanup activities.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_Reaktion_auf_Sicherheitsvorfaelle_und_Schadensereignisse_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies administrative or DevOps-related communication links (`usage: devops`) that are explicitly marked as using an out-of-band channel via the `@out-of-band-management` tag. The assumption is that using the standard, potentially compromised network for incident response or high-privilege administration on critical assets risks detection by a resident APT.",
        "riskAssessment": "The likelihood is high if administrative tasks are performed 'in-band' on critical assets, as APTs are expected to monitor such activities to maintain their foothold. The impact is directly related to the CIA value of the target asset and the overall business criticality, as a failed cleanup can lead to catastrophic damage.",
        "falsePositives": "An out-of-band channel might exist in reality but is not documented in the Threagile model with the `@out-of-band-management` tag. This risk should be confirmed with the operations and security teams.",
        "cwe": "507",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "33_sec4.ts",
        "bsiCode": "DER.2.3",
        "id": "service-disruption-during-apt-cleanup",
        "title": "Service Disruption During APT Incident Cleanup (BSI Scenario)",
        "description": "During the cleanup of an Advanced Persistent Threat (APT) incident, various IT systems may need to be reinstalled and networks temporarily isolated. This necessary remediation can lead to the failure of IT systems and services, making them limited or completely unavailable.",
        "impact": "If the cleanup process is prolonged, especially due to a lack of sufficient or accessible documentation for rebuilding, it can severely impact the institution's productivity. This can result in significant economic losses, which may even become an existential threat to the organization. This risk is most acute for critical, non-redundant systems.",
        "action": "Develop and Maintain a Comprehensive Incident Response and Business Continuity Plan",
        "mitigation": "Establish a robust incident response plan that includes procedures for isolating and remediating compromised systems after an APT. Crucially, maintain up-to-date and accessible documentation for all critical systems to enable rapid and predictable rebuilding (e.g., Infrastructure as Code, configuration backups, detailed runbooks). Regularly test the recovery procedures through drills and simulations to minimize downtime and ensure business continuity. Implementing redundancy for critical components can prevent a total service outage during remediation.",
        "check": "Is there a documented incident response plan for major threats like APTs? Is system documentation for recovery complete, current, and readily available? Are recovery procedures regularly tested? Are critical systems designed with redundancy?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.4 (Incident Response), specifically CON.4.A7 (Handling security incidents), and OPS.1.1.5 (Standard operating procedures), which covers the need for recovery documentation.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_4_Incident_Response_edition_2023.pdf?__blob=publicationFile (BSI CON.4)",
        "detectionLogic": "This risk is triggered for in-scope technical assets with high-availability requirements that lack redundancy. The assumption is that such assets represent single points of failure, and their remediation after an APT incident would cause a significant service outage, as described in the BSI scenario.",
        "riskAssessment": "Likelihood is based on the probability of a successful APT attack requiring major cleanup, which can be considered 'Likely' for many organizations. The impact is directly tied to the availability requirement of the affected asset. For a 'Mission-Critical' asset, the impact is 'Very High' as its unavailability can be existential. The impact is exacerbated if the asset is non-redundant and documentation for a swift recovery is inadequate.",
        "falsePositives": "The model cannot verify the quality of an organization's incident response plans or system documentation. This risk should be accepted or mitigated based on a manual review of the organization's business continuity and disaster recovery (BCDR) capabilities for the identified asset.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "33_sec5.ts",
        "bsiCode": "DER.2.3",
        "id": "apt-lateral-movement-and-persistence",
        "title": "APT Lateral Movement and Persistence (based on BSI Threat Scenario)",
        "description": "In an Advanced Persistent Threat (APT) attack, attackers gain detailed knowledge of the target environment's architecture and configuration, including network segments, system naming schemes, accounts, and deployed software. With this knowledge, attackers can move stealthily and efficiently within the network (lateral movement). Even after a partial cleanup, they may leverage this understanding to quickly regain access and re-establish a high degree of compromise, making complete eradication difficult.",
        "impact": "If an attacker establishes a foothold on a critical system, they can leverage it to compromise other connected systems. This can lead to widespread data exfiltration, manipulation of critical business processes, persistent long-term access, and significant disruption. The ability to move laterally multiplies the potential damage from a single initial breach.",
        "action": "Implement and Enforce Strong Network Segmentation, Access Control, and Threat Detection",
        "mitigation": "Employ a defense-in-depth strategy. Use micro-segmentation to isolate critical systems and restrict east-west traffic. Apply the principle of least privilege to all service and user accounts. Enforce strong, multi-factor authentication (MFA) for all administrative access and critical service-to-service communication. Implement robust logging and monitoring across the infrastructure, using Network and Endpoint Detection and Response (NDR/EDR) solutions to detect anomalous behavior indicative of lateral movement. Use egress filtering to prevent data exfiltration.",
        "check": "Are internal network segments and trust boundaries properly isolated? Is traffic between critical systems monitored for anomalies? Is access based on the principle of least privilege? Is strong authentication required for administrative and service-to-service communication?",
        "asvs": "Derived from BSI threat descriptions for Advanced Persistent Threats. Related concepts include BSI Bausteine DER.1 (Detection) and OPS.1.1.5 (Handling security incidents).",
        "cheatSheet": "https://www.bsi.bund.de/EN/Top@SystemType:ICS/Cyber-Security/Analyses-and-Trends/APT/apt_node.html",
        "detectionLogic": "This rule identifies high-value technical assets (high RAA, critical CIA ratings). It then checks for outgoing communication links to other high-value assets, which could serve as pathways for lateral movement. The risk is elevated if these pathways exist, especially across trust boundaries or with weak authentication, as they represent how an APT might expand their control after an initial compromise.",
        "riskAssessment": "The impact is determined by the sensitivity of the initial asset and the most critical asset it can reach. A high-value asset that can communicate with many other critical systems presents a very high impact. The likelihood is based on the number of potential lateral movement paths and the strength of the controls on those paths (e.g., authentication). An environment with many unrestricted pathways from one critical system to another is considered more likely to be exploited for lateral movement.",
        "falsePositives": "The model may flag legitimate and necessary communication between critical systems. This risk requires a qualitative assessment to confirm if the existing monitoring, authentication, and access control measures for these connections are sufficient to mitigate the threat of lateral movement.",
        "cwe": "288",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "DER.3.1": [
      {
        "file": "34_sec1.ts",
        "bsiCode": "DER.3.1",
        "id": "un-restarted-temporarily-disabled-security-measures",
        "title": "Security Measures Temporarily Disabled but Not Re-Enabled",
        "description": "The overall security level of an application or system depends on all security measures being implemented completely and correctly.",
        "impact": "If security controls are not re-enabled, the system operates at a lower security level than designed.",
        "action": "Establish and Enforce Secure Configuration and Change Management Processes",
        "mitigation": "Establish strict change management procedures that include checklists for disabling and re-enabling security functions.",
        "check": "Are there documented procedures for temporarily disabling and re-enabling security controls? Is there an automated system to verify the security configuration baseline against a golden image? Are alerts generated for disabled security controls?",
        "asvs": "V14.2 Configuration Verification",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Hardening_Cheat_Sheet.html",
        "detectionLogic": "This risk is common on systems that are manually configured or undergo frequent manual changes during deployment or maintenance.",
        "riskAssessment": "The likelihood is considered higher for systems requiring manual intervention during deployment or updates. The impact is directly related to the",
        "falsePositives": "This risk might be flagged for assets even if the organization has very mature, checklist-driven, or automated operational procedures that prevent this from happening.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "34_sec2.ts",
        "bsiCode": "DER.3.1",
        "id": "ineffective-or-uneconomical-security-measures",
        "title": "Ineffective or Uneconomical Security Measures",
        "description": "When security measures are implemented without considering practical aspects of their use, they might be ineffective or uneconomical.",
        "impact": "If security controls can be bypassed or are misapplied, assets they are meant to protect are exposed to threats, potentially leading to the compromise of their confidentiality, integrity, or availability. This can result in data breaches, system takeovers, and other security incidents despite the presence of security measures, creating a false sense of security.",
        "action": "Review and Harden Access Paths to Critical Assets",
        "mitigation": "Ensure that all access paths to a sensitive asset are protected with a consistent and appropriate level of security.",
        "check": "Review all incoming communication links to sensitive assets. Are there any links that lack authentication or encryption, especially when other links to the same asset are well-secured? Is it possible for an attacker to use a 'back door' to bypass the intended 'front door' security?",
        "asvs": "Based on BSI IT-Grundschutz CON.1 (Security concept and policies), which emphasizes the need for a coherent and appropriate set of security measures.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Security_concept_and_policies_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks for architectural inconsistencies in access control. It identifies sensitive technical assets that have at least one strongly authenticated incoming communication link but also at least one weak (unauthenticated) remote communication link. This constellation suggests a potential bypass of the intended security controls.",
        "riskAssessment": "The impact is determined by the CIA requirements of the asset being protected. A higher-value asset leads to a higher impact. The likelihood is considered high because the weak access path is readily available for exploitation. The risk is raised for each weak 'back door' path found.",
        "falsePositives": "A weak or unauthenticated link might be deliberately in place for a low-risk, public-facing function (like a health check endpoint that reveals no sensitive data), while authenticated links are for administrative access. This requires manual verification. However, unauthenticated access to sensitive systems is generally discouraged.",
        "cwe": "693",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "34_sec3.ts",
        "bsiCode": "DER.3.1",
        "id": "lack-of-independent-isms-review",
        "title": "Lack of Independent ISMS Review",
        "description": "In many institutions, the Information Security Officer (ISO) is responsible for verifying the implementation of security measures.",
        "impact": "If the ISMS is not independently and effectively audited, the overall security level of the institution can be significantly degraded.",
        "action": "Establish and Execute a Regular, Independent ISMS Audit Program",
        "mitigation": "Implement a formal process for regularly auditing the ISMS. These audits must be performed by a party independent of the Information Security Officer's direct operational responsibilities (e.g., a dedicated internal audit team or a qualified external third party).",
        "check": "Is there a documented process for auditing the ISMS? Are audits performed by a party independent of the ISO? Is there a recent audit report available? Are findings tracked to resolution?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium, Baustein ORP.3 'Internal Audit', specifically Requirement ORP.3.A3 'Independence of the auditors', which stresses the need for auditors to be independent of the activity being audited.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_Internal_audit_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.3)",
        "detectionLogic": "This is an organizational risk related to governance and process assurance. In a technical model, this risk is surfaced by attaching it to assets that are central to security management.",
        "riskAssessment": "The likelihood is considered HIGH if there is no established independent audit process for the ISMS. The impact is determined by the highest sensitivity of the assets and data managed under the ISMS, as a process failure at this level puts all protected assets at risk. The risk is calculated based on the CIA rating of the specific technical asset it is attached to in the model.",
        "falsePositives": "This risk is inherently organizational and cannot be validated from a technical model alone. The model surfaces the risk based on the presence of a security management role.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "34_sec4.ts",
        "bsiCode": "DER.3.1",
        "id": "inadequate-audit-or-review-orp-4-g1",
        "title": "Inadequate Audit or Review due to Unqualified or Unprepared Auditors (BSI ORP.4.G1)",
        "description": "If personnel conducting an audit or review are not sufficiently qualified or are inadequately prepared,",
        "impact": "A flawed audit can result in either an overestimation of security, leaving critical vulnerabilities unaddressed, or an underestimation,",
        "action": "Ensure Auditor Qualification and Preparation",
        "mitigation": "Ensure that internal and external auditors are appropriately qualified, independent, and have sufficient resources and time to prepare for and conduct audits.",
        "check": "Are there defined qualification criteria for auditors? Are audit plans and scopes documented? Are audit reports reviewed and tracked by management? Is there a process to ensure corrective actions are implemented and effective?",
        "asvs": "BSI IT-Grundschutz ORP.4 Audit and Review",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Audit_and_review_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This organizational risk is triggered by technical assets tagged with the `role:pruefer` (auditor/reviewer) tag.",
        "riskAssessment": "The likelihood is considered 'Likely' as a baseline, assuming a potential weakness in the organizational process for ensuring auditor qualification.",
        "falsePositives": "This risk is raised based on the presence of an audit-related role. The actual qualification and preparation of auditors cannot be determined from the technical model alone and requires reviewing the organization's audit processes and personnel qualifications.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "34_sec5.ts",
        "bsiCode": "DER.3.1",
        "id": "lack-of-central-audit-planning-orp2-a1",
        "title": "Lack of Central and Long-Term Audit Planning (BSI ORP.2.A1)",
        "description": "If audits and reviews are not planned centrally and for the long term, it can lead to an imbalanced audit scope.",
        "impact": "The primary impact is the inability to reliably assess the security status of the information system. Hidden vulnerabilities and non-compliance in unaudited areas may persist undetected.",
        "action": "Establish a Centralized, Risk-Based, and Strategic Audit Program",
        "mitigation": "Develop and implement a central, long-term audit plan that covers all relevant areas of the information system based on risk.",
        "check": "Is there a documented, long-term audit plan? Is the plan based on a risk assessment? Does it cover all critical systems and processes?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Information security auditing and review), Requirement ORP.2.A1 (Planning of information security audits).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Information_security_auditing_and_review_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.2)",
        "detectionLogic": "This is an organizational risk that cannot be detected directly from a technical model.",
        "riskAssessment": "The likelihood is considered 'Likely' as incomplete audit planning is a common organizational weakness.",
        "falsePositives": "This risk is inherently organizational. An organization might have a robust, centrally-managed audit program that is not reflected in the technical asset model.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "34_sec6.ts",
        "bsiCode": "DER.3.1",
        "id": "insufficient-audit-planning-orp3-g6",
        "title": "Insufficient Audit Planning (BSI ORP.3.G6)",
        "description": "If an audit or security check is poorly planned and not sufficiently coordinated with the institution, required personnel may not be available during the review.",
        "impact": "The primary impact is that existing security vulnerabilities, configuration errors, or non-compliance with security policies may go undetected.",
        "action": "Establish and Follow a Formal Audit and Security Check Process",
        "mitigation": "Define and implement a structured process for planning and conducting audits and security checks. This process must include clear communication channels,",
        "check": "Is there a documented procedure for planning audits and security checks? Are audit plans created, documented, and communicated in advance?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.3 (Security check and audit), Requirement ORP.3.A1 (Planning security checks).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_Security_check_and_audit_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.3)",
        "detectionLogic": "This is an organizational risk related to the audit process. It applies to technical assets that should be subject to audits.",
        "riskAssessment": "The likelihood is considered 'Likely' by default, as procedural gaps in audit planning are a common organizational weakness.",
        "falsePositives": "This risk is organizational and cannot be fully verified by the technical model alone. An organization might have a robust audit planning process.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "34_sec7.ts",
        "bsiCode": "DER.3.1",
        "id": "insufficient-compliance-with-co-determination-law",
        "title": "Insufficient Compliance with Co-determination Law during Audits",
        "description": "Data from audits and revisions can inadvertently contain information that allows for conclusions about employee performance.",
        "impact": "Violating co-determination laws can lead to legal disputes, fines, and a significant loss of trust between employees and management.",
        "action": "Establish Clear Policies for Audit Data Usage",
        "mitigation": "Clearly define and document the purpose of all auditing and logging activities, explicitly excluding employee performance evaluation.",
        "check": "Is there a written policy governing the use of audit and log data? Has the employee representation body formally approved this policy? Are access logs for audit data reviewed to prevent misuse?",
        "asvs": "Derived from user-provided BSI-style text. The principles align with BSI IT-Grundschutz Baustein DER.1 Data Protection, specifically requirements like DER.1.A6 'Involving the employee representation body'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Data_protection_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organizational risk is raised for technical assets that typically collect detailed, user-specific logs which could be repurposed for performance monitoring.",
        "riskAssessment": "The likelihood is considered 'Likely' if systems capable of detailed user logging exist, as the potential for misuse is inherent if policies are lacking.",
        "falsePositives": "This risk can only be confirmed by reviewing internal company policies and legal agreements with the employee representation body. A technical model cannot verify the existence or enforcement of such policies.",
        "cwe": "359",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "34_sec8.ts",
        "bsiCode": "DER.3.1",
        "id": "concealment-of-security-weaknesses-con1-a23",
        "title": "Concealment of Security Weaknesses (BSI CON.1.A23)",
        "description": "Employees, fearing that their mistakes will be discovered during audits, reviews, or testing, may attempt to conceal existing security problems or vulnerabilities. This can lead to a distorted and overly optimistic view of the actual security posture, leaving critical vulnerabilities unaddressed.",
        "impact": "Concealing vulnerabilities means they remain unaddressed and unmitigated, providing attackers with a persistent window of opportunity. The resulting false sense of security can lead to misinformed risk management decisions. Ultimately, this can result in severe security incidents, compromising the confidentiality, integrity, or availability of the system and associated data.",
        "action": "Foster a No-Blame Culture for Security Reporting",
        "mitigation": "Establish a clear, non-punitive process for reporting security weaknesses and errors. Management should actively promote a 'no-blame' culture where discovering and reporting vulnerabilities is rewarded, rather than punished. Emphasize that the goal of audits and reviews is system improvement, not assigning personal blame. Anonymous reporting channels can also help lower the barrier for employees to come forward.",
        "check": "Is there a formal policy for reporting security issues? Does the organizational culture encourage or discourage reporting errors? Are post-mortems of incidents focused on learning and improvement rather than blame? Are there anonymous reporting options available?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Security testing and exercises). This is an organizational risk related to human factors and company culture, which impacts the effectiveness of all technical verification and testing activities.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Security_testing_and_exercises_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This is an organizational risk related to human behavior and company culture. It cannot be detected automatically from a technical model. It is raised against assets that are likely to be subject to audits or reviews, especially those with custom-developed parts or those handling highly sensitive data, as the pressure to conceal failures is higher in these cases.",
        "riskAssessment": "The likelihood is HIGH in environments with a punitive or 'blame' culture and LOW in organizations with a mature, open, and blameless security culture. A 'Likely' exploitation is assumed as a baseline. The impact is directly proportional to the criticality (CIA) of the asset where a vulnerability is concealed. A hidden flaw in a mission-critical system has a 'Very High' impact.",
        "falsePositives": "This risk is always a potential false positive when generated from a technical model, as it depends entirely on the organizational culture, which cannot be modeled. Its presence should trigger a discussion about the company's security culture and reporting processes.",
        "cwe": "287",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.Tampering"
      }
    ],
    "DER.3.2": [
      {
        "file": "35_sec1.ts",
        "bsiCode": "DER.3.2",
        "id": "failure-to-implement-up-bund-2017",
        "title": "Failure to Implement UP Bund 2017 Requirements",
        "description": "The 'Umsetzungsplan für die Gewährleistung der IT-Sicherheit in der Bundesverwaltung' (UP Bund 2017) mandates that German federal agencies, and other institutions by law or contract, must implement an Information Security Management System (ISMS) based on BSI IT-Grundschutz standards. This includes using the standard security approach as a minimum requirement and regularly auditing the ISMS status using the 'Leitfaden für die Informationssicherheitsrevision'. Failure to establish, maintain, and regularly audit the ISMS in accordance with these requirements constitutes a direct violation of the UP Bund.",
        "impact": "Non-compliance with UP Bund 2017 can lead to significant legal, contractual, and financial penalties. It indicates a fundamental gap in the security governance, suggesting that required security controls (as defined by IT-Grundschutz) may be missing, unenforced, or unverified. This elevates the overall risk of security incidents, which could compromise the confidentiality, integrity, and availability of all information assets within the system's scope, leading to reputational damage and disruption of services.",
        "action": "Establish and Audit an ISMS based on BSI IT-Grundschutz",
        "mitigation": "Implement a comprehensive ISMS that fully aligns with the requirements of BSI IT-Grundschutz. This includes defining security policies, assigning responsibilities, implementing technical and organizational controls, and creating incident response plans. Crucially, conduct regular internal and external security audits based on the BSI's 'Leitfaden für die Informationssicherheitsrevision' to verify compliance and effectiveness. All audit findings must be tracked and remediated in a timely manner. Ensure that compliance documentation is maintained and readily available.",
        "check": "Is the organization obligated to comply with UP Bund 2017? Is a formal ISMS based on IT-Grundschutz established and actively maintained? Are regular IS audits, as required by the plan, being conducted and their results acted upon? Can compliance be demonstrated through documentation and audit reports?",
        "asvs": "Derived from German 'UP Bund 2017', which mandates the use of BSI IT-Grundschutz standards.",
        "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Oeffentliche-Verwaltung/IT-Grundschutz-in-Behoerden/it-grundschutz-in-behoerden_node.html",
        "detectionLogic": "This is an organizational compliance risk. In a Threagile model, it's triggered by the presence of the '@Compliance:UP-Bund-2017' tag on a technical asset. The risk assumes that if an asset falls under this regulation, the entire process of establishing and auditing an ISMS must be in place. The absence of such a process is the identified risk.",
        "riskAssessment": "The likelihood of this risk is considered high if the organization is subject to UP Bund 2017, as compliance is mandatory, but optional for non-OT system types. The impact is also inherently high due to the legal and procedural consequences of non-compliance. The impact is further elevated based on the CIA requirements of the assets governed by the regulation. A failure to implement the required security baseline exposes critical assets to a wide range of threats.",
        "falsePositives": "This risk can be considered a false positive if a robust, compliant, and regularly audited ISMS is indeed in place, but the threat model has not been updated to reflect this (e.g., via a risk tracking status change). Verification requires reviewing organizational compliance documentation, ISMS policies, and recent audit reports.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "35_sec10.ts",
        "bsiCode": "DER.3.2",
        "id": "concealment-of-security-deficiencies-during-audits",
        "title": "Concealment of Security Deficiencies during Audits (BSI-based)",
        "description": "Personnel might fear that an information security audit will reveal their mistakes. To avoid repercussions, they might conceal or downplay existing security problems, presenting a false picture of the actual security posture. This prevents the discovery and correction of security vulnerabilities.",
        "impact": "When security deficiencies are intentionally hidden, they remain uncorrected and can be exploited by attackers. Furthermore, management might misjudge the true risk level associated with a system, leading to poor security investment decisions and a false sense of security. This undermines the entire governance and audit process.",
        "action": "Foster a No-Blame Security Culture and Ensure Independent Audits",
        "mitigation": "Promote a security culture where reporting issues is encouraged and not punished. Ensure that security audits are conducted by independent parties (internal or external) who are separate from the teams being audited. Use automated tools for objective security scanning where possible. Establish clear procedures for reporting and remediating findings without assigning personal blame for unintentional errors. Management must communicate that the goal of audits is improvement, not punishment.",
        "check": "Is there a formal policy for 'no-blame' incident and vulnerability reporting? Are security audits performed by teams independent of the system owners/developers? Are audit results discussed constructively with a focus on remediation?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Information security governance), specifically opposing the principle of Requirement ORP.2.A5 (Reviewing information security), which requires transparent and regular reviews.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Information_security_governance_edition_2023.pdf?__blob=publicationFile (BSI ORP.2)",
        "detectionLogic": "This is an organizational and cultural risk. It is difficult to detect automatically. This rule raises the risk for technical assets where responsible personnel (like administrators or developers) might feel pressure to hide mistakes. It is triggered by assets tagged with specific roles.",
        "riskAssessment": "The likelihood is difficult to assess from the model alone but is assumed to be 'likely' in environments without a strong, blameless security culture. The impact is directly related to the criticality of the technical asset where a flaw is being concealed. Hiding a vulnerability on a mission-critical system has a very high impact.",
        "falsePositives": "This risk is inherently organizational and cultural. A model cannot verify the company culture. An organization might have a very healthy, open 'no-blame' culture, making this risk a false positive. Confirmation requires discussion with management and teams about audit processes and reporting culture.",
        "cwe": "1027",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "35_sec11.ts",
        "bsiCode": "DER.3.2",
        "id": "leakage-of-is-audit-information",
        "title": "Leakage of IS Audit Information (BSI ORP.3.A5)",
        "description": "During an information security audit, sensitive data such as identified vulnerabilities, security gaps, and potential attack vectors are collected and documented.",
        "impact": "If this audit information is leaked to unauthorized parties, it provides a direct roadmap for attacking the institution's systems.",
        "action": "Secure Handling and Storage of Audit Information",
        "mitigation": "Audit results and related documentation must be classified according to their sensitivity (e.g., 'Confidential' or 'Strictly Confidential').",
        "check": "Are audit results and reports classified and access-controlled? Are the systems storing this data hardened and monitored? Is encryption used for audit data storage and transmission?",
        "asvs": "BSI IT-Grundschutz ORP.3.A5 (Handling of audit results)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_Audit_and_review_of_information_security_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for technical assets that are likely to process or store sensitive IS audit information.",
        "riskAssessment": "The impact of a leak is determined by the sensitivity of the audit data, which is represented by the confidentiality rating of the technical asset or the data it handles.",
        "falsePositives": "The risk may be a false positive if the identified asset is part of a highly secured, segregated audit environment with strict access controls, even if n@SystemType:OT explicitly modeled as such.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "35_sec2.ts",
        "bsiCode": "DER.3.2",
        "id": "disabled-security-controls-reenabled",
        "title": "Security Controls Re-enabled (based on BSI)",
        "description": "The security level of an institution is influenced by whether security measures are implemented completely and correctly.",
        "impact": "Failure to re-enable security controls after temporary suspension leads to a persistent state of vulnerability.",
        "action": "Implement and Enforce Strict Change Management and Post-Change Validation Processes",
        "mitigation": "Establish a formal, audited process for temporarily disabling and re-enabling any security control.",
        "check": "Is there a formal change management process for altering security configurations? Is there an automated system to verify the security posture of assets after deployment or maintenance?",
        "asvs": "OWASP Top 10 2021: A05-Security Misconfiguration",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for technical assets and communication links where there's a contextual reason to believe security measures might be temporarily disabled.",
        "riskAssessment": "The likelihood of this risk is higher for assets undergoing frequent changes or active development.",
        "falsePositives": "This risk may be flagged for assets within a well-managed CI/CD pipeline where automated post-deployment checks already mitigate this process failure.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "35_sec3.ts",
        "bsiCode": "DER.3.2",
        "id": "impractical-or-ineffective-security-measures-bsi",
        "title": "Impractical or Ineffective Security Measures (BSI-style)",
        "description": "If security measures are implemented without taking practical aspects into account, these measures may be ineffective. For example, it is pointless to block an entrance area with turnstiles if employees can enter the building through an open side entrance instead. It can also happen that individual measures are taken that do not make economic sense. For example, for the protection of information with a normal need for protection with regard to confidentiality, an appropriately implemented rights and roles concept is more sensible and economical than setting up complex, certificate-based encryption on the file server.",
        "impact": "Ineffective measures create a false sense of security while leaving critical vulnerabilities open. This can result in security controls being bypassed, leading to unauthorized access, data breaches (loss of Confidentiality), data manipulation (loss of Integrity), or service disruption (loss of Availability). Over-engineered controls can increase complexity and cost without providing proportional security benefits.",
        "action": "Review and Refine Security Architecture and Control Selection",
        "mitigation": "Ensure security controls are placed appropriately within the data flow to be effective. For internet-facing systems, sensitive backend components should not be directly exposed. Instead, traffic should be routed through dedicated entry-point components like Reverse Proxies, WAFs, or API Gateways. Regularly review the architecture to identify and eliminate bypass routes. For data protection, select controls (like encryption) that are appropriate for the data's classification level to balance security with operational and economic viability.",
        "check": "Are there direct communication paths from untrusted networks (like the internet) to sensitive backend services, bypassing intended security controls (like WAFs, proxies)? Are the implemented security measures, such as encryption levels, proportional to the protection requirements of the assets?",
        "asvs": "Derived from BSI IT-Grundschutz principles. Aligns with OWASP Top 10 2021: A04 - Insecure Design.",
        "cheatSheet": "https://owasp.org/Top10/A04_2021-Insecure_Design/",
        "detectionLogic": "This rule identifies two potential architectural flaws: 1. A 'bypassed control' where an internet-exposed asset, which is not a typical gateway/proxy, communicates directly with a sensitive backend component. 2. An 'over-engineered control' where a datastore uses very strong encryption for data of only low-to-medium confidentiality.",
        "riskAssessment": "For bypassed controls, the likelihood is high if a direct, unfiltered path exists, and the impact is based on the CIA requirements of the target asset. For over-engineered controls, the risk is typically lower and relates more to operational complexity and cost, but can still indicate a misunderstanding of security requirements.",
        "falsePositives": "A direct connection might be intentionally designed and secured through other means (e.g., strong endpoint security, specific protocol hardening). A strong encryption choice might be a preemptive measure or required by a blanket policy. Manual verification is required.",
        "cwe": "501",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "35_sec4.ts",
        "bsiCode": "DER.3.2",
        "id": "lack-of-impartial-isms-audit",
        "title": "Lack of Impartial ISMS Audit (BSI ORP.4)",
        "description": "In many organizations, the Information Security Officer (ISO) is responsible for verifying the implementation of security measures.",
        "impact": "If the ISMS is not reviewed by an impartial entity, significant weaknesses in security governance, processes, and controls may go undetected.",
        "action": "Establish an Independent Audit Function for the ISMS",
        "mitigation": "Ensure that the ISMS is regularly audited by personnel who are independent of the ISMS management function (i.e., not the ISO).",
        "check": "Is there a documented process for auditing the ISMS? Is the entity (person or team) performing the ISMS audit demonstrably independent from the ISO and their team?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein ORP.4 (Internal and external audit), specifically Requirement ORP.4.A6 (Performing internal audits), which emphasizes the need for auditor objectivity and impartiality.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Internal_and_external_audit_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
        "detectionLogic": "This organizational risk is detected by checking for the presence of an Information Security Officer ('@Role:ITSecurityOfficer')",
        "riskAssessment": "The likelihood is considered 'Likely' if an ISO is defined without an independent auditor, as this structural conflict of interest directly enables the risk.",
        "falsePositives": "A false positive may occur if the audit function is performed by an external party not documented in the threat model, or if an internal asset performs audits but is not tagged with the 'role:pruefer' tag.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "35_sec5.ts",
        "bsiCode": "DER.3.2",
        "id": "inadequate-auditor-qualification-and-preparation",
        "title": "Inadequate Auditor Qualification and Preparation (BSI DER.2)",
        "description": "If an audit team ('Prüfteam') is not sufficiently qualified or prepares inadequately for audits,",
        "impact": "Flawed audit findings can result in a false sense of security, where critical vulnerabilities remain unaddressed.",
        "action": "Establish and Enforce a Formal Process for Auditor Selection and Audit Preparation",
        "mitigation": "Define clear, stringent qualification criteria for both internal and external auditors based on the scope and complexity of the systems being audited.",
        "check": "Is there a formal policy for selecting IS auditors? Are qualification criteria documented and enforced?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium: Baustein DER.2 'IS-Revision', particularly requirements DER.2.A5 'Auswahl geeigneter IS-Revisoren' (Selection of suitable IS auditors) and DER.2.A6 'Planung und Vorbereitung der IS-Revision' (Planning and preparation of the IS audit).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/der/DER_2_IS-Revision_Edition_2023.html",
        "detectionLogic": "This is an organizational risk related to the audit process. It can be raised against technical assets that are typically subject to or involved in security audits.",
        "riskAssessment": "The likelihood is considered 'Likely' if there's no formal, enforced process for auditor qualification and preparation.",
        "falsePositives": "This risk is organizational and cannot be fully confirmed by the technical model alone.",
        "cwe": "287",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "35_sec6.ts",
        "bsiCode": "DER.3.2",
        "id": "biased-internal-audit-team",
        "title": "Biased Internal IT Audit Team (BSI ORP.3.A3)",
        "description": "Internal IT audit teams may lack independence if they are not sufficiently separated from other processes.",
        "impact": "A biased audit compromises the reliability of security assessments, potentially causing security vulnerabilities to be overlooked,",
        "action": "Ensure Independence of the Audit Team",
        "mitigation": "Establish and enforce a clear policy on auditor independence and conflict of interest. Ensure that internal audit members do not audit processes,",
        "check": "Is there a documented policy defining auditor independence? Are internal auditors organizationally separate from the teams responsible for ISMS implementation and operations?",
        "asvs": "BSI IT-Grundschutz ORP.3 ISMS audit, Requirement ORP.3.A3 Independence of the auditors.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_ISMS_audit_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organizational risk is detected by identifying technical assets that represent an auditing function (tagged with 'role:pruefer')",
        "riskAssessment": "The likelihood is considered high if a clear conflict of interest is identified in the model via tags. The impact is derived from the",
        "falsePositives": "A technical asset might be generically tagged and may not accurately represent the distinct roles of the personnel involved.",
        "cwe": "269",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "35_sec7.ts",
        "bsiCode": "DER.3.2",
        "id": "lack-of-central-audit-planning-rev1.a4",
        "title": "Lack of Central and Long-Term Audit Planning (BSI REV.1.A4)",
        "description": "If information security audits/revisions are not planned centrally and for the long term, some organizational units or systems might be audited frequently while others are not audited at all. Also, changes to the ISMS (Information Security Management System) might not be adequately examined if audits are irregular. This makes it very difficult or impossible to properly assess the security posture of the entire information system.",
        "impact": "Unaudited areas may harbor undetected vulnerabilities, and security controls for new or changed components may not be verified. This leads to an increased risk of security incidents, non-compliance with regulations, and potential data breaches, as the actual security state of the system cannot be reliably determined.",
        "action": "Establish a Centralized and Regular Audit Program",
        "mitigation": "Develop and implement a formal, long-term audit plan that is managed centrally. The plan should define the scope, frequency, and methodology for audits across all organizational units and information systems. It must ensure regular coverage of all critical areas and include provisions for ad-hoc audits in response to significant changes or security incidents. The audit plan should be approved by management and communicated to relevant stakeholders.",
        "check": "Is there a formal, documented information security audit plan? Is it managed centrally? Does it specify scope and frequency for all critical systems? Is there a process for auditing significant changes to the system?",
        "asvs": "BSI IT-Grundschutz Kompendium 2023: Baustein REV.1 Revision, Anforderung REV.1.A4 Planung der IS-Revision.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/rev/REV_1_Revision_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This is a fundamental organizational risk that applies to the entire modeled system. The risk is generated if the model contains at least one in-scope, high-value technical asset, as the absence of a structured audit process poses a significant threat to such assets. The risk is raised once for the entire system, with its impact scaled by the highest criticality asset found.",
        "riskAssessment": "The likelihood is considered 'Likely' by default, assuming the absence of a formal audit plan is a significant process gap. The impact is directly correlated with the highest confidentiality and criticality of the data and assets within the system. If mission-critical or strictly confidential assets exist, the impact is 'High' or 'Very High', as their security posture cannot be reliably verified.",
        "falsePositives": "This risk is organizational and cannot be validated purely from a technical model. The organization may have a robust audit program that is not represented in the model. Verification requires checking for an official, management-approved audit plan and schedule.",
        "cwe": "732",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "35_sec8.ts",
        "bsiCode": "DER.3.2",
        "id": "inadequate-is-audit-planning-orp3-a1",
        "title": "Inadequate IS Audit Planning (BSI ORP.3.A1)",
        "description": "If an Information Security (IS) audit is poorly planned and not properly coordinated with the responsible personnel, the required subject matter experts may not be available during the on-site inspection.",
        "impact": "A poorly planned or executed audit provides a false sense of security. Undiscovered vulnerabilities or compliance gaps can be exploited later,",
        "action": "Establish and Follow a Formal IS Audit Planning and Coordination Process",
        "mitigation": "Define and enforce a formal process for planning and conducting IS audits. This process must include proactive coordination with all relevant stakeholders to ensure personnel availability and access to necessary systems, evidence, and documentation.",
        "check": "Is there a documented process for IS audit planning? Are audit schedules consistently coordinated with the affected departments and personnel?",
        "asvs": "BSI IT-Grundschutz Baustein ORP.3 IS-Revision, Requirement ORP.3.A1 Planung der IS-Revision (Planning of the IS audit).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_3_IS_revision_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This is an organizational risk that applies to any system requiring security assurance. In a technical model, this risk is raised for any in-scope assets that are highly sensitive (and thus require thorough auditing)",
        "riskAssessment": "The likelihood is considered 'Likely' if a formal, coordinated audit planning process is absent or ineffective. The impact is directly dependent on the business criticality (CIA) of the assets under audit.",
        "falsePositives": "This risk is procedural and organizational; its existence cannot be confirmed by a technical model alone. The organization may have a robust audit planning process that is not reflected in the model.",
        "cwe": "668",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "35_sec9.ts",
        "bsiCode": "DER.3.2",
        "id": "is-audit-as-performance-monitoring-der3.a1",
        "title": "IS Audit as Performance Monitoring without Staff Council Involvement (BSI DER.3.A1)",
        "description": "During IS audits, aspects can be checked that could allow conclusions to be drawn about how personnel behave at work and how capable they are.",
        "impact": "Failure to involve the staff council when an audit could be perceived as performance monitoring can lead to the delay or cancellation of crucial security audits.",
        "action": "Ensure Staff Council Involvement in IS Audits",
        "mitigation": "Establish and follow a formal process for planning IS audits that includes the timely and appropriate involvement of the staff council, especially when employee performance or behavior data might be collected or analyzed.",
        "check": "Is there a documented process for involving the staff council in IS audit planning? Is the staff council regularly consulted before audits that could involve employee data are conducted? Is there evidence (e.g., meeting minutes, official agreements) of this involvement?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein DER.3 Revision, Requirement DER.3.A1 Einbindung der Personalvertretung (Involvement of the staff council).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/der/DER_3_Revision_Edition_2023.pdf?__blob=publicationFile (BSI DER.3 German)",
        "detectionLogic": "This is an organizational risk that applies to technical assets used for auditing and monitoring purposes.",
        "riskAssessment": "The likelihood is considered high if a formal process for involving the staff council is missing or not followed.",
        "falsePositives": "This risk is inherently organizational. A technical model cannot definitively know if the staff council was involved.",
        "cwe": "213",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "DER.4": [
      {
        "file": "36_sec1.ts",
        "bsiCode": "DER.4",
        "id": "personnel-failure-knowledge-monopoly",
        "title": "Personnel Failure / Knowledge Monopoly (BSI ORP.4.A23)",
        "description": "The failure or absence of key personnel can prevent an organization from performing its core tasks and business processes.",
        "impact": "If a non-redundant, critical system can no longer be operated due to personnel failure, its availability is directly compromised.",
        "action": "Implement Redundancy, Knowledge Transfer, and Contingency Planning",
        "mitigation": "Ensure that no single person is the only one capable of operating or maintaining a critical system.",
        "check": "Is the technical asset marked as redundant in the model? Is there a documented and tested contingency plan for this asset/service?",
        "asvs": "BSI IT-Grundschutz ORP.4: Notfallmanagement (Contingency Management), Requirement ORP.4.A23: Regelungen für den Personalausfall (Regulations for personnel failure).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Notfallmanagement.html",
        "detectionLogic": "This rule triggers for any technical asset that is N@SystemType:OT marked as 'redundant' and has a 'Critical' or 'Mission-Critical'",
        "riskAssessment": "The likelihood of a single person or a single non-redundant component eventually failing is considered 'Likely'.",
        "falsePositives": "A risk might be flagged for an asset that has organizational redundancy (e.g., a team of administrators sharing a role)",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "36_sec2.ts",
        "bsiCode": "DER.4",
        "id": "component-failure-endangering-availability-con1",
        "title": "Component Failure Endangering Availability (BSI CON.1)",
        "description": "If components of an IT system fail, for example due to defective hardware or a power outage, the entire IT operation can be disrupted.",
        "impact": "A failure of a critical, non-redundant component leads to a denial of service, directly impacting the availability of the technical asset,",
        "action": "Implement Redundancy and High-Availability Measures",
        "mitigation": "Ensure that critical system components have a redundant design. The easiest way to model this mitigation is to set the 'redundant' flag to 'true' for the affected technical asset.",
        "check": "Are critical technical assets configured for high availability? Is the 'redundant' flag set to true in the model for these assets? Are there documented and tested disaster recovery and business continuity plans?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Redundant IT Systems) and INF.5 (Power Supply).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Redundant_IT_systems_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers for any in-scope technical asset that is marked as `redundant`. The risk is particularly high for assets with high availability requirements.",
        "riskAssessment": "The impact is derived directly from the 'availability' rating of the technical asset and the data it handles. A non-redundant asset with 'mission-critical' availability poses a 'very-high' impact risk. The likelihood is generally considered 'likely' as component and power failures are common operational risks.",
        "falsePositives": "The risk might be a false positive if redundancy is handled outside the component itself (e.g., at a higher infrastructure layer) but modeled as such. For low-impact, non-critical components, accepting this risk might be a valid business decision.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "36_sec3.ts",
        "bsiCode": "DER.4",
        "id": "wan-outage",
        "title": "Wide Area Network (WAN) Outage (BSI-Style)",
        "description": "The causes of a Wide Area Network (WAN) failure can be diverse, affecting individual users, a provider, or an entire region.",
        "impact": "A WAN outage primarily affects the availability of services and business processes that depend on this connectivity. This can lead to reduced productivity,",
        "action": "Ensure Redundancy and High Availability for WAN Connections",
        "mitigation": "Use redundant WAN links, preferably from different providers, to mitigate single points of failure.",
        "check": "Are critical services connected via redundant WAN links? Are these links from different providers? Is there an automatic failover mechanism?",
        "asvs": "BSI IT-Grundschutz: NET.3.2 Wide Area Network",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Wide_Area_Network_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies all communication links that cross a network-only trust boundary (e.g., between on-premise and cloud, or between two data centers),",
        "riskAssessment": "The likelihood of a temporary WAN outage is considered 'Likely'. The impact is determined by the highest availability requirement of the technical assets",
        "falsePositives": "This risk might be a false positive if the communication link, while traversing a WAN, is used for non-critical purposes that can tolerate outages.",
        "cwe": "755",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "36_sec4.ts",
        "bsiCode": "DER.4",
        "id": "unavailability-of-premises",
        "title": "Unavailability of Premises (BSI INF.5)",
        "description": "Buildings can become unexpectedly unusable, for example, because they have been partially or completely destroyed by fire, storm, flood, earthquake, or an explosion.",
        "impact": "If a physical location housing IT infrastructure becomes unavailable, all business and technical processes dependent on that infrastructure will be disrupted or completely halted.",
        "action": "Implement Business Continuity and Disaster Recovery Plans",
        "mitigation": "To mitigate the risk of premises unavailability, organizations should implement a robust Business Continuity Plan (BCP) and Disaster Recovery Plan (DRP). Key measures include:",
        "check": "Is there a documented and tested Business Continuity Plan? Does it account for the total failure of the primary physical location? Are there redundant systems in a separate physical location?",
        "asvs": "BSI IT-Grundschutz INF.5: Building, BSI 200-4: Business Continuity Management",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Building_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is automatically raised for each trust boundary representing a physical, on-premise location ('network-on-prem' or 'network-dedicated-hoster' types).",
        "riskAssessment": "The likelihood of a catastrophic event is considered 'unlikely' by default but represents a high-impact threat that must be considered in business continuity planning.",
        "falsePositives": "This risk might be considered a false positive if the model uses an 'on-prem' trust boundary for logical grouping rather than representing a single physical building susceptible to a single point of failure.",
        "cwe": "0",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "36_sec5.ts",
        "bsiCode": "DER.4",
        "id": "dependency-on-external-service-availability",
        "title": "Dependency on External Service Availability (BSI CON.3)",
        "description": "Institutions often depend on external services and suppliers. A partial or complete failure of such a service provider can quickly lead to interruptions in the institution's own business continuity.",
        "impact": "If an external service that a critical business process depends on fails, it can lead to a direct interruption of that process. This can result in an inability to perform key business functions, leading to financial losses, reputational damage, and failure to meet service-level agreements (SLAs) with customers. The availability of the system is compromised.",
        "action": "Implement Redundancy and Business Continuity Planning for External Dependencies",
        "mitigation": "For critical dependencies, ensure that contracts with service providers include specific SLAs for availability and that performance is monitored.",
        "check": "Are critical external service dependencies identified and documented? Are availability SLAs defined in contracts? Is the internal system designed to be resilient to the failure of this dependency? Is this scenario covered in the business continuity plan?",
        "asvs": "BSI IT-Grundschutz Kompendium: CON.3 Business Continuity Management",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Business_continuity_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule scans for communication links from in-scope technical assets with high-availability requirements to external entities or assets marked as out-of-scope. The risk is elevated if the internal, dependent asset is configured for redundancy.",
        "riskAssessment": "The impact is derived directly from the availability requirement of the internal asset that depends on the external service. A 'Mission-Critical' asset failing has a 'Very High' impact. The likelihood of exploitation (i.e., the provider failing) is considered 'Likely' by default. This likelihood is reduced if the dependent internal component is modeled as redundant, assuming it can fail over to a working instance.",
        "falsePositives": "The dependency might be on a non-critical feature of the external service captured in the model's granularity. The external service may have an extremely high, contractually guaranteed uptime that makes failure 'Unlikely' in practice. The model might capture complex, multi-layered business continuity or disaster recovery strategies that mitigate this risk.",
        "cwe": "1174",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "IND.1": [
      {
        "file": "37_sec1.ts",
        "bsiCode": "IND.1",
        "id": "harsh-environmental-conditions-for-@SystemType:ICS-components",
        "title": "Harsh Environmental Conditions for Physical Components (BSI CON.1.A9)",
        "description": "Components in industrial, on-premise, or uncontrolled environments are often exposed to adverse conditions that can impair safe operation.",
        "impact": "The primary impact of component failure due to environmental stress is a loss of availability (Denial of Service).",
        "action": "Implement Physical and Environmental Protections",
        "mitigation": "Ensure that all physical components (servers, network devices, @SystemType:ICS/I@SystemType:OT hardware) are suitable for their operating environment.",
        "check": "Are physical assets installed in environments that protect them from temperature extremes, humidity, dust, and vibration?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium Baustein CON.1 (Physical Environmental Protection), specifically requirement CON.1.A9 (Protection against environmental damage).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Physical_environmental_protection_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified for technical assets that are explicitly marked as being in a harsh environment via the `@Environment:Harsh` tag.",
        "riskAssessment": "The likelihood of failure is considered higher for assets explicitly tagged for harsh environments.",
        "falsePositives": "A risk might be flagged for an asset that has adequate, but un-modeled, physical protections (e.g., a ruggedized server case or a climate-controlled cabinet).",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "37_sec10.ts",
        "bsiCode": "IND.1",
        "id": "insecure-component-procurement",
        "title": "Insecure Component Procurement (based on BSI)",
        "description": "Due to insufficient security requirements and cost-cutting measures, information security is often neglected during the procurement of components.",
        "impact": "Acquiring components with inherent flaws introduces vulnerabilities directly into the system architecture.",
        "action": "Establish and Enforce Secure Procurement Policies",
        "mitigation": "Define and enforce a secure procurement policy that mandates security assessments for all third-party components (hardware and software) before acquisition.",
        "check": "Is there a formal security policy for procuring third-party assets? Are security assessments part of the purchasing process?",
        "asvs": "V14.2 Supply Chain",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Software_Supply_Chain_Security_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for any technical asset that is marked as custom-developed for n@SystemType:OT (`custom_developed_parts: false`).",
        "riskAssessment": "The likelihood is considered higher for complex, sensitive, or opaque systems (e.g., devices from n@SystemType:OT, ERPs, mainframes, security appliances).",
        "falsePositives": "This risk may be a false positive if an organization has a robust secure procurement process in place but has documented it in the model using the 'procurement-process-followed' tag.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "37_sec11.ts",
        "bsiCode": "IND.1",
        "id": "insecure-@SystemType:OT-protocol-@SystemType:ICS-t5-21",
        "title": "Insecure @SystemType:OT/@SystemType:ICS Protocol Usage (BSI @SystemType:ICS.T.5.21)",
        "description": "Industrial Control System (@SystemType:ICS) and Operational Technology (@SystemType:OT) components often use specialized network protocols that were not designed with security in mind.",
        "impact": "Successful exploitation can lead to a compromise of Confidentiality (eavesdropping on process data), Integrity (manipulating commands or data), and Availability (disrupting or stopping processes).",
        "action": "Use Secure Communication Protocols and Network Segmentation",
        "mitigation": "Whenever possible, use protocols that provide end-to-end encryption, integrity protection, and mutual authentication (e.g., OPC UA with a security policy, Modbus-Secure).",
        "check": "Are all communication links to and from @SystemType:OT/@SystemType:ICS components using encrypted protocols? If not, is the traffic tunneled over a VPN?",
        "asvs": "BSI IT-Grundschutz Kompendium: NET.3.2 @SystemType:ICS-Protokolle, @SystemType:ICS.1 Allgemeine @SystemType:ICS-Komponente",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Kompendium_Edition_2023.pdf?__blob=publicationFile (Search for NET.3.2)",
        "detectionLogic": "This rule triggers for any communication link involving an @SystemType:OT/@SystemType:ICS-style asset (e.g., technology 'i@SystemType:OT-device', 'mainframe', or tagged with '@SystemType:OT-asset') that uses an unencrypted protocol.",
        "riskAssessment": "The impact is calculated based on the Confidentiality, Integrity, and Availability ratings of the data assets being transferred.",
        "falsePositives": "The rule might trigger for protocols that have security features enabled at the application layer which are not captured in the model's protocol definition.",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "37_sec12.ts",
        "bsiCode": "IND.1",
        "id": "insecure-default-configuration-of-@SystemType:ICS-components",
        "title": "Insecure Default Configuration of @SystemType:ICS Components (related to BSI CON.1)",
        "description": "In the default configuration of @SystemType:ICS components, security measures are n@SystemType:OT always enabled. This can allow unauthorized individuals to easily gain access.",
        "impact": "If this vulnerability is exploited, an attacker could gain unauthorized access to the @SystemType:ICS component, leading to data theft, system manipulation, or a complete denial of service. This can compromise the confidentiality, integrity, and availability of the controlled industrial process, potentially causing physical damage, production downtimes, and safety hazards.",
        "action": "Harden @SystemType:ICS Component Configuration",
        "mitigation": "All @SystemType:ICS components must be hardened before being deployed into production. This includes changing all default passwords, disabling unnecessary services and physical interfaces (like USB ports), enabling and correctly configuring built-in security functions, and ensuring that encrypted protocols (like SSH) are used for all administrative access. A standardized hardening checklist specific to the component type should be developed and consistently applied.",
        "check": "Are all @SystemType:ICS components configured according to a security hardening guide before deployment? Are default passwords changed? Are administrative protocols encrypted? Are all unnecessary services and interfaces disabled?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (General @SystemType:ICS System), especially requirements like CON.1.A10 (Secure basic configuration of @SystemType:ICS components) and CON.1.A11 (Disabling unused interfaces and services on @SystemType:ICS components).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_ICS_system_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks for technical assets representing Industrial Control Systems (@SystemType:ICS), identified either by the 'IoTDevice' technology type or the '@SystemType:ICS-component' tag. It flags risks if it discovers administrative communication links ('devops' usage) that are either unencrypted or lack any form of authentication, as these are common signs of an insecure default configuration.",
        "riskAssessment": "The likelihood of exploitation is high for unencrypted or unauthenticated administrative interfaces, as these are common targets. The impact is determined by the criticality (CIA) of the @SystemType:ICS component itself and the data it processes or stores. A compromise of an @SystemType:ICS component controlling a critical process has a very high impact.",
        "falsePositives": "The risk might be flagged for a protocol that is seemingly unencrypted but secured by a separate mechanism n@SystemType:OT modeled (e.g., a VPN, which is checked for). A link using 'credentials' authentication might have a strong, non-default password, which the model cann@SystemType:OT verify. Manual verification of the component's configuration is always necessary.",
        "cwe": "798",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "37_sec13.ts",
        "bsiCode": "IND.1",
        "id": "dependency-on-external-systems-@SystemType:OT",
        "title": "Dependency of @SystemType:OT Systems on External IT Infrastructures (BSI-@SystemType:OT-Dependence-IT)",
        "description": "Operational Technology (@SystemType:OT) is increasingly no longer operated in a fully self-sufficient manner. When dependencies on other systems, networks, or services exist, failures or security incidents in the IT network can directly impact the @SystemType:OT environment. Especially when these dependent systems and networks are not directly controlled by the @SystemType:OT operator, the availability of @SystemType:OT systems and their associated processes can be severely impaired. Furthermore, resolving such incidents often requires external support, leading to delays.",
        "impact": "A failure or security incident in a dependent IT system (e.g., shared infrastructure, cloud service, remote access connection) can directly disrupt or halt @SystemType:OT processes, leading to production downtime, safety risks, and financial losses. Incident response can be delayed as it often depends on external parties.",
        "action": "Reduce and Harden Dependencies of @SystemType:OT Systems",
        "mitigation": "Minimize dependencies of @SystemType:OT systems on external or shared IT services wherever possible. For unavoidable dependencies, ensure the target IT service is designed for high availability and redundancy (e.g., clustered services, redundant network links). Implement strict access controls and monitoring at the IT/@SystemType:OT boundary using firewalls or data diodes. Use dedicated, hardened infrastructure for services critical to @SystemType:OT. Establish clear Service Level Agreements (SLAs) and joint incident response procedures with external service providers.",
        "check": "Are all communication links from @SystemType:OT assets to non-@SystemType:OT assets identified and justified? Are the target IT systems designed and operated for high availability? Are there contingency plans in case a dependent IT service fails? Are SLAs in place for externally managed services?",
        "asvs": "Derived from BSI IT-Grundschutz, specifically concepts in OPS.1.2 (Network and connections) and NET.1.1 (Network architecture) applied to an @SystemType:OT context. The risk description is based on observations from the BSI's guidance on @SystemType:OT security.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/@SystemType:ICS/BSI-CS_108_EN.pdf?__blob=publicationFile (BSI - Industrial Control System Security)",
        "detectionLogic": "This rule triggers risks in two scenarios: 1. When a technical asset tagged as `@SystemType:OT-Asset` has a communication link to an asset that is not part of the @SystemType:OT environment (i.e., not tagged `@SystemType:OT-Asset`). 2. When an `@SystemType:OT-Asset` runs on a Shared Runtime that also hosts non-@SystemType:OT assets, creating a dependency via a shared execution environment.",
        "riskAssessment": "The impact is determined by the availability requirement of the @SystemType:OT asset. A dependency for a 'mission-critical' @SystemType:OT asset results in a very high impact. The likelihood is considered `likely` or higher if the dependency is on a standard, non-redundant IT service or an internet-based service. The likelihood can be reduced if the target service is modeled as `redundant`.",
        "falsePositives": "The risk might be overstated if the target IT service is implicitly highly available (e.g., a major public cloud provider's core API) but not marked as `redundant` in the model. The dependency might be for non-critical, asynchronous tasks (like sending logs) that do not impact core @SystemType:OT functions in real-time.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "37_sec2.ts",
        "bsiCode": "IND.1",
        "id": "it-@SystemType:OT-security-policy-conflict",
        "title": "IT/@SystemType:OT Security Policy Conflict (based on BSI @SystemType:ICS recommendations)",
        "description": "Different frameworks, knowledge, and procedures in Office IT and Operational Technology (@SystemType:OT) can lead to implementation problems for overarching security requirements. Security specifications from the Office IT environment may not be feasible in @SystemType:ICS systems due to technical or procedural peculiarities. Conversely, @SystemType:OT-specific information security and functional safety aspects may not be known to Office IT security officers. This can result in friction in communication and implementation, and risks might not be identified or addressed adequately.",
        "impact": "Failure to harmonize IT and @SystemType:OT security policies can lead to improperly configured security controls, creating vulnerabilities. This can compromise the Integrity and Availability of critical @SystemType:OT/@SystemType:ICS systems, potentially causing production outages, physical damage, or safety incidents. It also opens pathways for attackers to pivot from less-secure IT environments into the highly sensitive @SystemType:OT network.",
        "action": "Harmonize IT and @SystemType:OT Security Policies and Controls",
        "mitigation": "Establish a joint IT/@SystemType:OT security governance team. Conduct a unified risk assessment that considers the specific constraints and safety requirements of the @SystemType:OT environment. Adapt generic IT security policies to be applicable and effective for @SystemType:ICS components. Use security gateways, DMZs, or data diodes to create strictly controlled communication channels between IT and @SystemType:OT networks. Ensure cross-functional training and awareness for both IT and @SystemType:OT personnel.",
        "check": "Is there a dedicated, documented security architecture for IT/@SystemType:OT integration? Are security controls on communication links between IT and @SystemType:OT (e.g., firewalls, proxies) configured with @SystemType:OT-specific rule sets? Do IT and @SystemType:OT teams conduct joint change management and incident response planning?",
        "asvs": "BSI IT-Grundschutz IND.2.2 Network Architecture for @SystemType:ICS",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/IND/IND_2_2_Network_architecture_for_ICS_Edition_2023.pdf",
        "detectionLogic": "Detects communication links between technical assets tagged as part of the IT domain (e.g., '@Domain:IT') and assets tagged as part of the @SystemType:OT/@SystemType:ICS domain (e.g., '@SystemType:OT', '@SystemType:ICS'). The risk is heightened if the communication link lacks strong authentication or encryption.",
        "riskAssessment": "The likelihood is high if the connection between IT and @SystemType:OT is direct and lacks specific security controls. The impact is determined by the criticality of the connected @SystemType:OT asset. A connection to a Mission-Critical @SystemType:OT asset results in a very high impact, as a compromise could affect physical processes.",
        "falsePositives": "A model might generate a false positive if a specialized security appliance (like a data diode or an @SystemType:OT-aware firewall) that mitigates the risk is modeled simply as a generic asset, or if its specific filtering capabilities are not captured in the model's tags.",
        "cwe": "1123",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "37_sec3.ts",
        "bsiCode": "IND.1",
        "id": "inadequate-@SystemType:OT-change-management",
        "title": "Inadequate Change Management in @SystemType:OT Environments",
        "description": "While Operational Technology (@SystemType:OT) and IT are converging, there are unique characteristics of @SystemType:ICS that complicate the transfer of established IT operational processes.",
        "impact": "Disruptions in @SystemType:OT systems, which monitor and control physical processes, can lead to production outages, physical damage to equipment, harm to personnel, and environmental damage.",
        "action": "Establish and Enforce @SystemType:OT-Specific Change and Incident Management Procedures",
        "mitigation": "Develop, document, and enforce change management processes tailored specifically for @SystemType:OT/@SystemType:ICS assets. These processes must integrate safety, engineering, and regulatory considerations.",
        "check": "Are there documented change and incident management processes specifically for @SystemType:OT/@SystemType:ICS assets? Do these processes account for safety, regulatory, and vendor support constraints? Are changes logged and approved by relevant stakeholders (e.g., engineering, safety teams)?",
        "asvs": "Derived from BSI IT-Grundschutz, particularly the Industrial Control Systems (@SystemType:ICS) overlay. While related to general processes like OPS.1.1.5 (Patch and change management), this risk highlights the specific challenges in @SystemType:OT environments that standard IT processes fail to address.",
        "cheatSheet": "https://www.bsi.bund.de/EN/Top@SystemType:ICS/Industrie_und_KRITIS/@SystemType:ICS/ics_node.html (BSI @SystemType:ICS Security)",
        "detectionLogic": "This is a process-level risk inherent to @SystemType:OT/@SystemType:ICS assets. The rule triggers for any technical asset explicitly tagged as an '@SystemType:OT-asset',",
        "riskAssessment": "The likelihood is high if no @SystemType:OT-specific change management process exists. The impact is directly correlated with the availability and integrity requirements of the @SystemType:OT asset,",
        "falsePositives": "This risk is raised to ensure a verification of operational processes. A false positive can be claimed if the organization has a mature, documented, and enforced change management program specifically designed for its @SystemType:OT environment.",
        "cwe": "1123",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "37_sec4.ts",
        "bsiCode": "IND.1",
        "id": "insufficient-access-protection-for-ot-systems",
        "title": "Insufficient Access Protection for OT/ICS (BSI-Style)",
        "description": "Industrial Control Systems (ICS/OT) are increasingly connected to other networks, such as corporate Office IT, partners, and service providers, for data exchange, monitoring, and remote maintenance.",
        "impact": "A compromise of OT systems can lead to manipulation of physical processes, production standstills, equipment damage, and safety hazards. This severely impacts the availability and integrity of the industrial processes.",
        "action": "Implement Strict Network Segmentation and Access Control for OT Environments",
        "mitigation": "Strictly segment the OT network from the Office IT network, typically using a Demilitarized Zone (DMZ) and firewalls.",
        "check": "Is there a firewall or DMZ between the IT and OT networks? Are all IT-to-OT communication links explicitly whitelisted, authenticated, and encrypted?",
        "asvs": "BSI IT-Grundschutz: SYS.2.4 Industrial Control System (ICS) components, NET.1.1 Network architecture",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_4_Industrial_Control_System_components_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies communication links that originate from a non-OT asset and terminate at an OT asset (identified by the '@OT' tag).",
        "riskAssessment": "The likelihood is high if an unsecured communication channel exists from IT to OT, as the IT environment is a common source of malware.",
        "falsePositives": "The risk might be a false positive if the connecting 'IT' asset is a dedicated, hardened jump host or data diode that is part of a secure architecture, but not tagged as '@OT' in the model.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "37_sec5.ts",
        "bsiCode": "IND.1",
        "id": "insecure-software-development-and-modification",
        "title": "Vulnerabilities due to Insecure Software Development and Modification (based on BSI)",
        "description": "Adjustments and further developments of IT systems and applications can introduce critical risks.",
        "impact": "If vulnerabilities are introduced into custom-developed components, this can lead to a compromise of their confidentiality, integrity, and availability,",
        "action": "Implement and Enforce a Secure Software Development Lifecycle (SDLC)",
        "mitigation": "Establish a comprehensive Secure SDLC program that includes threat modeling, secure coding standards, mandatory code reviews (manual and automated),",
        "check": "Is a formal Secure SDLC process defined and followed? Are development environments secured and monitored?",
        "asvs": "V1 Architecture, Design and Threat Modeling Requirements, V14 Configuration",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is identified for all in-scope technical assets marked as having `custom_developed_parts`.",
        "riskAssessment": "The likelihood is considered 'Likely' for any custom-developed component, as bugs can always occur.",
        "falsePositives": "A technical asset might be flagged because it contains custom code, even if the organization follows a very mature and secure SDLC.",
        "cwe": "20",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "37_sec6.ts",
        "bsiCode": "IND.1",
        "id": "insecure-remote-access-to-@SystemType:OT",
        "title": "Insecure Remote Access to @SystemType:OT/@SystemType:ICS Components (BSI INF.11)",
        "description": "In some cases, industrial control systems are administered via network access.",
        "impact": "If remote access to @SystemType:OT/@SystemType:ICS components is not adequately secured, attackers could gain unauthorized control, leading to manipulation of industrial processes,",
        "action": "Secure Remote Administration Access to @SystemType:OT/@SystemType:ICS",
        "mitigation": "All remote access to @SystemType:OT components must be routed through a secured, monitored gateway (e.g., a bastion host or jump server).",
        "check": "Are all remote administration connections to @SystemType:OT systems encrypted via VPN or at least a strongly authenticated, encrypted protocol? Is multi-factor authentication enforced?",
        "asvs": "BSI IT-Grundschutz Kompendium 2023: INF.11 Zugriff auf @SystemType:OT-Komponenten über Netze",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/IT-GS-Kompendium_2023/bausteine/INF/INF_11_Zugriff_auf_OT_Komponenten_ueber_Netze_Edition_2023.html",
        "detectionLogic": "This risk is triggered for @SystemType:OT/@SystemType:ICS components (modeled as 'I@SystemType:OT Device' or tagged with '@SystemType:OT'/'@SystemType:ICS') that have an incoming communication link from the Internet.",
        "riskAssessment": "The impact is determined by the availability and integrity rating of the @SystemType:OT component, as compromise can lead to physical process disruption.",
        "falsePositives": "A risk might be flagged if an intermediate security component (like a cloud provider's VPN gateway or a specialized firewall) that secures the connection is not modeled explicitly.",
        "cwe": "287",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "37_sec7.ts",
        "bsiCode": "IND.1",
        "id": "inadequate-monitoring-of-@SystemType:ICS-it-infrastructure",
        "title": "Inadequate Monitoring of Supporting IT Infrastructure for Industrial Control Systems (@SystemType:ICS)",
        "description": "A key function of industrial control systems is to monitor the automated process itself (e.g., fill levels, temperatures, valve positions).",
        "impact": "Failure to monitor the supporting IT infrastructure can lead to delayed detection and response to security incidents, component failures, or performance degradation.",
        "action": "Implement Comprehensive Monitoring and Logging for @SystemType:ICS Supporting Infrastructure",
        "mitigation": "Implement a dedicated monitoring solution that covers all critical IT components supporting the industrial process (e.g., servers, databases, network devices, applications).",
        "check": "Are all IT assets supporting the @SystemType:ICS environment connected to a monitoring system? Are security-relevant events being actively logged and analyzed? Is there an automated alerting mechanism for critical events? Is there a defined and tested incident response process linked to these alerts?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.A6 'Detection of security-relevant events' and OPS.1.1.A5 'Logging'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_operation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks for technical assets identified as part of an Industrial Control System (e.g., assets of type 'I@SystemType:OT Device' or assets tagged with '@SystemType:ICS') that are @SystemType:OT connected to a monitoring system.",
        "riskAssessment": "The impact is derived from the availability and integrity requirements of the unmonitored @SystemType:ICS component. A lack of monitoring on a 'mission-critical' asset will result in a higher impact.",
        "falsePositives": "This risk may be a false positive if monitoring is performed by an external system or a platform feature @SystemType:OT represented as a dedicated 'Monitoring' asset in the model.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "37_sec8.ts",
        "bsiCode": "IND.1",
        "id": "unplanned-changes-in-@Environment:OT",
        "title": "Unplanned or Untested Changes in @SystemType:OT Environments (BSI @SystemType:OT.1.A4)",
        "description": "Industrial control systems (@SystemType:OT/@SystemType:ICS) often have very high availability requirements, as disruptions or technical failures can lead to severe damage and high consequential costs.",
        "impact": "Failure to properly test and manage changes can lead to severe disruptions, system failures, physical damage, and high consequential costs, primarily affecting the Availability and Integrity of the @SystemType:OT system and the physical processes it controls.",
        "action": "Implement a Formal Change and Test Management Process for @SystemType:OT Systems",
        "mitigation": "Establish a strict change management process that includes planning, risk assessment, coordination with all stakeholders, and thorough testing in a representative, non-production environment before deployment. All changes, including vendor updates and parameter adjustments, must follow this process. Maintain rollback plans and ensure changes are performed by authorized and trained personnel.",
        "check": "Is there a documented change management policy for @SystemType:OT systems? Are all changes, including patches and configuration adjustments, tested in a separate, representative environment before deployment? Are change records, test results, and rollback procedures maintained?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium, Baustein @SystemType:OT.1: General @SystemType:OT components, Requirement @SystemType:OT.1.A4: Change and patch management.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OT_1_General_OT_components_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to technical assets identified as part of an Operational Technology (@SystemType:OT) environment, especially those with high availability or integrity requirements. The rule identifies these assets via a specific tag (`@SystemType:@SystemType:OT`). The risk is raised because such environments are highly sensitive to untested changes, which is a common procedural weakness if not explicitly countered.",
        "riskAssessment": "The likelihood is considered 'Likely' as a baseline, assuming a standard organization may not have a perfect, audited @SystemType:OT-specific change process. The impact is directly proportional to the `availability` and `integrity` ratings of the @SystemType:OT asset. A `mission-critical` asset will result in a `VeryHigh` impact, while a `critical` asset will result in a `High` impact.",
        "falsePositives": "This risk can be considered a false positive if the organization can demonstrate a robust, strictly enforced, and audited change and test management process specifically for their @SystemType:OT environment.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "37_sec9.ts",
        "bsiCode": "IND.1",
        "id": "unsupported-components-in-@Environment:OT",
        "title": "Unsupported Components in @SystemType:OT Environment (BSI-based)",
        "description": "In Operational Technology (@SystemType:OT) environments, components from standard Office-IT are often used.",
        "impact": "Successful exploitation of vulnerabilities in unsupported components can lead to unauthorized intrusion into critical @SystemType:OT systems.",
        "action": "Implement Component Lifecycle Management and Replace/Isolate Unsupported Assets",
        "mitigation": "Maintain a complete inventory of all hardware and software components and track their support lifecycle status.",
        "check": "Is there a complete and up-to-date inventory of all hardware and software components?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, SYS.1.2 Server under Windows, Requirement SYS.1.2.A16 'Use of up-to-date server products and components'. This principle applies broadly to all system components.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_Server_under_Windows_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule triggers for any technical asset that is tagged as `@Maintenance:Unmaintained` AND is identified as being part of an @SystemType:OT environment via the `@SystemType:OT` tag. The @SystemType:OT domain context can be applied directly to the asset or to a trust boundary containing the asset.",
        "riskAssessment": "The likelihood of exploitation is considered high because vulnerabilities in unsupported products are often publicly known and exploit tools are readily available.",
        "falsePositives": "A false positive may occur if an unsupported component is fully air-gapped and has no digital or physical data-transfer interfaces, which might not be fully represented in the model. However, such isolation is rare and difficult to maintain, so the risk should be carefully evaluated before being dismissed.",
        "cwe": "1104",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "IND.2.1": [
      {
        "file": "38_sec1.ts",
        "bsiCode": "IND.2.1",
        "id": "insecure-default-configuration-app4.4.a1",
        "title": "Insecure Default Configuration of Components (BSI APP.4.4.A1)",
        "description": "The default configuration of components is often designed for correct functionality and easy commissioning. Security mechanisms often play a subordinate role.",
        "impact": "If an attacker successfully exploits an insecure default configuration, they could gain control over the component. This can lead to the leakage of institution-critical information (loss of Confidentiality),",
        "action": "Implement and Enforce Secure Baseline Configurations (Hardening)",
        "mitigation": "Establish and enforce documented hardening guidelines for all types of components before they are deployed into production. This process should include:",
        "check": "Is there a documented hardening process for components of this type? Are default credentials verifiably changed? Are all running services, protocols, and open ports necessary and documented? Is there a process for regularly reviewing the configuration against the baseline?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein APP.4.4 'General Server', Requirement A1 'Secure basic configuration'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_General_server_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk applies to all technical assets that are simple clients, embedded components (like libraries), or DevOps-specific infrastructure (which have their own configuration risks), and are in-scope.",
        "riskAssessment": "The likelihood of this risk is considered high by default, as insecure configurations are a very common attack vector. The likelihood increases if the asset is exposed to the internet or has unauthenticated communication links.",
        "falsePositives": "This risk may be considered a false positive if the organization has a robust, mature, and consistently applied hardening process for all assets, even if explicitly tagged in the model. The tag serves as a way to explicitly confirm this within the threat model.",
        "cwe": "1032",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "38_sec2.ts",
        "bsiCode": "IND.2.1",
        "id": "inadequate-user-and-authorization-management",
        "title": "Inadequate User and Authorization Management on Components (BSI-@SystemType:ICS-SEC-1)",
        "description": "Some components, particularly those with their own user and authorization management, are susceptible to operational weaknesses.",
        "impact": "Unauthorized individuals gaining access to components can lead to a severe compromise of confidentiality, integrity, and availability.",
        "action": "Implement and Enforce Strict User and Permission Management",
        "mitigation": "Ensure that every user has a unique, individual account; prohibit and technically prevent the use of shared accounts.",
        "check": "Is there a documented process for user lifecycle management? Are shared accounts prohibited? Are access rights regularly audited?",
        "asvs": "V4 Access Control",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authorization_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for technical assets that are likely to have their own user management, especially when they are simple clients.",
        "riskAssessment": "The likelihood is high if a component with its own user management does not integrate with a central identity provider and/or relies on protocols with weak or no authentication.",
        "falsePositives": "A component might have a robust, well-maintained local user management system even if the model does not explicitly state it.",
        "cwe": "285",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "38_sec3.ts",
        "bsiCode": "IND.2.1",
        "id": "inadequate-security-logging-on-@SystemType:ICS-components",
        "title": "Inadequate Security Logging on @SystemType:ICS Components",
        "description": "On Industrial Control Systems (@SystemType:ICS) components, logging is often limited to process-relevant events, while data crucial for information security is not recorded. This deficiency makes it difficult to detect security incidents in a timely manner and often impossible to reconstruct them for forensic analysis afterwards.",
        "impact": "The absence of security-relevant logs prevents or significantly delays the detection of attacks and security breaches. After an incident, the lack of data hinders root cause analysis, making it impossible to understand the attack path, assess the full extent of the damage, or implement effective countermeasures to prevent recurrence. This can lead to prolonged system compromises, data manipulation, or physical process disruption going unnoticed.",
        "action": "Implement and Enhance Security-Relevant Logging on @SystemType:ICS Components",
        "mitigation": "Ensure that @SystemType:ICS components log security-relevant events in addition to process-relevant ones. This includes failed login attempts, configuration changes, administrative actions, network connection anomalies, and errors. Logs should be sent to a central, secured log management system (like a SIEM) for correlation, analysis, and alerting. The logging configuration must be protected against tampering. Timestamps should be synchronized across all components.",
        "check": "Are security events (e.g., logins, configuration changes, errors) being logged on @SystemType:ICS components? Are these logs collected centrally in a protected manner? Is there a process for reviewing these logs for anomalies?",
        "asvs": "BSI IT-Grundschutz COMPENDIUM, Module OPS.1.2.5: Logging",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_5_Logging_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for technical assets identified as @SystemType:ICS components (either via the `@SystemType:ICS` tag or `IoTDevice` technology) that lack explicit indicators of sufficient security logging (i.e., are not tagged with `@SecurityLogging` or `@SIEM-Connected`).",
        "riskAssessment": "The likelihood is considered high for any @SystemType:ICS component by default, as security logging is not a primary design feature for many of these systems. The impact is directly related to the criticality of the @SystemType:ICS component and the physical process it controls, with a focus on Integrity and Availability. A compromise of a mission-critical process controller has a very high impact.",
        "falsePositives": "A risk might be a false positive if the @SystemType:ICS component has robust, security-focused logging capabilities that are not reflected in the model (e.g., the `@SecurityLogging` tag is missing), or if logging is handled by a dedicated, connected monitoring device that is part of the model and protects the @SystemType:ICS component.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "38_sec4.ts",
        "bsiCode": "IND.2.1",
        "id": "@SystemType:ICS-manipulation-of-components-and-information",
        "title": "Manipulation of @SystemType:ICS Components and Information (BSI CON.6)",
        "description": "The diverse interfaces of Industrial Control System (@SystemType:ICS) components lead to an increased risk of manipulation for the IT systems, software, and information they transmit. Depending on the motivation and skills of the attackers, this can have local or even multi-site effects. Furthermore, status and alarm messages or other measured values can be suppressed or altered.",
        "impact": "Manipulated measurement values can lead to incorrect decisions by @SystemType:ICS components or operating personnel. Manipulated systems can be used to attack other systems or locations, or to conceal an ongoing manipulation. This directly threatens the integrity and availability of the production process, potentially causing physical damage, production downtimes, and safety hazards.",
        "action": "Secure @SystemType:ICS Interfaces and Validate Control Data",
        "mitigation": "All interfaces to @SystemType:ICS components must be secured using strong authentication and authorization mechanisms. Communication across network boundaries should be encrypted. All incoming data, especially control commands, measurements, and alarms (often tagged as @ICSControlData), must be validated for integrity and plausibility before being processed. Implement strict network segmentation to isolate critical control networks (@SystemType:OT) from corporate networks (IT) and the internet. Regularly update and patch @SystemType:ICS software and firmware where feasible.",
        "check": "Are all communication links to @SystemType:ICS components authenticated and authorized? Is data in transit encrypted when crossing trust boundaries? Are critical control data assets validated before being used? Is the @SystemType:ICS network properly segmented?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Manipulation of information) and aligns with industrial security standards like IEC 62443.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Manipulation_of_information_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule triggers for technical assets of type 'IoTDevice' (representing @SystemType:ICS components) that have incoming communication links with weak or no security controls (i.e., lacking authentication or authorization). The risk is elevated if these links transmit data assets tagged as '@ICSControlData', as these represent critical operational values.",
        "riskAssessment": "The likelihood is high if interfaces are unprotected, especially if they are exposed to less trusted networks. The impact is directly related to the Integrity and Availability rating of the @SystemType:ICS component and the data it processes. Manipulation of a 'mission-critical' component that controls physical processes has a 'very-high' impact.",
        "falsePositives": "A risk might be a false positive if compensating controls exist that are not @SystemType:OT modeled, such as an out-of-band physical monitoring system that would detect implausible values or actions, or if the interface is only accessible in a physically secured and highly restricted maintenance mode.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "38_sec5.ts",
        "bsiCode": "IND.2.1",
        "id": "insecure-@SystemType:ICS-@SystemType:OT-protocols",
        "title": "Insecure @SystemType:ICS/@SystemType:OT Protocols (based on BSI)",
        "description": "Protocols used in Industrial Control Systems (@SystemType:ICS) and Operational Technology (@SystemType:OT) environments often lack adequate security mechanisms.",
        "impact": "Successful exploitation can lead to a loss of Confidentiality (e.g., of process parameters), Integrity (e.g., manipulation of control commands),",
        "action": "Use Secure Communication Protocols and Network Segmentation",
        "mitigation": "Whenever possible, use protocols that provide end-to-end encryption, strong authentication, and message integrity checks.",
        "check": "Review the protocols used for communication with and between @SystemType:ICS/@SystemType:OT components. Are they encrypted? Is there mutual authentication? Is message integrity verified?",
        "asvs": "Derived from BSI recommendations for @SystemType:ICS/@SystemType:OT security. See BSI CS 132 'Cyber-Sicherheits-Anforderungen an netzwerkverbundene Industriesysteme' and IEC 62443 standard.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/@SystemType:ICS/BSI-CS_132.pdf?__blob=publicationFile (BSI CS 132)",
        "detectionLogic": "This rule checks for communication links involving Industrial Control Systems (@SystemType:ICS) or Operational Technology (@SystemType:OT) Devices that use insecure protocols.",
        "riskAssessment": "The likelihood of exploitation is considered high if an insecure protocol is used without compensating controls, as the vulnerability is easily accessible to anyone on the network segment.",
        "falsePositives": "A risk might be flagged even if the network is physically isolated and considered secure.",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "38_sec6.ts",
        "bsiCode": "IND.2.1",
        "id": "dos-against-@SystemType:ICS-components",
        "title": "Denial-of-Service against @SystemType:ICS Components (BSI @SystemType:ICS-K.3)",
        "description": "Attackers can impair the operation of Industrial Control System (@SystemType:ICS) components through Denial-of-Service (DoS) attacks.",
        "impact": "A successful DoS attack against an @SystemType:ICS component can render it unavailable, disrupting or halting critical industrial processes. This directly impacts Availability and can lead to secondary impacts on Integrity (e.g., corrupted production batches) and even safety.",
        "action": "Implement Network Segmentation and DoS Resilience Measures",
        "mitigation": "Protect @SystemType:ICS components by placing them in a segmented, controlled network zone, separate from general corporate IT and the internet. Use firewalls and intrusion detection/prevention systems (IDS/IPS) to strictly control traffic to the @SystemType:ICS zone. Ensure that components are configured for resilience and have sufficient resources to handle expected network loads. Consider using protocols and devices with built-in DoS protection mechanisms. Have a documented incident response plan for DoS events.",
        "check": "Are @SystemType:ICS components isolated in a dedicated network segment? Are there firewalls or other security gateways protecting the @SystemType:ICS network? Have components been assessed for their resilience to abnormal traffic patterns?",
        "asvs": "BSI IT-Grundschutz @SystemType:ICS-K.3 Denial-of-Service",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/@SystemType:ICS/BSI-CS_108.pdf?__blob=publicationFile (German)",
        "detectionLogic": "This rule triggers for technical assets identified as @SystemType:ICS components (either by technology type `i@SystemType:OT-device` or an `@SystemType:ICS` tag) that have a high or mission-critical availability requirement. The risk is raised if these components have incoming communication links, indicating network exposure.",
        "riskAssessment": "The likelihood of a DoS attack increases with the component's network exposure. Internet-facing @SystemType:ICS components are at a very high risk. Components connected to other internal, non-@SystemType:ICS networks are at a high risk. The impact is derived directly from the availability requirement of the component, as its failure could halt mission-critical operations.",
        "falsePositives": "The risk might be overstated if the component has robust, specialized DoS protection mechanisms that are not captured in the model, or if the connecting networks are very small and highly controlled. It can also be a false positive if an asset is modeled as an `i@SystemType:OT-device` but is not used in a real-time control capacity.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "38_sec7.ts",
        "bsiCode": "IND.2.1",
        "id": "malware-on-@SystemType:ICS",
        "title": "Malware on Industrial Control Systems (@SystemType:ICS)",
        "description": "The threat of malware is increasingly severe for Industrial Control Systems.",
        "impact": "A malware infection on an @SystemType:ICS component can lead to manipulation or failure of industrial processes,",
        "action": "Segment Networks and Control External Interfaces",
        "mitigation": "Strictly segment the @SystemType:ICS/@SystemType:OT network from Office IT and the internet using firewalls or DMZs.",
        "check": "Are @SystemType:ICS assets properly isolated within a dedicated trust boundary? Are all incoming connections from less-trusted networks (Office IT, Internet)",
        "asvs": "N/A (Related to ISA/IEC 62443 standards for IACS Security)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/CS/@SystemType:ICS-Security-Compendium/@SystemType:ICS-Security-Compendium.pdf?__blob=publicationFile (BSI @SystemType:ICS Security Compendium)",
        "detectionLogic": "This rule checks for technical assets tagged as `@SystemType:ICS-component`. It then identifies potential malware infection vectors by analyzing incoming communication links from:",
        "riskAssessment": "The impact is rated based on the @SystemType:ICS component's availability and integrity requirements, which are typically high.",
        "falsePositives": "The model might not capture the presence of specific network security controls like next-gen firewalls, data diodes, or intrusion detection systems (IDS) that mitigate this risk.",
        "cwe": "94",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "38_sec8.ts",
        "bsiCode": "IND.2.1",
        "id": "industrial-espionage-via-@SystemType:ICS-data",
        "title": "Industrial Espionage via @SystemType:ICS/I@SystemType:OT Data (BSI OPS.1.1.5)",
        "description": "@SystemType:ICS/I@SystemType:OT components often contain or transmit detailed information about the regulated or monitored process.",
        "impact": "If an attacker gains access to sensitive @SystemType:ICS/I@SystemType:OT data, it can lead to a loss of competitive advantage and intellectual property.",
        "action": "Encrypt @SystemType:ICS/I@SystemType:OT Communication and Data-at-Rest",
        "mitigation": "All communication to and from @SystemType:ICS/I@SystemType:OT components that transmits sensitive data must be encrypted using strong, modern protocols (e.g., MQTTS, OPC UA with security enabled, HTTPS).",
        "check": "Are all communication channels to/from @SystemType:ICS/I@SystemType:OT devices encrypted? Is sensitive configuration/process data encrypted on the device? Are the devices properly isolated in the network?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.5.A16 (Protection of confidentiality during data transmission) & A17 (Protection of confidentiality for stored data)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Industrial_IT_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies @SystemType:ICS/I@SystemType:OT components (assets with technology 'I@SystemType:OT Device' or tagged with '@SystemType:ICS') that either",
        "riskAssessment": "The likelihood of exploitation is significantly increased if the component is internet-facing or communicates across trust boundaries without encryption.",
        "falsePositives": "This risk may be a false positive if compensating controls exist that are not modeled for @SystemType:OT, such as a hardware-based VPN appliance encrypting all traffic for a network segment, or if the data, despite its classification, is not considered a trade secret for @SystemType:OT.",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "38_sec9.ts",
        "bsiCode": "IND.2.1",
        "id": "manipulation-of-@SystemType:ICS-firmware-ics1-a5",
        "title": "Manipulation of Firmware/Software on @SystemType:ICS Component (BSI @SystemType:ICS.1.A5)",
        "description": "Firmware and application software on @SystemType:ICS (Industrial Control System) components can be illicitly modified. This can happen through various vectors, including: a compromised programming device, a local data interface (e.g., USB), an existing network connection, a manipulated software update in-transit, or a compromised supply chain where the component arrives with malicious firmware already installed.",
        "impact": "Attackers gaining the ability to modify software or firmware can alter, falsify, or disrupt controlled industrial processes. This can lead to equipment damage, production loss, unsafe operating conditions, and denial of service. The primary impact is on the Integrity and Availability of the @SystemType:ICS component and the process it controls.",
        "action": "Implement Firmware/Software Integrity Controls and Secure Update Mechanisms",
        "mitigation": "Use digitally signed firmware and software to ensure authenticity and integrity. Implement secure boot mechanisms to verify software before execution. All update channels, whether network-based or local, must be strongly authenticated and encrypted. Restrict physical and logical access to programming and management interfaces. Vet the supply chain for all hardware and software components to reduce the risk of pre-compromised elements.",
        "check": "Is all firmware and application software digitally signed? Is secure boot enabled? Are software updates delivered over a secure, authenticated channel? Is access to management interfaces (network and physical) strictly controlled and monitored?",
        "asvs": "BSI IT-Grundschutz: @SystemType:ICS.1 General @SystemType:ICS component, Requirement @SystemType:ICS.1.A5 Manipulation of software and firmware on an @SystemType:ICS component.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ICS_1_General_ICS_component_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset of technology type 'I@SystemType:OT-Device' or 'Mainframe', as these often represent specialized @SystemType:ICS or control system hardware. The likelihood increases if the asset receives communication from development or operational tools (e.g., 'Build-Pipeline', 'DevOps-Client'), especially over insecure channels, or if it's a physical machine, which implies susceptibility to local attacks.",
        "riskAssessment": "The impact is derived directly from the **Integrity** and **Availability** ratings of the @SystemType:ICS component itself, as manipulation directly affects these properties. A 'Mission-Critical' component will result in a 'Very-High' impact. The likelihood is considered 'Unlikely' by default but is elevated to 'Likely' if clear-risk factors like insecure update paths or physical accessibility are present in the model.",
        "falsePositives": "The model may not be aware of out-of-band security controls such as strict physical security measures, air-gapped update procedures, or a thoroughly vetted supply chain, which could mitigate this risk in practice.",
        "cwe": "494",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      }
    ],
    "IND.2.2": [
      {
        "file": "39_sec1.ts",
        "bsiCode": "IND.2.2",
        "id": "incomplete-plc-documentation",
        "title": "Incomplete PLC/Industrial Control Systems (ICS) Documentation (BSI G 0.19)",
        "description": "Programmable Logic Controllers (PLCs) and other Industrial Control Systems (ICS) are often incompletely documented, so not all product functions are known. Documentation frequently lacks information about used services, protocols, communication ports, and permission management.",
        "impact": "This lack of documentation significantly hinders threat analysis, as critical interfaces, functions, and security mechanisms may be overlooked. Potential threats might not be identified or considered in the security concept. Furthermore, it becomes difficult or impossible to react to newly discovered vulnerabilities if the affected components and their configurations are not properly documented, which can lead to compromises of integrity, availability, and confidentiality.",
        "action": "Ensure Complete and Accurate System Documentation",
        "mitigation": "Create and maintain comprehensive documentation for all PLCs/ICS components. This must include all network interfaces, protocols, ports, and services, as well as the complete authorization and authentication concept. Utilize network scanning and asset inventory tools to discover and verify system properties. Harden systems by disabling all unused and undocumented services and ports. Regularly review and update the documentation, especially after system changes.",
        "check": "Is there complete technical documentation for the PLC/ICS asset? Does it accurately list all communication links, protocols, and ports? Is the permission and authentication model clearly defined?",
        "asvs": "Derived from BSI IT-Grundschutz Catalogues, Threat G 0.19 (Missing or insufficient documentation) as applied to module APP.4.4 (PLC) or newer modules like IND.2 (Industrial IT).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2022/bausteine/APP/APP_4_4_SPS_Edition_2022.html",
        "detectionLogic": "Automatically detects technical assets representing PLCs/ICS (e.g., technology 'IndustrialControlSystem-device') that show signs of being incompletely modeled. This includes communication links using 'unknown-protocol', missing authentication/authorization, or data flows without specified data assets.",
        "riskAssessment": "The likelihood is based on the number and severity of modeling omissions. A link with an 'unknown-protocol' is a strong indicator. The impact is derived from the CIA rating of the asset and the data it processes. An undocumented interface to a mission-critical system represents a high-impact risk.",
        "falsePositives": "The risk might be a false positive if the model is simply incomplete, while the real-world documentation is actually accurate and comprehensive. This must be verified outside the tool.",
        "cwe": "1059",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      }
    ],
    "APP.1.4": [
      {
        "file": "3_sec1.ts",
        "bsiCode": "APP.1.4",
        "id": "unsuitable-apps-bsi-threat",
        "title": "Unsuitable or @Maintenance:Unmaintained Applications (BSI Threat)",
        "description": "The choice of applications significantly impacts the information they process, the mobile devices they run on, and often the institution's backend IT infrastructure.",
        "impact": "Using unsuitable or @Maintenance:Unmaintained applications can lead to the compromise of confidentiality, integrity, and availability (CIA) of the data and systems involved.",
        "action": "Establish a Vetting and Lifecycle Management Process for Applications",
        "mitigation": "Implement a formal process for vetting and approving all applications, especially those on mobile devices. This process should include a security review,",
        "check": "Is there a documented policy for selecting and approving third-party applications? Are all mobile applications vetted for security and support before deployment?",
        "asvs": "BSI IT-Grundschutz SYS.2.2.2 Mobile Device Management (MDM)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_2_2_Mobile_Device_Management_MDM_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule triggers for any technical asset of the type 'Mobile App' that is marked as 'custom-developed'. The assumption is that third-party or",
        "riskAssessment": "The likelihood is considered 'Likely', and 'Very Likely' if the asset is internet-facing. The impact is calculated based on the highest CIA requirements of the",
        "falsePositives": "This risk may be considered a false positive if a formal, effective vetting and lifecycle management process is in place for all third-party applications,",
        "cwe": "1104",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "3_sec2.ts",
        "bsiCode": "APP.1.4",
        "id": "excessive-mobile-app-permissions",
        "title": "Excessive Mobile App Permissions (BSI APP.1.2)",
        "description": "Mobile applications require certain permissions to access device functions and services, such as internet connectivity, location data, or the address book.",
        "impact": "Exploitation of excessive permissions can lead to data breaches, unauthorized data modification or deletion, and financial loss.",
        "action": "Apply Principle of Least Privilege for App Permissions",
        "mitigation": "Ensure the mobile application requests only the absolute minimum set of permissions required for its functionality.",
        "check": "Is there a documented justification for every permission the mobile app requests? Does the app use runtime requests for sensitive permissions?",
        "asvs": "MASVS-V2.1: The app only requests the minimum set of permissions required.",
        "cheatSheet": "https://mas.owasp.org/MASTG/tests/android/MASVS-PLATFORM/MASTG-TEST-0055/",
        "detectionLogic": "This risk is raised for all 'Mobile App' technical assets.",
        "riskAssessment": "The likelihood is considered 'Likely' as requesting excessive permissions is a very common issue in mobile app development.",
        "falsePositives": "This risk can be considered a false positive if a thorough review confirms that all requested permissions are minimal, justified, and necessary for the app's core functionality.",
        "cwe": "272",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "3_sec3.ts",
        "bsiCode": "APP.1.4",
        "id": "malicious-mobile-app-sys2.4",
        "title": "Risk from Malicious Mobile Apps (BSI SYS.2.4)",
        "description": "Although some app store operators check the apps they offer, these can still contain security vulnerabilities or deliberately deployed malicious functions.",
        "impact": "If a malicious app is installed, it can lead to unauthorized access to sensitive data, data tampering, service disruption, and compromise of the entire device.",
        "action": "Restrict App Sources and Vet Applications",
        "mitigation": "Enforce a policy that only allows installation of applications from vetted, trustworthy sources (e.g., official corporate or public app stores).",
        "check": "Is there a policy that restricts app installation to trusted sources? Is this policy technically enforced by an MDM/MAM solution?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.2.4 (Clients under Android), specifically Requirement SYS.2.4.A5 'Use of trustworthy app sources'. The principle applies to all mobile operating systems.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_4_Clients_under_Android_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for any 'mobile-app' technical asset. The likelihood is significantly increased if the app is sourced from an 'untrusted' source, as indicated by a tag.",
        "riskAssessment": "The likelihood is 'Very Likely' if an app is sourced from an untrusted location (`@AppSource:untrusted`) and 'Likely' if it comes from a public app store without additional vetting.",
        "falsePositives": "This risk might be flagged for an app from an official store where the organization has a strong, but unmodeled, manual vetting process.",
        "cwe": "506",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "3_sec4.ts",
        "bsiCode": "APP.1.4",
        "id": "vulnerable-@Maintenance:Unmaintained-software",
        "title": "Vulnerabilities in @Maintenance:Unmaintained Software",
        "description": "Software components (e.g., applications, libraries, or systems) that are no longer maintained by their developers pose a significant security risk.",
        "impact": "Successful exploitation of vulnerabilities in @Maintenance:Unmaintained software can lead to a complete compromise of the affected asset's confidentiality, integrity, and availability.",
        "action": "Implement Patch and Vulnerability Management for All Components",
        "mitigation": "Establish a robust patch and vulnerability management process. Maintain a complete inventory of all software assets and their dependencies (a Software Bill of Materials - SBOM).",
        "check": "Is there a documented process for tracking and applying security patches? Is there a complete software inventory (SBOM)?",
        "asvs": "V14.2.1: An inventory of all software components and their versions is maintained.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for any in-scope technical asset marked with the `@Maintenance:Unmaintained` tag.",
        "riskAssessment": "The likelihood of exploitation is significantly increased if the asset is internet-facing or otherwise exposed on a network.",
        "falsePositives": "This risk can be considered a false positive if the `@Maintenance:Unmaintained` tag is applied incorrectly or if effective, verified compensating controls (like virtual patching) are in place but not modeled.",
        "cwe": "1104",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "3_sec5.ts",
        "bsiCode": "APP.1.4",
        "id": "insecure-local-data-storage-on-client",
        "title": "Insecure Local Data Storage on Client Device",
        "description": "Some applications store data on the client device, such as user profiles or documents. If this data is inadequately protected, other applications on the same device might be able to access it. This applies to both intentionally stored data and temporary data, such as information cached by the application.",
        "impact": "Failure to adequately protect locally stored data can lead to breaches of Confidentiality (unauthorized access by other apps or attackers with physical device access), Integrity (unauthorized modification), and Availability (data loss upon device failure or loss). This can result in the exposure of sensitive information and permanent data loss if not backed up.",
        "action": "Implement Secure Storage and Backup for Client-Side Data",
        "mitigation": "Utilize platform-provided secure storage mechanisms (e.g., iOS Keychain, Android Keystore). Encrypt all sensitive data before writing it to local storage on the client device. In the Threagile model, this is reflected by setting the 'encryption' property of the technical asset to a value other than 'none'.",
        "check": "Review client-type technical assets that store data. Verify that the 'encryption' property is not 'none'. For data with high availability requirements, confirm that the 'redundant' flag is set to true or that a communication link to a backup system exists.",
        "asvs": "OWASP MASVS V2: MSTG-STORAGE-1, MSTG-STORAGE-2",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Mobile_Security_Testing_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for in-scope client assets (e.g., mobile apps, desktop clients) that store data. A risk is generated if the data is stored unencrypted ('encryption: none'). A separate risk is generated if the asset is marked as redundant and stores data with high availability requirements.",
        "riskAssessment": "The impact is determined by the Confidentiality and Availability ratings of the data assets stored on the client.",
        "falsePositives": "The risk might be a false positive if the data stored is non-sensitive and public by nature, making encryption unnecessary. The availability risk may be falsely triggered if a backup mechanism is in place but not modeled via the 'redundant' flag (e.g., a specific data flow to a backup service).",
        "cwe": "312",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "3_sec6.ts",
        "bsiCode": "APP.1.4",
        "id": "unwanted-data-leakage-via-app-metadata",
        "title": "Unwanted Data Leakage via App Metadata (BSI APP.4.2)",
        "description": "Apps on client devices (e.g., mobile phones, desktops) often collect extensive metadata about their usage.",
        "impact": "Third parties could analyze this collected metadata to infer sensitive information, even if the app does not have direct access to it.",
        "action": "Restrict App Permissions and Manage Client Devices",
        "mitigation": "Strictly manage and restrict the permissions granted to applications on client devices, especially mobile apps.",
        "check": "Are policies in place to manage app installations and permissions on client devices? Is a Mobile Device Management (MDM) or similar endpoint protection solution used? Are users trained on these risks?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium, Baustein APP.4 Mobile Devices, specifically addressing the threat 'APP.4.2 Unerwünschter Datenabfluss' (Unwanted data leakage).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_Mobile_devices_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is automatically raised for all in-scope technical assets identified as client systems (e.g., mobile apps, browsers, desktop clients, IoT devices).",
        "riskAssessment": "The likelihood is rated higher for mobile and IoT technologies. The impact is determined by the confidentiality requirements of the technical asset,",
        "falsePositives": "This risk might be a false positive if robust device management solutions are in place that effectively restrict app permissions and data exfiltration, but the corresponding asset in the model has not been tagged as such.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "IND.2.3": [
      {
        "file": "40_sec1.ts",
        "bsiCode": "IND.2.3",
        "id": "@System:UCC-availability-dependencies",
        "title": "Availability Risk for @System:UCC Services due to Critical Dependencies (BSI APP.3.2.A5)",
        "description": "@System:UCC (Unified Communications and Collaboration) services often have high availability requirements. However, their functionality depends on various other IT systems.",
        "impact": "If a critical dependency of a @System:UCC service fails, the availability of the service is compromised. This can hinder communication-dependent business processes.",
        "action": "Architect for Resilience and Manage Critical Dependencies",
        "mitigation": "Identify all critical dependencies for @System:UCC services. For each dependency, implement resilience measures.",
        "check": "Are all dependencies for the @System:UCC service documented? Are the dependencies designed for high availability?",
        "asvs": "BSI IT-Grundschutz APP.3.2.A5 (High availability of @System:UCC services) and CON.1 (Contingency Management).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_UCC_services_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is detected by identifying assets tagged as `@System:UCC-service`. The rule then analyzes their communication links for critical dependencies:",
        "riskAssessment": "The impact is determined by the availability requirement of the @System:UCC service itself (e.g., `mission-critical` availability leads to `very-high` impact).",
        "falsePositives": "The model might not fully capture the resilience of a dependent service. For example, an asset representing an authentication provider might be a single node in the diagram but represent a highly-available cluster in reality. This risk should be validated against the detailed architecture of the dependent services.",
        "cwe": "693",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "40_sec2.ts",
        "bsiCode": "IND.2.3",
        "id": "inadequate-planning-of-@System:UCC-systems-app-3-2-a5",
        "title": "Inadequate Planning of @System:UCC Systems (BSI APP.3.2.A5)",
        "description": "If a Unified Communications and Collaboration (@System:UCC) system is not planned according to its actual and future usage, the functionality of all @System:UCC services can be severely impacted. As usage patterns change or the number of users increases, an initially suitable plan can become insufficient, leading to performance degradation or service outages. This is particularly true for network capacity and the processing power of endpoint devices.",
        "impact": "This can lead to severe degradation or complete failure of communication services (voice, video, messaging), disrupting business processes. For example, video conferences may suffer from stuttering, audio dropouts, or visual artifacts, and real-time communication may become unusable. This directly impacts operational efficiency, collaboration, and the availability of the system.",
        "action": "Ensure Comprehensive @System:UCC Planning and Capacity Management",
        "mitigation": "@System:UCC deployments must be meticulously planned based on current and projected usage, including user numbers, feature sets, and traffic patterns. Network infrastructure must be assessed and dimensioned to handle @System:UCC traffic, especially for real-time services like video and voice. The capabilities of endpoint client devices must be considered, avoiding the use of underpowered devices (like certain thin clients) for performance-intensive tasks. System performance and capacity should be regularly monitored and reviewed.",
        "check": "Is there a formal capacity and usage plan for the @System:UCC system? Has the network been explicitly dimensioned for @System:UCC traffic? Are the minimum hardware requirements for client devices documented and enforced? Is system performance actively monitored?",
        "asvs": "BSI IT-Grundschutz APP.3.2: Unified Communications and Collaboration, Requirement APP.3.2.A5: Planung des @System:UCC-Einsatzes (Planning the use of @System:UCC)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Bausteine/APP/APP_3_2_Unified_Communications_und_Collaboration.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for technical assets identified as part of a @System:UCC system (tagged with `@System:UCC`). The risk is heightened if these systems have high availability requirements. A specific risk is also generated if clients with limited processing power (tagged with `@ThinClient`) connect to @System:UCC systems, as this can lead to performance issues on the client-side, effectively causing a denial of service for that user.",
        "riskAssessment": "The likelihood is high if mission-critical @System:UCC services are deployed without specific capacity planning or if they rely on underpowered clients. The impact is directly related to the availability requirement of the @System:UCC system and the business processes that depend on it. A failure of a mission-critical collaboration platform has a very high impact.",
        "falsePositives": "This risk might be a false positive if comprehensive capacity planning and performance testing have already been performed, even if the model uses tags like `@ThinClient` or marks a @System:UCC system as mission-critical. The model does not contain data about network bandwidth or specific client hardware models. Verification requires reviewing network diagrams, capacity plans, and client hardware specifications.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "40_sec3.ts",
        "bsiCode": "IND.2.3",
        "id": "misconfiguration-of-services",
        "title": "Misconfiguration of Services",
        "description": "A large number of functions and services often implies a multitude of configuration options. This complexity can lead to misconfigurations, especially in systems like those for Unified Communications and Collaboration (@System:UCC), as cited by the BSI. Users may be overwhelmed when configuring their own clients, and administrators may introduce critical errors when altering central settings, particularly if the Identity and Access Management (IAM) concept is insufficient. Such misconfigurations can also result in inadequately restricted permissions for external participants.",
        "impact": "Misconfigurations can lead to a range of negative outcomes, including partial or complete service unavailability (Denial of Service), data loss, and security breaches. Specifically, they can cause unintentional information disclosure (e.g., a conference system auto-accepting calls), information leakage to unauthorized external parties, or data tampering.",
        "action": "Implement and Enforce Secure Configuration Baselines and a Robust IAM Concept",
        "mitigation": "Define hardened security baselines for all system components and verify them regularly. Manage configurations using version-controlled Infrastructure-as-Code (IaC) with automated linting and mandatory peer reviews. Implement a robust Identity and Access Management (IAM) concept based on the principle of least privilege for both administrators and end-users. For user-configurable clients, provide sensible, secure-by-default settings and clear guidance. Permissions for external or guest users must be strictly limited to only what is necessary.",
        "check": "Are secure configuration baselines defined, versioned, and automatically enforced? Is there a formal process for reviewing and approving configuration changes? Does a clear IAM concept exist that enforces least privilege? Are default permissions for external participants explicitly defined and restrictive?",
        "asvs": "OWASP ASVS V1.11.1 (was V14.2.1): The application is hardened and securely configured for all components in the stack.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Configuration_Management_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for technical assets that present a high potential for misconfiguration. This includes: 1. Assets representing user-facing clients which may be misconfigured by end-users. 2. Complex back-end systems, especially those with custom-developed parts. 3. Assets that accept incoming communication from external entities or across trust boundaries with weak or missing authorization, indicating a potential IAM or access control misconfiguration.",
        "riskAssessment": "The likelihood is considered higher for custom-developed components and for services exposed to external users with weak access controls. The impact is directly derived from the Confidentiality, Integrity, and Availability ratings of the technical asset and the data it processes or stores. A misconfiguration of a system handling 'Strictly Confidential' data can lead to a 'Very High' impact.",
        "falsePositives": "This risk is generated based on architectural patterns and asset properties, not the actual live configuration of the system. An asset might be flagged but be perfectly configured and managed according to best practices. Manual verification of the configuration and operational processes is required to confirm or dismiss this risk.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "40_sec4.ts",
        "bsiCode": "IND.2.3",
        "id": "misuse-of-administrative-privileges-on-@System:UCC-systems",
        "title": "Misuse of Administrative Privileges on @System:UCC Systems (BSI APP.3.2)",
        "description": "Due to their assigned administrative rights, administrators can potentially make profound changes to Unified Communications and Collaboration (@System:UCC) services.",
        "impact": "Unauthorized or abusive use of administrative privileges can lead to breaches of Confidentiality (e.g., exposing private chats/files), Integrity (e.g., unauthorized modification of data), and Availability (e.g., maliciously altering routing configurations to disrupt services like telephony).",
        "action": "Implement Strict Access Control, Monitoring, and Auditing for Administrative Roles on @System:UCC Systems",
        "mitigation": "Enforce the principle of least privilege for all administrative accounts on @System:UCC systems. Use dedicated, separate accounts for administrative tasks versus daily use.",
        "check": "Are administrative privileges on @System:UCC systems granted based on the principle of least privilege? Are all administrative actions logged? Are these logs regularly reviewed for suspicious activity? Are separate accounts used for administrative access?",
        "asvs": "BSI IT-Grundschutz Baustein APP.3.2 Unified Communications und Collaboration (@System:UCC)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_2_Unified_Communications_und_Collaboration_UCC__Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for technical assets that are identified as part of a @System:UCC system (e.g., mail servers, file servers, web applications, message queues) and are tagged with administrative roles.",
        "riskAssessment": "The impact is directly dependent on the confidentiality, integrity, and availability requirements of the @System:UCC system and the data it processes. A system handling 'strictly-confidential' data faces a 'very-high' impact.",
        "falsePositives": "A risk might be flagged as a false positive if the model does not capture compensating controls, such as a strictly enforced four-eyes principle for all administrative changes or real-time automated auditing that can block malicious actions.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "40_sec5.ts",
        "bsiCode": "IND.2.3",
        "id": "unintentional-disclosure-via-@System:UCC-client",
        "title": "Unintentional Information Disclosure via @System:UCC Client",
        "description": "Modern Unified Communications and Collaboration (@System:UCC) clients offer a wide range of features, which can make them complex and confusing for many users.",
        "impact": "Misuse of @System:UCC clients can lead to serious breaches of confidentiality and violations of internal policies. Sensitive information can be exposed to unauthorized individuals, both internal and external, leading to reputational damage, loss of competitive advantage, and potential legal or regulatory penalties.",
        "action": "Implement User Training and Harden @System:UCC Service Configuration",
        "mitigation": "A combination of user awareness and technical controls is required.",
        "check": "Are users regularly trained on secure @System:UCC practices? Are there clear policies for data handling within @System:UCC platforms? Are @System:UCC services configured with secure defaults (e.g., private-by-default team spaces)? Does the client UI provide clear warnings and indicators to prevent user error?",
        "asvs": "Derived from BSI IT-Grundschutz SYS.3.2.2 Unified Communications und Collaboration, specifically Requirement SYS.3.2.2.A5 'Sensibilisierung der Benutzer für die sichere Nutzung von @System:UCC-Diensten' (Sensitization of users for the secure use of @System:UCC services).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/sys/SYS_3_2_2_Unified_Communications_und_Collaboration_Edition_2023.pdf?__blob=publicationFile (BSI SYS.3.2.2)",
        "detectionLogic": "This risk is triggered for in-scope technical assets representing clients (e.g., Desktop, Mobile App, Browser) that are explicitly identified as being used for Unified Communications and Collaboration via the '@System:UCC-Client' tag.",
        "riskAssessment": "The likelihood of this risk is considered high due to the inherent complexity of feature-rich @System:UCC clients and common gaps in user awareness. The impact is determined by the sensitivity of the data that the client asset is rated to handle, as well as the data it processes. A client used to discuss 'Strictly Confidential' project details poses a much higher impact than one used for public relations.",
        "falsePositives": "The risk might be lower than calculated if the organization has an exceptionally robust and effective user training program for its @System:UCC tools, or if the specific client application has a very simple, intuitive design that minimizes the chance of user error.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "40_sec6.ts",
        "bsiCode": "IND.2.3",
        "id": "unwanted-disclosure-via-@System:UCC-services",
        "title": "Unwanted Disclosure of Information via @System:UCC Services (BSI OPS.2.2, OPS.1.1.5)",
        "description": "Unified Communications and Collaboration (@System:UCC) services often collect and display user data, such as presence status, activity timestamps, and even detailed analytics of conversations and content. This can lead to the creation of user profiles and the unintentional disclosure of personal or sensitive information.",
        "impact": "The unintentional disclosure of information can lead to privacy violations, enabling behavior and performance monitoring of employees. It can also expose personal relationships, work habits, and details of an individual's private life. This compromises confidentiality and can lead to reputational damage or social engineering attacks.",
        "action": "Implement and Enforce Privacy-Enhancing Configurations and User Training for @System:UCC Services.",
        "mitigation": "Technically, configure @System:UCC services to minimize data collection and exposure. Restrict visibility of presence status, disable or limit activity logging and analytics features, and enforce the use of virtual backgrounds or background blur in video conferences.",
        "check": "Are @System:UCC privacy settings reviewed and configured to a 'privacy-first' baseline? Are features like activity tracking disabled or their use justified and restricted? Is there a user training program that covers the privacy risks of remote collaboration and video conferencing?",
        "asvs": "BSI IT-Grundschutz Baustein OPS.2.2.A15 (Protection of user privacy in groupware) and OPS.1.1.5.A7 (Training for users of video conference systems).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_2_2_Groupware_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for assets identified as Unified Communications and Collaboration (@System:UCC) components. This includes both server-side assets (like Web Applications, Mail Servers, or Message Queues) that might aggregate user data, and client-side assets (like Mobile Apps or Browsers) that might expose the user's private environment when communicating with @System:UCC services.",
        "riskAssessment": "The likelihood is considered high for client applications due to the commonness of environmental exposure in video calls, and likely for server applications that offer extensive collaboration features. The impact is determined by the confidentiality of the data assets processed by the asset or transmitted over its communication links. Higher confidentiality data leads to a higher impact rating.",
        "falsePositives": "This risk might be a false positive if the identified asset is a @System:UCC tool with very limited functionality (e.g., a simple text-only chat with no presence) or if strong technical and organizational privacy controls are already proven to be in place and effective.",
        "cwe": "359",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "40_sec7.ts",
        "bsiCode": "IND.2.3",
        "id": "@System:UCC-service-interaction-risk-app-5-3",
        "title": "Functional Impairment due to @System:UCC Service Interaction (BSI APP.5.3.T5)",
        "description": "@System:UCC (Unified Communications and Collaboration) services can cause interactions with each other that restrict functionality.",
        "impact": "If @System:UCC services interfere with each other or overload the client system, their availability is compromised. This can disrupt business processes, prevent employees from completing tasks, and lead to a loss of productivity.",
        "action": "Isolate @System:UCC Services or Manage Shared Resources",
        "mitigation": "To prevent conflicts, run critical @System:UCC services on dedicated clients or in isolated environments (e.g., virtual machines).",
        "check": "Are multiple technical assets tagged with '@UCCService' running within the same shared runtime?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.5.3 @System:UCC-Clients (Edition 2022)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_5_3_UCC_clients_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is automatically triggered for any 'Shared Runtime' that contains two or more technical assets tagged as an '@UCCService'.",
        "riskAssessment": "The likelihood of a conflict is considered 'Likely' when multiple @System:UCC services are co-located. The impact is determined by the highest availability requirement among the conflicting services.",
        "falsePositives": "This risk might be a false positive if the @System:UCC applications are specifically designed to interoperate without conflict, or if the underlying operating system and hardware have robust resource management that prevents contention issues.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "40_sec8.ts",
        "bsiCode": "IND.2.3",
        "id": "uncontrolled-desktop-sharing",
        "title": "Uncontrolled Desktop or Application Sharing (BSI CON.3.A13)",
        "description": "When desktop or screen content is shared with other participants in a conversation (e.g., video conference, remote support), control can be transferred to other users.",
        "impact": "If an attacker or unauthorized participant gains control over a user's client, they can access sensitive data, install malware, manipulate files, or use the compromised",
        "action": "Restrict or Control Remote Desktop Sharing Features",
        "mitigation": "If the remote control feature is required, it should be disabled by default in collaboration tools.",
        "check": "Is remote control functionality in collaboration and screen-sharing tools disabled by default? Are users trained on the risks of this feature?",
        "asvs": "BSI IT-Grundschutz CON.3.A13 Remote control of clients",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Video_conferencing_systems_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for all in-scope client-type technical assets that are marked as being used by a human.",
        "riskAssessment": "The likelihood is considered higher for any client system, as the vulnerability stems from user behavior and common application features.",
        "falsePositives": "This risk may be a false positive if the remote control feature is confirmed to be disabled via technical controls (e.g., GPO, MDM policies)",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "40_sec9.ts",
        "bsiCode": "IND.2.3",
        "id": "@System:UCC-impersonation-risk",
        "title": "Impersonation Risk in Unified Communications and Collaboration (@System:UCC) Services",
        "description": "The introduction of new Unified Communications and Collaboration (@System:UCC) services, which often allow external parties to initiate contact, creates new avenues for attackers.",
        "impact": "Successful impersonation can lead to unauthorized disclosure of sensitive or confidential information, manipulation of business processes, and financial fraud.",
        "action": "Strengthen Identity Verification and User Awareness for Communication Platforms",
        "mitigation": "Implement a multi-layered defense. From a technical perspective, ensure that any user interface (UI) clearly and unmistakably labels communications originating from external sources.",
        "check": "Are all incoming communications from external sources clearly and prominently marked as such in the user interface?",
        "asvs": "V4.1 Identity and Verification Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Social_Engineering_Prevention_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for communication-oriented technical assets (like web applications, message queues, or mail servers) that are exposed to interaction from less-trusted sources.",
        "riskAssessment": "The likelihood of exploitation is high if the communication platform is directly exposed to the internet and lacks strong authentication for incoming interactions.",
        "falsePositives": "A technical asset might be flagged incorrectly if it has robust, non-bypassable controls for differentiating and flagging external communications that are captured in the threat model.",
        "cwe": "451",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Spoofing"
      }
    ],
    "IND.2.4": [
      {
        "file": "41_sec1.ts",
        "bsiCode": "IND.2.4",
        "id": "lack-of-maintenance-ops1.1.2",
        "title": "Lack of Regular Maintenance (BSI OPS.1.1.2)",
        "description": "If systems, applications, or hardware components are not regularly maintained, they can malfunction, perform poorly, or fail completely.",
        "impact": "Failure to perform regular maintenance primarily compromises the **Availability** of the affected asset and can also impact its **Integrity** (e.g., through data corruption or performance degradation).",
        "action": "Establish and Document a Regular Maintenance Plan",
        "mitigation": "Define, document, and implement a formal maintenance plan for all in-scope technical assets. This plan should specify maintenance tasks (e.g., patching, health checks, capacity monitoring, hardware inspection), frequencies, and responsible personnel.",
        "check": "Is there a documented maintenance plan for the asset? Are maintenance activities logged and auditable?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.2 (Proper Operation), specifically Requirement OPS.1.1.2.A11 (Maintenance and repair of IT components).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_2_Proper_operation_edition_2023.pdf?__blob=publicationFile (BSI OPS.1.1.2)",
        "detectionLogic": "This risk is raised for any technical asset that is not explicitly excluded (like serverless platforms or external entities) and does not have a `maintenance` tag.",
        "riskAssessment": "The likelihood of failure due to lack of maintenance increases with the asset's own operational requirements (i.e., its Availability rating).",
        "falsePositives": "A risk might be flagged for an asset that is actually well-maintained but lacks the corresponding tag in the model.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "41_sec2.ts",
        "bsiCode": "IND.2.4",
        "id": "insufficient-machine-interface-protection",
        "title": "Insufficient Machine Interface Protection (BSI-based)",
        "description": "If the interfaces of a machine (e.g., an IoT device, industrial control system, or mainframe) are insufficiently protected,",
        "impact": "Successful manipulation can lead to tampering with the machine's core functions. This could result in damaged physical goods or faulty product series (a loss of Integrity for processed assets),",
        "action": "Harden and Protect All Machine Interfaces",
        "mitigation": "Ensure that all communication links to the machine, especially those used for configuration, control, or administration, are adequately protected.",
        "check": "Review all incoming communication links to assets identified as physical machines. Are any using unencrypted protocols? Is authentication and/or authorization set to 'none'? Is network access appropriately restricted?",
        "asvs": "Not directly applicable as ASVS is web-focused. The equivalent in the Industrial Control Systems (ICS) space is IEC 62443, particularly concepts around zone and conduit boundaries and access control.",
        "cheatSheet": "https://www.cisa.gov/uscert/ICS/Recommended-Practices",
        "detectionLogic": "This rule triggers for technical assets that represent physical machines (i.e., `machine: physical`), particularly those with technologies like `IoT-device` or `mainframe`.",
        "riskAssessment": "The likelihood of exploitation is elevated if the insecure interface is accessible across a network trust boundary. The impact is directly correlated with the 'Integrity' and 'Availability' ratings of the machine.",
        "falsePositives": "This risk can be a false positive if there are strong compensating controls captured in the model, such as the machine being located in a physically secure, air-gapped network.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      }
    ],
    "IND.2.7": [
      {
        "file": "42_sec1.ts",
        "bsiCode": "IND.2.7",
        "id": "manipulation-of-safety-instrumented-system",
        "title": "Manipulation of Safety Instrumented System (based on NAMUR NA 163)",
        "description": "The manipulation of the application program on a logic system within a Safety Instrumented System (SIS) poses a significant risk. Unlike standard IT or OT components, a compromise of a SIS can have severe consequences for the safety of people, the environment, and physical plants.",
        "impact": "Successful manipulation can lead to a range of outcomes from operational downtime (spurious trip) to the complete failure of safety functions, potentially resulting in catastrophic physical damage, environmental harm, or loss of life when a hazardous event occurs.",
        "action": "Implement a Defense-in-Depth Security Architecture for OT/ICS Environments",
        "mitigation": "A multi-layered security approach is required. This includes strict network segmentation to isolate the SIS, robust access control mechanisms (both physical and logical) for the logic controller, and continuous integrity monitoring of the application program.",
        "check": "Is the SIS network segment isolated from the corporate and other control networks? Is access to the logic controller's programming interface restricted to authorized personnel and workstations?",
        "asvs": "Derived from BSI recommendations and NAMUR NA 163 guidelines for industrial control system security.",
        "cheatSheet": "https://www.namur.net/fileadmin/media/Publications/NA163_Automation_Security_for_Safety_Instrumented_Systems_2020-03-31.pdf",
        "detectionLogic": "This rule triggers on technical assets identified as core logic controllers for Safety Instrumented Systems, marked with the '@AssetType: sis-logic-controller' tag.",
        "riskAssessment": "The risk is assessed across three categories:",
        "falsePositives": "The risk may be overstated if the asset is incorrectly tagged or if there are extensive, un-modeled compensating controls (e.g., separate physical safety relays, redundant diverse systems).",
        "cwe": "749",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "42_sec2.ts",
        "bsiCode": "IND.2.7",
        "id": "inadequate-monitoring-of-it-infrastructure",
        "title": "Inadequate Monitoring of Supporting IT Infrastructure for Security Events",
        "description": "A key function of automation systems is to monitor the operational states of the process to be automated (e.g., fill levels, temperature).",
        "impact": "Failure to monitor the IT infrastructure prevents the early detection of security incidents, system failures, or performance degradation. This can lead to successful attacks going unnoticed, prolonged downtime, and an inability to perform forensic analysis, ultimately compromising the confidentiality, integrity, and availability of the system and its data.",
        "action": "Implement Comprehensive Security Monitoring and Logging",
        "mitigation": "Ensure that all critical IT infrastructure components (servers, network devices, applications, databases) generate security-relevant logs. These logs should be centrally collected, correlated, and monitored by a Security Information and Event Management (SIEM) system or a dedicated monitoring solution. Define and implement alerts for suspicious activities, security events, and critical system health indicators. Ensure monitoring systems themselves are secured and highly available. Model these monitoring systems and the communication links from monitored assets to them.",
        "check": "Are security-relevant events from all critical infrastructure components being logged? Is there a central logging and monitoring system in place? Are there defined alert rules for security events? Are personnel assigned to respond to these alerts? Is this architecture reflected in the threat model?",
        "asvs": "BSI IT-Grundschutz DER.1: Detection of Security-Relevant Events",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Detection_of_security_relevant_events_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified for any in-scope 'process' or 'datastore' asset that is not itself a monitoring component and does not have a documented communication link to a monitoring system (e.g., an asset with technology like 'Monitoring', 'IDS', 'IPS', or 'WAF').",
        "riskAssessment": "The likelihood is considered 'Likely' for any unmonitored critical component, as attacks and failures are common occurrences. The impact is rated based on the highest Confidentiality, Integrity, and Availability (CIA) rating of the technical asset, including the data it processes or stores. An unmonitored mission-critical database poses a very high impact.",
        "falsePositives": "This risk can be a false positive if monitoring is achieved through mechanisms not represented in the model, such as host-based agents reporting to a SaaS platform that isn't modeled, or via infrastructure-level monitoring in a cloud environment. It can also be a false positive for ephemeral assets or components with no security-sensitive role.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "IND.3.2": [
      {
        "file": "43_sec1.ts",
        "bsiCode": "IND.3.2",
        "id": "undocumented-@SystemType:OT-remote-access",
        "title": "Undocumented or Unmanaged Remote Maintenance Access in @SystemType:OT/@SystemType:ICS Environment",
        "description": "Remote maintenance access points in Operational Technology (@SystemType:OT) are often numerous and diverse, managed by various internal and external parties. This complexity can lead to an incomplete or inaccurate inventory of access points. If undocumented remote access paths exist, they cannot be controlled, monitored, or secured. Unauthorized users could gain access and directly manipulate physical processes, causing equipment malfunction, production standstills, or even physical harm to on-site personnel. This risk is often amplified when vendors supply 'Package Units' with pre-configured, insecure default remote access.",
        "impact": "An exploited unmanaged remote access can directly compromise the integrity and availability of Industrial Control Systems (@SystemType:ICS). This can lead to significant operational disruptions, damage to machinery, loss of production, and severe health and safety incidents. It represents a critical failure in the separation of IT and @SystemType:OT networks.",
        "action": "Establish and Maintain a Comprehensive Inventory and Management of Remote Access Points",
        "mitigation": "Establish a strict process for authorizing, documenting, and provisioning all remote access to the @SystemType:OT environment. Maintain a complete and current inventory of all remote access links, including their purpose, owner, and security controls. All access should be routed through a controlled gateway or 'jump host'. Default credentials and configurations from vendors must be changed immediately upon deployment. Employ a 'deny-by-default' network policy for the @SystemType:OT boundary. Ensure all remote connections use strong, multi-factor authentication, are encrypted, and are logged and monitored.",
        "check": "Is there a complete, up-to-date inventory of all remote maintenance access points into the @SystemType:OT zone? Is all remote access forced through a secure, monitored gateway? Are security controls like VPN, IP filtering, and strong authentication enforced on all remote links? Are default vendor settings for remote access disabled or changed?",
        "asvs": "Derived from BSI IT-Grundschutz Compendium, specifically concepts in IND.1 (Industrial Control System) and IND.2 (Remote maintenance of industrial components). This rule addresses the threat of unmanaged remote connections (IND.2.4.A1, IND.2.4.A2).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/IND_2_Remote_maintenance_of_industrial_components_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies communication links that originate from outside a trust boundary tagged as an '@Environment:OT' and target an asset within it. It flags such remote access links if they lack fundamental security controls like VPN, IP filtering, strong authentication, or encryption. The presence of such a link suggests a potential unmanaged or insecure remote access path.",
        "riskAssessment": "The likelihood of exploitation is high if multiple security controls are missing (e.g., no VPN and weak authentication). The impact is determined by the criticality of the target @SystemType:OT asset. If the asset controls a process with high integrity or availability requirements (e.g., mission-critical), the impact is rated as very high, reflecting the potential for physical damage or safety incidents.",
        "falsePositives": "This risk may be a false positive if compensating controls exist that are not modeled (e.g., a hardware firewall enforcing IP filtering that is not represented as a 'WAF' or 'ip_filtered' property in the model). The rule assumes that the model accurately reflects the security properties of the communication link.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "43_sec2.ts",
        "bsiCode": "IND.3.2",
        "id": "unmanaged-dependencies-between-@SystemType:OT-and-it",
        "title": "Unmanaged Dependencies between @SystemType:OT and Office IT (BSI @SystemType:ICS-style)",
        "description": "Industrial Control Systems (@SystemType:ICS) and Operational Technology (@SystemType:OT) often depend on uninterrupted, real-time data flows.",
        "impact": "If dependencies between @SystemType:OT and office IT are not taken into account and, as a result, security vulnerabilities are not closed, security incidents (especially availability failures) can quickly spread to the entire @SystemType:OT.",
        "action": "Segment and Control Connections between @SystemType:OT and Office IT",
        "mitigation": "Strictly segment the @SystemType:OT network from the office IT network using firewalls, data diodes, or other perimeter protection. All communication crossing this boundary must be explicitly defined, monitored, and secured.",
        "check": "Are there communication links between assets tagged '@Domain:IT' and assets tagged '@SystemType:OT'? Is remote maintenance performed via shared office IT infrastructure? Are the availability ratings of the IT assets sufficient for the dependent @SystemType:OT assets?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (General @SystemType:ICS component), specifically threat T 0.40 'Failure or disruption of a central infrastructure service'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_ICS_component_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is detected by identifying communication links that cross from a technical asset tagged as '@Domain:IT' to an asset tagged as '@SystemType:OT'.",
        "riskAssessment": "The impact is determined primarily by the Availability rating of the target @SystemType:OT asset. A dependency on a low-availability IT service for a 'mission-critical' @SystemType:OT asset constitutes a very high impact.",
        "falsePositives": "This risk can be a false positive if the network segmentation is handled by an out-of-scope component (e.g., a firewall not modeled in Threagile) that effectively mitigates the risk. The tagging '@Domain:IT' and '@SystemType:OT' must be applied correctly across assets to ensure accurate detection.",
        "cwe": "668",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "43_sec3.ts",
        "bsiCode": "IND.3.2",
        "id": "inadequately-regulated-@SystemType:OT-remote-access",
        "title": "Inadequately Regulated @SystemType:OT Remote Access (BSI CON.6)",
        "description": "@SystemType:OT remote maintenance access has a very large potential user base outside the operating institution. At the same time, the seamless availability of real-time data in an Industrial Control System (@SystemType:ICS) is essential. General regulations for office IT remote access are often unsuitable for @SystemType:OT or allow too much leeway. This lack of specific, restrictive rules for @SystemType:OT remote access can lead to severe security gaps.",
        "impact": "If the use of @SystemType:OT remote access is inadequately regulated, operators cannot control who uses the access or how it is used. This can lead to unauthorized access, credential sharing with unknown third parties, and difficulty in forensic analysis during security incidents, potentially prolonging costly production downtimes. If access paths are shared with standard office IT, inconsistent security configurations can arise that fail to meet the stricter requirements of the @SystemType:OT environment, exposing critical infrastructure to threats originating from the corporate network.",
        "action": "Implement Strict Contractual and Technical Controls for @SystemType:OT Remote Access",
        "mitigation": "Enforce dedicated, isolated access paths for all @SystemType:OT remote maintenance. Use a bastion host or jump server as a single, controlled entry point. Mandate strong multi-factor authentication (MFA/2FA) for all remote access. Ensure all connections are encrypted via VPN and an encrypted protocol. Apply the principle of least privilege for authorization. All remote access sessions must be logged in detail and monitored for suspicious activity. These technical requirements should be part of a formal, documented agreement with any third-party service provider.",
        "check": "Is there a documented policy specifically for @SystemType:OT remote access? Is access strictly limited to dedicated pathways, separate from corporate IT? Is two-factor authentication mandatory? Is the connection secured by both a VPN and an encrypted protocol? Are sessions logged and monitored?",
        "asvs": "BSI IT-Grundschutz CON.6 Remote Maintenance",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Remote_maintenance_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies remote maintenance communication links from external entities to technical assets within an @SystemType:OT environment. It then checks for common security weaknesses, such as inadequate authentication (n@SystemType:OT 2FA), lack of VPN encryption, or use of unencrypted protocols. It also detects architectural flaws where a single external entity has an access path to both @SystemType:OT and standard office IT environments, violating required network segmentation.",
        "riskAssessment": "The impact of any weakness in @SystemType:OT remote access is rated High or Very-High, depending on the availability and integrity requirements of the target @SystemType:OT asset, reflecting the potential for physical damage or production stoppage. The likelihood is rated based on the detected weakness; shared access paths are considered Very Likely to be exploited as a pivot vector, while missing technical controls are considered Likely.",
        "falsePositives": "The model may not fully represent complex network architectures, such as a well-configured bastion host that mitigates the risk of a shared access path. Such compensating controls should be verified manually before accepting the risk.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "43_sec4.ts",
        "bsiCode": "IND.3.2",
        "id": "uncontrolled-@SystemType:OT-remote-maintenance",
        "title": "Uncontrolled Remote Maintenance in @SystemType:OT Environments",
        "description": "Data and configuration settings within an Industrial Control System (@SystemType:ICS), as well as on-site personnel, property, and production processes, can be endangered by any access from other zones that is not adequately controlled by internal on-site staff or is insufficiently secured. In particular, personnel from external maintenance service providers, integrators, and manufacturing companies have the necessary specialized knowledge of the plant, machine, or component to be maintained, but are often unaware of the potential harmful effects a specific remote maintenance session can have on the overall system.",
        "impact": "If the processes and contents of @SystemType:OT remote maintenance sessions cannot be adequately controlled by the operators, configuration errors with high-risk potential, as well as unintentional or intentional misconduct by maintenance personnel, may not be detected or traced quickly enough. This can lead to failures or manipulation of real-time data streams, or allow malware to spread unnoticed throughout the entire @SystemType:OT network. The consequences can range from harm to life and limb of on-site operating personnel, to high financial losses due to production downtimes, up to the destruction of entire plants. Disclosure of trade secrets is also possible. Furthermore, the integrity of the manufactured products can be impaired (e.g., through manipulation of recipes), which can lead to reputational damage.",
        "action": "Implement Controlled and Monitored Remote Maintenance Access",
        "mitigation": "All remote maintenance access to @SystemType:OT/@SystemType:ICS environments, especially from external entities, must be routed through a controlled and monitored gateway (e.g., a jump host or bastion host). Implement a strict approval process for every maintenance session (e.g., 'four-eyes principle'). All sessions must be logged and, for critical systems, recorded. Access should be restricted to specific systems and times (principle of least privilege). Use strong authentication and encrypted protocols (e.g., via a mandatory VPN). Network segmentation should prevent lateral movement from the maintenance target into the wider @SystemType:OT network.",
        "check": "Is all remote maintenance access from external parties logged and monitored? Is there a formal approval process for initiating a remote session? Is access restricted to only the necessary components and timeframes? Are secure protocols and VPNs enforced for all remote connections into the @SystemType:OT environment?",
        "asvs": "BSI IT-Grundschutz @SystemType:ICS.S.5 Fernwartung, BSI-CS 108",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/@SystemType:ICS/BSI-CS_108.pdf?__blob=publicationFile (German)",
        "detectionLogic": "This rule identifies communication links originating from an 'External Entity' used for 'DevOps' (maintenance) purposes that target a technical asset tagged as being part of an @SystemType:OT/@SystemType:ICS environment. The existence of such a direct, potentially unmanaged access path is the primary risk.",
        "riskAssessment": "The likelihood is considered high by default for any direct external maintenance access to an @SystemType:OT system, as the potential for unmonitored, uncoordinated actions is significant. The impact is derived from the availability and integrity rating of the target @SystemType:OT asset, as failures or manipulations can halt production or destroy equipment. If the target asset is 'Mission-Critical', the impact is rated as 'Very High'.",
        "falsePositives": "A risk might be a false positive if the model shows a direct connection, but in reality, it passes through a central, fully-controlled and monitored remote access solution that is not explicitly modeled as a separate asset. In such cases, the risk can be accepted with justification.",
        "cwe": "552",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "43_sec5.ts",
        "bsiCode": "IND.3.2",
        "id": "direct-access-to-@SystemType:ICS-@SystemType:OT-from-less-trusted-networks",
        "title": "Direct IP Access to @SystemType:ICS/@SystemType:OT Systems from Less-Trusted Networks (BSI CON.6)",
        "description": "Data within an Industrial Control System (@SystemType:ICS) as well as on-site personnel, property, and production processes are fundamentally endangered by direct IP-based access from other zones and networks. This is exacerbated by factors like the significantly longer patch cycles in @SystemType:OT compared to office IT. Furthermore, remote maintenance access to an @SystemType:ICS often originates from networks that are not fully trusted, including not only external third-party networks but also other zones within the organization's own network, such as internal office IT, building management systems, or even other @SystemType:OT zones (e.g., for production management with MES, ERP).",
        "impact": "Direct access to an @SystemType:ICS from other zones and networks, for instance via a local connection or VPN, can introduce malware and facilitate targeted attacks. This can lead to physical harm to individuals, substantial financial losses from production downtime, and the exfiltration of confidential information, such as trade secrets.",
        "action": "Implement Strict Network Segmentation and Access Control for @SystemType:ICS/@SystemType:OT Environments",
        "mitigation": "Prohibit direct communication from less-trusted networks (like office IT) to the @SystemType:OT/@SystemType:ICS network zone. All remote access must be brokered through a hardened bastion host (jump server) located in a dedicated Demilitarized Zone (DMZ). Enforce strict firewall rules to ensure that only authorized and necessary traffic can enter the @SystemType:OT zone, based on the principle of least privilege. Use secure protocols for all remote access and monitor all connections crossing the boundary into the @SystemType:OT environment.",
        "check": "Are there any direct communication links from assets in office/corporate networks to assets inside the @SystemType:OT/@SystemType:ICS trust boundary? Is all remote maintenance access forced through a hardened jump host? Are firewall rules in place to strictly control traffic into the @SystemType:OT zone?",
        "asvs": "BSI IT-Grundschutz CON.6 (Industrial Control Systems)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Industrial_Control_Systems_ICS_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule checks for communication links that cross from a non-@SystemType:OT network boundary directly into an @SystemType:OT network boundary, targeting an asset tagged as '@SystemType:OT-Asset'. It identifies situations where office systems, clients, or other non-hardened assets have a direct communication path to critical industrial control systems, bypassing recommended architectural patterns like a DMZ with a bastion host.",
        "riskAssessment": "The impact is determined by the CIA ratings of the target @SystemType:OT asset, reflecting the potential for physical harm, production stoppage, or data theft. The likelihood is considered higher for remote maintenance connections ('devops' usage) or connections from standard client systems, as these are common attack vectors. Unencrypted protocols further increase the likelihood.",
        "falsePositives": "A direct connection might be reported as a risk even if it is secured by an external, un-modeled firewall with very strict rules. This risk is most accurate when trust boundaries are modeled correctly to represent the separation between @SystemType:OT and corporate networks.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "43_sec6.ts",
        "bsiCode": "IND.3.2",
        "id": "insecure-alternative-remote-access-@SystemType:OT",
        "title": "Insecure Alternative Remote Maintenance Access to @SystemType:OT/@SystemType:ICS Environments",
        "description": "In industrial environments, alternative remote maintenance accesses are often set up to ensure reliability and performance, especially during incidents where primary access may fail or be too slow. These secondary access paths (e.g., via cellular modem) provide a quick way to manage remote systems. However, such alternative access points can be particularly vulnerable to attack if they are not implemented with the same rigor as primary systems.",
        "impact": "If an alternative remote access path does not fully meet the institution's security requirements, attackers can use it as a weak point to penetrate the @SystemType:OT network. This can lead to unauthorized control of industrial processes, equipment damage, production stoppage, safety hazards, and the theft of sensitive operational data, severely impacting the Integrity and Availability of the @SystemType:ICS.",
        "action": "Secure and Harden All Remote Maintenance Access Paths",
        "mitigation": "Ensure that all remote access paths, including alternative and emergency ones, are subject to the same stringent security policies. This includes enforcing strong multi-factor authentication (MFA), using encrypted protocols (e.g., within a robust VPN), implementing strict IP-based access control lists (firewalls), and routing traffic through a bastion host or jump server. All access attempts should be logged and actively monitored. Alternative access should be disabled by default and only enabled when explicitly required.",
        "check": "Are all remote access paths to @SystemType:OT networks, including alternatives, fully documented? Do they all enforce MFA, strong end-to-end encryption, and strict access controls? Is all remote access traffic logged and monitored for anomalies?",
        "asvs": "BSI IT-Grundschutz CON.1: General Remote Access. The described scenario is a classic example of bypassing standard security controls for operational convenience, a key concern in @SystemType:ICS security.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/CON_1_General_remote_access_Edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
        "detectionLogic": "This rule checks for communication links tagged as '@MaintenanceAccess:alternative' that provide access to sensitive @SystemType:OT/@SystemType:ICS networks. A risk is raised if such a link originates from a non-@SystemType:OT environment and lacks fundamental security controls like VPN, IP filtering, strong authentication, or protocol-level encryption.",
        "riskAssessment": "The impact is directly related to the criticality of the target @SystemType:OT asset. Access to a mission-critical system can have a 'Very High' impact. The likelihood is considered 'Likely' or 'Very Likely' because attackers specifically target such misconfigured remote access points as they are often a reliable and overlooked entry vector.",
        "falsePositives": "The model might capture compensating controls (e.g., a separate, unmodeled hardware firewall) that mitigate the risk. A link might be tagged as an alternative but still be fully secured, which would result in a false positive. Manual verification of the link's security configuration is recommended.",
        "cwe": "287",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "43_sec7.ts",
        "bsiCode": "IND.3.2",
        "id": "insecure-@SystemType:OT-remote-maintenance-access",
        "title": "Insecure Remote Maintenance Access in @SystemType:OT/@SystemType:ICS Environments (BSI CON.1-Style)",
        "description": "Decentralized Industrial Control System (@SystemType:ICS) infrastructures often feature numerous remote maintenance access points from various manufacturers, many using proprietary solutions. This complexity hinders proper central security management. When these @SystemType:OT remote access points are located in openly accessible areas, or are protected only by weak, manufacturer-provided security components that do not meet the organization's standards, attackers can more easily penetrate @SystemType:OT networks to carry out manipulations.",
        "impact": "Successful exploitation of insecure remote access can allow attackers to manipulate control processes, disrupt physical operations, cause equipment damage, and compromise safety systems. This directly threatens the integrity and availability of the @SystemType:OT environment, leading to production loss, financial damage, and potential physical harm.",
        "action": "Implement Hardened and Centralized Remote Access Solution",
        "mitigation": "All remote maintenance access to @SystemType:OT environments should be routed through a centralized, hardened bastion host or jump server. Enforce strong, multi-factor authentication (MFA) for all remote access. Use encrypted protocols (e.g., VPN, SSH tunnels) for the entire communication path. Physically secure any hardware providing remote access capabilities. Deactivate or replace weak, manufacturer-default credentials and security settings with configurations that comply with internal security policies. Implement strict network segmentation and firewall rules to limit access from the bastion host to only the necessary target systems and ports.",
        "check": "Are all @SystemType:OT remote access points inventoried and managed centrally? Is strong MFA required for all remote connections? Are all remote sessions encrypted end-to-end? Are remote access points physically secured? Have default manufacturer credentials and settings been changed?",
        "asvs": "BSI IT-Grundschutz CON.1: Remote Access",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Remote_access_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies communication links from external entities to technical assets tagged as '@SystemType:OT-Asset'. It flags risks for specific vulnerabilities: physical insecurity of the target asset (tagged '@PhysicalSecurity:Insufficient'), use of unencrypted communication protocols, or weak authentication methods (like 'none' or just 'credentials').",
        "riskAssessment": "The impact is determined by the integrity and availability rating of the target @SystemType:OT asset, as these are paramount in an @SystemType:ICS environment. A breach of a 'mission-critical' asset has a 'very-high' impact. The likelihood is considered 'very-likely' for easily exploitable conditions like physical access or no encryption, and 'likely' for weak credential-based authentication.",
        "falsePositives": "A model might not capture all compensating controls, such as a separate, un-modeled firewall appliance that restricts access. The risk might be flagged even if the connection is only used in highly controlled, temporary maintenance windows.",
        "cwe": "288",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "43_sec8.ts",
        "bsiCode": "IND.3.2",
        "id": "insecure-@SystemType:OT-remote-maintenance-access-@SystemType:ICS-3-a5",
        "title": "Insecure @SystemType:OT Remote Maintenance Access (BSI @SystemType:ICS.3.A5)",
        "description": "Due to long lifecycles in industrial environments, @SystemType:OT remote maintenance solutions are often used for a decade or more and may have security vulnerabilities due to their age.",
        "impact": "If @SystemType:OT remote maintenance access points are not adequately secured, this facilitates unauthorized access to an Industrial Control System (@SystemType:ICS) and other networks and systems both inside and outside the @SystemType:OT environment.",
        "action": "Secure, Inventory, and Regularly Review @SystemType:OT Remote Maintenance Access",
        "mitigation": "Maintain a complete inventory of all remote maintenance access points for @SystemType:OT systems. Disable any unused or unknown access points immediately.",
        "check": "Is there a complete inventory of all @SystemType:OT remote maintenance accesses? Are all connections encrypted and do they use strong authentication?",
        "asvs": "BSI IT-Grundschutz @SystemType:ICS.3.A5: Insecure remote maintenance access",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ICS_3_Remote_maintenance_and_remote_access_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for technical assets tagged as `@SystemType:OT-system` that have insecure remote access.",
        "riskAssessment": "The impact is determined by the integrity and availability rating of the @SystemType:OT asset, as manipulation and denial of service are the primary threats. An asset with 'mission-critical' integrity or availability will result in a 'very-high' impact.",
        "falsePositives": "The model might not capture all compensating controls, such as an intermediate firewall or bastion host that secures the connection.",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "INF.10": [
      {
        "file": "44_sec1.ts",
        "bsiCode": "INF.10",
        "id": "improper-handling-of-physical-environments",
        "title": "Improper Handling of Physical Environments (based on BSI Recommendations)",
        "description": "Based on BSI recommendations, a common vulnerability arises when employees fail to secure physical spaces after use.",
        "impact": "This can lead to the unauthorized disclosure of confidential information, violating data protection regulations and causing reputational or financial damage.",
        "action": "Establish, Communicate, and Enforce Clear-Desk and Clear-Room Policies.",
        "mitigation": "Define and communicate clear rules for securing physical work environments, especially shared spaces like meeting rooms. This includes policies for closing doors/windows, erasing whiteboards, and securing documents.",
        "check": "Are there established 'clear room' and 'clear desk' policies? Is this topic covered in security awareness training? Are physical security walkthroughs performed?",
        "asvs": "BSI IT-Grundschutz INF.1 General Building, particularly INF.1.A15 Use of Rooms for other Purposes and INF.1.A16 Order and Cleanliness.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This organizational risk is detected by identifying technical assets that are explicitly modeled as physical machines (`machine: physical`) or are located in shared physical spaces (e.g., tagged with `@Location:MeetingRoom`).",
        "riskAssessment": "The likelihood is considered 'Likely' by default, assuming a baseline lack of specific training or enforcement. The impact is derived from the highest confidentiality of the data assets processed or stored by the physical technical asset, or the confidentiality of the asset itself.",
        "falsePositives": "The model cannot verify the actual implementation of physical security policies or the effectiveness of employee training. This risk should be validated against the organization's real-world security practices.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "44_sec2.ts",
        "bsiCode": "INF.10",
        "id": "incompatible-hardware-interfaces-sys-1-7",
        "title": "Incompatible Hardware Interfaces (BSI SYS.1.7)",
        "description": "Mobile IT systems are increasingly used in diverse environments. A common issue is the inability to use these systems as planned due to physical incompatibility with foreign IT systems.",
        "impact": "The primary impact is a loss of availability, preventing users from performing their tasks. This can disrupt business processes significantly.",
        "action": "Ensure Hardware Compatibility for Mobile Assets",
        "mitigation": "Establish a standard for hardware interfaces on all corporate mobile devices.",
        "check": "Are mobile assets (like laptops) equipped with standard, modern interfaces? Is a standard adapter kit issued to users of mobile assets?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.1.7 Mobiler Arbeitsplatz (Mobile Workstation), specifically related to the general operational risks in varied environments.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_7_Mobile_workstation_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk applies to technical assets that are physically mobile and used in various environments.",
        "riskAssessment": "The likelihood is considered 'Likely' for any mobile asset, as encountering varied environments is inherent to its use.",
        "falsePositives": "A risk might be flagged for a mobile asset where the organization has already implemented robust mitigation measures (e.g., providing universal dongles to all employees).",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "44_sec3.ts",
        "bsiCode": "INF.10",
        "id": "improper-physical-cabling",
        "title": "Improper Physical Cabling in Shared-Use Rooms",
        "description": "In rooms with frequently changing use, such as meeting, event, or training rooms, the equipment setup and cabling are often modified.",
        "impact": "Physical damage to IT systems caused by tripping over insecure cables can lead to a direct loss of availability for those systems (e.g., laptops, projectors, network devices).",
        "action": "Ensure Secure and Orderly Cabling Practices",
        "mitigation": "In all shared-use rooms, ensure that power and data outlets are conveniently located to minimize the need for long cable runs.",
        "check": "Perform physical inspections of meeting, event, and training rooms. Are there loose cables creating tripping hazards on the floor?",
        "asvs": "BSI IT-Grundschutz: INF.6 Cabling (specifically INF.6.A4 Orderly cabling) and INF.5 Room and Cabinet.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_Edition2023/bausteine/INF/INF_6_Cabling_Edition_2023.pdf?__blob=publicationFile (BSI INF.6)",
        "detectionLogic": "This risk is identified for technical assets located within trust boundaries tagged as shared-use spaces (e.g., '@Location:MeetingRoom').",
        "riskAssessment": "The likelihood is considered 'Likely' for any client-type device in a designated shared-use room, as these environments inherently have changing setups.",
        "falsePositives": "This risk might be flagged for a device that is permanently and securely installed within a shared-use room (e.g., a rack-mounted switch in a closet).",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "44_sec4.ts",
        "bsiCode": "INF.10",
        "id": "theft-of-it-equipment-in-meeting-rooms",
        "title": "Theft of IT Equipment from Meeting/Event Rooms (BSI INF.5.G1)",
        "description": "If data carriers, IT systems, accessories, software, or data that are sometimes permanently installed in a meeting, event, or training room are stolen,",
        "impact": "The theft of equipment leads to direct financial costs for replacement and restoration. It causes a loss of availability for the room and the associated business functions.",
        "action": "Implement Physical Security Measures for Assets in Shared/Public Spaces",
        "mitigation": "Physically secure all IT assets in meeting, event, or training rooms. For mobile devices like laptops, use Kensington locks or secure storage cabinets.",
        "check": "Are there policies and procedures for the physical security of assets in common areas like meeting rooms? Are devices like laptops required to be secured when left unattended?",
        "asvs": "BSI IT-Grundschutz Kompendium 2023: INF.5 Raum und Schrank (Room and Cabinet)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_and_cabinet_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any technical assets marked with a tag indicating they are located in a shared physical space like a meeting room (`@Physical@Location:MeetingRoom`).",
        "riskAssessment": "The likelihood is considered 'Likely' due to the opportunistic nature of physical theft in accessible areas. The impact is calculated based on the highest CIA requirement",
        "falsePositives": "This risk can be considered a false positive if the specific location tagged has exceptionally strong, enforced, and audited physical security controls that are captured in the model.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "44_sec5.ts",
        "bsiCode": "INF.10",
        "id": "unauthorized-disclosure-of-confidential-information",
        "title": "Unauthorized Disclosure of Confidential Information (based on BSI G 2.4)",
        "description": "Confidential information can be disclosed through technical failures, carelessness, ignorance, or intentional malicious acts. This information may reside on various media, such as internal storage within IT systems (e.g., hard drives), removable storage media (e.g., USB drives), or during transmission over a network. If information is read or disclosed without authorization, it can have serious consequences for the organization.",
        "impact": "Unauthorized disclosure of information can lead to severe consequences, such as violations of laws (e.g., @DataType:PII), competitive disadvantages, loss of customer trust, and direct financial losses.",
        "action": "Enforce Data-at-Rest and Data-in-Transit Encryption for Sensitive Data",
        "mitigation": "For data at rest, ensure that all technical assets storing `confidential` or `strictly-confidential` data use strong, modern encryption. This can be achieved through transparent disk/file system encryption, database-level encryption, or application-level encryption. The asset's `encryption` property in the model should be set accordingly (e.g., to `transparent` or a data-level encryption style). For data in transit, all communication links carrying such data must use strong, authenticated, and encrypted protocols like TLS 1.2+ (e.g., HTTPS, WSS, LDAPS, JDBC-encrypted).",
        "check": "Review asset configurations to verify that `encryption` is enabled for stored sensitive data. Analyze communication links in the model to ensure protocols are encrypted (e.g., `https`, `ldaps`) when transferring sensitive data. Penetration tests and network traffic analysis can confirm these controls in the running system.",
        "asvs": "OWASP ASVS V4.0.3: V4.1 (Data Classification), V4.2 (Data Protection)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html, https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers risks for two primary conditions: 1. A technical asset (especially a `datastore`) stores `confidential` or `strictly-confidential` data but has its `encryption` property set to `none`. 2. A communication link transfers `confidential` or `strictly-confidential` data but uses an unencrypted protocol.",
        "riskAssessment": "The impact is directly tied to the confidentiality level of the data involved (`High` for confidential, `Very High` for strictly confidential). The likelihood is considered `Very Likely` if sensitive data is handled without any encryption, as this represents a direct and exploitable weakness. The overall severity is calculated from these factors.",
        "falsePositives": "A risk might be flagged if encryption is handled by an underlying platform or hardware layer explicitly modeled (e.g., an encrypted file system on the host VM). In such cases, the asset's `encryption` property in the model should be updated to `transparent` to reflect this control and resolve the finding.",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "INF.11": [
      {
        "file": "45_sec1.ts",
        "bsiCode": "INF.11",
        "id": "bsi-unregulated-vehicle-comms",
        "title": "Disclosure of Confidential Information via Unregulated In-Vehicle Networks (BSI 2.1)",
        "description": "If it is not regulated, or only inadequately regulated, which information may be transmitted and processed via networks provided by vehicles for users (e.g., @Network:WLAN or Bluetooth) and which protective measures must be taken, confidential information may be disclosed. If rules for securing and using these networks are insufficient, sensitive information such as personal data could be exposed.",
        "impact": "Unauthorized disclosure of confidential or personal data transmitted over in-vehicle networks, leading to privacy violations, compliance failures, reputational damage, and potential financial loss.",
        "action": "Define and Enforce Secure Configuration Policies for In-Vehicle Networks",
        "mitigation": "Establish clear policies for all in-vehicle communication interfaces (@Network:WLAN, Bluetooth, etc.). Policies must specify the types of data permitted for transmission, require strong authentication and encryption (e.g., WPA3 for Wi-Fi, secure pairing for Bluetooth), and mandate secure default configurations. These policies must be enforced and regularly audited. Communication links in the model should use encrypted protocols.",
        "check": "Are there documented policies for in-vehicle network usage? Do all modeled communication links from the vehicle asset use encrypted protocols? Is authentication required for connections?",
        "asvs": "BSI IT-Grundschutz Kompendium 2023, Baustein INF.11: Allgemeines Fahrzeug",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP/APP_6_Vehicles_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Triggered for any 'IoT Device' technical asset (representing a vehicle) that has at least one outgoing communication link where: (1) the protocol is unencrypted (isProtocolEncrypted(link.protocol) === false) and vpn === false; and (2) the highest confidentiality of the transmitted data is 'Restricted' or higher.",
        "riskAssessment": "Impact depends directly on the confidentiality of data transmitted from the vehicle asset. Likelihood is 'Likely' or 'Very Likely' if unencrypted communication protocols are used for sensitive data. If strong encryption is used on all relevant links, the risk is mitigated.",
        "falsePositives": "This risk may be a false positive if the 'IoT Device' is not a vehicle or if the transmitted data is misclassified in the model. A link might be tunneled over a VPN, which should be modeled explicitly.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "INF.12": [
      {
        "file": "46_sec1.ts",
        "bsiCode": "INF.12",
        "id": "cable-fire-bsi-inf-1",
        "title": "Cable Fire (BSI INF.1)",
        "description": "Cable fires can cause significant damage to an information system. A fire can cause short circuits, interrupt conductors, lead to the failure of protective equipment, and release aggressive, corrosive gases from insulation materials, causing long-term damage to electronic components.",
        "impact": "The primary impact is a loss of availability for all affected physical assets and the communication links they depend on, potentially leading to a complete service outage. Secondary impacts include loss of integrity due to data corruption from short circuits or abrupt power failures, and potential loss of confidentiality if physical or logical security controls (e.g., firewalls, access systems) fail as a consequence.",
        "action": "Implement physical and environmental controls for fire protection",
        "mitigation": "Ensure proper fire prevention measures are in place, such as using fire-retardant cabling (e.g., plenum-rated), maintaining proper cable management to avoid overheating, and performing regular inspections of electrical systems. Implement and regularly test fire detection (e.g., smoke/heat detectors) and suppression systems (e.g., inert gas suppression in server rooms). Ensure physical separation of redundant systems and cable routes to minimize the impact of a localized fire.",
        "check": "Are fire detection and suppression systems installed and regularly tested? Is fire-retardant cabling used in critical areas? Are redundant systems and their cabling physically separated? Is there a documented fire safety and evacuation plan?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.1 (General building) Requirement INF.1.A17 (Fire prevention and protection in buildings).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all in-scope technical assets of the 'physical' machine type located within an 'on-premise' network trust boundary. These assets are susceptible to physical threats like fire, which are visible in a logical threat model.",
        "riskAssessment": "The impact is directly related to the availability and integrity criticality of the affected physical asset. A fire damaging a 'Mission-Critical' system has a 'Very-High' impact. The likelihood is set to 'Unlikely' by default, as major fires are not a daily occurrence, but this should be re-evaluated based on the specific physical environment and preventive measures in place.",
        "falsePositives": "This risk can be considered a false positive or mitigated if the physical location has certified, regularly maintained fire detection and suppression systems, and if appropriate fire-retardant infrastructure is verifiably in place. The model typically lacks insight into these specific physical controls.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "46_sec10.ts",
        "bsiCode": "INF.12",
        "id": "wiretapping-or-cable-manipulation",
        "title": "Wiretapping or Physical Manipulation of Data Cables (BSI INF.5)",
        "description": "Eavesdropping on data cables is a significant threat to information security. No cable is completely immune to tapping;",
        "impact": "Successful eavesdropping attacks compromise the confidentiality of all data transmitted over the affected line.",
        "action": "Use End-to-End Encryption and Ensure Physical Security of Cabling",
        "mitigation": "The most effective technical countermeasure is the consistent use of strong, end-to-end encryption protocols (e.g., TLS, IPsec/VPN) for all data transmission.",
        "check": "Is the communication protocol encrypted? Is the data transmitted over the link sensitive? Are the physical pathways for the cabling secured against unauthorized access?",
        "asvs": "BSI IT-Grundschutz Kompendium: INF.5 Verkabelung (Cabling), Threats INF.5.G5 Abhören der Kommunikationsverbindungen (Eavesdropping) and INF.5.G6 Manipulation oder Zerstörung der Kommunikationsverbindungen (Manipulation/Destruction).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Cabling_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks all communication links that are process-local. It triggers a risk for any link that uses an unencrypted protocol.",
        "riskAssessment": "The likelihood of a physical attack is considered higher for links crossing trust boundaries. The impact is calculated based on the highest Confidentiality,",
        "falsePositives": "This risk might be a false positive if the physical path of the cable is demonstrably secure (e.g., within a guarded data center),",
        "cwe": "311",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "46_sec2.ts",
        "bsiCode": "INF.12",
        "id": "inadequate-physical-capacity-planning",
        "title": "Inadequate Capacity Planning for Physical Infrastructure",
        "description": "When data centers, server rooms, or other physical hosting environments are planned, the designs are often based exclusively on current needs.",
        "impact": "If the physical infrastructure cannot support required growth, it can be impossible to deploy new systems or scale existing ones, directly impacting service availability.",
        "action": "Incorporate Scalability and Future Growth into Physical Infrastructure Planning",
        "mitigation": "During the planning and build-out of physical locations like data centers, explicitly plan for future growth.",
        "check": "Is there documentation for the power, network, and cooling capacity of the physical site? Was future growth a specified requirement during its design? Are there established procedures for capacity monitoring and review?",
        "asvs": "BSI IT-Grundschutz: INF.1 Allgemeines Gebäude (General Building)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers for physical, on-premise, or dedicated-hoster network trust boundaries that are not explicitly tagged as being designed for growth.",
        "riskAssessment": "The impact is determined by the highest availability requirement of the technical assets located within the boundary; if mission-critical systems cannot be scaled, the impact is very high.",
        "falsePositives": "This risk may be a false positive if a physical location is implicitly scalable even without being tagged, or if it hosts legacy systems with no foreseeable growth. Manual verification of the site's physical planning is required to confirm.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "46_sec3.ts",
        "bsiCode": "INF.12",
        "id": "improper-cabling-documentation-inf5",
        "title": "Improper Documentation of Physical Cabling (BSI INF.5)",
        "description": "If the exact location of physical network cables is unknown due to insufficient documentation, these cables can be accidentally damaged during construction, relocation, or maintenance work.",
        "impact": "Accidental damage to undocumented physical cabling can lead to a Denial of Service (DoS) for all systems and applications that rely on the affected network connection, potentially causing major business disruptions.",
        "action": "Establish and Maintain Comprehensive Cabling Documentation",
        "mitigation": "Create and maintain a detailed, accurate, and up-to-date documentation of all physical network cabling, including precise cable runs, patch panels, outlets, and connection points.",
        "check": "Is there a complete and current cabling plan for all physical network infrastructure? Are all physical cables and connection points clearly labeled?",
        "asvs": "BSI IT-Grundschutz Baustein INF.5 Verkabelung, Anforderung INF.5.A10 Dokumentation der passiven Netzkomponenten.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Cabling_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for communication links that likely represent physical, on-premise cabling but are not explicitly marked as documented.",
        "riskAssessment": "The likelihood of accidental damage is higher in environments undergoing frequent physical changes (e.g., construction, office reorganization, hardware changes).",
        "falsePositives": "This risk may be a false positive if comprehensive cabling documentation exists but this fact is not captured via a tag in the threat model.",
        "cwe": "730",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "46_sec4.ts",
        "bsiCode": "INF.12",
        "id": "unsecured-network-or-power-distributors",
        "title": "Unsecured Network or Power Distributors in Accessible Areas",
        "description": "Occasionally, power supply or data network distributors are installed without locks in generally accessible areas.",
        "impact": "Physical tampering with unsecured distributors can cause a Denial of Service, interrupting critical business processes that rely on the affected network or power infrastructure.",
        "action": "Secure Physical Infrastructure Components",
        "mitigation": "Ensure that all power and data network distributors (e.g., patch panels, server racks, fuse boxes) located in accessible or semi-public areas are installed in lockable cabinets or rooms.",
        "check": "Are all physical network and power distribution points in accessible areas secured against unauthorized access?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Physical and Environmental Security), Requirement INF.5.A10 (Protection of the technical infrastructure).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Physical_and_environmental_security_edition_2023.pdf?__blob=publicationFile (BSI INF.5)",
        "detectionLogic": "This risk is triggered for in-scope physical assets (`machine: physical`) that are tagged with `@PhysicalSecurity:Insufficient`.",
        "riskAssessment": "The impact is determined by the availability requirements of the physical asset and the data it processes or stores. A physical server hosting mission-critical applications poses a very high impact if taken offline.",
        "falsePositives": "This risk may be a false positive if compensating controls exist that are n@SystemType:OT modeled, such as constant surveillance of the area or if the 'accessible area' is still within a broader secure perimeter.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "46_sec5.ts",
        "bsiCode": "INF.12",
        "id": "unprotected-cables",
        "title": "Risk of Damaged Unprotected Cables",
        "description": "If a cable is routed in an unprotected manner, the risk of it being damaged, either intentionally or unintentionally, increases.",
        "impact": "Damage to physical cables can lead to a Denial of Service (DoS) by interrupting network connectivity between critical systems.",
        "action": "Ensure Secure Cable Routing and Physical Protection",
        "mitigation": "Cables should be routed through physically secure areas (e.g., locked server rooms, protected cable ducts, raised floors).",
        "check": "Are network cables for critical systems physically protected along their entire length? Is access to server rooms and wiring closets controlled? Are there regular physical inspections of the infrastructure?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Cabling), which details requirements for secure physical network infrastructure.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Bausteine/INF/INF_5_Verkabelung_Edition_2023.html",
        "detectionLogic": "This risk is generated for communication links between two technical assets that are both marked as `physical` machines and reside within the same on-premise trust boundary (`network-on-prem` or `network-dedicated-hoster`).",
        "riskAssessment": "The likelihood is considered 'Likely' for any unprotected physical connection, as both accidents and malicious acts are common threats in unsecured environments.",
        "falsePositives": "The model assumes a standard level of physical risk for on-premise connections.",
        "cwe": "732",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "46_sec6.ts",
        "bsiCode": "INF.12",
        "id": "power-supply-fluctuation-inf2.4",
        "title": "Power Supply Fluctuations (BSI INF.12 2.6)",
        "description": "Fluctuations in the supply voltage, such as surges, sags, or brownouts, can occur in all areas of electrical networks.",
        "impact": "If IT systems are affected by power supply fluctuations, their Availability is directly threatened, leading to service interruptions and potential hardware failure.",
        "action": "Implement power conditioning and @Backup:Target",
        "mitigation": "Protect sensitive and critical IT systems with an Uninterruptible Power Supply (UPS) to provide short-term @Backup:Target power and protect against voltage fluctuations.",
        "check": "Are critical servers and network components connected to a UPS? Is the capacity of the UPS sufficient for the connected load?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.12 (Cabling) section 2.6 (Voltage fluctuations, overvoltage, undervoltage) and requirements INF.12.A4 (EMC-compliant power supply) and INF.12.A7 (Surge protection).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Data_Centre_edition_2023.pdf?__blob=publicationFile (BSI INF.12)",
        "detectionLogic": "This risk applies to all in-scope technical assets running on physical or virtual machines, as they rely on a stable power supply.",
        "riskAssessment": "The impact is determined by the availability and integrity requirements of the affected asset. An asset with 'Mission-Critical' availability has a very high impact.",
        "falsePositives": "This risk may be a false positive if an asset is located in a data center with certified high-availability power infrastructure that is explicitly modeled with a tag,",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "46_sec7.ts",
        "bsiCode": "INF.12",
        "id": "improper-use-of-power-strips-inf5",
        "title": "Improper Use of Power Strips (BSI INF.12)",
        "description": "The use of low-quality power strips or chaining multiple strips together ('daisy-chaining') is a common but dangerous practice.",
        "impact": "A fire caused by faulty power strips can lead to catastrophic data loss, destruction of hardware, and prolonged service unavailability.",
        "action": "Ensure Proper Power Distribution and Cabling",
        "mitigation": "Only use high-quality, certified (e.g., CE, VDE) power strips adequate for the required load. Strictly prohibit the practice of chaining power strips ('daisy-chaining').",
        "check": "Are power strips daisy-chained anywhere in the facility? Are the power strips in use certified and of high quality?",
        "asvs": "N/A (physical security risk). See BSI IT-Grundschutz INF.12: Cabling.",
        "cheatSheet": "BSI IT-Grundschutz: INF.12 Cabling (Verkabelung)",
        "detectionLogic": "This is a physical, operational risk. It cannot be detected by analyzing a logical model alone.",
        "riskAssessment": "The impact is directly derived from the **Availability** and **Integrity** rating of the physical asset. A physical machine hosting mission-critical services will suffer a much higher impact from a fire.",
        "falsePositives": "This risk can be considered a false positive if the organization can demonstrate that strict power management and cabling policies are enforced, including the exclusive use of high-quality hardware and regular inspections.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "46_sec8.ts",
        "bsiCode": "INF.12",
        "id": "impermissible-network-connection",
        "title": "Impermissible Cable or Network Connection (BSI G 0.23)",
        "description": "In some cases, physical cable connections or network links are established between IT systems or other technical components that are not intended and are impermissible, bypassing security controls.",
        "impact": "Such impermissible connections can allow unauthorized access to data networks, IT systems, information, or applications, bypassing intended security checkpoints like WAFs or API Gateways.",
        "action": "Enforce Architectural Network Segmentation and Access Control",
        "mitigation": "Ensure that high-value assets or backend services are not directly accessible from components that are not designated as trusted intermediaries (e.g., API Gateways, WAFs, Application Servers).",
        "check": "Review network diagrams and firewall/network-policy configurations. Do any communication links bypass established security controls like API Gateways or WAFs to directly access backend databases or services?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.5 Network architecture and design, particularly Requirement A.12 Network segmentation.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Network_architecture_and_design_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified when a communication link directly connects to a sensitive backend asset (like a database, web service, or mainframe) from a source that is not a recognized intermediary or security control (like a WAF, Reverse Proxy, or Gateway).",
        "riskAssessment": "The likelihood of exploitation is higher if the source asset of the impermissible connection is exposed to less trusted zones (e.g., the internet or a client network).",
        "falsePositives": "Legitimate 'back-channel' or administrative connections might be flagged. For example, a batch-processing component might need direct database access, which can be allowed by policy.",
        "cwe": "424",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "46_sec9.ts",
        "bsiCode": "INF.12",
        "id": "crosstalk-on-communication-lines-inf5",
        "title": "Crosstalk on Communication Lines (BSI INF.12 – Leitungsbeeinträchtigungen/Übersprechen)",
        "description": "Electrical signal transmission in communication cables can be negatively influenced by electric and magnetic fields.",
        "impact": "Crosstalk can corrupt or alter data in transit, leading to a loss of Integrity. In severe cases, it can disrupt communication entirely, causing a Denial of Service (Availability).",
        "action": "Use Shielded/Fiber Cabling and Proper Separation",
        "mitigation": "Use high-quality, shielded cabling (e.g., S/FTP Cat. 6a or higher) appropriate for the data rate and environment.",
        "check": "Are communication links using shielded twisted-pair (STP/FTP) or fiber optic cables? Is the cabling category sufficient for the required bandwidth? Are data cables physically separated from power cables and documented in the model via `cabling:shielded` or `cabling:fiber-optic`?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.12 (Verkabelung), esp. 2.9 Leitungsbeeinträchtigungen (Übersprechen) and requirements INF.12.A1, INF.12.A2, INF.12.A9.",
        "cheatSheet": "BSI IT-Grundschutz Kompendium – Baustein INF.12 Verkabelung (Edition 2023)",
        "detectionLogic": "This risk is raised for network communication links that are not process-local and that are not explicitly tagged as using shielded or fiber-optic cabling.",
        "riskAssessment": "The likelihood is considered 'Likely' for copper-based network cabling in typical office or datacenter environments due to cable proximity and EMI sources.",
        "falsePositives": "This risk may be a false positive if appropriate cabling (e.g., fiber optic, shielded copper) is already in use but not documented in the model.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "INF.13": [
      {
        "file": "47_sec1.ts",
        "bsiCode": "INF.13",
        "id": "inf13-unclear-or-missing-requirements",
        "title": "Unclear or Missing TGM Requirements During Planning (BSI INF.13 §2.1)",
        "description": "If stakeholders, user groups, or “demand organizations” are not clearly defined during planning and development, their concrete objectives and needs remain unknown. As a result, the system may be implemented without the necessary operational and security requirements, causing mismatches between what is needed and what is built.",
        "impact": "A system built on unclear requirements can miss business goals and contain security gaps. Missing specifications for roles, data handling, or compliance can lead to weak authorization, logging, validation, and monitoring—affecting Confidentiality, Integrity, and Availability. Consequences include data breaches, misuse, downtime, costs, and possible regulatory penalties.",
        "action": "Identify demand organizations early and document measurable requirements",
        "mitigation": "Identify and involve all relevant stakeholder groups (e.g., building operations, tenants, safety/security, legal/compliance, IT/OT). Elicit and validate functional, non-functional, and security requirements; capture interfaces to TGA/GA systems; and maintain living documentation. Use user stories, abuse/misuse cases, and acceptance criteria. Review and baseline requirements before implementation and for every change.",
        "check": "Are all demand and operating organizations named with contacts? Is there a baselined, accessible, and up-to-date requirements set (including security and operational needs)? Are interfaces and responsibilities documented? Is there a change process for requirements?",
        "asvs": "V1.1: Maintain a security requirements list derived from business needs.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html",
        "detectionLogic": "Raise a finding for entry-point technical assets (internet-facing, web applications, or web services that are not development tooling) that have no incoming communication from an External Entity. The absence of any modeled external actor suggests stakeholder interactions and requirements were not captured or validated for this entry point.",
        "riskAssessment": "Likelihood is high when a primary entry point lacks modeled users/stakeholders. Impact scales with the asset’s CIA ratings: the more critical the asset, the more severe building the wrong behavior becomes.",
        "falsePositives": "Possible if the model is incomplete while the real-world requirements process was thorough, or if the asset is a backend without direct stakeholder interaction. Validate by reviewing planning documents, stakeholder registers, and agreed requirements baselines.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "47_sec2.ts",
        "bsiCode": "INF.13",
        "id": "incomplete-external-service-documentation",
        "title": "Incomplete Documentation for External Services (BSI TGM-style)",
        "description": "In complex systems, many external service providers are involved. If the documentation of responsibilities, contact persons, and Service Level Agreements (SLAs) is incomplete or inaccessible, it can lead to avoidable delays during incidents, such as when a critical system fails.",
        "impact": "Failure to properly document external service details can severely impact availability by delaying incident response. It can also lead to non-compliance with legal or contractual requirements and compromise system integrity if uncertified or vulnerable services are used. In critical infrastructure scenarios, this could even pose a risk to safety.",
        "action": "Establish and Maintain Comprehensive Documentation for Third-Party Services and Certifications.",
        "mitigation": "Maintain a central, accessible repository of all external service providers. For each provider, document emergency contact details, escalation procedures, and agreed-upon SLAs.",
        "check": "Is there a central repository for service provider contracts and SLAs? Are emergency contacts and escalation procedures documented and accessible to the incident response team? Is there a system to track certification validity and renewal dates for all external services?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein ORP.2 (Supplier relationships), which covers requirements for monitoring, controlling, and reviewing services from suppliers.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Supplier_relationships_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organizational risk is triggered for any technical asset of type 'external-entity'. The model cannot verify offline documentation processes.",
        "riskAssessment": "The impact is determined by the highest CIA requirement of the external service itself or any assets it communicates with. If a mission-critical system depends on an external service with poor documentation, the impact of a failure is very high. The likelihood is considered 'likely' by default unless there is explicit confirmation (via tags) that documentation processes are in place.",
        "falsePositives": "This risk can be a false positive if the organization has excellent, well-maintained documentation for all its service providers, but this has not been reflected in the model using the mitigation tags. The risk serves as a prompt to verify these external processes.",
        "cwe": "1059",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "47_sec3.ts",
        "bsiCode": "INF.13",
        "id": "compromise-of-physical-safety-interfaces",
        "title": "Compromise of Interfaces to Cyber-Physical Safety Systems",
        "description": "Technical Building Management (TGM) systems often provide interfaces to areas requiring special protection, such as Safety Instrumented Systems (SIS), security services, or fire alarm systems. If these interfaces are compromised—whether deliberately or unintentionally—it can lead to legal violations and pose a direct danger to life and limb.",
        "impact": "A compromise of these critical interfaces can have severe physical consequences. For example, disabling a fire alarm",
        "action": "Secure Communication Channels to Cyber-Physical Systems",
        "mitigation": "Communication links to cyber-physical systems must be robustly secured. This includes using strongly",
        "check": "Are communication links to assets tagged as '@Category:Cyber-Physical-System' using an encrypted protocol?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.3.2 Building automation and control systems (formerly CON.6).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_3_2_Building_automation_and_control_systems_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies communication links from any standard technical asset to a specialized asset tagged as a",
        "riskAssessment": "The impact of compromising a physical safety system is always considered 'Very High' due to the potential for physical harm to personnel.",
        "falsePositives": "A risk might be flagged if compensating controls exist that are not modeled, such as a physically isolated and secured",
        "cwe": "345",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "47_sec4.ts",
        "bsiCode": "INF.13",
        "id": "inadequate-monitoring-of-critical-systems",
        "title": "Inadequate Monitoring of Critical Systems (BSI INF.13 · OPS.1.1.5)",
        "description": "If critical systems (e.g., Technical Building Automation, TGA) are not adequately monitored, security-relevant events such as malfunctions or attacks may go undetected or be detected too late. Minor issues can escalate into major incidents impacting operations and safety.",
        "impact": "Undetected failures can cause prolonged downtime, physical damage to infrastructure, or even threats to life and limb. This primarily impacts Availability and Integrity. Example: an unnoticed heating failure during sub-zero temperatures can cause severe secondary damage.",
        "action": "Establish comprehensive monitoring and automated alerting for all critical TGA/OT systems",
        "mitigation": "Continuously monitor failures, anomalies, and security events via a central monitoring solution. Implement automated alerting to the on-call/operations team, define thresholds and escalation paths, and regularly test both monitoring coverage and alert delivery.",
        "check": "Are all assets identified as critical systems (e.g., IoT devices, TGA systems) sending monitoring data to a dedicated 'Monitoring' asset in the model? Is there a defined and tested alerting process?",
        "asvs": "BSI IT-Grundschutz / Bausteine INF.13 (TGM) & OPS.1.1.5 (Monitoring und Logging)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Logging_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule flags technical assets that are critical physical/control systems (technology = IoTDevice or explicitly tagged with '@tga') which lack any modeled communication link to an asset of technology 'Monitoring'. Missing such a link indicates a potential monitoring/alerting gap.",
        "riskAssessment": "Likelihood is high when no monitoring connection is modeled. Impact is derived from the asset’s Availability/Integrity ratings: Important → Medium, Critical → High, Mission-Critical → Very High.",
        "falsePositives": "The threat model may be incomplete: a monitoring system and data flows might exist in reality but are not documented. Validate with operations/TGM owners before remediation.",
        "cwe": "755",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "47_sec5.ts",
        "bsiCode": "INF.13",
        "id": "inadequate-dedicated-iam-for-segregated-environment",
        "title": "Weak Dedicated IAM in Segregated TGM Environment",
        "description": "If parts of a building’s technical environment (TGM/TGA/GA) are operated in a segregated zone with a separate Identity & Access Management (IAM), weaknesses in that dedicated IAM (e.g., shared accounts, missing MFA, slow JML handling) can open a single fault path to the entire zone. This aligns with BSI INF.13 (Technisches Gebäudemanagement) and ORP.4 (Identitäts- und Berechtigungsmanagement).",
        "impact": "Compromise of the dedicated IAM enables broad unauthorized access to TGM/TGA assets, endangering confidentiality (e.g., plans/BIM), integrity (control parameters), and availability (building functions: HVAC, alarms). Impacts can cascade to safety-relevant systems and legal obligations.",
        "action": "Harden and govern the dedicated IAM: unique identities only, MFA, automate Joiner–Mover–Leaver, periodic access reviews, and SoD for privileged operations.",
        "mitigation": "Disallow shared/service account reuse; enforce MFA for admins and high-impact operations; implement robust, automated JML workflows with immediate de-provisioning; schedule quarterly access reviews; integrate IAM logs with SIEM; use PAM for privileged access; maintain break-glass accounts with strict controls and monitoring; continuously reconcile identities with sources of truth.",
        "check": "Is a separate IAM used for the segregated TGM boundary? Are unique identities and MFA enforced? Is JML automated with timely revocation? Are periodic (e.g., quarterly) access reviews documented? Are shared accounts technically blocked and PAM enforced for admins? Is emergency access ('break-glass') controlled and logged?",
        "asvs": "OWASP ASVS V2 (Authentication), V4 (Access Control)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
        "detectionLogic": "Detect trust boundaries tagged with '@IAM:dedicated' and look for identity-related technical assets inside (e.g., IdentityProvider, LDAP/LDAPS directories). For each such IAM asset within the tagged boundary, raise one risk. Increase concern where the boundary also hosts high-criticality assets or safety-adjacent integrations; the rule inherently flags because dedicated IAMs demand strong governance and are frequent failure points.",
        "riskAssessment": "Likelihood defaults to 'Likely' due to operational fragility of separate IAMs without automation and periodic reviews. Impact is derived from the highest CIA ratings of assets inside the tagged boundary; safety-adjacent or mission-critical functions elevate impact to 'Very High'. MFA, PAM, automated JML, and audited access reviews can justify downgrading likelihood during expert assessment.",
        "falsePositives": "Lower risk where the dedicated IAM enforces unique accounts and MFA, uses PAM, automates JML with immediate revocation, performs periodic reconciliations and access reviews, integrates with SIEM, and applies SoD. In such mature setups, the finding may be informational.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "INF.14": [
      {
        "file": "48_sec1.ts",
        "bsiCode": "INF.14",
        "id": "inadequate-planning-of-building-automation-inf4-g1",
        "title": "Inadequate Planning of Building Automation (BSI INF.14 – Unzureichende Planung der GA)",
        "description": "Building automation (GA) systems coordinate and control technical building equipment (TGA). According to BSI, deficient planning of these systems, such as inadequate redundancy for central controllers, can lead to failures with significant consequences. The complexity of integrating heterogeneous systems (e.g., HVAC, access control, fire alarms) and multiple service providers exacerbates this risk.",
        "impact": "A failure resulting from poor planning can cause a denial of service to critical building functions, leading to property damage (e.g., from failed climate control), financial loss, disruption of business operations, and even physical harm to individuals (e.g., being trapped by a failed access control system). This directly impacts the availability of the controlled systems and the physical environment.",
        "action": "Ensure Comprehensive and Resilient Planning for Building Automation Systems",
        "mitigation": "The planning of Building Automation (GA) systems must be thorough, involving IT security, facility management, and other stakeholders. A key aspect is implementing redundancy for all critical components to prevent single points of failure. The model should reflect this by setting the 'redundant' flag to true for such assets. The design must also define safe fail-states for all controlled equipment. The network architecture for the GA should be robust and strictly segmented from other corporate IT networks.",
        "check": "Is there a detailed planning and architecture document for the building automation system? Does it include a redundancy concept for critical components (e.g., controllers)? Is the corresponding technical asset in the model marked as 'redundant'?",
        "asvs": "BSI IT-Grundschutz Baustein INF.14: Gebäudeautomation, Gefährdung: Unzureichende Planung der GA.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_4_Gebaeudeautomation_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset identified as a building automation controller (via the `@AssetType:BuildingAutomationController` tag) that is not marked as redundant (`redundant: false`). The absence of planned redundancy for such a central control component is a direct indicator of this risk.",
        "riskAssessment": "The impact is derived directly from the 'availability' rating of the non-redundant building automation asset. A system with 'mission-critical' availability will result in a 'very-high' impact risk. The likelihood is considered 'likely' because a non-redundant system is, by definition, susceptible to failure from a single fault over its operational lifetime.",
        "falsePositives": "A risk might be a false positive if the asset is not critical and its temporary failure is acceptable. This should be reflected by a low availability rating (e.g., 'archive' or 'operational'), which the risk logic already considers to lower the impact. It might also be a false positive if redundancy is achieved through external means not captured in the model.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "48_sec2.ts",
        "bsiCode": "INF.14",
        "id": "improper-subsystem-integration-in-building-automation",
        "title": "Improper Integration of Subsystems in Building Automation (BSI IND.2.2)",
        "description": "If a subsystem (e.g., access control, climate sensor, HVAC unit) is incorrectly or insufficiently integrated into the central building automation system, the functionality of the entire system can be compromised.",
        "impact": "An operational failure in building automation can have direct physical consequences. This includes failures in controlling heating, ventilation, lighting, or physical access systems.",
        "action": "Ensure robust integration, communication protocols, and error handling",
        "mitigation": "Use standardized, robust, and resilient communication protocols (e.g., BACnet/SC, OPC UA) for subsystem integration.",
        "check": "Are the communication protocols between the central controller and its subsystems documented and standardized? Is there monitoring and alerting for communication failures? How does the system behave if a subsystem becomes unavailable? Is data from subsystems validated before being acted upon?",
        "asvs": "BSI IT-Grundschutz Baustein IND.2.2: Gebäudeautomation",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/IND/IND_2_2_Gebaedeautomation_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for technical assets acting as central controllers (e.g., tagged with '@AssetType:BuildingAutomationController' or of technology type 'Gateway' or 'IoT-Device') that communicate with other subsystems.",
        "riskAssessment": "The likelihood of exploitation depends on the resilience of the integration. It is considered higher for proprietary or unauthenticated protocols.",
        "falsePositives": "The model cannot fully assess the resilience or specific error-handling capabilities of the implemented communication logic. A connection might be flagged as risky, but the application layer could have robust checks. This requires a manual review of the system's design and operational monitoring data.",
        "cwe": "755",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "48_sec3.ts",
        "bsiCode": "INF.14",
        "id": "outdated-or-unsupported-components",
        "title": "Use of Outdated or Unsupported Components",
        "description": "Many systems, especially in specialized environments like Building Automation (GA/TGA), use components (hardware or software) that are no longer supported by the manufacturer. This can be due to age, a lack of vendor patches, or inherent design limitations (e.g., insecure protocols due to limited computing resources). These components often have known, unpatched vulnerabilities, representing a significant security risk.",
        "impact": "Exploiting vulnerabilities in unsupported components can lead to a full compromise of the asset. This may result in unauthorized data access, manipulation of system functions (e.g., tampering with building controls), or using the compromised asset as a pivot point for further attacks within the network. This directly threatens the confidentiality, integrity, and availability of the system and the data it handles.",
        "action": "Implement a Vulnerability and Lifecycle Management Process",
        "mitigation": "Maintain a complete inventory of all hardware and software components, including version and support status (i.e., a Software/Hardware Bill of Materials). Proactively monitor for new vulnerabilities in these components. Apply security patches in a timely manner. For components that are End-of-Life (@Maintenance:Unmaintained) or no longer supported, devise a replacement plan. If immediate replacement is not feasible, apply compensating controls such as network segmentation, strict access control, virtual patching with a WAF/IPS, and enhanced monitoring.",
        "check": "Is there a complete inventory of components (SBOM/HBOM)? Is there a vulnerability monitoring and management process? Are End-of-Life components identified and subject to risk management (replacement or compensating controls)?",
        "asvs": "OWASP Top 10 A06:2021 - Vulnerable and Outdated Components",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any technical asset explicitly tagged as `@Unsupported-Component`. It is also raised for assets of type `IoT device` that use unencrypted communication protocols over a network, as this strongly indicates an outdated or insecure design.",
        "riskAssessment": "The likelihood is rated high for any component known to be unsupported, as vulnerabilities are often publicly known and unpatched. The impact is derived from the Confidentiality, Integrity, and Availability ratings of the technical asset and the data it processes or stores. Internet-facing unsupported components present a critical risk.",
        "falsePositives": "An asset might be tagged as unsupported but have effective compensating controls (such as being in a fully air-gapped network) that are not fully reflected in the model, reducing the practical risk.",
        "cwe": "1104",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "48_sec4.ts",
        "bsiCode": "INF.14",
        "id": "misconfiguration-of-building-automation-inf14",
        "title": "Misconfiguration of Building Automation (BSI INF.14)",
        "description": "Building Automation (BA) systems, also referred to as 'Gebäudeautomation' (GA), control critical physical infrastructure such as HVAC, power, fire suppression, and physical access. A misconfiguration in these systems can lead to severe consequences, as they are often complex, interconnected, and may lack proper testing environments before deployment. This risk is exacerbated by faulty updates or update processes that can render a BA system or component unusable.",
        "impact": "Depending on which area of the building automation is misconfigured, it can lead to disruptions in business operations, unauthorized physical access to protected areas, damage to IT systems (e.g., from overheating), and, in severe cases, damage to the building or personal injury.",
        "action": "Implement and enforce secure configuration management for building automation systems.",
        "mitigation": "Define and enforce secure configuration baselines for all BA components, tailored to their specific function. Implement a strict change management and review process for any configuration modifications. Where possible, use dedicated test environments to validate changes and software/firmware updates. Ensure update procedures are reliable and have documented rollback plans. Regularly audit configurations against the defined baselines.",
        "check": "Are there documented secure configuration standards for all building automation systems? Is there a formal change control process in place for these systems? Are logs from BA systems monitored for anomalies or unauthorized changes? Are personnel responsible for configuration adequately trained?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.14 Gebäudeautomation (Building Automation).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_14_Gebaudeautomation_Edition_2023.html",
        "detectionLogic": "Scans for technical assets representing Building Automation components (e.g., assets of technology type 'OT-Device' tagged with `@BuildingSystem:*`). The risk is heightened for systems that are not redundant, involve custom-developed parts, or lack defined coordination with other critical systems (such as power and fire suppression).",
        "riskAssessment": "The impact is directly related to the availability and integrity requirements of the controlled physical process. Any potential for personal injury (e.g., with access control or fire suppression systems) implies the highest impact. The likelihood is increased for complex or custom systems where configuration errors are more probable, especially given the difficulty of full-scale testing mentioned in the BSI source.",
        "falsePositives": "This risk is abstract, as the model cannot verify the actual real-world configuration state. An asset identified by this rule might be perfectly configured and managed. This risk serves as a reminder to audit and verify the configuration management processes for all critical BA systems.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "48_sec5.ts",
        "bsiCode": "INF.14",
        "id": "manipulation-of-ga-tga-interfaces",
        "title": "Manipulation of Interfaces between Building Automation (GA) and Technical Building Equipment (TGA) (BSI G 0.23)",
        "description": "Manipulated interfaces between building automation (GA) systems and coupled technical building equipment (TGA), such as sensors and actuators, can lead to incorrect reactions in the automation system.",
        "impact": "Successful manipulation of these interfaces can directly compromise physical security and safety. This can lead to unauthorized access to facilities, deactivation of security systems (like alarms or cameras), or dangerous manipulation of environmental controls (HVAC, fire suppression).",
        "action": "Implement Secure, Authenticated, and Integrity-Protected Communication",
        "mitigation": "All communication between building automation components (controllers, sensors, actuators) must be protected against tampering. Use cryptographically secure, mutually authenticated protocols like TLS (e.g., HTTPS, MQTTS, WSS) to ensure both confidentiality and integrity of the data in transit.",
        "check": "Are the communication links between physical control systems and their sensors/actuators encrypted (e.g., using TLS)? Is strong mutual authentication enforced between components? Are messages signed or otherwise protected to prevent tampering?",
        "asvs": "BSI IT-Grundschutz INF.14 & APP.5.3: Building Automation / Building Management Systems",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_5_3_Building_management_systems_edition_2022.html",
        "detectionLogic": "This rule detects communication links between GA controllers and TGA endpoints. A risk is raised when a link connects a controller with a sensor or actuator and the protocol is unencrypted or authentication is disabled.",
        "riskAssessment": "The likelihood of exploitation is considered very likely if the communication channel is unprotected, as it allows trivial message injection or modification by an attacker with network access.",
        "falsePositives": "A flagged link may be a false positive if integrity controls are implemented at the application layer (e.g., signed payloads) and are documented outside of the model's protocol metadata.",
        "cwe": "345",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "48_sec6.ts",
        "bsiCode": "INF.14",
        "id": "inadequate-protection-of-building-automation-networks",
        "title": "Inadequate Protection of Building Automation (GA) Networks (BSI INF.14)",
        "description": "Building Automation (GA) systems often consist of numerous interconnected components like IoT devices, sensors, and actuators that communicate over various network protocols (LAN, WLAN, Bluetooth).",
        "impact": "An attacker exploiting an unprotected network access point to a GA system can cause severe damage. This includes Denial-of-Service (DoS) attacks, manipulation or sabotage of physical controls (e.g., HVAC, lighting, access), data exfiltration (e.g., personnel location), and the injection of malware.",
        "action": "Secure Network Access to Building Automation Components",
        "mitigation": "All network communication with GA components must be secured. Enforce strong authentication for all access attempts.",
        "check": "Are all network links to building automation components authenticated and encrypted? Is the GA network properly segmented from other networks?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.14: Gebäudeautomation, e.g., INF.14.A6 (Separierung von Netzen der GA).",
        "cheatSheet": "BSI IT-Grundschutz Baustein INF.14 (Gebäudeautomation).",
        "detectionLogic": "This rule triggers for any technical asset identified as an `IoTDevice` (or tagged as part of a building automation system) that receives data via a communication link under risky conditions.",
        "riskAssessment": "The likelihood is considered 'Very Likely' if an unprotected channel crosses a network boundary into a GA component, as this is a common target for automated scanning and attacks.",
        "falsePositives": "A risk might be flagged as a false positive if compensating controls exist outside the modeled scope, such as physical network isolation that is not represented by a trust boundary in the model.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "48_sec7.ts",
        "bsiCode": "INF.14",
        "id": "insecure-control-elements",
        "title": "Insecure Control Elements (Physical Access)",
        "description": "If easily accessible control elements (e.g., wall-mounted touch panels, gate personnel consoles) are insufficiently secured, they can be used to attack connected systems. This includes exploiting a lack of authentication to operate the device or using unprotected physical ports (like LAN or USB) to gain unauthorized access.",
        "impact": "An attacker can gain unauthorized control over building automation or other systems, potentially opening secure doors, disabling alarms, or manipulating environmental controls. This can lead to physical security breaches, compromise of assets in secured areas, and disruption of operations. It represents a direct threat to the Integrity and Availability of the controlled systems.",
        "action": "Secure Physical Control Elements and their Interfaces",
        "mitigation": "Physically restrict or monitor access to control elements. Enforce strong, mandatory authentication for all operations on the control element. Disable or protect all unused physical ports (USB, LAN, etc.). Ensure that communication from the control element to the system it controls is encrypted and properly authorized.",
        "check": "Are control elements located in physically secure, monitored areas? Does using the control element require authentication (e.g., PIN, card, biometrics)? Are all physical ports on the device secured against unauthorized use? Is the communication from the device to the backend secure?",
        "asvs": "Derived from BSI IT-Grundschutz CON.1: General Building, specifically requirement CON.1.A15 (Protection against unauthorised access), which covers securing access points and control systems within a physical environment.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/con/CON_1_EN.html",
        "detectionLogic": "This rule triggers on technical assets, typically of type 'OT-Device' or 'Client-System', that are tagged as being in a physically unrestricted area (`@PhysicalAccess:Unrestricted`). It then checks for outgoing communication links from this device that lack any form of authentication (`authentication: none`).",
        "riskAssessment": "The likelihood of exploitation is considered Very Likely if a device is physically accessible and its control functions require no authentication. The impact is determined by the criticality (CIA) of the technical asset that the insecure control element communicates with. Controlling a mission-critical system has a higher impact than controlling a non-critical one.",
        "falsePositives": "This risk may be a false positive if other compensating physical controls exist that are not modeled (e.g., constant human supervision, CCTV monitoring). The presence of the `@PhysicalAccess:Unrestricted` tag is an assertion that must be validated against the real-world deployment environment.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "48_sec8.ts",
        "bsiCode": "INF.14",
        "id": "insecure-mobile-interface-on-ba-component",
        "title": "Insecure Mobile Network Interface on Building Automation (BA) / OT Component",
        "description": "Building automation (BA) or OT components are often connected via mobile network interfaces to external manufacturers or service providers.",
        "impact": "Successful exploitation can lead to unauthorized access to the entire building automation network. This allows an attacker to tamper with physical systems (e.g., HVAC, lighting, physical access controls), cause denial-of-service, or exfiltrate sensitive operational data. This compromises the integrity and availability of the controlled environment and can serve as an entry point for further attacks on connected IT systems.",
        "action": "Secure Remote Communication Interfaces",
        "mitigation": "Ensure all communication over mobile or other public networks is strongly encrypted using standard protocols like TLS or is encapsulated in a VPN.",
        "check": "Review the configuration of all BA/OT components with remote-access capabilities. Is the communication protocol encrypted? Is authentication required and is it strong? Is the component located in a properly segmented network? Is the interface active only when necessary?",
        "asvs": "BSI IT-Grundschutz: IND.2.2 Industrielle IT-Komponenten, NET.3.3 Mobilfunknetze; OWASP IoT Top 10: Insecure Network Services, Insecure Communication",
        "cheatSheet": "https://owasp.org/www-project-internet-of-things/",
        "detectionLogic": "This rule checks for technical assets of type 'OT device' that have communication links to the internet or external entities.",
        "riskAssessment": "The likelihood is considered high if the connection lacks both encryption and authentication, as this represents a wide-open door. The impact is determined by the criticality of the OT device itself and, more importantly, the assets it shares a network with, as the primary threat is lateral movement into the GA network.",
        "falsePositives": "A risk might be incorrectly flagged if the mobile communication is secured by an underlying mechanism not explicitly modeled in Threagile, such as a carrier-provided private APN with built-in security, or a hardware-level VPN. The component might also be in a completely isolated, non-critical test network where the risk is acceptable.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "INF.1": [
      {
        "file": "49_sec1.ts",
        "bsiCode": "INF.1",
        "id": "fire-and-smoke-damage-inf5",
        "title": "Fire and Smoke Damage (BSI INF.5)",
        "description": "Buildings, facilities, and IT systems can be severely damaged by fire, and people can be seriously injured or killed.",
        "impact": "A fire can lead to the complete destruction of IT assets and facilities, resulting in a long-term, catastrophic loss of availability and integrity of systems and data.",
        "action": "Implement Comprehensive Fire Prevention and Protection Measures",
        "mitigation": "Implement a multi-layered fire protection strategy including: organizational measures (e.g., fire safety regulations, no-smoking policies),",
        "check": "Are fire detectors and automatic alarm systems installed and regularly tested? Is there an appropriate fire suppression system (e.g., sprinklers, gas-based) for the server room/data center?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Fire Prevention and Protection)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Fire_prevention_and_protection_edition_2023.pdf?__blob=publicationFile&v=2 (BSI INF.5)",
        "detectionLogic": "This is a physical risk that applies to all in-scope technical assets located in on-premise trust boundaries (`type: network-on-prem`) or explicitly modeled as physical machines (`machine: physical`).",
        "riskAssessment": "The likelihood is generally considered 'Unlikely' for modern buildings adhering to fire codes, but is elevated to 'Likely' for mission-critical assets where the impact of even a small fire is unacceptable.",
        "falsePositives": "This risk is generated based on the physical location of an asset as defined in the model. It cannot automatically know the specific fire protection level of the building or room.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "49_sec2.ts",
        "bsiCode": "INF.1",
        "id": "damage-from-lightning-strikes-inf3",
        "title": "Damage to IT Systems from Lightning Strikes (related to BSI INF.3)",
        "description": "During thunderstorms, lightning strikes pose a significant threat to buildings and IT equipment. A strike can reach voltages of several hundred thousand volts and currents up to 200,000 amperes.",
        "impact": "Destruction or damage to physical hardware (servers, network components, etc.) leads to a direct loss of availability for the technical assets running on them.",
        "action": "Implement comprehensive lightning and surge protection",
        "mitigation": "A comprehensive lightning and surge protection concept must be implemented for all physical locations housing IT assets. This includes an external lightning protection system (e.g., lightning rods) to protect against direct strikes and an internal surge protection system (using Surge Protective Devices - SPDs) at various stages of the power distribution system to mitigate induced overvoltages.",
        "check": "Is there a documented lightning and surge protection concept for the physical location? Are assets housed in facilities with appropriate external and internal protection measures? Is there a defined process for regular inspection and maintenance of these systems?",
        "asvs": "BSI IT-Grundschutz Baustein INF.3 Blitz- und Überspannungsschutz (Lightning and Surge Protection)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_3_Blitz_und_Ueberspannungsschutz_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all technical assets running on physical, virtual, or container-based machines located within an on-premises or dedicated hosting trust boundary.",
        "riskAssessment": "The impact is determined by the availability and integrity rating of the affected technical asset. An outage of a mission-critical asset constitutes a very high impact.",
        "falsePositives": "The model might not accurately reflect the physical protections of a specific data center. An asset modeled in an 'on-prem' boundary might reside in a state-of-the-art, highly protected facility. This risk should be verified against the actual physical security measures at the location.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "49_sec3.ts",
        "bsiCode": "INF.1",
        "id": "water-damage-physical-infrastructure",
        "title": "Water Damage to Physical Infrastructure (BSI INF.1 T 0.5)",
        "description": "Water can cause damage to a building and its facilities. The source can be external, such as heavy rain, storm surges, or flooding,",
        "impact": "If physical IT infrastructure is damaged by water, it can lead to a complete loss of availability for the affected technical assets.",
        "action": "Implement Physical and Environmental Protections",
        "mitigation": "Ensure server rooms and data centers are located in areas with a low risk of flooding (e.g., not in basements).",
        "check": "Is the IT equipment located in a building area that is protected from flooding and water leaks? Are environmental sensors like water detectors in place?",
        "asvs": "Not applicable. This is a physical and environmental threat, which is outside the scope of the OWASP Application Security Verification Standard (ASVS).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile (BSI INF.1)",
        "detectionLogic": "This risk is automatically raised for any technical asset explicitly modeled as a 'physical' machine that is located within an 'on-premises' network trust boundary.",
        "riskAssessment": "The impact of this risk is determined by the availability requirements of the affected physical asset and the data it processes or stores.",
        "falsePositives": "This risk can be considered a false positive if the specific location has advanced, proven environmental controls against water damage that are not captured in the threat model.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "49_sec4.ts",
        "bsiCode": "INF.1",
        "id": "elemental-damage-natural-disasters",
        "title": "Elemental Damage and Natural Disasters (BSI INF.1.G4)",
        "description": "Depending on the location, a building is exposed to varying degrees of risk from elemental damage and natural disasters. Causes of natural disasters can include seismic (earthquakes), climatic (floods, landslides, tsunamis), or volcanic phenomena. Extreme weather events like hurricanes or heavy rainfall also pose a significant threat. This risk addresses the potential for physical infrastructure housing IT assets to be damaged or destroyed.",
        "impact": "The primary impact is on the Availability of all technical assets and data housed within the affected physical site. Physical destruction can lead to a total loss of services and business operations. Secondary impacts could include breaches of Confidentiality or Integrity if physical security controls are compromised during or after the event, leading to data loss or exposure.",
        "action": "Assess Site-Specific Environmental Risks and Implement Protective Measures",
        "mitigation": "Conduct a thorough risk assessment for the physical location of any data center or building housing critical assets. This includes checking official maps for floodplains, seismic zones, and historical weather data. Based on the assessment, implement appropriate structural and organizational safeguards, such as sump pumps, reinforced structures, fire suppression systems, and ensuring power/network redundancy. A comprehensive and tested Business Continuity and Disaster Recovery Plan (BCP/DRP) is essential, including geographically separate (off-site) data backups and potentially a h@SystemType:OT/cold secondary operational site.",
        "check": "Has a site-specific risk assessment for natural disasters been performed for all physical locations? Are physical protections in place corresponding to the identified risks? Is there a tested disaster recovery plan that accounts for the loss of the primary site?",
        "asvs": "BSI IT-Grundschutz INF.1: Gebäude (Buildings)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_Building_and_rooms_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any physical trust boundary (types 'network-on-prem' or 'network-dedicated-hoster') that contains technical assets. The risk is suppressed if the trust boundary is tagged with 'disaster-protection-site', indicating that a site assessment has been conducted and appropriate mitigations are in place.",
        "riskAssessment": "The likelihood is highly dependent on the geographical location of the physical site, which is unknown to the model. A general 'likely' is assumed for any un-assessed site. The impact is determined by the highest availability requirement of the assets within the site; if mission-critical assets are present, the impact is very high, as their destruction would lead to catastrophic business consequences.",
        "falsePositives": "This risk may be flagged for a location that has excellent, un-modeled physical protections. The model has no knowledge of specific building codes, flood barriers, or seismic retrofitting. Verification requires knowledge of the physical site's specific safeguards and the existence of a BCP/DRP. Tagging the boundary with 'disaster-protection-site' will mark it as a false positive in the model.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "49_sec5.ts",
        "bsiCode": "INF.1",
        "id": "environmental-hazard-to-building-inf1",
        "title": "Environmental Hazard to Building (BSI INF.1)",
        "description": "Buildings can be damaged by events in their immediate vicinity, such as the leakage of toxic substances.",
        "impact": "This can lead to a partial or total failure of the IT systems housed within the affected building, primarily impacting their **Availability**.",
        "action": "Select a Secure Location and Implement Physical and Organizational Protection Measures",
        "mitigation": "Site selection for data centers or server rooms should consider environmental risks (e.g., flooding, proximity to hazardous industrial sites).",
        "check": "Has the physical location of the data center been assessed for environmental risks? Are there emergency and evacuation plans? Are critical systems replicated in a separate, geographically distinct physical location?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.1 (Building Security)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is automatically generated for each trust boundary of type 'network-on-prem' or 'network-dedicated-hoster', as these represent physical locations susceptible to environmental hazards.",
        "riskAssessment": "The likelihood is location-dependent but is generally considered **Unlikely** for a generic model, as major disasters are not an everyday occurrence for most locations.",
        "falsePositives": "The risk may be a false positive or have a lower severity if the specific location is known to be low-risk (e.g., not in a flood plain, far from industrial hazards) or if extensive physical protections and redundancy plans are already in place, which might not be fully captured in the threat model.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "49_sec6.ts",
        "bsiCode": "INF.1",
        "id": "unauthorized-physical-access",
        "title": "Unauthorized Physical Access to Buildings/Rooms",
        "description": "Unauthorized entry into buildings or rooms enables theft, manipulation, or destruction of information, IT systems, or components.",
        "impact": "Compromises to physical access directly threaten Confidentiality (data theft), Integrity (manipulation of data/systems), and Availability (theft/destruction of hardware) of affected assets and the business processes they support.",
        "action": "Implement and enforce physical access control",
        "mitigation": "Deploy layered physical access controls for all areas containing IT assets: secure doors/locks, electronic access control (e.g., key cards), visitor management, surveillance/monitoring where appropriate, and secured racks or rooms for high-value assets.",
        "check": "Are physical access policies documented, enforced, and audited? Are sensitive areas protected by appropriate barriers (doors/locks) and access control mechanisms? Are access events logged and reviewed?",
        "asvs": "BSI IT-Grundschutz INF.1 Allgemeines Gebäude — insbesondere INF.1.A6 (Geschlossene Fenster und Türen), INF.1.A7 (Zutrittsregelung und -kontrolle), INF.1.A27 (Einbruchschutz).",
        "cheatSheet": "BSI IT-Grundschutz Kompendium — INF.1 Allgemeines Gebäude (Übersicht).",
        "detectionLogic": "Triggered for all in-scope technical assets with machine type 'Physical' that are within organization-controlled trust boundaries (NetworkOnPrem or NetworkDedicatedHoster).",
        "riskAssessment": "Impact is derived from the highest CIA requirement of the physically accessible asset and the data it processes/stores.",
        "falsePositives": "Assets may be flagged even if they are in highly secure areas (e.g., vault, DC cage) when this detail is not present in the model.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "49_sec7.ts",
        "bsiCode": "INF.1",
        "id": "inf1-non-compliance-during-development",
        "title": "Non-Compliance with Safety Requirements During Development (BSI INF.1 Analogy)",
        "description": "When an IT system is built, numerous laws, standards, and internal policies must be observed (e.g., data protection, architectural security, physical/environmental safety). If these regulations are violated during development, this may not be noticed for a long time, but can have catastrophic consequences, for instance, if security controls are not implemented as specified or secure coding practices are ignored.",
        "impact": "Failure to adhere to security requirements and regulations during development can introduce critical vulnerabilities. This can lead to data breaches, system failures, unauthorized access, and non-compliance with legal or contractual obligations (e.g., handling of PII, PCI-DSS), resulting in significant financial loss, reputational damage, and legal penalties.",
        "action": "Establish and Enforce a Secure Software Development Lifecycle (SDLC)",
        "mitigation": "Integrate security into every phase of the development lifecycle. Define clear security requirements, architectural principles, and secure coding standards based on relevant laws and best practices. Use a combination of automated security testing (SAST, DAST, IAST, SCA) within the CI/CD pipeline and manual verification (peer reviews, security walkthroughs, penetration testing) to ensure compliance. Provide ongoing training for developers on secure coding practices and the specific requirements applicable to the project.",
        "check": "Is there a documented Secure SDLC? Are security requirements explicitly defined and tracked? Are automated security scanning tools integrated into the build process? Are there records of security-focused code reviews and penetration tests for custom-developed components?",
        "asvs": "V1: Architecture, Design and Threat Modeling Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Abuse_Case_Cheat_Sheet.html",
        "detectionLogic": "Heuristic used by this rule: (1) The asset must be in scope (outOfScope === false). (2) The asset must contain custom-developed parts (customDevelopedParts === true). (3) Likelihood is increased to VeryLikely if the asset is internet-facing (internet === true), otherwise Likely. (4) Impact is derived from the asset's highest confidentiality, integrity, and availability requirements; assets tagged 'high-value-target' are upgraded to VeryHigh impact. (5) Data breach probability rises when confidentiality >= Restricted and impact >= Medium. This focuses attention on custom code that, if non-compliant, could undermine overall (including building-related) safety requirements per the INF.1 analogy.",
        "riskAssessment": "Likelihood: at least 'Likely' for any custom-developed component and 'VeryLikely' for internet-facing ones. Impact: derived from CIA levels of the asset and the data it handles; 'high-value-target' elevates the impact to VeryHigh. Resulting severity is calculated from likelihood and impact.",
        "falsePositives": "Projects with a mature and enforced Secure SDLC (evidence: requirements traceability, SAST/DAST/IAST/SCA gates, code reviews, pentest reports) may be low risk in practice despite custom development. Treat such cases as acceptable with documented justification.",
        "cwe": "1035",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "49_sec8.ts",
        "bsiCode": "INF.1",
        "id": "inadequate-cable-and-pipe-seals-inf2",
        "title": "Inadequate Cable and Pipe Seals (Brandschotten) (BSI INF.2)",
        "description": "In any building housing IT, numerous cables and pipes for power, data, water, and heating must pass through fire-rated walls and floors.",
        "impact": "Failure to properly seal cable and pipe penetrations can lead to catastrophic fire and smoke damage, resulting in a total loss of availability for affected IT systems.",
        "action": "Implement and Regularly Inspect Certified Fire Protection Seals",
        "mitigation": "Ensure all cable and pipe penetrations through fire-rated barriers are sealed using certified fire-stop systems (Brandschotten).",
        "check": "Are all cable and pipe penetrations through fire-rated walls and floors sealed with appropriate, certified fire stops?",
        "asvs": "This is a physical and environmental control not covered by OWASP ASVS. It directly maps to BSI IT-Grundschutz, Baustein INF.2: Gebäude (Building).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Building_Edition_2023.pdf?__blob=publicationFile (BSI INF.2)",
        "detectionLogic": "This risk is triggered for any on-premise network trust boundary ('network-on-prem') that is not explicitly tagged as having verified fire seals.",
        "riskAssessment": "The likelihood is considered 'likely' due to the high frequency of cabling changes in IT environments, as noted by the BSI.",
        "falsePositives": "This risk can be a false positive if the physical fire seals are actually in place and properly maintained, but the model has not been updated with the 'physical-control-fire-seals-verified' tag on the relevant trust boundary.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "49_sec9.ts",
        "bsiCode": "INF.1",
        "id": "power-outage-bsi-inf4",
        "title": "Power Outage / Loss of Power Supply (BSI INF.4)",
        "description": "In the event of a power failure, entire buildings or parts of them can become unusable. Not only are obvious, direct power consumers such as IT systems or lighting dependent on the power supply, but all infrastructure facilities are also directly or indirectly dependent on electricity. This includes elevators, air conditioning, alarm systems, security locks, automatic doors, and even water pumps. A power outage represents a fundamental threat to the availability of all colocated systems.",
        "impact": "A power outage directly impacts the availability of all dependent IT systems and physical infrastructure. This can lead to a complete standstill of business operations, inability to access physical locations, and failure of safety and security systems, resulting in significant operational and financial losses.",
        "action": "Ensure Redundant Power Supply and Contingency Planning",
        "mitigation": "Mitigate the risk of power outages by implementing uninterruptible power supplies (UPS) for critical systems and emergency power generators for longer outages. For assets located in cloud environments, the provider's SLA regarding power availability and redundancy should be considered sufficient unless modeled otherwise. For on-premises assets, power redundancy measures should be documented and tested. This can be indicated in the model by applying a `@redundant-power`, `@ups-protected`, or `@generator-@Backup:Target` tag to the relevant Technical Asset, its Trust Boundary, or its Shared Runtime.",
        "check": "Are critical on-premises assets and the data centers hosting them protected by UPS and/or emergency generators? Is this protection documented and regularly tested? For cloud-hosted assets, does the cloud provider's SLA meet the availability requirements?",
        "asvs": "BSI IT-Grundschutz Baustein INF.4: Electrical Power Supply",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_4_Electrical_power_supply_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all in-scope technical assets running on physical or virtual machines within on-premises or dedicated hosting provider trust boundaries. The risk is considered mitigated if the asset, its containing trust boundary (or any parent boundary), or its shared runtime is tagged with `@redundant-power`, `@ups-protected`, or `@generator-@Backup:Target`. The risk is not applied to serverless or containerized assets within cloud provider boundaries, as power is assumed to be part of the managed service.",
        "riskAssessment": "The likelihood of a power outage causing a failure is considered 'likely' for non-redundant assets and 'unlikely' for redundant assets (which may still fail if the redundant power source fails). The impact is derived directly from the asset's 'availability' rating. A mission-critical asset failing has a 'very-high' impact.",
        "falsePositives": "This risk can be a false positive if power redundancy measures (UPS, generators) exist but are not documented in the model via the specified tags. It might also be incorrectly raised for assets within a data center that has certified high availability, which is not captured in the model.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "APP.2.1": [
      {
        "file": "4_sec1.ts",
        "bsiCode": "APP.2.1",
        "id": "insecure-directory-service-deployment",
        "title": "Insecure Deployment of Directory Service due to Insufficient Hardening",
        "description": "The security of directory services (like LDAP) heavily relies on the security of the underlying operating system and its file system.",
        "impact": "A poorly configured or hardened directory service can be compromised, leading to unauthorized access, elevation of privilege across the entire network,",
        "action": "Apply OS and Application Hardening for Directory Services",
        "mitigation": "Ensure the operating system hosting the directory service is hardened according to established security baselines (e.g., CIS Benchmarks).",
        "check": "Are the operating system and the directory service application hardened according to a documented baseline? Are file system permissions restrictive?",
        "asvs": "Related to configuration and hardening best practices, similar in principle to CIS Benchmarks for operating systems and directory services. This is an operational and architectural risk rather than a specific application vulnerability.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS_1_3_Linux_und_Unix-Server_Edition_2023.pdf?__blob=publicationFile (BSI IT-Grundschutz SYS.1.3 as an example)",
        "detectionLogic": "This risk is raised for any technical asset of technology type `LDAP-Server` or `Identity-Store-LDAP` that is not explicitly tagged as hardened.",
        "riskAssessment": "The likelihood is considered higher for directory services in complex environments (i.e., with many communication links) where the chance of a configuration error increases.",
        "falsePositives": "This risk may be a false positive if the system is properly hardened in reality, but this fact is not reflected in the model via the `@Hardened:OS-for-Directory-Service` tag.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "4_sec2.ts",
        "bsiCode": "APP.2.1",
        "id": "improper-directory-service-partitioning-and-replication",
        "title": "Improper Directory Service Partitioning and Replication (BSI APP.2.1.A8)",
        "description": "Partitioning allows the directory data of a directory service to be divided into individual areas (partitions),",
        "impact": "Poorly planned partitioning and replication can lead to data loss, data inconsistencies, poor availability of the directory service,",
        "action": "Develop and adhere to a strategic partitioning and replication plan.",
        "mitigation": "A robust plan for partitioning and replication must be created before deployment. This plan should define the partitioning schema,",
        "check": "Is there a documented partitioning and replication strategy for the directory service?",
        "asvs": "BSI IT-Grundschutz APP.2.1 Allgemeiner Verzeichnisdienst, specifically requirement APP.2.1.A8 (Planning of partitioning and replication).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_2_1_Directory_services_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for any technical asset identified as an `LDAP Server` or `Identity Store LDAP`, as these technologies",
        "riskAssessment": "The likelihood is considered `Likely` due to the inherent complexity of managing distributed data stores.",
        "falsePositives": "This risk might be considered a false positive for very simple, single-instance, non-replicated directory services.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "4_sec3.ts",
        "bsiCode": "APP.2.1",
        "id": "incorrectly-administered-access-rights",
        "title": "Incorrectly Administered Access Rights (Least Privilege Violation)",
        "description": "Access rights to IT systems, applications, and stored data must be granted only to the extent necessary for assigned tasks (Principle of Least Privilege). This also applies to permissions for users and groups managed by a directory service. If these rights are administered incorrectly, it can lead to security vulnerabilities when excessive permissions are granted. Incorrect or inconsistent access rights, especially when no authorization is enforced on a data flow, can significantly jeopardize the security of the entire system.",
        "impact": "Failure to enforce the Principle of Least Privilege can allow attackers or malicious insiders to gain unauthorized access to data and functionality. If administrative rights are incorrectly assigned, the entire administrative concept can be subverted, potentially leading to a full system compromise. This directly threatens the Confidentiality, Integrity, and Availability of the system and its data, and can enable further attacks.",
        "action": "Review and Enforce Least Privilege Principle",
        "mitigation": "Implement a fine-grained authorization concept based on roles and responsibilities (RBAC). Regularly review and audit all access rights, especially administrative privileges. Avoid shared technical users with broad permissions where possible; prefer end-user identity propagation for accountability. Communication links to sensitive assets must have a defined and enforced authorization mechanism (e.g., avoid 'none').",
        "check": "Is there a documented authorization concept? Are access rights based on the Principle of Least Privilege? Are permissions, especially for administrators, regularly reviewed? Do communication links to data stores and sensitive components enforce authorization?",
        "asvs": "BSI IT-Grundschutz CON.8: Berechtigungskonzept (Authorization Concept), OWASP ASVS V4.0.3-4.1: Access Control Verification Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is identified when a communication link does not enforce any authorization (i.e., `authorization: none`) when accessing a technical asset. The risk is heightened when the target asset is a data store or another sensitive component (like an identity provider) and handles data with high confidentiality or integrity requirements.",
        "riskAssessment": "Impact is determined by the CIA rating of the target asset. A lack of authorization to a data store with 'Strictly Confidential' data constitutes a 'High' or 'Very High' impact. Likelihood is considered 'Likely' or 'Very Likely' because the lack of an authorization control is a direct, exploitable vulnerability for any party that can reach the asset.",
        "falsePositives": "A finding might be a false positive if the target endpoint is intentionally public and read-only, containing no sensitive information. Additionally, some applications might enforce authorization internally in a way that is not reflected in the model's communication link properties.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "4_sec4.ts",
        "bsiCode": "APP.2.1",
        "id": "bsi-app-2-1-insecure-directory-service-access",
        "title": "Insecure Access to Directory Service (based on BSI APP.2.1)",
        "description": "In many cases, other applications such as internet or intranet applications must access the directory service.",
        "impact": "If an attacker can exploit these misconfigurations, they could gain unauthorized access, elevate privileges, or intercept credentials by sniffing the network.",
        "action": "Secure Directory Service Configuration and Communication",
        "mitigation": "Ensure all communication with the directory service uses an encrypted protocol (e.g., LDAPS, or LDAP with STARTTLS).",
        "check": "Are all communication links to the directory service encrypted? Is authentication required for all access (i.e., no 'none' authentication)? Are anonymous binds disabled?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.2.1 (Allgemeiner Verzeichnisdienst). Relevant OWASP ASVS v4.0.3 requirements include V2.3.1 (secure transport), V4.1.1 (least privilege), and V4.2.1 (centralized access control).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Kompendium_Bausteine/APP_Anwendungen/APP_2_1_Allgemeiner_Verzeichnisdienst_Edition_2023.html",
        "detectionLogic": "This rule checks all assets that function as a directory service (e.g., technology 'ldap-server' or 'identity-store-ldap').",
        "riskAssessment": "The likelihood of exploitation is high for unauthenticated access and for unencrypted communication crossing trust boundaries.",
        "falsePositives": "This risk can be a false positive if the unencrypted/unauthenticated communication is strictly confined within a physically or logically isolated and trusted network segment where sniffing is considered infeasible (e.g., via localhost loopback). However, relying on network controls alone is not a robust defense.",
        "cwe": "522",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "4_sec5.ts",
        "bsiCode": "APP.2.1",
        "id": "technical-failure-of-directory-service-g0.18",
        "title": "Technical Failure of Directory Service (BSI G 0.18)",
        "description": "Technical failure due to hardware or software problems can cause directory services or parts of them to fail.",
        "impact": "The failure of a directory service can disrupt business processes and internal workflows that depend on it for authentication and authorization.",
        "action": "Ensure Redundancy and Implement @Backup:Target/Restore Strategy",
        "mitigation": "Implement the directory service in a redundant, highly-available configuration (e.g., clustered, with multi-master replication).",
        "check": "Is the technical asset representing the directory service configured as redundant in the model (i.e., `redundant: true`)?",
        "asvs": "Derived from BSI IT-Grundschutz Threat G 0.18 (Technical failure of IT components) applied to Baustein APP.2.1 (Directory Services).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_2_1_Directory_services_Edition_2023.pdf?__blob=publicationFile (BSI APP.2.1)",
        "detectionLogic": "This risk is automatically triggered for any technical asset identified as a directory service (e.g., technology is `ldap-server`, `identity-store-ldap`, `identity-store-database`, or `identity-provider`)",
        "riskAssessment": "The likelihood of a technical failure in a non-redundant system over its operational lifetime is considered 'likely'.",
        "falsePositives": "This risk can be a false positive if redundancy is achieved through mechanisms not captured in the model (e.g., underlying hypervisor or storage-level redundancy) and the asset itself is not marked as `redundant`. Manual verification of the architecture is required in such cases.",
        "cwe": "755",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "4_sec6.ts",
        "bsiCode": "APP.2.1",
        "id": "anonymous-access-to-directory-service",
        "title": "Anonymous Access to Directory Service (BSI-Style)",
        "description": "If anonymous users are permitted to access a directory service, its security is significantly at risk.",
        "impact": "Allowing anonymous access facilitates reconnaissance, which can expose sensitive information about the infrastructure and user accounts. It also makes Denial-of-Service (DoS) attacks easier to execute, as attackers have more uncontrolled access points. A full compromise could impact or destroy the entire system reliant on the directory service.",
        "action": "Disable Anonymous Access on Directory Services",
        "mitigation": "Configure all directory services (e.g., LDAP, Active Directory) to reject anonymous binds and queries by default. All access should require strong authentication and authorization. Any exceptions for anonymous access must be documented, risk-assessed, and limited to the absolute minimum required data.",
        "check": "Review the configuration of all directory services. Is anonymous binding disabled? Is there a documented business justification and risk acceptance for any exceptions?",
        "asvs": "V2.1.4: Verify that anonymous binding/access is disabled on the directory server unless it is specifically required for a public-facing resource.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for technical assets identified as directory services (e.g., technology is LDAP Server, Identity Store) that have incoming communication links with authentication set to 'none'. The risk is elevated if the anonymous connection originates from the internet.",
        "riskAssessment": "The likelihood of exploitation is high if an anonymous access path is discovered, especially from an untrusted network like the internet. The impact is determined by the sensitivity of the data within the directory service and the criticality of the systems that depend on it for authentication and authorization. A compromised directory service often leads to a widespread, high-impact breach.",
        "falsePositives": "Can occur if the model incorrectly flags an internal, highly trusted administrative connection as 'none' for authentication when it is otherwise secured (e.g., within a secure execution environment). This is generally rare.",
        "cwe": "306",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "4_sec7.ts",
        "bsiCode": "APP.2.1",
        "id": "misconfigured-directory-service-cleartext-auth",
        "title": "Misconfigured Directory Service (Cleartext Authentication)",
        "description": "Directory services offer extensive functionality, which can lead to misconfigurations if not carefully managed. A common and critical misconfiguration is allowing unencrypted communication. If default settings are not reviewed and hardened, authentication information can be transmitted in cleartext or with insufficient protection, allowing it to be intercepted by an attacker on the network.",
        "impact": "An attacker can eavesdrop on the network to capture credentials (usernames and passwords) sent in cleartext. This leads to unauthorized access to the directory service and potentially to all systems and applications relying on it for authentication, resulting in a widespread compromise.",
        "action": "Enforce Encrypted Communication for Directory Services",
        "mitigation": "All communication with the directory service MUST be encrypted using protocols like LDAPS or STARTTLS. Disable unencrypted LDAP (port 389) access entirely and only permit connections over the encrypted port (636). Ensure that clients are configured to verify the server's certificate to prevent man-in-the-middle attacks.",
        "check": "Review all communication links connected to any 'LDAP Server' or 'Identity Store LDAP' asset. Any link using the 'ldap' protocol is a vulnerability. All links should use 'ldaps'.",
        "asvs": "BSI IT-Grundschutz APP.4.4 Directory services, Requirement APP.4.4.A8 Secure communication with the directory service.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/APP/APP_4_4_Directory_services_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies any 'LDAP Server' or 'Identity Store LDAP' asset that communicates via the unencrypted 'ldap' protocol. It scans all communication links and flags those using 'ldap' where the source or target is a directory service.",
        "riskAssessment": "The likelihood is considered 'Very Likely' as the misconfiguration is actively present in the model. The impact is rated 'High' or 'Very High' depending on the confidentiality of the directory service, as it typically stores credentials for many other systems.",
        "falsePositives": "Can be considered a false positive only if the unencrypted LDAP traffic is strictly contained within a physically or cryptographically isolated network segment (e.g., a dedicated VLAN on a trusted switch, or within a service mesh with mTLS) where sniffing is impossible. This is a rare and high-risk exception.",
        "cwe": "319",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "INF.2": [
      {
        "file": "50_sec1.ts",
        "bsiCode": "INF.2",
        "id": "inadequate-physical-protection-for-on-prem-datacenter",
        "title": "Inadequate Protection of On-Premises Data Center Against Environmental Threats (BSI INF.2)",
        "description": "If a data center or on-premises server location is designed without adequately considering and mitigating fundamental physical and environmental threats, there is a very high risk of service disruption.",
        "impact": "Failure to protect against environmental and physical threats can lead to prolonged downtime of all systems within the affected site.",
        "action": "Perform site risk assessment and implement physical & environmental controls",
        "mitigation": "Conduct a thorough risk assessment for the chosen physical location, considering all plausible environmental threats (e.g., flooding, fire, seismic activity, extreme weather).",
        "check": "Has a formal site risk assessment been performed and documented? Are there protections in place against power failure, fire, and water damage?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium, Baustein INF.2: Rechenzentrum sowie Serverraum (Data Center and Server Room)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_2_Serverraum_sowie_Rechenzentrum_Edition_2023.html",
        "detectionLogic": "Triggers for any trust boundary of type 'network-on-prem' or 'network-dedicated-hoster', as these types of infrastructure are inherently susceptible to physical and environmental threats that require explicit real-world mitigation beyond what can be modeled in software architecture.",
        "riskAssessment": "The impact is determined by the highest availability requirement of any technical asset located within the on-premises trust boundary.",
        "falsePositives": "This risk can be considered a false positive if a comprehensive, documented, and tested business continuity and disaster recovery plan, including all relevant physical and environmental protections, is in place for the specific site. This risk serves as a reminder to verify these external controls, which cannot be represented in the threat model itself.",
        "cwe": "693 // Protection Mechanism Failure",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "50_sec2.ts",
        "bsiCode": "INF.2",
        "id": "inadequate-physical-access-controls",
        "title": "Inadequate Physical Access Controls (BSI INF.2.A6)",
        "description": "If physical access controls to sensitive areas like data centers are missing or insufficient, the risk of unauthorized access increases significantly.",
        "impact": "Insufficient physical access controls directly threaten the Confidentiality (e.g., data theft), Integrity (e.g., server manipulation), and",
        "action": "Implement and Enforce Strict Physical Access Controls",
        "mitigation": "Implement a multi-layered physical access control system for all sensitive areas (e.g., data centers, server rooms).",
        "check": "Is there a documented physical access control policy? Are all entry points to sensitive areas secured? Is access restricted to authorized personnel and logged? Are there procedures for visitors, cleaners, and maintenance staff?",
        "asvs": "BSI IT-Grundschutz INF.2 Data Center, Requirement INF.2.A6 Access Control",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Data_centre_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any trust boundary representing a physical on-premise or dedicated hosting environment",
        "riskAssessment": "The likelihood is considered high if a physical location housing IT assets is not explicitly secured. The impact is determined by the highest",
        "falsePositives": "The model might not fully reflect all physical security measures in place. An area could be physically secure in reality,",
        "cwe": "288",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "50_sec3.ts",
        "bsiCode": "INF.2",
        "id": "insufficient-monitoring-of-infrastructure",
        "title": "Insufficient Monitoring of IT and Infrastructure (aligned with BSI OPS.1.1)",
        "description": "If IT and infrastructure components are insufficiently monitored and managed, components can fail without being noticed.",
        "impact": "Non-detection of component failures or performance degradation directly affects the availability of the impacted systems and dependent business processes.",
        "action": "Implement comprehensive monitoring and alerting",
        "mitigation": "Implement a robust monitoring system for all critical IT components and infrastructure (e.g., servers, network devices, databases, applications).",
        "check": "Is a monitoring solution in place for all non-client, in-scope assets? Are key performance and health indicators tracked for these assets? Are alert thresholds defined and is there a documented incident response process for handling alerts?",
        "asvs": "BSI IT-Grundschutz Baustein OPS.1.1: General IT Operations, Requirement OPS.1.1.A7 (Monitoring of IT components and services)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_IT_operations_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified for any in-scope, non-client technical asset that is not itself a monitoring system and does not have a communication link to a technical asset with technology 'monitoring', 'IDS', or 'IPS'.",
        "riskAssessment": "The impact is derived directly from the availability rating of the unmonitored asset. A 'mission-critical' asset without monitoring poses a 'very-high' impact risk.",
        "falsePositives": "This rule may generate a false positive if monitoring is achieved via an out-of-band management network, an agent-based system, or a cloud-native platform service (like AWS CloudWatch, Azure Monitor) that is not explicitly modeled as a 'monitoring' asset with a corresponding communication link in the diagram.",
        "cwe": "755 // Improper Handling of Exceptional Conditions - as an unmonitored failure is an unhandled exception at the system level.",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "50_sec4.ts",
        "bsiCode": "INF.2",
        "id": "inadequate-operating-environment-inf2.a5",
        "title": "Inadequate Operating Environment (BSI INF.2.A5)",
        "description": "IT components require specific operating conditions to function reliably. They also convert the electrical power they consume into additional heat. If the temperature, humidity, or airborne particulate levels in an IT operating area are not maintained within the limits specified by the equipment manufacturers, it can lead to technical components malfunctioning or failing completely.",
        "impact": "Failure to maintain a suitable physical operating environment can lead to the degradation or complete failure of hardware components. This directly impacts the Availability of the systems and the services they provide, potentially causing business process disruptions, data loss or corruption (Integrity), and significant downtime.",
        "action": "Ensure Proper Environmental Controls for Physical IT Assets",
        "mitigation": "The operating environment for physical IT assets, such as server rooms or data centers, must be equipped with appropriate climate control systems (HVAC) to regulate temperature and humidity. Implement air filtration to reduce dust and other particulates. Environmental conditions should be continuously monitored, with automated alerts configured to notify operations personnel when values exceed predefined thresholds. Regular maintenance of climate control and monitoring systems is essential.",
        "check": "Are physical IT components housed in an environment with climate control? Are temperature and humidity monitored? Are there alerting mechanisms for environmental anomalies? Do the environmental conditions meet manufacturer specifications for the deployed hardware?",
        "asvs": "BSI IT-Grundschutz INF.2 Serverraum (Server Room), Requirement INF.2.A5 Ausreichende Klimatisierung (Sufficient Air Conditioning)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_2_Serverraum_Edition_2023.pdf?__blob=publicationFile (German)",
        "detectionLogic": "This risk is triggered for any in-scope technical asset modeled as a physical machine. The likelihood and impact are elevated for assets with high availability requirements or those located in on-premise trust boundaries, where environmental controls might be less robust than in a dedicated hosting facility.",
        "riskAssessment": "The impact is directly derived from the availability requirement of the physical asset. A mission-critical system failing has a much higher impact than an archive system. The likelihood is considered higher for mission-critical systems and those in on-premise data centers, as any environmental fluctuation is more likely to cause a noticeable and critical incident.",
        "falsePositives": "The model cannot verify the actual quality of the physical environment (e.g., HVAC systems, monitoring). This risk should be considered a standard due-diligence check for all physical infrastructure to ensure that operational environmental security is not overlooked.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "50_sec5.ts",
        "bsiCode": "INF.2",
        "id": "fire-risk-g0.1",
        "title": "Fire (BSI G 0.1)",
        "description": "Fire is a rare but high-impact threat. Fire and smoke can cause severe damage to IT systems, support infrastructure, and buildings.",
        "impact": "A fire can lead to the destruction or severe damage of IT hardware, support infrastructure, and the facility itself. This results in a major loss of Availability for all systems and data hosted in the affected location.",
        "action": "Implement Comprehensive Fire Protection Measures",
        "mitigation": "Install certified fire and smoke detection systems connected to an alarm center. Use automatic fire extinguishing systems appropriate for IT environments (e.g., inert gas).",
        "check": "Are fire detection and suppression systems installed, regularly tested, and certified? Is the building divided into fire compartments? Are staff trained in emergency procedures? Is combustible material stored away from critical IT areas?",
        "asvs": "BSI IT-Grundschutz INF.2.A5 Fire Protection",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Building_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to all technical assets located in physical, on-premise environments, especially data centers. The risk is raised for assets within trust boundaries of type 'network-on-prem' or those tagged with 'location:on-premise-datacenter'. The risk can be mitigated if the asset or its containing trust boundary is tagged with 'fire-protection:adequate'.",
        "riskAssessment": "The likelihood is generally 'Unlikely' but can be elevated to 'Likely' if fire protection measures are explicitly modeled as inadequate (e.g., via the 'fire-protection:inadequate' tag).",
        "falsePositives": "The risk might be a false positive if a 'network-on-prem' trust boundary represents a location with no significant, centralized IT infrastructure (e.g., a small branch office). The model also cannot verify the *actual* effectiveness of declared fire protection measures; it relies on the 'fire-protection:adequate' tag being applied correctly.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "50_sec6.ts",
        "bsiCode": "INF.2",
        "id": "water-damage-inf-1-a5",
        "title": "Water Damage in Data Center (BSI INF.1.A5)",
        "description": "Water can enter a data center through various means, such as leaking water pipes, floods, burst pipes, or defective sprinkler or air-conditioning systems. This ingress of water can physically damage server hardware, storage systems, and network equipment, causing malfunction or complete failure. It can also trigger short circuits, which may lead to power outages for individual racks or entire sections of the data center and, in the worst case, may ignite a fire.",
        "impact": "The primary impact of water damage is a severe loss of availability for all affected systems and the data they process or store. It can also lead to a loss of integrity if storage media are physically damaged. This can halt business operations, result in significant financial loss for repairs and downtime, and potentially cause permanent data loss.",
        "action": "Implement Physical Protection Measures Against Water Damage",
        "mitigation": "Locate data centers and server rooms above ground level and away from areas with a high risk of flooding or sources of water. Install water detectors in critical areas, especially in basements and under raised floors. Ensure proper drainage is in place. Regularly inspect and maintain all plumbing, sprinkler systems, and air conditioning units. Establish emergency procedures for shutting down power in affected areas to prevent short circuits and fires. Ensure that critical equipment is housed in water-resistant racks where feasible.",
        "check": "Is the data center location assessed for water-related risks? Are water detectors installed and monitored? Are there regular maintenance schedules for plumbing and HVAC systems? Are emergency power-off procedures documented and tested?",
        "asvs": "BSI IT-Grundschutz Baustein INF.1: Allgemeines Gebäude, Anforderung INF.1.A5 Schutz vor Wasser und Feuchtigkeit.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_1_Allgemeines_Gebaeude_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to all physical and virtual assets located within an on-premises or a dedicated hosting provider data center. The threat model identifies these as technical assets with a machine type of 'physical' or 'virtual' that are located inside a trust boundary of type 'network-on-prem' or 'network-dedicated-hoster'.",
        "riskAssessment": "The impact is determined by the availability and integrity requirements of the affected assets. An outage of a 'mission-critical' asset constitutes a 'very high' impact. The likelihood is considered 'unlikely' by default but can be adjusted by tagging the corresponding trust boundary with '@water-risk:low', '@water-risk:medium', or '@water-risk:high' to reflect a specific environmental assessment.",
        "falsePositives": "The risk may be flagged for a data center that has extensive physical water protection measures (e.g., advanced water detection and diversion systems) which are not visible in the threat model. The existence of such controls should be verified with the infrastructure and operations teams.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "50_sec7.ts",
        "bsiCode": "INF.2",
        "id": "insufficient-break-in-protection-inf2-a5",
        "title": "Insufficient Protection Against Break-in at Data Center (BSI INF.2.A5)",
        "description": "Even with established access control measures, a data center may still be vulnerable to physical intrusion (break-in) if not sufficiently hardened.",
        "impact": "Attackers with physical access can steal or manipulate IT components, leading to data theft (loss of Confidentiality), data/system manipulation (loss of Integrity),",
        "action": "Enhance Physical Security Measures",
        "mitigation": "Implement robust physical security controls for the data center perimeter. This includes reinforced doors and windows, intrusion detection and alarm systems,",
        "check": "Are there certified physical security measures in place (e.g., resistance classes for doors/windows)? Is there a monitored intrusion detection system?",
        "asvs": "BSI IT-Grundschutz Baustein INF.2: Rechenzentrum baulich-technische Sicherung (Data Center Physical and Technical Security), Requirement INF.2.A5: Schutz vor Einbruch und Diebstahl (Protection against burglary and theft).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Data_Centre_physical_and_technical_security_edition_2023.pdf?__blob=publicationFile&v=2 (BSI INF.2)",
        "detectionLogic": "Triggered when a trust boundary represents a physical data center (type 'NetworkOnPrem' or 'NetworkDedicatedHoster') AND it contains at least one in-scope technical asset.",
        "riskAssessment": "Default likelihood is 'Unlikely' due to the effort and risk for attackers. Impact scales with the highest confidentiality, integrity, and availability requirements",
        "falsePositives": "Considered a false positive if the data center has exceptionally strong, certified physical security (e.g., high-security vault) that is clearly documented in the model.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "50_sec8.ts",
        "bsiCode": "INF.2",
        "id": "power-outage-datacenter-inf2-g0.1",
        "title": "Power Outage at Data Center (BSI INF.2 G 0.1)",
        "description": "If the power fails, the operations of a data center—and thus the institution—can be significantly disrupted.",
        "impact": "A power outage directly compromises the availability of all IT systems and services hosted within the affected data center.",
        "action": "Implement Redundant Power Supply and Emergency Power Systems",
        "mitigation": "Install an Uninterruptible Power Supply (UPS) to bridge short-term outages and allow for a graceful shutdown of systems.",
        "check": "Is there a documented and tested emergency power concept? Does it include both a UPS and a generator? Are maintenance and test logs for these systems available?",
        "asvs": "N/A (ASVS focuses on application-level controls, whereas this is an environmental/infrastructure threat). BSI IT-Grundschutz INF.2 is the relevant standard.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Data_centre_physical_security_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to all technical assets located within a trust boundary that is explicitly identified as a data center (e.g., via an '@Datacenter' tag).",
        "riskAssessment": "The likelihood of a power outage depends on the reliability of the local power grid and is considered 'Likely' for a standard grid without specific protections.",
        "falsePositives": "This risk might be considered a false positive if the model does not accurately represent existing power redundancy measures (e.g., UPS and generators are present but not modeled via tags or other attributes).",
        "cwe": "404",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "50_sec9.ts",
        "bsiCode": "INF.2",
        "id": "contamination-in-datacenter",
        "title": "Contamination in the Data Center (Dust, Dirt)",
        "description": "The BSI notes that dust and other contaminants in a data center can cause technical components (e.g., cooling fans) to fail.",
        "impact": "The failure of physical hardware components due to contamination can lead to service outages, system performance degradation, and, in worst-case scenarios without sufficient redundancy, data loss.",
        "action": "Implement and maintain environmental controls and cleaning schedules",
        "mitigation": "Ensure the data center environment is controlled against dust and other contaminants. This involves implementing professional-grade air filtration systems (e.g., HEPA filters),",
        "check": "Is there a documented policy and procedure for data center cleanliness? Is a regular, professional cleaning and maintenance schedule in place and being followed?",
        "asvs": "ASVS V14.1.1 (Physical Security): Verify that the application's hosting and cloud environments have sufficient physical security controls to prevent unauthorized physical access and tampering.",
        "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Oeffentliche-Verwaltung/Nach-Themen/Infrastruktur/Rechenzentren/RZ-Grundschutz/rz-grundschutz_node.html",
        "detectionLogic": "This risk is raised for any 'physical' machine-type technical assets that are located within a trust boundary representing a data center.",
        "riskAssessment": "The likelihood of failure is considered 'likely' in the absence of stringent environmental controls.",
        "falsePositives": "This risk might be flagged as a false positive if the trust boundary designated as 'network-on-prem' is not a controlled data center environment (e.g., an office space),",
        "cwe": "1355",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "INF.5": [
      {
        "file": "51_sec1.ts",
        "bsiCode": "INF.5",
        "id": "inadequate-physical-security-for-infrastructure-room",
        "title": "Inadequate Physical Security for Infrastructure Room or Cabinet (BSI INF.5)",
        "description": "If a room or cabinet for technical infrastructure is poorly planned, several problems can arise. Water may enter, or IT components may overheat due to solar radiation if the location is unsuitable.",
        "impact": "Inadequate physical protection can compromise Availability (e.g., through power failure, overheating, water damage), Integrity (e.g., through physical damage or tampering),",
        "action": "Ensure Adequate Physical and Environmental Protection for Infrastructure Rooms and Cabinets",
        "mitigation": "Ensure that physical locations housing IT infrastructure (represented as on-premise trust boundaries in the model) are adequately protected against environmental and physical threats.",
        "check": "Is the trust boundary representing a physical room or cabinet for technical infrastructure tagged with `@PhysicalProtection:Reviewed-Adequate`?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5: Room and Cabinet for Technical Infrastructure.",
        "cheatSheet": "See BSI IT-Grundschutz Compendium, Baustein INF.5 (2023 edition).",
        "detectionLogic": "This risk is triggered for any `TrustBoundary` of type `network-on-prem` or `network-dedicated-hoster` that lacks the `@PhysicalProtection:Reviewed-Adequate` tag.",
        "riskAssessment": "The likelihood of physical threats (like unauthorized access, environmental damage) is considered 'Likely' by default for any on-premise or dedicated hoster location where physical security has not been explicitly confirmed via the `@PhysicalProtection:Reviewed-Adequate` tag. The impact is derived from the highest Confidentiality, Integrity, and Availability ratings of all technical assets located within the trust boundary. A breach of a location housing mission-critical assets can result in a 'Very High' impact.",
        "falsePositives": "The boundary might not represent a physical infrastructure room or cabinet, or physical security might be adequate but not yet documented in the model with the specified tag.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "51_sec2.ts",
        "bsiCode": "INF.5",
        "id": "lack-of-physical-access-control-bsi-inf5",
        "title": "Lack of Physical Access Control (BSI INF.5.A3)",
        "description": "If there is no access control or no intrusion protection for rooms with technical infrastructure, or if these measures are too weak, unauthorized persons may be able to gain physical access.",
        "impact": "A successful physical breach can directly compromise Confidentiality (via theft of data-bearing devices), Integrity (via manipulation or replacement of hardware), and",
        "action": "Implement and Enforce Physical Access Control and Intrusion Protection",
        "mitigation": "Ensure that all technical assets of machine type 'physical' are located in secure environments with appropriate physical access controls (e.g., key cards, biometrics, security personnel) and intrusion detection/prevention systems (e.g., alarms, video surveillance).",
        "check": "Are all physical assets located in secure, access-controlled environments? Is access restricted and logged?",
        "asvs": "BSI IT-Grundschutz INF.5.A3 (Zutrittsregelung und -kontrolle / Access Control)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers for any in-scope technical asset with `machine: physical` that is not tagged with `@PhysicalProtection`.",
        "riskAssessment": "The likelihood is considered high if no physical protection is modeled for a physical asset. The impact is derived from the CIA requirements of the physical asset itself and the data it processes or stores.",
        "falsePositives": "The model may not be aware of all physical security controls implemented (e.g., at a cloud provider's data center or a secured on-premise location).",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "51_sec3.ts",
        "bsiCode": "INF.5",
        "id": "inadequate-ventilation-bsi-inf-5-g3",
        "title": "Inadequate Ventilation or Climate Control (BSI INF.5.G3)",
        "description": "If a room housing technical infrastructure is inadequately ventilated or its climate control (HVAC) system fails, the ambient temperature can exceed the operational limits of the installed devices. This can lead to overheating.",
        "impact": "Exceeding the permissible temperature range can cause temporary device failure (outage), reduced performance, shortened lifespan, or permanent hardware damage. This directly impacts the **Availability** of the affected technical assets and the business processes that depend on them.",
        "action": "Ensure Adequate Environmental Controls for Physical Assets",
        "mitigation": "Ensure that rooms housing critical infrastructure have appropriate climate control (HVAC) systems. Implement temperature and humidity monitoring with alerting capabilities to notify operations staff of any anomalies. Ensure regular maintenance of HVAC systems. For critical environments, consider redundant climate control units. For assets in less controlled environments, ensure sufficient passive ventilation and placement away from heat sources.",
        "check": "Is the physical location of the asset equipped with climate control? Is there environmental monitoring (temperature, humidity) in place? Are there alerts for out-of-bounds conditions? Is there a maintenance plan for the HVAC system?",
        "asvs": "Not applicable, as this is a physical environmental risk. The relevant BSI IT-Grundschutz Baustein is INF.5: Room and Cabinet Air Conditioning.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_and_cabinet_air_conditioning_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any in-scope technical asset specified as a 'physical' machine that is not explicitly tagged as being in a controlled environment like '@Environment:DataCenter' or '@Environment:ServerRoom'. The absence of such a tag, or the presence of a tag like '@Environment:Office', implies a higher risk of inadequate climate control.",
        "riskAssessment": "The likelihood is higher for assets in environments not designed as data centers (e.g., office closets, uncontrolled spaces). The impact is directly proportional to the 'Availability' requirement of the asset and the services relying on it. A 'mission-critical' physical server failing has a much higher impact than an archive server.",
        "falsePositives": "A physical machine might be located in a well-ventilated, climate-controlled room even if it's not explicitly tagged as such in the model. The model may lack the necessary environmental details. This risk often highlights a need for more detail in the model's physical deployment description.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "51_sec4.ts",
        "bsiCode": "INF.5",
        "id": "fire-in-technical-infrastructure-room-inf5",
        "title": "Fire in Technical Infrastructure Room or Cabinet (BSI INF.5, Section 2.4 \\",
        "description": "A room or cabinet for technical infrastructure can be severely damaged or completely destroyed by a fire, causing the business processes or specialized tasks that depend on it to fail.",
        "impact": "A fire can lead to the partial or total destruction of technical assets, resulting in extended downtime and failure of dependent business processes. This directly impacts the Availability of systems and the Integrity of data, which may be corrupted or lost. In the worst case, physical destruction can lead to permanent data loss.",
        "action": "Implement Physical Fire Protection Measures",
        "mitigation": "Install professional fire detectors and a fire alarm system connected to a constantly manned office. Use a suitable fire suppression system (e.g., inert gas).",
        "check": "Are there fire/smoke detectors and a fire alarm system in place? Is a suitable fire suppression system installed? Are walls/doors/windows fire- and smoke-resistant? Is smoking prohibited? Are electrical installations regularly inspected? Are brand loads minimized?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Raum sowie Schrank für technische Infrastruktur), esp. Section 2.4 \\",
        "cheatSheet": "https://www.bsi.bund.de/EN/Themen/Unternehmen-und-Organisationen/Informationssicherheit/it-grundschutz/it-grundschutz-kompendium/it-grundschutz-kompendium_node.html",
        "detectionLogic": "Triggered for in-scope technical assets that (a) run on physical machines or (b) reside inside an on-premises trust boundary (e.g., server/infra room).",
        "riskAssessment": "Impact scales with the asset’s Availability/Integrity requirements. Mission-critical assets imply 'Very High' impact.",
        "falsePositives": "A risk may be flagged if physical fire protection measures exist but are not documented via the `@Control:fire-protection-present` tag.",
        "cwe": "730",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "51_sec5.ts",
        "bsiCode": "INF.5",
        "id": "flooding-in-infrastructure-room-con4",
        "title": "Flooding in Infrastructure Room (BSI CON.4 / INF.2)",
        "description": "Flooding within a room for technical infrastructure can cause water damage to the components operated there as well as to the room itself.",
        "impact": "The primary impact is a loss of availability for the technical assets within the affected room due to physical damage, short circuits, or subsequent corrosion.",
        "action": "Implement Physical and Environmental Controls against Water Damage",
        "mitigation": "Infrastructure rooms should be located in areas not prone to flooding (e.g., not in basements in flood zones). Install water detectors connected to an alarm system.",
        "check": "Is the location of the infrastructure room assessed for flood risk? Are water detectors installed? Are water-carrying pipes avoided or secured? Is building maintenance (e.g., roof, drainage) regularly performed?",
        "asvs": "BSI IT-Grundschutz INF.2: Building, Requirement INF.2.A11 Dealing with Water Hazards",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Building_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any physical or virtual technical asset located within a trust boundary that represents a physical infrastructure room.",
        "riskAssessment": "The impact is determined by the highest availability and integrity requirements of the technical assets within the room. A room containing mission-critical systems will have a 'Very High' impact.",
        "falsePositives": "This risk may be a false positive if the 'room' is located in a facility with certified, advanced environmental protections against water damage that are not captured in the model,",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "51_sec6.ts",
        "bsiCode": "INF.5",
        "id": "power-failure-in-infrastructure-room-inf2.g0.1",
        "title": "Power Failure in Infrastructure Room (BSI INF.2 G 0.1)",
        "description": "If the power supply to a room with technical infrastructure fails, multiple electrical components are usually affected.",
        "impact": "A power failure primarily impacts the availability of all systems within the affected physical space, leading to business process interruptions.",
        "action": "Ensure Redundant Power Supply and Environmental Controls",
        "mitigation": "Implement a multi-layered approach to power redundancy. An Uninterruptible Power Supply (UPS) should be used to bridge short-term outages and ensure a clean power supply.",
        "check": "Is there a UPS protecting the assets in the room? Is there a long-term power redundancy solution like a generator? Are environmental controls (e.g., cooling) also on redundant power? Are these systems regularly tested?",
        "asvs": "BSI IT-Grundschutz INF.2 Rechenzentrum sowie Server- und Technikraum (Data Center, Server Room, and Technical Room), Threat G 0.1 Ausfall der Stromversorgung (Power Supply Failure)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_2_Rechenzentrum_sowie_Server_und_Technikraum_Edition_2023.pdf?__blob=publicationFile (German)",
        "detectionLogic": "This risk is raised for any trust boundary representing a physical location (like an on-premise network or dedicated hoster) that contains technical assets but is not explicitly tagged as having power redundancy mitigations (like a UPS or generator).",
        "riskAssessment": "The likelihood of a power outage is considered 'likely' in many regions without specific mitigations. The impact is directly related to the availability requirements of the technical assets within the affected room. If mission-critical assets are present, the impact is very high, as their failure could halt core business functions.",
        "falsePositives": "The model might not accurately reflect the physical reality. A trust boundary could be a logical grouping rather than a single physical room with one power source. Also, mitigations might exist but are not documented with the specified tags in the model.",
        "cwe": "404",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "51_sec7.ts",
        "bsiCode": "INF.5",
        "id": "overvoltage-from-indirect-lightning-inf2",
        "title": "Overvoltage due to Indirect Lightning Strike (BSI INF.2)",
        "description": "In addition to the effects of a direct lightning strike, overvoltage spikes can also occur several hundred meters from the point of impact due to the inductive effect of indirect lightning.",
        "impact": "An overvoltage event can cause malfunctions or the complete failure of physical hardware. This directly compromises the Availability of the affected assets and any services, applications, or data they host or provide.",
        "action": "Implement and Maintain a Multi-Layered Surge Protection Concept",
        "mitigation": "A comprehensive surge protection concept should be implemented. This includes installing appropriate Surge Protection Devices (SPDs) at the building's power entry point (Type 1), at main and sub-distribution boards (Type 2), and close to sensitive terminal equipment (Type 3).",
        "check": "Is there a documented and implemented surge protection concept for all facilities housing physical IT assets? Are appropriate SPDs installed at critical points (building entry, distribution boards, near equipment)?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.2 (Rechenzentrum), Threat G 0.4 (Überspannung), and Requirement INF.2.A21 (Einsatz von Überspannungsschutzeinrichtungen).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/INF/INF_2_Rechenzentrum_Edition_2023.pdf?__blob=publicationFile (German BSI INF.2)",
        "detectionLogic": "This risk is raised for all in-scope technical assets of machine type 'physical' that are not located within a cloud environment (where the provider is assumed to manage this risk).",
        "riskAssessment": "The likelihood is considered 'Likely' for any unprotected physical asset in a susceptible location (i.e., not in the cloud). The likelihood is reduced if basic surge protection is in place and can be considered mitigated with a comprehensive solution.",
        "falsePositives": "This risk may be a false positive if a comprehensive, state-of-the-art surge protection system exists but has not been documented in the model using the `@SurgeProtection` tag.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "51_sec8.ts",
        "bsiCode": "INF.5",
        "id": "electromagnetic-interference",
        "title": "Electromagnetic Interference (EMI)",
        "description": "Electromagnetic fields can be emitted from sources of interference, such as elevator motors, powerful transmission systems, or discharge from lightning protection systems.",
        "impact": "Successful exploitation of this physical vulnerability by an EMI source leads to the malfunction or failure of affected hardware.",
        "action": "Shielding and Physical Protection against EMI",
        "mitigation": "Protect sensitive hardware by using shielded racks, shielded cables (e.g., STP instead of UTP), and ensuring proper electrical grounding.",
        "check": "Review the physical placement of hardware. Are sensitive assets located near potential EMI sources? Are shielded racks, enclosures, and cables in use where necessary?",
        "asvs": "BSI IT-Grundschutz: INF.5 Room for technical infrastructure",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_for_technical_infrastructure_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers for any in-scope technical asset running on physical, virtual, or containerized machines that is tagged with `@EMI-Source-Nearby`.",
        "riskAssessment": "The impact of this risk is determined by the **Availability** rating of the affected technical asset. A higher availability requirement (e.g., 'mission-critical') results in a higher impact.",
        "falsePositives": "This risk is based on the modeler's assessment of the physical environment. A false positive can occur if an asset is tagged but is, in reality, adequately shielded or the EMI source is weaker than assumed. The rule cannot validate the physical effectiveness of countermeasures.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "51_sec9.ts",
        "bsiCode": "INF.5",
        "id": "electrostatic-discharge-damage-inf-5-a8",
        "title": "Electrostatic Discharge (ESD) Damage (BSI INF.5 – Sections 2.9 / A8)",
        "description": "Uncontrolled electrostatic discharges can damage or destroy devices with sensitive electronic components, particularly in rooms or cabinets for technical infrastructure. This can lead to unreliable operation or complete failure of the affected equipment.",
        "impact": "Damage from ESD compromises the **Availability** of physical technical assets. This can disrupt business processes, cause data loss if assets fail during operations, and lead to significant hardware replacement costs.",
        "action": "Implement ESD Protection Measures in Physical Environments",
        "mitigation": "Implement comprehensive ESD protection measures in all areas housing physical hardware. This includes using conductive/anti-static flooring or mats, ensuring proper grounding of equipment racks, controlling ambient humidity, and using anti-static wrist straps and tools when handling sensitive components. All personnel working with physical hardware must be trained in ESD-safe procedures. Components should be stored and transported in anti-static packaging.",
        "check": "Are ESD protection measures (e.g., conductive/anti-static flooring, wrist straps, humidity control) in place in rooms or cabinets housing physical hardware? Is personnel trained in ESD safety? Are these measures regularly audited?",
        "asvs": "BSI IT-Grundschutz Baustein INF.5: Raum sowie Schrank für technische Infrastruktur (Abschnitt 2.9 / Anforderung A8)",
        "cheatSheet": "https://www.bsi.bund.de/",
        "detectionLogic": "This risk is triggered for any 'physical' technical asset located within a trust boundary representing a physical data center or on-premises location. The risk is elevated for non-redundant assets.",
        "riskAssessment": "The impact is directly related to the availability requirement of the physical asset and whether it is redundant. A non-redundant, mission-critical physical server suffering an ESD event has a very high impact. The likelihood is considered 'likely' by default for any physical asset in such an environment to ensure the risk is explicitly addressed, as ESD is an ever-present physical threat.",
        "falsePositives": "This risk can be considered a false positive if the physical location has comprehensive, audited ESD protection measures in place that are accurately reflected in the model. It may also not apply to hardware specifically designed to be resistant to ESD.",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "INF.6": [
      {
        "file": "52_sec1.ts",
        "bsiCode": "INF.6",
        "id": "archive-room-environment-and-access-inf6",
        "title": "Datenträgerarchiv: Environmental & Physical Controls (BSI INF.6)",
        "description": "Datenträgerarchive (archive rooms for media) host physical storage media such as disks in servers/SAN/NAS and @Backup:Target tapes, but may also include non-digital media.",
        "impact": "Compromised environmental or physical controls can corrupt data (integrity), interrupt services (availability), and—through unauthorized access or theft—expose information (confidentiality).",
        "action": "Secure and properly operate the Datenträgerarchiv (media archive room).",
        "mitigation": "Provide and maintain suitable hand fire extinguishers; strictly regulate and control access with adequate mechanical resistance (e.g., DIN EN 1627 RC2–RC3 as appropriate); protect against dust and enforce no-smoking;",
        "check": "Is there a designated archive room with documented access control and mechanical resistance? Are fire extinguishers present and maintained? Are windows closed/doors locked policies enforced?",
        "asvs": "N/A (application security scope). This concerns physical/environmental controls covered by BSI IT-Grundschutz INF.6 and ISO/IEC 27001:2022 (e.g., Annex A.7/A.8).",
        "cheatSheet": "BSI IT-Grundschutz INF.6: Datenträgerarchiv (Kompendium).",
        "detectionLogic": "Approximates INF.6 by flagging non-serverless datastores on physical, virtual, or container machines.",
        "riskAssessment": "Impact is derived from the datastore’s Integrity and Availability ratings; long-term archives raise the minimum impact.",
        "falsePositives": "May be a false positive if the on-premises location is a certified data center or purpose-built archive with documented environmental monitoring, access control, alarm system, sealed windows/doors, and leak detection.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "52_sec2.ts",
        "bsiCode": "INF.6",
        "id": "unlocked-data-archive",
        "title": "Unlocked Data Archive (Physical Security Negligence)",
        "description": "If employees do not close or lock the doors and windows of a data carrier archive after leaving, physical data media or other information can be stolen or accessed without authorization.",
        "impact": "Theft of or unauthorized access to physical data media can lead to a direct compromise of sensitive information, violating its Confidentiality and Integrity.",
        "action": "Enforce and Audit Physical Access Control Procedures",
        "mitigation": "Implement strict physical access controls for the data archive, including logged access, secure locks on all entry points (doors, windows), and potentially surveillance systems.",
        "check": "Are there formal procedures for securing the data archive? Are doors and windows equipped with appropriate, functioning locks? Is physical access logged and restricted to authorized personnel? Are employees trained on these procedures? Are regular physical security audits performed?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.6 (Data Carrier Archive), specifically Requirements INF.6.A2 (Access control and monitoring) and INF.6.A4 (Closed windows and locked doors).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Data-carrier_archive_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any 'datastore' asset that is hosted on a 'physical' machine and is explicitly tagged as a physical archive (@Archive:Physical).",
        "riskAssessment": "The likelihood is considered 'likely' due to the high potential for human error in manual security procedures.",
        "falsePositives": "This risk might be a false positive if the model does not capture compensating controls, such as automated locking systems, 24/7 on-site security personnel, or if the archive is located within another highly secured physical zone (which should be modeled as a nested trust boundary).",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "52_sec3.ts",
        "bsiCode": "INF.6",
        "id": "insufficient-physical-access-control",
        "title": "Insufficient Physical Access Control",
        "description": "If physical access controls to a data carrier archive or data center are missing or insufficient, unauthorized persons can enter the premises.",
        "impact": "Unauthorized physical access can lead to theft of hardware, data media, or sensitive documents. It can also result in tampering with systems and data, or the installation of malicious hardware/software.",
        "action": "Implement and Enforce Physical Access Controls",
        "mitigation": "Implement a layered physical security strategy for all locations housing critical assets. This includes locked doors, access control systems (e.g., key cards, biometrics), visitor logging, security personnel, and surveillance systems.",
        "check": "Are all data centers, server rooms, and data archives protected by effective physical access controls? Is access restricted to authorized personnel only? Is there a process for managing and auditing physical access?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Physical and environmental security), Requirement CON.3.A2 (Securing offices, rooms, and facilities) and CON.3.A10 (Access control).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Physical_and_environmental_security_edition_2023.pdf?__blob=publicationFile (BSI CON.3)",
        "detectionLogic": "This risk is triggered for any in-scope, physical (non-virtual/container/serverless) technical assets of type 'datastore' (or similar technologies like file servers and mainframes) that are not explicitly marked as having physical access controls.",
        "riskAssessment": "The likelihood of an attempt is considered 'likely' for any unprotected physical asset, as insider threats or determined external attackers are always a possibility.",
        "falsePositives": "This risk may be a false positive if robust physical controls exist but have not been documented in the model via the 'mitigation:physical-access-control' tag.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "INF.7": [
      {
        "file": "53_sec1.ts",
        "bsiCode": "INF.7",
        "id": "inadequate-physical-access-control-inf2.a5",
        "title": "Inadequate Physical Access Control (BSI INF.2.A5)",
        "description": "If physical access controls are missing or insufficient, unauthorized persons can enter an office space or data center and steal sensitive data, steal devices, or tamper with them. This can compromise the Availability, Confidentiality, or Integrity of devices and information. Even if no immediate damage is apparent, business operations can be disrupted, for example, by the need to investigate how such an incident was possible and whether any damage or tampering occurred.",
        "impact": "Failure to implement adequate physical access controls can lead to theft or manipulation of hardware and data, directly impacting the Confidentiality, Integrity, and Availability of the system. This can result in service disruptions, data breaches, and significant investigative overhead.",
        "action": "Implement and Enforce Physical Access Controls",
        "mitigation": "Ensure that all physical locations housing IT assets (e.g., data centers, server rooms, offices with workstations) have adequate access controls. This includes locked doors, electronic access control systems (e.g., key cards), reception staff, and a documented visitor policy. Access rights should follow the principle of least privilege. The effectiveness of these controls should be regularly reviewed. Tag the on-premises trust boundary or the specific physical asset with 'physical-security:adequate-access-control' to document that this has been implemented.",
        "check": "Are all access points to areas containing physical IT assets secured? Is there a documented visitor and access-control policy? Are access logs maintained and reviewed?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.2: Building and area management, Requirement INF.2.A5 (Access control for areas).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Building_and_area_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any in-scope technical assets of the machine type 'physical' that are located within a trust boundary of type 'network-on-prem'. The risk can be mitigated by applying the 'physical-security:adequate-access-control' tag to either the asset itself or its containing on-premises trust boundary.",
        "riskAssessment": "The likelihood of an unauthorized access attempt is considered 'likely' if basic physical controls are missing for on-premise assets. The impact is determined by the highest CIA requirement of the physical asset and the data it processes or stores. An asset processing 'Strictly Confidential' data or being 'Mission-Critical' for operations will result in a very high impact.",
        "falsePositives": "This risk may be a false positive if physical access controls exist but are not documented in the model via the specified tag. Verification requires a physical inspection or review of the organization's physical security policies.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "53_sec2.ts",
        "bsiCode": "INF.7",
        "id": "unfavorable-work-environment-inf5",
        "title": "Unfavorable Work Environment (BSI INF.7)",
        "description": "A non-ergonomic office space or an unfavorable work environment can prevent employees from working without distractions or from using the provided IT optimally.",
        "impact": "Failure to maintain a suitable work environment can lead to human error, resulting in the corruption of data (Integrity) or systems being used incorrectly (Availability).",
        "action": "Ensure Ergonomic and Distraction-Free Work Environment",
        "mitigation": "Workspaces for personnel should be designed to be ergonomic and minimize environmental distractions like noise, high traffic, and poor lighting/ventilation.",
        "check": "Are workspaces designed to minimize distractions from noise and traffic? Is there adequate and appropriate lighting and ventilation for IT use?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.7: Büroarbeitsplatz (Office Workspace)",
        "cheatSheet": "BSI IT-Grundschutz Baustein INF.7: Büroarbeitsplatz (overview)",
        "detectionLogic": "This is a physical/organizational risk. It is raised for technical assets that are likely used by humans in an on-premises office environment.",
        "riskAssessment": "The likelihood is rated as 'Likely' because poor ergonomics or distractions are common issues in many work environments.",
        "falsePositives": "This risk is highly dependent on the actual physical conditions of the workspace, which cannot be determined from the model alone.",
        "cwe": "20",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "53_sec3.ts",
        "bsiCode": "INF.7",
        "id": "uncontrolled-physical-access-by-visitors",
        "title": "Uncontrolled Physical Access by Visitors or External Personnel (BSI INF.2)",
        "description": "In office environments, visitors, cleaning staff, or other external personnel might gain uncontrolled access to internal areas.",
        "impact": "If uncontrolled physical access occurs, it can lead to the compromise of confidentiality (information disclosure), integrity (data or system manipulation), and availability (theft, damage, DoS) of assets located within the physical premises. This can result in data breaches, business process disruption, and financial loss.",
        "action": "Implement and Enforce a Visitor and External Personnel Management Policy",
        "mitigation": "Establish clear rules for all non-employees entering the premises. This includes maintaining a visitor log, enforcing an escort policy for all visitors in sensitive areas, and providing identification badges.",
        "check": "Is there a formal policy for managing visitors and external personnel? Are visitors required to sign in and be escorted? Are employees trained on clean desk and screen-locking policies? Are regular checks performed to ensure compliance?",
        "asvs": "BSI IT-Grundschutz INF.2.A12 (Regulation of the presence of external persons)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Rooms_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for all technical assets located within a trust boundary of type 'Network On-Premise'.",
        "riskAssessment": "The likelihood is considered 'Likely' by default, assuming that without specific physical controls (which cannot be modeled), an incident is probable over time.",
        "falsePositives": "This risk is procedural and environmental. An organization might have excellent physical security controls (e.g., locked server rooms, strict escort policies) that are not visible in the threat model.",
        "cwe": "284 // Improper Access Control",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "53_sec4.ts",
        "bsiCode": "INF.7",
        "id": "physical-manipulation-or-destruction",
        "title": "Physical Manipulation or Destruction of IT Systems and Data Carriers (BSI INF.2)",
        "description": "Attackers may attempt to manipulate or destroy IT systems, accessories, and other data carriers for various reasons. The effectiveness of such attacks increases with delayed detection, the perpetrator's level of knowledge, and the severity of the impact on work processes.",
        "impact": "Consequences can include unauthorized access to sensitive data (e.g., via stolen hard drives), destruction of data carriers or entire IT systems, and significant operational downtime and process limitations.",
        "action": "Implement Physical and Environmental Security Controls",
        "mitigation": "Protect IT systems and data carriers through physical access controls (e.g., locked rooms, racks), environmental controls (e.g., fire suppression), surveillance, and secure disposal procedures for media. Ensure that hardware and software integrity is monitored. Implement and regularly test backup and recovery strategies to restore service after destruction or manipulation.",
        "check": "Are sensitive IT systems and data carriers located in physically secured areas with controlled access? Are there procedures for secure hardware lifecycle management, including disposal? Are regular, tested backups available for all critical systems?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.2 (Physical and Environmental Security), specifically addressing threats like T 0.14 'Destruction of devices or data media' and T 0.17 'Manipulation of hardware or software'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_2_Physical_and_environmental_security_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all in-scope technical assets that are not serverless (i.e., of machine type 'physical' or 'virtual'). These assets have a physical component that is susceptible to manipulation or destruction. The likelihood is considered higher for 'physical' machines than for 'virtual' ones, as the latter have an additional layer of abstraction (the hypervisor host) protecting them.",
        "riskAssessment": "The likelihood is higher for directly accessible physical machines. The impact is directly derived from the Availability, Integrity, and Confidentiality ratings of the technical asset and the data it stores or processes. A mission-critical system being destroyed has a 'very-high' impact.",
        "falsePositives": "This risk is generated based on the logical machine type. It cannot account for the actual physical security measures implemented in the deployment environment (e.g., a highly-secured data center). Therefore, the risk must be validated against the real-world security posture.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "53_sec5.ts",
        "bsiCode": "INF.7",
        "id": "theft-of-it-equipment-inf5",
        "title": "Theft of IT Equipment (BSI INF.5)",
        "description": "As IT devices become more portable, it is easier to steal them. The theft of data carriers, IT systems, or accessories incurs costs for replacement and restoration of operational capacity.",
        "impact": "The primary impact of theft is the potential for a severe confidentiality breach if the data on the device is unencrypted.",
        "action": "Implement Physical Security Controls and Enforce Data-at-Rest Encryption",
        "mitigation": "Physically secure all IT equipment, especially portable devices like laptops and mobile phones (e.g., using cable locks, locked cabinets).",
        "check": "Are all IT assets, especially portable ones, physically secured when unattended? Are server rooms and sensitive areas access-controlled?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.5 (Protection against unauthorized access) and Threat G 0.14 (Theft of equipment, storage media, or documents).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Protection_against_unauthorized_access_edition_2023.pdf?__blob=publicationFile (BSI INF.5)",
        "detectionLogic": "This rule checks for technical assets that are physical or client-type devices (like laptops, mobile devices) and lack data-at-rest encryption.",
        "riskAssessment": "The impact of this risk is directly related to the confidentiality and availability requirements of the data stored on the stolen device.",
        "falsePositives": "The model might not capture all physical security controls. An asset might be flagged as at risk, but in reality, it could be located in a highly secure, access-controlled environment, reducing the likelihood of theft.",
        "cwe": "311",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "53_sec6.ts",
        "bsiCode": "INF.7",
        "id": "improper-cabling-inf7",
        "title": "Improper Cabling / Tripping Hazard (BSI INF.7)",
        "description": "Cables for power and data networks might be laid across rooms and walkways, especially if outlets are inconveniently located.",
        "impact": "If this risk materializes, IT equipment can be physically damaged, leading to a loss of Availability.",
        "action": "Implement proper cable management for office workspaces",
        "mitigation": "Ensure that all power and data cables are managed properly. Use cable ducts, conduits, or cable bridges to protect cables running across floors.",
        "check": "Are there any cables running across walkways in areas with physical IT assets? Are cable management solutions like ducts, bridges, or trays in use?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.7 (Büroarbeitsplatz), specifically requirement INF.7.A3 (Fliegende Verkabelung),",
        "cheatSheet": "BSI IT-Grundschutz Baustein INF.7 (Büroarbeitsplatz), insbesondere INF.7.A3 (Fliegende Verkabelung).",
        "detectionLogic": "This is a physical risk that applies to on-premises environments. The rule triggers for any technical asset that is explicitly modeled as a 'physical' machine",
        "riskAssessment": "The likelihood is considered 'likely' for any identified physical asset in an on-premises environment, as improper cabling is a common oversight.",
        "falsePositives": "This risk might be a false positive if the 'physical' asset is located in a professional data center with raised floors and proper under-floor cabling,",
        "cwe": "404",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "INF.8": [
      {
        "file": "54_sec1.ts",
        "bsiCode": "INF.8",
        "id": "insufficient-telework-regulations",
        "title": "Insufficient Regulations for Home Office / Teleworking (BSI INF.8)",
        "description": "Since a home office is located outside the organization's direct physical and network boundaries, employees are largely on their own.",
        "impact": "Failure to establish and enforce clear teleworking security policies can compromise the Confidentiality, Integrity, and Availability of information.",
        "action": "Establish and Enforce Clear Home-Office / Telework Security Policies",
        "mitigation": "Develop, document, and enforce a comprehensive security policy for all teleworking personnel. This policy should cover: secure remote access (e.g., mandatory VPN), handling and storage of physical and digital sensitive data at home, physical security of the workspace (lockable room/containers), use of private vs. company-provided devices, secure transfer/transport and disposal of documents and media, and defined procedures for IT support and incident response.",
        "check": "Is there a formal, documented security policy for home offices? Do employees receive training on this policy? Are procedures for remote support, secure transport and disposal of information, and incident response clearly defined and reviewed when household conditions change?",
        "asvs": "BSI IT-Grundschutz INF.8: Häuslicher Arbeitsplatz",
        "cheatSheet": "BSI Grundschutz-Kompendium – Baustein INF.8 „Häuslicher Arbeitsplatz“",
        "detectionLogic": "This risk is triggered for any technical asset that represents a client system (e.g., Desktop, Mobile App, Browser) that is internet-facing and communicates across a trust boundary with internal, non-internet-facing assets.",
        "riskAssessment": "The likelihood of exploitation is considered 'Likely' if teleworking setups exist without modeled mitigations (like specific policies being confirmed). The impact is determined by the highest sensitivity (CIA) of the data assets accessed by the teleworking client. Accessing 'Strictly Confidential' data from a home office poses a 'High' or 'Very High' impact.",
        "falsePositives": "This risk may be a false positive if the organization has strong, enforced teleworking policies that are not reflected in the threat model. The model identifies the technical potential for the risk; its actual existence depends on organizational controls.",
        "cwe": "668",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "54_sec2.ts",
        "bsiCode": "INF.8",
        "id": "unauthorized-physical-access-home-office-con.3.a15",
        "title": "Unauthorized Physical Access to Home Office (BSI CON.3.A15)",
        "description": "Rooms in a home office where sensitive information is stored/processed or sensitive equipment is kept become areas requiring protection.",
        "impact": "Unauthorized physical access can lead to theft of equipment, direct access to unlocked sessions, shoulder surfing, or installation of malicious hardware/software,",
        "action": "Implement and Enforce Physical Security Measures for Home Office Environments",
        "mitigation": "Define and enforce physical security policies for home offices. This includes secure storage for devices and documents (e.g., locked cabinets),",
        "check": "Are there defined policies for physical security in home offices? Are employees trained on these policies? Are technical measures like full-disk encryption and automatic screen locks enforced on assets used for teleworking?",
        "asvs": "BSI IT-Grundschutz Baustein CON.3 (Physical environmental security), Requirement CON.3.A15 (Physical access to teleworking and mobile working areas). This is a physical security risk and not directly covered by OWASP ASVS.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Physical_environmental_security_edition_2023.pdf?__blob=publicationFile (BSI CON.3)",
        "detectionLogic": "This risk is triggered for any in-scope technical asset that is explicitly tagged with `@Location:HomeOffice` and processes or stores data of at least `Restricted` confidentiality or `Important` integrity/availability.",
        "riskAssessment": "The likelihood is considered `Likely` due to the inherently less controlled nature of a home environment compared to a corporate office.",
        "falsePositives": "This risk can be considered a false positive only if the asset tagged with `@Location:HomeOffice` is used in a dedicated, professionally secured, and lockable room with controls that mirror a corporate environment. This status requires explicit justification and evidence.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "54_sec3.ts",
        "bsiCode": "INF.8",
        "id": "unsuitable-telework-environment-con3.g1",
        "title": "Unsuitable Telework Environment (BSI CON.3.G1)",
        "description": "A non-ergonomic or disruptive home office environment (e.g., due to noise, interruptions from family members, poor lighting, or poor ventilation) can prevent undisturbed work, hinder the optimal use of IT equipment, introduce errors, and reduce the protection of data. Confidentiality can also be at risk due to shoulder surfing or overheard conversations in non-private spaces.",
        "impact": "This can lead to reduced productivity, increased human error, and compromised data integrity as employees make mistakes or fail to follow security procedures correctly. Confidentiality can also be compromised, leading to data breaches, non-compliance with legal or contractual requirements, and subsequent financial or reputational damage.",
        "action": "Establish and Enforce Telework Security Policies",
        "mitigation": "Define and enforce clear policies for telework environments, including requirements for a private, distraction-free workspace, especially when sensitive data is handled. Provide ergonomic guidelines and security best practices for home offices (e.g., use of privacy screens, secure document storage, rules for smart home devices). Raise employee awareness about the risks of working in public or shared spaces. Provide necessary equipment like privacy screens or noise-cancelling headsets where appropriate.",
        "check": "Are there clear, communicated policies for teleworking? Do these policies address environmental security (privacy, distractions)? Are employees trained on these policies? Is there a process to assess or attest to the suitability of telework environments for handling sensitive information?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Telework), Gefährdung CON.3.G1 (Unsuitable conditions at the teleworkplace).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Telework_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This environmental risk is difficult to detect automatically. This rule triggers for any in-scope client-type assets (e.g., Browser, Desktop, Mobile App) that are used by humans, or any asset explicitly tagged as a '@telework-client'. The assumption is that these assets are used in a home office or remote setting which may not meet organizational security standards.",
        "riskAssessment": "The likelihood is rated as 'Likely' by default, assuming a baseline risk for any remote work. The impact scales with the Confidentiality and Integrity of the data processed by the teleworking user on the affected asset. An error made on a system processing 'Strictly-Confidential' or 'Mission-Critical' data has a very high impact.",
        "falsePositives": "This risk is environmental and depends on an individual's actual home office setup. The model can only flag assets used for telework as potentially being at risk. The actual risk level can only be confirmed by assessing the individual teleworkplaces or through organizational policies and employee attestations.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "54_sec4.ts",
        "bsiCode": "INF.8",
        "id": "insecure-data-transport-to-home-office-con3",
        "title": "Insecure Data Transport to Mobile/Home Office (BSI CON.3)",
        "description": "When documents, data carriers, or files are transported between the institution and a mobile or home office, this data and information can be lost.",
        "impact": "The loss of unique data originals without a backup can disrupt business processes (Availability). If unencrypted data carriers fall into the wrong hands, it can lead to a severe loss of Confidentiality.",
        "action": "Secure Physical Transport and Storage of Data on Mobile Assets",
        "mitigation": "Ensure all mobile assets (laptops, mobile devices) used for work have full-disk encryption enabled.",
        "check": "Is there a defined policy for mobile work and data transport? Are mobile assets like laptops required to have full-disk encryption enabled?",
        "asvs": "BSI IT-Grundschutz CON.3 Mobile Workplace & CON.4 Data Media Management",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_workplace_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for technical assets typical of mobile or remote work (e.g., 'Desktop', 'MobileApp', 'ClientSystem') that process or store data.",
        "riskAssessment": "The impact of this risk is directly related to the confidentiality, integrity, and availability requirements of the data stored on the mobile asset.",
        "falsePositives": "The model might identify a 'Desktop' asset as mobile, when in fact it is permanently located within a secure corporate facility.",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "54_sec5.ts",
        "bsiCode": "INF.8",
        "id": "improper-disposal-of-media-at-home-office",
        "title": "Improper Disposal of Media at Home Office (based on BSI)",
        "description": "If it is not possible to dispose of data carriers and documents appropriately in the home office,",
        "impact": "Improper disposal of media containing sensitive information can lead to severe breaches of confidentiality and integrity.",
        "action": "Establish and Enforce Secure Media Disposal Procedures for Remote Work",
        "mitigation": "Implement a clear policy for the secure disposal of all media (paper documents, USB drives, hard drives, CDs/DVDs, etc.)",
        "check": "Is there a documented policy for media disposal at home offices? Are employees provided with the necessary tools (e.g., shredders)?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 'Löschen und Vernichten' (Deletion and Destruction).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Deletion_and_destruction_of_data_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.6)",
        "detectionLogic": "This risk is identified for technical assets tagged as being used in a home office environment (e.g., via an `@Location:HomeOffice` tag),",
        "riskAssessment": "The likelihood is high if no formal disposal procedures for remote work exist. The impact is directly related to the",
        "falsePositives": "This risk might be a false positive if the organization has strong, enforced remote work policies for media disposal that are not",
        "cwe": "459",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "54_sec6.ts",
        "bsiCode": "INF.8",
        "id": "physical-tampering-or-destruction-at-home-office",
        "title": "Physical Tampering or Destruction at a Home Office",
        "description": "IT devices, accessories, information, and software used at a home office may be more easily manipulated or destroyed than within the institution's premises.",
        "impact": "If IT devices, accessories, information, or software are manipulated or destroyed, employees at the home office may have their ability to work significantly restricted (Availability).",
        "action": "Implement and Enforce Physical Security Policies for Home Office Environments",
        "mitigation": "Establish clear and enforceable security policies for home offices. This should include guidelines for the secure storage of devices and documents when not in use (e.g., in lockable cabinets), mandatory screen locking, and awareness about shoulder surfing.",
        "check": "Are there defined policies for physical security at home offices? Are employees trained on these policies? Is full disk encryption enabled and enforced on all mobile and home-office devices?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3: Mobile device usage. While not a perfect one-to-one match, the principles of securing devices outside a controlled corporate environment are highly relevant.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_device_usage_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to any technical asset that is used in a less controlled physical environment, such as a home office.",
        "riskAssessment": "The likelihood is considered 'Likely' due to the inherently reduced physical controls in a home environment compared to a corporate office.",
        "falsePositives": "This risk is generated based on the declared location of the asset. It cannot assess the actual physical security measures implemented by an individual employee in their specific home office.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "54_sec7.ts",
        "bsiCode": "INF.8",
        "id": "physical-theft-of-it-from-home-office",
        "title": "Physical theft of unencrypted IT equipment in the home office (BSI context)",
        "description": "Home-office environments are typically less physically secure than corporate offices, which often have measures such as access control systems and guards. This increases the risk of burglary and theft of company-issued IT equipment.",
        "impact": "Theft of an unencrypted device can directly compromise confidentiality and availability. Attackers could access sensitive corporate or customer data, trade secrets, and personal information. This information might be sold to competitors, used for extortion, or publicly leaked, resulting in significant financial losses, reputational damage, and legal or regulatory penalties.",
        "action": "Enable full-disk encryption and strong authentication on all devices used in the home office",
        "mitigation": "All IT equipment used outside secured corporate premises, especially in home offices, MUST be protected by full-disk encryption (e.g., BitLocker, FileVault).",
        "check": "Is the technical asset protected with full-disk encryption? Is strong authentication enforced? Is there a documented procedure and a technical capability to remotely wipe a stolen device?",
        "asvs": "BSI IT-Grundschutz Compendium reference: CON.1 Mobile device management; CON.3 Cryptographic methods. This scenario reflects common risks associated with teleworking described in BSI publications.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Mobile_device_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies client systems (laptops, desktops) used in a home-office environment (tagged '@Location:HomeOffice') that lack data-at-rest encryption. The absence of encryption on a portable, physically exposed device is a critical vulnerability.",
        "riskAssessment": "While targeted theft is hard to model, opportunistic theft is always possible. The likelihood is therefore considered 'Likely'.",
        "falsePositives": "This may be a false positive if the asset, although unencrypted, is confirmed to never store or process sensitive data (i.e., only public information). However, this is rare and risky for any corporate asset.",
        "cwe": "311",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "INF.9": [
      {
        "file": "55_sec1.ts",
        "bsiCode": "INF.9",
        "id": "insufficiently-regulated-mobile-work",
        "title": "Insufficiently Regulated Mobile Work (based on BSI)",
        "description": "If mobile work is not, or is insufficiently, regulated, the institution may suffer financial and other damage.",
        "impact": "Failure to adequately secure mobile work and remote access can lead to the compromise of confidential data,",
        "action": "Define and Enforce a Secure Mobile Work Policy",
        "mitigation": "Establish a clear policy for mobile and remote work that specifies mandatory technical safeguards.",
        "check": "Is there a documented policy for mobile work? Does it mandate the use of VPNs or other encrypted communication for accessing sensitive data?",
        "asvs": "BSI IT-Grundschutz CON.3 Mobile Working",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_working_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for communication links that originate from a client asset likely used for mobile work",
        "riskAssessment": "The impact is determined by the confidentiality level of the data being transmitted.",
        "falsePositives": "This risk can be a false positive if other compensating controls that are not modeled exist,",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "55_sec2.ts",
        "bsiCode": "INF.9",
        "id": "physical-environmental-threats-mobile-devices-sys2-3",
        "title": "Physical and Environmental Threats to Mobile Devices (BSI SYS.2.3)",
        "description": "Since mobile end devices (laptops, tablets, smartphones) are used in very different and often uncontrolled environments, they are exposed to many threats.",
        "impact": "Successful exploitation of these threats can directly impact the Availability of the device (if damaged or lost), the Integrity of its data and the systems it connects to (if infected with malware), and the Confidentiality of its stored information (if lost or stolen).",
        "action": "Implement Physical and Technical Protections for Mobile Devices",
        "mitigation": "A combination of physical, technical, and organizational controls is required. Use protective cases and train users on safe transport and handling.",
        "check": "Are mobile devices physically protected (e.g., with cases)? Is full-disk encryption enforced on all mobile clients?",
        "asvs": "BSI IT-Grundschutz SYS.2.3 Clients under special conditions of use",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_2_3_Clients_under_special_conditions_of_use_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset identified as a client-type device (e.g., `mobile-app`, `desktop`/`laptop`).",
        "riskAssessment": "The likelihood of exposure is inherently high for portable devices. The impact scales with the CIA rating of the device and the data it processes or stores.",
        "falsePositives": "The risk may be a false positive if a device, although technically a 'client', is used exclusively in a physically secure, controlled environment (e.g., a kiosk in a locked server room).",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "55_sec3.ts",
        "bsiCode": "INF.9",
        "id": "manipulation-or-destruction-of-mobile-systems-con3",
        "title": "Manipulation or Destruction of Mobile IT Systems (BSI CON.3.G18)",
        "description": "IT systems, accessories, information, and software used in a mobile context may be more easily manipulated or destroyed than those on the institution's premises. Mobile workplaces are often accessible to third parties and may lack the institution's central security measures, such as front desk/security services.",
        "impact": "If IT systems, accessories, information, or software are manipulated or destroyed, an employee's ability to work at the mobile workplace can be severely limited. Furthermore, destroyed IT components or software may need to be replaced, requiring significant financial resources and time. This directly affects the integrity and availability of the systems and associated data.",
        "action": "Implement Physical and Technical Security Measures for Mobile Devices",
        "mitigation": "Utilize physically robust devices. Implement technical safeguards such as full-disk encryption (e.g., BitLocker, FileVault), strong authentication (passwords, biometrics), and remote wipe capabilities. Employees should be trained on situational awareness to protect devices in public spaces. Use secure carrying cases. When unattended, devices should be stored securely (e.g., in a locked room or safe).",
        "check": "Are mobile devices physically protected? Is full-disk encryption enforced? Is strong authentication required? Is a remote wipe solution in place? Are employees trained on securing their devices outside the office?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 'Mobiles Arbeiten', specifically relating to the elementary threat G 0.18 'Manipulation oder Zerstörung mobiler IT-Systeme'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobiles_Arbeiten.html",
        "detectionLogic": "This risk applies to any technical asset identified as a client system used in a mobile context. The tool identifies these assets based on their technology type (e.g., MobileApp, Desktop, ClientSystem, IoTDevice). The risk is raised because these devices, by their nature, operate outside the primary physical security perimeter of the organization.",
        "riskAssessment": "The likelihood is higher for devices that are frequently used in public or unsecured locations. The impact is directly related to the Integrity and Availability requirements of the device itself and the data it handles. Manipulation or destruction of a device with mission-critical data or function will have a 'Very High' impact, while the same event for a less critical device has a lower impact.",
        "falsePositives": "This risk may be a false positive if a device, although technically 'mobile' (e.g., a laptop), is exclusively used in a physically secure, non-public environment (like a locked home office) that is considered equivalent to the main office premises. This context is typically not captured in the technical model and requires manual assessment.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "55_sec4.ts",
        "bsiCode": "INF.9",
        "id": "delayed-information-flow-due-to-mobile-work",
        "title": "Delayed Information Flow due to Mobile Work (BSI INF.9)",
        "description": "Mobile employees often have flexible working hours and can be difficult to reach while traveling, which can significantly delay information flow.",
        "impact": "The temporarily limited availability of employees can severely restrict the availability of crucial information, impacting business processes that rely on timely decisions or data access.",
        "action": "Establish Clear Communication Protocols and SLAs for Mobile Work",
        "mitigation": "Define clear expectations and Service Level Agreements (SLAs) for response times from mobile workers.",
        "check": "Are there defined policies for mobile work communication? Are response time SLAs in place? Are there escalation procedures or deputy rules for time-sensitive tasks assigned to mobile workers?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium INF.9 Mobiler Arbeitsplatz. This is an organizational process risk related to Availability and does not directly map to a specific ASVS requirement.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/sys/SYS_3_2_2_Mobiler_Arbeitsplatz_Edition_2023.pdf?__blob=publicationFile (BSI INF.9)",
        "detectionLogic": "This organizational risk is triggered for any in-scope technical asset tagged 'WorkModel:Mobile'.",
        "riskAssessment": "The likelihood is situational but assumed to be likely if no specific communication SLAs for mobile work are in place.",
        "falsePositives": "This risk can be considered a false positive if the organization has effective, compensating controls in place (e.g., strict SLAs, automated escalation, robust deputy arrangements) that are not captured in the technical model.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "55_sec5.ts",
        "bsiCode": "INF.9",
        "id": "insecure-transport-of-data-to-mobile-workplaces",
        "title": "Insecure Transport of Data or Media to Mobile Workplaces (BSI CON.6)",
        "description": "When documents, data carriers, or files are transported between an institution and mobile workplaces,",
        "impact": "The consequences of insecure transport can be severe, leading to financial damage.",
        "action": "Ensure Secure Data Transport Channels and Protocols",
        "mitigation": "All data transport to mobile or external clients must occur over encrypted and authenticated channels.",
        "check": "Review all communication links that cross trust boundaries to client-type assets.",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Transport of ICT components and data carriers), specific threat 'Loss or theft of data carriers or files during transport'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Transport_of_ICT_components_and_data_carriers_edition_2022.pdf?__blob=publicationFile&v=2 (BSI CON.6)",
        "detectionLogic": "This risk is triggered by communication links that transfer data from within a trust boundary to a client-type technical asset (e.g., mobile app, browser, desktop) located outside of it.",
        "riskAssessment": "The likelihood is high if data is sent over an unencrypted protocol. The impact is determined by the highest Confidentiality, Integrity, and Availability rating of the data assets being transferred.",
        "falsePositives": "A risk might be flagged as a false positive if there are compensating controls modeled,",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "55_sec6.ts",
        "bsiCode": "INF.9",
        "id": "improper-disposal-of-media-con4",
        "title": "Improper Disposal of Data Media at Mobile Workplaces (BSI CON.4)",
        "description": "If it is not possible to dispose of data carriers (e.g., printouts, notes, old USB drives) appropriately at a mobile workplace, they often end up in regular household or public waste bins, or are left behind in hotels or on trains.",
        "impact": "The consequences of improper disposal range from loss of knowledge and confidentiality to existential threats to the institution, for example if important contracts are not concluded or partnerships fail as a result of the information leak.",
        "action": "Implement and Enforce Secure Disposal Procedures for Mobile Workplaces",
        "mitigation": "Establish clear, communicated procedures for the secure disposal of all sensitive information, both digital and physical, for mobile and remote workers.",
        "check": "Are there clear, documented guidelines for disposing of documents and data carriers from mobile workplaces?",
        "asvs": "BSI IT-Grundschutz CON.4: Vernichtung und Entsorgung (Destruction and Disposal), especially Requirement CON.4.A5 (Geeignete Entsorgung von schützenswerten Informationen). Also relates to SYS.3.3 (Mobiler Arbeitsplatz).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_4_Vernichtung_und_Entsorgung_Edition_2023.pdf?__blob=publicationFile (BSI CON.4)",
        "detectionLogic": "Raise a risk for any technical asset that: (1) is a mobile workplace (has the '@MobileWorkplace:true' tag or is a client-type technology) and (2) processes or stores data with confidentiality 'Restricted' or higher.",
        "riskAssessment": "Likelihood: 'Likely' for mobile clients handling sensitive data due to frequent ad-hoc work environments.",
        "falsePositives": "May be a false positive if the organization enforces and audits secure disposal for mobile/remote locations (e.g., mandated return-to-office destruction, certified shredding services, locked disposal containers, awareness training with attestation).",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "55_sec7.ts",
        "bsiCode": "INF.9",
        "id": "unauthorized-access-mobile-workplace-con3",
        "title": "Unauthorized Information Access at the Mobile Workplace (BSI INF.9)",
        "description": "At a mobile workplace, unauthorized third parties can more easily access confidential information stored on devices (e.g., hard drives, removable media) or eavesdrop on communication links, especially when acting professionally. This can have severe consequences for the entire institution.",
        "impact": "An unauthorized disclosure of information (loss of confidentiality) can lead to legal or contractual violations, competitive disadvantages, and significant financial or reputational damage.",
        "action": "Implement Data Protection Measures for Mobile Workplaces",
        "mitigation": "Protect data at rest on mobile devices using strong, full-disk or file-based encryption (e.g., BitLocker, FileVault, LUKS). Protect data in transit by using exclusively encrypted communication protocols (e.g., HTTPS, WSS, FTPS) and/or a mandatory VPN for all connections into corporate or cloud networks. Enforce policies regarding the use of removable media and user awareness for physical security.",
        "check": "Are mobile devices' local storage encrypted by default? Are all communication channels from mobile clients to backend services encrypted? Is a VPN enforced for access to internal resources? Are there policies and training regarding physical security of mobile devices?",
        "asvs": "BSI IT-Grundschutz INF.9 Mobile Workplace",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_workplace_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies technical assets that function as mobile or client workplaces (e.g., Mobile App, Desktop Client, IoT Device). It then checks for two conditions: 1. The storage of sensitive data on the device without asset-level encryption being enabled. 2. The use of unencrypted communication protocols to transmit sensitive data from or to the device.",
        "riskAssessment": "The impact of the risk is determined by the confidentiality of the data at risk (stored or transmitted). The likelihood is considered high if protective measures like encryption are missing. The overall severity is a result of this combination.",
        "falsePositives": "A risk might be a false positive if other compensating controls that are not modeled in Threagile exist, such as an OS-level policy that transparently encrypts all storage, or if a device is used exclusively within a physically secure, trusted network.",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "55_sec8.ts",
        "bsiCode": "INF.9",
        "id": "physical-loss-or-theft-of-mobile-workstation",
        "title": "Physical Loss or Theft of Mobile Workstation (BSI CON.3.A1)",
        "description": "Mobile workstations are not as well physically secured as workstations within a company or government agency's premises.",
        "impact": "In addition to the material damage from the immediate loss of the mobile IT system, further financial damage can occur if sensitive data such as e-mails, meeting notes, addresses, or other documents are disclosed.",
        "action": "Implement Physical and Technical Safeguards for Mobile Devices",
        "mitigation": "To mitigate the risk of data disclosure from lost or stolen devices, all mobile workstations must use full-disk encryption (FDE).",
        "check": "Are all mobile devices (laptops, tablets, smartphones) managed under an MDM? Is full-disk encryption enforced on all mobile devices?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, Baustein CON.3: Mobiler Arbeitsplatz, Requirement CON.3.A1 Diebstahl oder Verlust von mobilen Endgeräten.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobiler_Arbeitsplatz_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for all in-scope technical assets that are identified as physical client devices.",
        "riskAssessment": "The likelihood of a mobile device being lost or stolen is considered 'Likely' due to the nature of mobile work.",
        "falsePositives": "A technical asset might be flagged that, while technically a mobile device (e.g., a laptop), is used exclusively in a physically secure, static location (e.g., permanently docked in a secure office).",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "ISMS.1": [
      {
        "file": "56_sec1.ts",
        "bsiCode": "ISMS.1",
        "id": "unclear-security-roles-and-responsibilities",
        "title": "Unclear Security Roles and Responsibilities (BSI ORP.1)",
        "description": "If roles and responsibilities within the security process are not clearly defined, many employees may neglect or deny their responsibility for information security, often deferring to higher management levels. As a consequence, necessary security measures are not implemented, as they almost always represent additional effort in the usual workflow.",
        "impact": "Failure to implement security measures due to unclear responsibilities creates vulnerabilities. This can lead to the compromise of confidentiality, integrity, or availability of critical assets, disrupt business processes, and result in security incidents and data breaches.",
        "action": "Clearly Define and Communicate Security Roles and Responsibilities",
        "mitigation": "Establish a formal information security organization with clearly defined roles (e.g., CISO, ISO, asset owners, technical administrators). Document the specific responsibilities for each role regarding information security. Ensure these roles and responsibilities are communicated effectively to all relevant personnel and are integrated into standard operational procedures. Assign clear ownership for all critical technical assets.",
        "check": "Is there a documented security organization? Are roles and responsibilities for information security clearly defined, assigned, and communicated? Do all critical technical assets have a designated owner or responsible administrator identified?",
        "asvs": "BSI IT-Grundschutz ORP.1: Information security organisation (specifically ORP.1.A1 Establishing an information security organisation and ORP.1.A2 Defining roles and responsibilities)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This is an organizational risk that can be detected by proxy within the technical model. The rule checks for high-value technical assets (based on their CIA rating) that lack a clearly assigned responsible role (i.e., are not tagged with any 'role:*' tag). The absence of a role tag on a critical asset implies that responsibilities for it may be unclear.",
        "riskAssessment": "The impact is determined by the CIA requirements of the technical asset for which responsibilities are unclear. A high-value asset without a clear owner poses a significant risk. The likelihood is considered high, as neglect of security duties is a common consequence of unclear responsibilities.",
        "falsePositives": "This risk can be a false positive if roles are managed outside of the threat model's tagging system. The model might simply be incomplete. Verification with the organization's role and responsibility matrix is required.",
        "cwe": "285",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "56_sec2.ts",
        "bsiCode": "ISMS.1",
        "id": "lack-of-management-support-for-security-orp1.a1",
        "title": "Lack of Management Support for Information Security (BSI ORP.1.A1)",
        "description": "If security officers do not receive unrestricted support from the institution's management, it can be difficult to enforce necessary security measures. This is particularly challenging when dealing with individuals who are hierarchically superior to the security officers. In such cases, the information security process cannot be fully implemented.",
        "impact": "A lack of management support undermines the entire information security process. Necessary security controls may be underfunded, bypassed, or ignored, leading to a weak security posture. This increases the likelihood of security incidents, potentially compromising the Confidentiality, Integrity, and Availability (CIA) of all assets, leading to data breaches, operational disruptions, financial loss, and reputational damage.",
        "action": "Establish and Demonstrate Clear Management Commitment to Information Security",
        "mitigation": "Management must visibly and actively support the information security strategy. This includes allocating sufficient resources (budget, personnel), approving security policies, empowering security roles (like the CISO or @Role:ITSecurityOfficer), and holding all personnel accountable for security. Management's commitment should be regularly communicated throughout the organization to foster a strong security culture.",
        "check": "Is there a documented information security policy approved by management? Are security roles clearly defined, empowered, and resourced? Does management regularly review the state of information security? Is security a topic in management meetings?",
        "asvs": "BSI IT-Grundschutz Kompendium: ORP.1.A1 Management responsibility for information security",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
        "detectionLogic": "This is an organizational risk that arises from a potential disconnect between management and security functions. This rule triggers if the threat model contains assets tagged with both a management role ('@Role:Management') and a security officer role ('@Role:ITSecurityOfficer'). When this condition is met, the risk is raised against all high-value technical assets, as they are the most likely to be affected by a failure to implement or enforce security controls.",
        "riskAssessment": "The likelihood is considered 'likely' by default, as a lack of explicit support is a persistent organizational vulnerability. The impact is calculated based on the Confidentiality, Integrity, and Availability (CIA) ratings of the affected assets. The failure to enforce security measures on a mission-critical system has a much higher impact than on a system processing public data.",
        "falsePositives": "This risk is an inference based on the presence of roles in the model. The actual level of management support is an organizational factor that cannot be fully determined from a technical model. The risk should be validated by reviewing internal policies, meeting minutes, and the effective power of the security team within the organization.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "56_sec3.ts",
        "bsiCode": "ISMS.1",
        "id": "isms1-unsupported-security-management",
        "title": "ISMS.1 – Unsupported Security Management",
        "description": "Das Sicherheitsmanagement (ISMS) existiert zwar auf dem Papier, ist jedoch organisatorisch nicht verankert: Rollen sind unklar, Ressourcen fehlen, die Leitlinie ist unbekannt und Sicherheitsziele werden nicht gesteuert. Dadurch werden Vorgaben ignoriert und Sicherheitsmaßnahmen bleiben Stückwerk.",
        "impact": "Fehlende Verantwortung und Ressourcen im ISMS führen zu lückenhaften Kontrollen, verspäteter Umsetzung und unkoordiniertem Incident Response. Die Folge sind erhöhte Risiken für Vertraulichkeit, Integrität und Verfügbarkeit (CIA) in besonders geschäftskritischen Assets – mit längeren Ausfällen, größerem Schaden und regulatorischen Konsequenzen.",
        "action": "ISMS sichtbar verankern: Leitung übernimmt Verantwortung, benennt Rollen, gibt Leitlinie frei, priorisiert Maßnahmen und stellt Budget/Personal bereit.",
        "mitigation": "Leitlinie beschließen und veröffentlichen, Sicherheitsziele & -strategie festlegen (mit Geltungsbereich), ISB benennen und ausstatten, Organisationsstruktur & Kommunikationswege definieren, Sicherheitskonzept(e) erstellen und pflegen, Management-Reporting etablieren, Revisionen/Wirksamkeitsprüfungen planen und dokumentieren.",
        "check": "Existiert eine freigegebene Leitlinie? Sind ISB und Rollen benannt und vertreten? Gibt es budgetierte Ressourcen & Zeit? Werden Management-Berichte erstellt (mind. jährlich) und Entscheidungen revisionssicher dokumentiert? Sind Sicherheitsmaßnahmen geplant, priorisiert, umgesetzt und überprüft?",
        "asvs": "Abgeleitet aus BSI IT-Grundschutz Kompendium 2023/2024, Baustein ISMS.1 (Sicherheitsmanagement), u. a. A1–A13 (Leitung, Leitlinie, Organisation, Sicherheitskonzept, Berichte).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/ISMS_1_Sicherheitsmanagement.pdf?__blob=publicationFile",
        "detectionLogic": "Heuristik (modellbasiert): Markiere technische Assets mit hoher Kritikalität (hohe CIA-Werte). Indizien: keine oder sehr wenige organisatorische Tags (z. B. „policy:missing“, „owner:unknown“), fehlende Zuordnung zu Sicherheitskonzepten/Leitlinien, sehr hohe Schutzbedarfe der verarbeiteten Daten (StrictlyConfidential/MissionCritical) bei zugleich fehlender Out-of-Scope-Markierung. Ergebnis: Hinweis auf mögliches fehlendes Management-Support und Ressourcenmangel.",
        "riskAssessment": "Wahrscheinlichkeit standardmäßig „Likely“, um eine organisatorische Prüfung anzustoßen. Die Auswirkung orientiert sich an den höchsten CIA-Einstufungen des betroffenen Assets und seiner Daten; bei Mission-Critical wird „Very High“ angesetzt.",
        "falsePositives": "Kein Befund, wenn Leitung sichtbar Verantwortung trägt, Rollen & Vertretungen geregelt sind, Ressourcen nachweislich ausreichen (Budget/Personen/Zeiten), Management-Berichte vorliegen und Sicherheitsmaßnahmen nach Plan umgesetzt/überprüft werden.",
        "cwe": "284",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "56_sec4.ts",
        "bsiCode": "ISMS.1",
        "id": "inadequate-management-reporting-and-oversight",
        "title": "Inadequate Management Reporting and Oversight",
        "description": "If management is not sufficiently informed about the security status of all business processes, IT systems, and applications, as well as existing deficiencies,",
        "impact": "This can result in an imbalance where some areas are over-protected while others have severe vulnerabilities.",
        "action": "Establish Clear Security Reporting and Oversight Processes",
        "mitigation": "Implement regular, clear, and comprehensive security reporting to management. This reporting should cover the current security posture, identified risks, incident statuses, and the effectiveness of security controls.",
        "check": "Is there a formal process for reporting security status to management? Does management regularly review this information? Are decisions about security resources and priorities documented and based on this reporting?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information security organisation), specifically Requirement ORP.1.A4 (Responsibility for information security).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
        "detectionLogic": "This is a high-level organizational risk. It is raised against mission-critical assets or key security controls under the assumption that a lack of management oversight could lead to their compromise due to misallocated resources or misconfiguration.",
        "riskAssessment": "The likelihood is considered 'Likely' if the organizational process for oversight is not explicitly modeled or confirmed. The impact is directly derived from the criticality of the assets that would be affected by this governance failure.",
        "falsePositives": "This risk is inherently organizational and serves as a prompt for review. An organization might have excellent oversight and reporting processes that are not visible in the technical threat model.",
        "cwe": "16",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "56_sec5.ts",
        "bsiCode": "ISMS.1",
        "id": "lack-of-cooperation-due-to-unclear-strategy-bsi",
        "title": "Lack of Cooperation due to Unclear Security Strategy (BSI-based)",
        "description": "To achieve a consistent and appropriate level of security, different areas of responsibility within an institution must cooperate. However, a lack of strategic guidelines and unclear objectives can lead to different interpretations of the importance of information security. As a result, necessary cooperation may not occur because the task of 'information security' is considered unnecessary or not a priority, leading to security measures not being implemented.",
        "impact": "Failure to cooperate on security matters leads to security measures not being implemented or being implemented inconsistently. This can create exploitable vulnerabilities, compromising the Confidentiality, Integrity, and Availability (CIA) of the entire system, leading to business disruptions, data breaches, and non-compliance.",
        "action": "Establish and Communicate a Clear Information Security Strategy and Foster Cooperation",
        "mitigation": "Management must define, document, and actively communicate a comprehensive information security strategy and policy. This includes clear objectives, defined roles and responsibilities, and processes that encourage and require cross-departmental cooperation on security topics. The strategy's importance must be championed by leadership to ensure it receives appropriate priority across the organization.",
        "check": "Is there a documented and communicated information security strategy and policy? Are security objectives clear and understood across different departments? Are there established processes for inter-departmental collaboration on security matters?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information security organisation), specifically Requirement ORP.1.A1 'Establishing an information security strategy' and ORP.1.A2 'Establishing an information security policy'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
        "detectionLogic": "This is a high-level organizational risk that applies to the entire system. It is generated once and attached to the most critical technical asset (based on its Relative Attacker Attractiveness - RAA) to represent the point of highest potential impact from this strategic failure. The presence of this risk suggests a foundational weakness that affects all components, not just the one it's attached to.",
        "riskAssessment": "Likelihood is HIGH if a clear security strategy is missing or not communicated effectively. Impact is directly related to the overall business criticality of the system. A lack of strategy for a mission-critical system has a VERY HIGH impact, as essential controls may be missing.",
        "falsePositives": "This risk is inherently organizational and its presence cannot be confirmed by the technical model alone. The model identifies it as a potential foundational risk. Verification requires reviewing organizational documents (strategy, policies) and interviewing key personnel to assess the state of inter-departmental cooperation on security.",
        "cwe": "693",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "56_sec6.ts",
        "bsiCode": "ISMS.1",
        "id": "outdated-security-concept-due-to-missing-review",
        "title": "Outdated Security Concept Due to Missing Review Processes (BSI-aligned)",
        "description": "New business processes, applications, and IT systems, as well as new threats, constantly affect the state of information security.",
        "impact": "An outdated security concept means that security measures are no longer adequate for the evolving system or the current threat landscape.",
        "action": "Establish a Regular Security Review and Threat Awareness Process",
        "mitigation": "Implement a formal, recurring process to review and update the information security concept. This process should include:",
        "check": "Is there a documented process for regularly reviewing the information security concept? When was the last review of this system's security architecture conducted?",
        "asvs": "Derived from the BSI IT-Grundschutz-Kompendium (2023), module ORP.4 (Continual improvement process), specifically requirement ORP.4.A5 (Reviewing the effectiveness of information security).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Continual_improvement_process_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organizational risk is raised for technical assets that evolve over time, making them susceptible to an outdated security concept.",
        "riskAssessment": "The likelihood is considered high when a review process is deficient or non-existent, since systems and threats evolve constantly.",
        "falsePositives": "This risk may be a false positive if a robust, continuous security review and improvement process is in place for the identified asset,",
        "cwe": "1104",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "56_sec7.ts",
        "bsiCode": "ISMS.1",
        "id": "violation-of-legal-or-contractual-requirements",
        "title": "Legal or Contractual Non-Compliance",
        "description": "Inadequately secured information, processes, and IT systems can trigger violations of laws (e.g., GDPR/DSGVO, NIS2), industry schemes (e.g., PCI DSS, HIPAA, SOC 2/ISO 27001), or contractual clauses (e.g., DPAs, SLAs). Lack of awareness of applicable national/international regulations and contractual obligations significantly raises this risk.",
        "impact": "Non-compliance can lead to fines and sanctions, regulatory action, loss of certifications/attestations, contractual penalties or termination, litigation, mandatory disclosures, and substantial reputational harm.",
        "action": "Establish and continuously verify compliance (policy → control → evidence → audit) across assets and suppliers.",
        "mitigation": "Identify all applicable legal, regulatory, and contractual requirements; map them to concrete controls with owners and evidence; maintain data inventories and processing purposes; enforce third-party security obligations (DPAs/SLAs, right-to-audit); implement change management for regulatory updates; and run periodic internal/external audits.",
        "check": "Is there an up-to-date register of applicable laws/standards/contracts? Are they mapped to implemented controls and evidence? Are responsibilities and review cadences defined? Are vendor DPAs/SLAs in place and audited? Is compliance re-validated after system or scope changes?",
        "asvs": "BSI IT-Grundschutz: ISMS.1 (Sicherheitsmanagement) — Gefährdung 2.7; related: DER.1 (Compliance).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Compliance_edition_2023.pdf?__blob=publicationFile&v=2 (BSI DER.1, see also ISMS.1 §2.7)",
        "detectionLogic": "Raised for technical assets likely under legal/contractual obligations when ANY of the following holds: (1) Asset carries a @Compliance base tag (e.g., @Compliance:GDPR/PCI-DSS). (2) Asset processes or stores highly sensitive or mission-critical data (Strictly-Confidential confidentiality OR Mission-Critical integrity/availability). (3) Asset communicates (inbound or outbound) with an External-Entity, implying contractual terms with partners/suppliers.",
        "riskAssessment": "Likelihood defaults to Likely due to the ongoing challenge of demonstrating continuous compliance. Impact scales with the asset’s highest CIA ratings: Important → Medium, Critical → High, Mission-Critical/Strictly-Confidential → Very High. Data breach probability is escalated to Probable when impact is High or above.",
        "falsePositives": "May be a false positive when an auditable compliance program fully covers the asset (clear control mapping, owners, evidence, and recurring audits). Review and document justification if the risk is accepted or downgraded.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "56_sec8.ts",
        "bsiCode": "ISMS.1",
        "id": "chain-of-events-leading-to-major-incident",
        "title": "Chain of Events Leading to Major Incident (BSI)",
        "description": "Security incidents can arise from a chain of minor causes or unfortunate circumstances, leading to major damage. A compromise of one system can enable an attacker to move laterally and compromise subsequent, more critical systems. This risk identifies potential architectural attack paths from less-trusted environments (such as the internet) to high-value assets via one or more intermediate systems.",
        "impact": "Successful exploitation of such an attack chain can lead to severe disruption of business processes, major data breaches affecting confidentiality and integrity, loss of system availability, significant reputational damage, and violation of legal or contractual obligations.",
        "action": "Implement Defense-in-Depth and Network Segmentation",
        "mitigation": "Architect the system to minimize attack paths and prevent lateral movement. Use strong trust boundaries (e.g., firewalls, network policies, security groups) to isolate critical assets from less trusted environments. Harden all systems in the chain, not just the initial entry point. Implement robust monitoring and alerting to detect anomalous behavior at any point in the chain, allowing for early intervention.",
        "check": "Are critical assets isolated from internet-facing systems by at least one security boundary? Is lateral movement between assets in the same trust zone restricted? Is there monitoring for multi-stage attack patterns?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein DER.1 (Security Incident Management), which addresses the need to prepare for and handle complex security incidents. The risk itself represents a potential failure of defense-in-depth, a core architectural principle.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Security_incident_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule detects potential attack paths (chains of communication) from internet-exposed assets to internal assets with high confidentiality, integrity, or availability ratings. A risk is generated if a high-value asset is reachable from the internet via one or more intermediate technical assets, representing a cascading risk.",
        "riskAssessment": "The likelihood is assessed based on the existence of such an architectural path. The impact is determined by the CIA rating of the final, high-value asset in the chain. A shorter, less-segmented path poses a higher risk than a multi-layered one. The impact is directly related to the business value of the compromised target.",
        "falsePositives": "The rule might flag standard n-tier architectures. A false positive can be claimed if the intermediate communication links are strongly secured (e.g., with application-layer firewalls, strict API contracts, and fine-grained authorization) to the point where lateral movement is considered infeasible.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "56_sec9.ts",
        "bsiCode": "ISMS.1",
        "id": "inadequate-security-management-orp1",
        "title": "Inadequate Security Management (BSI ORP.1)",
        "description": "Inadequate security management can lead to incorrect priorities being set and security investments not being made in areas that provide the most value. This can result in investing in expensive technologies without foundational organizational rules (like clear responsibilities), or focusing on less critical areas while neglecting business-essential systems. This misalignment creates significant, unaddressed risks despite security spending.",
        "impact": "Misaligned security priorities can lead to severe security incidents. Resources may be wasted on ineffective controls, while critical vulnerabilities in business-essential processes remain unmitigated. This can compromise the confidentiality, integrity, and availability of key assets, disrupt core business functions, and lead to significant financial and reputational damage.",
        "action": "Establish and Maintain a Holistic Information Security Management System (ISMS)",
        "mitigation": "Implement a comprehensive Information Security Management System (ISMS) to ensure a holistic and coordinated approach to security. The ISMS should align security priorities with business objectives, clarify roles and responsibilities, perform regular risk assessments to identify critical areas, and ensure a balanced and efficient allocation of security resources. The strategy should be documented, communicated, and regularly reviewed by management.",
        "check": "Is there a documented ISMS in place? Are security priorities and investments demonstrably linked to business-criticality and risk assessments? Is there a formal process for coordinating security measures and product selections across the organization?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023: ORP.1 Information security organisation.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This is a high-level organizational risk. It cannot be definitively identified from a technical model alone. This rule generates a single, model-wide risk if the system contains any in-scope technical assets. The risk is anchored to the most critical asset found, serving as a concrete example of what is at stake if security management is inadequate.",
        "riskAssessment": "The likelihood is rated as 'Likely' by default, as a perfect ISMS is rare and misalignment is a common organizational challenge. The impact is calculated based on the highest CIA ratings of the most critical asset in the model. A system with 'Strictly Confidential' data or 'Mission-Critical' services faces a 'Very High' impact from misaligned security priorities.",
        "falsePositives": "This risk can be considered a false positive if a mature and effective ISMS is in place that demonstrably aligns security investments with business risks. Verifying this requires reviewing organizational documentation, such as the security strategy, risk assessment reports, and management review minutes.",
        "cwe": "693",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "NET.1.1": [
      {
        "file": "57_sec1.ts",
        "bsiCode": "NET.1.1",
        "id": "inadequate-communication-link-performance",
        "title": "Inadequate Communication Link Performance (based on BSI threat)",
        "description": "If communication links are insufficiently dimensioned, or their performance is degraded due to technical failure or a Denial-of-Service (DoS) attack, clients may only be able to communicate with servers to a limited extent, significantly increasing access times.",
        "impact": "Services dependent on the affected link may become only partially available or completely unusable. Institution-relevant information may no longer be accessible. In severe cases, this can lead to a standstill of essential business processes or entire production lines, causing major operational disruptions.",
        "action": "Ensure adequate capacity and redundancy for communication links",
        "mitigation": "Ensure communication links are dimensioned to handle peak loads and have sufficient capacity. Implement redundant communication paths for all critical connections to mitigate single points of failure. For internet-facing links, use DoS protection services. Monitor link utilization and performance to proactively identify and address bottlenecks. Implement Quality of Service (QoS) mechanisms to prioritize critical traffic.",
        "check": "Are communication links monitored for utilization and performance? Are critical communication paths redundant? Is there a DoS protection strategy in place for internet-facing links? Has a load analysis been performed to ensure sufficient capacity?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Redundant communication links), which outlines measures to prevent availability loss from link failures.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Redundant_communication_links_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
        "detectionLogic": "This risk is raised for communication links that transfer data with high or mission-critical availability requirements, especially those crossing trust boundaries or connecting to the internet. The risk is not raised if the link is marked with the 'redundant-link-manually-confirmed' tag or is a non-network, in-process communication.",
        "riskAssessment": "The likelihood is higher for links connecting to the internet or crossing major trust boundaries, as they are more exposed to external threats and contention. The impact is directly determined by the availability requirements of the technical assets and data assets relying on the communication link. A failure of a link used by a mission-critical system has a 'Very High' impact.",
        "falsePositives": "The model may not capture all forms of network redundancy (e.g., dynamic routing protocols, multiple physical links aggregated into one logical link). The risk might be flagged even if the underlying infrastructure is resilient, but this resilience is not expressed in the model. A manual check of the network architecture is required to confirm.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "57_sec2.ts",
        "bsiCode": "NET.1.1",
        "id": "insufficient-gateway-protection",
        "title": "Insufficient Gateway Protection (BSI-Style)",
        "description": "If an internal network is connected to the Internet and the ingress point is insufficiently protected (e.g., because no dedicated firewall, WAF, or reverse proxy is used), attackers from the Internet can directly access internal systems. This allows them to potentially access, copy, or manipulate sensitive information within the internal network, bypassing perimeter defenses.",
        "impact": "Insufficient gateway protection can lead to unauthorized access to internal assets, resulting in the loss of confidentiality and integrity of processed or stored data. This can lead to severe data breaches, system compromise, and further lateral movement within the network.",
        "action": "Enforce Gateway Security Controls",
        "mitigation": "Ensure that all communication links from an internet-facing component to an internal component pass through a dedicated network security control. This can be a Reverse Proxy, a Web Application Firewall (WAF), an Intrusion Prevention System (IPS), or a dedicated API Gateway. The internal asset should not be directly exposed to traffic from the Internet.",
        "check": "Review all communication links that cross a trust boundary from the Internet into an internal network. Verify that the target of every such link is a technical asset designated as a gateway security control (like a WAF or Reverse Proxy).",
        "asvs": "V1.1.2: Security Architecture",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This rule iterates through all communication links. It identifies risks where a technical asset marked as 'internet-facing' communicates directly with an asset that is not 'internet-facing' (i.e., an internal asset), crossing a trust boundary. A risk is raised if the internal receiving asset is not a recognized gateway or security technology (like a WAF, Reverse Proxy, Gateway, etc.) and if the communication involves data of at least 'restricted' confidentiality or 'important' integrity.",
        "riskAssessment": "The likelihood is considered high because a direct attack path from the Internet to an internal, non-hardened system exists. The impact is determined by the maximum confidentiality and integrity of the data assets transferred over the unprotected link. A direct connection involving 'strictly confidential' data poses a 'very high' impact.",
        "falsePositives": "This might be a false positive if a compensating control that is not modeled exists, such as a cloud provider's firewall (e.g., AWS Security Group, Azure NSG) that is implicitly protecting the asset. However, for a robust threat model, such controls should ideally be modeled as part of a trust boundary.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "57_sec3.ts",
        "bsiCode": "NET.1.1",
        "id": "insecure-network-topology-net1.1",
        "title": "Insecure Network Topology (BSI NET.1.1)",
        "description": "If a network is improperly built or incorrectly extended, insecure network topologies or configurations can arise.",
        "impact": "An insecure network topology significantly increases the risk of lateral movement for an attacker who has gained an initial foothold.",
        "action": "Implement Secure Network Segmentation and Monitoring",
        "mitigation": "Design and implement a segmented network architecture (e.g., using nested trust boundaries in the model to represent DMZs,",
        "check": "Review the threat model's trust boundaries. Are assets with different purposes (e.g., web servers, application servers, databases)",
        "asvs": "BSI IT-Grundschutz NET.1.1 (Network Architecture and Design)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_1_Network_architecture_and_design_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule inspects network-type trust boundaries. It triggers a risk if a boundary represents a 'flat network'",
        "riskAssessment": "The impact is determined by the highest CIA rating of any asset within the insecure network boundary.",
        "falsePositives": "A model might oversimplify a network that is, in reality, properly segmented by underlying infrastructure not fully detailed in the model.",
        "cwe": "501",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "NET.1.2": [
      {
        "file": "58_sec1.ts",
        "bsiCode": "NET.1.2",
        "id": "compromise-of-network-management-solution",
        "title": "Compromise of Network Management Solution (BSI NET.1.2)",
        "description": "If an attack succeeds in accessing network management solutions, for example through unpatched security vulnerabilities or insufficient network separation, all connected network components can be controlled and reconfigured. This can lead to access to sensitive information, redirection of network traffic, or even sustained disruption of the entire network.",
        "impact": "Successful exploitation allows an attacker to control and reconfigure all connected network components. This can lead to unauthorized access to sensitive information (Confidentiality breach), redirection or manipulation of network traffic (Integrity breach), and sustained disruption of the entire network (Availability breach / Denial of Service).",
        "action": "Harden and Isolate Network Management Solutions",
        "mitigation": "Network management solutions must be conceptually treated as highly critical assets. They should be hardened according to best practices, including regular patching and vulnerability management. Access must be strictly controlled using multi-factor authentication and the principle of least privilege. Crucially, the management solution and its traffic should be isolated in a dedicated, restricted network segment (management VLAN/VPN) separate from production and user networks. All access to and from the management solution should be logged and monitored for anomalies.",
        "check": "Is the network management solution running in a dedicated, isolated network segment? Is access strictly limited to authorized administrators via secure channels? Is the system hardened and consistently patched? Are all administrative actions logged and monitored?",
        "asvs": "BSI NET.1.2 (Protection of network management), OWASP ASVS V4.0.3 - 1.1.2 (Secure Network Architecture), OWASP Top 10 2021: A05-Security Misconfiguration",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_2_Protection_of_network_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies technical assets that function as network or system management solutions based on their technology type (e.g., Monitoring, ContainerPlatform, ServiceMesh, WAF, LoadBalancer, etc.). A risk is raised if such a solution has outgoing communication links to manage other assets, as it represents a central point of control. The risk is considered higher if the management asset is exposed to less trusted environments (e.g., the Internet) or has a broad scope of control.",
        "riskAssessment": "The impact is calculated based on the highest Confidentiality, Integrity, and Availability of all technical assets managed by the solution. A compromise of a system managing mission-critical assets has a 'Very High' impact. The likelihood is considered 'Likely' by default and elevated to 'Very Likely' if the management solution is exposed to the Internet or consists of custom-developed parts, which implies a higher chance of vulnerabilities.",
        "falsePositives": "A risk might be a false positive if the identified asset is not used for management purposes, or if there are strong, unmodeled compensating controls like a physically separate management network or strict host-based firewalls.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "58_sec2.ts",
        "bsiCode": "NET.1.2",
        "id": "compromise-of-network-component",
        "title": "Compromise of a Network Component (BSI-style)",
        "description": "Based on a BSI-style threat: If an attacker succeeds in accessing an individual network component (such as a load balancer, reverse proxy, or gateway), the component can be controlled and manipulated. All data traffic routed through it can be compromised (eavesdropped on or tampered with). Furthermore, the compromised component can be used as a stepping stone to launch further attacks and penetrate deeper into the network.",
        "impact": "Successful exploitation leads to loss of confidentiality and integrity for all data traffic passing through the component. It enables man-in-the-middle attacks, session hijacking, and may facilitate lateral movement, significantly expanding an attacker's foothold within the architecture. This can result in major data breaches and system-wide compromise.",
        "action": "Harden Network Components and Monitor Traffic",
        "mitigation": "Apply security hardening baselines to all network components. Change default credentials immediately. Keep firmware and software patched and up-to-date. Implement strong, multi-factor authentication for management interfaces. Restrict access to management interfaces to a dedicated, secured management network. Employ network segmentation to limit the blast radius. Monitor traffic and component logs for anomalous activity.",
        "check": "Are default credentials for network devices changed? Are all component software and firmware regularly patched? Is access to management interfaces restricted (e.g., via firewall rules, jump hosts)? Is multi-factor authentication used for administrative access? Is network traffic to and from the component monitored for signs of compromise?",
        "asvs": "V14.2 Network and Platform Configuration",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for all in-scope technical assets that act as network infrastructure components, such as load balancers, reverse proxies, gateways, and service meshes. The severity is determined by the sensitivity of the data passing through the component and its exposure to the internet.",
        "riskAssessment": "The impact is calculated based on the highest confidentiality and integrity of data assets on all connected communication links. A higher impact is assigned if the data is confidential or critical. The likelihood is considered higher for components that are directly exposed to the internet, as they are more accessible targets for attackers.",
        "falsePositives": "This risk may be a false positive if extensive hardening measures are in place (e.g., hardware security modules, protected out-of-band management networks) but are not represented in the model.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "58_sec3.ts",
        "bsiCode": "NET.1.2",
        "id": "unprotected-network-management-communication",
        "title": "Unprotected Network Management Communication",
        "description": "If network management communication is eavesdropped upon and manipulated, active network components can be misconfigured or controlled.",
        "impact": "An attacker exploiting this vulnerability can intercept credentials, manipulate network traffic, reconfigure critical network components to disrupt service (Denial of Service), or pivot deeper into the infrastructure (Elevation of Privilege).",
        "action": "Encrypt Network Management Traffic",
        "mitigation": "Ensure all communication links used for management, monitoring, or other DevOps purposes utilize strong, encrypted protocols (e.g., SSH, HTTPS, LDAPS, FTPS, WSS, SNMPv3).",
        "check": "Review all communication links with a 'devops' usage designation. Verify that the protocol is encrypted or that the link is protected by a VPN.",
        "asvs": "V14.2.1 (ASVS 4.0.3) / 13.2.1 (ASVS 5.0): Data-in-transit is encrypted and authenticated using a secure protocol.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for any communication link marked with `usage: devops` that is not using an encrypted protocol and is not explicitly protected by a VPN.",
        "riskAssessment": "The likelihood is considered high, especially for links crossing trust boundaries. The impact is determined by the criticality (CIA ratings) of the target asset being managed.",
        "falsePositives": "This risk might be a false positive if the link is protected by other compensating controls not modeled, such as a physically isolated and secured management network which is considered fully trusted.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "58_sec4.ts",
        "bsiCode": "NET.1.2",
        "id": "insufficient-time-synchronization-ops1-1-5",
        "title": "Insufficient Time Synchronization (BSI OPS.1.1.5.A14)",
        "description": "If the system time of components—especially those used for infrastructure management and security monitoring—is not synchronized, correlating log data from different sources becomes difficult or impossible. Inconsistent timestamps can lead to incorrect event analysis, hindering incident response and forensic investigations.",
        "impact": "The inability to correlate events across systems hampers incident response, troubleshooting, and forensic analysis. Security incidents, data exfiltration, or coordinated attacks might go undetected or be misinterpreted, leading to prolonged system compromise, delayed remediation, and an inability to reliably prove what occurred.",
        "action": "Implement and Enforce Time Synchronization via NTP",
        "mitigation": "All relevant systems should be configured to synchronize their time with a reliable and consistent time source (e.g., using NTP - Network Time Protocol). Use internal, tiered NTP servers for on-premises networks and provider-managed time services in the cloud. Ensure firewall rules permit NTP traffic between clients and servers. Regularly monitor the time synchronization status of all critical components. Use the 'ntp-configured' tag on assets where this control is confirmed.",
        "check": "Are all technical assets configured to use a central, reliable time source (NTP)? Is the time synchronization status monitored? Can log entries from different systems be reliably correlated by timestamp?",
        "asvs": "BSI IT-Grundschutz-Kompendium: OPS.1.1.5.A14 Zeit-Synchronisation (Time synchronization)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Logging_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for all in-scope, server-side or infrastructure-related technical assets that do not have the 'ntp-configured' tag. Accurate time is fundamental for logging, which is critical for nearly all backend components. The risk is suppressed for client-side technologies and embedded libraries, where local time is less critical for cross-system event correlation.",
        "riskAssessment": "The likelihood is considered 'likely' when the control is not explicitly modeled, as misconfigurations are common. The impact is derived from the asset's Integrity and Availability ratings, because time synchronization is crucial for investigating issues related to both (e.g., data tampering or service outages). A higher CIA rating results in a higher impact.",
        "falsePositives": "This risk can be a false positive if time synchronization is implemented and managed at an underlying layer (e.g., by the cloud provider or via OS deployment images) but not explicitly tagged in the model. To remediate this finding, apply the 'ntp-configured' tag to the asset.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "NET.2.1": [
      {
        "file": "59_sec1.ts",
        "bsiCode": "NET.2.1",
        "id": "@Network:WLAN-interference-or-jamming-bsi-net3.2",
        "title": "@Network:WLAN Interference or Jamming (BSI NET.3.2)",
        "description": "In wireless networks, information is transmitted using electromagnetic radio waves.",
        "impact": "Disruption or complete failure of wireless communication leads to a loss of availability for the @Network:WLAN and any assets or business processes that depend on it.",
        "action": "Secure @Network:WLAN Configuration and Monitoring",
        "mitigation": "To mitigate unintentional interference, perform site surveys to plan channel allocation and access point placement to avoid overlapping frequencies with other powerful sources.",
        "check": "Is there a WIPS in place to detect jamming and other wireless attacks? Are Protected Management Frames (802.11w) enabled on the @Network:WLAN?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium Baustein NET.3.2 Wireless LAN.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Wireless_LAN_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any communication link that is explicitly tagged as a wireless connection (e.g., using the `@Network:WLAN` tag).",
        "riskAssessment": "The likelihood of unintentional interference is considered 'Likely' in dense environments with many competing wireless devices.",
        "falsePositives": "This risk might be a false positive if the @Network:WLAN is operated in a specially shielded environment (e.g., a Faraday cage) or if highly specialized, military-grade anti-jamming technology is in use,",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "59_sec10.ts",
        "bsiCode": "NET.2.1",
        "id": "@Network:WLAN-hardware-damage-bsi-con-3",
        "title": "Hardware Damage to @Network:WLAN Components (BSI CON.3)",
        "description": "Hardware damage can disrupt wireless traffic, and in the worst-case scenario, the @Network:WLAN can fail completely.",
        "impact": "Physical damage to @Network:WLAN components primarily impacts Availability, leading to service disruption or complete failure.",
        "action": "Physically Protect Exposed @Network:WLAN Hardware",
        "mitigation": "@Network:WLAN components in exposed locations (outdoors, public areas) should be installed in physically secure, weather-resistant, and vandal-proof enclosures.",
        "check": "Are @Network:WLAN devices in exposed locations physically protected by appropriate enclosures? Is there protection against environmental factors like weather and lightning?",
        "asvs": "Derived from BSI IT-Grundschutz Compendium CON.3: Wireless LAN (@Network:WLAN)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Wireless_LAN_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified for any technical asset explicitly marked as a `@Network:WLAN-Component` that is also tagged as being in an exposed location with `@PhysicalLocation:Outdoor`.",
        "riskAssessment": "The likelihood of damage is considered high for any component tagged as being outdoors, as this is the explicit vulnerability condition.",
        "falsePositives": "A technical asset might be tagged as being outdoors but could be installed inside a highly durable, vandal-proof, and weather-proof enclosure.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "59_sec11.ts",
        "bsiCode": "NET.2.1",
        "id": "stolen-@Network:WLAN-access-point",
        "title": "Theft of a @Network:WLAN Access Point (BSI NET.3.2.A4)",
        "description": "If a @Network:WLAN Access Point (AP) is installed in an unsecured, publicly accessible area, it can be physically stolen.",
        "impact": "Extracting credentials from a stolen AP allows an attacker to gain unauthorized access to the wireless network.",
        "action": "Secure Physical Installation of Access Points",
        "mitigation": "Physically secure all @Network:WLAN Access Points, especially those in public or semi-public areas, using anti-theft enclosures, security cables, or by installing them in concealed locations (e.g., above a ceiling).",
        "check": "Are @Network:WLAN Access Points located in public areas physically secured against theft? Are sensitive credentials stored on the APs kept to a minimum and protected? Is there a documented process for decommissioning and disposing of network hardware?",
        "asvs": "BSI IT-Grundschutz NET.3.2 Wireless LAN, Threat NET.3.2.A4 Theft of an Access Point.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Wireless_LAN_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any `technical_asset` of type `physical` that is tagged with both `@component:@Network:WLAN-access-point` and `@location:public-area`.",
        "riskAssessment": "The likelihood is considered high if a physical AP is located in a public area without any modeled compensating controls.",
        "falsePositives": "This risk might be a false positive if the asset is tagged as being in a `@location:public-area` but is, in reality, inside a locked cabinet, behind a permanently locked door, or otherwise physically secured in a way not captured by the threat model. The model abstracts physical security into a simple location tag.",
        "cwe": "522",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "59_sec2.ts",
        "bsiCode": "NET.2.1",
        "id": "inadequate-@Network:WLAN-planning",
        "title": "Inadequate @Network:WLAN Planning (based on BSI NET.2.1)",
        "description": "Errors in planning information technology deployments often prove to be particularly serious because they can easily create widespread security vulnerabilities.",
        "impact": "Poor @Network:WLAN planning can lead to the compromise of data confidentiality through eavesdropping on unencrypted or weakly encrypted traffic.",
        "action": "Develop and Implement a Comprehensive @Network:WLAN Security and Deployment Concept",
        "mitigation": "A formal @Network:WLAN concept should be created before deployment. This concept must specify the use of strong, state-of-the-art encryption and authentication protocols (e.g., WPA3 with a strong pre-shared key or, preferably, WPA3-Enterprise with 802.1X/EAP-TLS).",
        "check": "Is there a documented @Network:WLAN security and deployment plan? Does it mandate strong encryption (WPA2/WPA3) and forbid outdated protocols?",
        "asvs": "BSI IT-Grundschutz NET.2.1 @Network:WLAN Operation (see also NET.2.2 @Network:WLAN Use)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_WLAN_use_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers risks for any communication link tagged as `@Network:WLAN-transport` that does not use an encrypted application-layer protocol (like HTTPS, FTPS, etc.).",
        "riskAssessment": "The likelihood of exploitation is considered high if sensitive data is transmitted without application-level encryption over a @Network:WLAN, as an attacker only needs to gain access to the wireless medium.",
        "falsePositives": "This risk may be a false positive if the underlying @Network:WLAN transport is stringently secured using mechanisms not visible in the model, such as WPA3-Enterprise with mandatory EAP-TLS and robust network segmentation.",
        "cwe": "326",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "59_sec3.ts",
        "bsiCode": "NET.2.1",
        "id": "unauthorized-wlan-access-point",
        "title": "Unauthorized WLAN Access Point Connected to the Internal Network",
        "description": "If an employee connects an unauthorized or insecurely configured wireless access point to an internal network segment, it can lead to severe security problems.",
        "impact": "A rogue access point compromises the network perimeter, exposing internal systems and data to unauthorized access.",
        "action": "Implement Network Access Control and Prohibit Unauthorized Hardware",
        "mitigation": "Implement technical controls like IEEE 802.1X Network Access Control (NAC) on all network switch ports to prevent unauthorized devices from gaining network access.",
        "check": "Are network access controls (like 802.1X) implemented on all user-accessible network ports? Are there regular, automated scans for rogue wireless access points? Is there a clear, communicated policy against connecting unauthorized devices?",
        "asvs": "V13.1.2: Verify that internal network segments containing sensitive data are separated from other network segments using firewalls and logical access controls.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
        "detectionLogic": "This risk is identified by detecting direct communication links from assets in untrusted or internet-facing zones to assets in trusted, internal network boundaries,",
        "riskAssessment": "The likelihood is considered 'Likely' if network ports are not physically or technically secured (e.g., via NAC), as this allows employees or attackers with physical access to connect unauthorized devices.",
        "falsePositives": "This rule might trigger a false positive if the model legitimately depicts a direct, highly privileged connection across network boundaries (e.g., a secure administrative tunnel) that is not explicitly modeled as a typical perimeter service.",
        "cwe": "501",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "59_sec4.ts",
        "bsiCode": "NET.2.1",
        "id": "insufficient-authentication-mechanisms",
        "title": "Weak or Missing Authentication Mechanisms",
        "description": "If authentication methods and mechanisms for communication links are missing or insufficient,",
        "impact": "Exploitation of weak or missing authentication can lead to unauthorized access, data breaches, and session hijacking.",
        "action": "Enforce Strong, Encrypted Authentication",
        "mitigation": "Ensure that all communication links, especially those crossing trust boundaries or carrying sensitive data,",
        "check": "Review all communication links in the model. Do any have authentication set to 'none'? Are there any links using 'credentials' over an unencrypted protocol (such as HTTP, FTP, or LDAP)?",
        "asvs": "V4.2 (Authentication), V7.1 (Network)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
        "detectionLogic": "This rule checks all communication links. It triggers a risk if a link has authentication set to 'none' or 'credentials' over an unencrypted channel.",
        "riskAssessment": "The impact is determined by the highest confidentiality and integrity of the data assets transferred over the link.",
        "falsePositives": "A risk might be a false positive if other compensating controls exist that are not modeled, such as physical network isolation or a service mesh that transparently adds mTLS. In such cases, the risk should be accepted with justification or mitigated by modeling the compensating control.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "59_sec5.ts",
        "bsiCode": "NET.2.1",
        "id": "insecure-@Network:WLAN-configuration",
        "title": "Insecure @Network:WLAN Configuration",
        "description": "Access Points and other @Network:WLAN components (e.g., @Network:WLAN Controllers) offer a variety of configuration settings, especially concerning security functions.",
        "impact": "Misconfiguration of @Network:WLAN components can lead to unencrypted data transmission, allowing attackers to intercept sensitive information (violating Confidentiality),",
        "action": "Securely Configure @Network:WLAN Components and Enforce Encrypted Communication",
        "mitigation": "Ensure all @Network:WLAN components are configured to use strong, modern security protocols such as WPA3 or WPA2 with AES encryption. Disable outdated protocols such as WEP, WPA, and features such as WPS (Wi-Fi Protected Setup).",
        "check": "Are all @Network:WLAN components configured to use WPA3/WPA2-AES? Are weak protocols and WPS disabled?",
        "asvs": "V14.2.1: Verify that all network connections use authenticated encryption (e.g., TLS).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for any technical asset tagged as a '@Network:WLAN-component' that has outgoing communication links using an unencrypted protocol.",
        "riskAssessment": "The likelihood of exploitation is considered high for unencrypted @Network:WLAN traffic, as sniffing tools are widely available. The impact is directly dependent on the sensitivity (Confidentiality and Integrity) of the data assets transmitted over the insecure link.",
        "falsePositives": "This risk might be a false positive if the @Network:WLAN is deployed in a physically secured, isolated environment with no unauthorized access possible,",
        "cwe": "319",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "59_sec6.ts",
        "bsiCode": "NET.2.1",
        "id": "weak-@Network:WLAN-security",
        "title": "Weak @Network:WLAN Encryption / Cleartext Traffic",
        "description": "@Network:WLAN components in their default delivery state are often configured with few or no security mechanisms enabled.",
        "impact": "If weak or no encryption is used for a @Network:WLAN, an attacker can eavesdrop on the data traffic (including credentials and session cookies), leading to disclosure of sensitive information and potential account takeover.",
        "action": "Enforce strong WLAN encryption and eliminate cleartext protocols",
        "mitigation": "Ensure all @Network:WLAN components enforce WPA3 or, at minimum, WPA2-Enterprise (802.1X) with strong EAP methods; avoid WPA2-PSK unless using long, unique passphrases.",
        "check": "Is the @Network:WLAN configured for WPA3 or WPA2-Enterprise (802.1X)? Are WEP and WPA/TKIP disabled? If PSK is used, is it unique and ≥20 characters? Is WPS disabled?",
        "asvs": "ASVS V14.2.1 & V9.1: Encrypt communications in transit using strong, peer-authenticated protocols; disable legacy/weak cipher suites and protocols.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/SYS/SYS_3_2_1_Wireless_LAN_en.html",
        "detectionLogic": "Triggers when a technical asset tagged `@Network:WLAN` participates in a communication link whose `protocol` is evaluated as cleartext by the platform’s `isProtocolEncrypted` check.",
        "riskAssessment": "Likelihood is very high for cleartext WLAN traffic because passive eavesdropping is trivial. Impact scales with the highest confidentiality of data observed on the affected link:",
        "falsePositives": "This risk might be a false positive if the apparent cleartext protocol is fully encapsulated in a modeled secure tunnel (e.g., a VPN link protocol is explicitly represented on the link).",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "59_sec7.ts",
        "bsiCode": "NET.2.1",
        "id": "eavesdropping-on-insecure-@Network:WLAN",
        "title": "Eavesdropping on Insecure @Network:WLAN Communication (BSI NET.2.1)",
        "description": "Because wireless communication (@Network:WLAN) is a shared medium, data transmitted over it can be intercepted and recorded. If this data is not encrypted, or is insufficiently encrypted, the payload can be read. Furthermore, the radio waves of wireless networks often extend beyond the physical boundaries of one's own premises. Thus, data is also broadcast into areas that cannot be controlled or secured by the user or organization.",
        "impact": "If sensitive data is transmitted unencrypted over a wireless network, an attacker can intercept and read it, leading to a breach of confidentiality. This can expose user credentials, personal data, session information, or business secrets and can cascade into identity theft, financial loss, or further system compromises.",
        "action": "Enforce strong end-to-end encryption on all @Network:WLAN communications and WPA3 on the WLAN itself.",
        "mitigation": "All communication links traversing a wireless network must use a protocol that provides strong, end-to-end encryption (e.g., HTTPS, WSS, JDBC-encrypted, FTPS, SFTP). For the @Network:WLAN infrastructure itself, use strong security protocols like WPA3 with robust authentication. Avoid using outdated or broken protocols like WEP. If an application protocol is inherently unencrypted, it must be tunneled through a secure layer like a VPN if it must traverse a wireless network. The use of a VPN can be modeled by setting the `vpn: true` flag on the communication link.",
        "check": "Review all communication links tagged as '@Network:WLAN'. Verify that the protocol used is encrypted or that the link is protected by a VPN. Check the WLAN infrastructure configuration to ensure WPA3 (or better) is enforced.",
        "asvs": "V11.1.1: Verify that all communications between components are encrypted in transit.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule scans for communication links that are explicitly tagged with `@Network:WLAN`. For each such link it checks `isProtocolEncrypted(link.protocol)` and the `link.vpn` flag. If the protocol is not encrypted and the link is not traversing a VPN, a risk is generated. Links using encrypted application protocols (e.g., HTTPS/WSS/JDBC-encrypted/FTPS/SFTP) or explicitly modeled with `vpn: true` are ignored. Impact is scaled based on `link.getHighestConfidentiality()` and the risk title names the source and target assets.",
        "riskAssessment": "The likelihood is very high if an unencrypted protocol is used over a @Network:WLAN, as eavesdropping tools are widely available and effective. The impact depends directly on the sensitivity (confidentiality) of the data assets being transmitted. Transmitting 'Strictly Confidential' data results in a very-high impact.",
        "falsePositives": "A false positive might occur if the model incorrectly tags a link as `@Network:WLAN` when it is entirely on a wired network, or when encryption is provided by an out-of-band tunnel that is not modeled (e.g., a site-to-site VPN not represented on the link). This risk is considered mitigated if the link is modeled with the `vpn: true` flag, even if the application protocol is unencrypted.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "59_sec8.ts",
        "bsiCode": "NET.2.1",
        "id": "rogue-access-point-net-2-1",
        "title": "Communication via Rogue/Evil-Twin Access Point (BSI NET.2.1)",
        "description": "An attacker can impersonate part of a wireless network infrastructure by deploying a malicious access point (a 'Rogue' or 'Evil Twin' AP)",
        "impact": "Successful exploitation can expose credentials, session tokens, and sensitive payloads (Confidentiality) and allow in-transit modification or",
        "action": "Implement Strong Wireless Security and Secure Communication Channels",
        "mitigation": "Enforce a secure VPN for all connections originating from clients on potentially untrusted networks to protect traffic end-to-end.",
        "check": "Review client-originating communication links: is a VPN enforced on untrusted networks? For managed WLANs, verify WPA3 or WPA2-Enterprise",
        "asvs": "BSI IT-Grundschutz NET.2.1 — WLAN-Betrieb",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/NET/NET_2_1_WLAN-Betrieb_Edition_2023.pdf?__blob=publicationFile (German)",
        "detectionLogic": "Flags communication links that originate from client-type technical assets (e.g., Mobile App, Laptop, IoT Device) where the link is not",
        "riskAssessment": "Likelihood is high for mobile/roaming clients. Impact scales with the confidentiality/integrity requirements of the data traversing the link.",
        "falsePositives": "May be a false positive for strictly wired-only environments or if compensating controls (e.g., always-on enterprise VPN with device",
        "cwe": "311",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "59_sec9.ts",
        "bsiCode": "NET.2.1",
        "id": "unprotected-access-point-backend-connection",
        "title": "Physically Accessible AP with Unencrypted Wired Backhaul",
        "description": "If a wireless Access Point (AP) is installed where unauthorized people can physically reach it, an attacker can tap or insert a device into the wired backhaul (e.g., Ethernet) between the AP and the switching infrastructure. This enables passive sniffing or active MitM on all traffic traversing the AP, regardless of the WLAN air-interface encryption (WPA2/WPA3).",
        "impact": "Leads to disclosure and potential manipulation of data transiting the AP, bypassing WLAN encryption. Impact scales with the highest confidentiality of data on the affected link; sensitive data can result in severe or critical impact.",
        "action": "Secure physical placement and encrypt the AP’s wired backhaul",
        "mitigation": "Install Access Points in physically secure or tamper-resistant locations (locked rooms/ceilings/enclosures). Encrypt the wired backhaul (e.g., IEEE 802.1AE MACsec on the switchport or tunneling AP traffic via IPsec/VPN to a controller). Enforce port security/802.1X on the switchport, disable unused ports, and ensure management access uses secure channels (SSH/TLS).",
        "check": "Are any Access Points publicly reachable (hallways, lobbies, outdoor areas)? Is the wired uplink from the AP to the switch encrypted (e.g., MACsec or VPN)? Do switchports enforce 802.1X/port security and are APs mounted to deter tampering/theft?",
        "asvs": "V14.1.1 Network Architectural Design and Segmentation",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "Flags technical assets modeled as Access Points (technology 'Gateway' or 'IoTDevice') that are tagged '@Access:Public'. For each such asset, all outgoing communication links are checked; if a link’s protocol is not considered encrypted by the model, a risk is raised for that link.",
        "riskAssessment": "Likelihood is 'Likely' if the AP is physically accessible and its backhaul is unencrypted. Impact derives from the highest confidentiality of data flowing over the link; risks become High or Critical when Confidential or Strictly Confidential data traverse the unencrypted path.",
        "falsePositives": "May be a false positive when compensating controls exist but are not represented in the model—e.g., MACsec enabled on the switchport (a Layer-2 control typically not modeled as a protocol), backhaul VPN tunneling, or continuous physical monitoring and tamper detection.",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "APP.2.2": [
      {
        "file": "5_sec1.ts",
        "bsiCode": "APP.2.2",
        "id": "improper-ad-forest-security-boundary",
        "title": "Improper AD Forest Security Boundary",
        "description": "In Active Directory Domain Services (AD DS), the Forest is the ultimate security boundary, not the Domain.",
        "impact": "A full compromise of an AD Forest gives an attacker control over all objects belonging to all contained domains, including all user accounts, administrator accounts, and computer accounts.",
        "action": "Implement Forest-Level Segmentation for High-Security Zones",
        "mitigation": "For environments requiring true security isolation (e.g., separating production from development), use separate, non-trusting AD Forests.",
        "check": "Review the AD topology. Are distinct security zones (like production, staging, development) separated by domains within the same forest?",
        "asvs": "V1.4.1: Verify that there is appropriate separation of duties and least privilege between components, services and applications.",
        "cheatSheet": "https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models",
        "detectionLogic": "This rule identifies trust boundaries tagged as `@AD:Forest` that contain more than one nested trust boundary tagged as `@AD:Domain`.",
        "riskAssessment": "The impact of a forest compromise is almost always 'Very High'. The likelihood is rated as 'Likely' because attack paths within multi-domain forests are well-documented and commonly exploited.",
        "falsePositives": "This risk can be considered a false positive if the multi-domain forest is intended for a single, unified security context and a robust, well-maintained administrative tiering model is strictly enforced.",
        "cwe": "266",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec10.ts",
        "bsiCode": "APP.2.2",
        "id": "active-directory-compromise-via-ntdsdit",
        "title": "Compromise of Active Directory via ntds.dit Theft",
        "description": "A core component of Active Directory, the ntds.dit database, contains password hashes for all domain users and is replicated on every read-write domain controller (RWDC). Attackers who gain access to this file, either from a live system or an insecure @Backup:Target, can extract credentials. This risk is significantly amplified when domain controllers are virtualized and share a physical host with less secure systems, as compromising the host or its administrative accounts can provide a direct path to the virtualized DC's files.",
        "impact": "Successful exploitation leads to the complete compromise of the Active Directory domain, and potentially the entire forest. Attackers can create administrative accounts, access any system connected to the domain, decrypt sensitive data, and achieve full persistence. This constitutes a critical failure of confidentiality, integrity, and availability.",
        "action": "Isolate and Harden Domain Controllers",
        "mitigation": "Physically and logically secure all domain controllers. Use dedicated, hardened virtualization hosts for virtualized DCs or ensure strict network and administrative isolation from other VMs. Implement secure @Backup:Target procedures with encrypted, access-controlled storage for @Backup:Target files. Severely restrict and monitor administrative access to both the domain controllers and their virtualization hosts.",
        "check": "Are domain controllers running on dedicated physical or virtual hosts? If virtualized, are they isolated from other, less critical VMs? Are virtualization host administrator accounts strictly controlled and monitored? Is the @Backup:Target process for DCs documented, secure, and tested?",
        "asvs": "Derived from the BSI IT-Grundschutz APP.2.2 'Active Directory Domain Services', addressing threats such as T 5.147 'Compromise of domain controllers' and guidance on physical protection and the secure operation of virtualized domain controllers.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_2_2_Active_Directory_Domain_Services_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Identifies technical assets configured as LDAP identity stores (typically Active Directory domain controllers). The risk is elevated if these critical assets are virtualized and run on a shared runtime environment alongside other, potentially less secure, technical assets.",
        "riskAssessment": "The impact is considered 'Very High' due to the catastrophic consequences of a domain compromise. The likelihood starts as 'Likely' for any identified DC. It increases to 'Very Likely' if the DC is virtualized and shares a runtime environment with other assets, as this expands the attack surface to the virtualization host and its neighbors.",
        "falsePositives": "This risk may be a false positive if the shared virtualization environment has compensating controls visible in the model, such as advanced hypervisor security, micro-segmentation, and strict administrative separation between the DC and other VMs.",
        "cwe": "522",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec11.ts",
        "bsiCode": "APP.2.2",
        "id": "cached-privileged-credentials",
        "title": "Privileged Credentials Cached on Non-PAW Systems (BSI APP.2.2)",
        "description": "If highly privileged domain accounts (e.g., Domain Admins) sign in to standard servers or clients, their credentials can be cached on those systems (e.g., in LSASS memory). Compromise of such a system enables credential theft and rapid privilege escalation across the domain/forest.",
        "impact": "Compromise of one non-PAW system that cached privileged credentials can cascade to full domain and potentially forest compromise via lateral movement and impersonation.",
        "action": "Enforce PAW-only sign-in for Tier-0 roles and a strict tiered admin model; prefer JIT/JEA administration and remote workflows that do not expose credentials on standard hosts.",
        "mitigation": "Prohibit the use of highly privileged accounts on anything other than dedicated, hardened Tier-0 hosts (Domain Controllers and Privileged Access Workstations). Implement a tiered access model where administrative accounts for one tier cannot be used on lower-trust tiers. Use separate admin and daily-use accounts. Mandate PAWs for all domain administration. Enable Windows Defender Credential Guard and LSA protection (RunAsPPL) on endpoints. Prefer Remote Credential Guard/PowerShell Just-Enough-Administration to avoid credential material on targets.",
        "check": "Are privileged domain logons technically restricted to PAWs/DCs? Is a tiered access model (Tier-0/1/2) documented and enforced? Are PAWs mandated and verified? Are Credential Guard and LSA protection enabled? Are JIT/JEA processes in place to avoid persistent high-privilege sessions?",
        "asvs": "MITRE ATT&CK: T1003.001 (OS Credential Dumping: LSASS Memory); Related: T1550 (Use of Stolen Credentials)",
        "cheatSheet": "https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protecting-and-managing-credentials",
        "detectionLogic": "Flag whenever a communication link explicitly tagged as a high-privilege domain login (e.g., '@Privilege:DomainAdmin') originates from an in-scope technical asset that is not tagged '@AssetType:PAW' and targets an identity-related system (e.g., LDAP/AD DS/KDC/Identity Store). The source asset is marked at risk because it would cache the privileged credentials.",
        "riskAssessment": "Impact is Very High by default due to potential identity infrastructure takeover. Likelihood is higher for client-type sources (users browse/email) and lower for hardened servers. Severity is calculated from these factors.",
        "falsePositives": "May be a false positive if the source is actually a hardened PAW but is not tagged '@AssetType:PAW' in the model, or if the tag '@Privilege:DomainAdmin' was used for a non-interactive, isolated flow that cannot cache credentials.",
        "cwe": "522",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec12.ts",
        "bsiCode": "APP.2.2",
        "id": "uncontrolled-domain-join",
        "title": "Uncontrolled Domain Join by Authenticated Users",
        "description": "In the default configuration of Active Directory Domain Services (AD DS), any authenticated user is permitted to join up to ten IT systems to the domain, even without holding administrative privileges within AD DS.",
        "impact": "This misconfiguration can be exploited by an attacker with standard user credentials to escalate privileges within the domain. By joining a compromised machine to the domain, the attacker can potentially intercept credentials, move laterally, and gain access to sensitive resources, ultimately compromising the entire domain. It also undermines IT governance by allowing non-compliant or unmanaged systems into the trusted network.",
        "action": "Restrict Domain-Join Permissions",
        "mitigation": "Set the Active Directory attribute `ms-DS-MachineAccountQuota` to 0 for the domain. This prevents non-administrative users from adding computer accounts.",
        "check": "Verify that the `ms-DS-MachineAccountQuota` attribute is set to 0 in AD DS. Review the 'User Rights Assignment' in the relevant Group Policy Objects to confirm that 'Add workstations to domain' is restricted to authorized administrative personnel.",
        "asvs": "CIS Microsoft Windows Server Benchmark: 2.2.1 Ensure 'Add workstations to domain' is set to 'Administrators'",
        "cheatSheet": "https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/add-workstations-to-domain",
        "detectionLogic": "This risk is triggered for any in-scope technical asset identified as an LDAP-based identity store, which typically represents an Active Directory Domain Controller.",
        "riskAssessment": "The likelihood of exploitation is considered 'Likely' as it only requires standard authenticated user access, which is a common prerequisite for internal attackers. The impact is 'High' by default due to the potential for full domain compromise. If the asset itself is rated as 'Mission-Critical' for integrity or availability, the impact is elevated to 'Very High'.",
        "falsePositives": "This risk can be considered a false positive if the `ms-DS-MachineAccountQuota` has been manually set to 0 and the corresponding user rights have been restricted, which cannot be verified by the threat model alone and requires manual confirmation.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec2.ts",
        "bsiCode": "APP.2.2",
        "id": "improper-trust-relationship-evaluation",
        "title": "Improper Evaluation of Trust Relationships (BSI APP.2.2.A6)",
        "description": "Trust relationships between domains and forests (represented as separate network trust boundaries) allow accounts from one boundary to access resources within another.",
        "impact": "An attacker could exploit a weak or improperly configured trust relationship to escalate privileges from a lower-security environment to a higher-security one.",
        "action": "Review and Secure Trust Relationships",
        "mitigation": "All trust relationships (i.e., communication links crossing network boundaries between identity systems) must be regularly evaluated for their business necessity.",
        "check": "Are all communication links crossing network-level trust boundaries between identity-related assets necessary? Is SID filtering enabled for them? Is Selective Authentication used where appropriate?",
        "asvs": "BSI IT-Grundschutz APP.2.2.A6: Secure configuration of trust relationships",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Active_Directory_Domain_Services_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies communication links between identity-related technical assets (like LDAP servers or Identity Providers) that cross network-level trust boundaries.",
        "riskAssessment": "The likelihood is considered 'Likely' if an untagged trust relationship exists, as these are often complex and misconfigured. The impact is determined by the highest sensitivity (CIA rating) of the assets and data involved in the connected trust boundaries. A trust leading to a boundary with 'Strictly Confidential' data poses a 'High' or 'Very High' impact.",
        "falsePositives": "This risk is raised as a prompt for architectural review. A trust relationship might be fully secure and documented outside the model.",
        "cwe": "266",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec3.ts",
        "bsiCode": "APP.2.2",
        "id": "outdated-ad-ds-functional-level-bsi",
        "title": "Outdated Active Directory Functional Levels",
        "description": "Each new generation of Windows Server, up to and including Windows Server 2016, has introduced additional security features and enhancements for Active Directory Domain Services (AD DS) in the form of domain and forest functional levels.",
        "impact": "Failure to use modern security features in Active Directory can lead to a compromise of the entire domain or forest. This jeopardizes the confidentiality, integrity, and availability of all managed information (such as user credentials, group policies, and access rights) and can enable widespread elevation-of-privilege attacks.",
        "action": "Upgrade Domain Controllers and Raise Functional Levels",
        "mitigation": "All Domain Controllers (DCs) should be migrated to a current, supported version of Windows Server. After all DCs are upgraded, the domain and forest functional levels must be raised to the highest possible level.",
        "check": "Are all Domain Controllers running a current, supported version of Windows Server? Have the domain and forest functional levels been raised to the highest level supported by all DCs? Are modern AD security features enabled and configured?",
        "asvs": "BSI IT-Grundschutz CON.3.A11 Use of an up-to-date version of the directory service",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Directory_services_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for technical assets representing Domain Controllers (technology `identity-store-ldap` or `ldap-server`) that are tagged with an outdated Windows Server version (e.g., `os:windows-server-2016` or older). The presence of such a tag indicates that the system cannot benefit from the latest Active Directory security enhancements.",
        "riskAssessment": "The impact is considered very high if the asset is rated with high or critical CIA values, as compromising a Domain Controller typically compromises the entire environment it manages. The likelihood is considered likely, as exploits against older AD versions and configurations are well-documented and widely known.",
        "falsePositives": "The risk might be mitigated by extensive compensating controls not visible in the model, such as advanced endpoint detection and response (EDR) on the Domain Controllers, strict network segmentation of the management infrastructure, or specialized AD monitoring tools. However, the underlying risk of missing built-in security features remains.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec4.ts",
        "bsiCode": "APP.2.2",
        "id": "unnecessary-services-on-domain-controller",
        "title": "Unnecessary Services on a Domain Controller",
        "description": "Running additional services on a Domain Controller (DC) alongside identity services (like Active Directory) increases the attack surface of this highly critical component.",
        "impact": "If this risk is exploited, an attacker could gain control over the central identity and authentication system, leading to a complete loss of confidentiality, integrity, and availability for all connected systems and data. This constitutes a catastrophic security incident.",
        "action": "Isolate Domain Controller Services",
        "mitigation": "Domain Controllers must be treated as highly sensitive, dedicated systems. Do not install any software or services that are not essential for the functioning of the directory service itself.",
        "check": "Review all technical assets modeled as `IdentityStoreLDAP`. Are they located in a `SharedRuntime` that contains other, non-identity-related technical assets? If so, this risk is present.",
        "asvs": "Derived from the BSI IT-Grundschutz Compendium, Baustein DIR.1: Directory Services, specifically the principle of minimizing the attack surface of critical infrastructure.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DIR_1_Directory_services_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule iterates through all `SharedRuntime` components in the model. It flags any runtime that contains a technical asset of technology `IdentityStoreLDAP` (representing a DC) alongside any other non-identity-related technical assets.",
        "riskAssessment": "The impact of compromising a Domain Controller is consistently rated as `VeryHigh`. The likelihood of exploitation is elevated by the presence of any additional service, as each one introduces its own set of potential vulnerabilities.",
        "falsePositives": "The rule might trigger a false positive if a service that is essential for the operation or monitoring of the directory service (e.g., a specific, hardened security agent) is modeled as a separate technical asset within the same runtime. These cases should be reviewed and can be accepted with proper justification.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec5.ts",
        "bsiCode": "APP.2.2",
        "id": "excessive-rights-delegation",
        "title": "Excessive Rights Delegation Due to Unsystematic Planning (BSI-based)",
        "description": "If the creation of organization-specific groups and the delegation of rights to these groups or individual user objects are not systematically planned and implemented, the delegation becomes difficult to control. This can grant far more access than intended, which may be abused by third parties. A lack of regular auditing of access rights for groups and individual user objects can further exacerbate the problem. Similarly, when standard, highly privileged groups (e.g., 'Account Operators') are used to delegate permissions to other roles (e.g., helpdesk staff), more rights are typically granted than are actually required, violating the Principle of Least Privilege.",
        "impact": "Granting excessive permissions violates the Principle of Least Privilege. This can lead to unauthorized access, data tampering, information disclosure, or elevation of privilege by malicious actors or through accidental misuse by legitimate users. This directly threatens the Confidentiality, Integrity, and Availability of all assets managed by the compromised identity system.",
        "action": "Implement systematic access control and regular auditing",
        "mitigation": "Establish a formal process for requesting, approving, and granting access rights based on the Principle of Least Privilege. Avoid delegating permissions from broad, powerful standard groups (like 'Account Operators'). Instead, create fine-grained custom roles and groups with the minimum necessary permissions. Regularly audit and recertify all access rights to ensure they are still required and appropriate for the given role.",
        "check": "Is there a documented process for access rights management? Are access rights reviewed periodically (recertification)? Is the use of overly permissive standard groups for delegation avoided? Are roles and permissions based on the 'need-to-know' and 'need-to-do' principles?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Identity and access management), particularly requirements like ORP.4.A5 (Requesting authorizations), ORP.4.A6 (Granting authorizations), and ORP.4.A19 (Recertification of authorizations).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is detected by identifying core identity management assets (like Identity Providers, LDAP Servers, or Identity Stores) and checking for incoming communication from assets associated with roles that typically should not have broad administrative rights, such as 'helpdesk' or 'account-operator'. Such a connection implies a delegation of permissions that may be overly permissive.",
        "riskAssessment": "The likelihood is considered high if IAM components are managed by roles like 'helpdesk' without specific fine-grained controls, as this pattern is inherently risky. The impact is determined by the criticality of the identity management asset itself. If the IAM system controls access to mission-critical or strictly confidential assets, the potential impact is very high, as its compromise could lead to a widespread system breach.",
        "falsePositives": "The model cannot distinguish between a properly configured, least-privilege delegation and an overly permissive one. This risk flags a potentially dangerous architectural pattern. Confirmation requires a manual audit of the actual permissions configured in the target identity management system.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec6.ts",
        "bsiCode": "APP.2.2",
        "id": "legacy-authentication-in-ad-ds",
        "title": "Insecure Legacy Authentication in AD DS",
        "description": "Legacy authentication mechanisms in Active Directory Domain Services (AD DS), such as LAN Manager (LM) and NT LAN Manager (NTLM) v1, are insecure. Attackers can exploit them under certain conditions to gain and misuse privileges without knowing the plaintext passwords, potentially leading to the compromise of parts of the domain, the entire domain, or even the AD forest.",
        "impact": "Successful exploitation can lead to a full compromise of the Active Directory domain, granting attackers high-level privileges. This enables them to access, modify, or delete sensitive data, create rogue accounts, and disable security controls across the entire network infrastructure connected to Active Directory.",
        "action": "Disable legacy authentication protocols",
        "mitigation": "Configure Active Directory and all connected systems to reject insecure legacy authentication protocols such as LM and NTLMv1. Enforce the use of modern, secure protocols like Kerberos or NTLMv2. Manage this via Group Policy Objects (GPOs) applied to domain controllers and member servers and workstations. Audit logs should be monitored for legacy authentication attempts.",
        "check": "Are Group Policies in place to explicitly block LM and NTLMv1 authentication? Are audit logs reviewed for legacy authentication attempts? Have all clients and services been verified to support modern authentication protocols?",
        "asvs": "BSI IT-Grundschutz APP.2.2.A9 (Protection of authentication when using AD DS)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_2_2_Active_Directory_Domain_Controller_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for technical assets representing Active Directory Domain Services (e.g., technologies `identity-store-ldap`, `ldap-server`) that are explicitly tagged as using legacy authentication (e.g., via the `@LegacyAuth:used` tag).",
        "riskAssessment": "The likelihood of exploitation is high, as well-known tools exist to perform pass-the-hash and other related attacks against these weak protocols. The impact is considered very high as it can lead to a full domain compromise, which typically means a complete compromise of the entire IT infrastructure.",
        "falsePositives": "The risk might be a false positive if compensating controls (like strict network segmentation and monitoring) are in place that effectively prevent exploitation, though disabling the protocols is the recommended primary mitigation. The risk is directly dependent on the accuracy of the `@LegacyAuth:used` tag.",
        "cwe": "326",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec7.ts",
        "bsiCode": "APP.2.2",
        "id": "excessive-privileges-for-service-accounts",
        "title": "Excessive Privileges for Service Accounts (based on BSI APP.2.2)",
        "description": "Application service accounts are sometimes granted the rights of highly privileged groups (e.g., Domain Administrators) for ease of deployment or testing, even though significantly fewer rights are needed for normal operation. A significant risk arises if these service accounts use weak passwords or if their credentials are compromised. Even accounts not directly in a privileged group can be assigned extensive administrative permissions across many systems, granting similarly powerful rights. Attackers can abuse these over-privileged accounts to move laterally within the IT environment and escalate their privileges.",
        "impact": "Compromise of an over-privileged service account allows an attacker to gain extensive control over connected systems. This can be used for lateral movement, accessing or tampering with critical data, deploying ransomware, or achieving a full domain compromise, leading to severe impacts on Confidentiality, Integrity, and Availability.",
        "action": "Apply the principle of least privilege (PoLP) to all service accounts",
        "mitigation": "Ensure that all service accounts run with the minimum set of permissions necessary for their function. Avoid using Domain Administrator or equivalent high-privilege accounts for application services. Instead, create dedicated, unprivileged accounts for each service. Credentials for these accounts should be strong, unique, and managed securely, preferably through an automated vault or secrets management solution. Regularly audit the permissions of all service accounts.",
        "check": "Are any service accounts members of highly privileged groups like 'Domain Admins' or 'Enterprise Admins'? Do service accounts have administrative rights on systems where they are not required? Has the principle of least privilege been applied to all service account configurations?",
        "asvs": "BSI IT-Grundschutz APP.2.2 Active Directory Domain Services; OWASP Top 10 2021: A04: Insecure Design (Principle of Least Privilege)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_2_Active_Directory_Domain_Services_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers when a technical asset uses a 'technical-user' authentication for an outgoing communication link, AND the asset itself is tagged as having high privileges (e.g., '@Privilege:DomainAdmin'). This indicates a powerful account is being used for a service, violating the principle of least privilege.",
        "riskAssessment": "The impact is determined by the sensitivity of the target asset that can be accessed with the high privileges. If the target stores or processes 'Strictly Confidential' or 'Mission-Critical' data, the impact is very high. The likelihood is considered 'Likely' if password-based credentials are used, as these are more susceptible to compromise than certificate- or token-based authentication.",
        "falsePositives": "Can occur if the high privilege level is documented, formally accepted as a risk, and absolutely necessary for the service's core function. However, such cases should be extremely rare and are generally considered poor security architecture.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec8.ts",
        "bsiCode": "APP.2.2",
        "id": "reuse-of-local-credentials-on-shared-runtime",
        "title": "Reuse of Local Credentials Across Multiple Systems (BSI-Style)",
        "description": "Even when an IT system is joined to a domain, local accounts can still be used for sign-in. If identical local credentials—especially for built-in administrator accounts—are used on multiple IT systems (e.g., due to a common base image or deployment script), compromising one system enables an attacker to sign in to the others with the same credentials.",
        "impact": "This greatly facilitates lateral movement, allowing an attacker to spread throughout the infrastructure. It significantly increases the risk that an attacker will find and misuse highly privileged domain credentials on one of the systems, potentially leading to the compromise of the entire domain and its parent forest.",
        "action": "Ensure Unique Local Administrator Passwords",
        "mitigation": "Use a centralized solution such as Microsoft LAPS (Local Administrator Password Solution) to automatically manage and randomize local administrator passwords on all domain-joined systems. Avoid reusing any local account password across systems. Disable or rename the built-in local Administrator account where possible and restrict its ability to sign in remotely. If this is implemented, tag the relevant 'Shared Runtime' with 'laps-managed'.",
        "check": "Are local administrator passwords unique on each system? Is a tool such as LAPS deployed and configured correctly? Is there monitoring for sign-in events using local administrator accounts?",
        "asvs": "BSI IT-Grundschutz: APP.2.2 Active Directory Domain Services; SYS.1.2.2 Windows Client Hardening. MITRE ATT&CK T1078 (Valid Accounts) & T1550.002 (Use Alternate Authentication Material: Pass the Hash).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/IT-Grundschutz-Kompendium/bausteine/SYS/SYS_1_2_2_Windows_10_und_11_Edition_2023.html",
        "detectionLogic": "This risk is generated for any 'Shared Runtime' that contains multiple technical assets of types where local administrator accounts are common (e.g., desktops, servers). The assumption is that assets within a shared runtime (such as a common server image or desktop build) are at high risk of having identical local credentials, enabling lateral movement. The risk is raised if the assets reside within a common network trust boundary and the shared runtime is not tagged as 'laps-managed'.",
        "riskAssessment": "Likelihood is considered 'Very Likely' if multiple systems share a runtime without mitigation. The impact is calculated based on the highest confidentiality, integrity, and availability of all assets within that shared runtime, as a compromise of one can lead to a compromise of all.",
        "falsePositives": "A false positive may occur if the systems within the shared runtime are confirmed to have unique local credentials despite being part of a common build process. To suppress this finding, tag the 'Shared Runtime' with 'laps-managed'.",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "5_sec9.ts",
        "bsiCode": "APP.2.2",
        "id": "insecure-password-storage-in-ad-ds",
        "title": "Insecure Password Storage in Active Directory Domain Services (AD DS)",
        "description": "Active Directory Domain Services (AD DS) stores password representations for legacy compatibility (NTLM) using a weak, unsalted MD4 hash function.",
        "impact": "Successful exploitation allows an attacker to compromise user and service accounts. This can lead to widespread unauthorized access, elevation of privilege up to Domain Admin, data breaches, and a complete compromise of the Windows domain and all connected systems.",
        "action": "Harden Domain Controllers and Password Security",
        "mitigation": "Strictly limit and monitor administrative access to all Domain Controllers (DCs). Implement strong physical and network security controls for DCs.",
        "check": "Are Domain Controllers treated as the highest-value assets with maximum security controls? Is administrative access (especially Domain Admins) tightly controlled, minimized, and monitored?",
        "asvs": "BSI TR-02102-1 (Cryptographic Mechanisms: Recommendations and Key Lengths); BSI IT-Grundschutz APP.2.2 (Active Directory Domain Services)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/TechGuidelines/TR02102/BSI-TR-02102-1.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any 'datastore' asset identified as an 'identity-store-ldap' technology, which typically represents an Active Directory Domain Controller.",
        "riskAssessment": "The likelihood of exploitation is considered 'likely' if an attacker gains administrative access to a Domain Controller, as the vulnerability is inherent to AD DS and tools to extract hashes are widely available.",
        "falsePositives": "A technical asset might be incorrectly identified as a writable AD DS domain controller. The risk might be considered mitigated by compensating controls (like advanced threat detection and access control) that are not visible in the model.",
        "cwe": "328",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "NET.2.2": [
      {
        "file": "60_sec1.ts",
        "bsiCode": "NET.2.2",
        "id": "improper-@Network:WLAN-usage",
        "title": "Improper @Network:WLAN Usage by Users (based on BSI)",
        "description": "If users are not sufficiently aware of the rules for the correct use of WLANs, they cannot adhere to them.",
        "impact": "Connecting to untrusted networks without proper safeguards can lead to eavesdropping on sensitive data, man-in-the-middle attacks,",
        "action": "Enforce Encrypted Communication and User Awareness",
        "mitigation": "All communication from client devices should enforce transport-level encryption (e.g., TLS).",
        "check": "Are all communication links from client devices encrypted by default? Is there a policy requiring VPN use on untrusted networks?",
        "asvs": "V6.2.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for client systems (e.g., mobile apps, browsers, desktop clients) that are exposed to the internet",
        "riskAssessment": "The impact is directly related to the confidentiality and integrity requirements of the data assets being transmitted.",
        "falsePositives": "This risk might be a false positive if the 'unencrypted' communication happens within a protected tunnel (like a VPN)",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "60_sec2.ts",
        "bsiCode": "NET.2.2",
        "id": "negligent-disregard-of-security-measures",
        "title": "Negligent Disregard for Security Measures (BSI style)",
        "description": "Due to negligence and a lack of controls, individuals sometimes do not implement, or only partially implement, recommended or mandated security measures. This can lead to bypassing security controls and creating vulnerabilities.",
        "impact": "If security policies are disregarded on client devices, it can lead to severe security incidents. For example, using a client in an unauthorized ad-hoc Wi-Fi mode could allow attackers to directly connect to the device, bypassing network firewalls. This could lead to unauthorized access to confidential data, malware injection, or system tampering, compromising the Confidentiality, Integrity, and Availability of the asset and any data it can access.",
        "action": "Enforce Security Policies via Technical Controls",
        "mitigation": "Ensure security policies are not only defined but also enforced through technical controls where possible (e.g., disabling ad-hoc Wi-Fi, USB port access, or unauthorized software installation via endpoint management solutions like MDM or GPO). Implement regular automated compliance checks and audits to verify that configurations align with policies. Use monitoring and endpoint detection and response (EDR) solutions to detect and alert on policy violations in real-time. Foster a security culture where compliance is understood and valued.",
        "check": "Are security policies for client devices technically enforced? Are there regular compliance audits? Is there monitoring for policy violations? Does the organization have a process to actively address non-compliance on endpoints?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Conformity), specifically requirement ORP.2.A5 'Review of compliance with information security'. The described threat results from a failure to ensure and verify compliance.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Conformity_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for in-scope client-type technical assets (e.g., desktops, mobile apps, IoT devices) that handle sensitive data (Restricted/Important or higher). Such devices are prone to user-induced misconfigurations if not strictly controlled, allowing security measures to be bypassed.",
        "riskAssessment": "The likelihood is considered 'Likely' for client devices, assuming a baseline level of user freedom and the potential for negligence. The impact is calculated based on the highest Confidentiality, Integrity, and Availability ratings of the client asset and the data it processes or stores. A breach of a client handling mission-critical data will have a high impact.",
        "falsePositives": "This risk might be a false positive if the organization has strong, centrally managed endpoint security controls (e.g., MDM, EDR, mandatory GPOs) that prevent users from altering security-critical settings, even if this is not explicitly modeled with a specific tag.",
        "cwe": "732",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "60_sec3.ts",
        "bsiCode": "NET.2.2",
        "id": "unencrypted-@Network:WLAN-communication-net-2-2",
        "title": "Unencrypted Communication over Wireless Networks (BSI NET.2.2)",
        "description": "Wireless networks (@Network:WLAN) are a shared medium, making it easy for unauthorized parties to intercept and record data traffic.",
        "impact": "Eavesdropping on unencrypted wireless communication can lead to the compromise of sensitive information, including credentials, personal data, and business secrets.",
        "action": "Enforce strong encryption on all wireless communication",
        "mitigation": "Ensure that all wireless communication links use protocols that provide strong, end-to-end encryption (e.g., HTTPS, WSS, SSH, any protocol using TLS).",
        "check": "Review all communication links tagged as '@Network:WLAN'. Verify that the protocol used for each link is an encrypted one (e.g., HTTPS, not HTTP).",
        "asvs": "V4.0.3-9.1.1 (Verify that all communication to or between components containing sensitive data is encrypted in transit)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for any communication link that is explicitly tagged as '@Network:WLAN' and uses a protocol that is not recognized as encrypted.",
        "riskAssessment": "The likelihood of an attacker eavesdropping on an unencrypted wireless network is considered very high.",
        "falsePositives": "A communication link might be mis-tagged as '@Network:WLAN'.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "60_sec4.ts",
        "bsiCode": "NET.2.2",
        "id": "mac-address-tracking-over-wlan",
        "title": "Movement Profile Creation via MAC Address Tracking over WLAN",
        "description": "In IEEE 802.11-based WLANs, the MAC address of a device is transmitted with every data frame. Since this address is sent unencrypted at Layer 2, it allows attackers on the same network to capture it. This can be used to create movement profiles of mobile users, for example, when they connect to various public hotspots. This risk is derived from BSI IT-Grundschutz concepts regarding WLAN security.",
        "impact": "An attacker can track the physical presence and movement of users across different locations where they use WLAN, leading to a significant loss of privacy. This can expose patterns of life (home, work, travel), which could be used for social engineering, stalking, or other malicious activities. This compromises the confidentiality of the user's location data, which is often considered sensitive personal information.",
        "action": "Enforce MAC Address Randomization on Client Devices",
        "mitigation": "For all mobile client assets (laptops, mobile phones, etc.), ensure the operating system's MAC address randomization feature is enabled and active, especially for non-trusted networks. For corporate-managed devices, this can be enforced via Mobile Device Management (MDM) policies. For Bring-Your-Own-Device (BYOD) scenarios, it is crucial to educate users on the risks and provide clear instructions on how to enable this privacy-enhancing feature. Note that while application-level encryption (TLS) is essential for protecting data content, it does not mitigate this specific Layer 2 identifier leakage.",
        "check": "Are client devices that connect to external or public networks configured to use MAC address randomization? Is there an enforceable policy (e.g., via MDM) or a user education program in place to ensure this setting is active?",
        "asvs": "This is a Layer 2 network protocol issue not directly covered by OWASP ASVS or MASVS, which focus on higher application layers. However, it relates to the broader principle of protecting data in transit. The most relevant BSI context is NET.2.2 WLAN usage, with related guidance in NET.2.1 WLAN operation and SYS.3.2 Mobile Device Management.",
        "cheatSheet": "https://www.wi-fi.org/download.php?file=/sites/default/files/private/Wi-Fi_Alliance_Device_MAC_Address_Randomization_Readiness_and_Best_Practices_202206.pdf",
        "detectionLogic": "This risk is raised for any technical asset identified as a client-type device (e.g., technology 'mobile-app', 'desktop', 'browser', 'IoT device') that has a communication link to an internet-facing asset or a link that crosses a trust boundary. The assumption is that such communication may traverse untrusted WLANs where its MAC address can be sniffed by third parties.",
        "riskAssessment": "The likelihood is considered 'Likely' as connecting to various Wi-Fi networks is a standard use case for mobile devices. The impact is rated as 'Medium' because it constitutes a significant privacy violation, even if it doesn't directly compromise data assets stored within the application. The severity is therefore typically 'Elevated'.",
        "falsePositives": "This risk can be considered a false positive if it can be confirmed that the client device will exclusively use trusted networks (e.g., cellular data, or a corporate network with mandatory VPN) and will never connect to third-party or public WLANs. It can also be mitigated if MAC randomization is verifiably enforced on the device.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "60_sec5.ts",
        "bsiCode": "NET.2.2",
        "id": "rogue-access-point",
        "title": "Rogue Access Point (BSI NET.2.2)",
        "description": "Attackers can impersonate part of a wireless network infrastructure by installing their own access point (AP) with a suitably chosen @Network:WLAN name (SSID) in the vicinity of a @Network:WLAN client. This fake AP is called a 'Rogue Access Point'. If this rogue AP offers the @Network:WLAN client a stronger signal than the legitimate AP, the client will use it as its base station, especially if mutual authentication is not performed. Additionally, the legitimate AP could be taken down by a Denial-of-Service attack to force the connection. As a result, users connect to a network that only pretends to be the target network, allowing attackers to eavesdrop on and control the communication. This is a common attack vector in public wireless networks (hotspots).",
        "impact": "If clients connect to a rogue access point, an attacker can intercept, read, and modify all transmitted data (Man-in-the-Middle). This can lead to the compromise of credentials, session tokens, and sensitive data, thus violating confidentiality and integrity. The attacker could also redirect the user to malicious sites or block access to legitimate services, affecting availability.",
        "action": "Enforce Strong Mutual Authentication and Use of Encrypted Tunnels (VPN)",
        "mitigation": "Use strong enterprise-grade authentication for wireless networks, such as WPA2/WPA3-Enterprise with 802.1X, which enables mutual authentication via client and server certificates. Configure client devices to not automatically connect to unknown or open Wi-Fi networks and to only trust specific, secured SSIDs. For all connections over untrusted or public networks, all traffic should be routed through a trusted VPN tunnel. Educate users about the risks of connecting to untrusted public Wi-Fi.",
        "check": "Is mutual authentication (e.g., via client certificates) enforced for the communication link? Does the client device connect to potentially untrusted networks (e.g., public hotspots)? Is a VPN used to protect the data in transit?",
        "asvs": "BSI IT-Grundschutz NET.2.2 WLAN Usage",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_WLAN_usage_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for client assets (e.g., mobile apps, desktop clients, IoT devices) that communicate over a network link without strong mutual authentication (i.e., not using client certificates). The risk is considered higher if the client is explicitly modeled to be in a public environment, connected to the internet, or is a mobile-type technology. The use of a VPN is considered a full mitigation for the data-in-transit aspect of this risk.",
        "riskAssessment": "The likelihood is high if a client asset connects over a network without strong mutual authentication like client certificates. The likelihood increases if the client is mobile or explicitly placed in an untrusted environment (like the internet or tagged as using public Wi-Fi). The impact is determined by the highest confidentiality and integrity of the data assets transmitted over the vulnerable link.",
        "falsePositives": "This risk might be a false positive if the modeled communication path, while lacking client-certificate authentication, is known to operate exclusively over a physically secured, private, wired network where the threat of a rogue AP is negligible. The model itself does not distinguish between wired and wireless connections, so this risk highlights a potential weakness in any non-local communication channel that isn't strongly authenticated.",
        "cwe": "290",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Spoofing"
      }
    ],
    "NET.3.1": [
      {
        "file": "61_sec1.ts",
        "bsiCode": "NET.3.1",
        "id": "unclear-it-administration-responsibilities",
        "title": "Unclear IT Administration Responsibilities",
        "description": "The administration of IT systems involves diverse tasks across various components and domains.",
        "impact": "A lack of clearly defined administrative responsibilities can directly endanger all three protection goals of information security.",
        "action": "Clearly Define and Document Administrator Roles and Responsibilities",
        "mitigation": "Establish a comprehensive concept for the administration of IT systems.",
        "check": "Is there a documented concept for IT administration? Are responsibilities for all administrative tasks clearly assigned?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.2 Administration of IT Systems",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_Operation_of_IT_systems_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified by analyzing the scope and distribution of administrative roles within the model.",
        "riskAssessment": "The impact is determined by the highest confidentiality, integrity, and availability requirements of the assets an administrator can access.",
        "falsePositives": "The model cannot fully understand the organizational context.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "61_sec10.ts",
        "bsiCode": "NET.3.1",
        "id": "human-error-in-administration-g3.3",
        "title": "Human Error in IT Administration (BSI G 3.3)",
        "description": "Human error can never be completely ruled out and may have far-reaching consequences in IT administration. The powerful tools used for administration allow extensive changes to IT components with minimal effort. Depending on the mistake, all information security objectives (confidentiality, integrity, and availability) can be seriously endangered. Errors are particularly likely during multitasking—for example, when different input windows or console outputs are confused—leading to unintended operations on critical systems.",
        "impact": "An administrative error can directly compromise the confidentiality, integrity, or availability of affected IT components. This can cause system outages (denial of service), data corruption or loss (integrity violations), or unauthorized data exposure (confidentiality violations), resulting in significant operational disruption and business damage.",
        "action": "Implement robust change management, automation, and operational procedures",
        "mitigation": "Use the 'four-eyes principle' for critical changes. Implement automated checks, linting, and validation before applying configurations (e.g., via CI/CD pipelines). Use dedicated, isolated administrative workstations. Minimize parallel administrative tasks across different environments. Maintain clear, up-to-date documentation for procedures. Implement comprehensive logging and monitoring to quickly detect and roll back erroneous changes. Provide regular, hands-on training for administrators on tools and emergency procedures.",
        "check": "Is there a formal change-management process? Are critical changes reviewed by a second person (four-eyes principle)? Are administrative actions logged and reviewed? Do administrators use hardened, dedicated environments for their tasks? Are configuration changes deployed through automated, tested pipelines where possible?",
        "asvs": "Derived from BSI IT-Grundschutz threat G 3.3 'Menschliche Fehlhandlung' (human error). Mitigations are described in modules such as OPS.1.1 'General Operation' and ORP.4 'Identity and Access Management'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_operation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This organizational risk is applied to technical assets that are typically managed by administrators and are critical to the system's function. The tool identifies these assets by their technology type (e.g., Database, Application Server, Container Platform, Load Balancer) and/or associated role tags (e.g., `@Role:Administrator`, `@Role:ITSecurityOfficer`). The risk is considered higher for assets involved in development and deployment pipelines, as errors there can propagate widely.",
        "riskAssessment": "The likelihood of an error occurring is high if manual changes are frequent and procedural controls like the four-eyes principle or automated deployment pipelines are absent. The impact is directly related to the CIA rating of the asset and the data it processes or stores. An error on a mission-critical database is far more severe than on a non-production test server.",
        "falsePositives": "The model cannot verify the existence or effectiveness of organizational procedures such as the four-eyes principle, the quality of administrator training, or the robustness of a change-management process. This risk should be validated by reviewing the organization's operational security procedures (OSP).",
        "cwe": "400 // CWE-400: Uncontrolled Resource Consumption (as a likely consequence",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "61_sec11.ts",
        "bsiCode": "NET.3.1",
        "id": "disruption-by-authorized-administration",
        "title": "Disruption by Authorized IT Administration",
        "description": "Even when IT administration activities are performed without errors, they can still disrupt the institution's IT environment.",
        "impact": "Failure to adhere to proper administrative procedures (such as maintenance windows) or unforeseen consequences of administrative changes can directly impact the availability of critical systems and business processes. This can lead to service outages, financial loss, and reduced operational capacity. In some cases, flawed changes can also impact data integrity or hinder future maintenance and recovery efforts.",
        "action": "Establish and Enforce Strict Change Management and Administration Procedures",
        "mitigation": "Implement a formal change management process for all administrative activities. Define, communicate, and enforce strict maintenance windows for production systems.",
        "check": "Is there a formal change management process? Are maintenance windows defined and enforced? Are administrative changes tested before deployment to production? Are there documented rollback procedures?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.5 Administration in accordance with regulations & OPS.1.1.3 Patch and change management",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Administration_according_to_regulations_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for technical assets that are likely subject to frequent and critical administrative tasks. This is determined by identifying assets that:",
        "riskAssessment": "The impact is derived directly from the availability requirement of the technical asset. A 'Mission-Critical' asset failing will have a 'Very High' impact.",
        "falsePositives": "This risk describes a potential failure in an organizational process (change management). A model cannot verify the quality of an organization's operational procedures.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "61_sec2.ts",
        "bsiCode": "NET.3.1",
        "id": "insufficient-documentation-ops1.1.a7",
        "title": "Insufficient Documentation (BSI OPS.1.1.A7)",
        "description": "Documentation may be insufficient if information about IT components (e.g., configurations or access rights) is not recorded or is incomplete.",
        "impact": "Insufficient documentation can lead to misconfigurations or generally flawed IT administration, which can significantly jeopardize all information security objectives (Confidentiality, Integrity, Availability).",
        "action": "Establish and Maintain Comprehensive System Documentation",
        "mitigation": "Implement a formal process for creating and maintaining documentation for all critical IT systems, including configuration details, network diagrams, access control lists, and operational procedures.",
        "check": "Is there a documented process for system documentation? Is the documentation for critical systems complete, accurate, and up-to-date? Is documentation easily accessible to authorized personnel, especially during an emergency?",
        "asvs": "BSI IT-Grundschutz Baustein OPS.1.1.A7 (Documentation of IT Operations)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_IT_operation_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organizational risk is raised for technical assets that are custom-developed (where documentation is often neglected) or have a high availability requirement (where lack of documentation severely impacts incident response and recovery times).",
        "riskAssessment": "The likelihood is considered 'Likely' as insufficient documentation is a very common problem in operations.",
        "falsePositives": "This risk is based on heuristics (custom-developed, high-availability) and might be a false positive if an organization has exceptionally disciplined documentation practices despite these indicators. Verification requires checking the actual documentation processes and quality.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "61_sec3.ts",
        "bsiCode": "NET.3.1",
        "id": "excessive-administrative-permissions-orp4",
        "title": "Excessive Administrative Permissions (BSI ORP.4)",
        "description": "Excessively broad administrative permissions can be exploited for sabotage or information gathering, which can then serve as a starting point for further attacks.",
        "impact": "Abuse of excessive administrative rights or retained access by former administrators can lead to system sabotage, data theft, unauthorized configuration changes, and widespread compromise of the IT landscape, directly impacting Confidentiality, Integrity, and Availability.",
        "action": "Enforce the Principle of Least Privilege (PoLP) and robust identity lifecycle management",
        "mitigation": "Strictly enforce the Principle of Least Privilege for all administrative accounts, granting only the minimum permissions necessary for assigned tasks.",
        "check": "Are administrative permissions reviewed on a regular basis? Is the Principle of Least Privilege demonstrably enforced?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Identity and Access Management), specifically requirements like ORP.4.A6 (Assignment of access rights) and ORP.4.A17 (Protection of privileged accounts).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
        "detectionLogic": "This risk is raised for any technical asset representing an administrative function (identified by '@Role:Administrator' or similar tags).",
        "riskAssessment": "The impact of this risk is directly proportional to the highest confidentiality, integrity, and availability requirements of all assets managed by the administrative component.",
        "falsePositives": "The model correctly identifies an administrative function. A false positive can occur if, in reality, the permissions are already strictly limited according to PoLP and robust offboarding processes are in place. This cannot be verified by the model alone and requires organizational assessment.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "61_sec4.ts",
        "bsiCode": "NET.3.1",
        "id": "insufficiently-secured-administrative-access",
        "title": "Insufficiently Secured Administrative Access",
        "description": "Administrative access points can expose sensitive information, such as system documentation or IT system configurations.",
        "impact": "Beyond the initial loss of confidentiality, compromised administrative access can be used to manipulate systems and data, or to launch further, more extensive attacks,",
        "action": "Secure Administrative Access Channels",
        "mitigation": "Ensure that all communication links used for administrative purposes are robustly secured. This includes using strongly encrypted protocols (e.g., HTTPS, SSH, RDP with TLS),",
        "check": "Are all administrative communication links using encrypted protocols? Do they enforce strong authentication (ideally MFA)? Are they protected by network controls like VPNs or IP filters when crossing network boundaries? Is authorization restricted based on the principle of least privilege?",
        "asvs": "Derived from BSI IT-Grundschutz principles. This aligns with OWASP ASVS V2 (Authentication Verification Requirements), especially V2.2.1 (MFA for high-value accounts) and V7 (Access Control).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
        "detectionLogic": "This rule inspects all communication links identified as administrative (either by 'DevOps' usage, or by targeting an asset with administrative technology or roles).",
        "riskAssessment": "The likelihood is determined by the specific weaknesses found; a lack of encryption or authentication is considered very likely to be exploited.",
        "falsePositives": "A link might be considered secure by compensating controls not captured in the model, such as being on a physically isolated and secured network segment.",
        "cwe": "522",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "61_sec5.ts",
        "bsiCode": "NET.3.1",
        "id": "insufficient-redundancy-of-admin-knowledge-bsi",
        "title": "Insufficient Redundancy of Administrator Knowledge (BSI-derived)",
        "description": "If the necessary knowledge for IT administration is not redundantly available among personnel,",
        "impact": "The primary impact is on the availability of IT systems, as failures cannot be addressed in a timely manner.",
        "action": "Establish and document substitution rules for administrators; verify substitutes can act without the primary admin.",
        "mitigation": "Define and document clear substitution rules for all administrative roles. Ensure that designated substitutes",
        "check": "Are primary and substitute administrators defined for all critical systems (esp. routers/switches)? Is there up-to-date documentation for all administrative procedures?",
        "asvs": "BSI IT-Grundschutz: ORP.2.A5 (Regelungen zur Vertretung), CON.1.A11 (Definition von Vertretungsregeln), NET.3.1.A9 (Betriebsdokumentationen), NET.3.1.A22 (Notfallvorsorge).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile (BSI ORP.2)",
        "detectionLogic": "Raised for any in-scope technical asset tagged with an administrative role (see SupportedTags)",
        "riskAssessment": "Impact is derived from the asset’s availability and integrity requirements: mission-critical implies very-high impact.",
        "falsePositives": "A risk might be flagged as a false positive if robust, organization-wide substitution policies are in place but not explicitly",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "61_sec6.ts",
        "bsiCode": "NET.3.1",
        "id": "staff-shortage-administrators",
        "title": "Staff Shortage Among Administrators (BSI Organizational Threat)",
        "description": "If there is a shortage of administrative personnel, for example due to insufficient personnel planning, overbooking, or a pandemic,",
        "impact": "Both neglected tasks and administrative errors can lead to insufficient availability of IT systems, an increased attack surface, and thus endanger all protection goals of information security (Confidentiality, Integrity, and Availability). This can result in system failures, security breaches, and non-compliance.",
        "action": "Ensure Adequate Staffing, Redundancy, and Training for Administrators",
        "mitigation": "Implement robust personnel and resource planning for IT administration to ensure sufficient staffing levels.",
        "check": "Is there a formal process for personnel resource planning for IT administration? Is there a contingency plan for administrator absence? Are administrators given dedicated time for training and non-urgent maintenance tasks? Are key administrative tasks automated?",
        "asvs": "Derived from BSI IT-Grundschutz CON.1 (Personnel) and related to failures in fulfilling requirements from OPS.1.1 (Server Operation).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Personnel_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This is an organizational risk that is difficult to detect automatically. This rule raises a risk for technical assets that require significant administrative effort, identified by role tags or high criticality.",
        "riskAssessment": "The likelihood is considered 'Likely' by default, as administrative staff shortages are a common organizational challenge.",
        "falsePositives": "The model cannot know the actual staffing levels of the organization. This risk is raised to prompt a manual review of administrative capacity. It can be considered a false positive if the organization can demonstrate adequate staffing, contingency planning, and high levels of automation for the identified asset.",
        "cwe": "732",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "61_sec7.ts",
        "bsiCode": "NET.3.1",
        "id": "inadequately-secured-admin-tools-bsi",
        "title": "Inadequately Secured Administration Tools (BSI)",
        "description": "Administration tools grant extensive access to an institution's IT systems. If these tools are not adequately secured and isolated, they can be compromised. This can lead to the sabotage of IT administration or enable unauthorized administrative access. A common cause of this vulnerability is insufficient separation of administrative tools and environments from general-use applications and networks (e.g., using the same workstation for system administration and for browsing the internet or checking email).",
        "impact": "If an attacker gains access to an inadequately secured administration tool or workstation, they can obtain far-reaching privileges. These privileges can be abused for various attacks, compromising the Confidentiality, Integrity, and Availability of all administered systems. This can lead to data breaches, system-wide compromise, and significant disruption of business operations.",
        "action": "Isolate Administrative Environments",
        "mitigation": "Ensure a strict separation between administrative and non-administrative environments. Use dedicated and hardened administrative workstations (Privileged Access Workstations - PAWs) or secure virtual environments for all administrative tasks. These administrative environments must not be used for general activities like email, web browsing, or using office software. Enforce multi-factor authentication, strong access controls, and comprehensive logging for all access to and from administrative tools and workstations.",
        "check": "Are administrative tasks performed from dedicated, hardened systems that are isolated from the general user network? Are the tools used for administration (e.g., SSH clients, RDP clients) also used for non-administrative tasks on the same machine? Is there a policy for Privileged Access Workstations (PAWs)?",
        "asvs": "Derived from BSI IT-Grundschutz principles, such as network separation (NET.1.1) and secure administration (related to SYS.1.2, SYS.1.3). The core concept is the use of a dedicated, hardened environment for privileged access (e.g., a Privileged Access Workstation - PAW). @BSI_ID: SYS.1.6.A5 (example: Secure Administrative Workstation).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_Windows_Server_2016_edition_2021.pdf?__blob=publicationFile&v=2 (Example: BSI Windows Server administration concepts)",
        "detectionLogic": "This rule identifies technical assets that are used for administrative purposes (e.g., using SSH or other DevOps protocols to manage backend systems) while simultaneously being used for general, non-administrative purposes (e.g., being a desktop/browser or having connections to the internet). This lack of separation creates a significant risk.",
        "riskAssessment": "The likelihood of exploitation is considered high, as general-purpose workstations are frequently targeted by malware. The impact is determined by the highest sensitivity (CIA rating) of the systems being administered from the insecure workstation. A compromise of the workstation can lead to a complete compromise of all administered systems.",
        "falsePositives": "A model might show a single 'Developer Desktop' asset for both administrative and general use. In reality, the developer might use a separate, isolated virtual machine (VM) for administrative tasks on that desktop. If this separation is not explicitly modeled, this risk may be flagged based on the available information.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "61_sec8.ts",
        "bsiCode": "NET.3.1",
        "id": "net31-admin-tools-spof",
        "title": "Single Point of Failure in Administration Tools (BSI NET.3.1)",
        "description": "If administrative tools or capabilities fail and there are no redundant systems or alternative",
        "impact": "A lack of redundant or alternative administration paths can cause prolonged outages, hinder incident response, and",
        "action": "Implement redundancy and alternative administration paths (e.g., out-of-band management, emergency console access); document and test failover.",
        "mitigation": "Ensure that critical administration tools are designed for high availability by marking them as 'redundant: true' in the model.",
        "check": "Review the model to identify critical assets. For each, verify that they are managed by at least one administration tool marked as redundant.",
        "asvs": "BSI NET.3.1: A13, A22, A26 (Managementnetz, Notfallvorsorge, Hochverfügbarkeit)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Contingency_planning_for_the_failure_of_an_IT_system_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "The rule treats an 'administration tool' as any asset with usage 'devops' or technologies such as",
        "riskAssessment": "Impact scales with the availability requirement of the managed asset.",
        "falsePositives": "The model may not capture out-of-band or emergency administration procedures that serve as alternatives.",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "61_sec9.ts",
        "bsiCode": "NET.3.1",
        "id": "net-3-1-unprotected-management-channels",
        "title": "Unprotected Router/Switch Management Channel",
        "description": "Management and monitoring channels for routers, switches, and other network/administrative components (e.g., SSH/HTTPS/SNMP) that lack strong authentication and transport encryption can be spoofed or tampered with. Attackers may inject fake alerts/commands or trick administrators into executing changes, leading to unauthorized configuration, traffic redirection, or outages.",
        "impact": "Compromise of device management can enable manipulation of configurations (Tampering), rerouting/blackholing or traffic interception (Information Disclosure), and service disruption up to backbone outage (Denial of Service). In effect, an attacker abuses administrative privileges to impact confidentiality, integrity, and availability across connected systems and network segments.",
        "action": "Harden network device management: prefer out-of-band management, restrict source IPs, require mTLS/SSHv2 with strong keys, disable Telnet/HTTP/SNMPv1, enable ACLs/timeouts, and centralize logging/alerting.",
        "mitigation": "Use mutually authenticated and encrypted management protocols (e.g., SSHv2, HTTPS with client certificates). Limit management access to dedicated networks and allowlisted sources. Disable legacy/unused services and in-band management where possible. Enforce MFA for privileged consoles, log administrative actions, and require four-eyes approval for high-impact changes.",
        "check": "Inspect all incoming links targeting network/administrative assets (routers, switches, monitoring, build/CI, container/IDP, registries). Are the links encrypted (TLS or VPN)? Is authentication strong (no anonymous/basic credentials)? Do links cross trust boundaries or originate from internet-exposed sources? Verify ACLs restricting management access.",
        "asvs": "BSI IT-Grundschutz NET.3.1 (A4 Schutz der Administrationsschnittstellen, A13 Managementnetz, A18 ACLs, A19 Switch-Ports, A21 IAM) and DER.1.A7 (Protokollierung von sicherheitsrelevanten Ereignissen).",
        "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/IT-Grundschutz/Kompendium/kompendium_node.html",
        "detectionLogic": "Treat an asset as a network/administrative target when its technology is administrative (Monitoring, BuildPipeline, ContainerPlatform, IdentityProvider, WAF/IDS/IPS, Vault, Service* components, LoadBalancer/ReverseProxy) or it has tags like '@Device:Router', '@Device:Switch', '@Capability:NetworkManagement', '@Role:NetworkAdministrator'. For each incoming link that crosses a trust boundary, raise the risk if the link uses weak authentication (none/credentials) OR an unencrypted protocol (no TLS and no VPN). Increase likelihood to VeryLikely when the source is internet-exposed or both weaknesses exist. Impact scales with the target’s CIA requirements; multi-tenant and core control planes (e.g., Vault/IdP/ContainerPlatform) are treated as VeryHigh impact. Data-breach scope includes the target and all its direct downstream links.",
        "riskAssessment": "Channels without authentication and encryption are high-risk. Impact is derived from the device’s confidentiality/integrity/availability needs and the blast radius of its role (e.g., routing/identity/control plane). Successful exploitation can enable widespread data exposure and outages.",
        "falsePositives": "May be a false positive if compensating controls not visible in the model exist (e.g., management happens only via a secured jump host or VPN with strong client auth, or strict operational procedures requiring out-of-band verification). Missing model details about authentication can also lead to false flags.",
        "cwe": "841",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "NET.3.2": [
      {
        "file": "62_sec1.ts",
        "bsiCode": "NET.3.2",
        "id": "ddos-on-network-component-net3.2",
        "title": "DDoS on Network Entry Component (Firewall/WAF) — BSI NET.3.2",
        "description": "A Distributed Denial-of-Service (DDoS) attack (e.g., TCP SYN flooding, UDP packet storms) can overwhelm a perimeter component such as a firewall, WAF, reverse proxy, gateway, IPS, or load balancer. Excessive connection setup and packet processing exhausts resources, causing service degradation or outage for systems behind the component.",
        "impact": "Loss of availability for services and assets behind the overloaded entry component; potential outage of entire network segments; disruption of business processes with financial and reputational consequences for critical systems.",
        "action": "Implement and regularly test DDoS resilience for internet-facing network entry points.",
        "mitigation": "Use dedicated DDoS mitigation (e.g., upstream/anycast scrubbing); enable SYN cookies and connection limits; configure UDP/ICMP rate limiting and timeouts; deploy scalable architectures and HA pairs; filter at upstream providers; tune conntrack/state tables; maintain playbooks and monitoring with threshold-based alerts.",
        "check": "Is a DDoS mitigation solution (cloud or provider) in front of internet-facing entry points? Are SYN/UDP rate limits and timeouts configured and tested? Is monitoring in place with alarms and runbooks? Has failover and capacity under stress been validated (e.g., synthetic load or provider test)?",
        "asvs": "BSI IT-Grundschutz: NET.3.2 (Protection against DoS) — notably NET.3.2.A1 (Planning protection), A2 (Firewall rules), A19 (Rate limits/SYN/UDP), A23 (Monitoring).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
        "detectionLogic": "Raise a risk for in-scope TechnicalAssets whose technology is WAF, ReverseProxy, Gateway, IPS, or LoadBalancer and that are internet-facing (either directly via the 'internet' flag or indirectly via an incoming link from an internet-exposed source). Determine impact using the highest availability requirement among targets of the component’s outgoing links; if none exist, fall back to the component’s own availability. Attach the component’s trust boundary as context and ignore out-of-scope assets.",
        "riskAssessment": "Likelihood is Very Likely for public-facing entry components due to the prevalence of volumetric and protocol DDoS. Impact scales with the highest availability of protected services: Operational→Medium, Important/Critical→High, Mission-Critical→Very-High; the component’s own high availability rating can raise impact.",
        "falsePositives": "Possible false positive if a robust, dedicated third-party DDoS mitigation/scrubbing service is deployed in front of the component and modeled separately, or if capacity is significantly over-provisioned and validated by regular tests. Also possible if the asset is not actually reachable from the internet in the deployed topology.",
        "cwe": "770",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "62_sec2.ts",
        "bsiCode": "NET.3.2",
        "id": "unauthorized-firewall-access",
        "title": "Unauthorized Access to Firewall or Gateway",
        "description": "If an attacker gains unauthorized access to a network security component such as a firewall, gateway, or load balancer—or to its management interface—they can manipulate its files and configuration.",
        "impact": "A successful attack can lead to a complete compromise of the protected network segments. Attackers could bypass security controls to access internal systems, exfiltrate sensitive data, or launch Denial-of-Service (DoS) attacks by blocking legitimate traffic. This compromises the Confidentiality, Integrity, and Availability of all assets behind the security component.",
        "action": "Secure Administrative Access to Network Security Components",
        "mitigation": "Restrict access to management interfaces using dedicated, secured networks (e.g., management VLANs) and jump hosts. Enforce strong, multi-factor authentication (MFA) for all administrative access. Use encrypted protocols (e.g., SSH, HTTPS) for all management communication. Apply the principle of least privilege for administrative roles. Regularly audit configurations, rule sets, and access logs for unauthorized changes or suspicious activity. Keep the component's firmware/software patched and hardened by disabling unnecessary services.",
        "check": "Is administrative access to the component logged and monitored? Is strong MFA required for all administrative users? Are management interfaces isolated from general network traffic? Are all management connections encrypted?",
        "asvs": "BSI IT-Grundschutz NET.3.2 Firewall",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_1_Firewall_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers for network security components (such as firewalls, gateways, WAFs, reverse proxies, load balancers) that have weakly protected or unencrypted administrative communication links. It also flags components where no administrative link is modeled at all, as this represents a potential blind spot.",
        "riskAssessment": "The impact is rated High or Very High, as compromising such a component affects all the assets it protects. The likelihood depends on the security of the management interface. An unauthenticated or unencrypted interface exposed to untrusted networks poses a Very Likely risk. An interface with only basic password authentication is rated Likely. If no management interface is modeled, the risk is assumed to be present.",
        "falsePositives": "The model might not fully represent all access control mechanisms like jump hosts or out-of-band management, which could lead to a false positive. The risk might be accepted if compensating controls are in place and documented.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "62_sec3.ts",
        "bsiCode": "NET.3.2",
        "id": "firewall-bypass-via-protocol-manipulation",
        "title": "Firewall Bypass via Network Protocol Manipulation (BSI NET.3.2)",
        "description": "Attackers can exploit fundamental mechanisms within network protocols (e.g., fragmentation attacks)",
        "impact": "A successful bypass of firewall rules grants an attacker unauthorized access to a protected network segment.",
        "action": "Harden firewall and network segmentation rules",
        "mitigation": "Ensure that firewalls are stateful and properly configured to handle protocol anomalies like fragmented packets.",
        "check": "Are firewalls stateful and configured to reassemble fragmented packets before analysis? Is there a regular",
        "asvs": "Derived from BSI IT-Grundschutz Baustein NET.3.2 'Firewall'. This threat corresponds to the potential for",
        "cheatSheet": "https://www.owasp.org/index.php/Testing_for_Firewall_(OWASP-CM-008)",
        "detectionLogic": "This risk is triggered for every communication link that crosses a network-based trust boundary.",
        "riskAssessment": "The likelihood of exploitation is elevated for connections originating from the internet. The impact is calculated",
        "falsePositives": "This risk might be a false positive if the firewall in place is a sophisticated Next-Generation Firewall (NGFW) or",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "62_sec4.ts",
        "bsiCode": "NET.3.2",
        "id": "misconfigured-firewall",
        "title": "Misconfigured Firewall (BSI-based)",
        "description": "An incorrectly configured or operated firewall can seriously impact the availability of services. If firewall rules are set incorrectly, for example, network access can be blocked. Furthermore, faulty configurations can lead to IT systems no longer being fully protected or not protected at all. In the worst case, this makes internal services accessible to attackers.",
        "impact": "A misconfigured firewall can lead to either denial-of-service for legitimate users (if rules are too strict) or unauthorized access to internal systems (if rules are too lenient). This can compromise the Confidentiality, Integrity, and Availability (CIA) of the protected assets, potentially leading to data breaches, service disruption, and unauthorized system control.",
        "action": "Review and Harden Firewall Configuration",
        "mitigation": "Ensure all firewall, WAF, and reverse proxy components have a documented, reviewed, and hardened configuration. Implement a strict change management process for firewall rules. Regularly audit the rule set to remove obsolete or overly permissive rules. Employ a 'default-deny' policy. Use automated tools to scan for configuration weaknesses.",
        "check": "Is there a documented configuration standard for firewalls/WAFs? Is there a formal change review process for firewall rules? Are the rules audited regularly? Are there any 'allow any/any' rules connecting different trust zones?",
        "asvs": "BSI IT-Grundschutz NET.3.2 Firewall",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_2_Firewall_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any technical asset identified as a network security control point, such as a WAF, Reverse Proxy, Gateway, IDS, or IPS. The risk is generic as the model cannot verify the actual configuration. The severity increases based on the sensitivity of the assets it protects.",
        "riskAssessment": "The likelihood is considered 'Likely' due to the complexity and criticality of firewall configurations, where small errors can have large consequences. The impact is calculated based on the highest CIA requirements of the technical assets directly communicating with the firewall component. If a firewall protects mission-critical assets, the impact is very high.",
        "falsePositives": "This is a generic risk based on the presence of a firewall-like component. It may be a false positive if the component's configuration is indeed hardened, regularly audited, and managed under a strict, proven process. This must be verified manually.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "NET.3.3": [
      {
        "file": "63_sec1.ts",
        "bsiCode": "NET.3.3",
        "id": "unregulated-it-administration-ism2.2",
        "title": "Insufficient Regulation of IT Administration Responsibilities (BSI-based)",
        "description": "IT administration involves diverse tasks across various components. If responsibilities and processes are not clearly regulated or are unknown to the personnel in charge, significant security gaps can arise. Necessary administrative tasks might be neglected, performed by unauthorized personnel lacking full context, or conflicting measures might be taken by different teams. This is particularly critical when roles such as application operations and system operations are not clearly separated, despite being interconnected.",
        "impact": "A lack of clear administrative regulations can lead to a loss of control, potentially compromising all three security goals. Systems may become partially or completely unavailable (Denial of Service). Administrators with excessive or ill-defined permissions might access confidential information beyond their need-to-know basis (Information Disclosure). The overall integrity of systems can be threatened, leading to a general loss of control over the IT landscape.",
        "action": "Establish and Enforce Clear IT Administration Roles, Responsibilities, and Processes",
        "mitigation": "Clearly define and document all IT administration responsibilities and associated processes. Assign specific roles for distinct administrative domains (e.g., application, system, database, network). Enforce the principle of least privilege, ensuring administrators only have the rights essential for their tasks. Avoid using shared administrative accounts. Implement a formal process for granting and revoking administrative privileges. Ensure all administrators are aware of and trained on these regulations.",
        "check": "Are administrative roles and responsibilities clearly documented? Is there a separation of duties between different administrative domains? Is the principle of least privilege enforced for all administrative accounts? Are there multiple, distinct administrative access paths to a single critical component?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Identity and Access Management), particularly requirements concerning the principle of least privilege for administrators (ORP.4.A5) and segregation of duties (ORP.4.A6).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
        "detectionLogic": "This risk is identified by detecting technical assets, especially critical backend systems, that are accessible by multiple distinct administrative sources. An 'administrative source' can be an asset tagged with an administrator role or a component used for DevOps purposes. A high number of such sources accessing a single asset suggests a potential lack of regulated responsibilities and increases the attack surface.",
        "riskAssessment": "The likelihood increases with the number of administrative access paths to a single asset. The impact is determined by the confidentiality, integrity, and availability requirements of the targeted asset. A mission-critical database accessed by numerous administrators poses a very high impact.",
        "falsePositives": "The model cannot verify the existence or enforcement of organizational policies. Multiple administrative access paths might be legitimate, necessary, and well documented. This risk should be validated by reviewing the organization's identity and access management policies for administrators.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "63_sec10.ts",
        "bsiCode": "NET.3.3",
        "id": "vpn-planning-configuration-operation",
        "title": "VPN Planning, Configuration & Operation Weakness (BSI NET.3.3)",
        "description": "VPNs protect sensitive data across untrusted networks using cryptography and mutual authentication. If planning, selection, configuration, or operation is weak, the VPN can become a high-impact entry point into the institutional network. Typical causes include missing requirement analysis, insecure defaults on VPN endpoints, poorly configured remote-access clients, unverified service providers, and insufficient monitoring or access review. Remote users connecting from unmanaged or insecure devices further increase exposure.",
        "impact": "A flawed VPN can enable unauthorized access into internal networks, exposing Confidentiality (e.g., data exfiltration), Integrity (e.g., manipulation via tunneled access), and Availability (e.g., outages through misrouting or DoS amplification). Cascading compromise of many connected systems is possible.",
        "action": "Plan, harden, and continuously monitor VPN endpoints and access.",
        "mitigation": "Implement: 1) Formal VPN plan with clear responsibilities, user groups, and rights (A1). 2) Evaluate and contract providers with SLAs and verify compliance (A2). 3) Secure installation by qualified staff with pre-go-live testing (A3). 4) Baseline hardened configurations and periodic reviews (A4). 5) Disable stale VPN accounts/tunnels promptly; restrict access to business hours (A5). 6) Requirements analysis covering processes, access paths, users, auth, and responsibilities (A6). 7) Technical design for crypto suites, endpoints, allowed protocols/services, and reachable subnets (A7). 8) VPN security policy, training, and user handouts (A8). 9) Fit-for-purpose product selection (A9). 10) Operating concept including QA, monitoring, maintenance, training, and authorization (A10). 11) Allow tunnels only between intended systems/services using suitable protocols (A11). 12) Centralized account and access management for remote-access VPNs (A12). 13) Integrate VPN components with the firewall and document the setup (A13).",
        "check": "Is there a documented VPN plan and operating concept? Are provider SLAs monitored? Are endpoint/client configurations hardened and periodically reviewed? Are unused accounts/tunnels disabled promptly and access time-boxed? Are crypto suites and reachable subnets explicitly defined? Is remote access centrally managed and integrated with the firewall? Are VPN logs monitored and correlated?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein NET.3.3 VPN; related: ORP.4, OPS.1.1.2, OPS.1.1.3, OPS.1.2.5, CON.1; references ISO/IEC 27033-5 and NIST SP 800-77.",
        "cheatSheet": "https://www.bsi.bund.de/EN/Topics/ITGrundschutz/itgrundschutz_node.html",
        "detectionLogic": "This rule flags likely VPN endpoints/concentrators by focusing on administered, backend assets with significant CIA ratings. Heuristics: (1) assets receiving 'DevOps' usage links (proxy for administrative/remote-ops paths); (2) exclusively backend technologies; (3) higher CIA requirements increase impact. If the model explicitly contains VPN signals—asset titles containing 'VPN', 'Gateway', 'Concentrator', 'Remote Access', or link protocols mentioning 'IPsec', 'OpenVPN', 'WireGuard', 'TLS VPN'—treat them as strong matches. The risk escalates with the asset’s criticality and the presence of incoming administrative links.",
        "riskAssessment": "Likelihood is considered 'Likely' due to omnipresent human error and configuration drift in VPN operations. Impact scales with the CIA requirements of the affected asset and whether it mediates access between untrusted and internal networks.",
        "falsePositives": "May be a false positive for non-VPN backend assets or where zero-trust access, strong automation, audited change control, and hardened baselines materially minimize human-error exposure. Provide evidence (policy, automation, monitoring) to downgrade.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "63_sec11.ts",
        "bsiCode": "NET.3.3",
        "id": "disruption-by-it-administration-t5.158",
        "title": "Disruption by IT Administration (BSI T 5.158)",
        "description": "Even when IT administration tasks are performed without error, they can inadvertently disrupt the institution's IT services.",
        "impact": "The primary impact is the disruption of service availability, either immediately by violating maintenance windows or delayed due to unforeseen side effects of administrative changes.",
        "action": "Implement and Enforce a Strict Change Management Process",
        "mitigation": "Implement and strictly enforce a formal change management process for all IT administration activities, as described in BSI control OPS.1.1.A15.",
        "check": "Is there a formal change management process in place? Are maintenance windows defined and respected? Are changes tested in a separate environment before production deployment? Are rollback procedures available and tested?",
        "asvs": "Corresponds to BSI IT-Grundschutz Threat T 5.158 (Incorrect planning or implementation of changes). Mitigation is covered by controls like OPS.1.1.A15 (Patch and change management).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_server_operation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to any in-scope, non-client technical asset that requires administration (e.g., servers, applications, databases, network components).",
        "riskAssessment": "The impact of the risk directly correlates with the availability requirement of the administered technical asset. A higher availability requirement (e.g., 'mission-critical') results in a higher impact.",
        "falsePositives": "This risk might be considered a false positive if the organization has an exceptionally mature and rigorously tested change management process that effectively eliminates unforeseen side effects and strictly adheres to non-disruptive maintenance schedules.",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "63_sec2.ts",
        "bsiCode": "NET.3.3",
        "id": "insufficient-documentation-bsi-ism2.2",
        "title": "Insufficient Documentation (BSI ISM.2.2)",
        "description": "Documentation can be insufficient if information about IT components (e.g., configuration or access rights) has not been recorded or is incomplete.",
        "impact": "Insufficient documentation can lead to misconfigurations and flawed IT administration, which can compromise the Confidentiality, Integrity, and Availability (CIA) of the affected systems.",
        "action": "Establish and Maintain Comprehensive System Documentation",
        "mitigation": "Establish and enforce a process for creating, maintaining, and regularly reviewing system documentation.",
        "check": "Is there a formal process for system documentation? Is the documentation for critical systems complete, current, and regularly reviewed?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1 (General IT Operation), Requirement OPS.1.A9 (Documentation of the regular IT operation) as per Edition 2023.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_General_IT_operation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI OPS.1)",
        "detectionLogic": "This is an organizational risk that can be difficult to verify from a technical model alone.",
        "riskAssessment": "The likelihood is considered 'Likely' as insufficient documentation is a very common organizational weakness.",
        "falsePositives": "This risk can be considered a false positive if the organization has a robust and mature documentation process that is consistently followed,",
        "cwe": "732",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "63_sec3.ts",
        "bsiCode": "NET.3.3",
        "id": "net-3-3-vpn-over-privileged-access",
        "title": "NET.3.3 VPN: Over-Privileged or Poorly Governed Access",
        "description": "VPN endpoints, gateways, and their administrative components often end up with broad, persistent reach into internal networks.",
        "impact": "Compromise or misuse of a VPN endpoint/gateway or its admin plane can grant wide network reach (east-west and north-south),",
        "action": "Harden VPN endpoints and enforce least privilege with strong identity, short-lived credentials, MFA, and timely off-boarding.",
        "mitigation": "Restrict VPN reach to defined subnets and services; avoid generic 'super-user' or 'any-to-any' access; disable split tunneling unless explicitly justified;",
        "check": "Are VPN assets explicitly modeled (e.g., '@Component:VPN', '@Tag:VPN-Gateway')? Is split tunneling disabled by default?",
        "asvs": "Mapped to BSI NET.3.3 (A1–A5, A7, A10–A13) with related governance in ORP.4 and cryptographic controls in CON.1.",
        "cheatSheet": "BSI IT-Grundschutz Baustein NET.3.3 VPN – planning, secure configuration, product selection, and periodic access review.",
        "detectionLogic": "This rule looks for technical assets tagged as VPN endpoints or privileged admin components (e.g., '@Component:VPN', '@Tag:VPN-Gateway', '@Role:Administrator')",
        "riskAssessment": "Impact is derived from the highest confidentiality, integrity, and availability of all reachable assets.",
        "falsePositives": "Central gateways or monitoring hubs may legitimately have many links but be constrained by strong segmentation, per-tunnel ACLs,",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "63_sec4.ts",
        "bsiCode": "NET.3.3",
        "id": "insufficiently-secured-admin-access",
        "title": "Insufficiently Secured Administrative Access",
        "description": "Administrative access can expose sensitive data and powerful functions (e.g., configuration changes, user management, operational data). If these administrative channels are not robustly secured, unauthorized actors may gain privileged access, enabling data disclosure, manipulation, or service disruption and threatening all CIA objectives.",
        "impact": "A successful exploitation of an insecure administrative channel can lead to a complete compromise of the target system, including data breaches, configuration manipulation, and service outages. It can also serve as a pivot point for further attacks within the infrastructure.",
        "action": "Secure Administrative Access Channels",
        "mitigation": "Administrative communication links must be strongly secured. Use encrypted protocols (e.g., HTTPS, SSH, FTPS, RDP with TLS), strong multi-factor authentication, and strict authorization. Apply network-level protections (VPNs, IP filtering), especially when crossing trust boundaries. Access credentials must not be transmitted in clear text. Enforce least privilege for administrative roles.",
        "check": "Are all administrative links (e.g., `usage: devops` or admin-tagged clients) encrypted? Is strong authentication (2FA, client certificates, externalized via IdP) enforced? Are VPN/IP filters used across trust boundaries, especially for internet exposure?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.2.A16 (Secure administration of IT systems)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_2_Regular_operations_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Analyze all communication links: flag those used for administration (either `usage: devops` or links from human-operated clients tagged `@Role:Administrator`). Raise a risk if any of the following hold: (1) protocol is unencrypted; (2) authentication is `none` or credentials-only; (3) the link crosses a trust boundary without VPN or IP filtering—especially when one side is internet-facing.",
        "riskAssessment": "Likelihood increases when administrative interfaces are reachable from untrusted networks or use weak/no authentication. Impact scales with the CIA rating of the target asset and processed/stored data. Compromising admin access to a mission-critical system implies very high impact due to privileged control.",
        "falsePositives": "May be a false positive if compensating controls exist but are not modeled (e.g., hardened bastion hosts or firewalls enforcing strict IP filtering). Treat plain 'credentials' as weak for admin access; in low-risk environments with strong policies this may be acceptable, but generally credentials-only are insufficient.",
        "cwe": "522",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "63_sec6.ts",
        "bsiCode": "NET.3.3",
        "id": "staff-shortage-administrators",
        "title": "Staff Shortage Among Administrators",
        "description": "A shortage of administrative personnel, whether due to insufficient planning, overcommitment, or external factors such as a pandemic, can prevent necessary administrative tasks from being completed in a timely manner.",
        "impact": "If administrative tasks are neglected or performed incorrectly due to staff shortages, critical security vulnerabilities may go unpatched, misconfigurations may occur, and system availability may be compromised.",
        "action": "Ensure adequate staffing, cross-training, and contingency planning for administrators",
        "mitigation": "Implement robust personnel and resource planning for administrative roles to ensure adequate staffing levels.",
        "check": "Is there a documented process for personnel capacity planning for IT administration? Are substitution rules for critical administrators defined, documented, and tested?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (Personnel), especially ORP.2.A1 (Personnel requirements analysis) and ORP.2.A5 (Substitution rules).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.2)",
        "detectionLogic": "This is an organizational risk that is difficult to detect automatically. However, its potential impact can be highlighted by identifying the critical technical assets managed by administrators.",
        "riskAssessment": "The likelihood is HIGH if a staff shortage is a known organizational issue or if there is no formal capacity planning or substitution rules.",
        "falsePositives": "This risk is raised based on the presence of an administrative role tag on a technical asset. It does not verify the actual staffing levels of the responsible team.",
        "cwe": "1126",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "63_sec7.ts",
        "bsiCode": "NET.3.3",
        "id": "insufficient-separation-of-admin-tools",
        "title": "Insufficient Separation of Administration Tools",
        "description": "Administration tools grant extensive access to an institution's IT systems. If these tools are inadequately secured, for example, by being insufficiently separated from non-administrative applications, they can be compromised. This can occur when the same client system or application (e.g., a web browser or SSH client) is used for both privileged administrative tasks and general daily use (e.g., browsing the web, checking email). An attack originating from the non-administrative context can then pivot to compromise the administrative session.",
        "impact": "If an attacker gains access to an administration tool through a less secure context, they can gain extensive permissions. These permissions can be abused for various attacks, such as sabotaging IT administration, performing unauthorized administrative actions, or escalating privileges further into the network. This endangers the confidentiality, integrity, and availability of all systems managed by that tool.",
        "action": "Use dedicated and hardened administrative clients",
        "mitigation": "Administrative tasks should be performed from dedicated and hardened systems (e.g., Privileged Access Workstations - PAWs), which can be physical or virtual machines. These systems should be isolated from the general corporate network and have no access to the internet or email. The tools used for administration (browsers, terminals) must not be used for any non-administrative purpose. If dedicated systems are not feasible, use separate user profiles or browser profiles for administrative and regular tasks, although this provides weaker separation.",
        "check": "Are administrative tasks performed from dedicated, hardened systems? Are the client applications (e.g., browsers, SSH clients) used for administration strictly isolated from those used for daily business like email and general web browsing?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.5.A4 (Separate clients for administration)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Logging_edition_2023.pdf?__blob=publicationFile (Note: The specific requirement A4 is in the German version of the 'System- und Anwendungsadministration' Baustein, which is part of the broader OPS group).",
        "detectionLogic": "This rule identifies technical assets that are used by humans as clients (e.g., Desktops, DevOps Clients) and have outgoing communication links for both administrative purposes (usage: 'devops') and regular business purposes (usage: 'business'). This mixing of contexts on a single client system represents the vulnerability.",
        "riskAssessment": "The likelihood is considered high if a client mixes administrative and business usage contexts. The impact is determined by the highest sensitivity (a combination of Confidentiality, Integrity, and Availability) of the assets being administered via the 'devops' communication links. Compromising a client that administers mission-critical systems has a very high impact.",
        "falsePositives": "A model might show a single asset (e.g., 'Developer Desktop') with mixed-use communication links. In reality, the user may be employing mitigating controls not captured in the model, such as using separate virtual machines or heavily restricted profiles on that single desktop. This should be verified before accepting the risk.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "63_sec8.ts",
        "bsiCode": "NET.3.3",
        "id": "failure-of-administration-capabilities",
        "title": "Failure of Administration Capabilities / SPOF in Ops Tools (BSI CON.1.A4; supports NET.3.3 VPN availability)",
        "description": "If administration capabilities fail and there is no redundancy or alternative due to poor planning, related IT administration activities cannot be carried out until the failure is resolved. In the worst-case scenario, the entire IT infrastructure is restricted, unavailable, or non-functional. Administration tools can also fail due to their own administration, e.g., through misconfiguration, a faulty patch, or a change introduced by an IT administration activity, creating a Single Point of Failure (SPOF). This is particularly relevant for core access components such as VPN endpoints/concentrators governed by NET.3.3.",
        "impact": "The failure of a non-redundant administration tool can render the systems it manages inoperable or unmanageable, directly impacting their availability. This can lead to widespread service disruptions, violating SLAs and causing significant business harm.",
        "action": "Ensure redundancy and tested fallback for critical administration/operations tools and platforms (including VPN endpoints).",
        "mitigation": "Ensure that all technical assets performing critical administrative or operational functions are designed with redundancy (e.g., active-passive, active-active clustering). If a tool is identified as a Single Point of Failure (SPOF), implement a redundant instance or a documented, tested manual fallback/recovery procedure that can be executed if the primary tool fails. Change management processes for these tools should be particularly rigorous and include staged rollouts and quick rollback.",
        "check": "Are critical administration tools (like build pipelines, container orchestrators, identity providers, VPN concentrators) configured to be redundant? Is the 'redundant' flag in the model accurately set for these assets? Is there a documented and tested fallback procedure in case of failure?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Contingency Management), specifically requirement CON.1.A4 (Redundancy of platforms); also aligned with NET.3.3 VPN regarding availability and secure operation of VPN endpoints.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Contingency_Management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
        "detectionLogic": "This rule scans all technical assets and flags non-redundant administrative/operational tools. It checks assets whose `technology` is one of: BuildPipeline, SourcecodeRepository, ArtifactRegistry, CodeInspectionPlatform, Monitoring, IdentityProvider, Vault, HSM, ContainerPlatform, ServiceMesh, Scheduler, LoadBalancer, ReverseProxy, WAF, IDS, IPS, ServiceRegistry. Assets marked `outOfScope` or with `redundant=true` are ignored. A risk is raised only if the tool has at least one outgoing `communicationLink` with `usage === DevOps` to an existing target asset—indicating it actively manages other components and thus represents a Single Point of Failure (SPOF). For each such tool, the rule derives impact from the highest availability requirement among the managed targets.",
        "riskAssessment": "Impact scales with the highest availability requirement among the assets managed by the non-redundant tool: Important → Medium, Critical → High, Mission-Critical → Very High. Likelihood is `Likely` by default because administrative tools change frequently and outages due to updates or misconfiguration are plausible.",
        "falsePositives": "A risk might be flagged for a tool that is not critical for immediate production availability (e.g., a development-only tool or an offline analytics platform). It can also be a false positive if a documented and effective manual fallback procedure exists but is not captured in the model.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "63_sec9.ts",
        "bsiCode": "NET.3.3",
        "id": "misleading-it-administration",
        "title": "Misleading IT Administration",
        "description": "If IT administrators are misled, for example by false information, they may respond incorrectly.",
        "impact": "Being tricked into performing unauthorized administrative actions can lead to data or system manipulation (loss of integrity),",
        "action": "Implement and Enforce Strict Administrative Procedures with Verification",
        "mitigation": "Establish and enforce strict change management and incident response processes for all administrative tasks.",
        "check": "Are all administrative actions required to follow a documented process? Is there a requirement for out-of-band verification for critical administrative tasks?",
        "asvs": "Derived from BSI IT-Grundschutz Threat CON.8 (Manipulation of information). This is primarily an operational security and social engineering threat.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/CON_8_Manipulation_of_information_Edition_2023.html",
        "detectionLogic": "This is an operational risk that applies to any technical asset that requires administration. The risk is triggered for backend systems,",
        "riskAssessment": "The impact of a successful attack is directly related to the confidentiality, integrity, and availability requirements of the targeted technical asset.",
        "falsePositives": "This risk is process-related and cannot be fully confirmed or denied solely by the technical model. The model identifies assets where this risk would have a high impact.",
        "cwe": "285",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Spoofing"
      }
    ],
    "NET.3.4": [
      {
        "file": "64_sec1.ts",
        "bsiCode": "NET.3.4",
        "id": "inadequate-nac-planning-net-2-1",
        "title": "Inadequate NAC Planning or Implementation (BSI NET.2.1)",
        "description": "If not all IT systems relevant for Network Access Control (NAC) are recorded in IT asset management, a NAC solution cannot be adequately planned.",
        "impact": "Flaws in NAC planning and implementation can lead to unauthorized network access, granting attackers a foothold in internal networks. This can result in the compromise of sensitive data (Information Disclosure), lateral movement (Elevation of Privilege), or disruption of services (Denial of Service, Availability).",
        "action": "Review and Enhance NAC Strategy and Implementation",
        "mitigation": "Ensure a complete IT asset inventory exists and that all assets are modeled within appropriate network trust boundaries.",
        "check": "Are all network-connected assets registered and modeled within a defined network trust boundary? Do all communication links crossing network boundaries use strong, non-replayable authentication and explicit authorization policies?",
        "asvs": "BSI IT-Grundschutz: NET.2.1 Network Access Control",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_2_1_Network_Access_Control_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified in two ways: 1. When a communication link crosses a network-level trust boundary without strong authentication (e.g., 'none') or without specified authorization. 2. When a network-relevant technical asset is not placed inside any trust boundary, indicating a potential gap in asset management, which is a prerequisite for effective NAC.",
        "riskAssessment": "Impact is rated based on the sensitivity of the target asset and the data transferred. The likelihood is high for unauthenticated connections or unmanaged assets. The risk of data breach is considered probable when sensitive data is transferred over weakly protected links.",
        "falsePositives": "The model might not explicitly show a central NAC or authenticating proxy, making direct connections appear unauthenticated. This risk should be verified against the actual network architecture.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "64_sec2.ts",
        "bsiCode": "NET.3.4",
        "id": "inadequate-endpoint-integration-and-orchestration-con6",
        "title": "Inadequate Endpoint Integration and Orchestration (related to BSI CON.6)",
        "description": "A lack of, or poorly implemented, orchestration tools, security policies, and standardized processes for managing endpoints can lead to significant security gaps. Endpoints may be integrated into the network in an uncoordinated manner, making it difficult to enforce secure, role-based authentication and commissioning procedures. This can result in endpoints being placed in incorrect network segments, using weak authentication methods, or having their communication capabilities impaired.",
        "impact": "If endpoints are not managed and segmented correctly, this can lead to a variety of security incidents. Protected devices might be exposed in less secure network zones, making them vulnerable to attack. The use of weak authentication can allow for spoofing and unauthorized access. These failures can compromise the confidentiality, integrity, and availability of data, lead to privilege escalation, and cause service disruptions.",
        "action": "Implement Standardized Endpoint Onboarding and Management with proper Network Access Control (NAC).",
        "mitigation": "Establish and enforce a comprehensive strategy for endpoint management. Utilize orchestration tools to automate and standardize the configuration of endpoints. Define clear security policies, requirements, and commissioning processes for all device types. Ensure the Network Access Control (NAC) solution can enforce these policies, including strong authentication and correct network segmentation for different endpoint groups. Regularly audit endpoint configurations and network segments to ensure compliance.",
        "check": "Is there a central endpoint management or orchestration tool? Are there documented standards and onboarding processes for endpoints? Does the NAC solution enforce strong authentication and network segmentation based on defined policies?",
        "asvs": "BSI IT-Grundschutz Baustein CON.6: Netz-Zugangskontrolle (Network Access Control)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Network_access_control_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is detected by identifying its symptoms on client-type technical assets. The rule checks for two primary conditions: 1. Client assets using weak or no authentication on communication links that cross trust boundaries. 2. Sensitive client assets being placed in the same network trust boundary as less-secure assets (e.g., internet-facing systems), indicating poor segmentation.",
        "riskAssessment": "The likelihood is considered high if symptoms like weak authentication are present, as this directly indicates a failure in policy enforcement. The impact is determined by the sensitivity (CIA ratings) of the misconfigured endpoint and the data it handles. A highly confidential client in a poorly segmented network or using no authentication to access critical systems poses a very high risk.",
        "falsePositives": "The model might not fully capture the specifics of the NAC implementation or other compensating controls (e.g., host-based firewalls). A finding of 'weak authentication' could be a false positive if the target system is a public, low-value service where authentication is not required.",
        "cwe": "287",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "64_sec3.ts",
        "bsiCode": "NET.3.4",
        "id": "weak-network-access-authentication",
        "title": "Weak Authentication for Network Access (based on BSI INF.5.A10)",
        "description": "If secure authentication methods (like EAP with strong ciphers) are not supported or not enforced for network access, insecure protocols such as EAP-MD5 or MAC-based authentication might be used. This facilitates spoofing, replay, or man-in-the-middle attacks, allowing unauthorized systems to gain access to the network.",
        "impact": "An attacker can impersonate a legitimate device to gain unauthorized network access. If the network is not properly segmented for devices authenticated with weak methods, the attacker can gain extensive communication capabilities, potentially accessing sensitive systems, intercepting traffic, and compromising the confidentiality, integrity, and availability of data and services within the target network.",
        "action": "Enforce Strong, Encrypted Authentication for Network Access and Segment Networks",
        "mitigation": "Use strong, certificate-based authentication methods like EAP-TLS for network access whenever possible. Avoid using weak or non-existent authentication. If weak authentication (like MAC-based filtering or credentials over unencrypted protocols) is unavoidable for certain legacy devices, those devices must be placed in a strictly segregated network zone (VLAN) with tight firewall rules that only permit required communication to specific targets.",
        "check": "Are all network access points (@Network:WLAN, LAN ports) configured to enforce strong authentication? Is MAC-based authentication used? If so, are those devices in a separate, restricted network segment? Are credentials for network access ever sent over unencrypted protocols?",
        "asvs": "BSI IT-Grundschutz INF.5.A10 (Use of secure authentication methods)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_WLAN_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule detects communication links that cross network boundaries with weak authentication methods. Weak authentication is identified if the link uses no authentication, sends credentials over an unencrypted protocol, or is explicitly tagged as using a weak method like MAC-based authentication (`@authentication:mac-based`).",
        "riskAssessment": "The likelihood is high if no authentication is used, or likely if weak methods are used. The impact is determined by the sensitivity of the data traversing the link and the criticality of the assets within the target network segment. A flat, unsegmented network significantly increases the potential impact.",
        "falsePositives": "The risk might be a false positive if there are other compensating controls not modeled, such as a physically secured network where only trusted devices can be connected, or if the target network for the weak authentication is an isolated guest network with no access to internal resources.",
        "cwe": "287",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "64_sec4.ts",
        "bsiCode": "NET.3.4",
        "id": "misconfiguration-of-nac-components",
        "title": "Misconfiguration of Network Access Control (NAC) Components",
        "description": "Due to human error, inadequate processes, or insufficient personnel capacity and resulting time constraints,",
        "impact": "Incorrect NAC configuration can lead to two primary failure modes:",
        "action": "Implement Strict Configuration and Change Management for NAC Components",
        "mitigation": "Establish and enforce strict change management and configuration review processes for all NAC components (e.g., assets tagged as @NACComponent).",
        "check": "Is there a documented change control process for NAC configurations? Are configurations regularly audited for correctness and consistency? Is access to configure NAC components tightly controlled and logged?",
        "asvs": "V4.1 Access Control Design",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any technical asset identified as a core part of the Network Access Control infrastructure (tagged with `@NACComponent`).",
        "riskAssessment": "The likelihood is considered higher for manually managed systems or those involving custom-developed parts.",
        "falsePositives": "This risk can be considered a false positive if robust, automated, and audited configuration management processes are in place and visible within the threat model.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "64_sec5.ts",
        "bsiCode": "NET.3.4",
        "id": "inadequate-change-validation-process",
        "title": "Inadequate Validation of NAC Configuration Changes (BSI NET.3.4.A13/A11/A16)",
        "description": "Weak or missing validation in NAC-related change processes (e.g., on RADIUS, access switches, wireless controllers, supplicants) can introduce configuration errors. This may grant devices excessive access, assign them to the wrong VLAN/microsegment, disable NAC on ports, or deny legitimate access entirely. Disabling or loosening controls (e.g., IEEE 802.1X, authorization rules) without proper review can lead to unauthorized network access, lateral movement, or outages.",
        "impact": "Misconfigurations in NAC components directly threaten Confidentiality, Integrity, and Availability. Unauthorized endpoints may gain network access (confidentiality breach), authorized devices may be blocked (availability loss), and inconsistent authorization states can enable tampering or spoofing (integrity risk). Critical blast radius exists for central components like RADIUS, identity stores, and access switches.",
        "action": "Enforce Formal Validation for All NAC-Relevant Changes",
        "mitigation": "Establish a robust change process for NAC: peer review, test/stage validation, automated policy linting, and rollbacks for RADIUS, authorization rules, switch/WLAN authenticator settings, and supplicant configs. Require tickets with justification, impact analysis, and audit trails. Permit disabling NAC only via documented emergency policies with time-bounded approvals and monitoring.",
        "check": "Is there a documented workflow requiring validation of NAC changes (RADIUS policies, VLAN assignments, downloadable ACLs, 802.1X settings)? Are changes tested in staging with sample devices? Are NAC status changes (e.g., 802.1X disabled on ports) detected and alerted? Are configuration writes to central NAC components logged and reviewed?",
        "asvs": "BSI IT-Grundschutz NET.3.4 Network Access Control — esp. NET.3.4.A11 (Sichere Konfiguration), NET.3.4.A12 (Monitoring), NET.3.4.A13 (Validierungsvorgaben), NET.3.4.A16 (Protokollierung).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_4_Network_Access_Control.pdf",
        "detectionLogic": "Organizational risk with technical hotspots: flag assets where inadequate validation is most harmful — central RADIUS/AAA, identity providers, access control points (reverse proxies/WAFs as policy edge), CI/CD for network configs, and critical data/secret stores. Also highlight endpoints and client systems whose supplicant/policy deployment is frequently changed. The rule raises risks on these assets to surface where strict validation is essential.",
        "riskAssessment": "Likelihood increases with frequent changes, large device diversity (LAN/WLAN/IoT), or shared admin models. Impact scales with asset criticality and role: central AAA/IdP, production databases, and core security controls drive Very High impact if misconfigured. Weak logging/monitoring further raises residual risk.",
        "falsePositives": "If the organization operates a mature NAC change process with enforced reviews, staged validation, automated checks, and continuous monitoring, this finding may be informational. Verification requires reviewing documented procedures, change tickets, and audit logs.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "64_sec6.ts",
        "bsiCode": "NET.3.4",
        "id": "disabled-or-insufficient-network-access-control-net-3-4",
        "title": "Disabled or Insufficient Network Access Control (NAC) (BSI NET.3.4)",
        "description": "If Network Access Control (NAC) is temporarily or permanently disabled on network access points (e.g., switches/WLAN), network access is insufficiently protected. This allows unauthorized individuals or devices to access the network or lets insecure IT systems obtain excessive communication privileges. Similarly, if endpoint compliance is not verified before granting access, devices with vulnerabilities (e.g., outdated anti-virus) can connect.",
        "impact": "Unauthorized access may lead to disclosure, manipulation, or deletion of information (breaching confidentiality, integrity, and availability). Malware can be introduced, causing lateral movement, data breaches, and service disruptions.",
        "action": "Enforce, continuously monitor, and test NAC at all access layers",
        "mitigation": "Ensure strong NAC is active on all access ports and WLAN. Require certificate-based or account-based authentication (IEEE 802.1X/EAP) and verify endpoint compliance before granting access. Use least-privilege authorization (e.g., VLAN assignment/micro-segmentation), monitor for disabled NAC, and audit for policy violations or non-compliant devices.",
        "check": "Are NAC policies defined and enforced on all critical segments and ports? Is 802.1X with EAP in use and coupled to RADIUS? Are compliance checks and alerts for disabled NAC, unusual RADIUS failures, or MAC-auth exceptions in place?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein NET.3.4 Network Access Control, addressing risks from weak or missing NAC and insufficient endpoint compliance checks.",
        "cheatSheet": "BSI NET.3.4 Network Access Control (German) – guidance on IEEE 802.1X, RADIUS, MAC authentication, compliance checks, and operations.",
        "detectionLogic": "Detect links that simulate bypassing NAC: a client-type asset outside a network trust boundary connects to an in-boundary target over a link without authentication, VPN, or IP filtering. Such a path indicates that an untrusted endpoint could attach directly to internal segments without NAC enforcement.",
        "riskAssessment": "Likelihood increases when generic client devices can connect without network-layer protection. Impact aligns with the CIA requirements of the target asset and the data processed; compromises of mission-critical or strictly confidential environments are high impact.",
        "falsePositives": "Out-of-band compensating controls (e.g., dedicated NAC appliances, port security, physical controls) might not be modeled. Validate findings against actual NAC deployment, RADIUS policies, and switch/WLAN configurations.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "64_sec7.ts",
        "bsiCode": "NET.3.4",
        "id": "uncontrolled-network-access-on-nac-failure",
        "title": "Uncontrolled Network Access on NAC Failure",
        "description": "Failure or unavailability of central Network Access Control (NAC) components (e.g., RADIUS servers) can lead to unintended network access behavior. This can be caused by a lack of redundancy, software faults, DoS attacks, or network disruptions. Depending on the configuration of network infrastructure (e.g., switches), this can result in endpoints either losing all network access (fail-close) or gaining unrestricted access (fail-open).",
        "impact": "A fail-open scenario bypasses network segmentation and access controls, potentially exposing sensitive systems and data to unauthorized access, leading to severe confidentiality and integrity breaches. A fail-close scenario causes a denial-of-service, impacting the availability of applications and services within the affected network segment.",
        "action": "Implement a resilient and explicitly fail-closed NAC architecture with health monitoring and alerting.",
        "mitigation": "Ensure that all critical NAC components are implemented in a redundant, highly-available cluster. Explicitly configure the fail-state of network switches to 'fail-close' (deny access by default) to prevent unauthorized access. Only allow 'fail-open' where a documented, risk-accepted exception exists for a low-sensitivity environment. Implement comprehensive, end-to-end health monitoring for the NAC control path (RADIUS, directory services, network reachability) with immediate alerting and tested RADIUS-down policies.",
        "check": "Are NAC components (e.g., RADIUS servers) modeled as redundant? Is the fail-state (fail-open/fail-close) documented, configured, and regularly tested? Is end-to-end monitoring in place for NAC and its dependencies with alerting on failure?",
        "asvs": "V13 Network Architecture",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Network_Access_Control_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Raise this risk for technical assets that are potential NAC components (technology: 'IdentityProvider') that are in-scope and not redundant ('redundant: false'). The risk applies to the entire trust boundary guarded by that component. As an additional signal, prioritize cases where the trust boundary contains highly sensitive assets (high C/I/A).",
        "riskAssessment": "Impact is derived from the maximum Confidentiality, Integrity, and Availability of assets within the affected trust boundary. Fail-open primarily threatens Confidentiality and Integrity; fail-close threatens Availability. Likelihood is 'Likely' when the NAC component is a single point of failure (non-redundant).",
        "falsePositives": "An 'IdentityProvider' asset may serve purposes other than NAC (e.g., SSO for web apps). The model may also omit external redundancy (e.g., load balancers or managed HA), which could lead to over-reporting. Validate with architecture documentation.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "64_sec8.ts",
        "bsiCode": "NET.3.4",
        "id": "inadequate-log-data-protection-ops-1-1-5-g5",
        "title": "Inadequate Protection of Personal Log Data (BSI OPS.1.1.5.G 5)",
        "description": "An insufficient administration concept, inadequate implementation, excessive data retention periods, or a lack of coordination with the works council and data protection officer can lead to inadequate protection of personal log data. This could allow the creation of user profiles, enabling employees to be tracked over time.",
        "impact": "The unauthorized creation of user profiles from log data constitutes a significant violation of employee privacy and data protection regulations (e.g., @DataType:PII). This can lead to severe legal penalties, substantial fines, and reputational damage. It also undermines the trust between the organization and its employees, potentially affecting morale and productivity.",
        "action": "Establish and enforce a data-protection-compliant logging concept",
        "mitigation": "Develop a comprehensive logging concept in close coordination with the data protection officer and, where applicable, the works council. This concept must clearly define the purposes for logging, specify exactly what data is collected, establish appropriate and justifiable retention periods, and implement strict, role-based access controls for all log data. Employ pseudonymization or anonymization techniques wherever the purpose of logging allows. The entire logging process, from collection to deletion, should be regularly audited for compliance.",
        "check": "Is there a documented logging concept approved by the data protection officer? Are data retention periods defined, technically enforced, and justified? Are access rights to log data restricted on a strict need-to-know basis and regularly reviewed? Are there technical measures in place to prevent unauthorized analysis of log data?",
        "asvs": "BSI IT-Grundschutz-Kompendium 2023: OPS.1.1.5 Protokollierung (Logging), Gefährdung G 5 'Unzulässige Auswertung von Protokollierungsdaten' (Unauthorized evaluation of log data).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/OPS/OPS_1_1_5_Protokollierung_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for `datastore` assets that store `data_asset` items tagged as `@DataType:Logging`. The risk is considered more severe if the log data has a `confidentiality` level of `Restricted` or higher, as this indicates the presence of sensitive or personal information.",
        "riskAssessment": "The impact escalates with the confidentiality of the log data being stored. `Restricted` personal data implies a medium impact, while `Confidential` or `Strictly Confidential` data (such as detailed user activity logs) leads to a high or very high impact. The likelihood is considered `Likely` by default, as a lack of specific, modeled controls for log data implies a higher chance of misuse or unauthorized access.",
        "falsePositives": "This may be a false positive if a compliant and comprehensive logging concept is in place but its controls are not explicitly modeled. For example, if log data is managed by a specialized SIEM or log management platform with robust, audited access controls and retention policies, this risk may be considered mitigated, even if not visible in the model. Applying a `log-protection-compliant` tag to the datastore can suppress this finding.",
        "cwe": "532",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "NET.4.1": [
      {
        "file": "65_sec1.ts",
        "bsiCode": "NET.4.1",
        "id": "unencrypted-telecommunication-eavesdropping",
        "title": "Eavesdropping on Unencrypted Telecommunication (related to BSI NET.4.1 / G 0.35)",
        "description": "When phone calls or other sensitive data are transmitted unencrypted over a telecommunication system (TK-Anlage), attackers can eavesdrop on or intercept the communication. Threats include tapping phone lines, intercepting VoIP streams, listening in on PBX systems, or capturing unencrypted data packets. Specific risks arise when voicemail systems forward audio files via unencrypted email, making them easy to intercept. Additionally, system features (e.g., call monitoring, 'Zeugenschaltung') can be abused to covertly listen to conversations, often enabled by publicly available system knowledge.",
        "impact": "Eavesdropping on unencrypted TK traffic compromises confidentiality, potentially leaking business secrets, personal data, or other sensitive information. Consequences include financial loss, reputational harm, legal liabilities, and regulatory penalties.",
        "action": "Encrypt Telecommunication Channels and Secure TK-Systems",
        "mitigation": "Encrypt all TK-related communication (voice, fax, voicemail, signaling) with state-of-the-art cryptography (e.g., TLS, SRTP for VoIP, STARTTLS for email, HTTPS for web). Harden PBX and VoIP gateways: disable unused features, enforce strong authentication, and restrict admin access. Ensure voicemails are protected both in transit and at rest.",
        "check": "Are all TK communication protocols (VoIP, email forwarding, signaling) encrypted? Are PBX/VoIP gateways securely configured and hardened? Are voicemail messages protected during transmission and storage?",
        "asvs": "BSI IT-Grundschutz: G 0.35 Mithören von Nachrichten; NET.4.1 TK-Anlagen; NET.1.2 VoIP, specifically NET.1.2.A5 'Encryption of VoIP data'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_2_VoIP_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "The rule checks:",
        "riskAssessment": "Likelihood is 'Likely' for unencrypted links and 'Very Likely' if crossing trust boundaries or involving unencrypted email forwarding. Impact depends on data confidentiality: 'Very High' for Strictly Confidential information.",
        "falsePositives": "False positives are rare. Only acceptable if TK traffic is carried over a fully isolated, physically secured network (e.g., air-gapped). Identification of 'telecom systems' for voicemail scenarios is heuristic and may not always be perfect.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "65_sec2.ts",
        "bsiCode": "NET.4.1",
        "id": "eavesdropping-via-microphone",
        "title": "Eavesdropping via Microphone in End Devices",
        "description": "Microphones in end devices can be exploited for eavesdropping in rooms. This can happen in two primary ways:",
        "impact": "Unauthorized eavesdropping leads to a severe breach of confidentiality. Sensitive conversations, business secrets, or personal data could be captured,",
        "action": "Harden End Devices, Manage Permissions, and Secure Remote Control Features",
        "mitigation": "Implement strong authentication for any feature capable of remotely activating hardware like microphones. For mobile or client applications,",
        "check": "Are there any features that allow remote, unauthenticated, or weakly authenticated microphone activation? Do applications on the device request microphone permissions?",
        "asvs": "OWASP MASVS-PLATFORM-2: Request only the minimum set of permissions required. OWASP IoT Top 10: I5 - Lack of Physical Hardening.",
        "cheatSheet": "https://owasp.org/www-project-internet-of-things/assets/cheatsheets/IoT_Firmware_Security_Cheat_Sheet.pdf",
        "detectionLogic": "This risk is raised for technical assets that are classified as end-user clients, which could plausibly have microphones.",
        "riskAssessment": "Likelihood is higher for devices with known insecure remote-control features or for applications that request microphone permissions without a clear, user-facing purpose.",
        "falsePositives": "The risk might be a false positive if the device physically has no microphone, if remote activation features are properly secured with strong authentication,",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "65_sec3.ts",
        "bsiCode": "NET.4.1",
        "id": "toll-fraud",
        "title": "Toll Fraud (Gebührenbetrug)",
        "description": "Toll fraud aims to shift the cost of telecommunication services (such as phone calls or data transfers) to a third party.",
        "impact": "The primary impact of toll fraud is direct financial loss for the organization. It can also lead to a denial-of-service condition if all available communication lines are occupied by fraudulent calls, disrupting legitimate business operations.",
        "action": "Secure Configuration and Monitoring of Telephony Systems",
        "mitigation": "Harden all telephony systems against abuse. Restrict access to administrative functions and remote maintenance ports (e.g., via VPN and strong multi-factor authentication).",
        "check": "Are remote administration interfaces for telephony systems secured? Are high-risk features like DISA and unauthenticated call forwarding disabled? Is there a policy for call barring, and is it enforced? Are call logs actively monitored for signs of fraud?",
        "asvs": "BSI IT-Grundschutz Kompendium: NET.4.1 TK-Anlagen",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_TK-Anlage_Edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers for any technical asset tagged as a `@Category:Telephony` system.",
        "riskAssessment": "The likelihood of exploitation is significantly higher for internet-exposed telephony systems, especially those with weak authentication. The impact is determined by the business-criticality (Integrity and Availability) of the telephony service. A successful attack against a mission-critical system will have a high impact due to both financial loss and operational disruption.",
        "falsePositives": "This risk is raised based on the presence of a 'Telephony' tag and high-level architectural properties. A manual check is required to confirm if the asset is indeed a telephony system and if its specific, detailed configuration is vulnerable. The system might have compensating controls not captured in the model.",
        "cwe": "306",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "65_sec4.ts",
        "bsiCode": "NET.4.1",
        "id": "unauthorized-access-to-phonebook-on-public-phones",
        "title": "Unauthorized Access to Electronic Phonebook on Publicly Accessible Telephones",
        "description": "Telephones, especially those not assigned to a specific user and located in publicly accessible areas (e.g., parking garages, lobbies, or in front of access control systems), may have an electronic phonebook. If this phonebook contains internal contact numbers, these numbers could be exfiltrated by unauthorized individuals, such as visitors.",
        "impact": "Leakage of internal phone numbers can facilitate social engineering attacks, targeted phishing (vishing), or harassment of employees. It exposes internal organizational structure and contact information to unauthorized parties, which can be a valuable precursor for more sophisticated attacks.",
        "action": "Restrict Access and Sanitize Data on Public-Facing Devices",
        "mitigation": "Telephones in public areas should not store internal contact directories. If they must, access to the phonebook feature should be protected (e.g., with a PIN or other authentication). Physical access to such devices should be controlled where possible. Regularly review and sanitize the data stored on such devices to remove non-essential sensitive information. Ideally, use phones without a local contact storage feature for such locations.",
        "check": "Are there technical assets representing telephones in publicly accessible areas? Do these devices store a data asset representing an internal-only contact directory? Is access to this directory restricted?",
        "asvs": "Derived from BSI IT-Grundschutz principles regarding physical, environmental, and component security.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_component_edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
        "detectionLogic": "This risk is detected for technical assets identified as telephones (via the '@BSI-Device:Telephone' tag) that are located in a 'public' context. An asset is considered public if it is directly exposed to the internet, resides in a trust boundary tagged with '@Access:Public', or is not located within any trust boundary at all. The risk is confirmed if this asset stores a data asset representing internal phone numbers.",
        "riskAssessment": "The likelihood is considered high if an unprotected telephone storing internal contacts is located in a public area. The impact is directly related to the confidentiality of the contact data; leakage of a restricted internal directory is more severe than a public-facing one. The impact escalates if the phone numbers belong to key personnel.",
        "falsePositives": "A risk might be flagged if the phonebook feature is disabled or protected by a strong PIN, but the model does not capture this specific control. The model might also incorrectly assume an area is 'public' if trust boundaries are not defined accurately.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "NET.4.2": [
      {
        "file": "66_sec1.ts",
        "bsiCode": "NET.4.2",
        "id": "misconfiguration-voip",
        "title": "Misconfiguration of VoIP Components (BSI SYS.3.2.1)",
        "description": "A VoIP-based telephone system can be affected by misconfigurations in a similar way to a circuit-switched telephone solution.",
        "impact": "Misconfiguration of VoIP components can lead to a complete failure of the telephone infrastructure (Availability),",
        "action": "Implement Configuration Management and Hardening for VoIP Systems",
        "mitigation": "Establish a robust configuration and change management process for all VoIP components.",
        "check": "Is there a documented change management process for the VoIP infrastructure?",
        "asvs": "BSI IT-Grundschutz SYS.3.2.1 VoIP-Komponenten",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_VoIP_Komponenten.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset identified as a VoIP component via the '@Service:VoIP' tag.",
        "riskAssessment": "The likelihood of misconfiguration is considered 'likely' due to the inherent complexity of VoIP systems.",
        "falsePositives": "The risk might be flagged for a system that is managed via a highly mature, automated, and tested configuration management pipeline, which is not visible in the threat model.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "66_sec2.ts",
        "bsiCode": "NET.4.2",
        "id": "incorrect-voip-compression-configuration",
        "title": "Incorrect VoIP Compression Configuration (BSI-style)",
        "description": "Whether VoIP components are dedicated hardware appliances or software-based systems, their configuration is crucial for proper functionality. This includes settings for media stream transmission, especially the compression method used. An incorrectly configured or unsuitable compression method can lead to significant transmission problems.",
        "impact": "If an unsuitable method with excessive compression is used, voice quality often deteriorates, impacting the integrity of the communication. Conversely, if a method with too little compression is chosen, the data stream is not sufficiently reduced, which can overload the network and lead to a Denial of Service (DoS), impacting availability.",
        "action": "Review and Validate VoIP Compression Settings",
        "mitigation": "Ensure that the compression codecs and transmission methods selected for VoIP media streams are appropriate for the network's bandwidth and the required voice quality. The configuration should balance bandwidth savings with acceptable audio fidelity to prevent both poor quality (integrity loss) and network overload (availability loss). This configuration should be part of a standardized build and regularly reviewed, especially after network infrastructure changes.",
        "check": "Are the VoIP codecs and compression settings documented? Has the chosen configuration been tested under various network load conditions? Is there a process to review and approve changes to VoIP configuration?",
        "asvs": "Derived from BSI IT-Grundschutz principles. Does not map directly to a specific ASVS item, but relates to general secure configuration principles found in V11.1 (Configuration).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any technical asset explicitly tagged as a VoIP system. The model cannot verify the specific configuration, so it serves as a reminder to manually check that compression settings are optimized to prevent network overload (Denial of Service) and poor voice quality (Integrity degradation).",
        "riskAssessment": "The likelihood is considered 'Likely' as misconfigurations are a common operational issue, especially in complex network environments. The impact is directly related to the availability requirements of the communication service provided by the asset. If VoIP is mission-critical for business operations, the impact of a service degradation or outage is high.",
        "falsePositives": "This risk is a general best-practice check. A false positive occurs if the VoIP system is already correctly configured and optimized, which can only be verified by a manual review of the component's settings.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "66_sec3.ts",
        "bsiCode": "NET.4.2",
        "id": "unencrypted-telephony-voip",
        "title": "Unencrypted Telephony / VoIP (based on BSI CON.3)",
        "description": "If phone calls, VoIP calls, or related data (such as voicemail-to-email) are transmitted unencrypted, an attacker on the same network segment can intercept, eavesdrop on, and record the communication. This is especially true for VoIP media streams (e.g., using RTP) on data networks and for voicemail audio files sent via unencrypted email protocols (like plain SMTP).",
        "impact": "Successful interception of unencrypted telephony or VoIP communication compromises the confidentiality of conversations and any data transmitted therein. Attackers gain access to potentially sensitive or confidential information, leading to data breaches, espionage, and providing material for further social engineering attacks.",
        "action": "Enforce encryption for all telephony and VoIP-related communication",
        "mitigation": "All communication links carrying voice data or related messages (e.g., voicemail) must use strong, state-of-the-art transport-layer encryption. Use encrypted protocols like SMTPS/IMAPS (for voicemail), HTTPS, WSS, or tunnel traffic through a secure VPN. For VoIP-specific protocols, ensure signaling (like SIP) and media (like RTP) are both encrypted, for example by using TLS for signaling and SRTP for media streams. For voicemail-to-email functionality, the communication link from the telephony system to the mail server must use an encrypted protocol (e.g., SMTP with STARTTLS).",
        "check": "Review the configuration of all telephony systems, VoIP gateways, clients, and mail servers. Are all relevant communication links using encrypted protocols? Verify that protocols like plain SMTP, FTP, or unencrypted BINARY/TEXT are not used for transmitting voice data or voicemails. Confirm that VoIP clients are configured to prefer or require encrypted media (SRTP).",
        "asvs": "BSI IT-Grundschutz CON.3 VoIP",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_VoIP_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is detected when communication links are identified as potentially carrying telephony or VoIP data without encryption. The check specifically looks for:  1. Unencrypted protocols (like SMTP) sending data to a Mail Server, which is a common pattern for voicemail-to-email.  2. Technical assets explicitly tagged as `@Service:VoIP` communicating over generic unencrypted protocols like BINARY or TEXT, which could represent unencrypted media streams.",
        "riskAssessment": "The likelihood of exploitation is significantly increased if the unencrypted communication crosses any network trust boundary. The impact is directly related to the confidentiality of the data assets being transmitted over the link. A conversation about a 'Strictly Confidential' topic has a much higher impact than a public one.",
        "falsePositives": "This risk might be a false positive if the unencrypted communication occurs entirely within a fully trusted and physically secured network segment where interception is practically impossible. The generic detection for BINARY/TEXT protocols might flag non-VoIP traffic if the `@Service:VoIP` tag is misapplied to an asset not related to telephony.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "66_sec4.ts",
        "bsiCode": "NET.4.2",
        "id": "unauthorized-access-via-public-phone-port",
        "title": "Unauthorized Network Access via Publicly Accessible Phone (BSI NET.4.2)",
        "description": "Networked devices, such as VoIP phones, are sometimes located in areas with unrestricted physical access (e.g., lobbies, printer rooms, parking garages).",
        "impact": "Successful exploitation can lead to the leakage of sensitive organizational data, compromise of the endpoint device, and unauthorized access to internal networks. This can result in further attacks, data breaches, service disruptions, and a complete compromise of the network segment's security.",
        "action": "Implement Network Access Control and Network Segmentation for Publicly Accessible Devices",
        "mitigation": "Do not place network-connected devices in publicly accessible areas if possible. If unavoidable, apply layered security controls:",
        "check": "Are there networked devices (like VoIP phones) in publicly accessible areas? Is the network port they use protected by NAC (e.g., 802.1X)? Is the device on an isolated, restricted network segment (VLAN)?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein NET.4.2 (VoIP), specifically section 2.4 on misuse of publicly accessible phone connections. Aligns with OWASP ASVS V14.2 (Network Security) requirements for network segmentation and access control.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_2_1_VoIP_systems_edition_2022.pdf?__blob=publicationFile (BSI NET.4.2)",
        "detectionLogic": "This rule triggers for technical assets of type 'IoT device' that are located in a physically unrestricted area (indicated by the `@PhysicalAccess:Unrestricted` tag).",
        "riskAssessment": "The exploitation likelihood is considered **Very Likely** due to the ease of physical access. The impact is calculated based on the sensitivity (CIA ratings) of the internal assets the device connects to. If the network port provides access to a network with mission-critical systems, the impact is very high.",
        "falsePositives": "This can be a false positive if compensating controls like a robust Network Access Control (NAC) solution are in place and correctly configured, which would prevent an unauthorized device from gaining network access. The model should be updated to reflect this (e.g., by tagging the communication link).",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "NET.4.3": [
      {
        "file": "67_sec1.ts",
        "bsiCode": "NET.4.3",
        "id": "lack-of-consumables-for-@AssetType:Fax-or-@AssetType:Printer",
        "title": "Lack of consumables for @AssetType:Fax/@AssetType:Printer devices (BSI G 0.6)",
        "description": "Devices that produce physical output, such as @AssetType:Fax machines or printers, depend on consumables like paper and toner for their operation.",
        "impact": "A lack of consumables leads to a denial of service for the affected device. This can disrupt business processes that rely on printed documents or faxes.",
        "action": "Implement Monitoring and Replenishment Procedures for Consumables",
        "mitigation": "Establish a process for regularly monitoring the levels of all necessary consumables (paper, toner, etc.) for dependent devices.",
        "check": "Is there a documented process for monitoring and replenishing consumables? Are personnel assigned to this task?",
        "asvs": "Derived from BSI IT-Grundschutz Threat G 0.6 (Failure of consumables) applied to component SYS.3.2.1 (@AssetType:Fax devices). This is an operational availability risk.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_3_2_1_Faxgeraete.html (BSI SYS.3.2.1)",
        "detectionLogic": "This risk is triggered for any technical asset that is explicitly marked with the `@consumable-dependent` tag.",
        "riskAssessment": "The likelihood is considered 'Likely' if a device is dependent on consumables, as operational oversights can easily occur without a robust replenishment process.",
        "falsePositives": "This risk might be a false positive if the organization has a highly reliable, automated, and tested replenishment system for consumables.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "67_sec2.ts",
        "bsiCode": "NET.4.3",
        "id": "insecure-unreliable-@AssetType:Fax-transmission",
        "title": "Insecure or Unreliable @AssetType:Fax Transmission",
        "description": "@AssetType:Fax transmissions over traditional networks (like the public switched telephone network) are susceptible to various failures.",
        "impact": "Failures in @AssetType:Fax transmission can lead to faulty business decisions based on incorrect or missing information, causing operational delays and potential financial damage. The misdelivery of faxes can result in a breach of confidentiality, leading to reputational damage, competitive disadvantage, and non-compliance with data protection regulations (like @DataType:PII).",
        "action": "Secure, Monitor, and Verify @AssetType:Fax Transmissions",
        "mitigation": "For sensitive data, replace traditional faxing with more secure, verifiable electronic communication methods. If faxing is unavoidable, use encrypted @AssetType:Fax-over-IP (FoIP) solutions. Implement strict procedures for managing @AssetType:Fax server address books and for sending highly sensitive documents (e.g., four-eyes principle). Implement monitoring and alerting for transmission failures. Establish a process for senders to verify the successful and correct receipt of critical faxes.",
        "check": "Are @AssetType:Fax transmissions encrypted? Is there monitoring and alerting for failed transmissions? Are there formal procedures for managing @AssetType:Fax address books and verifying receipt of sensitive documents?",
        "asvs": "BSI IT-Grundschutz: SYS.3.2.1 @AssetType:Fax Server (Threats T 2.50 Erroneous transmission of @AssetType:Fax documents & T 2.51 Erroneous sending of @AssetType:Fax documents)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2021/bausteine/sys/sys_3_2_1_faxserver_edition_2021.html",
        "detectionLogic": "Identifies communication links to or from technical assets tagged as `@AssetType:Fax-related` that use unencrypted protocols to transmit data. The risk level is determined by the sensitivity of the data assets being transferred.",
        "riskAssessment": "The likelihood is considered 'Likely' for any unencrypted @AssetType:Fax transmission, as both transmission errors and misdelivery are common issues with this technology. The impact is calculated based on the highest Confidentiality, Integrity, or Availability requirement of the data being sent. A breach of highly confidential data or the corruption/loss of mission-critical data results in a high impact.",
        "falsePositives": "The model cannot determine if out-of-band compensating controls exist, such as a sender manually calling the recipient to confirm receipt. A link might also be a modern, secure FoIP solution that is incorrectly modeled with a generic or unencrypted protocol.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "67_sec3.ts",
        "bsiCode": "NET.4.3",
        "id": "manipulation-of-@AssetType:Fax-address-books",
        "title": "Manipulation of @AssetType:Fax Address Books and Distribution Lists",
        "description": "In @AssetType:Fax machines or @AssetType:Fax servers (often integrated with groupware), address books and distribution lists are used to store recipient numbers.",
        "impact": "Manipulation of @AssetType:Fax address books can lead to a breach of confidentiality if sensitive documents are sent to incorrect recipients.",
        "action": "Implement Strict Access Control and Auditing for Address Books",
        "mitigation": "Restrict modification permissions for @AssetType:Fax and groupware address books to authorized personnel only.",
        "check": "Are permissions to modify @AssetType:Fax/groupware address books tightly controlled? Is there an audit trail for all changes with alerts on bulk edits? Are users aware of the risk of mis-sending faxes?",
        "asvs": "ASVS V4.0.3 - 4.1 Access Control",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for technical assets that function as a mail/@AssetType:Fax server or a standalone communication device (like an IoT device representing a @AssetType:Fax machine)",
        "riskAssessment": "The impact is determined by the highest confidentiality of data processed by the asset and the highest availability requirements.",
        "falsePositives": "This risk might be a false positive if robust, non-technical controls (like a mandatory four-eyes principle for all address book changes) are in place, which cannot be modeled.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "67_sec4.ts",
        "bsiCode": "NET.4.3",
        "id": "unprotected-shared-@AssetType:Fax-machine",
        "title": "Unprotected Shared @AssetType:Fax Machine (based on BSI)",
        "description": "In many organizations, @AssetType:Fax machines are shared among multiple users for economic reasons.",
        "impact": "If confidential or strictly confidential information is received via a physically unsecured @AssetType:Fax machine,",
        "action": "Implement Physical and Procedural Controls for @AssetType:Fax Machines",
        "mitigation": "Place @AssetType:Fax machines that receive sensitive information in a secure, access-controlled room.",
        "check": "Are @AssetType:Fax machines that handle sensitive data located in physically secure areas? Is access to these machines logged or restricted?",
        "asvs": "Derived from BSI IT-Grundschutz Catalog principle regarding the physical security of shared office equipment (CON.1).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_physical_security_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers for any technical asset identified as a @AssetType:Fax machine (via the `@AssetType:Fax` tag) that receives data assets rated 'restricted' or higher in confidentiality.",
        "riskAssessment": "The impact is calculated based on the highest confidentiality of the data received by the @AssetType:Fax machine. The likelihood of exploitation is considered 'Very Likely' due to the ease of simply walking up to the machine and reading the paper.",
        "falsePositives": "A false positive might occur if the model does not accurately represent the physical security of the @AssetType:Fax machine's location.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "67_sec5.ts",
        "bsiCode": "NET.4.3",
        "id": "remnant-data-on-@AssetType:Fax-systems",
        "title": "Remnant Data on @AssetType:Fax Systems (BSI SYS.2.5.A10)",
        "description": "Depending on the technical process used by @AssetType:Fax systems to store, process, or print information, remnant data can remain on the device after faxes are sent or received.",
        "impact": "If remnant data from @AssetType:Fax transmissions is not properly sanitized, it can lead to a breach of confidentiality.",
        "action": "Implement and Enforce Secure Data Sanitization Procedures",
        "mitigation": "For @AssetType:Fax servers, use encrypted file systems and ensure that temporary files and completed jobs are securely deleted using cryptographically strong erasure methods.",
        "check": "Are @AssetType:Fax servers configured to securely delete temporary files and data from swap/paging files? Do physical @AssetType:Fax devices have certified data sanitization features enabled? Is there a formal, audited process for decommissioning hardware containing sensitive data?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.2.5 (@AssetType:Fax and Multifunction Devices), specifically requirement SYS.2.5.A10 (Secure deletion of information).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_2_5_Fax_and_multifunction_devices_edition_2023.pdf?__blob=publicationFile (BSI SYS.2.5)",
        "detectionLogic": "This risk is raised for assets that could function as a @AssetType:Fax server or a physical @AssetType:Fax/multifunction device, such as 'Mail Server', 'Client System', or 'IoT Device'. The risk is triggered if these assets process or store data with a confidentiality rating of 'restricted' or higher, as remnant data would pose a significant risk.",
        "riskAssessment": "The likelihood is considered 'likely' if sensitive data is handled, assuming no specific sanitization methods are modeled. The impact is directly related to the confidentiality and integrity of the data processed or stored by the asset. A breach of 'strictly-confidential' data has a very high impact.",
        "falsePositives": "The risk may be a false positive if the asset is a modern cloud-based @AssetType:Fax service that contractually guarantees data sanitization, or if the specific device model has certified secure-deletion features enabled by default, which is not captured in the threat model.",
        "cwe": "459",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "67_sec6.ts",
        "bsiCode": "NET.4.3",
        "id": "spoofed-or-tampered-@AssetType:Fax",
        "title": "Spoofed or Tampered @AssetType:Fax Communication",
        "description": "@AssetType:Fax transmissions are a common medium for sending documents that must bear a signature to be valid. However, just as a false sender can be faked with a forged name and letterhead, a @AssetType:Fax transmission can also be manipulated. For example, signatures can be scanned from other documents and copied onto the @AssetType:Fax document. In general, it is impossible to tell whether a signature was genuinely made or is merely a reproduced graphic file.",
        "impact": "Damages occur when recipients view the information contained therein as authentic or even legally binding. This compromises the integrity and authenticity of the transmitted data, potentially leading to financial loss, unauthorized actions, or legal disputes.",
        "action": "Use More Secure Alternatives for Legally Binding Documents",
        "mitigation": "For documents requiring a legally binding signature, replace @AssetType:Fax transmissions with more secure methods like qualified electronic signatures (QES) or secure document portals with strong authentication. If @AssetType:Fax must be used, implement a secondary out-of-band verification process (e.g., a phone call to the sender) to confirm the authenticity of critical or high-value faxes before acting upon them. Clearly define in policies which types of information are not permitted to be sent or accepted via @AssetType:Fax.",
        "check": "Are there policies defining the acceptable use of @AssetType:Fax for sensitive or legally binding documents? Is there a more secure alternative available and mandated for such documents? If faxes are still used for critical transactions, is there a mandatory out-of-band verification process in place?",
        "asvs": "N/A (BSI-derived recommendation). The risk relates to the inherent weakness of the @AssetType:Fax medium itself, which is not directly covered by a single ASVS control. Related concepts fall under data authenticity verification (ASVS V4.2).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for any technical asset identified as an @AssetType:Fax system via the `@AssetType:Fax-gateway` tag. The risk applies to the asset itself and all data assets it processes, as the integrity of the communication cannot be guaranteed.",
        "riskAssessment": "The likelihood is 'Very Likely' due to the ease of forging faxes. The impact is directly related to the integrity requirement of the data assets transmitted via @AssetType:Fax. If data assets with high integrity requirements (e.g., contracts, financial instructions) are sent, the impact is 'High' or 'Very-High'.",
        "falsePositives": "This can be considered a false positive if the @AssetType:Fax system is used exclusively for non-sensitive, non-binding information for which forgery has no significant impact, and this is enforced by policy.",
        "cwe": "345",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      }
    ],
    "OPS.1.1.1": [
      {
        "file": "68_sec1.ts",
        "bsiCode": "OPS.1.1.1",
        "id": "insufficient-personnel-capacity-it-operations",
        "title": "Insufficient Personnel Capacity in IT Operations",
        "description": "IT operations personnel are responsible for the functionality of the entire IT infrastructure, without which an organization often cannot operate. IT systems are particularly vulnerable if IT operations lack sufficient capacity.",
        "impact": "Failure to properly execute operational processes due to personnel shortages or knowledge silos can lead to severe service disruptions (Availability). It can also degrade security posture, as tasks like monitoring, patching, and incident response are neglected, impacting Confidentiality and Integrity. This can result in business downtime, data breaches, and failure to meet service level agreements.",
        "action": "Ensure Sufficient Personnel Capacity and Know-How Redundancy",
        "mitigation": "Develop and maintain a strategic personnel capacity plan for IT operations. Implement robust substitution rules (Vertretungsregelungen) for all critical operational roles to avoid single points of failure.",
        "check": "Is there a documented capacity plan for IT operations? Are there defined and tested substitution plans for key operational personnel? Is there evidence of cross-training programs for the operations team? Are critical operational procedures well-documented and accessible?",
        "asvs": "BSI IT-Grundschutz: ORP.2 Personnel (esp. A5 Substitution rules) and OPS.1.1 General IT Operations (esp. A5 Sufficient personnel resources, A15 Handling of operational disruptions and failures).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_General_IT_operations_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Raise this organizational risk for technical assets that (a) have operational role tags such as 'role:operator', 'role:devops', 'role:sre', or '@Role:Administrator', or (b) demand high Availability or Integrity (≥ Critical). Increase likelihood if the asset lacks redundancy (redundant = false) as a proxy for single-person dependency; otherwise decrease it. Assets out of scope are ignored.",
        "riskAssessment": "The impact is determined by the availability and integrity requirements of the affected asset. An asset critical for business operations ('mission-critical') will suffer a higher impact from operational failure.",
        "falsePositives": "This risk is organizational and is inferred from technical attributes. An organization might have excellent personnel planning and substitution rules that are not visible in the threat model, which would make this a false positive. Verification requires checking the organization's operational and HR-related documentation.",
        "cwe": "404",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "68_sec2.ts",
        "bsiCode": "OPS.1.1.1",
        "id": "insufficient-it-operations-documentation",
        "title": "Insufficient IT Operations Documentation (BSI-based)",
        "description": "If IT operations activities rely on insufficient, outdated, or manipulated documentation, they can cause severe disruptions. This includes incorrect incident response, configuration errors, and delays in maintenance. Without proper documentation, operational knowledge can be lost and the ability to manage and secure IT systems is diminished. Causes include a lack of coordination with service providers, poorly defined documentation processes, or failure to keep documentation current.",
        "impact": "Direct consequences include disruptions to IT functionality and incorrect or delayed incident resolution, primarily affecting Availability and Integrity. If sensitive configuration details (such as credentials or architectural weaknesses) are part of poorly secured documentation, Confidentiality is also at risk. Ultimately, this can lead to system downtime, data loss or corruption, and security breaches.",
        "action": "Establish and maintain comprehensive and secure IT operations documentation",
        "mitigation": "Create and enforce a policy for IT operations documentation. Documentation must be comprehensive, up to date, and securely stored with appropriate access controls. It should cover system administration, configuration, incident response procedures, and dependencies. Ensure clear agreements with external service providers about their documentation responsibilities. Regularly review and audit the documentation for accuracy and completeness.",
        "check": "Is there a documented process for creating, maintaining, and storing IT operations documentation? Is the documentation for critical systems complete, accurate, and regularly reviewed? Are access controls for the documentation system in place and enforced? Are incident response playbooks based on this documentation?",
        "asvs": "Derived from the BSI IT-Grundschutz module OPS.1.1.2 (Administration), particularly requirements A5 (creation of administration documentation) and A6 (maintenance of administration documentation).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_2_Administration_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This is an organizational risk that applies to all technical assets requiring operational management. The risk is raised for all in-scope, non-client, server-side assets. The impact is assessed based on the asset's criticality, as poor documentation for a mission-critical system is far more dangerous than for a non-critical one.",
        "riskAssessment": "The likelihood is often 'Likely' or 'Very Likely' in environments without a formal, enforced documentation policy. The impact correlates with the CIA requirements of the operated technical asset. A mission-critical system suffering from poor documentation will result in a High or Very High impact, whereas a non-critical internal tool might result in a Low impact.",
        "falsePositives": "This risk is organizational and cannot be fully verified by a technical model alone. The organization may have excellent, up-to-date documentation stored in a separate system not visible to the model. Verification requires auditing the actual operational documentation and processes.",
        "cwe": "755",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "68_sec3.ts",
        "bsiCode": "OPS.1.1.1",
        "id": "inadequate-operational-resources",
        "title": "Inadequate Operational Resources (BSI OPS.1.1.A10)",
        "description": "Operational resources, which encompass all IT components used to perform IT operations tasks (e.g., build servers, monitoring systems, container platforms), are critical for the efficient and secure functioning of IT processes.",
        "impact": "The unavailability of critical operational resources can prevent the timely resolution of errors or deployment of security updates to the managed IT components.",
        "action": "Ensure Redundancy and Hardening of Operational Resources",
        "mitigation": "Treat operational infrastructure with the same criticality as the business systems it manages.",
        "check": "Are all technical assets with `usage: devops` or development-relevant technologies (build pipelines, repositories) configured as `redundant: true` in the model?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.A10 High availability of components for IT operations",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_IT_operation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies technical assets that are used for operational or development purposes (`usage: devops` or technologies like 'build-pipeline', 'sourcecode-repository', etc.) but are not marked as redundant (`redundant: false`).",
        "riskAssessment": "The likelihood is considered high for any non-redundant operational system, as single points of failure are prone to disruption.",
        "falsePositives": "A risk might be a false positive if redundancy is achieved through mechanisms not captured in the model, such as cloud-native auto-healing, auto-scaling groups, or a documented and tested manual failover plan that meets the availability requirements.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "68_sec4.ts",
        "bsiCode": "OPS.1.1.1",
        "id": "abuse-of-privileged-rights-by-operations-personnel",
        "title": "Abuse of Privileged Rights by Operations Personnel (OPS.1.1.1)",
        "description": "Privileged rights held by operations personnel (admins, service providers, and similar roles) can affect the entire IT landscape. If those rights are misused—intentionally or under coercion—to sabotage, manipulate, or spy, all core security objectives (Confidentiality, Integrity, Availability) for operated components and institutional data are endangered. Typical root causes include overly broad permissions, poor offboarding, absence of segregation of duties, or the use of shared/break-glass accounts.",
        "impact": "Misuse of privileged access can trigger data exfiltration, integrity loss of critical configurations, and service outages across multiple systems. The blast radius usually spans entire platforms and environments, with financial, legal, and reputational harm.",
        "action": "Enforce least privilege, segregation of duties, and strong privileged access management (PAM)",
        "mitigation": "Implement PoLP and role-based access with strict separation between admin and non-admin tasks. Use PAM with just-in-time elevation, MFA, session recording, and approval workflows. Eliminate shared/group admin accounts; use individual, named identities. Ensure rapid de-provisioning during offboarding and periodic recertification of rights. Log and continuously review all privileged operations.",
        "check": "Are privileged roles minimal and separated (SoD)? Are shared/break-glass accounts prohibited or tightly governed? Are admin actions audited and reviewed? Are offboarding and periodic access recertifications enforced? Is PAM with MFA and JIT used for all high-value assets?",
        "asvs": "Aligned with BSI IT-Grundschutz OPS.1.1.1 (Allgemeiner IT-Betrieb)—notably A2 (Rollen/Berechtigungen), A12 (klare Betriebsprozesse), A13 (Absicherung Betriebsmittel/Dokumentation), A21 (Einbindung ins Sicherheitsmonitoring)—and ORP.4 (Identity & Access Management).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile (BSI ORP.4)",
        "detectionLogic": "Flag technical assets tagged with privileged roles (e.g., `@Role:Administrator`, `@Role:SystemAdministrator`, `@Role:ExternalServiceProvider`, `@Role:ITSecurityOfficer`) or with `account-type:shared-privileged-account`. Treat multi-tenant and high-value assets as higher impact. Consider stronger signals when tags like `break-glass`, `no-PAM`, or `no-audit` co-occur.",
        "riskAssessment": "Likelihood is typically high where persistent privileged access exists without strong PAM or auditing. Impact scales with the asset’s confidentiality and mission criticality; compromise of mission-critical, multi-tenant, or platform assets yields very high impact.",
        "falsePositives": "Lower risk where compensating controls exist—e.g., robust PAM with session monitoring, JIT elevation, MFA, immutable audit logs, and frequent access reviews. Also less relevant for strictly OT/isolated systems when modeled with appropriate constraints and monitoring.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "68_sec5.ts",
        "bsiCode": "OPS.1.1.1",
        "id": "inadequate-physical-access-control-inf1",
        "title": "Inadequate Physical Access Control (BSI INF.1)",
        "description": "If there is insufficient protection against unauthorized physical access to premises where IT equipment is located, this can be used as a starting point for any type of attack or misuse.",
        "impact": "Unauthorized physical access can lead to hardware theft, tampering with systems, installation of malicious hardware or software, and unauthorized access to sensitive data directly from the console.",
        "action": "Implement and Enforce Physical Access Controls",
        "mitigation": "Implement multi-layered physical security controls for all areas containing critical IT assets. This includes locked doors, electronic access control systems with logging, surveillance cameras, and policies for visitor access. Server racks should be individually locked.",
        "check": "Are server rooms and data centers physically secured with access controls? Is access restricted to authorized personnel and logged?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein INF.1 (General Building), Requirement INF.1.A1 (Adequate access control).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_building_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for technical assets located within physical trust boundaries (e.g., On-Premises Data Center, Dedicated Hoster) that are not explicitly tagged as having adequate physical access controls.",
        "riskAssessment": "The likelihood of exploitation is considered high if no physical security measures are modeled for an on-premises or dedicated hosting environment.",
        "falsePositives": "A model may not fully represent all existing physical security controls. The absence of a tag does not definitively mean the control is missing in reality.",
        "cwe": "1250",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "68_sec6.ts",
        "bsiCode": "OPS.1.1.1",
        "id": "social-engineering-against-it-operations",
        "title": "Social Engineering against IT Operations (Spoofing)",
        "description": "If internal or external individuals deliberately present false information to IT operations personnel, for example by falsely impersonating an authorized person (spoofing),",
        "impact": "A successful social engineering attack against IT operations can compromise all primary security goals. Administrators could be tricked into disabling security controls,",
        "action": "Implement Strong Authentication and Verification for Administrative Actions",
        "mitigation": "Protect all administrative access with Multi-Factor Authentication (MFA).",
        "check": "Are all administrative interfaces and actions protected by MFA? Are there clear, mandatory procedures for verifying sensitive requests from users or other administrators?",
        "asvs": "V2.2.1 (MFA), V1.4.2 (Awareness Training)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Social_Engineering_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for technical assets managed by administrative roles that receive communication from potentially untrusted sources (e.g., the internet, general end-user systems)",
        "riskAssessment": "The likelihood is high if administrative assets are reachable from untrusted networks or systems with only single-factor authentication (e.g., username/password).",
        "falsePositives": "The model might not be aware of out-of-band mitigating controls, such as a separate, mandatory phone call verification process for all administrative actions, which would lower the actual risk.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "68_sec7.ts",
        "bsiCode": "OPS.1.1.1",
        "id": "disruption-of-it-operations",
        "title": "Disruption of IT Operations (BSI-based)",
        "description": "If the activities of IT operations are blocked or not carried out properly, the availability and integrity of the entire IT infrastructure can be impaired. This can be caused by various factors, including inadequately designed or procured IT components that are difficult to operate, poor process planning with unclear interfaces or responsibilities, and incorrect execution of tasks by operations personnel due to insufficient know-how or unclear agreements with service providers.",
        "impact": "A disruption in IT operations can lead to a significant reduction in the availability and integrity of business-critical systems. This can halt business processes, lead to data inconsistencies, and prevent services from being delivered to customers, resulting in financial and reputational damage.",
        "action": "Establish and Maintain Robust IT Operations",
        "mitigation": "Ensure that IT components are procured and designed with operability in mind (e.g., adequate monitoring, configuration, and redundancy). Define clear operational processes, interfaces, and responsibilities, especially for interactions between different teams and with external service providers. Provide operations personnel with adequate training and documentation for all relevant operational processes and systems. Implement a robust monitoring and incident management process to quickly detect and respond to operational issues.",
        "check": "Are operational requirements (like monitoring and redundancy) considered during procurement and development? Are operational processes and responsibilities clearly documented? Is there an ongoing training program for operations staff? Are interfaces to external service providers clearly defined and secured?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.1 (IT-Betrieb) and OPS.1.1.2 (Behandlung von IT-Problemen und Störungen).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_1_IT_Betrieb_Edition_2023.pdf?__blob=publicationFile (BSI OPS.1.1.1)",
        "detectionLogic": "This risk is detected by identifying common indicators of poor operational readiness and planning. This includes: critical operational assets lacking redundancy; assets managed by operations staff (indicating a dependency on human processes); insecure or undefined communication links between operational components or with external service providers.",
        "riskAssessment": "The impact is determined by the criticality (Availability and Integrity) of the affected assets. A lack of redundancy for a mission-critical database has a very high impact. The likelihood is considered higher for concrete findings like insecure interfaces or a lack of redundancy, and medium for organizational risks like dependency on staff know-how.",
        "falsePositives": "The model identifies potential weaknesses based on declared properties. A system might be considered non-redundant in the model but have high-availability mechanisms at a lower, unmodeled layer. An unauthenticated link might be protected by network-level controls not visible in the model.",
        "cwe": "732",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "OPS.1.1.2": [
      {
        "file": "69_sec1.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "unclear-admin-responsibilities-ism2.2",
        "title": "OPS.1.1.2: Unclear or Missing Regulations for IT Administration Responsibilities",
        "description": "IT administration spans diverse tasks across many components. If responsibilities and processes are not defined, or the responsible personnel are not aware of them, significant security gaps can arise.",
        "impact": "All three security pillars can be compromised. Availability may be reduced or eliminated, confidentiality can be breached by excessive rights, and integrity can be harmed through misconfiguration.",
        "action": "Define, document, and enforce clear IT administration roles and responsibilities.",
        "mitigation": "Establish and document responsibilities and processes for all administration tasks. Grant administrative privileges strictly by least privilege and enforce segregation of duties.",
        "check": "Are admin roles and responsibilities documented and communicated? Is there a formal approval process for granting admin rights? Is segregation of duties enforced? Are admin permissions reviewed periodically?",
        "asvs": "Derived from BSI IT-Grundschutz (OPS.1.1.2 Ordnungsgemäße IT-Administration). Related fundamentals include ORP.4.A6 (Segregation of duties), ORP.4.A13 (Rules for administration), and ORP.4.A14 (Assignment of access rights).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
        "detectionLogic": "Detect in-scope, non-client, non-external technical assets with incoming communication links from assets tagged with administrative roles (e.g., '@Role:Administrator', '@Role:Operator', 'role:devops-engineer').",
        "riskAssessment": "Likelihood is set to 'Likely' for administered critical systems (organizational threat). Impact is derived from the administered asset’s CIA ratings: higher confidentiality (e.g., Strictly Confidential) or critical availability elevates impact.",
        "falsePositives": "Models may find administrative access to a critical system even when procedures are well-defined. Organizational verification is required to confirm.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "69_sec10.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "human-error-in-administration",
        "title": "Human Error in IT Administration (BSI OPS.1.1.2 / G 0.14)",
        "description": "Human errors can never be completely ruled out and can have far-reaching consequences in IT administration.",
        "impact": "An administrative error can lead to misconfigurations that compromise system security, cause service disruptions, or lead to data breaches.",
        "action": "Harden administrative processes and controls: enforce least privilege, change management with peer review, MFA for admin access, comprehensive logging/alerting, and dedicated hardened admin workstations.",
        "mitigation": "To reduce the likelihood and impact of administrative errors, implement a combination of technical and procedural controls. This includes:",
        "check": "Are administrative actions logged and reviewed? Is there a formal change management process for critical systems?",
        "asvs": "This is an organizational and operational risk. Related ASVS controls include V1 'Architecture, Design and Threat Modeling', V4 'Access Control', and V14 'Configuration', as robust access controls and secure configuration can limit the blast radius of an administrative error.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk applies to any technical asset that is subject to administrative action. It is raised when an asset carries administrative role tags (e.g., '@Role:Administrator', '@Role:Developer', '@Role:DevOpsEngineer', '@Role:ExternalServiceProvider', '@Role:ITSecurityOfficer')",
        "riskAssessment": "The likelihood of human error is treated as 'Likely'. The impact scales with the asset’s CIA ratings: high or mission-critical confidentiality/integrity/availability elevates impact, and multi-tenancy can further increase it.",
        "falsePositives": "A model cannot see procedural controls. An organization might have excellent change management, peer review, and automation that significantly reduces the real-world likelihood of a damaging error.",
        "cwe": "668",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "69_sec11.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "disruption-by-it-administration-bsi-ops",
        "title": "Disruption by IT Administration Activities (BSI-related)",
        "description": "Even if IT administration tasks are performed without errors, they can still disrupt the institution's IT services.",
        "impact": "Disruption of IT services due to administrative activities can lead to a loss of availability for critical business functions.",
        "action": "Establish and Enforce Strict Change Management and Maintenance Window Policies",
        "mitigation": "Define and strictly enforce maintenance windows for all administrative activities on production systems. Implement a formal change management process that",
        "check": "Is there a formal, enforced change management process? Are there defined and respected maintenance windows for production systems? Are administrative changes tested in a non-production environment before deployment? Are rollback procedures documented and tested?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.5 (Patch and Change Management), Requirement A 6 'Planning of patch and change management processes'.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for technical assets with at least 'important' availability that receive administrative access.",
        "riskAssessment": "The likelihood is higher for systems with high complexity or many interdependencies where unforeseen side effects are more probable. It's also considered high if formal change management processes are lacking.",
        "falsePositives": "An organization might have a very mature and strictly enforced change management process that mitigates this risk effectively, even though the model shows administrative access to critical systems.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "69_sec2.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "insufficient-documentation-bsi",
        "title": "Insufficient Documentation (BSI CON.2 / OPS.1.1.2)",
        "description": "Documentation can be insufficient if information about IT components (e.g., configuration, dependencies, or access rights) is not recorded, is incomplete, or is not kept up to date.",
        "impact": "Insufficient documentation can lead to misconfigurations or general errors in IT administration, significantly compromising Confidentiality, Integrity, and Availability.",
        "action": "Establish and Maintain Comprehensive System Documentation",
        "mitigation": "Implement a robust process to ensure that all IT components, including their configurations, access rights, network connections, and dependencies, are documented accurately.",
        "check": "Is there an established process for creating and updating system documentation? Is this process integrated with change management?",
        "asvs": "Derived from BSI IT-Grundschutz Bausteine CON.2 (Configuration Management) and OPS.1.1.2 (Proper IT Administration), specifically requirements like CON.2.A5 (Documenting the configuration) and OPS.1.1.2.A23 (Keeping a system file).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_2_Configuration_management_edition_2023.pdf?__blob=publicationFile (BSI CON.2)",
        "detectionLogic": "This is a process-level risk that applies to any technical asset. It is particularly relevant for assets that are custom-developed, as their documentation is often less standardized than that of commercial off-the-shelf products.",
        "riskAssessment": "The likelihood is considered high if there is no formal, enforced process for documentation management.",
        "falsePositives": "This risk is organizational and cannot be definitively confirmed by a technical model alone. The presence of a `custom_developed_parts` flag or high CIA ratings only indicates a higher potential impact.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "69_sec3.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "excessive-administrative-permissions",
        "title": "Excessive Administrative Permissions",
        "description": "Excessively broad administrative permissions can be exploited for sabotage or for spying on information, which can then serve as a starting point for further attacks. This endangers all information security objectives (Confidentiality, Integrity, and Availability). The risk increases when offboarding processes are inadequate, allowing former administrators to retain privileged access.",
        "impact": "Abuse of excessive permissions can lead to unauthorized modification or destruction of data (Integrity), exposure of sensitive information (Confidentiality), and disruption or complete loss of services (Availability). An attacker with such privileges can create backdoors, erase audit logs, or escalate privileges within the infrastructure, potentially resulting in a complete system compromise.",
        "action": "Enforce the Principle of Least Privilege (PoLP) and Just-in-Time (JIT) access",
        "mitigation": "Review and restrict administrative permissions to the absolute minimum required for each role. Implement fine-grained access control aligned with job functions. Use a Privileged Access Management (PAM) solution to manage, monitor, and control privileged sessions. Employ just-in-time (JIT) access mechanisms that grant temporary permissions for specific tasks. Regularly audit administrative accounts, their assigned permissions, and their activity. Ensure a robust and timely offboarding process that revokes all access for departing personnel.",
        "check": "Are administrative permissions regularly audited? Is there a documented process for granting and revoking administrative rights based on the principle of least privilege? Are PAM or JIT solutions in use? Are administrative tasks performed using dedicated, audited accounts?",
        "asvs": "V4.2 - Verify that the principle of least privilege is used to grant access and permissions to data and functionality.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for in-scope technical assets that are associated with administrative roles (e.g., tagged with `@Role:Administrator`, `@Role:ITSecurityOfficer`). The risk assumes that, without specific controls like a PAM or JIT system, these permissions might be overly broad by default, posing a significant threat.",
        "riskAssessment": "The likelihood of exploitation is higher for assets exposed to the internet or easily accessible within the internal network. The impact correlates with the CIA rating of the technical asset and the data it processes or stores. An administrator on a mission-critical, multi-tenant database poses a much higher risk than on a standalone, non-critical internal tool.",
        "falsePositives": "The model cannot verify the presence or effectiveness of external compensating controls such as a fully implemented PAM solution, rigorous JIT access policies, or strict real-time auditing. If such controls are confirmed to be in place and effective for the identified asset, this risk can be considered a false positive or mitigated.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "69_sec4.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "insecure-administrative-access",
        "title": "Insecure Administrative Access",
        "description": "Administrative access points (for configuration, maintenance, or monitoring) grant powerful privileges over systems and data. If these channels are not sufficiently secured, unauthorized individuals may gain access via weak authentication, unencrypted protocols, or exposure to untrusted networks.",
        "impact": "A successful exploit not only risks confidentiality of administrative data and configurations, but can enable manipulation of systems (integrity) or service disruption (availability). Compromised admin access is a common pivot for broader attacks and endangers all security objectives.",
        "action": "Harden Administrative Access Channels (encryption, MFA, network gating)",
        "mitigation": "Protect all administrative access with strong multi-factor authentication (MFA). Ensure all admin traffic uses encrypted protocols, preferably via dedicated secure channels (VPN, bastion/jump host) when crossing or originating from untrusted networks. Apply least privilege for admin roles, and comprehensively log and monitor administrative actions.",
        "check": "Are all admin interfaces behind MFA? Are they reachable only from trusted networks (e.g., via VPN/bastion) with IP filtering? Are protocols encrypted end-to-end? Are admin actions immutably logged and regularly reviewed?",
        "asvs": "V4 Access Control, e.g., 4.1.2 (Least Privilege for Admin Interfaces) and 4.2.1 (Strong Credentials/MFA for Admin Accounts)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "Identifies administrative communication links (Usage.DevOps) with missing MFA (authentication != TwoFactor), unencrypted protocols, or internet exposure from the source asset without VPN or IP filtering. Out-of-scope targets are ignored.",
        "riskAssessment": "Impact follows the target asset’s confidentiality/integrity/availability requirements. Likelihood is very high for internet-exposed access without compensating controls or when authentication is 'None'; otherwise medium–high if MFA or encryption is missing on internal links.",
        "falsePositives": "May trigger on DevOps links that are non-privileged or already protected by controls not modeled (e.g., jump hosts, PAM). Validate environment context, emergency-only paths, or temporary maintenance tunnels.",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "69_sec5.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "lack-of-redundant-admin-knowledge-orp-4-a5",
        "title": "Lack of Redundant Administrator Knowledge (BSI ORP.4.A5)",
        "description": "If the necessary knowledge for IT administration is not redundantly available among administrators,",
        "impact": "Failure to perform critical administrative tasks due to knowledge monopolies or lack of deputies can severely impact the availability of IT systems",
        "action": "Ensure Redundancy in Administrative Knowledge, Access, and Documentation",
        "mitigation": "Establish and enforce a policy for substitution for all critical administrative roles. This includes designating and training deputies.",
        "check": "Are deputies formally designated for all critical administrative roles? Is there up-to-date, accessible, and comprehensive documentation for all administrative tasks?",
        "asvs": "BSI IT-Grundschutz Kompendium: Baustein ORP.4 (Personal), Anforderung ORP.4.A5 (Regelung von Vertretungen / Regulation of substitution).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Personnel_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organizational risk is triggered for any in-scope technical asset that is associated with an administrative role (via `role:*` tags).",
        "riskAssessment": "The likelihood is considered 'Likely' as personnel turnover, illness, or vacation are common events.",
        "falsePositives": "The risk might be a false positive if the organization has robust, well-documented, and tested substitution policies that are not visible in the threat model.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "69_sec6.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "administrator-staff-shortage",
        "title": "Administrator Staff Shortage (based on BSI Generic Threat)",
        "description": "If there is a shortage of administrative staff (e.g., due to insufficient staffing plans, overbooking, illness, or pandemics), necessary administration tasks may not be performed in time.",
        "impact": "Missed tasks and administrative errors can reduce availability, increase attack surface (e.g., missed patching or misconfigurations), and jeopardize confidentiality, integrity, and availability.",
        "action": "Ensure Adequate Staffing, Training, and Tooling for Administrators",
        "mitigation": "Establish robust personnel/resource planning for administrative teams, including coverage for absences and emergencies. Implement cross-training and procedure documentation to avoid single points of failure.",
        "check": "Is there a formal capacity plan for operations/admin? Are there enough administrators to cover tasks without chronic overtime?",
        "asvs": "Derived from BSI IT-Grundschutz ORP.2 (Personnel), esp. ORP.2.A5 (Staffing of roles), requiring adequate staffing and qualification.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile (BSI ORP.2)",
        "detectionLogic": "Organizational risk surfaced at the asset level. A finding is created for technical assets tagged with administrative responsibility (e.g., @Role:Administrator, @Role:SystemAdministrator, @Role:DevOps, @Role:ExternalServiceProvider).",
        "riskAssessment": "Likelihood defaults to 'Likely' where ongoing administration is needed. Impact is scaled from the asset’s own CIA classification (mission-critical assets → very high).",
        "falsePositives": "This risk is raised based on administrative role tags and cannot be confirmed without insight into actual staffing levels and workload.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "69_sec7.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "inadequate-securing-of-admin-tools",
        "title": "Inadequate Securing of Administration Tools (based on BSI CON.8.A24)",
        "description": "Administration tools grant extensive access to an institution's IT systems. If these tools are inadequately secured, they pose a significant risk to all information security objectives. A primary cause for this vulnerability is the insufficient separation of administrative tools and tasks from non-administrative ones. For example, using the same client system, or even the same applications (like an SSH client or text editor), for both IT administration and general-purpose tasks (like browsing the web or checking email) creates a pathway for attackers to compromise the administrative session.",
        "impact": "If an attacker gains control over an inadequately secured administration tool, they can acquire far-reaching privileges. These privileges can be abused to sabotage IT administration, conduct unauthorized administrative actions, and launch further attacks against connected systems. This compromises the confidentiality, integrity, and availability of all managed IT assets, leading to data breaches, system downtime, and loss of control over the infrastructure.",
        "action": "Isolate Administrative Environments and Tools",
        "mitigation": "Use dedicated, hardened systems (physical or virtual) exclusively for administrative tasks. These 'Secure Admin Workstations' (SAWs) should not be used for general office work, email, or web browsing. Administrative access should be routed through hardened jump hosts or bastion servers. Enforce multi-factor authentication (MFA) for all administrative access. Use separate, privileged user accounts for administration that are distinct from standard user accounts. Network segmentation should be used to isolate administrative access paths from general user networks.",
        "check": "Are dedicated, isolated systems used for all administrative tasks? Is there a strict separation between administrative and non-administrative user accounts and sessions? Is administrative access restricted to specific network paths and controlled via bastion hosts? Is MFA enforced for all privileged access?",
        "asvs": "BSI IT-Grundschutz CON.8: Software development and testing; specifically A24 Segregation of administration clients. The principle also aligns with OPS.1.1.5 Administration using a standard client.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Software_development_and_testing_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified when a technical asset (like a desktop, client system, or CLI tool) is used for both administrative purposes and non-administrative, potentially less secure, activities. The model detects this by finding a client asset that has outgoing communication links with a 'devops' usage (indicating administration) and simultaneously has links with a 'business' usage (indicating general tasks). The risk is higher if the business usage involves connecting to the internet.",
        "riskAssessment": "The likelihood is high if a client asset mixes 'devops' and 'business' usage, and very high if the business usage includes internet access. The impact is determined by the highest CIA requirements of the systems being administered via the 'devops' links. Administering mission-critical databases from a mixed-use client poses a very high impact.",
        "falsePositives": "A model might flag a 'Desktop' asset as being used for mixed purposes. In reality, the organization might use a properly isolated Virtual Machine (VM) on that desktop for administrative tasks. The model cannot see this level of detail, which could result in a false positive. Manual verification of the administrative procedures is required.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "69_sec8.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "failure-of-administration-tools-ops115",
        "title": "Failure of Administration Capabilities (BSI-based)",
        "description": "If administration capabilities fail and, due to poor planning, there is no redundancy or alternative,",
        "impact": "A failure of critical, non-redundant administration tools leads to an inability to manage, monitor, or repair other IT systems.",
        "action": "Ensure Redundancy and Failover for Critical Administration Tools",
        "mitigation": "Identify all critical administration tools and components within the infrastructure.",
        "check": "Are all critical administration and infrastructure components (e.g., identity providers, container platforms, monitoring systems, CI/CD pipelines) designed to be redundant?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.5 Redundancy (Requirement A4 - Redundancy for central infrastructure services) and OPS.1.1.3 Patch and change management.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Redundancy_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for technical assets that are identified as administrative or critical infrastructure components, are rated as having 'Important' or higher availability requirements, and are explicitly marked as not being redundant in the model.",
        "riskAssessment": "The likelihood is considered 'Likely' because single points of failure (SPOFs) in complex systems are prone to eventual failure from hardware faults, software bugs, or human error (misconfiguration, bad patches).",
        "falsePositives": "A risk might be flagged for a component that has out-of-band or manual recovery procedures that are considered acceptable by the organization, even without being marked as 'redundant' in the model. This should be verified with the system architects or operations team.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "69_sec9.ts",
        "bsiCode": "OPS.1.1.2",
        "id": "misleading-it-administration",
        "title": "Misguided IT Administration (Fehlgeleitete Administration)",
        "description": "If IT administration is misled—for example, by an attacker injecting false information—administrators can be tricked into performing incorrect or harmful actions.",
        "impact": "Successful exploitation can lead to the manipulation of information, hardware, or software, compromising availability and integrity.",
        "action": "Implement strict verification and communication protocols for administrative actions",
        "mitigation": "Establish and enforce strict, out-of-band verification procedures for any critical administrative request (e.g., system restarts, configuration changes, user account modifications).",
        "check": "Are there formal, documented processes for critical administrative actions? Do these processes include out-of-band verification steps? Are administrators trained on social-engineering threats? Is there a secure, dedicated channel for administrative communication?",
        "asvs": "Based on BSI IT-Grundschutz, OPS.1.1.2 (section 2.9 “Fehlgeleitete Administration”) and general social-engineering threats against operators.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Incident_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any in-scope technical asset managed by personnel with administrative roles.",
        "riskAssessment": "The likelihood is higher for assets that are critical and managed by multiple administrators, increasing the social-engineering attack surface.",
        "falsePositives": "The risk might be considered a false positive if the organization has exceptionally strong, enforced, and audited out-of-band verification processes for all administrative actions, making such social-engineering attempts highly unlikely to succeed.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Spoofing"
      }
    ],
    "APP.2.3": [
      {
        "file": "6_sec1.ts",
        "bsiCode": "APP.2.3",
        "id": "improper-ldap-backend-selection",
        "title": "Improper OpenLDAP Backend Selection",
        "description": "If OpenLDAP backends, directives, and parameters are chosen incorrectly, they can negatively affect the functions offered by the directory service.",
        "impact": "Misconfiguration of the LDAP backend can severely limit the service's functionality, integrity, and availability. It can prevent proper management of a large user base,",
        "action": "Ensure a Robust and Scalable Backend is Used for OpenLDAP",
        "mitigation": "For production environments, configure OpenLDAP to use a robust, transactional backend like 'mdb' (Memory-Mapped Database), which is the recommended default.",
        "check": "Inspect the OpenLDAP server's configuration (e.g., slapd.conf or cn=config) to identify the configured database backend for the main suffix(es). Verify that the backend is suitable for the intended load and scale.",
        "asvs": "N/A. This is a specific technology configuration issue. The principle aligns with OWASP ASVS V14.1 (Configuration) but is more specific than any single requirement.",
        "cheatSheet": "https://www.openldap.org/doc/admin26/backends.html",
        "detectionLogic": "Automatically detects technical assets of type 'LDAP Server' or 'Identity Store (LDAP)' that are not explicitly tagged with a robust backend.",
        "riskAssessment": "The impact is determined by the CIA requirements of the assets relying on this LDAP server. If it is used for mission-critical authentication, the impact is high.",
        "falsePositives": "This risk might be a false positive for very small, non-critical, or temporary deployments where a simple backend might be sufficient and the operational risks are accepted.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "6_sec2.ts",
        "bsiCode": "APP.2.3",
        "id": "bsi-openldap-overlay-planning",
        "title": "Poorly Planned OpenLDAP Overlays (BSI-derived)",
        "description": "The BSI notes that if the use of OpenLDAP overlays is poorly planned, unnecessary operations may be executed or other functions may be impaired.",
        "impact": "This vulnerability can lead to incorrect or completely missing access logs, which undermines non-repudiation and can hide security incidents like data breaches or unauthorized modifications.",
        "action": "Develop and Enforce a Clear Configuration and Logging Plan for OpenLDAP Overlays",
        "mitigation": "Define and document the required functionality for all OpenLDAP overlays, with special attention to those responsible for logging ('auditlog', 'accesslog') and access control.",
        "check": "Is there a documented plan for OpenLDAP overlay usage? Are logging overlays like 'auditlog' and 'accesslog' configured correctly and are the logs monitored?",
        "asvs": "V14.2.1: Secure Configuration",
        "cheatSheet": "https://www.openldap.org/doc/admin24/overlays.html",
        "detectionLogic": "This risk is raised for any technical asset identified as an OpenLDAP server (technology: `ldap-server`).",
        "riskAssessment": "The likelihood is considered 'Likely' because secure configuration of specialized components like OpenLDAP overlays requires specific expertise that may not always be present.",
        "falsePositives": "This risk might be a false positive if a robust, audited configuration management and review process for the OpenLDAP server is in place, even if not explicitly captured in the threat model.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "6_sec3.ts",
        "bsiCode": "APP.2.3",
        "id": "unsuitable-environment-for-ldap",
        "title": "Unsuitable System Environment for OpenLDAP (BSI APP.2.3 / APP.3.2.A6)",
        "description": "OpenLDAP can malfunction when its live database (e.g., mdb/hdb) resides on network/distributed filesystems such as NFS or SMB/CIFS. These platforms often do not fully support POSIX file locking and atomic semantics needed by database backends. Missing or unreliable locks can cause write-race conditions, stale pages, and database corruption.",
        "impact": "Loss of integrity and availability of the directory service. Corruption or inconsistent states can break authentication/authorization flows for dependent applications, leading to outages and possibly forced restores with data loss.",
        "action": "Ensure the live LDAP database uses suitable local or block-level storage",
        "mitigation": "Store the OpenLDAP database and runtime state on storage that guarantees local POSIX locking and correct fsync semantics (e.g., ext4, XFS, APFS, or SAN block devices). Avoid NFS/SMB for the live database path. If network shares are required, restrict them to backups/exports/logs only and keep the live DB local.",
        "check": "Inspect the LDAP host's mount table and the configured database directory. Verify there is no writable NFS/SMB mount involved. In the model, look for write-capable communication links from an LDAP Server to a Datastore using NFS/SMB protocols.",
        "asvs": "BSI IT-Grundschutz APP.2.3 (Section 2.1); APP.3.2.A6",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_2_LDAP_en.html",
        "detectionLogic": "Detect in-scope technical assets with technology 'LDAP Server' that have non-readonly communication links using Protocol.NFS or Protocol.SMB pointing to a Datastore/File-Server asset. Such writable links indicate that the live database might be placed on an unsuitable distributed filesystem.",
        "riskAssessment": "Likelihood is high because the misconfiguration is self-exploiting during normal operations (concurrent writes). Impact scales with the LDAP server's integrity/availability criticality, often high due to its central role in authN/authZ.",
        "falsePositives": "May be a false positive if the NFS/SMB share is strictly for backups, exports, or logs and not the live database location. The model may not differentiate usage purpose; manual verification is recommended.",
        "cwe": "662",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "6_sec4.ts",
        "bsiCode": "APP.2.3",
        "id": "ldap-version-incompatibility",
        "title": "LDAP Version Incompatibility (BSI)",
        "description": "Incompatible versions of one or more applications may attempt to access the databases used by an LDAP server.",
        "impact": "If an incompatible client application connects to the LDAP server, it can lead to Denial of Service (through repeated connection failures or resource exhaustion),",
        "action": "Ensure and Verify Component Compatibility",
        "mitigation": "Maintain a bill of materials for all applications that connect to the LDAP server. Before deploying or updating a client application,",
        "check": "Is there a documented list of client applications and their versions that are certified to work with the production LDAP server?",
        "asvs": "V14.2.5: Verify that third-party components are from a trusted source and have a secure configuration.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html",
        "detectionLogic": "Identifies all 'LDAP Server' or 'LDAP Identity Store' technical assets. The risk is raised if these assets receive communications from other application components,",
        "riskAssessment": "The likelihood increases with the number and diversity of client applications connecting to the LDAP server. The impact is directly related to the",
        "falsePositives": "This risk can be considered a false positive if the organization enforces a strict version control and compatibility testing regime for all clients",
        "cwe": "1104",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "6_sec5.ts",
        "bsiCode": "APP.2.3",
        "id": "inconsistent-ldap-state-mixed-access-bsi-app-2-3",
        "title": "Inconsistent LDAP State from Mixed Access (BSI APP.2.3, Section 2.2)",
        "description": "Data in an OpenLDAP directory, including both directory objects and configuration settings, can be accessed through different methods.",
        "impact": "If both online and offline access methods are used without proper synchronization or understanding, the resulting LDAP database can become inconsistent.",
        "action": "Standardize and Restrict Access Methods to LDAP Database",
        "mitigation": "Define a strict and exclusive procedure for modifying the LDAP database. Prefer using standard online LDAP operations for all changes.",
        "check": "Review the operational runbooks for the LDAP server. Are there procedures that involve both online LDAP commands and offline file manipulation?",
        "asvs": "Derived from BSI IT-Grundschutz APP.2.3 (mixing online and offline access to the OpenLDAP database; see Section 2.2). This is a specific operational risk that does not directly map to an OWASP ASVS requirement.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_OpenLDAP_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is identified for any technical asset of technology type 'LDAP Server' that has both incoming communication links using the LDAP/LDAPS protocol (online access)",
        "riskAssessment": "The likelihood is higher if multiple administrative roles or systems have different types of access. The impact is directly related to the **Integrity** and **Availability**",
        "falsePositives": "The risk might be a false positive if the offline access protocols are used strictly for non-conflicting purposes (e.g., log file shipping, monitoring) and not for database manipulation,",
        "cwe": "345",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "OPS.1.1.3": [
      {
        "file": "70_sec1.ts",
        "bsiCode": "OPS.1.1.3",
        "id": "unclear-responsibilities-in-processes-bsi-orp1-a2",
        "title": "Unclear or Overlapping Responsibilities (BSI ORP.1.A2)",
        "description": "Poorly defined, overlapping, or unclear responsibilities for security-relevant processes can lead to significant delays and errors.",
        "impact": "In extreme cases, poorly defined responsibilities can disrupt the entire system or large parts of it. Operational disruptions negatively affect Availability.",
        "action": "Clearly Define, Document, and Communicate Roles and Responsibilities",
        "mitigation": "Establish and document clear responsibilities for all security-relevant processes, particularly for patch and change management, incident response, and access control.",
        "check": "Is there a documented patch and change management process? Are roles and responsibilities for testing, approving, and deploying changes clearly defined and assigned?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information security organisation), Requirement ORP.1.A2 (Defining roles and responsibilities).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
        "detectionLogic": "This is an organizational risk that can be modeled against technical assets where process failures have a high impact.",
        "riskAssessment": "The likelihood is considered 'Likely' by default, as this process weakness is common in many organizations.",
        "falsePositives": "This risk is raised based on the type of asset, not on direct evidence of a process failure. The model cannot know the quality of an organization's internal processes.",
        "cwe": "306",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "70_sec2.ts",
        "bsiCode": "OPS.1.1.3",
        "id": "inadequate-patch-and-change-management-ops-1-1-5",
        "title": "Inadequate Patch and Change Management (BSI OPS.1.1.5)",
        "description": "If patch and change management has low acceptance within the institution, or communication among a project's or system's stakeholders is poor, change requests may be delayed or be decided on incorrectly. This can lower the overall security level and seriously disrupt IT operations.",
        "impact": "Poor communication makes the change process inefficient, requiring excessive time and resources. This harms the institution's responsiveness and, in extreme cases, can introduce security vulnerabilities or prevent important business objectives from being achieved. The primary impacts concern the Integrity of systems (untested changes, new vulnerabilities) and Availability (disruption of IT operations).",
        "action": "Establish a formalized and well-communicated patch and change management process",
        "mitigation": "A documented patch and change management process must be established and consistently followed. This process should define clear roles and responsibilities, communication channels, testing procedures for all changes, and rollback plans. All changes, including patches, should be documented in a central system. Emergency change procedures should also be defined and tested. Ensure all involved personnel are trained on the process.",
        "check": "Is there a documented patch and change management policy? Are roles and responsibilities defined? Are all changes tested before deployment to production environments? Is there a documented history of all applied changes?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.5 (Patch and change management), particularly Requirements A1 (Planning of patch and change management), A4 (Documenting changes), and A6 (Testing of patches and changes).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organizational risk is often reflected in technical assets that require frequent manual intervention or are part of a complex delivery pipeline. This rule triggers on assets that have custom-developed parts or are related to development and operations infrastructure, as these are prime candidates for failures in the change management process. The risk also applies to assets managed by key operational roles.",
        "riskAssessment": "The likelihood is higher for assets that are custom-developed, as they lack standardized, automated update mechanisms. Impact directly depends on the asset's business criticality (CIA ratings). A failed change on a mission-critical, internet-facing asset has a much higher impact than on a non-critical internal system.",
        "falsePositives": "The model cannot verify the actual quality of an organization's patch and change management process. An organization might have a very mature, well-executed manual process for assets flagged as 'custom-developed', effectively mitigating this risk. This can only be verified by interviewing responsible staff and reviewing change logs and process documentation.",
        "cwe": "937",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "70_sec3.ts",
        "bsiCode": "OPS.1.1.3",
        "id": "inadequate-change-management-con-3-g5",
        "title": "Inadequate Change Management (BSI CON.3.G5)",
        "description": "Unsuitable or improperly assessed changes to IT systems can impair business processes, lead to system failures, or reduce the overall security level. This often occurs when testing is insufficient or when there is a lack of coordination between IT, security, and business departments during the change approval and implementation process.",
        "impact": "Flawed changes can directly impact the availability of services, causing business disruptions and outages. They can also introduce new vulnerabilities, compromising the confidentiality and integrity of data. This may lead to data breaches, financial loss, and reputational damage.",
        "action": "Implement a formal and comprehensive change management process",
        "mitigation": "Establish a documented change management policy that applies to all production systems. The process must include: formal change requests (CRs), risk and security impact analysis for each CR, approval workflows involving all relevant stakeholders (business, IT, security), dedicated testing in a pre-production environment, and a clear rollback strategy. Ensure all changes are tracked and audited.",
        "check": "Is there a formal change management process? Are all changes to production environments logged and approved? Does the process mandate security reviews and testing? Are rollback plans in place for critical changes?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.3 (Change Management), specifically threat G5 'Unzureichendes Änderungsmanagement' (insufficient change management).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Change_management_Edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.3)",
        "detectionLogic": "This organizational risk is identified on technical assets that are central to the software development and deployment lifecycle (e.g., build pipelines, source code repositories, container platforms) or are critical, custom-developed applications. The risk is higher for assets involved in 'DevOps' communication flows, as these are points where automated changes are funneled into production.",
        "riskAssessment": "The likelihood is considered higher for assets central to development and deployment. The impact is calculated based on the Confidentiality, Integrity, and Availability (CIA) ratings of the affected asset and the data it processes or stores. An improper change to a system with mission-critical data has a much higher impact than a change to a less critical component.",
        "falsePositives": "This risk is raised based on the technical role of an asset. The model cannot verify the actual quality of the organization's change management process. A well-disciplined organization might have a robust process, rendering this a false positive. Verification requires auditing the change management policy and its implementation.",
        "cwe": "755",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "70_sec4.ts",
        "bsiCode": "OPS.1.1.3",
        "id": "inadequate-patch-management-resources",
        "title": "Inadequate Resources for Patch and Change Management (BSI OPS.1.1.3)",
        "description": "Effective patch and change management requires adequate personnel, time, and financial resources. If these are not available, necessary roles may be filled by unsuitable personnel, communication channels between IT and business departments may not be established, and the required infrastructure for testing and deployment environments may not be provided. While such deficiencies can sometimes be compensated for during normal operations, they become particularly apparent under time pressure, such as when emergency patches must be deployed.",
        "impact": "A lack of resources for patch management leads to delayed or failed patching, leaving systems vulnerable to exploitation. This can result in the compromise of confidentiality, integrity, and availability of the organization's information and assets, leading to data breaches, system downtime, and significant financial or reputational damage.",
        "action": "Ensure Sufficient Resources for Patch and Change Management",
        "mitigation": "Allocate a sufficient budget for patch and change management activities. Assign qualified personnel to defined roles and responsibilities, and provide them with adequate time for testing and deployment. Establish clear, documented processes and communication channels between IT operations, development, and business departments. Maintain separate, adequately equipped environments for testing patches before deploying them to production systems. Use a tag like `@patch-process:managed` on assets to denote that a formal process is in place.",
        "check": "Are roles and responsibilities for patch management clearly defined and assigned to qualified individuals? Is there a documented process that includes communication with business departments? Are separate test/staging environments used for patch validation before production deployment? Is there a dedicated budget for these activities?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.3 (Patch and change management), especially requirements OPS.1.1.3.A1 (Concept for patch and change management) and OPS.1.1.3.A15 (Regular updating of IT systems and software).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This organizational risk is raised for all in-scope, non-client, non-library technical assets that are likely to require regular patching. The risk can be mitigated on a per-asset basis by applying a `@patch-process:managed` tag, which indicates that a formal, well-resourced process is in place for that asset.",
        "riskAssessment": "The likelihood of exploitation is higher for internet-facing systems and systems built on common third-party technologies. The impact is directly correlated with the business criticality (CIA) of the asset and the data it processes or stores. An unpatched, internet-facing asset with high-value data represents a very high risk.",
        "falsePositives": "This risk is raised based on the absence of explicit information about a managed patching process in the model. The model cannot verify the actual quality or resourcing of an organization's patching process. Therefore, this finding should be considered a strong recommendation to verify the process and its resource allocation externally.",
        "cwe": "1104",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "70_sec5.ts",
        "bsiCode": "OPS.1.1.3",
        "id": "flawed-patch-distribution-sys-1-3-g5",
        "title": "Faulty Automated Patch/Change Distribution (BSI OPS.1.1.3 §2.5)",
        "description": "Patches and changes are often distributed centrally using software-based automation.",
        "impact": "A faulty or malicious patch distributed via a central management system can introduce widespread vulnerabilities, system instability, or denial of service across numerous assets.",
        "action": "Harden, Stage, and Verify Patch Distribution",
        "mitigation": "Establish a multi-stage deployment process (e.g., dev, test, prod) to vet patches and changes before a full rollout.",
        "check": "Is there a central patch/change management system? Are patches and changes thoroughly tested in a pre-production environment before rollout?",
        "asvs": "BSI OPS.1.1.3 Patch- und Änderungsmanagement",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_3_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Automatically detects central DevOps assets (Usage = DevOps) that act as software/patch distribution hubs.",
        "riskAssessment": "Likelihood: 'Likely' due to automation complexity and human error in change management.",
        "falsePositives": "The model can identify the architectural pattern of centralized management but cannot assess the maturity of operational processes (testing, approvals, staged rollouts).",
        "cwe": "1104",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "70_sec6.ts",
        "bsiCode": "OPS.1.1.3",
        "id": "inadequate-patch-rollback-capability",
        "title": "Inadequate Patch/Change Rollback Capability",
        "description": "When patches or changes are distributed without a provisioned recovery option, or if the recovery routines of the software used are ineffective or inadequate, faulty updated software cannot be corrected in a timely manner. This can lead to the failure of important IT systems and result in high consequential damages.",
        "impact": "A failed update without a proper rollback plan can lead to extended outages, data corruption, or loss. The availability and integrity of the data and the affected IT systems are particularly endangered, potentially disrupting critical business processes.",
        "action": "Implement and test rollback plans for patches and changes",
        "mitigation": "Establish a formal change management process that requires a tested rollback or recovery plan for every significant patch or change. This can include system snapshots, database backups, application versioning, or blue-green/canary deployment strategies. The recovery procedure must be documented, and its effectiveness should be verified periodically, especially for critical systems. Ensure that personnel are trained on how to execute the rollback procedures.",
        "check": "Is there a documented change management process requiring a rollback plan for changes? Are these rollback plans tested before deploying the actual change to production? Can the operations team demonstrate a successful rollback from a recent deployment in a test or staging environment?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.5 Patch and Change Management, particularly requirement A6 (fallback option for patches).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This is a process-related risk. The rule triggers on technical assets where the impact of a failed update would be most severe. It identifies assets with high integrity or availability requirements, custom-developed components that change frequently, and key DevOps systems. The risk is heightened for non-redundant assets, where a single failure leads to a complete outage.",
        "riskAssessment": "The impact is directly derived from the availability and integrity rating of the affected technical asset. The likelihood is considered higher for non-redundant systems, as there is no immediate failover capability to mitigate the impact of a failed patch. For all other critical systems, the likelihood is assumed to be 'likely' to reflect the common operational challenge of maintaining perfect, tested rollback plans for every change.",
        "falsePositives": "This risk is raised based on asset criticality, assuming a potential weakness in operational processes. An organization may have an excellent and rigorously tested change management and rollback procedure, which cannot be verified by the model. This risk should be confirmed by reviewing the actual operational processes.",
        "cwe": "755 // CWE-755: Improper Handling of Exceptional Conditions (a failed patch being an exceptional condition that requires a recovery routine).",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "70_sec7.ts",
        "bsiCode": "OPS.1.1.3",
        "id": "flawed-patch-and-change-management",
        "title": "Flawed Patch and Change Management (BSI CON.1)",
        "description": "If changes are prioritized incorrectly, critical security patches might be installed too late, leaving known vulnerabilities open for exploitation.",
        "impact": "This can result in systems remaining vulnerable to known exploits, significantly increasing the likelihood of compromise. The integrity, availability, and confidentiality of the system and the data it processes are put at risk. Unpatched systems are a primary vector for attacks that can lead to data breaches, service disruptions, and unauthorized access.",
        "action": "Establish and Adhere to a Robust Patch and Change Management Process",
        "mitigation": "Define and enforce a clear, risk-based process for identifying, prioritizing, testing, and deploying patches and system changes.",
        "check": "Is there a documented patch and change management policy? Are patches consistently prioritized based on vulnerability severity and asset criticality? Are changes tested in a pre-production environment? Is there a verification process to confirm successful deployment and functionality?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Patch and change management).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for all technical assets that require regular patching (e.g., servers, applications, databases), excluding serverless components and the DevOps/management tools themselves.",
        "riskAssessment": "The impact is determined by the confidentiality, integrity, and availability (CIA) requirements of the technical asset and the data it handles.",
        "falsePositives": "This risk can be considered a false positive if a robust, effective, and well-documented patch management process exists for the asset, even if it is not fully represented by a 'build-pipeline' in the threat model.",
        "cwe": "937",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "70_sec8.ts",
        "bsiCode": "OPS.1.1.3",
        "id": "compromised-patch-management-system",
        "title": "Compromise of Patch and Change Management System",
        "description": "Patch and change management systems often operate from a central position to distribute software and updates.",
        "impact": "A successful attack can lead to widespread compromise across many systems, severely impacting the integrity, confidentiality, and availability of the entire ecosystem.",
        "action": "Harden Software Supply Chain Infrastructure",
        "mitigation": "Implement strict access control and network segmentation for all components of the software supply chain (source code repositories, build pipelines, artifact registries).",
        "check": "Are patch and artifact management systems isolated from general corporate networks? Is all administrative access secured with strong authentication?",
        "asvs": "V14.2 Software and Component Integrity Requirements",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Software_Component_Verification_Cheat_Sheet.html",
        "detectionLogic": "This rule identifies central components of the software delivery pipeline (e.g., Build Pipeline, Artifact Registry, Source Code Repository) that distribute software to multiple other assets.",
        "riskAssessment": "The impact is calculated based on the number and sensitivity of the downstream systems that receive software from this central component.",
        "falsePositives": "This rule may flag any central build system as risky.",
        "cwe": "494",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "OPS.1.1.4": [
      {
        "file": "71_sec1.ts",
        "bsiCode": "OPS.1.1.4",
        "id": "malware-infection-via-unpatched-client-software",
        "title": "OPS.1.1.4 – Malware Infection via Unpatched Client Software",
        "description": "If IT systems, particularly client-side applications like browsers or mobile apps, are not adequately protected against malware, attackers can exploit software vulnerabilities to execute malicious code. This often occurs when security patches are not applied promptly or when protection mechanisms are misconfigured. A common attack vector is a 'drive-by-download', where simply visiting a compromised website can lead to infection.",
        "impact": "A successful exploit can lead to system infection, giving an attacker extensive control over the compromised asset and a potential foothold into the institution's internal network. This can result in data theft (compromising Confidentiality), system modification (compromising Integrity), and inclusion in botnets for DDoS attacks (compromising Availability).",
        "action": "Establish and enforce a robust patch and vulnerability management process for all client systems.",
        "mitigation": "Keep client systems (desktops, laptops, mobile devices) and their applications (browsers, plugins) up to date with security patches. Use centrally managed, modern endpoint protection/EDR with frequent signature and engine updates. Harden browser settings to limit active content, disable deprecated plugins, and enforce safe defaults. Decommission unsupported software and hardware in time.",
        "check": "Is there a documented patch management policy for client software? Are clients regularly scanned for vulnerabilities? Is endpoint protection centrally deployed and updated? Are browser configurations hardened and enforced via management (e.g., MDM/GPO)?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.4 (Protection against malware); related: SYS.1.2.2, APP.3.2 (Web Browser), and patch management in client OS modules (e.g., SYS.1.3).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_Web_browser_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "Raised for any technical asset classified as a client (via isTechnologyClient) that is internet-connected. Typical technologies include Browsers, Mobile Apps, Desktops/Thin Clients. The rule favors internet exposure as a primary indicator of drive-by and client-side exploit risk.",
        "riskAssessment": "Likelihood is very high for internet-facing clients due to the steady discovery of client-side vulnerabilities. Impact scales with the asset’s highest CIA rating and the sensitivity of processed/stored data. Clients used for admin tasks or handling sensitive data imply higher impact.",
        "falsePositives": "May be a false positive in tightly managed environments with rapid, enforced patching, advanced EDR, application control, and strict egress filtering. Such mitigating controls cannot be fully derived from the model alone and require verification.",
        "cwe": "937",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "71_sec2.ts",
        "bsiCode": "OPS.1.1.4",
        "id": "ransomware-encryption",
        "title": "Risk of Ransomware & Malware Encryption (BSI OPS.1.1.4 / CON.8)",
        "description": "Malware—including ransomware—can execute without user awareness and encrypt or destroy information on clients, servers, mobiles, IoT and even industrial systems.",
        "impact": "Without effective malware protection and resilient backups, availability of information can be severely restricted, data may be permanently lost and operations disrupted—causing financial losses, legal exposure and reputational damage.",
        "action": "Establish multi-layered anti-malware controls and a hardened, regularly tested @Backup:Target & recovery strategy.",
        "mitigation": "Deploy enterprise-grade, centrally managed anti-malware on endpoints and servers (incl. behavioral analysis and host-based intrusion prevention).",
        "check": "Are enterprise anti-malware solutions deployed, updated and monitored on all relevant systems (incl. gateways)? Are backups isolated/immutable and restoration tested end-to-end? Are least-privilege, patching, application control and network segmentation enforced? Are incident procedures for malware alerts rehearsed?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.4 (Malware Protection) & CON.8",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Malware_protection_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Applicable to in-scope assets that are typical infection vectors (clients) or store valuable/operational data (datastores, file servers, databases).",
        "riskAssessment": "Prevalence of ransomware makes likelihood at least Likely; it becomes VeryLikely for Internet-facing assets or gateways.",
        "falsePositives": "Raised based on asset role and data criticality. The model cannot verify presence or effectiveness of external controls (e.g., EDR, email sandboxing) or the quality of @Backup:Target procedures.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "OPS.1.1.5": [
      {
        "file": "72_sec7.ts",
        "bsiCode": "OPS.1.1.5",
        "id": "inadequate-or-missing-logging-der.1.a5",
        "title": "Inadequate or Missing Logging (BSI DER.1.A5)",
        "description": "If IT systems within an information system fail to provide necessary logging data for security-relevant events,",
        "impact": "A lack of adequate logging creates a significant blind spot in the security posture, allowing attackers to remain undetected for extended periods.",
        "action": "Ensure Comprehensive and Monitored Logging",
        "mitigation": "Ensure all critical systems are configured to generate detailed logs for security-relevant events (e.g., login attempts, administrative actions, data access, errors).",
        "check": "Are all critical assets configured to log security-relevant events? Are logs sent to a central, secure repository?",
        "asvs": "BSI IT-Grundschutz DER.1.A5 (Logging of security-relevant events); OWASP ASVS V7.1 (Log Generation)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Detection_of_security-relevant_events_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified for critical in-scope 'process' or 'datastore' assets that do not have a communication link to a monitoring system (e.g., SIEM/log server).",
        "riskAssessment": "The likelihood is considered higher for custom-developed parts, as logging is often an afterthought.",
        "falsePositives": "The model might not represent a separate, out-of-band monitoring network. An asset might be monitored by a system not included in the threat model.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "72_sec8.ts",
        "bsiCode": "OPS.1.1.5",
        "id": "insufficient-logging-infrastructure-ops1.1.5",
        "title": "Insufficient Logging Infrastructure (BSI OPS.1.1.5)",
        "description": "Due to complex information networks and diverse attack scenarios, logging requirements are increasing, necessitating the storage and processing of large volumes of log data.",
        "impact": "An undersized logging infrastructure can lead to lost or incomplete log data. This prevents the detection of security incidents,",
        "action": "Ensure Sufficient Capacity for Logging Infrastructure",
        "mitigation": "The logging infrastructure must be designed with sufficient capacity to handle both normal operational load and peak loads during security incidents.",
        "check": "Is the logging infrastructure (storage, CPU, network) dimensioned to handle peak log volumes, especially during a simulated security incident?",
        "asvs": "BSI IT-Grundschutz Baustein OPS.1.1.5 (Logging), Requirement OPS.1.1.5.A5 (Sufficient dimensioning of the logging infrastructure).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Logging_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is identified for central monitoring and logging systems (e.g., technology 'Monitoring', 'Search-Index', 'Search-Engine')",
        "riskAssessment": "The likelihood of this risk materializing is high if a central logging/monitoring system has a large number of sources and no explicit capacity planning has been done.",
        "falsePositives": "The model cannot know the actual hardware or cloud resource allocation. A 'Monitoring' asset might be running on a highly scalable, auto-sizing platform.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "OPS.1.1.6": [
      {
        "file": "73_sec1.ts",
        "bsiCode": "OPS.1.1.6",
        "id": "testing-with-production-data-bsi-con-6",
        "title": "Testing with Production Data (BSI CON.6)",
        "description": "If software is tested using production data, significant security issues can arise.",
        "impact": "This practice can cause severe breaches of confidentiality, integrity, and availability. Unauthorized access to sensitive data may result in privacy violations, financial losses, and reputational damage.",
        "action": "Separate test/development and production environments; use anonymized or synthetic data for testing",
        "mitigation": "Strictly separate test, development, and production environments. Establish a policy that prohibits using real production data for testing.",
        "check": "Are test and production environments logically and physically separated? Is there a policy that prohibits using production data for testing?",
        "asvs": "V14.3.1: Verify that test and production environments are strictly segregated.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Testing_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is detected by identifying data flows from production datastores to development or test systems.",
        "riskAssessment": "Likelihood is considered high if a direct data flow from a production datastore to a test environment exists in the model.",
        "falsePositives": "A data flow might be mislabeled with 'DevOps' usage. The risk primarily concerns bulk data transfers for testing purposes.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "73_sec2.ts",
        "bsiCode": "OPS.1.1.6",
        "id": "insufficient-software-testing-con1",
        "title": "Insufficient Software Testing and Release Procedures (BSI OPS.1.1.6)",
        "description": "If new software is not tested or is tested inadequately and released without proper installation procedures, critical errors can remain undetected.",
        "impact": "Undetected software or installation errors can lead to unexpected system behavior, crashes, data corruption, or data loss, especially when updates are deployed.",
        "action": "Establish and enforce a formal software testing and release management process",
        "mitigation": "Implement a formal, multi-stage testing process for all new and updated custom-developed software before deployment. This should include unit, integration, and user acceptance testing (UAT).",
        "check": "Is there a documented software testing and release policy? Are test results (including security tests) reviewed and approved before release? Are installation and rollback guides provided for all software? Is a change management process strictly followed for all production deployments?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.6 (Software testing and releases), e.g., A2/A4/A15.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_software_development_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all in-scope technical assets marked as having 'custom-developed parts'.",
        "riskAssessment": "The likelihood is considered 'likely' for any custom-developed component, as missing or flawed testing is a common issue in many development lifecycles.",
        "falsePositives": "This risk may be a false positive if the organization has a very mature and rigorously enforced SDLC and testing process that is not visible in the threat model.",
        "cwe": "754",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "73_sec3.ts",
        "bsiCode": "OPS.1.1.6",
        "id": "'inadequate-release-process'",
        "title": "OPS.1.1.6 – Inadequate Software Test/Release & Approval Process",
        "description": "Software changes may reach production without structured testing, explicit sign-off, or artifact integrity checks. Missing approvals or weak gating can allow unverified code to be deployed.",
        "impact": "Unapproved or insufficiently tested releases can introduce unintended or malicious functions, remove needed features, break compatibility, or degrade security controls—directly threatening integrity and availability and potentially exposing data.",
        "action": "Establish and enforce auditable release gates with explicit approvals and artifact integrity verification.",
        "mitigation": "Define a documented, repeatable release workflow: mandatory sign-offs (product/QA/security), separation of duties, CI/CD gates (policy-as-code), artifact signing/checksums, environment promotion controls, and limited deploy privileges. Keep evidence for each deployment.",
        "check": "Is there a written test & release procedure? Are recent deployments backed by verifiable approvals and artifact integrity records? Do pipelines prevent unapproved or unsigned artifacts from being promoted to production?",
        "asvs": "OWASP ASVS: V1.1 (SDLC) • V14.2 (Supply Chain) • ISO/IEC 29119 (Testing)",
        "cheatSheet": "BSI OPS.1.1.6 – Software-Tests und -Freigaben (Test- & Release-Management)",
        "detectionLogic": "Triggers for in-scope technical assets with customDevelopedParts=true that represent executable code or data stores (processes/datastores). Heuristics (conceptual): higher priority where the asset is business-critical, processes or stores sensitive data, or lacks modeled references to approval gates. Absence of modeled release controls is treated as a warning requiring verification.",
        "riskAssessment": "Impact scales with the asset’s CIA requirements: Important⇒Medium, Critical⇒High, Mission-Critical/Strictly Confidential⇒Very High. Likelihood is set to Likely for custom software due to common organizational drift in enforcing approvals.",
        "falsePositives": "Organizational release processes may exist outside the model (e.g., out-of-band CAB/ITIL). Validate before remediation. If strong pipeline policies and artifact signing are already enforced, this can be marked as accepted with evidence.",
        "cwe": "494",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "73_sec4.ts",
        "bsiCode": "OPS.1.1.6",
        "id": "incomplete-test-documentation-bsi-con-1-a12",
        "title": "Incomplete Test Documentation (BSI CON.1.A12 / OPS.1.1.6)",
        "description": "If software test documentation is incomplete, it is impossible to determine retrospectively what was tested and with which results.",
        "impact": "Bugs or missing features that are not properly documented and addressed before a release can directly impact the integrity of processed data (unintentional modification/deletion)",
        "action": "Introduce and enforce comprehensive, reviewable test documentation and release criteria.",
        "mitigation": "Ensure that all test activities (test plan, cases, data, environment, execution logs, results, defects, and approvals) are complete, traceable, and versioned.",
        "check": "Is there an enforced policy for test documentation and release criteria? Are test results and deviations reviewed before approval? Is a bug tracker used, and are regression tests and environment separation practiced?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.6 Software-Tests und Freigaben; CON.1.A12 Documentation on tests and approvals",
        "cheatSheet": "https://www.bsi.bund.de/EN/Topics/ITGrundschutz/itgrundschutz_node.html",
        "detectionLogic": "Raised for each technical asset with customDevelopedParts=true that is in scope.",
        "riskAssessment": "Likelihood is set to 'Likely' as a baseline for custom software lacking verifiable, formal test documentation.",
        "falsePositives": "May be a false positive where a mature and enforced process exists: written policies, test plans, regression testing, separated test environments, formal approvals, and a mandatory defect management workflow.",
        "cwe": "1164",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "73_sec5.ts",
        "bsiCode": "OPS.1.1.6",
        "id": "unclear-software-release-criteria",
        "title": "Unclear Software Release Criteria (BSI-derived)",
        "description": "If release criteria for software are not clearly defined and communicated, software may be released prematurely with undetected defects, or conversely, releases may be unnecessarily delayed.",
        "impact": "Releasing software prematurely can introduce versions with undetected bugs, potentially disrupting production operations and affecting the Integrity and Availability of the system.",
        "action": "Define, document, and enforce clear release criteria",
        "mitigation": "Establish and document formal release criteria that cover functional correctness, security checks (e.g., SAST/DAST results, dependency scanning), performance testing, and operational readiness.",
        "check": "Is there a formal, documented policy for software release criteria? Do build pipelines enforce checks related to these criteria? Is there a formal approval or sign-off process for production releases?",
        "asvs": "ASVS V1.1 (Secure Software Development Lifecycle Requirements)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Secure_Software_Development_Lifecycle_Cheat_Sheet.html",
        "detectionLogic": "This organizational risk is raised for all in-scope technical assets marked as `custom_developed_parts`.",
        "riskAssessment": "The likelihood of this risk is considered 'Likely' as establishing and maintaining rigorous release processes is a common challenge.",
        "falsePositives": "This risk can be considered a false positive if a robust, well-documented release process is in place for the asset, but it has not been marked in the model with the `release-criteria:documented` tag.",
        "cwe": "400",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      }
    ],
    "OPS.1.1.7": [
      {
        "file": "74_sec1.ts",
        "bsiCode": "OPS.1.1.7",
        "id": "compromise-of-system-management-solution",
        "title": "Compromise of System Management Solution",
        "description": "Due to their central position and the necessary access rights to all managed systems, system management solutions are a primary target for attacks.",
        "impact": "A successful compromise can lead to the complete takeover of all managed systems. Attackers could install ransomware, exfiltrate sensitive data from across the managed fleet, or cause widespread service outages.",
        "action": "Harden System Management Solutions and Ensure Timely Patching",
        "mitigation": "Implement a robust patch and vulnerability management process for the system management solution itself.",
        "check": "Is there a documented and effective patch management process for the system management solution? Is the solution itself hardened? Is access to its management interfaces restricted to only authorized personnel and systems?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.1.5 (Patch and Change Management), specifically Requirement OPS.1.1.5.A13 (Timely application of security-relevant patches and updates).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for any technical asset explicitly tagged as a `@SystemManagementSolution`. The tool then identifies all systems managed by this solution (via outgoing communication links) to assess the potential blast radius and calculate impact.",
        "riskAssessment": "The likelihood is considered higher if the management solution is internet-exposed or consists of custom-developed parts, as these factors increase the attack surface.",
        "falsePositives": "This risk may be flagged even for well-maintained and hardened systems, as the model cannot verify the current patch level or the effectiveness of operational security controls. It should be considered a standing risk to be accepted or mitigated through robust operational processes.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "74_sec2.ts",
        "bsiCode": "OPS.1.1.7",
        "id": "faulty-automation-from-scripts-bsi",
        "title": "Compromise via Faulty System Management Automation (BSI-aligned)",
        "description": "All protection goals (Confidentiality, Integrity, Availability) of managed systems can be jeopardized by defective automation.",
        "impact": "A single flaw in automation (e.g., a mistaken configuration push or unsafe task) can propagate rapidly across many systems, including highly critical ones, causing outages, tampering, or data exposure.",
        "action": "Harden and validate automation that manages systems",
        "mitigation": "Apply SDLC controls to automation and IaC: code reviews, static checks, tests, and staged rollouts with automatic rollback.",
        "check": "Are automation scripts/pipelines reviewed and tested? Do automation accounts have only necessary permissions?",
        "asvs": "ASVS V1, V2, V3, V11.3.1 (Deployment Process Security)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/CI_CD_Security_Cheat_Sheet.html",
        "detectionLogic": "Trigger for technical assets that represent system-management automation (build/deploy pipelines, schedulers, orchestration, repos with webhooks)",
        "riskAssessment": "Likelihood rises when custom-developed automation is present or frequently changed. Impact is derived from the target’s CIA ratings—",
        "falsePositives": "May be a false positive if links are strictly read-only/monitoring, workflows are formally verified, or if changes cannot be applied to targets (e.g., air-gapped, immutable).",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "74_sec3.ts",
        "bsiCode": "OPS.1.1.7",
        "id": "insecure-system-management-communication",
        "title": "Insecure System Management Communication (BSI CON.6)",
        "description": "Accidental interference with or targeted attacks on system management communication can violate the integrity and availability of managed IT systems. If system management communication is eavesdropped on, data transmitted to and from the systems can be recorded and viewed. If the communication is manipulated, active systems can be controlled by unauthorized actors.",
        "impact": "If an attacker can eavesdrop on or manipulate this communication, they can intercept sensitive configuration data, credentials, or operational data (violating Confidentiality). They could also inject malicious commands to alter system configurations, deploy malware, or disrupt services (violating Integrity and Availability), effectively gaining unauthorized control over the target system (Elevation of Privilege).",
        "action": "Secure System Management Communication Links",
        "mitigation": "All communication links used for system management (`usage: devops`) must use strong, encrypted protocols (e.g., HTTPS, SSH, WSS, FTPS). Ensure that strong authentication methods are used and that authentication is never set to `none`. For highly sensitive connections crossing trust boundaries, consider enforcing the use of a VPN (`vpn: true`) and implementing strict IP filtering.",
        "check": "Review all communication links with `usage: devops`. Verify that their `protocol` is an encrypted variant and that `authentication` is not `none`. Check if these links cross trust boundaries without additional protection like a VPN.",
        "asvs": "V6.1.1: Verify that all communications between components are encrypted using TLS with a strong configuration.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for any `CommunicationLink` where `usage` is `devops` and the connection is either unencrypted (checked via `isProtocolEncrypted`) or uses no authentication (`authentication: none`). The risk is ignored if the link is marked as protected by a VPN (`vpn: true`).",
        "riskAssessment": "The likelihood is based on the context. An unencrypted management link on a trusted internal network might be 'Likely' to be exploited by an insider. If it crosses a trust boundary or the internet, it becomes 'Very Likely' or 'Frequent'. The impact is determined by the CIA ratings of the technical asset being managed. Gaining control over a `mission-critical` system has a `Very-High` impact.",
        "falsePositives": "A link might be mis-tagged as `devops`. The communication might be tunneled through an external VPN but not modeled with the `vpn: true` flag. Some legacy monitoring protocols might be intentionally unencrypted but heavily firewalled; this could be a valid exception if documented.",
        "cwe": "319",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "74_sec4.ts",
        "bsiCode": "OPS.1.1.7",
        "id": "insufficient-time-synchronization-bsi-ops114-a4",
        "title": "Insufficient Time Synchronization (BSI OPS.1.1.7.A3)",
        "description": "Errors in time synchronization can obscure problems and events, making it difficult to detect security incidents and data exfiltration.",
        "impact": "This can severely hamper incident response, hide unauthorized activities, and disrupt authentication or other time-sensitive protocols.",
        "action": "Ensure and Enforce Centralized Time Synchronization",
        "mitigation": "All server-side technical assets, especially those involved in logging, monitoring, authentication, and transaction processing, must be configured to use a central, reliable time source (e.g., via NTP).",
        "check": "Are all server-side systems and relevant devices (like IoT) configured to use a central NTP server? Is the health of the NTP service monitored? Do logs from different systems show synchronized timestamps?",
        "asvs": "BSI IT-Grundschutz Baustein OPS.1.1.7 (Systemmanagement), Requirement A3 (Time synchronization for system management)",
        "cheatSheet": "BSI IT-Grundschutz: OPS.1.1.7 Systemmanagement (A3: Zeitsynchronisation)",
        "detectionLogic": "This risk is raised for any in-scope, server-side technical asset (i.e., not a typical client like a browser or mobile app) that is not explicitly tagged as being time-synchronized via '@NTP-Synchronized: true'.",
        "riskAssessment": "The likelihood is considered 'Likely' if there is no explicit confirmation of a time synchronization mechanism. The impact is derived from the integrity and availability requirements of the asset.",
        "falsePositives": "This risk is generated based on the absence of a specific tag in the model. It can be a false positive if the asset is indeed time-synchronized but has not yet been tagged accordingly in the model. Verification with the operations team is required.",
        "cwe": "117",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "74_sec5.ts",
        "bsiCode": "OPS.1.1.7",
        "id": "incompatible-system-management-solution",
        "title": "Incompatible System Management Solution (related to BSI G 0.23)",
        "description": "A partially compatible system management solution can cause malfunctions in the managed IT systems, limiting their availability.",
        "impact": "The primary impact is on the **Availability** of the managed systems, potentially leading to instability, unexpected behavior, or crashes.",
        "action": "Verify and Test System Management Tool Compatibility",
        "mitigation": "Ensure that any system management solution is fully compatible with the target systems it manages. This should be verified before initial deployment and re-validated after any updates to either the management tool or the managed system.",
        "check": "Is there a documented compatibility matrix for the management tools and the systems they manage? Is there a testing and validation process to verify compatibility after updates?",
        "asvs": "Based on BSI IT-Grundschutz Catalog, Threat G 0.23 'Fehlfunktion durch Inkompatibilität' (Malfunction due to Incompatibility).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/kompendium_elementare_gefaehrdungen_2023.pdf?__blob=publicationFile (Catalog of Elementary Threats)",
        "detectionLogic": "Triggers on communication links originating from assets identified as system management tools (e.g., Monitoring, Scheduler, Container Platform, IDS/IPS) to other technical assets. The risk highlights the potential for incompatibility between the tool and the target, which requires manual verification.",
        "riskAssessment": "The impact is derived from the **Availability** rating of the managed target asset. A `mission-critical` target results in a 'Very High' impact. The likelihood is rated as `Likely` by default to flag this architectural concern for manual review, as it cannot be automatically confirmed. The risk is higher in heterogeneous environments.",
        "falsePositives": "This risk can be considered a false positive if the management tool is explicitly designed and certified for the target system (e.g., a vendor's proprietary management suite for its own products). Manual confirmation is required to close this risk.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "74_sec6.ts",
        "bsiCode": "OPS.1.1.7",
        "id": "connection-interruption-system-management",
        "title": "Connection Interruption of System Management Solution (BSI SYS.1.6.A1)",
        "description": "Connection interruptions can limit the availability of a system management solution.",
        "impact": "If a connection is interrupted or disrupted, costly, security-relevant, and time-critical tasks cannot be performed on schedule.",
        "action": "Ensure Network and System Resilience for Management Connections",
        "mitigation": "Implement redundant network paths for critical administrative connections. Ensure high-availability configurations for the system management solution itself and monitor connection health.",
        "check": "Are communication links to system management tools monitored for availability? Is the system management solution deployed in a highly available configuration?",
        "asvs": "ASVS V9.1: Denial of Service Defenses",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
        "detectionLogic": "This risk is generated for 'devops' usage communication links from an administrative client to a system management component (e.g., monitoring, container platform, identity provider).",
        "riskAssessment": "The likelihood of an interruption is higher for connections that cross unreliable networks (like the internet) without robust protocols or VPNs.",
        "falsePositives": "This risk might be a false positive if network redundancy exists but is not explicitly modeled (e.g., via BGP, multiple NICs, or SD-WAN).",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "74_sec7.ts",
        "bsiCode": "OPS.1.1.7",
        "id": "connection-loss-to-managed-systems",
        "title": "Connection Loss to Managed Systems",
        "description": "Connection interruptions to systems that are being managed (e.g., for administration, monitoring, or deployments) can impair the availability and integrity of services within the information network. The extent of such a connection loss determines whether services are impaired and what damage may occur. The resulting error patterns can be difficult to analyze, and the resulting faults can be difficult to rectify.",
        "impact": "A loss of a management connection can lead to service degradation or complete outages (Denial of Service). It may also result in data inconsistencies or corruption if ongoing processes are interrupted abruptly (loss of integrity). Furthermore, the resulting errors can be difficult to diagnose, prolonging downtime and increasing operational effort.",
        "action": "Implement Redundant Connections and Failover Mechanisms",
        "mitigation": "Ensure that critical management and operational connections are redundant. Use high-availability network setups. Implement automated health checks on connections with failover capabilities. Robust monitoring and alerting should be in place to quickly detect and respond to connection failures. The target systems themselves should also be redundant where possible.",
        "check": "Are connections for management and operations to critical systems designed for high availability? Do monitoring systems alert on connection failures? Is the target system itself redundant to mitigate the impact of a control plane failure?",
        "asvs": "Derived from general BSI threat assessments. Closely related to the principles of BSI IT-Grundschutz Baustein CON.3 (Redundancy).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Redundancy_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for `devops`-usage communication links connecting to important or critical technical assets, especially when the target asset is not marked as redundant. The severity increases based on the target's lack of redundancy and its overall availability and integrity requirements.",
        "riskAssessment": "The impact is determined by the highest availability and integrity requirements of the target asset and the data it handles. A lack of redundancy in the target system significantly increases the impact. The likelihood of an incident is considered higher for non-redundant targets, as a single connection failure directly leads to a loss of management capability.",
        "falsePositives": "The model may not capture underlying network-level redundancy (e.g., redundant switches, link aggregation). The risk may be acceptable if such infrastructure-level resilience is confirmed to be in place.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "74_sec8.ts",
        "bsiCode": "OPS.1.1.7",
        "id": "uncoordinated-network-and-system-management",
        "title": "Uncoordinated Network and System Management",
        "description": "Uncoordinated actions in network management can have a negative impact on system management.",
        "impact": "If changes to network and system configurations are not coordinated, it can lead to service disruptions (Denial of Service) or data corruption (Integrity loss).",
        "action": "Establish and Enforce Coordinated Change Management",
        "mitigation": "Implement a unified change management process that covers both network and system infrastructure.",
        "check": "Is there an integrated change management process for both network and systems? Are network changes assessed for their impact on application and data flows?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.5 Patch and Change Management",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Patch_and_change_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is identified for communication links that traverse network-level trust boundaries.",
        "riskAssessment": "The likelihood of an incident is higher when communication crosses administrative or network boundaries.",
        "falsePositives": "This risk may be a false positive in organizations with exceptionally mature and integrated change management processes, even with complex network architectures.",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "OPS.1.2.2": [
      {
        "file": "75_sec1.ts",
        "bsiCode": "OPS.1.2.2",
        "id": "data-obsolescence-in-archives",
        "title": "Data Obsolescence in Long-Term Archives (BSI CON.8.G1)",
        "description": "Data intended for long-term storage can become unusable over time. This is due to the physical or technical aging of underlying system components, storage media, and data formats.",
        "impact": "If this risk materializes, archived information may become unreadable (loss of availability) or be altered by degradation (loss of integrity).",
        "action": "Implement Data Lifecycle and Archiving Strategy",
        "mitigation": "Establish a robust long-term archiving strategy. This should include selecting durable, open, and well-documented data formats.",
        "check": "Is there a defined strategy for long-term data preservation? Are data formats and storage media periodically checked for obsolescence and integrity?",
        "asvs": "BSI IT-Grundschutz CON.8.A3 Selection of suitable storage media and data formats; CON.8.A4 Regular check of the readability of information",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Long-term_archiving_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for any technical asset of type 'datastore' that stores data assets classified with a criticality of 'archive'.",
        "riskAssessment": "The likelihood is considered 'likely' by default, as data and media obsolescence is a certainty over long periods without intervention.",
        "falsePositives": "A false positive can occur if an effective archiving and migration strategy exists but is not documented in the model via the",
        "cwe": "353",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "75_sec2.ts",
        "bsiCode": "OPS.1.2.2",
        "id": "insufficient-archive-classification-criteria-bsi-con-8-a22",
        "title": "Insufficient Classification Criteria for Archives (BSI CON.8.A22)",
        "description": "Electronic archives may contain very large amounts of data. Records are stored based on classification criteria (indexing) derived from index data of business applications and from the archive system itself.",
        "impact": "Due to unsuitable or limited classification criteria, archiving objectives may be missed, such as the ability to provide evidence to third parties.",
        "action": "Define and Implement Robust Archiving and Indexing Policies",
        "mitigation": "Define and document suitable and sufficient classification criteria for all electronic archives based on business, operational, and legal requirements.",
        "check": "Are there documented classification and indexing criteria for all electronic archives? Do these criteria meet all relevant legal and business requirements for data retrieval and provability?",
        "asvs": "BSI IT-Grundschutz CON.8 Archiving — CON.8.A22 Selection of suitable classification criteria for electronic archives.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Archiving_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any data store (`type: datastore`) that is explicitly identified as an archive via the `classification:archive` tag.",
        "riskAssessment": "The likelihood of this risk is considered 'Likely' for any system identified as an archive, as proper long-term classification is a complex requirement that is often overlooked.",
        "falsePositives": "This can be a false positive if a comprehensive and suitable archiving and classification strategy is defined and implemented for the asset but is not modeled (e.g., documented externally).",
        "cwe": "353",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "75_sec3.ts",
        "bsiCode": "OPS.1.2.2",
        "id": "insufficient-logging-of-archive-access",
        "title": "Insufficient Logging of Archive Access (based on BSI)",
        "description": "Unauthorized access to archives is typically detected using log files. However, if logging is not sufficiently comprehensive,",
        "impact": "If logging is insufficient, unauthorized access to archived data may not be detected. This can lead to a silent breach of confidentiality (data theft)",
        "action": "Implement Comprehensive and Tamper-Proof Logging for Archive Access",
        "mitigation": "Ensure that all access attempts (both successful and failed) to technical assets holding archive data are logged in detail.",
        "check": "Are all read and write access events to the archive asset logged? Are the logs protected against tampering and unauthorized access? Is there a process for regular review of these logs?",
        "asvs": "BSI IT-Grundschutz CON.8 (Detection of security-relevant events), OWASP ASVS V7 (Logging and Monitoring)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Detection_of_security-relevant_events_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies technical assets of type 'datastore' that store data assets classified with an integrity or availability level of 'archive'.",
        "riskAssessment": "The likelihood is considered 'likely' by default, as comprehensive logging for less-frequently accessed archives is often overlooked.",
        "falsePositives": "This risk is generated based on the architectural model and cannot verify the actual logging implementation.",
        "cwe": "778",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "75_sec4.ts",
        "bsiCode": "OPS.1.2.2",
        "id": "falsification-or-loss-during-scanning-con1",
        "title": "Falsification or Loss of Information during Document Scanning (BSI CON.1)",
        "description": "When documents are scanned or digitized, their appearance or the semantics of the captured data can be falsified. Documents or parts of them can also be lost during this process.",
        "impact": "This compromises the Integrity and Availability of the data. Incorrect business decisions may be made based on flawed data, business processes can be disrupted, and regulatory or contractual obligations might be violated if the original document information is not preserved correctly.",
        "action": "Implement Robust Scanning and Data Validation Processes",
        "mitigation": "Implement technical and organizational controls for the scanning/digitization process. This includes using high-quality software with error detection and correction features (e.g., OCR confidence scores, image quality checks). Implement checksums or other integrity checks for file transfers. For critical processes, incorporate a manual or semi-automated validation step where a human reviews the digitized output against the original document, especially for key data fields. Maintain detailed logs of all operations to trace any lost or incorrectly processed documents.",
        "check": "Does the digitization process have built-in quality and completeness checks? Are there procedures to validate the integrity of the captured data against the source? Are logs kept for all digitization activities to ensure traceability?",
        "asvs": "BSI IT-Grundschutz Baustein CON.1 (Data Acquisition and Preparation), especially CON.1.A19 (Error handling during data acquisition). Also relates to OWASP ASVS V5.2 (Data Validation Requirements).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Data_acquisition_and_preparation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "The risk is identified for technical assets of type 'process' that accept data in a generic 'file' format (`DataFormat.File`), as this often represents a digitization or scanning process where information can be lost or misinterpreted. The risk is considered higher for custom-developed components, as they may lack the sophisticated error-handling and reconciliation features of specialized COTS scanning solutions.",
        "riskAssessment": "The likelihood is higher if the component processing the files is custom-developed. The impact is directly related to the integrity and availability requirements of the data being processed. If mission-critical data is being scanned, the impact is very high.",
        "falsePositives": "The asset might be accepting files for a purpose other than digitization (e.g., a simple file share without processing). The risk can be considered a false positive if the process has strong, proven validation and reconciliation mechanisms that are not captured in the model.",
        "cwe": "20",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "75_sec5.ts",
        "bsiCode": "OPS.1.2.2",
        "id": "outdated-encryption-methods",
        "title": "Use of Outdated Encryption Methods (BSI OPS.1.2.2 context)",
        "description": "Cryptographic methods used for encryption must be regularly adapted to the state of the art to maintain their protective effect.",
        "impact": "An attacker could break the weak encryption, leading to the disclosure of sensitive or confidential information. This compromises confidentiality and can lead to data breaches, regulatory fines, and loss of trust.",
        "action": "Migrate to a state-of-the-art encryption algorithm",
        "mitigation": "Replace outdated encryption algorithms (like DES, 3DES, RC4, Blowfish) and modes (like ECB) with strong, modern alternatives (e.g., AES-256 with GCM or CCM mode).",
        "check": "Review source code, configuration files, and documentation to identify the encryption algorithms, modes, and key lengths in use. Use security scanners that detect weak cryptographic dependencies or configurations.",
        "asvs": "V6.2.3: Verify that strong, approved cryptographic algorithms and protocols are used.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html",
        "detectionLogic": "Triggers on technical assets explicitly tagged with `@Crypto:Weak-Encryption`. This tag indicates that the asset is known to use a broken, deprecated, or risky cryptographic algorithm for encryption purposes.",
        "riskAssessment": "The likelihood is high because the weakness is explicitly tagged. The impact is determined by the confidentiality requirements of the data processed or stored by the asset. A breach of 'Strictly Confidential' data has a very high impact.",
        "falsePositives": "This risk is unlikely to be a false positive if the tag is applied correctly. It might be considered a lower priority if the asset is only accessible within a highly trusted environment, but the underlying weakness still exists.",
        "cwe": "327",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "75_sec6.ts",
        "bsiCode": "OPS.1.2.2",
        "id": "insufficient-archive-review",
        "title": "Insufficient Review of Archiving Process (BSI-CON.1-style)",
        "description": "If the archiving process is checked too infrequently or imprecisely, malfunctions may not be detected.",
        "impact": "Failure to regularly and accurately review the archiving process can lead to undetected data corruption or manipulation.",
        "action": "Implement Regular Audits and Integrity Checks for Archiving Systems",
        "mitigation": "Establish a formal process for regularly reviewing and auditing the archiving system and its processes.",
        "check": "Is there a documented procedure for reviewing the archiving process? Are integrity checks performed on archived data?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Archivierung), Requirement CON.1.A5 (Prüfung des Archivs).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Archiving_Edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
        "detectionLogic": "This risk is raised for any datastore asset that stores data with high or mission-critical integrity requirements.",
        "riskAssessment": "The impact is directly derived from the integrity requirement of the most critical data asset stored in the archive.",
        "falsePositives": "This risk may be a false positive if a robust, regular, and effective review and audit process for the archiving system is already in place,",
        "cwe": "354",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "75_sec7.ts",
        "bsiCode": "OPS.1.2.2",
        "id": "non-compliance-with-legal-archiving-requirements",
        "title": "Non-Compliance with Legal Archiving Requirements",
        "description": "When archiving electronic documents and data, various legal and regulatory frameworks must be observed.",
        "impact": "Failure to comply with legal archiving and data retention requirements can lead to severe legal penalties, fines, and reputational damage.",
        "action": "Define and Implement Data Retention and Archiving Policies",
        "mitigation": "Establish and document clear data retention policies based on all applicable legal and business requirements.",
        "check": "Are there documented data retention policies for all relevant data types? Does the archiving solution technically enforce these policies? Is there a process for legal holds and eventual secure deletion?",
        "asvs": "This risk relates to legal and regulatory requirements, which are an overarching concern for applications. It aligns with the spirit of ASVS V14 (Configuration), as proper data retention is a critical configuration aspect.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_8_Loeschen_und_Vernichten.html",
        "detectionLogic": "This rule triggers risks for any 'datastore' technical asset that stores data classified with an 'archive' level of integrity or availability but does not have a tag indicating that a retention policy has been explicitly defined for it ('@retention-policy-defined').",
        "riskAssessment": "The likelihood of non-compliance is considered high if a policy is not defined for a system intended for archiving.",
        "falsePositives": "A policy might exist organizationally but may not be captured in the threat model via the specified tag. This risk should be verified with the system owner to confirm if a compliant retention policy is indeed missing.",
        "cwe": "16",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "OPS.1.2.4": [
      {
        "file": "76_sec1.ts",
        "bsiCode": "OPS.1.2.4",
        "id": "insufficient-telework-regulations-ops1.2.4",
        "title": "Insufficient Regulations for Telework (BSI OPS.1.2.4)",
        "description": "Using a telework setup requires supplementary organizational agreements and clear instructions for employees, especially regarding how to handle security incidents. Without communicated guidelines for events such as device loss or compromise at a remote location, incidents may not be reported or handled correctly, which significantly increases the risk of damage.",
        "impact": "If security incidents at a telework location (e.g., loss or theft of a device, unauthorized observation by third parties, malware infection) are not handled according to a defined process, confidential information can be compromised. This can lead to severe damage, including data breaches, reputational harm, and financial loss for the organization.",
        "action": "Establish and communicate clear telework security policies and incident response procedures",
        "mitigation": "Define, document, and communicate clear, actionable security policies and procedures specifically for telework. These policies must cover secure device handling (both corporate and BYOD), acceptable network usage, data storage and encryption requirements, and clear, mandatory procedures for immediately reporting any suspected security incidents. Ensure all personnel engaging in telework are trained on these procedures and know whom to contact and how. Regularly review and update these policies.",
        "check": "Are there documented and communicated security policies specifically for telework? Do employees know the exact procedure for reporting a security incident from their remote location? Is this process regularly tested or included in awareness campaigns?",
        "asvs": "BSI IT-Grundschutz Baustein OPS.1.2.4 (Telework), Section 2.1 (Insufficient or missing rules for telework)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Telework_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any technical asset that represents a telework endpoint. This includes client-type technologies (like browsers, mobile apps, desktops) that connect from the public internet or are explicitly marked as being used by a human client, and which process or store data with a sensitivity rating of 'restricted' or higher.",
        "riskAssessment": "The likelihood of this risk is considered 'likely' if telework capabilities are modeled, as specific telework incident response plans are a common oversight. The impact is directly dependent on the sensitivity (Confidentiality, Integrity, and Availability) of the data assets accessible from the telework asset. Accessing 'Strictly Confidential' data from a remote location without clear incident handling procedures poses a high-impact risk.",
        "falsePositives": "The threat model can only identify the technical presence of telework assets; it cannot verify the existence or effectiveness of organizational policies. This risk must be manually verified by reviewing the organization's documented telework security policies and incident response plans.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "76_sec2.ts",
        "bsiCode": "OPS.1.2.4",
        "id": "unauthorized-private-use-of-telework-client-bsi-ops-1-2-4",
        "title": "Unauthorized Private Use of Company Telework Client (BSI OPS.1.2.4)",
        "description": "In a home environment, users can more easily install unvetted or unapproved hardware or software on a company-provided telework client.",
        "impact": "If the telework client is infected, confidential information can be disclosed, altered, or exfiltrated.",
        "action": "Enforce endpoint security, clear usage rules, and least privilege.",
        "mitigation": "Introduce and enforce a strict policy prohibiting private use of company telework clients.",
        "check": "Is there a clearly communicated policy on private use of company devices? Are user accounts on telework clients configured without administrative privileges?",
        "asvs": "BSI IT-Grundschutz OPS.1.2.4: Telearbeit (e.g., 2.2 unauthorized private use; A2/A7 policy and technical safeguards).",
        "cheatSheet": "BSI IT-Grundschutz-Kompendium, Baustein OPS.1.2.4 \\",
        "detectionLogic": "This risk is raised for any technical asset identified as a client-type device (e.g., Desktop, Client-System) that is explicitly tagged as a telework client via the `telework-client` tag.",
        "riskAssessment": "Likelihood is high if no specific endpoint security controls or policies exist for telework clients.",
        "falsePositives": "This may be a false positive if robust, non-bypassable technical controls effectively prevent unauthorized software installation and private use, even if not explicitly modeled.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "76_sec3.ts",
        "bsiCode": "OPS.1.2.4",
        "id": "workflow-delay-due-to-uncoordinated-telework",
        "title": "Workflow Delay Due to Uncoordinated Telework (BSI OPS.1.2.4)",
        "description": "If employees do not have fixed working hours at the teleworkplace and no fixed times are agreed upon when they must be reachable, the workflow can be delayed as a result.",
        "impact": "Delayed workflows due to personnel unavailability directly compromise the Availability of business functions and processes. This can lead to missed deadlines, reduced productivity, and a failure to meet service level objectives.",
        "action": "Establish and Enforce Core Availability Hours for Telework",
        "mitigation": "Define and communicate a clear policy regarding telework, including core hours during which employees are expected to be available for collaboration and communication.",
        "check": "Is there a documented policy for telework that specifies core availability hours? Do team members know and adhere to these hours?",
        "asvs": "Not directly applicable. This is an organizational process risk related to human resource availability, not a technical application security vulnerability. It aligns with general business continuity management principles.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_4_Telearbeit.html",
        "detectionLogic": "This organizational risk is triggered for any technical asset tagged with '@Location:HomeOffice'.",
        "riskAssessment": "The likelihood of this risk materializing is considered 'Likely' in environments without formal telework policies. The impact is directly derived from the 'Availability' requirement of the tagged technical asset. A delay in a 'Mission-Critical' process has a much higher impact than a delay in an 'Archive' or 'Operational' one.",
        "falsePositives": "This risk might be a false positive if an organization has effective, albeit informal, communication and coordination practices for its remote workforce.",
        "cwe": "693",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "76_sec4.ts",
        "bsiCode": "OPS.1.2.4",
        "id": "delayed-information-for-remote-workers",
        "title": "Delayed Information for Remote Workers (BSI OPS.1.2.4)",
        "description": "Because employees are not always physically present in the organization, they have fewer opportunities to participate in ad-hoc, informal exchanges with managers and colleagues.",
        "impact": "Failure to learn about updated procedures or other important information in time can disrupt business processes and hinder task completion, affecting the availability (and in some cases integrity) of operations.",
        "action": "Establish formal and redundant communication channels for remote workers",
        "mitigation": "Ensure that all critical operational information is documented and communicated through formal, asynchronous channels (e.g., wikis, ticket systems, official chat channels, email summaries) that are accessible to all team members, regardless of their physical location.",
        "check": "Are there mandatory, documented procedures for disseminating important information to remote workers? Is critical information centrally archived and easily accessible?",
        "asvs": "Not directly covered by OWASP ASVS (organizational/process risk); related to ISO/IEC 27001 Annex A (e.g., A.6.2.1 Mobile device policy; A.11.2.6 Security of equipment and assets off-premises) and BSI OPS.1.2.4.A8.",
        "cheatSheet": "BSI IT-Grundschutz Kompendium – OPS.1.2.4 Telearbeit (German)",
        "detectionLogic": "This organizational risk is associated with assets that represent telework endpoints. In this model, it flags assets that are human-operated clients (`used_as_client_by_human`), are internet-facing (`internet`),",
        "riskAssessment": "Likelihood is considered 'likely' wherever remote work is supported, as informal communication gaps are common without explicit mitigation.",
        "falsePositives": "Can be a false positive if robust, formal, asynchronous communication processes exist (e.g., mandatory written decisions, centrally documented updates, inclusive meeting practices) that reliably reach all remote workers.",
        "cwe": "841",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "76_sec5.ts",
        "bsiCode": "OPS.1.2.4",
        "id": "insecure-telework-environment-con3",
        "title": "Insecure Telework Environment (BSI OPS.1.2.4)",
        "description": "At the teleworking location (e.g., home office), a lack of organizational control and monitoring can lead to employees not implementing recommended or mandated security measures fully. This can be due to insecure private networks, use of devices by unauthorized third parties (e.g., family members), or shoulder surfing. As a result, sensitive information handled on these remote devices can be compromised and fall into the hands of unauthorized individuals.",
        "impact": "If security measures are not enforced on remote clients, confidential information accessed or processed by them can be exposed. This can lead to data breaches, compliance violations, and reputational damage. The integrity of the system can also be affected if the insecure client is used as an entry point for further attacks.",
        "action": "Implement and enforce secure teleworking policies and technical controls",
        "mitigation": "Enforce a comprehensive security policy for all remote work. This includes hardening client devices (laptops, mobile phones) with full-disk encryption (FDE), endpoint detection and response (EDR) solutions, and Mobile Device Management (MDM). Mandate the use of a secure VPN for all access to internal company resources. Provide regular security awareness training focused on the specific risks of teleworking. Implement strong multi-factor authentication for all remote access.",
        "check": "Is there a defined and enforced policy for secure teleworking? Are client devices centrally managed and hardened? Is a VPN required for access? Do employees receive training on remote work security?",
        "asvs": "BSI IT-Grundschutz CON.3.A13: Protecting information when teleworking",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Mobile_use_of_ICT_Edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies technical assets that are used by humans as clients (e.g., browsers, desktop apps) and are connected to the internet, suggesting they operate in an uncontrolled environment such as a home office. A risk is raised if these clients access or transmit data with a confidentiality level of 'restricted' or higher.",
        "riskAssessment": "The likelihood of an incident is considered high for unmanaged clients in untrusted environments. The impact is directly proportional to the confidentiality of the data being accessed. A 'Strictly Confidential' document accessed from a home office poses a much higher risk than a 'Public' one. The risk can be mitigated by applying technical controls, which can be indicated by the '@Telework:Hardened' tag.",
        "falsePositives": "A risk might be flagged for an asset that is, in reality, well protected by endpoint security measures (EDR, MDM) that are not documented in the threat model. In such cases, the asset can be tagged with '@Telework:Hardened' to suppress this finding.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "OPS.1.2.5": [
      {
        "file": "77_sec1.ts",
        "bsiCode": "OPS.1.2.5",
        "id": "insecure-remote-maintenance-configuration",
        "title": "Insecure Configuration of Remote Maintenance (BSI CON.3.A4)",
        "description": "Administrators who set up and use remote maintenance rely on policies that define how it should be used. For example, it is necessary to specify how remote maintenance applications must be configured. Otherwise, remote maintenance can introduce additional risks to the internal network. If the regulations for remote maintenance are not communicated to the parties involved, risks to IT operations arise. For example, a remote maintenance interface could be configured to allow an authentication method with an insecure password instead of a secure, certificate-based procedure.",
        "impact": "If remote maintenance is not configured securely due to a lack of clear rules, it can create a major entry point for attackers into an otherwise protected internal network. This can lead to unauthorized access, privilege escalation, data breaches (loss of Confidentiality), system and data manipulation (loss of Integrity), and service disruptions (loss of Availability).",
        "action": "Define and Enforce Secure Remote Maintenance Policies",
        "mitigation": "Establish and enforce clear, documented policies for all remote maintenance access. These policies must specify mandatory security configurations, including the use of strong, multi-factor, or certificate-based authentication. The use of simple password-based credentials for remote access across network boundaries should be explicitly forbidden. Ensure all administrators are aware of and trained on these policies. Regularly audit remote access configurations for compliance.",
        "check": "Is there a documented policy for remote maintenance? Does it mandate strong authentication (MFA, certificates)? Is there a process to ensure administrators follow this policy? Are remote access links using weak authentication methods like simple credentials?",
        "asvs": "BSI IT-Grundschutz CON.3 Remote Access, Requirement CON.3.A4 Regulation of remote maintenance",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Remote_Access_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers on communication links that use typical remote maintenance protocols (like SSH) to cross a network trust boundary, but are configured with weak authentication methods (like 'credentials' instead of 'client-certificate'). This indicates a potential violation of secure remote maintenance policies.",
        "riskAssessment": "The likelihood is high if a remote maintenance protocol is used across a network boundary with weak authentication ('credentials' or 'none'). The impact is directly dependent on the confidentiality and integrity of the target asset. Accessing a mission-critical database via insecure remote maintenance has a very high impact.",
        "falsePositives": "The model might flag a connection using 'credentials' as weak, even if a compensating control like MFA is enforced by the target system but not modeled in Threagile. The risk is about the *policy* and its technical implementation, so it might be considered a valid finding even if other controls exist.",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "77_sec2.ts",
        "bsiCode": "OPS.1.2.5",
        "id": "insecure-remote-administration",
        "title": "Insecure Remote Administration (BSI OPS.1.2.5)",
        "description": "If remote administration is not carefully planned, configured, and regulated, the security of an institution's IT systems can be compromised.",
        "impact": "Using insecure protocols or authentication for remote administration can lead to unauthorized access, data breaches, system tampering, or denial of service.",
        "action": "Secure Remote Administration Channels",
        "mitigation": "Use strong, encrypted protocols (e.g., SSH, HTTPS, or any protocol tunneled through a VPN).",
        "check": "Are all remote administration connections using encrypted protocols? Is strong authentication enforced? Is access restricted by source IP? Are sessions logged and monitored?",
        "asvs": "BSI IT-Grundschutz OPS.1.2.5 Remote Administration",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_5_Remote_administration_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule scans for communication links identified for administrative purposes (`usage: devops`) that are configured insecurely.",
        "riskAssessment": "The likelihood of exploitation is high if unencrypted protocols or no authentication are used for remote administration, especially for internet-facing assets.",
        "falsePositives": "A risk might be a false positive if the `devops` usage tag is used for non-administrative purposes,",
        "cwe": "522",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "77_sec3.ts",
        "bsiCode": "OPS.1.2.5",
        "id": "weak-authentication-for-remote-maintenance",
        "title": "Weak Authentication for Remote Maintenance",
        "description": "Different authentication mechanisms can be used for remote maintenance. If an insecure authentication procedure is used,",
        "impact": "Successful exploitation can lead to a complete compromise of the target system, including unauthorized access, modification, or",
        "action": "Enforce Strong Authentication for all Remote Maintenance Connections",
        "mitigation": "Use multi-factor authentication (MFA / 'two-factor'), client certificates, or hardware tokens for all remote maintenance access.",
        "check": "Review all communication links with a usage of 'devops' or involving administrative protocols like SSH.",
        "asvs": "OWASP ASVS V4.0.3 - 2.1.1 (Authentication), 2.2.1 (Credential Strength)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
        "detectionLogic": "This rule checks all communication links that are likely used for remote maintenance. These are identified by the 'devops'",
        "riskAssessment": "The likelihood of exploitation is highest for connections directly exposed to the internet using no authentication.",
        "falsePositives": "A risk flagged for 'credentials'-based authentication might be a false positive if the password policy is very strong and enforced,",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "77_sec4.ts",
        "bsiCode": "OPS.1.2.5",
        "id": "inadequate-remote-maintenance-ops115",
        "title": "Inadequate Remote Maintenance (BSI OPS.1.2.5)",
        "description": "To ensure the security and functionality of IT systems and applications that are accessed remotely,",
        "impact": "Improper or insecure remote maintenance can lead to a loss of availability, system integrity violations,",
        "action": "Establish and Enforce Secure Remote Maintenance Procedures",
        "mitigation": "Define and enforce clear, secure procedures for all remote maintenance activities.",
        "check": "Are all remote administration connections forced to use encrypted protocols and strong authentication?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.1.2.5 (Remote Maintenance).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_Server_operation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI OPS.1.2.5)",
        "detectionLogic": "This risk is detected by analyzing incoming communication links to server-side technical assets.",
        "riskAssessment": "The likelihood is high if unencrypted protocols or no authentication is used for remote access across network boundaries.",
        "falsePositives": "A link might be miscategorized as 'maintenance' when it is not. The model might not fully capture",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "77_sec5.ts",
        "bsiCode": "OPS.1.2.5",
        "id": "insecure-communication-protocol",
        "title": "Insecure Communication Protocol (based on BSI recommendation)",
        "description": "Communication over public or internal networks using insecure protocols poses a significant threat.",
        "impact": "Using insecure protocols can lead to the compromise of confidentiality through eavesdropping (Information Disclosure) and the compromise of integrity through data modification (Tampering).",
        "action": "Enforce Secure Communication Protocols",
        "mitigation": "All communication links transmitting sensitive data across trust boundaries must use strong, state-of-the-art encryption protocols (e.g., HTTPS, WSS, FTPS, SFTP, SMTPS).",
        "check": "Review all communication links in the architecture. Are there any protocols that transmit data in cleartext across trust boundaries? For all encrypted protocols, are up-to-date and securely configured versions and ciphers used?",
        "asvs": "V4.3.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule automatically detects all communication links that use a protocol not considered encrypted (e.g., HTTP, FTP, Telnet).",
        "riskAssessment": "The likelihood of exploitation is higher for links exposed to the internet or crossing network boundaries. The impact is directly related to the sensitivity (confidentiality and integrity) of the data assets being transferred over the insecure link. Transmitting 'Strictly Confidential' data over HTTP poses a 'Critical' risk.",
        "falsePositives": "A risk might be flagged for a link that is protected by a separate, un-modeled compensating control, like a site-to-site VPN tunnel.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "77_sec6.ts",
        "bsiCode": "OPS.1.2.5",
        "id": "unregulated-remote-maintenance-by-third-party",
        "title": "Unregulated Remote Maintenance by Third Party (BSI OPS.1.2.5)",
        "description": "If IT systems are remotely maintained by third parties without a contractual basis, the responsibilities for remote maintenance may not be clearly regulated.",
        "impact": "This lack of regulation can result in unauthorized access, data tampering (Integrity), information disclosure (Confidentiality), or service disruption (Availability).",
        "action": "Establish Formal Agreements and Technical Controls for Remote Maintenance",
        "mitigation": "Ensure that all remote maintenance activities performed by third parties are governed by a formal, legally binding contract.",
        "check": "Is there a contract in place for every third party that performs remote maintenance? Does the contract specify security requirements for the remote access connection? Are remote access logs created and reviewed? Is access actively managed and revoked when no longer necessary?",
        "asvs": "BSI IT-Grundschutz Baustein OPS.1.2.5 (Remote Maintenance), specifically addressing threat G 0.35 (Insufficient regulations for remote maintenance).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_5_Remote_access_and_remote_maintenance_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for any communication link from a `third-party` technical asset (type `external-entity`) to an in-scope asset using a common remote maintenance protocol (like SSH, SCP, SFTP).",
        "riskAssessment": "The likelihood is considered high if an unregulated remote access path from a third party exists. The impact is determined by the CIA requirements of the target asset and the data it processes or stores.",
        "falsePositives": "A risk might be flagged if the modeler omitted the `@Service:RemoteMaintenance` tag, even though a valid contract exists. The existence of a formal agreement must be verified outside the threat model.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "77_sec7.ts",
        "bsiCode": "OPS.1.2.5",
        "id": "remote-maintenance-via-online-service-ops1.2.5",
        "title": "Remote Maintenance via Untrusted Online Service (BSI OPS.1.2.5)",
        "description": "When remote maintenance is performed via an intermediary online service, a data connection is established from the system to be administered to the service's servers. Administrators then access their systems through this service, for example via a web browser. If this communication is not end-to-end encrypted (i.e., the online service can decrypt the traffic), the service provider can read the entire data exchange. This creates a risk of information disclosure and tampering.",
        "impact": "A malicious or compromised online service provider could gain access to sensitive administrative commands and data. This could lead to unauthorized administration of systems, data manipulation (tampering), or theft of credentials and sensitive information, compromising the confidentiality and integrity of the managed systems. If the IT system automatically connects to the service on startup, it may be possible to access the system without the knowledge of the system's users or administrators.",
        "action": "Implement End-to-End Encrypted Remote Maintenance",
        "mitigation": "Prefer direct remote maintenance channels secured by VPN (`vpn: true` on the communication link). If an intermediary online service must be used, ensure that the communication is truly end-to-end encrypted, meaning the service provider cannot access the plaintext of the administrative session. This can be achieved through protocols that establish a secure tunnel through the intermediary. All connections must use strong, state-of-the-art transport encryption (e.g., HTTPS, SSH). The online service itself should be thoroughly vetted as a trusted provider. Monitor all remote maintenance connections.",
        "check": "Does any remote maintenance (`devops` usage) traffic pass through an internet-facing intermediary component? Is this communication protected by more than just standard HTTPS on each leg? Is there a mechanism (like a VPN or an end-to-end encrypted tunnel) that prevents the intermediary from reading the traffic?",
        "asvs": "BSI IT-Grundschutz OPS.1.2.5 Fernwartung (Remote Maintenance)",
        "cheatSheet": "",
        "detectionLogic": "This risk is raised for any internet-facing technical asset (of type Process or External-Entity) that acts as an intermediary for `devops` traffic. An intermediary is identified as an asset that has at least one incoming communication link and at least one outgoing communication link with the `devops` usage type.",
        "riskAssessment": "The impact is calculated based on the highest Confidentiality, Integrity, and Availability of all target assets being administered through the intermediary. The likelihood is 'Likely' due to the architectural pattern itself, which exposes traffic to the intermediary. If any of the communication links involved are unencrypted, the likelihood increases to 'Very-Likely'.",
        "falsePositives": "A false positive may occur if the model does not capture specific end-to-end encryption controls that prevent the intermediary from accessing plaintext (e.g., a custom-built secure tunneling protocol). The risk may be acceptable if the intermediary is a fully trusted, hardened, and monitored component, although the architectural weakness still exists.",
        "cwe": "300",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "77_sec8.ts",
        "bsiCode": "OPS.1.2.5",
        "id": "vulnerability-in-integrated-remote-maintenance-component",
        "title": "Vulnerability in Integrated Remote Maintenance Component",
        "description": "Many IT systems contain components that offer integrated remote maintenance functions (e.g., IPMI, iLO, iDRAC, Intel AMT).",
        "impact": "If an attacker gains control over an integrated remote maintenance component, they can usually take over the entire IT system with extensive privileges.",
        "action": "Harden and Isolate Remote Maintenance Interfaces",
        "mitigation": "Unused remote maintenance components should be deactivated (e.g., via BIOS/UEFI settings).",
        "check": "Is there a complete inventory of all hardware assets and their remote maintenance capabilities? Are unused remote maintenance functions verifiably deactivated?",
        "asvs": "BSI IT-Grundschutz SYS.1.1.A15 (Secure remote access)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_1_General_server_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all technical assets of the machine type 'physical' or 'virtual', as well as for 'IoT-Device' technology.",
        "riskAssessment": "The impact is directly derived from the confidentiality and integrity requirements of the asset itself, as a compromise of the management plane grants full control. The likelihood is considered higher if the asset is directly exposed to the internet.",
        "falsePositives": "This risk can be considered a false positive if the technical asset does not possess any hardware-based remote maintenance functionality (e.g., certain simple virtual machines without emulated management cards or simple IoT devices) or if the functionality has been verifiably and permanently disabled.",
        "cwe": "1189",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "OPS.1.2.6": [
      {
        "file": "78_sec1.ts",
        "bsiCode": "OPS.1.2.6",
        "id": "inadequate-time-sync-planning",
        "title": "Inadequate Planning of Time Synchronization (BSI INF.11.A1)",
        "description": "Insufficient planning can lead to IT systems failing to receive a sufficiently accurate system time.",
        "impact": "If time synchronization is not properly planned and implemented, it can lead to inconsistent or incorrect timestamps across systems.",
        "action": "Plan and Implement a Robust Time Synchronization Architecture",
        "mitigation": "Establish a clear time synchronization strategy. Designate primary, trusted time sources (e.g., dedicated internal NTP servers synchronized with a reliable external source).",
        "check": "Is there a defined time synchronization strategy? Are all systems configured to use a trusted NTP server? Is network connectivity between NTP clients and servers ensured across all network boundaries?",
        "asvs": "BSI IT-Grundschutz INF.11 Time Service, Requirement INF.11.A1 Planning of time supply",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_11_Time_service_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks for technical assets that are typically time-sensitive based on their technology type (e.g., databases, application servers, schedulers, identity providers).",
        "riskAssessment": "The likelihood is considered 'Likely' as time synchronization is a frequently overlooked aspect of infrastructure planning.",
        "falsePositives": "This risk may be a false positive if a robust time synchronization mechanism exists (e.g., provided by the underlying cloud platform or virtualization host) but is not explicitly modeled with a `@TimeSource` tag.",
        "cwe": "778",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "78_sec2.ts",
        "bsiCode": "OPS.1.2.6",
        "id": "ntp-failure-or-misinformation",
        "title": "NTP Server Failure or Misinformation (BSI SYS.1.6)",
        "description": "NTP servers can fail, become unreachable, or transmit incorrect time information. If an IT system cannot synchronize its clock correctly, its internal time can become inaccurate. This can lead to incorrect timestamps in applications and log data. Furthermore, incorrect time information can cause certificate-based services or services that use one-time passwords (TOTP) to fail, preventing users from authenticating.",
        "impact": "Inaccurate system time can lead to the failure of critical security services like authentication and encrypted communication (TLS), causing a Denial of Service. It also compromises the integrity of log data, which hinders forensic analysis and enables repudiation of actions. This can lead to operational disruptions, security breaches, and non-compliance with auditing requirements.",
        "action": "Ensure Redundant and Secure Time Synchronization",
        "mitigation": "Configure systems to use multiple, independent, and trusted NTP sources for redundancy. Whenever possible, use authenticated NTP (e.g., NTS) to prevent spoofing of time information. Monitor the availability and accuracy of the time service. If the NTP server is within the organization's control, it should be hardened and protected against unauthorized access.",
        "check": "Are systems configured with at least two independent NTP sources? Is the time service monitored? Is authenticated NTP used where supported and applicable? Are the configured NTP servers known to be reliable?",
        "asvs": "BSI IT-Grundschutz: SYS.1.6 Time Service, Requirement A5 (Synchronization of system time)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_Time_service_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified for any technical asset that has a communication link to another asset tagged as an 'ntp-server'. The risk is elevated if the asset relies on only a single NTP source, as this creates a single point of failure for time synchronization.",
        "riskAssessment": "The likelihood of an incident is higher for systems relying on a single NTP source ('Frequent'). The impact is determined by the availability and integrity requirements of the client system. Systems requiring accurate time for security functions (like certificate validation or TOTP) or for reliable transaction logging face a higher impact.",
        "falsePositives": "The model does not reflect the inherent reliability of the configured NTP sources. A system might use a single but highly reliable clustered NTP source, which is not distinguishable from a simple single server. Also, time synchronization might be handled by the underlying infrastructure (e.g., hypervisor) and might not be explicitly modeled.",
        "cwe": "295",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "78_sec3.ts",
        "bsiCode": "OPS.1.2.6",
        "id": "conflicting-ntp-servers-net.3.2",
        "title": "Conflicting Time Information from Multiple NTP Sources (BSI NET.3.2)",
        "description": "If an IT system uses multiple NTP servers to adjust its system clock, the time information from different NTP servers can vary.",
        "impact": "Incorrect system time can compromise authentication protocols (e.g., Kerberos), invalidate certificate checks, and corrupt logs and transaction records with false timestamps.",
        "action": "Establish a Hierarchical and Reliable Time Synchronization Strategy",
        "mitigation": "Configure a hierarchical time synchronization setup using a limited set of trusted, primary NTP sources. Other systems should synchronize with these internal primary sources.",
        "check": "Review the NTP configuration of the technical asset. Is it configured to use multiple, potentially conflicting, external NTP sources?",
        "asvs": "V14.4.1: Verify that all components have a common time source and that all logs have synchronized timestamps.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_NTP_time_service_edition_2023.pdf?__blob=publicationFile (BSI NET.3.2)",
        "detectionLogic": "This risk is raised for technical assets that are manually tagged with `@ntp-sources: >1`.",
        "riskAssessment": "The likelihood is considered 'Likely' if the tagged condition exists.",
        "falsePositives": "The system might have a sophisticated algorithm for selecting the best time source that is not reflected in the model, thereby handling potential conflicts gracefully.",
        "cwe": "829",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "78_sec4.ts",
        "bsiCode": "OPS.1.2.6",
        "id": "manipulation-of-time-information-ntp",
        "title": "Manipulation of Time Information (BSI Threat)",
        "description": "The Network Time Protocol (NTP) is susceptible to various attacks. An attacker could manipulate time information during transmission or redirect NTP requests to a malicious server. This could allow an attacker to manipulate the system time of NTP clients.",
        "impact": "Successful manipulation of system time can undermine time-based security controls. For example, an attacker could abuse expired time-limited access rights, bypass certificate validity checks, or falsify log entries, which complicates forensic analysis. This can compromise the confidentiality, integrity, and availability of the system and its data.",
        "action": "Implement Secure Time Synchronization",
        "mitigation": "Configure all systems to use a secure time synchronization mechanism. This can be achieved by using authenticated NTP (e.g., with symmetric keys) or a more secure protocol like Network Time Security (NTS). Ensure that configured time sources are trusted. For assets where this has been verified, apply the `@SecureTimeSync` tag to prevent this risk from being raised.",
        "check": "Are all systems configured to use authenticated NTP or NTS? Are the time sources trusted? Is the time synchronization traffic protected against manipulation, especially when crossing network boundaries?",
        "asvs": "V14.2.3: Verify that all components are configured to use a common, trusted, and reliable time source.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for sensitive server-side technical assets that are not explicitly tagged as using a secure time synchronization mechanism (`@SecureTimeSync`). The assumption is that these assets rely on a time source (like NTP) and are vulnerable if the protocol is not secured, especially when processing or storing sensitive information where time accuracy is critical for security controls.",
        "riskAssessment": "The likelihood of exploitation increases if the asset is internet-facing or communicates across untrusted network boundaries. The impact is determined by the CIA requirements of the asset and the data it handles. Manipulation of time on a system handling 'Strictly Confidential' data or performing 'Mission-Critical' functions has a very high impact.",
        "falsePositives": "This risk might be a false positive if time synchronization is secured by other means not visible in the model (e.g., network-level IPsec) or if the asset operates in a highly isolated environment where manipulation of NTP traffic is infeasible.",
        "cwe": "290",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "OPS.2.2": [
      {
        "file": "79_sec1.ts",
        "bsiCode": "OPS.2.2",
        "id": "lacking-cloud-strategy-ops.2.2.a1",
        "title": "Lacking or Inadequate Cloud Usage Strategy (BSI OPS.2.2.A1)",
        "description": "Using cloud services is a strategic decision for an institution. Without a clear and comprehensive strategy, there is a risk of selecting unsuitable cloud services or providers. The chosen services might be incompatible with the existing IT environment, internal business processes, or the required protection level for the data involved.",
        "impact": "An inadequate cloud strategy can lead to organizational, technical, and financial consequences. It may hinder business processes, prevent achievement of strategic goals, and significantly reduce overall security, potentially causing compliance violations, data breaches, and service disruptions.",
        "action": "Develop and document a comprehensive cloud strategy",
        "mitigation": "Define a formal strategy for cloud usage before adopting cloud services. This strategy should address provider selection criteria, data governance, security requirements (based on protection needs), integration with existing systems, exit strategies, and compliance obligations. Ensure the strategy is communicated to and understood by all relevant stakeholders, including architecture, development, and operations teams. The existence of such a strategy can be documented in the model by tagging the corresponding trust boundary with `@CloudStrategy:Defined`.",
        "check": "Is there a documented cloud usage strategy? Does it cover security, compliance, data classification, and provider vetting? Are the cloud services in use aligned with this strategy?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.2.2 Cloud-Nutzung, Requirement OPS.2.2.A1 (Creation of a strategy for cloud usage).",
        "cheatSheet": "https://www.bsi.bund.de",
        "detectionLogic": "This organizational risk is raised for each top-level cloud-based trust boundary found in the model (for example, types like 'network-cloud-provider' or 'network-cloud-security-group'). The presence of cloud services without a documented and validated strategy (indicated by the absence of the `@CloudStrategy:Defined` tag) is a potential architectural weakness.",
        "riskAssessment": "The likelihood is considered 'likely' if cloud services are used without explicit confirmation of a strategy via model tagging. The impact is determined by the highest sensitivity (CIA rating) of any technical asset located within the cloud trust boundary. Storing 'Mission-Critical' or 'Strictly-Confidential' assets in the cloud without a clear strategy results in a higher impact.",
        "falsePositives": "A risk might be flagged even if a robust cloud strategy exists but is not represented in the model. This risk can be considered a false positive or mitigated by applying the tag `@CloudStrategy:Defined` to the cloud trust boundary to indicate that a strategic review has been performed.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "79_sec2.ts",
        "bsiCode": "OPS.2.2",
        "id": "cloud-provider-dependency-ops-2-2",
        "title": "Dependency on External Cloud Provider (BSI OPS.2.2)",
        "description": "When an institution uses external cloud services, it becomes dependent on the cloud service provider.",
        "impact": "A failure or malicious act by the cloud provider can directly compromise the confidentiality, integrity, and availability (CIA) of the institution's data and services.",
        "action": "Manage Cloud Provider Dependency and Ensure Sufficient Oversight",
        "mitigation": "Implement a robust governance framework for cloud usage. This includes thorough vetting of providers (e.g., checking certifications like ISO 27001, C5),",
        "check": "Is there a formal vetting process for cloud providers? Are strong SLAs for security and availability contractually defined?",
        "asvs": "BSI IT-Grundschutz Baustein OPS.2.2 (Cloud-Nutzung)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_General_operation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI OPS.2.2)",
        "detectionLogic": "Detects technical assets operating within a cloud-based trust boundary (e.g., 'network-cloud-provider', 'network-cloud-security-group').",
        "riskAssessment": "The likelihood of being dependent is constant once a cloud service is used; therefore, it is rated 'Likely'.",
        "falsePositives": "This risk may be a false positive or significantly reduced if the asset in the cloud is non-critical and the organization has implemented",
        "cwe": "1277",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "79_sec3.ts",
        "bsiCode": "OPS.2.2",
        "id": "lacking-requirements-management-for-cloud-usage-ops115",
        "title": "Lacking Requirements Management for Cloud Usage (BSI OPS.2.2)",
        "description": "When an institution decides to use a cloud service, many expectations are usually attached. For example, employees hope for higher performance or a broader range of functions from the outsourced services, while management expects lower costs. However, a lack of requirements management before using the cloud can lead to these expectations not being met and the service not delivering the desired added value, for example in terms of availability, security, or compliance.",
        "impact": "If the selected cloud service does not meet the actual business, technical, and security requirements, it can lead to operational disruptions, failure to meet business objectives, unexpected costs, and a negative impact on the availability, performance, or security of dependent systems. This risk materializes as a failure to realize expected benefits and can cause potential financial loss or compliance violations.",
        "action": "Establish a Formal Cloud Adoption and Requirements Management Process",
        "mitigation": "Define and document clear business, technical, security, and compliance requirements before selecting and integrating a cloud service. Evaluate potential cloud providers and services against these defined requirements. The process should include a cost-benefit analysis, a risk assessment of the provider, and a review of the provider's service level agreements (SLAs). Document the decision and ensure all stakeholders (business, technical, security, legal) are involved. Use the 'cloud-requirements-defined' tag on assets where this process has been completed.",
        "check": "Is there a documented process for cloud service evaluation? Were specific availability, performance, and security requirements defined before adoption? Was a cost-benefit analysis performed and reviewed? Are SLAs from the cloud provider understood and accepted?",
        "asvs": "V1.1.4: Ensure that security requirements are defined and implemented for all application components, including those related to cloud services.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Cloud_usage_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This organizational risk is raised for any technical asset identified as being part of a cloud environment (i.e., located within a cloud-provider trust boundary or of a serverless machine type). The risk can be mitigated on a per-asset basis by applying the 'cloud-requirements-defined' tag, which signifies that a formal requirements and evaluation process was followed for that specific service.",
        "riskAssessment": "The impact is derived directly from the availability requirement of the technical asset using the cloud service. A service with 'mission-critical' availability that fails to meet its non-functional requirements will have a 'very-high' impact. The likelihood is considered 'likely' by default, as omitting a formal requirements process for cloud services is a common anti-pattern.",
        "falsePositives": "This risk may be a false positive if a thorough, albeit undocumented or untagged, requirements management process was indeed followed. The risk serves as a prompt to verify and document this process.",
        "cwe": "1035",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "79_sec4.ts",
        "bsiCode": "OPS.2.2",
        "id": "unclear-legal-framework-for-cloud",
        "title": "Unclear Legal Framework for International Cloud Providers (BSI-style)",
        "description": "Many providers offer their cloud services in an international environment, making them subject to different national legal systems.",
        "impact": "Using international cloud services without a clear understanding of the legal framework can lead to non-compliance with data protection laws (like @DataType:PII),",
        "action": "Perform Legal and Contractual Due Diligence for Cloud Services",
        "mitigation": "Thoroughly review the legal and data protection frameworks applicable to the cloud provider.",
        "check": "Has the cloud provider's contract been reviewed by legal experts? Is the data residency location contractually guaranteed?",
        "asvs": "BSI IT-Grundschutz OPS.2.2 Cloud-Nutzung (Cloud Usage), specifically Requirement OPS.2.2.A1 (Strategy for cloud usage) and OPS.2.2.A9 (Contract design with cloud providers).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_2_2_Cloud_usage_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any technical asset located within a cloud-based trust boundary (e.g., 'Network Cloud Provider').",
        "riskAssessment": "The likelihood is considered 'Likely' because major cloud providers are subject to international laws that may conflict with local regulations.",
        "falsePositives": "This risk might be a false positive if the modeled 'Cloud Provider' is a national or sovereign cloud not subject to foreign jurisdictions,",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "79_sec5.ts",
        "bsiCode": "OPS.2.2",
        "id": "insufficient-tenant-isolation-in-cloud-environment",
        "title": "Insufficient Tenant Isolation in Cloud Environment",
        "description": "In cloud computing, multiple tenants often share a common infrastructure, including IT systems, networks, and applications.",
        "impact": "A breach in tenant isolation can lead to severe data breaches, compromising the Confidentiality, Integrity, and Availability (CIA) of the affected tenant's data and services.",
        "action": "Ensure Strong Tenant Isolation and Segmentation",
        "mitigation": "Implement and verify strong logical and physical isolation controls between tenants. Use dedicated resources (e.g., VPCs, dedicated hosts) for highly sensitive workloads.",
        "check": "Is the technical asset configured for multi-tenancy? Are the isolation mechanisms provided by the cloud platform or application framework configured according to security best practices?",
        "asvs": "V14.2.5: Verify that cloud or containerization solutions are configured to ensure strong isolation between tenants or containers, preventing data leakage or unauthorized access.",
        "cheatSheet": "https://owasp.org/www-project-cloud-native-application-security-top-10/descriptions/cnapp-1-insecure-cloud-service-configuration",
        "detectionLogic": "The risk is triggered for any in-scope technical asset marked as `multi-tenant: true`. The severity of the risk is calculated based on the sensitivity (CIA ratings) of the asset itself and the data assets it processes or stores.",
        "riskAssessment": "The likelihood is higher for custom-developed multi-tenant platforms versus mature PaaS/SaaS offerings from major cloud providers. The impact is directly proportional to the highest confidentiality, integrity, and availability requirements of the data processed or stored by the multi-tenant asset. A multi-tenant database storing 'Strictly Confidential' data for multiple clients represents a 'Very High' impact if isolation fails.",
        "falsePositives": "This risk might be considered a false positive or of lower severity if the asset is a well-established and hardened SaaS/PaaS offering from a reputable provider where tenant isolation is a core, audited feature. However, even in these cases, misconfiguration by the consumer of the service can weaken isolation, so the risk often remains relevant.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "79_sec6.ts",
        "bsiCode": "OPS.2.2",
        "id": "inadequate-cloud-provider-contracts-con2",
        "title": "Inadequate Contractual Agreements with Cloud Service Providers (BSI OPS.2.2)",
        "description": "Inadequate contractual agreements with cloud service providers can lead to significant and severe security issues.",
        "impact": "This can lead to unimplemented or weak security controls, unclarified responsibilities in case of incidents, and risks from undisclosed sub-processors,",
        "action": "Review and Enhance Cloud Service Provider Contracts",
        "mitigation": "Ensure that contracts with cloud service providers clearly define all security requirements, responsibilities (including for sub-processors),",
        "check": "Are there formal, legally-reviewed contracts for all cloud services? Do these contracts explicitly state security responsibilities,",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.2.2 (Cloud Usage)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_2_Cloud_service_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organizational risk is triggered for any technical assets that are identified as being part of an external or cloud-based service offering.",
        "riskAssessment": "The likelihood is considered higher for services handling critical data or that are internet-facing, as the complexity of contractual requirements increases.",
        "falsePositives": "This risk can be considered a false positive if the organization has robust, well-defined contracts and supplier management processes in place for the identified cloud service.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "APP.3.1": [
      {
        "file": "7_sec1.ts",
        "bsiCode": "APP.3.1",
        "id": "insufficient-logging-of-web-components",
        "title": "Insufficient Logging of Web Components (BSI APP.3.1)",
        "description": "If security-relevant events from a web application or web service are insufficiently logged,",
        "impact": "Without adequate logs, organizations cannot effectively detect, investigate, or respond to security incidents.",
        "action": "Implement Comprehensive Logging for Web Components",
        "mitigation": "Ensure that all security-relevant events are logged for web applications and web services. This includes, but is not limited to:",
        "check": "Are security events like logins, configuration changes, and errors logged? Are the logs protected from unauthorized access or modification?",
        "asvs": "BSI IT-Grundschutz APP.3.1 Webanwendungen und Webservices",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_1_Webanwendungen_und_Webservices_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all in-scope technical assets identified as web applications, web servers, or web services.",
        "riskAssessment": "The likelihood of this vulnerability is considered high for custom-developed parts, as security logging is frequently incomplete.",
        "falsePositives": "A technical asset might not perform logging itself but could forward all relevant information to a central logging component or SIEM.",
        "cwe": "778",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "7_sec2.ts",
        "bsiCode": "APP.3.1",
        "id": "information-leakage-about-backend-systems",
        "title": "Information Leakage about Backend Systems via HTTP Headers or Error Messages",
        "description": "Websites and data generated and delivered by a web application or web service can contain information about the underlying backend systems, such as details about databases, server types, or framework version numbers (e.g., in `Server` or `X-Powered-By` HTTP headers, or in verbose error messages). This information makes it significantly easier for attackers to launch targeted attacks by looking up known vulnerabilities for the identified technologies.",
        "impact": "The disclosure of technical details about the backend infrastructure (like server types, framework versions, or internal error details) provides attackers with a clear roadmap for finding known vulnerabilities and tailoring their exploits. This significantly lowers the effort required for a successful attack, increasing the likelihood of a compromise.",
        "action": "Harden Web Server and Application Configuration to Suppress Banners and Errors",
        "mitigation": "Configure web servers, application servers, and frameworks to suppress detailed version banners and other sensitive technical information in HTTP response headers (e.g., `Server`, `X-Powered-By`, `X-AspNet-Version`). Implement custom, generic error pages that do not leak internal stack traces, database errors, or other implementation details. Regularly scan the application to detect information leakage points.",
        "check": "Are HTTP response headers and error pages reviewed to ensure they do not leak backend technology details? Are server configurations set to hide version banners and other fingerprints? Are custom error pages used for all types of server-side exceptions?",
        "asvs": "V14.1.2: Verify that the application does not reveal sensitive information in HTTP response headers, such as detailed version information of the web or application server, or frameworks used.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any in-scope technical assets identified as a web server, web application, application server, or web service (typically REST-based). These types of assets are prone to leaking information through HTTP headers or error pages if not properly hardened.",
        "riskAssessment": "The likelihood is considered 'likely' for any unhardened web technology. The impact is directly related to the sensitivity of the asset and the data it processes or stores. An information leak on a system handling 'Strictly Confidential' data poses a 'High' impact because it directly aids attackers in compromising a high-value target.",
        "falsePositives": "The risk can be considered a false positive if the asset has already been properly hardened to suppress all unnecessary technical information in both HTTP headers and error messages. This requires manual verification of the asset's live configuration and behavior under error conditions.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "7_sec3.ts",
        "bsiCode": "APP.3.1",
        "id": "automated-threats-bsi-app3.1",
        "title": "Automated Threats (e.g., Brute Force, Enumeration, DoS)",
        "description": "When functions of a web application or web service are automated, numerous operations can be executed in a short time.",
        "impact": "Insufficient protection against automated attacks can lead to credential compromise through brute forcing, sensitive information disclosure via account enumeration, and degradation or complete loss of service availability (DoS). This can result in unauthorized access, data breaches, and disruption of business operations.",
        "action": "Implement Protection Against Unauthorized Automated Use",
        "mitigation": "Implement robust protection mechanisms against automated, high-frequency requests. Key controls include:",
        "check": "Are sensitive endpoints like login and registration protected by rate limiting? Is there an account lockout policy for failed authentication attempts? Are CAPTCHAs or similar bot-detection mechanisms in place? Is there monitoring for unusual request volumes?",
        "asvs": "BSI IT-Grundschutz APP.3.1.A7 (Protection against unauthorized automated use), OWASP Top 10 2021: A07 – Identification and Authentication Failures, OWASP Automated Threat Handbook (OAT-007 Credential Cracking, OAT-012 Account Enumeration, OAT-018 Denial of Service)",
        "cheatSheet": "https://www.bsi.bund.de/EN/Topics/ITGrundschutz/itgrundschutz_node.html",
        "detectionLogic": "This risk is raised for internet-facing or critical internal web applications, web services, and identity providers that are not explicitly marked as having protection against automated attacks (e.g., via the 'mitigation:automated-threat-protection' tag).",
        "riskAssessment": "The likelihood is significantly increased for assets exposed to the internet, especially identity providers. The impact is determined by the Confidentiality, Integrity, and Availability (CIA) requirements of the asset and the data it processes. An attack on an identity provider or a system handling strictly confidential data will have a very high impact.",
        "falsePositives": "This risk might be a false positive if protection mechanisms are in place but not documented in the model via the specified tag. Verification requires checking the application's configuration, source code, or the presence of external protection like a WAF.",
        "cwe": "307",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "7_sec4.ts",
        "bsiCode": "APP.3.1",
        "id": "weak-authentication",
        "title": "Weak or Missing Authentication for Web Application / Web Service",
        "description": "Often, special functions of a web application or web service should be reserved for specific groups of users.",
        "impact": "Bypassing authentication can lead to unauthorized access to data and functionality, resulting in data breaches, financial loss, and reputational damage.",
        "action": "Implement Strong Authentication and Session Management",
        "mitigation": "Enforce strong authentication for all sensitive endpoints of web applications and web services.",
        "check": "Is authentication enforced on all communication links to web applications and web services that are not explicitly public?",
        "asvs": "V2 Authentication Verification Requirements, V3 Identification and Authentication Failures",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for web applications and web services that have incoming communication links with weak or no authentication.",
        "riskAssessment": "The likelihood of exploitation is high if no authentication is present on an internet-facing or cross-boundary link.",
        "falsePositives": "Endpoints that are designed to be public (e.g., a login page itself, public data feeds) might be flagged.",
        "cwe": "287",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "OPS.2.3": [
      {
        "file": "80_sec1.ts",
        "bsiCode": "OPS.2.3",
        "id": "inadequate-outsourcing-security-strategy-con6",
        "title": "Inadequate Outsourcing Security Strategy (BSI OPS.2.3)",
        "description": "An inadequate strategy leads to information security not being properly considered in outsourcing projects.",
        "impact": "This can impair or cause business processes to fail and can lead to sensitive information leaking to unauthorized third parties,",
        "action": "Develop and Enforce a Comprehensive Outsourcing Security Strategy",
        "mitigation": "Establish and enforce a comprehensive security strategy for all outsourcing engagements. This strategy should include:",
        "check": "Is there a documented strategy for managing security in outsourcing? Are security requirements part of contracts with providers? Is the provider's compliance with security requirements monitored and regularly reviewed?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein OPS.2.3 (Nutzung von Outsourcing)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/CON_6_Management_of_external_IT_services_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any communication link from an in-scope asset to a technical asset of type 'external-entity'.",
        "riskAssessment": "The likelihood is considered 'likely' by default, assuming no formal strategy is in place if not explicitly modeled. The impact is calculated based on the highest Confidentiality, Integrity, and Availability ratings of the data assets being transferred to the external entity. Transfer of highly sensitive or critical data results in a higher impact.",
        "falsePositives": "The model might not capture the existence of a robust, real-world outsourcing governance process. If a proper strategy is in place for a specific outsourced service, this risk can be considered a false positive for that context.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "80_sec10.ts",
        "bsiCode": "OPS.2.3",
        "id": "improper-outsourcing-termination-process",
        "title": "Improper Outsourcing Termination Process (BSI DER.1.A15)",
        "description": "Inadequate or missing regulations for the termination of an outsourcing relationship can lead to hardware, data, and access rights not being properly transferred back to the commissioning entity. This can result in loss of data, continued unauthorized access by the former outsourcing partner, and disruption of business operations.",
        "impact": "Failure to properly manage the termination process can severely impact Confidentiality (if the outsourcer retains data/access), Integrity (if data is returned incomplete or corrupted), and Availability (if the business loses access to critical data or services required for its operations).",
        "action": "Define and Implement a Formal Offboarding Process for Outsourcing Partners",
        "mitigation": "Establish clear, contractual regulations for the termination of the outsourcing relationship. This must include procedures for the secure, certified deletion of data on the outsourcer's systems, the complete transfer of all business data back in a usable format, the immediate revocation of all access credentials and network connections, and the return or certified disposal of any physical hardware. Conduct a final audit to confirm all offboarding steps have been successfully completed.",
        "check": "Is there a documented and contractually agreed-upon offboarding plan for every outsourcing relationship? Does the plan cover data return, data deletion, access revocation, and hardware transfer? Are there procedures to verify the completion of the offboarding process?",
        "asvs": "BSI IT-Grundschutz DER.1.A15 (Regulations for contract termination)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Outsourcing_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any 'external-entity' technical asset marked with the '@Outsourcer' tag that does not also have a mitigating '@Offboarding-Plan-Exists' tag. The risk's severity is determined by the sensitivity of the data exchanged with the outsourcer.",
        "riskAssessment": "The impact is directly dependent on the highest Confidentiality, Integrity, and Availability ratings of all data assets exchanged with the outsourcing partner. If mission-critical systems or strictly confidential data are involved, the impact is considered very high. The likelihood is considered 'likely' by default if no explicit offboarding plan is documented for the relationship.",
        "falsePositives": "This risk is flagged based on the model's tags. It can be considered a false positive if a sufficient contractual offboarding plan exists but has not been marked in the model with the '@Offboarding-Plan-Exists' tag.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "80_sec11.ts",
        "bsiCode": "OPS.2.3",
        "id": "inadequate-emergency-management-for-outsourcing",
        "title": "Inadequate Emergency Management for Outsourced Services (BSI CON.1)",
        "description": "In the event of a disruption, emergency, or crisis, inadequate contingency management for outsourced services can lead to service failure.",
        "impact": "Failure to adequately plan for the unavailability of a critical outsourced service can lead to a significant denial of service for the dependent systems.",
        "action": "Establish and Verify Business Continuity Plans for Critical External Dependencies",
        "mitigation": "Identify all critical business processes and the technical assets they depend on, especially those involving external service providers.",
        "check": "Are critical external dependencies identified? Are there SLAs covering availability and recovery? Is there a documented and tested Business Continuity Plan for the failure of this dependency?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Contingency Management)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Contingency_Management_edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
        "detectionLogic": "This risk is raised for in-scope technical assets with 'Important', 'Critical', or 'Mission-Critical' availability requirements that have a communication link to an 'External Entity'.",
        "riskAssessment": "The impact of this risk is derived directly from the availability requirement of the technical asset that depends on the outsourced service.",
        "falsePositives": "A business continuity plan might exist at the organizational level but is not documented in the threat model via the `@BCP:Confirmed` tag. This risk should be confirmed with the system architect or operations team.",
        "cwe": "755",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "80_sec2.ts",
        "bsiCode": "OPS.2.3",
        "id": "uncontrolled-outsourcing-of-critical-processes",
        "title": "Uncontrolled Outsourcing of Critical Processes (BSI CON.1)",
        "description": "Processes that should remain within the institution due to their criticality or protection requirements are outsourced.",
        "impact": "Failure or disruption of a critical outsourced process can severely impact business continuity, leading to financial losses and reputational damage.",
        "action": "Establish a Formal Outsourcing Governance Process",
        "mitigation": "Implement a robust process for evaluating, selecting, and managing outsourcing providers.",
        "check": "Is there a formal policy governing the outsourcing of services? Are risk assessments performed before outsourcing critical processes?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.1 (Outsourcing), Requirement CON.1.A5 (Selecting suitable service providers) and CON.1.A6 (Drawing up outsourcing contracts).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_Edition_2023.pdf?__blob=publicationFile&v=2 (BSI CON.1)",
        "detectionLogic": "This risk is triggered when a technical asset explicitly marked as critical for in-house operation (`@Should-Not-Be-Outsourced` tag) has a communication link to an `External-Entity`.",
        "riskAssessment": "The impact is derived directly from the availability and integrity rating of the internal process being outsourced.",
        "falsePositives": "This risk may be a false positive if the `External-Entity` is not a typical outsourcing provider but, for example, a government regulatory body that the process must report to by law.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "80_sec3.ts",
        "bsiCode": "OPS.2.3",
        "id": "dependency-on-outsourcing-provider",
        "title": "Dependency on Outsourcing Provider",
        "description": "When an organization chooses to outsource, it becomes dependent on the outsourcing provider. This dependency can lead to a loss of internal knowledge and a loss of full control over the outsourced processes.",
        "impact": "A strong dependency on an outsourcing provider, coupled with a loss of control and insight, can lead to security vulnerabilities going undetected and unaddressed.",
        "action": "Establish clear outsourcing contracts, monitoring, and exit strategies",
        "mitigation": "Define clear, legally binding contracts with outsourcing providers that include specific security requirements (SLAs), audit rights, and data protection clauses.",
        "check": "Are there clear contracts defining security responsibilities? Are the provider's security measures regularly audited or certified?",
        "asvs": "BSI IT-Grundschutz-Kompendium: OPS.2.3 Nutzung von Outsourcing",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Outsourcing_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered by identifying internal technical assets that have communication links to assets of type 'external-entity'.",
        "riskAssessment": "The impact is determined by the criticality (integrity and availability) of the dependent internal asset and the confidentiality of the data sent to the external provider.",
        "falsePositives": "This rule might flag minor dependencies on non-critical external services (e.g., a public, non-essential API) as a risk.",
        "cwe": "829",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "80_sec4.ts",
        "bsiCode": "OPS.2.3",
        "id": "insufficient-outsourcing-security-standard-der.1",
        "title": "Insufficient Information Security Standard in Outsourcing (BSI DER.1)",
        "description": "An inadequate level of information security within the outsourcing customer's organization can lead to security being neglected in outsourcing projects.",
        "impact": "If an outsourcing provider fails to maintain adequate security, it can lead to data breaches, system compromises, and service unavailability.",
        "action": "Establish, enforce, and verify security requirements for outsourcing providers",
        "mitigation": "Define clear and robust information security requirements for all outsourcing providers. These requirements must be included in legally binding contracts.",
        "check": "Are information security requirements included in contracts with outsourcing providers? Is there a formal process for assessing the security posture of new providers?",
        "asvs": "BSI IT-Grundschutz DER.1: Supplier and service provider management; specifically DER.1.A5 (Monitoring information security for suppliers and service providers)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Supplier_and_service_provider_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk applies to all 'External-Entity' technical assets that handle sensitive data. The rule identifies external providers and raises a risk if they process or store",
        "riskAssessment": "The impact depends directly on the maximum confidentiality, integrity, and availability (CIA) requirements of the data handled by the external provider. The likelihood is 'likely' by default for any",
        "falsePositives": "This risk may be a false positive if a comprehensive supplier security management process is in place, including contractual requirements and regular audits,",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "80_sec5.ts",
        "bsiCode": "OPS.2.3",
        "id": "inadequate-outsourcing-management",
        "title": "Inadequate Outsourcing Management (based on BSI OPS.2.3)",
        "description": "When outsourcing management is non-existent or only partially implemented, the ongoing outsourced processes are managed inadequately.",
        "impact": "The inability to control and verify the security practices of an outsourcing provider can lead to compromises of Confidentiality, Integrity, and Availability (CIA) for all data assets sent to or received from the provider.",
        "action": "Establish and Maintain Outsourcing Management and Monitoring",
        "mitigation": "Implement a comprehensive outsourcing management process. This includes defining clear security requirements in contracts (SLAs), establishing regular monitoring and auditing procedures for the provider, and maintaining clear lines of communication.",
        "check": "Are there communication links to external entities that lack evidence of a managed relationship (e.g., missing the `@Outsourcing:Managed` tag)? Are contracts with these providers reviewed for security clauses? Are audits or reviews of the provider conducted regularly?",
        "asvs": "BSI IT-Grundschutz OPS.2.3 (Nutzung von Outsourcing)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_2_Outsourcing_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any communication link that targets an `External-Entity` and is not explicitly marked as managed via the `@Outsourcing:Managed` tag.",
        "riskAssessment": "The impact is directly proportional to the highest CIA requirements of the data assets being exchanged with the external provider. An unmanaged connection to a provider handling `Strictly-Confidential` data poses a `Very High` impact.",
        "falsePositives": "A false positive can occur if an outsourcing management process exists in reality, but the corresponding communication link in the model has not been tagged with `@Outsourcing:Managed`. The model accurately reflects the lack of documented assurance.",
        "cwe": "1395",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "80_sec6.ts",
        "bsiCode": "OPS.2.3",
        "id": "inadequate-contractual-agreements-bsi-con-1-g2",
        "title": "Inadequate Contractual Agreements with Outsourcing Providers (BSI CON.1.G2)",
        "description": "Inadequate contractual agreements with outsourcing providers can create information security vulnerabilities throughout the entire outsourcing lifecycle. Contracts define the overall process and form the basis for claims by users against providers. If tasks, performance parameters, or efforts are insufficiently or ambiguously described, security measures may not be implemented due to a lack of knowledge or resources.",
        "impact": "Failure to define security requirements in outsourcing contracts can lead to non-fulfillment of regulatory requirements, failure to comply with disclosure obligations and laws, and inadequate protection of the user's processes and data. This can result in security incidents, data breaches, financial losses, and reputational damage.",
        "action": "Establish Clear, Comprehensive, and Secure Outsourcing Contracts",
        "mitigation": "Ensure that all outsourcing contracts explicitly detail information security requirements, including data protection standards, security measures, incident response protocols, audit rights, and clear liability clauses. All relevant legal and regulatory requirements must be incorporated. Use a tag like `contract:reviewed` on the relevant technical asset in the model to signify that this has been done.",
        "check": "Is there a formal process for reviewing outsourcing contracts for security requirements? Do contracts with external providers include specific clauses for data handling, security controls, incident notification, and right to audit? Are the assets representing these outsourced services tagged appropriately (e.g., `provider:external` or `out_of_scope`)?",
        "asvs": "BSI IT-Grundschutz CON.1.A5 (Requirements for outsourcing contracts)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This organizational risk is triggered for any technical asset that is marked as `out_of_scope` or tagged as `provider:external`, as these typically represent services managed by third parties. The risk assumes that without explicit confirmation, the contractual basis for security may be insufficient.",
        "riskAssessment": "The likelihood is considered 'Likely' by default for any outsourced component. The impact is determined by the maximum Confidentiality, Integrity, and Availability (CIA) ratings of the asset itself and the data it processes or stores. High or critical CIA ratings lead to a higher impact.",
        "falsePositives": "This risk is a cautionary flag. A robust contract might be in place even if not reflected in the model. The risk can be marked as a false positive or mitigated by applying the `contract:reviewed` tag to the asset after confirming contractual adequacy.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "80_sec7.ts",
        "bsiCode": "OPS.2.3",
        "id": "inappropriate-rights-for-outsourced-personnel-con1",
        "title": "Inappropriate Access Rights for Outsourced Personnel (BSI CON.1)",
        "description": "When outsourcing, it is often necessary for the provider's employees to have access rights to the customer's IT systems, information, or premises.",
        "impact": "Failure to properly manage access rights for external personnel can lead to severe security incidents, including data breaches (Confidentiality), unauthorized data modification (Integrity), and service disruption (Availability). This can result in significant financial loss, reputational damage, and violation of legal or contractual obligations.",
        "action": "Implement and Enforce Least Privilege for Outsourced Access",
        "mitigation": "Enforce the principle of least privilege for all access granted to external personnel. Use strong, individual authentication methods (e.g., client certificates, multi-factor authentication) instead of shared credentials.",
        "check": "Are all access rights for external personnel documented? Is there a regular access review and recertification process? Is the principle of least privilege technically enforced? Is strong, non-shared authentication used for all external access?",
        "asvs": "BSI IT-Grundschutz-Kompendium: CON.1 Outsourcing (especially requirement CON.1.A15: Control of access options and rights)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule identifies communication links originating from technical assets representing an outsourcing provider (tagged with `@Role:ExternalServiceProvider`) that connect to in-scope assets.",
        "riskAssessment": "The likelihood of exploitation is high if authentication or authorization is missing. The impact is determined by the confidentiality, integrity, and availability requirements of the target asset.",
        "falsePositives": "A risk might be flagged for a legitimate, highly-controlled administrative access scenario where compensating controls (e.g., contractual agreements, continuous auditing, session recording) are not visible in the model.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "80_sec8.ts",
        "bsiCode": "OPS.2.3",
        "id": "lack-of-control-over-subcontractors",
        "title": "Lack of Control Over Subcontractors (BSI DER.1.A8)",
        "description": "Outsourcing providers may delegate parts of their services to subcontractors. This increases the complexity of the outsourcing process and reduces transparency for the customer.",
        "impact": "If security requirements are not passed down and enforced with subcontractors, it can lead to unmitigated vulnerabilities in the service chain.",
        "action": "Establish and Enforce Security Requirements for Subcontractors",
        "mitigation": "Contractually require the outsourcing provider to disclose the use of any sub-contractors.",
        "check": "Do contracts with service providers include clauses about sub-contractor management? Are we aware of all sub-contractors handling our data?",
        "asvs": "BSI IT-Grundschutz DER.1: General Service Provider Management (Requirement DER.1.A8: Managing sub-contractors)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_General_service_provider_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any 'External-Entity' technical asset tagged as an 'external-provider'.",
        "riskAssessment": "The likelihood of this risk is considered 'Likely' by default for any outsourced relationship where subcontractor controls are not explicitly verified.",
        "falsePositives": "A provider might have excellent and transparent subcontractor management in place. This cannot be determined from the threat model alone and requires reviewing contracts and audit reports.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "80_sec9.ts",
        "bsiCode": "OPS.2.3",
        "id": "insufficient-outsourcing-control-der1.a6",
        "title": "Insufficient Control and Monitoring of Outsourcing Providers (BSI DER.1.A6)",
        "description": "If an institution lacks adequate instruments, such as key performance indicators (KPIs) and audit rights, to monitor and control its outsourcing providers, it cannot effectively verify that the outsourced processes are implemented correctly and securely. This lack of control and steering mechanisms prevents the institution from ensuring that contractually agreed security requirements are met by the provider.",
        "impact": "The inability to detect and respond to poor performance or security deficiencies from an outsourcing provider can lead to a gradual degradation of security. This may result in confidentiality breaches, integrity loss, or availability issues for the services and data handled by the provider, often without the institution's knowledge. This can lead to compliance violations, financial loss, and reputational damage.",
        "action": "Establish and Implement a Supplier Review and Audit Process",
        "mitigation": "Define and contractually agree upon clear, measurable Key Performance Indicators (KPIs) and Service Level Agreements (SLAs) for security. Implement a regular review process, including rights to audit, performance reports, and regular meetings with the provider. Ensure that rights to audit and access to necessary information for verification are part of the contract. The results of these reviews must be documented, and any identified deficiencies must be tracked until resolved.",
        "check": "Are there formal, contractually defined KPIs and SLAs for security with the outsourcing provider? Does a regular review and audit process exist? Are the results of these reviews documented? Are there defined procedures for escalating and addressing non-performance?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein DER.1 (Supplier and Service Provider Management), specifically Requirement DER.1.A6 (Reviewing the services of suppliers and service providers).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Supplier_and_service_provider_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to technical assets of type 'external-entity' that are explicitly marked with the 'outsourcing-provider' tag. The model assumes that without specific evidence of controls (which is outside the model's scope), a risk of insufficient monitoring exists for any outsourced relationship.",
        "riskAssessment": "The likelihood is considered 'likely' if a critical service is outsourced. The impact is directly related to the CIA requirements of the data assets sent to and received from the provider, as well as the overall criticality of the service it provides. High-impact data or mission-critical services being outsourced lead to a higher risk rating.",
        "falsePositives": "The model can only identify the presence of an outsourced relationship via asset type and tags. It cannot know the contractual details or the real-world review processes. A risk will be flagged based on the model, but it is a false positive if a robust, real-world supplier management and review process is in place, even if not modeled with specific tags.",
        "cwe": "221",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "OPS.3.2": [
      {
        "file": "81_sec1.ts",
        "bsiCode": "OPS.3.2",
        "id": "deficient-ism-at-outsourcer-bsi-orp2-a5",
        "title": "Deficient Information Security Management at Outsourcing Provider (BSI ORP.2.A5)",
        "description": "A deficient information security management system (ISMS) at an outsourcing provider can lead to the inadequate fulfillment of information security objectives (Confidentiality, Integrity, Availability).",
        "impact": "Failure to meet contractually agreed security objectives can result in data breaches, service disruptions, financial losses, reputational damage, and non-compliance with legal or regulatory requirements (e.g., personal data (PII)).",
        "action": "Implement and Enforce Supplier Security Management",
        "mitigation": "Establish a robust supplier security management process. This includes thorough due diligence before onboarding, clear contractual security requirements (SLAs),",
        "check": "Are there formal contracts with security SLAs for all outsourcing providers? Is due diligence performed? Are security controls of the provider regularly reviewed or audited? Are data processing agreements in place?",
        "asvs": "BSI IT-Grundschutz ORP.2: Supplier and Service Provider Management, specifically Requirement ORP.2.A5: Monitoring of information security in the case of suppliers and service providers.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Supplier_and_service_provider_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is automatically raised for any 'External-Entity' technical asset that communicates with in-scope assets.",
        "riskAssessment": "The impact is directly proportional to the sensitivity (CIA ratings) of the data assets exchanged with the provider.",
        "falsePositives": "This risk may be considered a false positive or can be downgraded if a very strong, well-documented, and audited supplier management process is in place for the specific provider, even if not explicitly modeled.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "81_sec2.ts",
        "bsiCode": "OPS.3.2",
        "id": "inadequate-outsourcer-contingency-planning",
        "title": "Inadequate Contingency Planning by Outsourcing Provider (BSI CON.1, CON.8)",
        "description": "When disruptions or emergencies occur at an outsourcing provider, it can lead to operational failures that also affect the outsourced processes of the customer, impacting their regular business operations.",
        "impact": "A lack of effective emergency preparedness at the provider can render disruptions and crises unmanageable for the customer institution.",
        "action": "Verify and Ensure Supplier's Business Continuity and Contingency Plans",
        "mitigation": "Establish strong contractual requirements for the outsourcing provider's business continuity and emergency preparedness. Regularly review and audit the provider's contingency plans, test results, and recovery capabilities.",
        "check": "Are there contractual agreements regarding the provider's contingency planning? Have the provider's Business Continuity Management (BCM) plans been reviewed or audited? Are RTOs and RPOs defined and contractually agreed upon? Is there a plan for what happens if the provider is unavailable for an extended period?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium Baustein CON.1 (Outsourcing) and CON.8 (Contingency management).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_Edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
        "detectionLogic": "This risk is raised for any in-scope technical asset that has a communication link to an asset of type 'external-entity'.",
        "riskAssessment": "The likelihood of an outage causing impact is higher for dependencies on single, non-redundant external providers. The impact is directly proportional to the 'availability' rating of the internal asset that depends on the provider.",
        "falsePositives": "This risk may be a false positive if the outsourcing provider has demonstrably robust and audited contingency plans that meet or exceed the customer's requirements.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "81_sec3.ts",
        "bsiCode": "OPS.3.2",
        "id": "inadequate-outsourcing-contracts-der1.a5",
        "title": "Inadequate Outsourcing Contracts (BSI DER.1.A5)",
        "description": "Inadequacies in the contractual design for outsourced services can lead to insufficient information security for the outsourced processes.",
        "impact": "If security requirements are not contractually defined and enforced with an external service provider, it can lead to the compromise of confidentiality, integrity, or availability",
        "action": "Define, Enforce, and Verify Security Requirements in All Outsourcing Contracts",
        "mitigation": "Ensure that all contracts with external service providers include clear, comprehensive, and enforceable information security requirements.",
        "check": "Are all contracts with external service providers reviewed for security requirements? Do they include clauses covering data protection, incident handling, and audit rights?",
        "asvs": "BSI IT-Grundschutz Baustein DER.1: Outsourcing to external service providers, Requirement DER.1.A5: Defining and reviewing security requirements in contracts.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Outsourcing_to_external_service_providers_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is automatically raised for any technical asset of type `external-entity` that is in-scope and does not have the `contract:security-clauses-verified` tag.",
        "riskAssessment": "The impact of this risk is determined by the highest confidentiality, integrity, and availability requirements of the data assets exchanged with the external service provider.",
        "falsePositives": "This risk can be considered a false positive if a secure contract is in place but the corresponding asset in the model has not yet been tagged with `contract:security-clauses-verified`.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "81_sec4.ts",
        "bsiCode": "OPS.3.2",
        "id": "weak-outsourcing-interface",
        "title": "Weakness at the Outsourcing Interface (Technische/Organisatorische Schwachstellen an der Outsourcing-Schnittstelle)",
        "description": "The technical connection between outsourcing users and providers can introduce technical and organizational weaknesses at the interfaces.",
        "impact": "If technical or organizational weaknesses at an outsourcing interface are exploited, this can result in data breaches (Confidentiality), unauthorized data modification (Integrity), or service disruptions (Availability).",
        "action": "Strengthen and formalize the outsourcing interface",
        "mitigation": "Ensure all communication links to outsourcing providers are technically secured with strong encryption (e.g., VPN, TLS/HTTPS, SFTP) and robust authentication (e.g., mTLS, OAuth 2.0).",
        "check": "Is communication with the outsourcing provider encrypted? Is strong authentication enforced? Is the connection protected by a VPN or IP filtering?",
        "asvs": "OWASP Application Security Verification Standard (ASVS) V13 (Communications Security)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Third_Party_Security_Cheat_Sheet.html",
        "detectionLogic": "This rule checks for communication links to external entities designated as outsourcing providers.",
        "riskAssessment": "The impact is determined by the sensitivity (CIA ratings) of the data assets transferred over the communication link. A link carrying 'Strictly Confidential' data will have a 'Very High' impact.",
        "falsePositives": "This risk may be flagged if the model does not fully capture all compensating controls (e.g., application-layer encryption within a technically unencrypted channel).",
        "cwe": "319 // CWE-319: Cleartext Transmission of Sensitive Information",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "81_sec5.ts",
        "bsiCode": "OPS.3.2",
        "id": "critical-dependency-on-outsourcer-subcontractor",
        "title": "Critical Dependency on Outsourcer's Subcontractors",
        "description": "If an outsourcing provider delegates activities to subcontractors, there is a risk that these subcontractors may exploit their position to make demands or disregard contractual obligations. This creates a critical dependency on a third party to deliver the customer’s services. If the outsourcing provider is unable to compensate for disruption or failure by a subcontractor, the dependency becomes a hard dependency, putting the subcontractor in a favorable position. The subcontractor may then fail to maintain the contractually agreed quality and level of information security.",
        "impact": "This dependency can undermine the outsourcing relationship. For the direct customer (the modeled system), it may lead to service degradation or failure. For the outsourcing provider, it can result in legal and financial consequences, as well as reputational damage, further affecting service stability.",
        "action": "Manage and Mitigate Subcontractor Risks in Outsourcing Agreements",
        "mitigation": "Ensure that outsourcing contracts explicitly address the use of subcontractors. The agreement should grant rights to audit or assess subcontractors, or require the primary provider to enforce equivalent security standards on them. The primary provider must have a documented and tested business continuity plan to handle subcontractor failures. For critical services, consider contractual requirements for the provider to have redundant subcontractors or an in-house fallback solution. In the model, if a redundant setup exists, mark the corresponding technical asset as `redundant: true`.",
        "check": "Does the outsourcing agreement cover the use of subcontractors? Are there defined security requirements for subcontractors? Does the provider have a contingency plan for subcontractor failure? Is the provided service architected to be redundant?",
        "asvs": "BSI IT-Grundschutz: OPS.3.2 Anbieten von Outsourcing. This also relates to general supply chain security principles, such as those covered in NIST SP 800-161 (Supply Chain Risk Management) and OWASP Top 10 A06:2021 – Vulnerable and Outdated Components.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Outsourcing_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule triggers for technical assets of type 'external-entity' that are marked with the `@Outsourcing:has-subcontractors` tag but are not marked as redundant (`redundant: false`). The risk is elevated for services that handle data with high availability or integrity requirements.",
        "riskAssessment": "The likelihood of exploitation is considered 'Likely' for any non-redundant dependency on a service using subcontractors, as single points of failure in a supply chain are inherently risky. The impact is derived from the availability and integrity rating of the external service itself, as its failure would directly affect the system's core functions.",
        "falsePositives": "This risk might be a false positive if robust contractual controls, provider-side contingency plans, and subcontractor vetting processes are in place that adequately mitigate the risk of a single point of failure, even if the service is technically redundant.",
        "cwe": "1104",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "81_sec6.ts",
        "bsiCode": "OPS.3.2",
        "id": "improper-directory-service-config-for-outsourcing",
        "title": "Improper Directory Service Configuration for External Partners (BSI style)",
        "description": "An improperly or insufficiently configured central directory service—especially in scenarios involving external partners (e.g., outsourcing customers)—can result in users receiving excessive privileges. This can enable unauthorized access to sensitive or personal data belonging to the service provider or other customers, violating the principles of least privilege and tenant separation.",
        "impact": "If excessive permissions are granted or exploited, the integrity and confidentiality of data are at risk. This can lead to data breaches, contractual penalties, reputational damage to the provider and their customers, and failure to meet compliance requirements.",
        "action": "Harden directory service configuration and review access rights",
        "mitigation": "Implement a robust access control model based on the principle of least privilege. External partner access should be strictly segregated, ideally in a separate directory instance, domain, or organizational unit (OU). Regularly audit and review all user permissions, especially for external accounts. Enforce strong authentication (e.g., client certificates, MFA) for all administrative and remote access to the directory service. Log and monitor all access attempts and permission changes.",
        "check": "Are external partner accounts isolated from internal and other customer accounts? Are permissions for external users strictly limited to what is necessary? Is there a regular access review process? Is access to the directory service itself properly secured and monitored?",
        "asvs": "ASVS V4: Access Control",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for central directory services (such as LDAP servers or identity providers) that are configured for multi-tenancy or explicitly tagged for external partner access. The risk is identified when such a service receives communication from an external source (across a network trust boundary), indicating it is being used as described by the BSI.",
        "riskAssessment": "The likelihood is high if a directory service is multi-tenant and accessed by external parties, as misconfigurations are common and impactful in such complex setups. The impact is directly related to the sensitivity of the data assets managed by or accessible via the directory service. A breach of a directory service managing 'Strictly Confidential' data can have a very high impact.",
        "falsePositives": "The model might flag a correctly configured and hardened multi-tenant directory service. Consider this a false positive only if a thorough review confirms that strong tenant separation, least-privilege access controls, and regular audits are effectively in place.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "81_sec7.ts",
        "bsiCode": "OPS.3.2",
        "id": "insufficient-tenant-separation-in-outsourcing",
        "title": "Insufficient Tenant Separation in Outsourcing Environments (BSI APP.6.A9)",
        "description": "Outsourcing providers typically serve multiple customers (tenants) using the same shared resources like IT systems, networks, or personnel.",
        "impact": "This constitutes a direct breach of confidentiality for the affected tenant's data. The situation is particularly problematic when tenants are competitors.",
        "action": "Implement and Enforce Strict Tenant Isolation",
        "mitigation": "Ensure strict logical and/or physical separation of tenant data and processes on all shared resources.",
        "check": "Are multi-tenant assets explicitly designed with tenant separation in mind? Are there dedicated security controls to prevent cross-tenant access? Have penetration tests been conducted to validate tenant isolation? How is provider administrative access to tenant data controlled and audited?",
        "asvs": "BSI IT-Grundschutz APP.6.A9 (Separation of Clients)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_6_Outsourcing_and_cloud_services_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset marked as `multi-tenant` that has not been explicitly tagged as `tenant-isolation-verified`.",
        "riskAssessment": "The likelihood is considered high for any multi-tenant system that processes sensitive data without explicitly defined and validated isolation controls, especially if it involves custom-developed parts.",
        "falsePositives": "The model may not capture all specific isolation controls implemented (e.g., fine-grained application-level logic).",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "81_sec8.ts",
        "bsiCode": "OPS.3.2",
        "id": "inadequate-control-of-subcontractors-bsi-der.1",
        "title": "Inadequate Control of Subcontractors (BSI DER.1)",
        "description": "Outsourcing providers may subcontract parts or all of the outsourced services to other sub-service providers.",
        "impact": "If a subcontractor fails to meet security standards, it can lead to the compromise of confidentiality, integrity, or availability of the outsourced processes and data.",
        "action": "Enhance Vendor Due Diligence and Contractual Obligations for Subcontracting",
        "mitigation": "Ensure that contracts with outsourcing providers explicitly address subcontracting. The contract should require the provider to:",
        "check": "Does the contract with the external provider explicitly cover subcontracting? Are security requirements contractually passed down to all subcontractors?",
        "asvs": "BSI IT-Grundschutz DER.1.A5 (Checking the information security of the outsourcing service provider) and DER.1.A6 (Monitoring and reviewing the outsourcing service provider's services).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Outsourcing_edition_2023.pdf?__blob=publicationFile&v=2 (BSI DER.1)",
        "detectionLogic": "This risk is triggered for any 'External Entity' technical asset tagged as an external service provider ('@Role:ExternalServiceProvider').",
        "riskAssessment": "The likelihood of this risk materializing is higher for services where multi-level subcontracting is common (e.g., large cloud platforms, specialized processing services).",
        "falsePositives": "This risk can be considered a false positive or mitigated if the contract with the vendor explicitly forbids subcontracting, or if a thorough, successful, and recent audit of the subcontractor's security posture has been performed and documented.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "81_sec9.ts",
        "bsiCode": "OPS.3.2",
        "id": "inadequate-outsourcing-termination-plan",
        "title": "Inadequate Outsourcing Termination/Offboarding Plan",
        "description": "Inadequate regulations for the end of an outsourcing relationship can lead to hardware and data not being properly returned, transferred, or deleted.",
        "impact": "If there is no secure and comprehensive offboarding plan, sensitive data may be lost, stolen, or exposed.",
        "action": "Establish a Formal Offboarding and Termination Plan",
        "mitigation": "Define and contractually agree upon a detailed offboarding and termination plan with the outsourcing provider.",
        "check": "Is there a written, contractually binding termination clause for every outsourcing relationship? Does this clause detail the procedures for data return, transfer, and deletion?",
        "asvs": "BSI IT-Grundschutz CON.8.A23 (Planning the termination of the service)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Outsourcing_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for any 'External-Entity' technical asset that processes or stores data but is not tagged as having a contractually secured offboarding plan.",
        "riskAssessment": "The impact is rated based on the highest confidentiality of the data stored or processed by the external entity, as well as the highest integrity and availability requirements.",
        "falsePositives": "A plan might exist organizationally, but the corresponding technical asset in the model has not been tagged accordingly.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "ORP.1": [
      {
        "file": "82_sec1.ts",
        "bsiCode": "ORP.1",
        "id": "inadequate-or-missing-security-regulations",
        "title": "Inadequate or Missing Security Regulations (based on BSI)",
        "description": "Missing, outdated, impractical, or incomprehensible organizational regulations can lead to significant security gaps.",
        "impact": "The absence of effective regulations for critical assets or sensitive data can result in security incidents,",
        "action": "Establish and Maintain an Information Security Management System (ISMS)",
        "mitigation": "Define, document, and regularly review clear, practical, and understandable security regulations for all critical areas of information processing.",
        "check": "Is there a documented ISMS in place? Are key security regulations (e.g., for incident response, data handling) defined, up-to-date, and accessible? Are these regulations reviewed periodically for practicality and effectiveness?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.2 (ISMS). Establishing an Information Security Management System is the primary way to ensure regulations are created, maintained, and effective.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_ISMS_organisation_and_personnel_edition_2022.pdf?__blob=publicationFile (BSI ORP.2)",
        "detectionLogic": "This organizational risk is difficult to detect automatically. This rule raises awareness by flagging in-scope technical assets with high or critical protection requirements.",
        "riskAssessment": "The likelihood is difficult to determine from the model alone but can be assumed 'likely' for any organization without a mature ISMS.",
        "falsePositives": "This risk is raised based on asset criticality, not direct evidence of missing regulations. Its existence must be verified by reviewing the organization's policies, procedures, and ISMS documentation.",
        "cwe": "668",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "82_sec2.ts",
        "bsiCode": "ORP.1",
        "id": "non-compliance-with-regulations-bsi-orp1",
        "title": "Non-Compliance with Organisational Regulations (BSI ORP.1)",
        "description": "Experience shows that simply defining security rules is not sufficient. Clear communication to employees is essential so that all those affected can apply the requirements in day-to-day work.",
        "impact": "Non-compliance with organisational regulations can lead to serious incidents, including compromise of confidential information, loss of data integrity, and unauthorized disclosure. This may result in reputational damage, financial loss, and legal or regulatory penalties.",
        "action": "Implement, communicate, and enforce security policies",
        "mitigation": "Ensure all security regulations are clearly documented, easily accessible, and effectively communicated to all employees.",
        "check": "Is there a security awareness program in place? Are policies easily accessible to all employees? Are there technical controls to enforce critical rules?",
        "asvs": "BSI IT-Grundschutz ORP.1: Information security organisation; related items in ORP.2: Information security policies and regulations.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This organisational risk is raised for any technical asset that processes or stores data with high confidentiality or integrity requirements, or for web applications that might publish information.",
        "riskAssessment": "The likelihood is set to 'Likely' by default, as perfect adherence to all rules at all times is unrealistic in any organization.",
        "falsePositives": "This can be a false positive in an organization with a very strong and mature security culture in which policies are deeply ingrained and consistently enforced.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "82_sec3.ts",
        "bsiCode": "ORP.1",
        "id": "insufficient-operational-resources",
        "title": "Insufficient Operational Resources for Availability and Integrity (BSI CON.3)",
        "description": "If required operational resources are available in insufficient quantity, are not provided in a timely manner, or are not properly maintained, disruptions can occur.",
        "impact": "Failure to provide adequate and redundant resources can severely compromise the Integrity and Availability of data and systems.",
        "action": "Ensure redundancy and implement a robust backup and recovery strategy",
        "mitigation": "Critical technical assets should be designed and deployed in a redundant configuration (e.g., clustered, load-balanced across availability zones) to prevent single points of failure.",
        "check": "Review technical assets with high Availability or Integrity requirements. Are they marked as 'redundant' in the model?",
        "asvs": "BSI IT-Grundschutz CON.3 (Data Backup Concept) & INF.5 (Server Room)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule automatically triggers for any in-scope, non-redundant technical asset that has 'Important' or higher Availability or Integrity requirements.",
        "riskAssessment": "The impact of this risk is directly derived from the asset's specified Availability and Integrity ratings.",
        "falsePositives": "An asset might have redundancy or backup mechanisms not captured in the threat model (e.g., hardware-level RAID for a server, or a cloud provider's managed backup service that isn't modeled as a separate communication link).",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "82_sec4.ts",
        "bsiCode": "ORP.1",
        "id": "physical-access-by-external-personnel",
        "title": "Unauthorised Physical Access by External Personnel (BSI INF.6)",
        "description": "External persons (e.g., visitors, cleaning staff, or maintenance workers) might not be familiar with the institution's security policies.",
        "impact": "Successful exploitation of unsupervised physical access can directly compromise the Confidentiality (espionage, theft), Integrity (damage, unauthorised modification),",
        "action": "Implement physical access controls and supervision policies",
        "mitigation": "Enforce a strict policy for external personnel, including registration, identification (badges), and escort requirements in sensitive areas.",
        "check": "Are there formal procedures for managing visitors and external personnel? Are sensitive assets located in physically secured zones?",
        "asvs": "BSI IT-Grundschutz INF.6: Protection against unauthorised physical access. This also relates to classic BSI threats such as G 0.14 (External Staff) and G 0.15 (Visitors and external persons).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_6_Protection_against_unauthorised_physical_access_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is triggered for technical assets located in physically less secure areas, identified by 'physical-access' tags like 'public' or 'office'.",
        "riskAssessment": "The likelihood is determined by the level of physical access (e.g., a public lobby is riskier than a general office).",
        "falsePositives": "A model might flag an asset in an 'office' area as at risk, but supplementary controls (such as a locked office door or a PC case lock) might exist that are not captured in the model.",
        "cwe": "732",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "ORP.2": [
      {
        "file": "83_sec1.ts",
        "bsiCode": "ORP.2",
        "id": "personnel-unavailability-orp-4-a17",
        "title": "Personnel Unavailability (BSI ORP.4.A17)",
        "description": "The absence of key personnel (e.g., due to illness, vacation, or departure) can delay essential operational, maintenance, or security tasks.",
        "impact": "Missing necessary tasks due to personnel unavailability directly threatens the availability of dependent services and systems.",
        "action": "Establish and maintain substitution policies for key roles",
        "mitigation": "Define, document, and communicate clear substitution rules (Vertretungsregelungen) for all key personnel.",
        "check": "Are there documented substitution plans for all key roles associated with critical assets? Are these plans tested periodically?",
        "asvs": "BSI IT-Grundschutz Kompendium 2023, Baustein ORP.4: Personal, Anforderung A17: Regelung für die Vertretung bei Ausfall von Mitarbeitern.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Personal_Edition_2023.pdf?__blob=publicationFile (BSI ORP.4 - German)",
        "detectionLogic": "This risk is raised for non-redundant technical assets with high availability or integrity requirements that are associated with specific personnel roles (via `role:*` tags).",
        "riskAssessment": "The likelihood is considered likely, as substitution planning is a common organizational challenge.",
        "falsePositives": "The model cannot verify the existence or effectiveness of an organization's internal substitution policies.",
        "cwe": "1127",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "83_sec2.ts",
        "bsiCode": "ORP.2",
        "id": "incomplete-asset-inventory-inf1.a1",
        "title": "Incomplete or Outdated IT Asset Inventory (BSI INF.1.A1)",
        "description": "Without a complete, correct, and up-to-date inventory of all hardware and software components, it is impossible to manage them securely. Unmanaged or 'shadow IT' assets are not patched, monitored, or configured according to security policies. This creates significant, undiscovered security gaps that attackers can exploit.",
        "impact": "Unmanaged assets can be exploited by attackers to gain a persistent foothold in the network, bypass security controls, and access sensitive data. This can lead to data breaches, malware propagation, and disruption of critical business services. An incomplete inventory undermines the effectiveness of nearly all other technical and organizational security measures, including vulnerability management, monitoring, and incident response.",
        "action": "Establish and maintain a comprehensive asset inventory program",
        "mitigation": "Implement a robust asset management program that includes automated discovery tools to continuously scan networks for new or changed devices and software. Establish and enforce clear processes for the procurement, deployment, and decommissioning of all IT assets. The inventory should be centralized, regularly audited against physical and network reality, and integrated with other security systems such as vulnerability scanners, configuration management databases (CMDBs), and Security Information and Event Management (SIEM) systems. Suppress this warning by tagging a central asset or trust boundary with 'asset-inventory:mature'.",
        "check": "Is there a centralized, up-to-date asset inventory? Does it cover all environments (on-premises, cloud, OT, development, production)? Are automated discovery tools in place? Are there formal processes to handle the life cycle of all assets?",
        "asvs": "Derived from the BSI IT-Grundschutz-Kompendium 2023, Baustein INF.1: Allgemeine Infrastruktur-Komponenten, requirement INF.1.A1 'Bestandsaufnahme der Hardware- und Software-Komponenten' (Inventory of hardware and software components).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_1_General_infrastructure_components_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This is a foundational organizational risk concerning the completeness of the threat model itself. It is impossible for an automated tool to detect assets that are not defined in the model. Therefore, this risk is raised once for the entire system, anchored to the most critical asset, to serve as a reminder that 'shadow IT' may exist. The risk is suppressed if any component in the model is tagged with 'asset-inventory:mature', indicating that a robust external asset management process is in place.",
        "riskAssessment": "The likelihood is considered high by default in any organization without a mature, automated asset management program. The impact is determined by the highest confidentiality, integrity, and availability requirements of the assets within the model, as an unknown asset could provide a path to compromise any of them.",
        "falsePositives": "This risk describes a potential gap in the modeling process itself and is therefore difficult to classify as a false positive without external verification. The finding is valid if the organization cannot provide evidence of a comprehensive and mature asset management program that ensures the threat model accurately reflects reality.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "83_sec3.ts",
        "bsiCode": "ORP.2",
        "id": "careless-handling-of-credentials",
        "title": "Careless Handling of Credentials / Circumvention of Security Measures",
        "description": "It is often observed that, although institutions have many organizational and technical security procedures, these are undermined by careless employee behavior. A typical example is a sticky note on a monitor with access passwords written on it. Such behavior weakens established security controls and creates a direct path for unauthorized access.",
        "impact": "If credentials are handled carelessly (e.g., written down and left in plain sight or shared with others), accounts can be compromised. An attacker who obtains these credentials could impersonate the user, access sensitive data, modify critical information, or escalate privileges within the system. This directly threatens the Confidentiality, Integrity, and Availability (CIA) of associated assets and can result in significant data breaches and operational disruption.",
        "action": "Enforce secure credential-handling policies and user awareness training",
        "mitigation": "Implement and enforce clear policies that prohibit writing down or sharing passwords. Provide secure alternatives, such as approved password managers. Conduct regular, mandatory security awareness training that covers the risks of careless credential handling and social engineering attacks. Use technical controls to enforce password complexity and multi-factor authentication where appropriate.",
        "check": "Is there a written policy for credential management? Are users trained on it? Are password managers available and their use encouraged or mandated? Are technical controls (e.g., MFA, password complexity) in place for critical systems?",
        "asvs": "Based on BSI IT-Grundschutz Baustein ORP.2 (Personnel), especially Section 2.3: Careless handling of information (e.g., passwords on sticky notes).",
        "cheatSheet": "See BSI IT-Grundschutz, ORP.2 Personnel (Sorglosigkeit im Umgang mit Informationen).",
        "detectionLogic": "This organizational risk applies to any technical asset requiring user authentication. The rule triggers on assets explicitly marked as being used by a human (`used_as_client_by_human: true`), client-type technologies, or assets associated with a specific user role via `role:*` tags. The assumption is that if a human interacts with the asset, there is a risk of careless credential handling.",
        "riskAssessment": "Likelihood is high in environments without strong credential policies, training, and technical enforcement (such as MFA). The impact is proportional to the CIA rating of the technical asset and the data it processes or stores. Compromising credentials for a mission-critical database administrator is a very high impact event.",
        "falsePositives": "This risk is organizational and relies on assumptions about user behavior. A model cannot verify actual credential handling practices. Treat this risk as a prompt to verify that appropriate policies, training, and technical controls are in place.",
        "cwe": "522",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "83_sec4.ts",
        "bsiCode": "ORP.2",
        "id": "insufficiently-qualified-personnel-bsi",
        "title": "Insufficiently Qualified or Trained Personnel (BSI-based)",
        "description": "In daily IT operations, many disruptions and errors can occur. If responsible personnel are not sufficiently qualified, sensitized, and trained,",
        "impact": "Errors by insufficiently qualified personnel in configuring, operating, or developing systems can directly introduce vulnerabilities.",
        "action": "Establish and Maintain Personnel Qualification and Training Standards",
        "mitigation": "Define clear qualification and experience requirements for all roles responsible for operating, administering, and developing IT systems.",
        "check": "Are there formally defined qualification requirements for IT roles? Is there an ongoing training plan?",
        "asvs": "Based on BSI IT-Grundschutz Baustein ORP.2 (Personal), in particular ORP.2.A15 (Personnel qualification) and related organizational measures such as ORP.2.A1/A2 (onboarding/offboarding) and ORP.2.A4 (rules for external personnel), as applicable.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile (BSI ORP.2)",
        "detectionLogic": "This is an organizational risk that materializes at the technical level. The risk is raised for any in-scope technical asset that is associated with a human role (via `role:*` tags).",
        "riskAssessment": "The likelihood is considered higher for complex, custom-developed systems as they require more specialized knowledge.",
        "falsePositives": "This risk is an abstraction of an organizational issue. The model cannot know the actual qualifications of the personnel.",
        "cwe": "732",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "ORP.3": [
      {
        "file": "84_sec1.ts",
        "bsiCode": "ORP.3",
        "id": "insufficient-knowledge-of-regulations",
        "title": "Insufficient Knowledge of Information Security Regulations",
        "description": "Simply defining information security regulations does not ensure they will be followed.",
        "impact": "Non-adherence to security regulations due to insufficient knowledge can lead to the creation or exploitation of security vulnerabilities,",
        "action": "Implement and maintain security awareness and training programs",
        "mitigation": "Implement a comprehensive, ongoing security awareness and training program tailored to roles and responsibilities.",
        "check": "Is there an established, ongoing security awareness and training program? Are security regulations easy to access and communicated effectively?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information Security Organisation), requirement ORP.1.A6 (Awareness training on information security).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This is an organizational risk concerning personnel awareness. It applies conceptually to the entire system where personnel interaction occurs.",
        "riskAssessment": "The likelihood is considered 'Likely' by default, assuming a baseline need for continuous awareness efforts.",
        "falsePositives": "This risk is inherently organizational and difficult to verify solely from a technical model.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "84_sec2.ts",
        "bsiCode": "ORP.3",
        "id": "insufficient-security-awareness",
        "title": "Insufficient Security Awareness",
        "description": "Experience shows that it is not enough to simply mandate security measures. Employees must understand the meaning and purpose of these measures; otherwise, they may ignore them in day-to-day work. If employees are not adequately made aware of information security topics, the institution's security culture, objectives, and strategy can be jeopardized.",
        "impact": "If employees ignore security measures due to lack of awareness, it can lead to the introduction of new vulnerabilities or the breakdown of existing controls. This can directly compromise the confidentiality, integrity, or availability of business processes and information, potentially resulting in security incidents, data breaches, and non-compliance.",
        "action": "Establish and maintain a continuous security awareness and training program",
        "mitigation": "Implement a comprehensive, role-based security awareness and training program that is continuously reinforced. Ensure that all personnel understand the purpose and importance of the security measures relevant to their tasks. The program should be supported by management and integrated into the company culture. Regularly communicate security topics and verify understanding.",
        "check": "Is there an established, ongoing security awareness and training program? Are employees able to explain the importance of key security measures for their roles? Is there visible management support for a security-minded culture?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium 2023, ORP.3 Sensibilisierung und Schulung zur Informationssicherheit (Awareness and training on information security).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This is an organizational risk that applies to all parts of the system where human interaction occurs. This rule triggers for all in-scope technical assets that are not exclusively backend systems, as these are the components employees are most likely to interact with, directly or indirectly. A lack of awareness in these interactions can lead to security controls being bypassed.",
        "riskAssessment": "The likelihood is considered 'likely' by default, reflecting a baseline potential for human error or lack of awareness in any organization. The impact is calculated based on the sensitivity (CIA ratings) of the technical asset in question. If an employee ignores a security measure on a mission-critical system, the impact is much higher than on a system handling public data.",
        "falsePositives": "This risk is organizational in nature and cannot be fully confirmed or denied by a technical model alone. An organization might have an effective security awareness and training program in place. Treat this risk as a prompt to verify the status and effectiveness of awareness activities and the security culture.",
        "cwe": "284",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "84_sec3.ts",
        "bsiCode": "ORP.3",
        "id": "ineffective-security-awareness-program",
        "title": "Ineffective Security Awareness Program (aligned with BSI ORP.3)",
        "description": "Security awareness and training activities are not always as successful as needed.",
        "impact": "If an institution conducts inadequate awareness and training activities for its employees, aspects of information security can be endangered, which directly restricts the fulfillment of tasks.",
        "action": "Ensure Effectiveness of Security Awareness and Training Programs",
        "mitigation": "Ensure strong management support for security awareness initiatives. Define clear, measurable goals for training programs. Plan activities carefully, allocating sufficient resources (financial and personnel).",
        "check": "Is there clear evidence of management support for the security awareness program? Are the program's goals documented and measurable? Is there a formal process for monitoring the success and impact of the training? Is the program ongoing and allocated sufficient resources?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.3 (Sensibilisierung und Schulung zur Informationssicherheit), particularly requirements ORP.3.A4, ORP.3.A6, and ORP.3.A8. This risk represents the failure to effectively implement these controls.",
        "cheatSheet": "BSI IT-Grundschutz Kompendium, Baustein ORP.3 (Sensibilisierung und Schulung zur Informationssicherheit).",
        "detectionLogic": "This is an organizational risk concerning the effectiveness of training programs. It applies conceptually to the entire system where personnel interaction occurs.",
        "riskAssessment": "The likelihood is considered HIGH if there is no success monitoring for awareness programs or if it is known to be ineffective. The likelihood is MEDIUM if success monitoring is sporadic or lacks depth.",
        "falsePositives": "This risk is inherently organizational. A model cannot determine the actual quality or effectiveness of a training program.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "84_sec4.ts",
        "bsiCode": "ORP.3",
        "id": "insufficient-training-on-new-software",
        "title": "Insufficient training on new software and security features",
        "description": "Employees often do not use newly introduced security programs and features because they do not know how to operate them or consider it too time-consuming to learn.",
        "impact": "Misoperation or incorrect configuration of software due to insufficient training can neutralize intended security benefits. This can lead to unpatched vulnerabilities, bypassed security controls, and exposure of sensitive data.",
        "action": "Establish role-based training for new software and security features",
        "mitigation": "Develop and enforce a mandatory training program for all new software, especially for security-related tools and critical business applications.",
        "check": "Is there a formal process for training employees on new software and systems before access is granted?",
        "asvs": "Derived from BSI IT-Grundschutz concepts. This threat aligns with ORP.3 (Awareness and training), and supports the principles in ORP.1 (Information security organization) and ORP.2 (Personnel), which emphasize competence and awareness.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Personnel_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.2)",
        "detectionLogic": "This organizational risk is triggered for technical assets that are either custom-developed, act as security controls, or handle highly critical data.",
        "riskAssessment": "The likelihood of this risk is higher for custom-developed parts and dedicated security components due to their complexity and non-standard nature.",
        "falsePositives": "This risk may be a false positive if the organization has a robust and effective training program for all new software deployments, even if this is not captured in the threat model.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "84_sec5.ts",
        "bsiCode": "ORP.3",
        "id": "failure-to-recognize-and-report-incidents",
        "title": "Failure to Recognize and Report Security Incidents (BSI ORP.3)",
        "description": "In daily operations, many disruptions and errors can occur with IT and ICS components. Security incidents might not be identified as such by personnel, and cyber-attacks or attempted attacks could go unnoticed.",
        "impact": "Failure to recognize and report security incidents in a timely manner can allow small security gaps to grow into critical threats, compromising the Confidentiality, Integrity, and Availability of information.",
        "action": "Establish and maintain an awareness and training program for recognizing, reporting, and escalating suspected security incidents across all roles.",
        "mitigation": "Create clear, accessible reporting procedures and train all personnel (users, admins, leadership) to recognize potential signs of a security incident (e.g., unusual system behavior, unexpected errors, performance degradation, suspicious messages).",
        "check": "Are awareness and training measures (ORP.3) defined, current, and role-specific? Do personnel know indicators of incidents and how to report them promptly? Is there a designated point of contact and an exercised reporting path?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.3 (Sensibilisierung und Schulung zur Informationssicherheit), esp. 2.5 (Nicht erkannte Sicherheitsvorfälle) and requirements ORP.3.A1, ORP.3.A3, ORP.3.A6, ORP.3.A8, ORP.3.A9.",
        "cheatSheet": "https://www.bsi.bund.de/grundschutzkurs",
        "detectionLogic": "Organizational risk focused on awareness and processes. It conceptually applies wherever human interaction is key.",
        "riskAssessment": "Likelihood is elevated where awareness programs and reporting processes are missing or ineffective. Impact scales with the asset’s CIA needs and the sensitivity of data processed or stored.",
        "falsePositives": "This is largely organizational and cannot be proven by the technical model alone. An institution may already run an effective program.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "84_sec6.ts",
        "bsiCode": "ORP.3",
        "id": "negligence-and-human-error",
        "title": "Negligence or Human Error Leading to Information Disclosure (BSI G 0.14)",
        "description": "Various factors, such as carelessness or haste, can lead to situations where, for example, confidential documents are left openly visible at workstations or emails are sent without encryption.",
        "impact": "If sensitive information is handled carelessly, it can lead to unauthorized disclosure, modification, or loss of data. This compromises confidentiality and integrity, potentially leading to financial loss, reputational damage, and legal or regulatory penalties.",
        "action": "Implement Technical Safeguards and Enhance Security Awareness",
        "mitigation": "Combine technical controls with organizational measures. Implement a 'clean desk' policy and provide regular security awareness training focusing on secure data handling practices.",
        "check": "Are there enforced policies for a 'clean desk' and for screen locking? Is email and data-at-rest encryption mandated and technically enforced for sensitive information? Do employees receive regular, practical security awareness training?",
        "asvs": "Derived from the BSI IT-Grundschutz Catalogues, 'G 0.14 Carelessness or Lack of Knowledge'. The current BSI IT-Grundschutz Kompendium addresses this in several modules, including ORP.2 (Personnel) and DER.1.1 (General Client).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_1_General_client_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is identified on in-scope technical assets that are used by humans (e.g., workstations, mobile devices). It triggers under two conditions:",
        "riskAssessment": "The likelihood is considered 'likely' for any system with direct human interaction handling sensitive data, as human error is common. The impact directly relates to the confidentiality, integrity, and availability requirements of the data being handled. A breach of 'strictly confidential' data has a much higher impact than 'internal' data.",
        "falsePositives": "This risk can be considered a false positive if technical controls are in place that fully prevent the identified scenario (e.g., a DLP solution that blocks unencrypted emails with sensitive attachments, or mandatory full-disk encryption). Such controls must be documented and verified.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "84_sec7.ts",
        "bsiCode": "ORP.3",
        "id": "careless-handling-of-information",
        "title": "Careless Handling of Information by Employees",
        "description": "Many organizations define numerous organizational and technical security measures, but they can be undermined by careless employee behavior.",
        "impact": "Careless handling of information can render security measures ineffective, allowing unauthorized individuals to access sensitive data.",
        "action": "Enforce secure information-handling policies and awareness",
        "mitigation": "Implement and enforce clear policies for secure information handling, such as a 'Clean Desk and Clear Screen' policy.",
        "check": "Are there established policies for clean desk/screen and secure document handling? Are employees regularly trained on these policies? Are privacy screens deployed on mobile devices? Is there a secure process for disposing of sensitive physical media?",
        "asvs": "BSI IT-Grundschutz CON.1.A8 Clean Desk and Clear Screen",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_handling_of_information_and_assets_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for all technical assets that are either used directly by humans (where screens can be shoulder-surfed or credentials left visible) or are tagged as having a physical presence where information could be mishandled (like printers or paper archives).",
        "riskAssessment": "The likelihood of this risk is generally considered 'likely' due to the human factor. The impact is determined by the maximum confidentiality and integrity of the data processed or stored by the affected asset. If highly sensitive data is handled on a device used in an insecure manner, the impact can be very high.",
        "falsePositives": "This risk is raised based on the potential for careless behavior. An organization might have a strong security culture and effective training programs that mitigate this risk in practice, which cannot be determined from the technical model alone.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "84_sec8.ts",
        "bsiCode": "ORP.3",
        "id": "disregard-of-security-regulations-ism2.2",
        "title": "Disregard of Security Regulations (BSI ISM.2.2)",
        "description": "Employees might not adhere to information security requirements for various reasons, such as a weak security culture,",
        "impact": "Disregarding security regulations can lead to the bypass of security controls, compromising the Confidentiality, Integrity, and Availability (CIA) of assets.",
        "action": "Foster a Strong Security Culture and Review Security Policies for Practicality",
        "mitigation": "Management must actively promote a positive security culture and lead by example. Security policies should be practical, well-justified, and not overly burdensome to avoid rejection by employees.",
        "check": "Is there evidence of a strong, top-down security culture? Are security policies reviewed for practicality? Is there a feedback mechanism for employees regarding security controls? Are permissions allocated based on need-to-know and business justification?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.1 (Information security organisation), Requirement ORP.1.A1 (Management tasks for information security), which emphasizes the importance of management commitment and fostering a security culture.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_1_Information_security_organisation_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.1)",
        "detectionLogic": "This is an organizational risk related to employee behavior and security culture. It applies conceptually to the entire system.",
        "riskAssessment": "The likelihood is considered 'Likely' if there is reason to believe the security culture is weak or policies are impractical. The impact is directly related to the CIA requirements of the assets and data that could be affected by bypassed controls.",
        "falsePositives": "This is an organizational risk. Its presence cannot be confirmed from the technical model alone.",
        "cwe": "284",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "84_sec9.ts",
        "bsiCode": "ORP.3",
        "id": "social-engineering",
        "title": "Social Engineering",
        "description": "Social engineering is a method of gaining unauthorized access to information or IT systems by manipulating employees. Attackers often make direct contact via phone, email, or social networks, sometimes in multi-stage campaigns. By feigning insider knowledge (e.g., posing as a colleague, superior, or IT support) and appealing to the victim's helpfulness or urgency, attackers can trick employees into performing unauthorized actions.",
        "impact": "If employees are not sufficiently sensitized to this type of attack, they can be manipulated into disclosing internal information, infecting their IT systems with malware, or even transferring money to fraudulent accounts (e.g., 'CEO fraud'). This can lead to severe financial loss, data breaches (confidentiality), system compromise (integrity), service disruption (availability), and reputational damage.",
        "action": "Conduct regular, targeted security awareness training and implement technical controls",
        "mitigation": "Implement a robust security awareness program that specifically addresses social engineering tactics (phishing, pretexting, CEO fraud, etc.). Use simulated phishing campaigns to train and test employees. Enforce technical controls that limit the impact of a compromised user account, such as the principle of least privilege, multi-factor authentication (MFA), and strict, out-of-band validation for sensitive actions like financial transfers or password resets. Establish clear, well-known channels for employees to report suspected social engineering attempts without fear of reprisal.",
        "check": "Are employees regularly trained to identify social engineering attacks? Are technical controls like MFA enforced for all users? Is there a formal, out-of-band verification process for unusual or urgent requests? Is there a clear process for reporting suspicious activity?",
        "asvs": "ASVS V1.10.1: Security Awareness Training",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Social_Engineering_Cheat_Sheet.html",
        "detectionLogic": "This risk is generated for any technical asset that is directly used by a human (`used_as_client_by_human: true`), is a client-type technology (`browser`, `desktop`, etc.), or is tagged with a `role:*` tag. The assumption is that the human user of this asset is the primary target of social engineering.",
        "riskAssessment": "The likelihood is considered at least `Likely` due to the prevalence of social engineering attacks. It is elevated to `VeryLikely` for assets associated with high-privilege roles (e.g., `role:administrator`) or those handling highly sensitive data. The impact is derived from the CIA ratings of the technical asset and the data it processes. A successful attack against a user with access to 'Strictly Confidential' data or 'Mission Critical' systems results in a 'High' or 'VeryHigh' impact.",
        "falsePositives": "The model correctly identifies human interaction points as vulnerable. However, the actual risk level depends on the effectiveness of the organization's security awareness training and technical countermeasures, which may not be fully represented in the model. This risk should be validated against the organization's security posture.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.Spoofing"
      }
    ],
    "ORP.4": [
      {
        "file": "85_sec1.ts",
        "bsiCode": "ORP.4",
        "id": "inadequate-iam-processes",
        "title": "Inadequate Identity & Access Management (IAM) Processes",
        "description": "If Identity & Access Management (IAM) processes are poorly defined or inconsistently implemented,",
        "impact": "Weak IAM lifecycle controls enable unauthorized access, escalate blast radius after compromises, and drive regulatory non-compliance.",
        "action": "Institutionalize IAM: define, automate, and audit joiner-mover-leaver (JML) processes; enforce least privilege; and recertify access regularly.",
        "mitigation": "Establish a formal IAM lifecycle with clear ownership (joiner, mover, leaver).",
        "check": "Is there a documented, measured JML process? Are admin and service accounts inventoried and reviewed?",
        "asvs": "ASVS V4: Access Control (Identity & Session Management touchpoints)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "Detection flags technical assets where robust IAM is most critical, using three signals:",
        "riskAssessment": "Likelihood is set to Likely due to the prevalence of process gaps in JML and recertification.",
        "falsePositives": "Model-only evidence cannot prove process weakness. Organizations with mature IAM/JML may still trigger.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "85_sec2.ts",
        "bsiCode": "ORP.4",
        "id": "lack-of-centralized-account-management",
        "title": "Lack of Centralized Account Management",
        "description": "In many organizations, employees have accounts on various IT systems (e.g., production, test, and quality assurance systems)",
        "impact": "Failure to centrally manage and deprovision user accounts can lead to unauthorized access via orphaned accounts.",
        "action": "Implement Centralized Identity and Access Management (IAM)",
        "mitigation": "Establish a central identity provider (IdP) (e.g., Active Directory, LDAP, or a cloud-based IdP) as the single source of truth for user identities.",
        "check": "Is there a central identity provider in the model? Do applications that require user authentication use externalized authentication and link to the central IdP?",
        "asvs": "V4.3.2: Verify that there is a process for revoking access to all associated accounts, resources, and credentials in a timely manner when a user's access is no longer required.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Identity_and_Access_Management_Cheat_Sheet.html",
        "detectionLogic": "This risk is identified when multiple technical assets that typically require user authentication (like web applications or databases)",
        "riskAssessment": "The likelihood is considered high if multiple decentralized user stores exist, as this makes it very probable that account deprovisioning will be incomplete.",
        "falsePositives": "A system might use 'credentials' for a technical user or API key, not an end-user account.",
        "cwe": "404",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "85_sec3.ts",
        "bsiCode": "ORP.4",
        "id": "poorly-regulated-access-rights-orp4",
        "title": "Poorly Regulated Assignment of Access Rights (BSI ORP.4)",
        "description": "If the assignment of access rights is poorly regulated, it can lead to serious security vulnerabilities, for example through permission sprawl.",
        "impact": "Excessive or uncontrolled permissions can allow unauthorized users, or attackers who have compromised an account, to access, modify, or delete sensitive information,",
        "action": "Implement a Formal and Auditable Authorization Process",
        "mitigation": "Establish and enforce a formal process for managing access rights based on the principle of least privilege.",
        "check": "Is there a documented policy for access control? Are roles and responsibilities for granting access clearly defined?",
        "asvs": "Derived from the BSI IT-Grundschutz Compendium 2023, module ORP.4 Identity and Access Management; specifically requirements ORP.4.A5 (Granting of authorizations), ORP.4.A6 (Management of authorizations), and ORP.4.A15 (Regular review of access rights).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is identified when a communication link between two in-scope technical assets lacks a defined authorization mechanism (`authorization: none`).",
        "riskAssessment": "The impact is determined by the highest confidentiality and integrity of the data assets transferred over the link and the target asset itself. A link to a database storing 'Strictly Confidential' data without authorization has a very high impact.",
        "falsePositives": "A risk might be a false positive if authorization is handled by an out-of-scope component not present in the model or through an implicit mechanism not captured by the `authorization` attribute (e.g., a network firewall rule that allowlists all traffic from a trusted zone).",
        "cwe": "285",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "ORP.5": [
      {
        "file": "86_sec1.ts",
        "bsiCode": "ORP.5",
        "id": "'violation-of-legal-and-contractual-requirements'",
        "title": "Violation of Legal and Contractual Requirements (BSI ORP.5; see also ORP.2 / ORP.3)",
        "description": "If information security is implemented incorrectly or inadequately, organizations may violate legal regulations or contractual agreements. This is especially relevant when using external services, such as cloud providers, which operate in international environments with complex and different legal frameworks (e.g., for data protection, liability, or government access). A failure to perform adequate due diligence, sometimes driven by a focus on low costs, can lead to unintentional but severe compliance violations.",
        "impact": "Violating legal or contractual requirements can lead to significant financial penalties, reputational damage, and loss of customer trust. It may also result in the forced suspension of business processes or compromise the confidentiality, integrity, and availability of data assets hosted with non-compliant providers.",
        "action": "Implement a due-diligence and compliance management process for all external services",
        "mitigation": "Establish and enforce a formal process for evaluating and approving all external services, especially cloud providers. This process must include a thorough assessment of all applicable legal, regulatory, and contractual requirements. Involve legal, data protection, and information security officers in the review. Ensure that contracts include clear clauses regarding data handling, security measures, liability, jurisdiction, and audit rights. Maintain an inventory of all external services and the legal frameworks that apply to them.",
        "check": "Is there a documented process for vetting external suppliers for legal and security compliance? Are legal and data protection experts part of the approval workflow? Are cloud service contracts reviewed for specific compliance and security clauses before signing? Is there an up-to-date inventory of applicable laws and regulations?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.5 (Compliance Management – Requirements Management); see also ORP.2 (Compliance) and ORP.3 (Information security in supplier relationships).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_2_Compliance_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any technical asset located within a trust boundary of type \"Network Cloud Provider\" or \"Network Cloud Security Group\". The use of public cloud infrastructure inherently introduces risks related to jurisdiction and cross-border data flows, which must be carefully managed to ensure compliance.",
        "riskAssessment": "Impact is determined by the sensitivity (CIA ratings) of the data processed or stored by the cloud-based asset. Likelihood increases for assets handling sensitive data, as complexity and the potential for oversight in legal due diligence are higher. A cost-only focus without adequate compliance checks, as described in the source context, is considered a plausible scenario.",
        "falsePositives": "This risk may be a false positive if the organization has already performed a thorough legal and compliance assessment for the specific cloud service and documented that all requirements are met. The risk serves as a prompt to confirm that due diligence has been completed.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "86_sec2.ts",
        "bsiCode": "ORP.5",
        "id": "improper-handling-of-information-by-employees",
        "title": "Improper Handling of Information by Employees (BSI ORP.5)",
        "description": "Due to improper behavior by employees, sensitive information can be disclosed without authorization.",
        "impact": "This can lead to serious breaches of confidentiality, compromising sensitive business data, personal information (potential GDPR violations), or trade secrets.",
        "action": "Establish clear policies and enforce separation of duties / dual control",
        "mitigation": "Define and enforce clear, practical policies for handling sensitive information in all forms (digital, verbal, written). Implement the 'four-eyes principle' (dual control) for critical administrative actions.",
        "check": "Are there clear, accessible policies for handling sensitive information? Is there a formal, enforced process for granting access to sensitive user data (such as emails)? Is the four-eyes principle applied to critical administrative tasks?",
        "asvs": "Aligned with BSI IT-Grundschutz, module ORP.5 Compliance Management (Requirements Management), e.g., ORP.5.A1 (Identification of framework conditions), ORP.5.A2 (Observance of framework conditions), and ORP.5.A8 (Regular reviews of the compliance management system).",
        "cheatSheet": "https://www.bsi.bund.de/",
        "detectionLogic": "This risk is raised when a technical asset representing a privileged role (e.g., 'role:administrator') has a communication link to a data store (such as a mail server, database, or file server) that contains highly confidential data.",
        "riskAssessment": "The likelihood is considered 'likely' because bypassing formal procedures ('auf dem kleinen Dienstweg') is a common organizational weakness.",
        "falsePositives": "The model identifies the technical capability for misuse based on access paths. It cannot verify the existence or effectiveness of external procedural controls such as a mandatory ticketing system or a formal 'four-eyes' approval process.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "86_sec3.ts",
        "bsiCode": "ORP.5",
        "id": "social-engineering-pretexting-bsi-con1",
        "title": "Social Engineering via Pretexting (BSI CON.1)",
        "description": "In personal conversations, on the phone, or via email, many employees are willing to disclose far more information than they would in writing or in a larger group. In addition, the identity of communication partners is often not questioned, as this is perceived as impolite. Likewise, authorizations are frequently not verified sufficiently but are implicitly derived from the asserted role. For example, an employee may receive an email from an alleged acquaintance of their manager requesting the quick transfer of an outstanding amount. Or a stranger in work clothes with a tool case gains access to the data center after mentioning something about 'water pipes'.",
        "impact": "An attacker could trick an employee into performing unauthorized actions, such as making fraudulent financial transfers, disclosing sensitive information (credentials, customer data), or granting unauthorized physical or logical access. This can lead to significant financial loss, data breaches, system compromise, and reputational damage.",
        "action": "Establish Strict Verification Procedures and Security Awareness Training",
        "mitigation": "Implement and enforce strict, non-bypassable verification procedures for all sensitive requests (e.g., financial transfers, password resets, access grants), requiring out-of-band confirmation (such as a phone call to a known number). Provide regular, mandatory security awareness training for all employees that focuses on recognizing social engineering tactics like pretexting, phishing, and CEO fraud. Foster a security culture in which questioning unusual or urgent requests is encouraged and rewarded, not considered impolite or obstructive.",
        "check": "Are there formal, multi-channel verification processes for sensitive requests? Does security awareness training cover pretexting, phishing, and CEO fraud? Are employees aware of and following these procedures? Are technical controls in place to flag suspicious external emails (e.g., banners)?",
        "asvs": "BSI IT-Grundschutz CON.1: Social Engineering and Phishing",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_Social_Engineering_and_phishing_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This organizational risk is triggered for any in-scope technical asset that is a high-value target, because human operators are the primary attack vector. The risk is raised for assets with high confidentiality (>= 'confidential'), integrity (>= 'critical'), or availability (>= 'critical'), as these are attractive targets for attackers manipulating employees.",
        "riskAssessment": "The likelihood is considered 'very likely' by default due to the prevalence and effectiveness of social engineering. The impact is calculated based on the maximum CIA rating of the targeted technical asset and the data it processes or stores. For example, tricking an administrator of a mission-critical database has a 'very high' impact.",
        "falsePositives": "The technical model can only indicate where a social engineering attack would be damaging; it cannot assess the effectiveness of an organization's security awareness program or its internal verification procedures. Treat this risk as a starting point for a manual review of related human processes and controls.",
        "cwe": "290",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "86_sec4.ts",
        "bsiCode": "ORP.5",
        "id": "unintentional-information-disclosure",
        "title": "Unintentional Information Disclosure (per BSI description)",
        "description": "During information transfer, there is a risk that unintended additional data is disclosed along with the intended content.",
        "impact": "The disclosure of unintended or confidential information can lead to severe breaches of confidentiality, legal and regulatory violations (e.g., GDPR),",
        "action": "Implement Data Loss Prevention (DLP) measures and strict data-handling/sanitization procedures.",
        "mitigation": "Ensure all data transmissions contain only the explicitly intended information. Implement controls to prevent sending data to incorrect recipients.",
        "check": "Are there automated checks (such as DLP or content filters) on outbound data streams? Is data sanitized before being sent over communication links?",
        "asvs": "Derived from BSI IT-Grundschutz, module CON.1 (General data protection), in particular requirement CON.1.A17 (Rules for transferring information).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_data_protection_edition_2023.pdf?__blob=publicationFile (BSI CON.1)",
        "detectionLogic": "This risk is identified on communication links that transfer sensitive data.",
        "riskAssessment": "The likelihood increases if the target is external or the communication crosses a trust boundary, especially if the source component is custom-developed.",
        "falsePositives": "False positives can occur if the model does not fully represent the data sanitization or filtering logic (e.g., use of DTOs) that happens within the source asset before transmission.",
        "cwe": "200",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "SYS.1.1": [
      {
        "file": "87_sec2.ts",
        "bsiCode": "SYS.1.1",
        "id": "configuration-drift-due-to-inadequate-knowledge",
        "title": "Configuration Drift from Insufficient Knowledge of OS Changes (BSI SYS.1.1)",
        "description": "New versions of server operating systems regularly introduce new features and modify existing ones, including parameters and default settings.",
        "impact": "Configuration drift can lead to undocumented and untested security weaknesses, inconsistent application of security policies, and an overall degradation of the security posture. This can result in unauthorized access, privilege escalation, or service disruption, compromising the confidentiality, integrity, and availability of affected servers and the data they handle.",
        "action": "Implement centralized configuration management and continuous training",
        "mitigation": "Establish and enforce security baselines for all server operating systems using a centralized configuration management system (e.g., Ansible, Puppet, Chef, SaltStack, or GPOs).",
        "check": "Is a centralized configuration management tool in use? Are security baselines for server operating systems defined, documented, and enforced? Are regular audits performed to detect configuration drift? Do administrators receive regular training on deployed OS versions?",
        "asvs": "BSI IT-Grundschutz SYS.1.1 General Server — especially A11 (Server security policy), A16 (Secure installation and baseline configuration), A23 (System monitoring), and A39 (Central management of security policies).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_1_General_server_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk is raised for all in-scope technical assets that are identified as server-like technologies (e.g., web servers, application servers, databases, backend services). The risk is inherent to manually managed or inconsistently managed environments.",
        "riskAssessment": "The likelihood is considered 'Likely' as manual configuration and lack of continuous training are common operational challenges. The impact is determined by the CIA requirements of the server asset itself and the data it processes or stores. Servers handling critical or highly sensitive data will have a higher impact rating.",
        "falsePositives": "This risk may be a false positive if a mature, automated configuration management system and a robust training program are in place, even if not explicitly modeled. The risk serves as a strong recommendation to verify these operational processes.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "87_sec3.ts",
        "bsiCode": "SYS.1.1",
        "id": "regular-work-with-admin-privileges-bsi-ops115-a6",
        "title": "Regular Work with Administrative Privileges (BSI OPS.1.1.5 A6)",
        "description": "Performing regular user tasks (e.g., email, web browsing) with administrative privileges—especially on server systems—poses a significant security risk because it violates the principle of least privilege. When a user is logged in with elevated rights, any malicious code they encounter (via phishing, malicious websites, etc.) also runs with those same elevated rights. This practice dramatically increases the attack surface for compromising the asset and the entire network.",
        "impact": "If an administrative account used for daily tasks is compromised, an attacker gains extensive privileges on the server and potentially other connected systems. This can lead to complete system takeover, data theft or destruction, and lateral movement across the network using techniques like Pass-the-Hash. Abuse of these far-reaching privileges by legitimate administrators acting maliciously is also a significant threat scenario.",
        "action": "Enforce Strict Separation of User and Administrative Accounts",
        "mitigation": "Strictly enforce the principle of least privilege. Administrators must use a standard, non-privileged user account for all regular tasks. A separate, dedicated administrative account must be used only for performing administrative tasks. This administrative access should be further protected by multi-factor authentication and session monitoring (e.g., via a Privileged Access Management (PAM) solution). Server systems should be hardened to prevent standard user activities like web browsing.",
        "check": "Are administrative and standard user accounts strictly separated? Is there a policy preventing the use of administrative accounts for non-administrative tasks? Is the `usedAsClientByHuman` flag in the model set to `true` on any server-like technical assets? This flag indicates a potential violation.",
        "asvs": "BSI IT-Grundschutz / BSI 200-2, Baustein OPS.1.1.5 Identity and Access Management, Requirement A6: Restrictive assignment of authorizations (Least-Privilege Principle).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_5_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is detected for any non-client technical asset (e.g., servers, backends, databases) that has the `usedAsClientByHuman` property set to `true`. This property indicates that a human is using a server-like component for interactive tasks, which strongly indicates this antipattern.",
        "riskAssessment": "The likelihood is considered high if the condition is met, as this creates a direct and well-known attack vector. The impact is derived from the CIA rating of the affected technical asset. A compromise of an administrative session on a mission-critical asset will have a very high impact.",
        "falsePositives": "A false positive might occur if a system is legitimately a server but also has a dedicated, sandboxed client interface for a specific, justified purpose. In such cases, the risk should be accepted with justification or the model updated to better reflect the architecture (e.g., by splitting the asset into a server and a client component).",
        "cwe": "250",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "87_sec4.ts",
        "bsiCode": "SYS.1.1",
        "id": "data-loss-on-servers",
        "title": "Data Loss on Servers (BSI SYS.1.1)",
        "description": "The loss of data on servers can have significant consequences for business processes and the entire organization.",
        "impact": "If institutionally relevant information is destroyed or falsified, business processes can be delayed or completely halted.",
        "action": "Implement a robust data backup and recovery strategy and/or a high-availability architecture",
        "mitigation": "To mitigate the risk of data loss, implement a comprehensive data backup and recovery plan. This should include regular, automated backups of all critical data.",
        "check": "Are regular data backups performed for all critical server systems? Is the data recovery process documented and tested periodically?",
        "asvs": "BSI IT-Grundschutz SYS.1.1 General Server; see availability and redundancy measures (e.g., SYS.1.1.A28).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_1_General_server_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for in-scope technical assets of type `datastore` (or technologies that typically store data) that are not marked as `redundant: true`.",
        "riskAssessment": "The impact of data loss is directly proportional to the `availability` and `integrity` ratings of the technical asset. A `mission-critical` asset will result in a very high impact.",
        "falsePositives": "A risk might be flagged for an asset that has an out-of-band backup solution not captured in the model.",
        "cwe": "755",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "87_sec5.ts",
        "bsiCode": "SYS.1.1",
        "id": "denial-of-service-on-resources",
        "title": "Denial of Service against Data and System Resources (BSI)",
        "description": "A Denial of Service (DoS) attack targets the availability of data assets, systems, or functions to prevent authorized use.",
        "impact": "A successful DoS attack can render services or resources completely unusable, disrupting business operations. Due to the strong interdependence of modern IT systems, a resource shortage on one server can quickly cause cascading failures that affect dependent systems and services.",
        "action": "Implement multi-layer DoS protection and resource management",
        "mitigation": "Employ a combination of defenses:",
        "check": "Are DoS mitigation services (WAF, CDN protection) in place for internet-facing assets? Are critical services redundant? Is resource utilization actively monitored with alerting? Is rate limiting implemented on public-facing APIs?",
        "asvs": "ASVS V1.4.4 (Business Logic DoS), V12.5.1 (Resource Exhaustion)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html",
        "detectionLogic": "This risk is generated for in-scope technical assets exposed to potential DoS attacks. Prime candidates are internet-facing assets, especially those providing web applications or services. Non-redundant assets with high availability requirements are particularly vulnerable because their failure has significant impact.",
        "riskAssessment": "The likelihood of a DoS attack is very high for any internet-facing service. Impact correlates with the asset’s availability requirement and the data it handles. A non-redundant, mission-critical asset represents a very high-impact risk. Impact increases further if many other assets depend on the target (cascading failure).",
        "falsePositives": "This risk may be partially mitigated by external services (e.g., Cloudflare, Akamai, AWS Shield) that are not explicitly modeled. The rule raises the risk to ensure such protections are considered and verified.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "87_sec6.ts",
        "bsiCode": "SYS.1.1",
        "id": "unnecessary-services-on-server-sys1-1-a12",
        "title": "Unnecessary Applications and Services on Servers (BSI SYS.1.1.A12)",
        "description": "During OS installation or subsequent operation, applications and services are often installed that are not actually required for the asset’s purpose.",
        "impact": "Exploiting vulnerabilities in unpatched, unnecessary services can lead to system compromise, allowing attackers to tamper with data, disclose sensitive information, or use the server as a pivot point for further attacks. This compromises the confidentiality, integrity, and availability of the server and the data it processes.",
        "action": "Implement system hardening and configuration management",
        "mitigation": "Establish a hardening baseline for all servers that applies the principle of least functionality. Deactivate or uninstall all services, applications, and features that are not explicitly required for the server’s business purpose. Regularly audit servers against this baseline to identify and remove unnecessary software. Integrate this check into the server provisioning process. In the threat model, tag the asset with `Hardening:Standard` or `Hardening:Minimal` to indicate this.",
        "check": "Are server configurations based on a documented hardening standard? Is there a process to review and approve all installed software? Are servers regularly scanned for open ports and running services to identify deviations from the baseline?",
        "asvs": "BSI IT-Grundschutz-Kompendium: SYS.1.1 Allgemeiner Server, Requirement SYS.1.1.A12 (Deaktivierung nicht benötigter Dienste). This also closely relates to OWASP Top 10 A06:2021 - Vulnerable and Outdated Components.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_1_Allgemeiner_Server_Edition_2023.html",
        "detectionLogic": "This is an operational hygiene risk. The tool cannot definitively determine which services are “unnecessary.”",
        "riskAssessment": "The likelihood is high for any server asset without a documented hardening process in place. The impact is directly related to the CIA requirements of the server and the data it handles. A compromised server handling 'Strictly Confidential' data has a very high impact.",
        "falsePositives": "This risk can be considered a false positive if a strong, automated configuration management and hardening process is in place but has not been documented in the threat model by applying the appropriate `Hardening` tag to the asset.",
        "cwe": "1390",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "87_sec7.ts",
        "bsiCode": "SYS.1.1",
        "id": "server-overload-due-to-insufficient-capacity",
        "title": "Server Overload Due to Insufficient Capacity (BSI CON.8)",
        "description": "If servers are not properly sized, they may fail to meet the organization's performance or capacity requirements. Depending on the affected IT systems, negative effects can include temporary service unavailability or data loss. In complex IT landscapes, overloading a single server can also cause problems or outages in dependent systems. Triggers can include misconfigured applications consuming excessive resources, exceeding storage limits, handling too many concurrent requests, high CPU demand, or processing an excessive number of messages simultaneously.",
        "impact": "Non-redundant servers that fail due to overload directly jeopardize availability. If the failure leads to data corruption or loss, integrity is also affected. This can disrupt business processes, cause financial losses, and damage the organization's reputation.",
        "action": "Implement capacity management and monitoring",
        "mitigation": "Continuously monitor key performance indicators (KPIs) for servers and services, including CPU, memory, storage, and network utilization. Implement automated alerts to notify administrators when predefined thresholds are exceeded. Design critical systems for high availability and scalability using redundancy, such as load balancers, failover clusters, or cloud-based auto-scaling groups. Perform regular capacity planning based on historical trends and expected business growth to proactively provision resources.",
        "check": "Are performance and capacity metrics for critical systems monitored? Are alerting mechanisms in place for high-load scenarios? Are critical systems designed with redundancy or scalability in mind? Is there a documented capacity management process?",
        "asvs": "N/A (derived from BSI)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_8_Capacity_management_edition_2022.pdf?__blob=publicationFile (BSI CON.8: Capacity Management)",
        "detectionLogic": "This risk is identified for technical assets that are critical for business operations but lack redundancy. The risk is raised for non-redundant assets with high or mission-critical availability requirements. The likelihood increases if the asset is a central component with many incoming data flows, indicating high potential load and a significant impact on dependent systems.",
        "riskAssessment": "The impact of this risk correlates with the availability and integrity requirements of the affected asset and the data it handles. A non-redundant, mission-critical database poses a very high risk. The likelihood is higher for such systems, especially if they serve as a hub for many other components, as indicated by a high number of incoming communication links.",
        "falsePositives": "This risk might be a false positive if redundancy is achieved through mechanisms not modeled in Threagile, such as high-availability (HA) features of virtualization platforms or underlying hardware that are not explicitly detailed in the model.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "SYS.1.2.2": [
      {
        "file": "88_sec2.ts",
        "bsiCode": "SYS.1.2.2",
        "id": "uncontrolled-use-of-integrated-cloud-services",
        "title": "Uncontrolled Use of Integrated Cloud Services",
        "description": "Modern server operating systems (e.g., Windows Server), databases, and other backend applications often include built-in options to use public cloud services—for example, online backup, recovery key storage, or data synchronization. While this can improve availability, using such features without a defined governance framework introduces significant risks.",
        "impact": "If data is transferred to external cloud providers without appropriate controls (such as strong, centrally managed encryption), confidentiality can be compromised through unauthorized access by criminal or state actors. It also creates a strong dependency on the provider; service disruption or discontinuation can severely affect the availability of business processes.",
        "action": "Establish and enforce a cloud governance policy",
        "mitigation": "A clear policy must govern the use of any external cloud services, including those integrated into operating systems or applications. For sensitive data, such features should be disabled by default via configuration management or group policies. If their use is permitted, all data must be encrypted with organization-controlled keys before transfer to the cloud. A contingency and exit plan should be in place to mitigate vendor dependency and ensure business continuity if the cloud service becomes unavailable.",
        "check": "Is there a corporate policy for the use of integrated cloud services? Are these features disabled by default on sensitive systems? Is all data sent to external cloud storage strongly encrypted with organization-managed keys? Are contingency and exit plans defined for provider failure?",
        "asvs": "BSI IT-Grundschutz OPS.1.2.5 Cloud-Nutzung (Cloud usage)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_2_Cloud_usage_edition_2022.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule triggers for non-client, non-security-control technical assets that process or store data with at least restricted confidentiality or important availability. These assets are likely candidates for integrated cloud backup or storage features, and their use can pose a risk to sensitive data.",
        "riskAssessment": "Impact is determined by the highest confidentiality and availability rating of the data processed or stored by the asset. Likelihood is 'likely' if the asset resides within a public cloud environment and 'unlikely' otherwise, assuming on-premises systems are less prone to using public cloud integrations without explicit consideration. Severity is calculated based on this impact and likelihood.",
        "falsePositives": "This risk may be a false positive if the organization has enforced technical controls to disable integrated cloud features across systems, or if their use is governed and secured by a robust policy (e.g., via a Cloud Access Security Broker or client-side encryption with corporate keys). Manual verification of system configuration is required.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "88_sec3.ts",
        "bsiCode": "SYS.1.2.2",
        "id": "insecure-windows-server-2012-configuration",
        "title": "Insecure or Inconsistent Configuration of Windows Server 2012/R2",
        "description": "Windows Server 2012 and 2012 R2 introduced new security features and modified existing ones.",
        "impact": "Misconfigurations can create exploitable vulnerabilities, compromising the confidentiality, integrity, and availability of the server and the data it handles.",
        "action": "Implement hardening and centralized configuration management for Windows Server 2012/R2",
        "mitigation": "Establish and enforce a mandatory hardening baseline for all Windows Server 2012/R2 instances, based on security best practices (e.g., from CIS Benchmarks or Microsoft).",
        "check": "Are configurations for Windows Server 2012/R2 instances centrally managed and documented?",
        "asvs": "Derived from BSI IT-Grundschutz. Related to ASVS V14.2.1 (Component Hardening).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Hardening_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for all in-scope technical assets identified as Windows Server 2012 or Windows Server 2012 R2 via tags.",
        "riskAssessment": "The likelihood of exploitation is increased if the server is internet-facing or uses legacy protocols like unencrypted SMB or LDAP.",
        "falsePositives": "This risk might be a false positive if the identified server, despite its OS, is confirmed to be fully hardened, consistently managed via a central tool, and regularly audited. Manual verification of operational security practices is required to confirm mitigation.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "88_sec4.ts",
        "bsiCode": "SYS.1.2.2",
        "id": "gpo-misconfiguration",
        "title": "Risk of GPO Misconfiguration on Windows Systems",
        "description": "Group Policy Objects (GPOs) are a powerful mechanism for configuring security settings of Windows systems, particularly within a domain. However, due to the large number of options, an unsystematic approach can easily lead to contradictory or incompatible configurations, or entire security areas being overlooked. Misunderstood inheritance rules and filters can even cause GPOs to fail to apply at all, leaving systems in a default, potentially insecure state.",
        "impact": "Improper GPO management can lead to severe vulnerabilities on servers and connected clients, operational disruptions, and a general weakening of the security posture. Failure to apply intended security settings can compromise the confidentiality, integrity, and availability of the managed systems and the data they process.",
        "action": "Implement Systematic GPO Management and Review",
        "mitigation": "Adopt a structured approach to GPO management. Use security baselines (e.g., from Microsoft or CIS) as a foundation. All GPO changes should be documented, tested in a non-production environment, and reviewed before deployment. Regularly audit GPOs for conflicts, redundancies, and unexpected results using tools such as 'gpresult' or Microsoft Advanced Group Policy Management (AGPM). Restrict permissions to modify GPOs to authorized administrators.",
        "check": "Is there a documented process for creating, testing, and deploying GPOs? Are GPOs regularly reviewed against security baselines? Is an audit trail of GPO changes maintained? Are tools used to check for conflicts and whether settings are effectively applied?",
        "asvs": "This is a platform-level control. Its principle relates to ASVS V14.1 (Configuration), which requires security configuration to be defined, implemented, and maintained.",
        "cheatSheet": "https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-security-baselines",
        "detectionLogic": "This risk is raised for technical assets that are typically managed by GPOs in a Windows environment, such as LDAP servers (domain controllers), identity providers (AD FS), and file servers. The risk can also be triggered by explicitly tagging any asset with `@gpo-managed:true`.",
        "riskAssessment": "The likelihood is considered 'Likely' because GPO misconfiguration is common without a strict, formalized management process. The impact is determined by the criticality of the asset. A misconfigured domain controller (`LDAPServer`) has a systemic, high impact, while other servers' impact depends on their specific CIA rating.",
        "falsePositives": "This risk is flagged based on the asset's technology type, assuming it is managed by GPOs. The organization may have a robust GPO management process or may use alternative configuration management tools. Manual verification of the GPO management lifecycle is required to confirm or dismiss this risk.",
        "cwe": "732",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "88_sec5.ts",
        "bsiCode": "SYS.1.2.2",
        "id": "insufficient-server-hardening",
        "title": "Insufficient Hardening or Misconfiguration of the Server OS",
        "description": "Server operating systems like Windows Server offer numerous security features to protect the integrity of processed information. However, these features can themselves contain vulnerabilities or, more commonly, be inconsistently configured for convenience. Insufficient security hardening can allow unauthorized individuals to tamper with information and system processes, hide their tracks, or deploy malware to manipulate data remotely.",
        "impact": "Successful exploitation can lead to severe integrity loss of data and system processes. Attackers could alter critical business data, install backdoors, disrupt services (denial of service), and escalate privileges within the network. This can result in financial loss, reputational damage, and operational failure.",
        "action": "Implement and Enforce Secure Baseline Configurations (Hardening)",
        "mitigation": "Define, implement, and regularly audit a security baseline (hardening guide) for all server operating systems. This should include disabling unnecessary services and ports, enforcing strong access controls and logging, applying security patches promptly, and using configuration management tools to prevent configuration drift. Regularly use vulnerability scanners and integrity monitoring tools (e.g., a file integrity monitor) to detect deviations from the baseline and potential compromises.",
        "check": "Are there documented, version-controlled hardening guides for all server operating systems in use? Is there a process to ensure new systems are built according to these guides? Are systems regularly audited against the baseline? Is automated configuration management in place to enforce the secure state?",
        "asvs": "BSI IT-Grundschutz: SYS.1.1 (General Server), OWASP ASVS v4.0.3: 1.1.1 (Secure Configuration)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Hardening_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for technical assets representing server-side technologies that are common targets for misconfiguration (e.g., web servers, application servers, databases). The risk is higher for assets directly exposed to the internet or those handling highly critical or confidential data, as they are more attractive targets.",
        "riskAssessment": "The impact is determined by the integrity and confidentiality requirements of the asset itself and the data it handles. The likelihood is considered 'Likely' by default for susceptible technologies, as maintaining a secure configuration is a persistent operational challenge. The likelihood increases to 'Very Likely' for internet-facing assets, which are subject to constant automated scanning and attack attempts.",
        "falsePositives": "This risk might be a false positive if a robust, automated configuration management and hardening process (e.g., using Ansible, Puppet, or similar tools with audited playbooks) is in place, even if not explicitly modeled. This must be verified by reviewing operational security processes.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "88_sec6.ts",
        "bsiCode": "SYS.1.2.2",
        "id": "abuse-of-administrative-functions",
        "title": "Abuse of Administrative Functions",
        "description": "Routine work under standard permissions is now common practice. However, administrators still need to elevate privileges at certain times, creating opportunities for attackers to gain privileged access. Abuse of privileges by legitimate administrators is also a relevant threat scenario. Attackers can leverage compromised administrative credentials to move laterally within the network, for example by using Pass-the-Hash or similar techniques.",
        "impact": "Because administrative roles are highly privileged, compromise typically has significant impact, especially for domain administrators. This can result in the complete loss of confidentiality, integrity, and availability of all systems managed by that role, enabling attackers to exfiltrate data, destroy systems, or deploy ransomware across the infrastructure.",
        "action": "Enforce Least Privilege and Monitor Privileged Access",
        "mitigation": "Strictly implement the principle of least privilege. Use separate, dedicated accounts and hardened workstations (Privileged Access Workstations - PAWs) for administrative tasks. Enforce strong multi-factor authentication (MFA) for all administrative access. Log, monitor, and regularly audit all privileged activities. Employ Privileged Access Management (PAM) solutions to control, vault, and rotate credentials. Use modern credential protection mechanisms such as Windows Credential Guard to prevent credential theft attacks like Pass-the-Hash.",
        "check": "Are administrative tasks performed from dedicated, hardened systems? Is MFA enforced for all administrative access? Is all privileged activity logged and regularly reviewed? Are PAM solutions used to manage and secure administrative credentials?",
        "asvs": "V4.0.3-4.1.2: Least Privilege",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for technical assets that are managed by administrative roles. These roles are identified by tags such as `role:administrator`, `role:fachadministrator`, or the highly critical `role:domain-administrator`. The risk is particularly high for assets that represent identity stores or central management components (e.g., identity provider, LDAP server).",
        "riskAssessment": "The likelihood is considered 'Likely' because administrative accounts are high-value targets. The impact is directly related to the power of the administrative role and the criticality of the managed asset. For a `role:domain-administrator`, the impact is rated 'Very High' by default. For other administrative roles, the impact is derived from the highest CIA rating of the technical asset itself or the data it processes or stores.",
        "falsePositives": "The risk might be lower if strong compensating controls such as a mature PAM solution, comprehensive EDR/SIEM monitoring, and regular auditing are in place but not explicitly modeled. This requires manual verification of the organization's operational security practices.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "88_sec7.ts",
        "bsiCode": "SYS.1.2.2",
        "id": "insecure-remote-administration",
        "title": "Insecure Remote Administration (BSI-derived)",
        "description": "Servers such as Windows Server provide a variety of remote administration capabilities that can be misused.",
        "impact": "Successful exploitation allows an attacker to gain administrative control over the server, leading to a complete loss of confidentiality, integrity, and availability for the asset and its data.",
        "action": "Harden remote administration interfaces",
        "mitigation": "Secure all remote administration channels by enforcing the use of encrypted protocols (e.g., RDP with TLS, SSH, HTTPS-based management).",
        "check": "Are remote administration protocols (such as RDP, WinRM, or SSH) exposed to untrusted networks? Is strong authentication (e.g., MFA or client certificates) enforced on all administrative access points?",
        "asvs": "V14.2.1 (Secure Configuration), V14.4.4 (Restricted Remote Access)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any in-scope technical asset tagged with '@os:windows-server' that has an incoming communication link representing a potential remote administration channel with security weaknesses.",
        "riskAssessment": "The likelihood is high if an administrative port is exposed to the internet, especially with weak password-based authentication. The impact is determined by the business criticality (CIA) of the server asset itself. A compromise of a mission-critical server has a very high impact.",
        "falsePositives": "This risk might be a false positive if compensating controls exist outside the model, such as a separate, unmodeled Web Application Firewall (WAF), an Intrusion Prevention System (IPS), or an out-of-band management network that provides strong segregation not reflected in the diagram.",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "SYS.1.2.3": [
      {
        "file": "89_sec1.ts",
        "bsiCode": "SYS.1.2.3",
        "id": "'unmanaged-cloud-integration-in-os'",
        "title": "Unmanaged or Unapproved Integrated Cloud Features on Windows Server",
        "description": "Windows Server ships with built-in hooks to Microsoft cloud services (e.g., Azure Backup, online BitLocker key escrow, telemetry upload). If these integrations are used without policy, review, or explicit hardening, they can bypass established data handling and supplier controls.",
        "impact": "Unmanaged cloud integrations can leak sensitive information (e.g., credentials, recovery keys, crash dumps) and create hidden third-party dependencies. Termination or outage of the external service may break backup/restore or administrative workflows and degrade availability of business processes.",
        "action": "Govern OS-integrated cloud features via policy, tagging, and configuration baselines",
        "mitigation": "Mandate a corporate policy for OS-integrated cloud features. Enforce via Group Policy/Intune baselines to disable unapproved options by default. Allow only reviewed use cases and tag such assets as `@cloud-integration:managed`; tag hardened/disabled hosts as `@cloud-integration:disabled`. Monitor egress to public cloud endpoints and review telemetry/diagnostic settings (set minimum practical level). Perform risk assessment before enabling features like Azure Backup or online key escrow.",
        "check": "Verify a written policy exists, baseline settings are deployed, assets are consistently tagged (`managed` or `disabled`), and network monitoring alerts on unexpected cloud endpoints. Confirm that recovery keys and diagnostics are not sent to external tenants without approval.",
        "asvs": "ASVS V14.2.5 (Configuration: External Behavior), V1.14 (Secure Defaults)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Third_Party_Security_Cheat_Sheet.html",
        "detectionLogic": "Implementation detail: The rule flags any in-scope technical asset tagged `@os:windows-server` that is NOT also tagged with either `@cloud-integration:managed` or `@cloud-integration:disabled`. Missing explicit governance implies default OS behavior may enable cloud ties (backup, key escrow, telemetry), elevating data-exfiltration and supplier-lock risks.",
        "riskAssessment": "Likelihood: Likely (features tend to be enabled/usable out of the box and often overlooked during hardening). Impact scales with the asset’s Confidentiality and Availability requirements: servers processing Restricted/Confidential data or providing Important/Critical services face greater impact.",
        "falsePositives": "May be a false positive if network egress to relevant cloud services is centrally blocked or if the OS tag is incorrect. Also consider cases where governance exists but tags are missing; update tags rather than suppressing the rule.",
        "cwe": "200",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "89_sec2.ts",
        "bsiCode": "SYS.1.2.3",
        "id": "insecure-remote-administration-windows",
        "title": "Insecure Remote Administration of Windows Server (BSI SYS.1.2.3)",
        "description": "Windows Server provides several remote administration capabilities (e.g., RDP, WinRM) that can be misused if not properly secured.",
        "impact": "An attacker exploiting insecure remote access can gain extensive control over the server, compromising the confidentiality, integrity, and availability of its data and services.",
        "action": "Secure remote administration channels and authentication",
        "mitigation": "Ensure all remote administration protocols use strong, encrypted channels (e.g., via a secure VPN or an SSH tunnel). Enforce strong, multi-factor authentication (MFA) instead of relying solely on passwords.",
        "check": "Are all remote administration connections encrypted? Is strong authentication (MFA) enforced for all administrative access? Are access lists (IP filtering) in place for remote management interfaces? Are unnecessary remote services disabled?",
        "asvs": "BSI IT-Grundschutz SYS.1.2.3 Windows Server, Requirements A5 (Secure authentication and authorization) and A6 (Security for Remote Desktop access).",
        "cheatSheet": "BSI IT-Grundschutz Kompendium: SYS.1.2.3 Windows Server",
        "detectionLogic": "This risk is raised for technical assets tagged as `os:windows-server` that have incoming communication links using remote administration protocols (e.g., RDP or WinRM) with weak authentication (`none` or `credentials`).",
        "riskAssessment": "The likelihood of exploitation is HIGH, especially if weak authentication is combined with internet exposure. The impact is VERY HIGH if the server processes or stores high-value data (high CIA ratings) or is connected to other critical systems, as a compromise allows for widespread damage and potential lateral movement.",
        "falsePositives": "This risk can be a false positive if compensating controls exist outside the model, such as a mandatory corporate VPN with MFA that protects the entire network segment, which is not explicitly modeled on the communication link itself.",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "89_sec3.ts",
        "bsiCode": "SYS.1.2.3",
        "id": "uncontrolled-windows-telemetry",
        "title": "Uncontrolled Transmission of Diagnostic and Telemetry Data from Windows Server",
        "description": "By default, Windows Server sends diagnostic data to the manufacturer, Microsoft.",
        "impact": "If sensitive data (such as information from memory dumps or system event logs) is transmitted to Microsoft via telemetry services,",
        "action": "Harden Telemetry Service Configuration",
        "mitigation": "The telemetry and diagnostic data services on all Windows Server systems should be explicitly configured to a level that aligns with the organization's security and data protection policies.",
        "check": "Are all Windows Server assets configured to a minimal, policy-compliant telemetry level? Is there a Group Policy or other configuration management tool in place to enforce this setting?",
        "asvs": "BSI IT-Grundschutz SYS.1.2.3 Windows Server; related requirement: SYS.1.2.3.A3 Telemetry and usage data under Windows Server. Related threats include G 0.40 Eavesdropping and G 0.14 Misuse of administrative and maintenance functions.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_2_2_Windows_Server_2019_Edition_2021.html",
        "detectionLogic": "This rule triggers for any technical asset tagged with '@os:windows-server' that is not also tagged with '@telemetry:configured'.",
        "riskAssessment": "The likelihood is considered 'very likely' as telemetry is enabled by default on Windows Server. The impact is determined by the confidentiality of the data processed or stored by the server.",
        "falsePositives": "A false positive can occur if the telemetry settings have been hardened using a mechanism that is not reflected in the model's tags (e.g., an external configuration management system).",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "89_sec4.ts",
        "bsiCode": "SYS.1.2.3",
        "id": "forensic-investigation-hindered-by-vsm",
        "title": "Forensic investigation hindered by Virtual Secure Mode (VSM) (BSI-based)",
        "description": "Using Virtual Secure Mode (VSM) can significantly hinder or even prevent forensic investigations, for example during incident response. Processes protected by the Secure Kernel or Isolated User Mode (IUM)—such as Credential Guard—are no longer accessible for analysis. For instance, memory dumps of these protected processes cannot be examined due to cryptographic protections.",
        "impact": "If a security incident occurs on a system using VSM, it may be impossible to determine the root cause, the scope of the breach, or the attacker’s actions. This prevents effective remediation, accountability, and lessons learned, potentially allowing attackers to maintain persistence or repeat the attack. It directly degrades incident response capabilities.",
        "action": "Evaluate and document the trade-off between proactive hardening and reactive forensics",
        "mitigation": "Acknowledge the trade-off between the preventive security of VSM and the reactive needs of forensic analysis. If memory forensics are critical for compliance or operational security, consider disabling VSM/IUM features on systems where detailed incident analysis is required. Alternatively, ensure that other logging and monitoring mechanisms (e.g., EDR, advanced logging) unaffected by VSM can provide sufficient visibility for incident response. Document this decision in the system’s security concept and have it approved by the incident response team.",
        "check": "Does the system use Virtual Secure Mode (VSM), Credential Guard, or other IUM-based technologies? Has the incident response team approved this configuration and confirmed they have alternative, sufficient investigation methods?",
        "asvs": "Derived from BSI IT-Grundschutz DER.1 Incident Detection and Handling, specifically DER.1.A4 Performing a forensic analysis, which VSM can impede.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/DER_1_Incident_Detection_and_Handling_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Triggers on technical assets explicitly tagged with `@VSM-Enabled`, indicating they use technologies like Virtual Secure Mode or Credential Guard that impede memory analysis.",
        "riskAssessment": "The likelihood is based on the probability of a security incident occurring that requires deep forensic analysis. The impact is determined by the criticality (CIA rating) of the asset; the inability to investigate a compromise of a mission-critical asset is a high-impact event.",
        "falsePositives": "This risk is valid if VSM or a similar technology is enabled. A false positive might be claimed if the organization has formally accepted this risk or implemented compensating controls (e.g., extensive, immutable external logging) that make direct memory forensics unnecessary for their specific incident response procedures.",
        "cwe": "778",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "APP.3.2": [
      {
        "file": "8_sec1.ts",
        "bsiCode": "APP.3.2",
        "id": "uncontrolled-webserver-admin-access",
        "title": "Uncontrolled Administrative Access to a Web Server",
        "description": "If an attacker gains administrative access to a web server, they can deliver a manipulated website (defacement), publish false information, or exfiltrate data processed or stored by the server.",
        "impact": "A successful attack can lead to significant reputational damage if the website is defaced or used to spread misinformation.",
        "action": "Harden the web server and strictly control administrative access",
        "mitigation": "Implement the principle of least privilege for all server and application accounts. Administrative access (e.g., via SSH, RDP, or an admin panel) must be strictly controlled, logged, and monitored.",
        "check": "Are administrative interfaces exposed directly to the Internet? Is MFA enforced for all administrative access?",
        "asvs": "Based on BSI IT-Grundschutz concepts for securing web servers (APP.3.2 Webserver) and general servers (SYS.1.1). Aligns with OWASP ASVS V14.2 (Configuration) and V1.5 (Architecture, Design and Threat Modeling Requirements).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
        "detectionLogic": "This risk applies to all technical assets functioning as web servers, web applications, or application servers, as they are common targets for such attacks.",
        "riskAssessment": "The likelihood of exploitation is elevated for any Internet-facing web server due to constant automated scanning and targeted attacks.",
        "falsePositives": "This risk might be considered a false positive for web servers that are hosted in a highly restricted environment (e.g., an isolated network segment) with strong, layered access controls that are not fully described in the model.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "8_sec2.ts",
        "bsiCode": "APP.3.2",
        "id": "unauthorized-web-server-file-manipulation",
        "title": "Unauthorized Manipulation of Web Server Files (BSI APP.3.2)",
        "description": "During an attack, unauthorized persons could gain access to a web server and manipulate its files.",
        "impact": "Successful manipulation of web server files can lead to significant damage. Altering configuration could cause service outages (Availability).",
        "action": "Harden Web Server and Implement Integrity Monitoring",
        "mitigation": "Implement strong access controls and apply the principle of least privilege for all file and directory permissions on the server.",
        "check": "Are file and directory permissions on the web server properly restricted? Is a patch management process in place and followed?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.3.2 Webserver, focusing on protecting the integrity of web content and configurations.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_3_2_Web_applications_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is generated for all assets identified as web servers, web applications, or web services.",
        "riskAssessment": "The impact of this risk is determined by the integrity and availability requirements of the technical asset and the data it processes.",
        "falsePositives": "A risk might be considered a false positive if the identified 'web server' is only accessible within a highly restricted network segment with strong compensating controls,",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "8_sec3.ts",
        "bsiCode": "APP.3.2",
        "id": "denial-of-service-against-web-services-app4-t35",
        "title": "Denial-of-Service against Web Servers (BSI APP.3.2)",
        "description": "DoS attacks can specifically impair the availability of a web service, for example, by locking individual accounts through repeated failed login attempts.",
        "impact": "For many institutions, such a failure can quickly become business-critical, for example, for online shops.",
        "action": "Implement Anti-DoS/DDoS Measures",
        "mitigation": "Employ a multi-layered defense strategy. This includes using a Web Application Firewall (WAF) or a specialized anti-DDoS service provider to filter malicious traffic.",
        "check": "Is the asset protected by a WAF or an upstream anti-DDoS service? Are there rate limits on resource-intensive endpoints? Is the infrastructure designed to be scalable to handle traffic peaks?",
        "asvs": "BSI IT-Grundschutz-Kompendium: APP.3.2 Webserver (Denial of Service)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_Web_server_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to all internet-facing technical assets providing web-based services (e.g., Web Servers, Web Applications, REST/SOAP Services, Reverse Proxies).",
        "riskAssessment": "The likelihood is considered **very high** for any unprotected, internet-facing web service due to the prevalence of automated scanning and attack tools. The impact is directly related to the **Availability** rating of the asset and its data. A 'Mission-Critical' service will suffer a 'Very High' impact, while a less critical 'Operational' service will have a lower impact.",
        "falsePositives": "A risk might be incorrectly flagged if comprehensive anti-DoS measures are in place but are not modeled. This is common when protection is provided by an upstream infrastructure component (e.g., a cloud provider's standard DDoS protection) that is not explicitly shown as a WAF asset in the diagram.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "8_sec4.ts",
        "bsiCode": "APP.3.2",
        "id": "weak-or-outdated-cryptography-on-link",
        "title": "Weak or Outdated Cryptography on Communication Link",
        "description": "Many web servers still use outdated cryptographic methods like RC4 or SSL.",
        "impact": "If communication is not properly encrypted using strong, modern cryptographic standards, sensitive data can be disclosed to attackers (e.g., session cookies, credentials, personal data).",
        "action": "Enforce strong, modern encryption for all communication",
        "mitigation": "Ensure that all communication links, especially those crossing trust boundaries or involving sensitive data, use a strong, encrypted protocol (e.g., HTTPS, WSS, JDBC-encrypted, FTPS).",
        "check": "Review all communication links in the architecture. Is the protocol for each link an encrypted variant?",
        "asvs": "V9.1.1, V9.2.1",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule checks all communication links in the model. It triggers a risk if a communication link uses an unencrypted protocol",
        "riskAssessment": "The exploitation likelihood is determined by whether the unencrypted communication crosses a trust boundary and if either endpoint is exposed to the internet.",
        "falsePositives": "A risk might be a false positive if the link operates entirely within a physically secured, isolated network segment where interception is considered impossible,",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "8_sec5.ts",
        "bsiCode": "APP.3.2",
        "id": "violation-of-regulatory-requirements-for-web-content",
        "title": "Regulatory Non-Compliance for Web Content (BSI APP.3.2 · CON.3 · DER.1)",
        "description": "Publishing web content is subject to multiple legal requirements. In addition to telemedia and data protection laws (e.g., @DataType:PII), copyright and consumer-protection rules apply.",
        "impact": "Non-compliance may lead to fines, injunctions, takedown orders, litigation, and reputational damage.",
        "action": "Establish and enforce legal & regulatory compliance checks for all published web content and services.",
        "mitigation": "Introduce a documented pre-publish review including legal sign-off. Ensure an accurate, easily accessible imprint and privacy policy.",
        "check": "Is there a formal pre-publication legal review? Are imprint and privacy policy complete, up-to-date, and visible on every page?",
        "asvs": "BSI IT-Grundschutz: APP.3.2 (Webserver), CON.3 (Web Applications), DER.1 (Data Protection)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Web_applications_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Raise this risk for technical assets identified as web servers/applications/CMS/report engines that are internet-facing,",
        "riskAssessment": "Likelihood: Likely, as legal oversights are common without explicit processes.",
        "falsePositives": "May be a false positive for purely internal, informational, or static pages with no tracking, or when strong, provable legal review processes exist that are not visible in the model.",
        "cwe": "200",
        "function": "RiskFunction.BusinessSide",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "8_sec6.ts",
        "bsiCode": "APP.3.2",
        "id": "inadequate-error-handling-bsi-app-3-2",
        "title": "Missing or Inadequate Error Handling (BSI APP.3.2)",
        "description": "If errors occur during the operation of a web server, this can affect its availability, cause content to be displayed incompletely, or lead to the failure of security mechanisms.",
        "impact": "Improper error handling can lead to denial of service and, more critically, the disclosure of sensitive system information (e.g., stack traces, database queries, internal file paths) that attackers can use to plan further attacks. It may also cause security controls to fail open, bypassing authentication or authorization checks.",
        "action": "Implement robust and secure error and exception handling.",
        "mitigation": "Implement comprehensive error handling (e.g., try-catch-finally blocks) across application logic.",
        "check": "Is there a global exception handler? Are user-facing error pages generic and free of technical details?",
        "asvs": "BSI IT-Grundschutz APP.3.2: Webserver, Requirement APP.3.2.A12: Appropriate handling of errors and error messages.",
        "cheatSheet": "",
        "detectionLogic": "This risk is raised for any web application or web server, especially those with custom-developed parts, where error handling is often implemented incorrectly.",
        "riskAssessment": "The likelihood is considered 'Likely' for any custom-developed web component. The impact is determined by the sensitivity (CIA) of the asset and the data it handles.",
        "falsePositives": "Possible false positive if the application uses a modern, mature framework that enforces secure error handling by default and this has been verified.",
        "cwe": "209",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "SYS.1.3": [
      {
        "file": "90_sec1.ts",
        "bsiCode": "SYS.1.3",
        "id": "user-enumeration-via-system-tools-bsi-t4.19",
        "title": "User Enumeration and Activity Profiling via System Tools (BSI T 4.19)",
        "description": "Various Unix-like programs (e.g., 'who', 'finger', 'ruser') can be used by any user to query data that the IT system stores about its users and system state.",
        "impact": "Attackers can build detailed usage profiles for specific accounts (such as system administrators) by periodically evaluating this information.",
        "action": "System Hardening and Access Control Configuration",
        "mitigation": "Harden the operating system by disabling or removing unnecessary network services such as 'finger' and 'ruser'.",
        "check": "Are legacy services such as 'finger' and 'ruser' disabled on multi-user systems? Can a non-privileged user run commands like 'who', 'w', or 'users' and see information about other users, especially administrative ones? Are file permissions on system directories (e.g., /var/log/wtmp) and process information (in /proc) appropriately restricted?",
        "asvs": "ASVS V14.2.2: The application has been hardened to remove all unnecessary functionality, files, and services from the application server.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
        "detectionLogic": "This risk is generated for technical assets explicitly marked as `multi_tenant` or for technology types that typically support multiple users (e.g., application servers, databases, mainframes, or general-purpose server OS). The risk is considered more severe if the asset handles highly sensitive data, as the value of the reconnaissance increases.",
        "riskAssessment": "The likelihood is considered 'Likely' on any multi-user system that has not been explicitly hardened, as the required tools are standard on most Unix-like operating systems.",
        "falsePositives": "This risk can be a false positive if the system is properly hardened (e.g., services are disabled, permissions are strict, mandatory access control is used), but the model only indicates that it is a multi-user technology. Verification requires checking the actual system configuration and hardening measures.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "90_sec2.ts",
        "bsiCode": "SYS.1.3",
        "id": "abuse-of-scripting-on-unix",
        "title": "Abuse of Scripting Languages on Unix-like Systems (BSI OPS.1.1.5.A1)",
        "description": "Unix-like operating systems often utilize powerful scripting languages. Scripts, which are text files containing a series of commands, can be executed from the command line. Due to the extensive functionality of these scripting environments, attackers can misuse scripts for a wide range of malicious purposes. Furthermore, once activated, it is very difficult to contain or restrict the capabilities of these scripting languages.",
        "impact": "If an attacker can execute or modify scripts on a compromised system, they can escalate privileges, install malware, exfiltrate data, tamper with system files, or cause a denial of service. This compromises the confidentiality, integrity, and availability of the system and the data it processes.",
        "action": "Harden System and Restrict Script Execution",
        "mitigation": "Apply the principle of least privilege. Disable unnecessary scripting interpreters (like Perl, Python, Bash if not needed). Use mandatory access control systems (like AppArmor or SELinux) to restrict which scripts can run, from where, and by whom. Ensure file permissions on scripts and directories are secure to prevent unauthorized modification. Regularly monitor for suspicious script execution via EDR or logging.",
        "check": "Are scripting languages not essential for the application's function disabled? Are there execution controls (like AppArmor, SELinux) in place to limit script execution? Are file permissions on system directories and scripts hardened? Is there active monitoring for command line and script execution?",
        "asvs": "Derived from BSI IT-Grundschutz Catalog (e.g., OPS.1.1.5 Linux and Unix Servers). While not a direct match, this relates to OWASP ASVS V14.2 (Validation, Sanitization and Encoding) and V1.10 (Hardening and Configuration).",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for all in-scope technical assets tagged as a Unix-like operating system (`os:unix`). The risk is generic to the OS platform and its potential for misuse if not properly hardened.",
        "riskAssessment": "The likelihood is elevated for internet-facing systems. The impact is directly related to the CIA rating of the technical asset and the data it processes or stores. A compromise of a mission-critical database server via scripting abuse has a very high impact.",
        "falsePositives": "The risk might be considered a false positive if the system, despite being Unix-like, has mature and robust hardening measures (e.g., SELinux in enforcing mode with a strict policy, minimal packages installed) that are not captured in the threat model.",
        "cwe": "78",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "90_sec3.ts",
        "bsiCode": "SYS.1.3",
        "id": "ld-preload-hijacking",
        "title": "Dynamic-Linker Hijacking via LD_PRELOAD (BSI Recommendation)",
        "description": "The LD_PRELOAD environment variable on Unix-like systems forces a specified dynamic library to be loaded before any other standard libraries required by an application.",
        "impact": "Successful exploitation of this vulnerability allows an attacker to execute arbitrary code with the permissions of the hijacked application.",
        "action": "Harden Execution Environments and Sanitize Inputs",
        "mitigation": "To mitigate this risk, apply defense-in-depth at the operating system level. Restrict write permissions on system directories and application paths to prevent unauthorized library placement.",
        "check": "Are file and directory permissions on the host system appropriately hardened? Are mandatory access control systems (SELinux, AppArmor) configured and enforced?",
        "asvs": "MITRE ATT&CK: T1574.006 - Hijack Execution Flow: Dynamic Linker Hijacking",
        "cheatSheet": "https://attack.mitre.org/techniques/T1574/006/",
        "detectionLogic": "This risk is raised for technical assets of type Process or Datastore that run on machine types where attackers could gain local access and control environment variables (Physical, Virtual, Container).",
        "riskAssessment": "The likelihood of exploitation is considered 'Likely' for any qualifying asset, assuming an attacker can gain local user access to the host system. The likelihood increases if the asset is internet-facing, as this provides more avenues for an attacker to gain initial access.",
        "falsePositives": "This risk is generated assuming a standard, insufficiently hardened operating system. It may be a false positive if the underlying execution environment is strongly hardened with technologies like SELinux, restricted permissions, and secure loader configurations that prevent LD_PRELOAD abuse.",
        "cwe": "427",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "90_sec4.ts",
        "bsiCode": "SYS.1.3",
        "id": "uncontrolled-software-source-bsi-sys-1-2",
        "title": "Uncontrolled Software Installation from Unvetted Sources (BSI SYS.1.2)",
        "description": "On Unix-like IT systems, users sometimes download and compile software source code themselves or install pre-compiled packages from third-party sources instead of using official, vetted package repositories. Each of these alternative methods of software installation carries additional risks, as it can lead to the installation of faulty, incompatible, or malicious software.",
        "impact": "Installing software from untrusted sources can introduce malware, leading to a compromise of confidentiality, integrity, and availability. It can also cause system instability and disrupt business operations due to faulty or incompatible software components.",
        "action": "Enforce Use of Vetted Software Sources and Repositories",
        "mitigation": "Establish and enforce a strict policy that all software must be installed from official, trusted, and signed package repositories. Use configuration management tools (e.g., Ansible, Puppet, Chef) to automate and control software installations. Implement an allow-list for software sources and repositories. Regularly scan systems for unauthorized or manually installed software. If compiling from source is absolutely necessary, it must be done in a controlled, isolated build environment after a rigorous source code review and security assessment.",
        "check": "Is there a documented policy for software installation? Are system configurations managed by an automated tool? Are package repositories restricted to a trusted allow-list? Are systems scanned for unauthorized software packages?",
        "asvs": "V14.2.1: Verify that all third-party components are from a trusted source, and have a secure and verifiable delivery mechanism.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html",
        "detectionLogic": "This risk is triggered for in-scope technical assets running on container, virtual, or physical machines, particularly those of a type where administrative or developer access is common (e.g., application servers, build pipelines). The likelihood of this risk is considered higher if the asset has custom developed parts or is explicitly tagged with `@Control:unvetted-software-sources`.",
        "riskAssessment": "The impact is determined by the CIA requirements of the technical asset and the data it processes or stores. A compromise of a mission-critical system has a very high impact. The likelihood is high if the practice is known to occur (indicated by the tag) or if no preventive controls are in place on susceptible system types. Without the explicit tag, a general risk is raised for relevant asset types to encourage verification of operational controls.",
        "falsePositives": "This risk might be acceptable in isolated sandboxes or development environments where experimentation is required, provided that these environments cannot affect production systems and are regularly wiped or reimaged. It can also be a false positive if strong compensating controls (like strict AppArmor/SELinux policies, network segmentation, and regular audits) are proven to be in place and effective.",
        "cwe": "829",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ],
    "SYS.1.5": [
      {
        "file": "91_sec1.ts",
        "bsiCode": "SYS.1.5",
        "id": "unclear-responsibilities-on-virtualization-platform",
        "title": "Unclear Responsibilities and Rights Separation on Virtualization Platform (BSI APP.4.4)",
        "description": "If the technical and organizational integration of virtualization servers into the existing infrastructure is not adequately planned,",
        "impact": "Failure to properly separate administrative responsibilities and access rights on a shared virtualization platform can allow an attacker or malicious insider to escalate privileges.",
        "action": "Define and Enforce a Granular Roles and Rights Concept for the Virtualization Platform",
        "mitigation": "Implement a detailed roles and rights concept that enforces separation of duties for different administrative areas (e.g., hypervisor admin, network admin, storage admin, and individual guest/application admins).",
        "check": "Is there a documented roles and rights concept for the virtualization platform? Are administrative accesses separated based on roles (e.g., hypervisor admin vs. guest admin)? Is this enforced using technical controls like RBAC? Are access logs for the platform reviewed regularly?",
        "asvs": "Derived from BSI IT-Grundschutz Kompendium APP.4.4 Virtualization, especially requirements A1 (Planning the use of virtualization), A4 (Administration of the virtualization solution), and A6 (Separation of administrative roles).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/bausteine/APP/APP_4_4_Virtualisierung.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for any 'Shared Runtime' that hosts two or more technical assets. The risk is considered higher if the co-located assets belong to different trust boundaries, indicating a mix of security domains on a single platform. The risk can be mitigated by tagging the 'Shared Runtime' with `rbac-enforced`.",
        "riskAssessment": "The likelihood is 'Likely' for any multi-tenant platform and increases to 'Very Likely' if tenants from different trust boundaries are mixed. The impact is determined by the highest confidentiality and integrity requirements of any asset on the platform, as a compromise of the platform or one tenant could affect all others.",
        "falsePositives": "The model cannot verify the actual implementation quality of the RBAC on the virtualization platform. The risk is generated based on shared tenancy, but the platform might have excellent, non-modeled controls that effectively separate tenants.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "91_sec2.ts",
        "bsiCode": "SYS.1.5",
        "id": "incorrect-placement-of-high-value-virtual-asset",
        "title": "Incorrect Placement of High-Value Virtualized Asset in a Public Network Zone (BSI APP.3.2.A5)",
        "description": "Virtualization simplifies and accelerates the provisioning of IT systems. Resources like CPU, RAM, and network connections are typically configured via a central management system, removing hardwired constraints.",
        "impact": "If a high-value virtualized asset is incorrectly exposed to the internet, it bypasses perimeter security controls and becomes a direct target for a wide range of attacks.",
        "action": "Implement and Enforce Strict Network Configuration and Deployment Processes for Virtualized Environments",
        "mitigation": "Establish strict change management and a 'four-eyes principle' for any network configuration changes within the virtualization management platform.",
        "check": "Is there a documented and enforced process for assigning virtual machines to network zones? Are changes to virtual network configurations subject to review and approval?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.3.2 (Virtualisierung). Requirement APP.3.2.A5 (Zuordnung von VMs zu virtuellen Netzen) directly addresses the need for correct network assignment.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/APP/APP_3_2_Virtualisierung_Edition_2023.pdf?__blob=publicationFile (BSI APP.3.2)",
        "detectionLogic": "This rule checks for technical assets that are virtualized (`virtual` or `container`) and have at least a medium sensitivity rating.",
        "riskAssessment": "The impact is directly derived from the confidentiality and integrity rating of the misplaced asset. A 'Strictly Confidential' database exposed to the internet has a much higher impact than a moderately sensitive internal application.",
        "falsePositives": "This risk might be a false positive if an asset is intentionally and securely designed to be internet-facing, despite its technology type (e.g., a specialized, hardened API gateway built on a technology not typically used for that purpose).",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "91_sec3.ts",
        "bsiCode": "SYS.1.5",
        "id": "inadequate-resources-on-virtualization-host-g-0-4",
        "title": "Inadequate Resources on Virtualization Host (BSI G 0.4)",
        "description": "Virtualization servers require resources like disk space, CPU power, RAM, and network bandwidth to operate the virtual IT systems they host. If these resources are not adequately planned or provisioned, significant risks to the availability of the virtual systems and the integrity of the information processed within them can arise. This is especially true when features like snapshots or resource over-commitment (overbooking) are used. Resource bottlenecks can cause virtual systems to interfere with each other, malfunction, or fail entirely.",
        "impact": "Resource exhaustion on a virtualization host can lead to a Denial-of-Service (DoS) condition where hosted virtual systems become unresponsive or crash. This can also result in data corruption (loss of Integrity) if systems cannot write data correctly during a failure. The overall effect is the disruption of business processes that rely on these virtual systems.",
        "action": "Implement Capacity Planning and Resource Monitoring for Virtualization Platforms",
        "mitigation": "Implement a robust capacity planning and management process for all virtualization platforms, considering the peak resource needs of all hosted systems. Use monitoring tools to track resource utilization (CPU, RAM, storage, network I/O) and configure alerts for when predefined thresholds are approached. Avoid excessive over-commitment of resources unless the workload characteristics are well-understood and actively managed. If a comprehensive capacity management or auto-scaling solution is in place, tag the corresponding `Shared-Runtime` component in the model with `mitigation:capacity-management-in-place` or `mitigation:auto-scaling-resources` to acknowledge this mitigation.",
        "check": "Is there a documented capacity management process for virtualization platforms? Are resource utilization levels actively monitored with alerting? Is there a policy regarding resource over-commitment?",
        "asvs": "BSI IT-Grundschutz G 0.4 (Unzureichende Ressourcen) in Baustein OPS.1.1.2 (Virtualisierung)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_2_Virtualisierung_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for every `Shared-Runtime` component identified in the model, as it represents a virtualization host or platform where multiple technical assets share common underlying physical resources, creating a potential for resource contention. The risk's severity increases with the number and criticality of the assets running on the shared platform.",
        "riskAssessment": "The likelihood is considered 'Likely' and increases with the number of systems sharing a runtime, as this increases complexity and the potential for unforeseen resource contention. The impact is determined by the highest availability and integrity requirements of all virtual systems running on the host. If a mission-critical system is hosted, the impact is considered 'Very High'.",
        "falsePositives": "This risk might be considered a false positive if the underlying virtualization platform is a managed service with effectively limitless, auto-scaling resources (e.g., a large-scale cloud provider) or if a very robust capacity management process is in place, which might not be fully captured in the threat model. In such cases, applying a mitigation tag is recommended.",
        "cwe": "770",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "91_sec4.ts",
        "bsiCode": "SYS.1.5",
        "id": "improper-vm-snapshot-handling",
        "title": "Risks of Improper Virtual Machine Snapshot Handling",
        "description": "A snapshot can freeze and save the state of a virtual machine. If such a snapshot is restored at a later point in time, all changes made in the meantime are lost. This can also reopen security vulnerabilities that have already been patched. Furthermore, inconsistent data can arise from open files, file transfers, or database transactions at the time of the snapshot. In addition, snapshots can be misused in attacks to gain unauthorized access to the data of a virtual IT system, because if the snapshot was created during operation, the contents of the main memory were also saved to the hard disk and can be restored and analyzed in a virtual environment outside the original IT infrastructure. Likewise, snapshots can become very large, causing available storage capacity to become scarce.",
        "impact": "Improper handling of VM snapshots can lead to severe security incidents. Restoring old snapshots can re-introduce critical vulnerabilities, undoing security patches and exposing the system to known exploits (Integrity loss). Snapshots of running systems capture memory contents, which can be analyzed offline by an attacker to extract secrets like keys, passwords, and sensitive data (Confidentiality loss). The process can also lead to data corruption if taken during active transactions (Integrity loss). Finally, an accumulation of large snapshots can exhaust storage resources, leading to a denial of service (Availability loss).",
        "action": "Implement and Enforce a Snapshot Lifecycle Management Policy",
        "mitigation": "Implement a formal snapshot management policy that treats snapshots as temporary, short-term mechanisms (i.e., not as backups). Delete snapshots promptly after their purpose is fulfilled (e.g., post-patch validation). Use automation to enforce snapshot lifecycle policies (creation, deletion, and alerting). Secure the underlying datastore where snapshots reside with strict access controls and consider encryption-at-rest for the snapshot files. To prevent data inconsistency, applications and filesystems should be quiesced before a snapshot is taken. To mitigate data leakage from memory dumps, avoid storing long-lived secrets in the memory of virtual machines where possible. Continuously monitor storage capacity to prevent availability issues.",
        "check": "Is there a formal policy for VM snapshot lifecycle management? Are snapshots regularly audited and deleted? Is the storage for snapshots secured and monitored? Are applications quiesced before snapshots are created for data consistency?",
        "asvs": "BSI IT-Grundschutz CON.6 Virtualization",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_6_Virtualization_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for all technical assets configured to run on virtual machines (`machine: virtual`). The risk is especially high for VMs that process or store sensitive data, as their memory contents (captured in snapshots) and data state are valuable targets.",
        "riskAssessment": "The likelihood of exploitation is considered 'likely' by default, as snapshot mismanagement is a common operational oversight. The impact is directly derived from the Confidentiality, Integrity, and Availability ratings of the virtualized asset and the data it handles. A VM handling 'strictly-confidential' data will have a 'high' or 'very-high' impact, as an attacker could extract this data from a snapshot's memory dump.",
        "falsePositives": "The risk may be overstated if the organization has strong, externally enforced snapshot management policies (e.g., via a cloud provider's governance tools) that are not reflected in the model tags. Some virtualization platforms also offer features to create snapshots without including memory content, which would reduce the confidentiality risk.",
        "cwe": "524",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "91_sec5.ts",
        "bsiCode": "SYS.1.5",
        "id": "single-point-of-failure-virtualization-management-server",
        "title": "Single Point of Failure: Virtualization Management Server (BSI)",
        "description": "Since all functions of a virtual infrastructure are controlled and administered via the management server, a failure of this management system means that no configuration changes can be made to the virtual infrastructure.",
        "impact": "A failure of the central management server leads to a significant degradation of operational capabilities. While existing virtual systems may continue to run, the inability to manage, reconfigure, or recover them can quickly escalate into major service disruptions, especially in dynamic environments. This directly impacts the overall availability of the services hosted on the virtual infrastructure.",
        "action": "Ensure High Availability for the Virtualization Management Server",
        "mitigation": "The virtualization management server should be designed for high availability. This can be achieved through clustering, failover mechanisms, or redundant instances. The asset should be marked as `redundant: true` in the model to reflect this mitigation. Regularly test failover procedures to ensure they work as expected.",
        "check": "Review the architecture of the virtualization management components. Is the technical asset responsible for managing the virtual infrastructure (e.g., a 'container-platform') configured redundantly? Is the `redundant` flag set to `true` for this asset in the model?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.4 Redundancy",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_4_Redundancy_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for technical assets that act as a central management component for a virtualized environment (e.g., technology 'container-platform') and are not marked as redundant (`redundant: false`). These assets represent a Single Point of Failure (SPOF) for the operational management of the infrastructure they control.",
        "riskAssessment": "The likelihood of failure for a non-redundant critical system is considered 'Likely' over its operational lifetime. The impact is 'High' or 'Very High' if the managed virtual systems have high availability requirements, as a failure of the management plane directly compromises the ability to ensure service continuity and disaster recovery.",
        "falsePositives": "The risk might be a false positive if redundancy is achieved through external means not captured in the model (e.g., a cloud provider's managed service that guarantees high availability implicitly) and the `redundant` flag was not set.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "91_sec6.ts",
        "bsiCode": "SYS.1.5",
        "id": "guest-tool-privilege-risk",
        "title": "High Privileges of Guest Tools in Virtual Machines",
        "description": "Guest tools (e.g., VMware Tools, VirtualBox Guest Additions) often run with very high privileges (SYSTEM/root) inside virtual machines.",
        "impact": "If this vulnerability is exploited, it can lead to a Denial-of-Service of the affected virtual machine. The most severe impact is a complete takeover of the virtualization host, which compromises the confidentiality, integrity, and availability of all other assets running on the same host.",
        "action": "Harden Virtualization Components and Keep Them Updated",
        "mitigation": "Regularly update both the guest tools within the virtual machine and the virtualization host platform itself to patch known vulnerabilities.",
        "check": "Are guest tools and the virtualization platform kept up-to-date with security patches? Is the virtual machine modeled as being part of a 'shared_runtime' representing the hypervisor?",
        "asvs": "BSI IT-Grundschutz SYS.1.3 Virtualisierung",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_3_Virtualization_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Finds all technical assets configured with `machine: virtual`. The risk is inherent to using virtualization with guest tools, as they require deep integration with the guest OS kernel.",
        "riskAssessment": "The impact is considered 'High' if the virtual machine itself processes or stores highly sensitive data. It escalates to 'Very High' if other critical assets are running on the same virtualization host (modeled as a shared_runtime), due to the risk of a host compromise.",
        "falsePositives": "This risk can be considered a false positive or of lower severity if strong compensating controls are in place, such as advanced EDR/sandboxing technologies within the guest, or if using virtualization technologies that do not rely on traditional privileged guest tools (e.g., certain micro-VM implementations).",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "91_sec7.ts",
        "bsiCode": "SYS.1.5",
        "id": "compromise-of-hypervisor",
        "title": "Compromise of Hypervisor (based on BSI)",
        "description": "The virtualization software (hypervisor) is the central component of a virtualization server.",
        "impact": "A successful compromise of the hypervisor grants an attacker full control over all hosted virtual machines.",
        "action": "Harden and Secure the Hypervisor Platform",
        "mitigation": "Apply security patches to the hypervisor promptly. Use a dedicated and isolated management network for the hypervisor.",
        "check": "Are hypervisor security patches applied in a timely manner? Is the hypervisor management interface isolated from production and user networks?",
        "asvs": "Derived from concepts in BSI IT-Grundschutz, particularly related to virtualization security (e.g., APP.3.1 Virtualisation). The core risk is about platform integrity.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Virtualization_Security_Cheat_Sheet.html",
        "detectionLogic": "Detects `shared_runtime` components tagged with `@Hypervisor` that run one or more `technical_asset`(s) of machine type `virtual`.",
        "riskAssessment": "The impact is determined by the highest Confidentiality, Integrity, and Availability of any virtual machine running on the hypervisor, as a compromise of the hypervisor compromises all running VMs.",
        "falsePositives": "This risk might be considered a false positive or accepted if the hypervisor is part of a fully managed service from a major cloud provider (e.g., AWS Nitro, Azure Hypervisor) where the customer has no direct control over patching or configuration.",
        "cwe": "653",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "SYS.1.6": [
      {
        "file": "92_sec1.ts",
        "bsiCode": "SYS.1.6",
        "id": "vulnerable-or-malicious-container-images",
        "title": "Vulnerable or Malicious Components in Container Images (based on BSI CON.8)",
        "description": "Containers are primarily created from pre-built images, which can be sourced from the internet or created in-house.",
        "impact": "Exploitation of vulnerabilities within a container can lead to a complete compromise of that asset. This can result in the loss of Confidentiality, Integrity, and Availability (CIA) for all data processed or stored by the container.",
        "action": "Implement Image Scanning and Lifecycle Management",
        "mitigation": "Use a dedicated container image vulnerability scanner within the CI/CD pipeline to detect known vulnerabilities in base images and application dependencies.",
        "check": "Are container images scanned for vulnerabilities before being deployed? Is there a defined policy for trusted image sources? Are base images regularly updated and applications rebuilt?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.8 (Containerisierung), particularly requirement CON.8.A4 (Prüfung von Images auf Schwachstellen).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_8_Containerisierung.html",
        "detectionLogic": "This risk is triggered for any technical asset running as a container (`machine: container`).",
        "riskAssessment": "The likelihood of this risk is considered high, especially for images based on third-party components (`custom_developed_parts: false`).",
        "falsePositives": "A risk might be flagged even if an effective image scanning process exists but is not documented in the model via the `@Control:image-vulnerability-scanner` tag.",
        "cwe": "937",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "92_sec2.ts",
        "bsiCode": "SYS.1.6",
        "id": "unprotected-container-administration",
        "title": "Unprotected Container Administration Interface (BSI CON.7.A12)",
        "description": "To manage container services on a host, administrative access is required. This access is often realized as services that can be addressed either locally (e.g., via sockets) or over the network.",
        "impact": "Successful exploitation allows an attacker to gain full administrative control over the container platform. This can lead to executing arbitrary commands, deploying malicious containers, stealing or modifying data within all containers, and causing a denial-of-service for all applications running on the host. This constitutes a complete compromise of the host and all its workloads.",
        "action": "Secure Container Administration Interfaces",
        "mitigation": "Enable strong authentication and authorization for all container management interfaces (e.g., Docker daemon API, Kubernetes API server).",
        "check": "Are all container platform management interfaces protected with strong, mandatory authentication? Is all administrative network traffic encrypted? Is network access to management interfaces restricted to a minimal set of trusted sources? Are file permissions on local management sockets properly restricted?",
        "asvs": "BSI IT-Grundschutz CON.7 Containerization, Requirement CON.7.A12 'Securing the management interfaces of containers and container images'",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_7_Containerisation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule targets technical assets of type 'Container Platform'. It identifies risks in two ways:",
        "riskAssessment": "The impact is rated 'Very High' as a compromise affects all containers and applications on the host. The likelihood is 'Very Likely' for unprotected network interfaces and 'Likely' for risks from co-located assets, as this requires an initial compromise of a neighboring container.",
        "falsePositives": "A risk might be generated for a container platform that has compensating controls (e.g., a hardware firewall) not modeled in Threagile. The distinction between a management node and a worker node might not be clear from the model, potentially leading to a risk being raised for a worker node where local access is less critical.",
        "cwe": "306",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "92_sec3.ts",
        "bsiCode": "SYS.1.6",
        "id": "container-resource-exhaustion-on-host",
        "title": "Container Resource Exhaustion on Host (BSI CON.7)",
        "description": "An individual container, if not properly resource-constrained, can consume an excessive amount of the host's resources (CPU, memory, I/O, PIDs). This can lead to a denial-of-service condition affecting other containers running on the same host, or even compromising the stability and availability of the host system itself (a 'Noisy Neighbor' attack).",
        "impact": "A successful exploitation of this vulnerability leads to a Denial of Service. This impacts the availability of all services running in containers on the affected host, as well as potentially the host system itself. Business processes depending on these services will be disrupted, potentially leading to financial loss.",
        "action": "Enforce Container Resource Limits",
        "mitigation": "Define and enforce strict resource quotas (CPU, memory, PID limits, I/O) for each container. This should be implemented at the container orchestrator level (e.g., Kubernetes LimitRanges, pod resource requests/limits) or via the container runtime configuration. Monitor resource usage continuously to detect and alert on abnormal consumption before it impacts the host. Consider using a tag like `resource-limits-applied` on the shared runtime or containers to denote mitigation.",
        "check": "Are resource limits (CPU, memory, PIDs) defined and enforced for all containerized assets running on a shared host? Is there active monitoring of container resource usage against their defined quotas?",
        "asvs": "BSI IT-Grundschutz CON.7.A12 Ressourcenbegrenzung von Containern (Resource limitation of containers).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_7_Containerisation_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is automatically detected whenever a 'Shared Runtime' hosts more than one technical asset of machine type 'Container'. In such a multi-tenant environment, one container can impact the availability of others if resource limits are not enforced.",
        "riskAssessment": "The impact is determined by the highest availability requirement of any containerized asset running on the shared host. A host running 'mission-critical' assets will result in a higher impact. The likelihood is considered 'likely' by default, as unconstrained resource usage is a common configuration oversight.",
        "falsePositives": "This risk might be a false positive if the underlying host or orchestrator implements strong resource isolation between tenants by default. The risk can be marked as mitigated or a false positive if explicit resource limits are confirmed to be in place for all containers on the host.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "92_sec4.ts",
        "bsiCode": "SYS.1.6",
        "id": "unrestricted-container-communication-con5",
        "title": "Unrestricted Container Communication (BSI CON.5)",
        "description": "All containers on a host are generally able to communicate with each other, with the host, and with any other hosts.",
        "impact": "Failure to restrict container communication can lead to lateral movement within the infrastructure, allowing a compromise to spread from one container to others or to the host system.",
        "action": "Implement Network Segmentation and Egress/Ingress Filtering for Containers",
        "mitigation": "For inter-container communication on the same host, implement fine-grained network policies to enforce a 'least privilege' communication model, ensuring containers can only communicate with intended endpoints. In a Threagile model, this can be represented by placing communicating containers inside a 'Network Policy Namespace Isolation' trust boundary.",
        "check": "Are containers running on the same host isolated from each other via network policies? Are internal-only container services prevented from being accessed externally? Is there a default-deny policy for container ingress and egress traffic?",
        "asvs": "BSI IT-Grundschutz CON.5 Containerisation",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_5_Containerisation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks for two conditions based on BSI CON.5:",
        "riskAssessment": "The likelihood of exploitation is considered 'likely' for unsegmented hosts and 'very-likely' for exposed internal services, as they are often less hardened. The impact is calculated based on the highest Confidentiality, Integrity, and Availability (CIA) ratings of the affected container assets. A compromise of a host running mission-critical services will result in a high-impact risk.",
        "falsePositives": "A model might not explicitly include a `NetworkPolicyNamespaceIsolation` trust boundary even if one exists in the real implementation, leading to a false positive. Similarly, a service tagged as `@Visibility:internal` might be intentionally exposed for a specific, justified reason not captured in the model.",
        "cwe": "923",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "92_sec5.ts",
        "bsiCode": "SYS.1.6",
        "id": "container-breakout",
        "title": "Container Breakout (BSI)",
        "description": "If it is possible to execute custom code within a container, an attacker may be able to overcome the container's isolation",
        "impact": "A successful attack could allow an attacker to gain control of the host system or other systems in the infrastructure.",
        "action": "Harden Container Host, Runtime, and Images",
        "mitigation": "Harden the host system by using a minimal, container-optimized OS and keeping the kernel and all system components patched.",
        "check": "Are host systems and kernels regularly patched? Are minimal host OS images used? Are security profiles like Seccomp and AppArmor enforced?",
        "asvs": "BSI IT-Grundschutz APP.4.4.A12 (Hardening the host operating system) and APP.4.4.A13 (Hardening the container engine).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_Containerisation_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is generated for every technical asset modeled to run inside a 'container' (`machine: container`).",
        "riskAssessment": "The impact is calculated based on the highest Confidentiality, Integrity, and Availability (CIA) ratings of *all* assets running on the same host",
        "falsePositives": "The risk might be mitigated by advanced sandboxing technologies (e.g., gVisor, Kata Containers) or exceptional host hardening and runtime",
        "cwe": "668",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "92_sec6.ts",
        "bsiCode": "SYS.1.6",
        "id": "improper-container-shutdown",
        "title": "Improper Container Shutdown (BSI CON.6)",
        "description": "When managing containers, they can be shut down without giving the software running inside an opportunity to complete its current processes, such as writing data (i.e., a non-graceful shutdown). If data is being processed by the container at that moment, it will be lost. Data stored persistently within the container can also be permanently lost or corrupted this way.",
        "impact": "A non-graceful shutdown of a container can lead to data loss or corruption, directly impacting the Availability and Integrity of the information being processed or stored. This can cause inconsistent application states, disrupt business processes, and lead to the permanent loss of critical data.",
        "action": "Ensure Graceful Container Shutdown",
        "mitigation": "Applications running within containers must be designed to handle termination signals (like SIGTERM) gracefully. This involves saving state, finishing critical operations, and closing connections before exiting. The container orchestration platform (e.g., Kubernetes) must be configured with an adequate `terminationGracePeriodSeconds` to allow applications enough time to shut down cleanly. Avoid using forceful termination commands (like `kill -9` or `docker kill`) in automated scripts or manual operations unless absolutely necessary.",
        "check": "Does the application inside the container handle SIGTERM signals to perform a graceful shutdown? Is the container platform's grace period configured appropriately for the application's needs? Are operational procedures in place to avoid forceful container termination?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Containerization). Also relates to Kubernetes best practices for Pod termination lifecycle.",
        "cheatSheet": "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-termination",
        "detectionLogic": "This risk is raised for any technical asset identified as a container (`machine: container`) that processes or stores data. The risk is higher for custom-developed applications, as they are more likely to overlook implementing graceful shutdown procedures.",
        "riskAssessment": "The impact of this risk is determined by the highest Availability and Integrity rating of the data assets processed or stored by the container. A higher rating leads to a higher impact. The likelihood is considered higher for custom-developed parts, as off-the-shelf software often has more robust lifecycle handling. An improper shutdown of a container processing mission-critical data constitutes a very high-impact risk.",
        "falsePositives": "A model cannot determine if the application code within a container correctly handles termination signals. Therefore, this risk may be flagged even if the application is implemented correctly. This must be verified by a code review or by checking the application's documentation and operational behavior.",
        "cwe": "404",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "92_sec7.ts",
        "bsiCode": "SYS.1.6",
        "id": "hardcoded-credentials-in-container-environment",
        "title": "Hard-coded or Insecurely Stored Credentials in Container Environment",
        "description": "The principles of building and creating images for containers require that access data, such as database credentials, are available in the container. This access data can fall into unauthorized hands through the images themselves, the scripts used to create the images (e.g., Dockerfiles), the version control of the scripts, or unencrypted runtime environment variables. This poses a significant risk of confidentiality loss for these sensitive credentials.",
        "impact": "If credentials for sensitive systems like databases are compromised, an attacker can gain unauthorized access. This can lead to the theft of sensitive data (confidentiality breach), unauthorized modification or deletion of data (integrity breach), and potential disruption of dependent services (availability impact).",
        "action": "Use a Secure Secrets Management Solution for Containers",
        "mitigation": "Do not hard-code credentials or other secrets in container images, Dockerfiles, or any files checked into version control. Avoid passing secrets as plaintext environment variables. Instead, use a dedicated secrets management solution (like HashiCorp Vault, AWS Secrets Manager, Azure Key Vault) to inject secrets securely into containers at runtime. Utilize the native secret management capabilities of your container orchestrator (e.g., Kubernetes Secrets, Docker Swarm Secrets) and ensure they are properly configured for production use (e.g., with RBAC, encryption at rest).",
        "check": "Review Dockerfiles and related build scripts for hard-coded credentials. Check source code repositories for committed secrets. Verify that secrets are not passed as plaintext environment variables in deployment configurations. Confirm that a secrets management tool or a platform-native secret object is used to provide credentials to the container at runtime.",
        "asvs": "V6.4.2: Verify that credentials and other secrets are not hard-coded in the source code but are stored in a secure location, such as a managed secrets store.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for any technical asset of type 'container' that has a communication link to a 'database' (or similar data-store technology) and does not show evidence of using a secure secrets management solution. Evidence for mitigation is either a communication link to a 'vault' or 'HSM' asset, or the container asset being tagged with `@secrets-management:injected`.",
        "riskAssessment": "The likelihood of this vulnerability is considered high if a containerized application requires database credentials, as it's a common anti-pattern to handle them insecurely without explicit controls. The impact is directly derived from the confidentiality and integrity rating of the data stored in the target database. A breach of credentials for a database holding 'Strictly Confidential' data results in a 'Very High' impact.",
        "falsePositives": "This risk can be a false positive if secrets are securely managed and injected at runtime through a mechanism not modeled, such as a custom sidecar injector or an external process not represented by a 'vault' asset. In such cases, the risk can be mitigated by adding the tag `@secrets-management:injected` to the container asset.",
        "cwe": "798",
        "function": "RiskFunction.Development",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "92_sec8.ts",
        "bsiCode": "SYS.1.6",
        "id": "loss-of-control-via-cicd",
        "title": "Loss of Control over Deployed Components in Container Environments",
        "description": "In contrast to traditional installations managed by IT operations, where control over deployed applications, components, and services lies entirely with the operations team, this control is lost in automated environments like CI/CD pipelines deploying to container platforms.",
        "impact": "If developers can deploy unvetted components and their dependencies directly into a production or production-like environment, there is a high risk of introducing vulnerabilities, malware, or non-compliant software. This can lead to data breaches, system instability, and a loss of the overall security posture, compromising the confidentiality, integrity, and availability of the services running on the platform.",
        "action": "Implement Governance and Security Gates in CI/CD Pipelines",
        "mitigation": "To mitigate the loss of control, implement robust security gates within the CI/CD pipeline. This includes Static Application Security Testing (SAST), Software Composition Analysis (SCA) to check for vulnerable dependencies, and container image scanning.",
        "check": "Is there a CI/CD pipeline that can deploy directly to a container platform? Are security checks like SAST, SCA, and image scanning integrated as mandatory gates in the pipeline? Does the container platform use an admission controller to enforce security policies (e.g., block images with critical vulnerabilities)? Are all deployed images cryptographically signed and verified before deployment?",
        "asvs": "V11.3 Build Pipeline Security",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/CI_CD_Security_Cheat_Sheet.html",
        "detectionLogic": "This risk is detected when a development-related asset (like a 'Build Pipeline') has a direct communication link to a 'Container Platform'. This indicates a CI/CD process where developers can push components directly, bypassing traditional operational controls.",
        "riskAssessment": "The likelihood is considered high by default, as this deployment model intentionally cedes control to development teams. The impact is determined by the highest sensitivity (CIA ratings) of all containerized applications that are running on the affected platform, as a compromise could affect any or all of them.",
        "falsePositives": "A model might show a direct deployment link, but in reality, the CI/CD pipeline or container platform has strong, non-bypassable security gates (like mandatory vulnerability scans or admission controllers) that are not represented in the model. Such cases can be considered false positives if the controls are deemed effective.",
        "cwe": "1127",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      }
    ],
    "SYS.1.7": [
      {
        "file": "93_sec1.ts",
        "bsiCode": "SYS.1.7",
        "id": "insecure-zos-configuration",
        "title": "Insecure z/OS Configuration (BSI APP.4.4)",
        "description": "The configuration of a z/OS operating system is highly complex and requires intervention by system administrators in many areas.",
        "impact": "An insecurely configured z/OS system can allow attackers to bypass essential security controls, leading to unauthorized access,",
        "action": "Secure Configuration and Hardening of z/OS",
        "mitigation": "Implement and enforce a strict security baseline for the z/OS configuration based on vendor best practices and established hardening guides.",
        "check": "Is the z/OS system configured according to a documented security baseline? Is access to critical system datasets tightly controlled?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein APP.4.4 (z/OS) Requirement APP.4.4.A19 (Secure Configuration of z/OS).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Bausteine/APP_4_4_z_OS.pdf?__blob=publicationFile",
        "detectionLogic": "This risk applies to any technical asset identified as a mainframe, as the complexity of z/OS configuration is inherent.",
        "riskAssessment": "The likelihood is considered high due to the inherent complexity of z/OS, which makes manual configuration error-prone.",
        "falsePositives": "This risk might be considered a false positive if the organization can demonstrate mature, well-documented, and automated processes",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "93_sec2.ts",
        "bsiCode": "SYS.1.7",
        "id": "insecure-racf-default-configuration",
        "title": "Insecure Default RACF Configuration on z/OS (BSI-Style)",
        "description": "On a z/OS operating system, a specialized security system like RACF is responsible for user authentication and resource authorization.",
        "impact": "If unauthorized users can execute privileged system commands due to a weak RACF configuration, they can disrupt system stability (Availability),",
        "action": "Harden RACF Configuration",
        "mitigation": "The default RACF configuration must be comprehensively reviewed and hardened according to the principle of least privilege.",
        "check": "Is the technical asset a mainframe running z/OS? Has its RACF configuration been reviewed and hardened beyond the default state?",
        "asvs": "BSI IT-Grundschutz SYS.2.2 z/OS, specifically Requirement SYS.2.2.A25 (Appropriate Configuration of the Security System under z/OS)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_2_2_z_OS_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset of technology type 'Mainframe' that is also tagged with `racf-unhardened`.",
        "riskAssessment": "The likelihood is considered 'Likely' if the default configuration is in use, as default weaknesses are often well-documented and targeted.",
        "falsePositives": "This risk can be considered a false positive if the 'racf-unhardened' tag has been applied incorrectly to an already hardened system, or if there are",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "93_sec3.ts",
        "bsiCode": "SYS.1.7",
        "id": "mainframe-maloperation-risk",
        "title": "Mainframe Maloperation Risk due to Complexity",
        "description": "Due to the inherent complexity of a z/OS operating system and its components, operational errors or misconfigurations by personnel cannot be entirely eliminated.",
        "impact": "A failure on a mainframe system due to maloperation or resource contention can lead to a significant denial-of-service for all dependent business applications.",
        "action": "Implement Robust Mainframe Monitoring, Training, and Operational Procedures",
        "mitigation": "Mitigation involves a combination of skilled personnel and technical controls: 1. Ensure mainframe operators are highly trained and have access to ongoing education.",
        "check": "Is there a dedicated, experienced mainframe operations team? Are operational runbooks available and regularly updated? Is automated monitoring for resource usage and contention in place?",
        "asvs": "Derived from BSI IT-Grundschutz methodology (related to operational reliability of complex systems). This risk is not directly covered by a single ASVS item but relates to operational security principles.",
        "cheatSheet": "https://www.ibm.com/docs/en/zos/latest?topic=zos-problem-management",
        "detectionLogic": "This risk is automatically raised for any technical asset identified as a 'Mainframe' (`TechnicalAssetTechnology.Mainframe`).",
        "riskAssessment": "The likelihood is considered 'Likely' due to the inherent complexity of the platform, as noted in the source text.",
        "falsePositives": "The risk might be overstated if the organization has a highly mature mainframe operations team with extensive experience, robust automation, and well-tested recovery procedures.",
        "cwe": "833",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "93_sec4.ts",
        "bsiCode": "SYS.1.7",
        "id": "unprotected-mainframe-interfaces",
        "title": "Unprotected Mainframe Interfaces",
        "description": "z/OS systems can be influenced and managed via a wide variety of interfaces, such as the Hardware Management Console (HMC), local and remote MCS consoles, automation processes, and remote maintenance access. If, for example, physical or logical access to these interfaces is insufficiently protected, unauthorized parties could manipulate the z/OS systems.",
        "impact": "Unauthorized manipulation of mainframe interfaces can directly compromise the integrity and availability of the entire system. This can lead to unauthorized system commands, shutdown of critical services, data tampering, or full system takeover, resulting in catastrophic business disruption and potential data breaches.",
        "action": "Secure All Mainframe Management and Access Interfaces",
        "mitigation": "Ensure all communication links to mainframe systems, especially those for management, automation, or remote access, use strong, state-of-the-art authentication (e.g., multi-factor authentication) and encrypted protocols (like SSH, FTPS, or HTTPS). Access should be strictly controlled and restricted via network segmentation, VPNs, or IP filtering where applicable. Authorization must be fine-grained and adhere to the principle of least privilege. Disable or remove any unused or legacy interfaces.",
        "check": "Review all incoming communication links for assets with `technology: mainframe`. Verify that each link uses an encrypted protocol and has an authentication method stronger than `none`. Check if access is further restricted by `vpn: true` or `ip_filtered: true` where the connection crosses a trust boundary.",
        "asvs": "Derived from the BSI IT-Grundschutz Catalog threat for z/OS systems (SYS.1.6 z/OS, Threat T 5.14 Manipulation of z/OS systems via unprotected interfaces).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_6_z_OS_edition_2022.html",
        "detectionLogic": "This rule inspects all incoming communication links to technical assets identified as mainframes (`technology: mainframe`). It triggers a risk if any link uses an unencrypted protocol or has authentication set to `none`, as these represent insufficiently protected interfaces.",
        "riskAssessment": "The likelihood of exploitation is significantly increased if there is no authentication. The impact is directly derived from the integrity and availability rating of the mainframe asset itself. A `mission-critical` mainframe that can be manipulated constitutes a `very-high` impact risk.",
        "falsePositives": "This risk can be considered a false positive if compensating controls that are not modeled (e.g., a physically separate and secured management network) are in place. However, the lack of encryption and authentication on the link itself remains a significant weakness.",
        "cwe": "306",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "93_sec5.ts",
        "bsiCode": "SYS.1.7",
        "id": "network-attack-on-zos",
        "title": "Network-based Attacks on z/OS Systems (BSI G 0.21)",
        "description": "z/OS mainframe systems connected to TCP/IP networks, especially those using Unix System Services, are exposed to common network-based attacks.",
        "impact": "Successful attacks can lead to Denial-of-Service (DoS) against critical mainframe services, unauthorized access to or manipulation of sensitive data in transit (Information Disclosure, Tampering),",
        "action": "Secure Network Communication and Access to Mainframe",
        "mitigation": "Enforce the use of encrypted protocols for all data exchange (e.g., HTTPS, SFTP, FTPS, LDAPS, JDBC-encrypted). Segment the network to isolate the mainframe from untrusted zones.",
        "check": "Review all communication links to the mainframe. Are unencrypted protocols like HTTP, FTP, LDAP, or plain JDBC used? Is the mainframe accessible from networks with lower trust levels without VPN or IP filtering?",
        "asvs": "BSI IT-Grundschutz: APP.4.4 z/OS, Threat G 0.21 Netz-Angriffe auf z/OS-Systeme",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/APP_4_4_z_OS_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies assets with 'Mainframe' technology. It then inspects all incoming communication links for two primary weaknesses:",
        "riskAssessment": "The likelihood is high if unencrypted protocols are used across network boundaries or if access is not properly segmented.",
        "falsePositives": "A risk might be a false positive if compensating controls exist that are not modeled, such as a separate hardware encryption appliance securing the link, or if an 'unencrypted' protocol is running inside a secure,",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "93_sec6.ts",
        "bsiCode": "SYS.1.7",
        "id": "incorrect-character-set-translation-ebcdic-ascii",
        "title": "Incorrect Character Set Translation (EBCDIC-ASCII/Unicode)",
        "description": "EBCDIC, ASCII, and Unicode are character sets that define how letters, numbers, and other characters are represented using bits.",
        "impact": "Data corruption due to faulty character set translation compromises the integrity of the information. This can lead to incorrect data processing,",
        "action": "Ensure Correct and Validated Code Page Translation",
        "mitigation": "Ensure that all data exchange channels between EBCDIC-based systems (e.g., Mainframes) and ASCII/Unicode-based systems use correctly configured and validated code page translation tables.",
        "check": "Are code page translation tables explicitly defined and tested for all communication links between mainframes and other systems? Is there a process to validate data integrity after transfer? Are special characters handled correctly in test cases?",
        "asvs": "Derived from BSI IT-Grundschutz Catalog text concerning z/OS data exchange. This can be mapped to application security requirements like ASVS V4.0.3: 13.2.3",
        "cheatSheet": "https://www.ibm.com/docs/en/zos/2.5.0?topic=services-character-conversion",
        "detectionLogic": "This risk is raised for any communication link between a technical asset of technology 'Mainframe' and another asset that is not a 'Mainframe'.",
        "riskAssessment": "The likelihood is considered 'Likely' as this is a common and often overlooked interoperability problem. The impact is determined by the integrity requirement (criticality) of the data assets being exchanged. A high integrity requirement leads to a high impact.",
        "falsePositives": "This risk can be a false positive if the specific communication protocol or application layer transparently and correctly handles character set translation by default, or if the data exchanged is purely binary and does not require character translation.",
        "cwe": "176",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      }
    ],
    "SYS.1.8": [
      {
        "file": "94_sec1.ts",
        "bsiCode": "SYS.1.8",
        "id": "insecure-default-configuration-of-storage-components",
        "title": "Insecure Default Configuration of Storage Components (based on BSI guidance)",
        "description": "Storage components are often shipped with default configurations optimized for ease of use and broad functionality, not for security.",
        "impact": "Using storage components with insecure factory settings allows for easier unauthorized access. This can lead to service unavailability (Denial of Service),",
        "action": "Harden and Secure Storage Component Configuration",
        "mitigation": "Review and harden the configuration of all storage components before production use. Disable all unnecessary protocols and services (e.g., HTTP, Telnet, FTP).",
        "check": "Are storage components configured according to a security hardening baseline? Are all incoming communication links to datastores using encrypted protocols? Are default credentials changed?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.1.2: Databases, specifically requirements like SYS.1.2.A11 (Protection of management and administration interfaces) and SYS.1.2.A16 (Secure configuration of the database).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_Databases_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule checks for technical assets of type 'datastore' (like databases, file servers, block storage) that have incoming communication links using insecure, unencrypted network protocols.",
        "riskAssessment": "The likelihood is very high if an insecure protocol is actively used for access, as it allows for trivial interception of data and credentials.",
        "falsePositives": "The risk might be a false positive only if the communication occurs within a completely isolated, physically secured network segment where sniffing is considered impossible and other strong compensating controls are in place.",
        "cwe": "1188",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "94_sec2.ts",
        "bsiCode": "SYS.1.8",
        "id": "improper-san-segmentation-bridging-networks",
        "title": "Improper SAN Segmentation Bridging Networks (based on BSI)",
        "description": "A misconfigured Storage Area Network (SAN) can unintentionally bridge different network segments.",
        "impact": "This type of breach can bypass security and monitoring measures, such as firewalls or Intrusion Detection Systems (IDS),",
        "action": "Implement Strict SAN and Network Segmentation (Zoning)",
        "mitigation": "Ensure that Storage Area Networks are properly segmented using techniques like zoning (hardware-based) and LUN masking.",
        "check": "Is there a documented network architecture showing segmentation? Is SAN zoning and LUN masking implemented and regularly reviewed?",
        "asvs": "BSI IT-Grundschutz NET.1.1 Network architecture and design, particularly Requirement NET.1.1.A7 Requirements for network segmentation.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_1_1_Network_architecture_and_design_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is identified by finding data stores of type 'block-storage' (representing a SAN) that are connected to multiple assets.",
        "riskAssessment": "The likelihood of exploitation is considered high if an internet-facing component is connected to a shared SAN, as these components are primary targets for attackers.",
        "falsePositives": "The model might not differentiate between proper logical SAN zoning and a flat, unsegmented SAN fabric.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "94_sec3.ts",
        "bsiCode": "SYS.1.8",
        "id": "unencrypted-storage-replication",
        "title": "Unencrypted Storage Replication Traffic (based on BSI)",
        "description": "Storage-based replication methods are used to duplicate stored or archived data in real-time across a storage network for redundancy and to prevent data loss.",
        "impact": "If replication traffic is intercepted, the confidentiality of the duplicated data assets is compromised. This can lead to severe data breaches, regulatory fines, and loss of customer trust, especially if the data is sensitive.",
        "action": "Encrypt Replication Traffic",
        "mitigation": "Ensure that all communication links used for data replication between storage systems use a protocol that provides strong, state-of-the-art encryption.",
        "check": "Review all communication links between assets of type datastore, database, file server, block storage, etc. Verify that the protocol used is encrypted or the connection is flagged as being protected by a VPN.",
        "asvs": "V6.2.1 (Data-in-Transit Protection)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers for any communication link between two technical assets that typically store data (e.g., Database, FileServer, BlockStorage) if the link sends data and the protocol is not encrypted.",
        "riskAssessment": "The impact of this risk is determined by the highest confidentiality level of the data assets being sent over the unencrypted link.",
        "falsePositives": "This risk might be a false positive if the network link is physically isolated and secured (e.g., dedicated dark fiber) in a way that is not captured by the threat model's trust boundaries or VPN flags.",
        "cwe": "311",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "94_sec4.ts",
        "bsiCode": "SYS.1.8",
        "id": "wwn-iqn-spoofing-on-block-storage",
        "title": "Identifier Spoofing on Block Storage (WWN/IQN-Spoofing)",
        "description": "Storage Area Networks (SANs), especially Fibre Channel (FC) based ones, often use World Wide Names (WWNs) to manage and assign access rights, similar to how MAC addresses are used in Ethernet networks.",
        "impact": "Successful identifier spoofing leads to unauthorized access to sensitive data stored on the block storage system. This compromises data confidentiality and integrity. In a multi-tenant environment, the impact is magnified as it could lead to a cross-tenant data breach, causing significant financial, reputational, and legal damage.",
        "action": "Implement Strong Authentication for SAN/Block Storage Access",
        "mitigation": "Do not rely solely on identifiers like WWN or IQN for access control. Implement a strong, cryptographically-backed authentication protocol like Challenge-Handshake Authentication Protocol (CHAP) for all connections to the block storage system.",
        "check": "Are connections to block storage systems authenticated with methods stronger than just a plain identifier (e.g., is CHAP or a similar protocol used)? Are access controls within the SAN (zoning, LUN masking) configured to prevent unauthorized cross-system access?",
        "asvs": "BSI IT-Grundschutz CON.3.A12 (Zoning in a SAN). While zoning is a primary defense, it is vulnerable to WWN spoofing if not combined with stronger authentication.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_SAN_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule triggers on 'block-storage' datastores that have incoming communication links with authentication set to 'none'. Such a configuration implies that access control might rely solely on a spoofable identifier (like a WWN or IQN), which is a significant vulnerability.",
        "riskAssessment": "The impact of this risk is rated higher if the block storage system is multi-tenant or processes/stores data with high confidentiality or integrity requirements. The likelihood is considered 'likely' because the means to perform this attack are well-documented, and the lack of proper authentication in the model is a direct indicator of the vulnerability.",
        "falsePositives": "This risk might be a false positive if other, non-modeled controls are in place, such as strict port security on the SAN fabric switches that prevent identifier spoofing. However, relying on such controls without cryptographic authentication is not a robust defense.",
        "cwe": "287",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "94_sec5.ts",
        "bsiCode": "SYS.1.8",
        "id": "inadequate-vsan-separation-for-multi-tenancy",
        "title": "Inadequate Separation of Multi-Tenant Storage Networks (BSI NET.3.2.A5)",
        "description": "When the network structures of different tenants are separated by virtual storage area networks (VSANs) instead of physically separate networks, the information security of the institution can be compromised.",
        "impact": "A successful exploit of this weakness could allow an attacker who has compromised one tenant's environment to access, modify, or disrupt the data and services of other tenants. This violates tenant separation and can lead to major confidentiality and integrity breaches, service disruptions, and potential legal and contractual violations.",
        "action": "Implement Strong Logical and Cryptographic Tenant Separation",
        "mitigation": "Ensure that multi-tenant storage systems enforce strict separation between tenants at the network and data level. Use separate VLANs, network security groups, or similar network segmentation controls for each tenant's access path to the shared storage.",
        "check": "Is a multi-tenant storage system in use? How are the connecting client systems of different tenants logically separated from each other? Does the shared storage system have direct connections from assets in different trust boundaries? Are tenant-specific encryption keys being used?",
        "asvs": "BSI IT-Grundschutz NET.3.2: Separation and Partitioning of Networks, Requirement A5 (Logical network separation)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Separation_and_partitioning_of_networks_edition_2022.pdf?__blob=publicationFile",
        "detectionLogic": "This rule triggers on multi-tenant datastores (especially Block Storage or File Servers). It checks for incoming connections from client assets. A risk is identified if the client assets connecting to the same shared storage reside in different trust boundaries, as this indicates the storage is bridging distinct security zones without guaranteed separation, posing a cross-tenant access risk.",
        "riskAssessment": "The impact is determined by the highest confidentiality and integrity requirements of the data stored on the shared asset.",
        "falsePositives": "This rule might generate a false positive if the virtual storage system itself implements robust, cryptographically-enforced tenant separation that is not visible in the model's architecture. It can also be a false positive if the different trust boundaries are purely for organizational purposes and do not represent different levels of security or trust.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "94_sec6.ts",
        "bsiCode": "SYS.1.8",
        "id": "component-failure-in-storage-solution-sys1.6.t5",
        "title": "Component Failure in Complex Storage Solution (BSI SYS.1.6 T5)",
        "description": "Complex network-based storage solutions often consist of many interconnected components (e.g., Fibre-Channel switches, storage controllers, virtualization appliances). The failure of a single, non-redundant component can lead to the entire storage solution becoming unavailable or malfunctioning, threatening dependent applications.",
        "impact": "If a critical component of a storage solution fails, important applications relying on it may no longer work correctly. This can lead to significant disruptions in business operations, data corruption, or permanent data loss, thus compromising the Availability and Integrity of the stored information.",
        "action": "Implement Redundancy and High-Availability for Storage Components",
        "mitigation": "Ensure that the storage solution is designed for high availability by using redundant components (e.g., redundant controllers, power supplies, network paths) and robust failover mechanisms. The 'redundant' flag for the technical asset should be set to 'true'. Regularly test failover procedures. Implement and test robust backup and recovery strategies to mitigate the risk of data loss. Monitor the health of all storage components to predict and prevent failures.",
        "check": "Is the technical asset representing the storage solution marked as 'redundant: true' in the model? Is the solution designed with redundant components and tested failover mechanisms? Is there a comprehensive and tested backup and recovery plan?",
        "asvs": "BSI IT-Grundschutz SYS.1.6 Storage, Threat T 5.150 Failure of the storage solution.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS/SYS_1_6_Storage_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for any technical asset identified as a storage solution that is not marked as redundant (`redundant: false`). Storage solutions include databases, file servers, block storage, data lakes, and other similar technologies.",
        "riskAssessment": "The likelihood of a service-impacting failure is considered 'Likely' for any complex, non-redundant system. The impact is directly related to the availability and integrity requirements of the asset and the data it stores. A failure of a storage system holding mission-critical data will have a 'Very High' impact.",
        "falsePositives": "This risk might be a false positive if redundancy is implemented at a higher level not captured in the model (e.g., application-level replication) or if the asset's `redundant` flag is incorrectly set to `false`.",
        "cwe": "755",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "94_sec7.ts",
        "bsiCode": "SYS.1.8",
        "id": "insufficient-physical-access-control-for-storage",
        "title": "Insufficient Physical Access Control for Storage System Components (BSI-style)",
        "description": "If there are insufficient or no physical access controls for the components of a storage system, an attacker could gain physical access to existing Fibre Channel (FC) SAN switches or connect additional unauthorized switches to the network.",
        "impact": "The goal of such an attack could be to access and modify the distributed zoning database, which controls storage access. This would allow the attacker to bypass logical access controls and gain unauthorized access to storage systems, compromising the confidentiality and integrity of the stored data.",
        "action": "Implement and Enforce Strict Physical Access Controls",
        "mitigation": "Ensure all storage system components, including SAN switches and storage arrays, are located in physically secure areas (e.g., locked server rooms, secure racks). Implement strict physical access controls with logging and monitoring. Network ports in unsecured areas should be disabled. Regularly audit physical security measures.",
        "check": "Are storage components in a locked, access-controlled room? Is physical access logged and monitored? Are unused physical network ports on switches disabled? Is there a formal procedure for authorizing physical access to the data center or server room?",
        "asvs": "BSI IT-Grundschutz INF.5.A6 (Zutrittskontrolle)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/INF_5_Room_and_cabinet_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for physical datastore assets (i.e., machine type 'physical') that are located in an environment with insufficient physical security. This is indicated by the custom tag '@PhysicalSecurity:insufficient' on the asset or its containing trust boundary. The risk is especially relevant for block-storage, file servers, and databases.",
        "riskAssessment": "The likelihood is high if the components are in an accessible or poorly monitored area. The impact is directly related to the confidentiality and integrity of the data stored on the system. Unauthorized physical access to a storage system holding strictly confidential data constitutes a very high impact.",
        "falsePositives": "The risk might be a false positive if the tag '@PhysicalSecurity:insufficient' is applied incorrectly, or if compensating controls (like data-at-rest encryption with key management that is physically and logically separate from the storage host) are in place but not modeled.",
        "cwe": "269",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "SYS.1.9": [
      {
        "file": "95_sec1.ts",
        "bsiCode": "SYS.1.9",
        "id": "usability-impairment-due-to-latency-or-overload",
        "title": "Usability Impairment due to Latency or Overload (BSI)",
        "description": "Applications provided by a central server (such as a terminal server or VDI environment) are used in real time. If the server's response to user input is noticeably delayed or the visual quality is poor, usability can be so limited that it equates to a service outage. This can be caused by constant high latency, unpredictable performance spikes, or insufficient network bandwidth leading to compression artifacts.",
        "impact": "High latency or server overload can prevent users from working efficiently with the provided applications, or at all. This constitutes a Denial-of-Service, directly impacting business continuity and productivity. It can lead to missed deadlines and financial loss if the affected applications are critical for business operations.",
        "action": "Implement Capacity Planning, Performance Monitoring, and Network Quality Assurance",
        "mitigation": "Ensure the server (CPU, RAM, storage) is adequately sized for the expected peak user load. Use load balancing for high numbers of users. Guarantee low-latency, high-bandwidth network paths between clients and the server. All intermediary components (e.g., VPN gateways, firewalls, reverse proxies) must be sized and configured to handle the traffic without introducing significant delay. Continuously monitor server resource utilization, network latency, and application responsiveness to proactively identify and resolve bottlenecks.",
        "check": "Are performance and capacity requirements for the service defined and tested? Is the server and network infrastructure monitored for performance bottlenecks (latency, packet loss, CPU/memory usage)? Are intermediary security gateways verified not to be a performance bottleneck under load?",
        "asvs": "Derived from BSI IT-Grundschutz Catalog threat descriptions for terminal servers (e.g., former `SYS.3.2.1 Terminal-Server`) and general threats like `G 0.35 Failure or disruption of communication networks` and `G 0.26 Failure of devices or systems`. This is primarily an operational availability risk.",
        "cheatSheet": "https://www.bsi.bund.de/EN/Topics/ITGrundschutz/itgrundschutz_node.html",
        "detectionLogic": "This risk is raised for server-type technical assets with high availability requirements that receive a significant number of connections from client-type assets. The likelihood increases if the server is not marked as redundant, is of a smaller size (e.g., 'component'), or if connections traverse network trust boundaries or VPNs, which can introduce latency.",
        "riskAssessment": "The impact is derived directly from the availability rating of the technical asset (from Medium for 'important' assets to Very High for 'mission-critical' ones). The likelihood is calculated based on a combination of factors: the number of concurrent clients, the server's specified size and redundancy, and the network complexity of the connections.",
        "falsePositives": "The risk can be a false positive if the architectural model does not accurately capture the real-world capacity of the server or the performance of the network. A component might be modeled with a small 'size' but run on highly performant, dedicated hardware. The model does not contain quantitative data on network bandwidth or latency.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "95_sec2.ts",
        "bsiCode": "SYS.1.9",
        "id": "terminal-server-availability-failure",
        "title": "Availability Failure in Terminal Server Environments",
        "description": "In a terminal server-based environment, applications are executed centrally, and their output is transmitted to the corresponding clients. If the terminal server is unavailable, no input can be processed, and the applications provided by it fail immediately. If clients receive their entire user interface from the terminal server, the IT system appears to have completely failed from the user's perspective.",
        "impact": "Failures of the network or the terminal server generally affect more than just individual clients. In many cases, numerous or even all clients of an institution depend on the terminal server. If the terminal server fails, a large number of clients are affected simultaneously, leading to widespread operational disruption.",
        "action": "Ensure High Availability for Central Components",
        "mitigation": "To mitigate the risk of a single point of failure, implement redundancy for the central terminal server asset. This can be achieved through clustering, load balancing, and failover mechanisms. Ensure that the network paths between clients and servers are also redundant. The technical asset in the model representing the terminal server should be marked as `redundant: true` to reflect these measures. Continuous monitoring of server health, resource utilization, and network connectivity is crucial for early detection of potential availability issues.",
        "check": "Is the technical asset acting as a terminal server designed for high availability (e.g., clustered, load-balanced)? Are network connections to the server redundant? Is the asset's `redundant` flag set to `true` in the model? Is there monitoring and alerting in place for availability events?",
        "asvs": "BSI IT-Grundschutz SYS.1.4 Terminalserver (classic)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/kompendium_archiv/kompendium_15_0.pdf?__blob=publicationFile (Classic BSI Compendium featuring SYS.1.4)",
        "detectionLogic": "This rule identifies non-redundant central technical assets (like Application Servers or virtual Desktops) that serve multiple clients. A failure of such an asset would constitute a single point of failure, causing a denial of service for all dependent clients.",
        "riskAssessment": "The impact of the risk is determined by the availability requirement of the central server asset itself. A 'mission-critical' server failure has a 'very-high' impact. The likelihood is considered 'likely' for any non-redundant central component, as hardware, software, or network failures are common operational occurrences. The risk is not generated if the server asset is marked as 'redundant'.",
        "falsePositives": "The rule might identify a standard application server as a 'terminal server' if it serves many clients, even if it's not used for desktop virtualization. However, the availability risk is still valid for any central, non-redundant component. The risk can be considered a false positive if high-availability measures are in place but not documented in the model via the `redundant: true` property.",
        "cwe": "400",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "95_sec3.ts",
        "bsiCode": "SYS.1.9",
        "id": "terminal-server-as-pivot-point-for-lateral-movement",
        "title": "Terminal Server as a Pivot Point for Lateral Movement (based on BSI T 5.150)",
        "description": "Terminal servers often host client-like applications (e.g., web browsers, office suites) for end users, giving them a lower level of intrinsic trust, similar to a standard client machine.",
        "impact": "An attacker gaining control over a terminal server can launch further attacks on other servers within the same network segment. This can lead to unauthorized access to sensitive data and critical backend services, potentially causing data breaches, service disruption, and compromise of the entire server environment.",
        "action": "Isolate Terminal Servers in a Dedicated, Restricted Network Segment",
        "mitigation": "Place terminal servers in their own dedicated network segment (DMZ or a specific 'Terminal Server Zone').",
        "check": "Review the network architecture diagram and firewall rule sets. Is the technical asset acting as a terminal server located in the same network trust boundary as other backend servers (e.g., databases, application services)? Are outbound connections from the terminal server restricted to only what is absolutely necessary?",
        "asvs": "ASVS V14.2.1: Verify that the system is deployed in an environment that has security controls to protect it from other applications on the same server and other servers in the same environment.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
        "detectionLogic": "This rule identifies technical assets tagged with `stereotype:terminal-server`.",
        "riskAssessment": "The likelihood of exploitation is considered 'Likely' because using a compromised system as a pivot point is a standard attacker technique.",
        "falsePositives": "This might be a false positive if strong, un-modeled compensating controls are in place, such as host-based firewalls on the terminal server or micro-segmentation at the hypervisor level that effectively isolates the assets despite them being in the same logical network zone.",
        "cwe": "923",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "95_sec4.ts",
        "bsiCode": "SYS.1.9",
        "id": "weak-isolation-in-shared-environment",
        "title": "Weak Isolation in Shared Environment (Terminal-Server-Style Risk)",
        "description": "When multiple applications or dedicated instances for different clients/tenants run on the same underlying operating system without strong isolation, there is a risk of security boundary traversal. This is common in classic terminal server or other multi-tenant environments where resources like the kernel, libraries, and file systems are shared.",
        "impact": "A successful exploit can lead to unauthorized information disclosure (e.g., reading data from another session's memory), tampering with data or system files, elevation of privilege by hijacking a higher-privileged session, and denial of service by exhausting shared resources (CPU, RAM). This compromises the Confidentiality, Integrity, and Availability of all assets hosted on the shared environment.",
        "action": "Enforce Strong Isolation and Hardening for Shared Environments",
        "mitigation": "Prefer using environments with strong kernel-level isolation, such as modern container platforms (e.g., Docker, Podman) or full virtualization (separate VMs), over simple shared-OS multi-tenancy. Apply the principle of least privilege to all user sessions and application service accounts, strictly limiting filesystem and resource access.",
        "check": "Are multiple applications from different tenants or trust levels running on a single shared OS? What isolation mechanisms are in place (e.g., containers, sandboxing, virtualization)? Are session permissions minimized? Is the host environment and all hosted software kept up-to-date with security patches?",
        "asvs": "V14.4 Configuration",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any 'Shared Runtime' that hosts more than one technical asset. The severity increases significantly if the assets have different sensitivity levels (CIA ratings) or if the environment is explicitly marked as multi-tenant, as a compromise of the weakest asset could lead to a breach of the most sensitive one.",
        "riskAssessment": "The impact is determined by the most sensitive data or critical function of any asset within the shared runtime. A breach of isolation affects the most valuable target.",
        "falsePositives": "This risk might be a false positive if the shared runtime technology, though abstractly modeled, implements strong, effective isolation that is not visible in the model (e.g., advanced SELinux policies, AppArmor profiles, or other sandboxing technologies).",
        "cwe": "668",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "95_sec5.ts",
        "bsiCode": "SYS.1.9",
        "id": "insecure-terminal-server-communication",
        "title": "Insecure Terminal Server Communication",
        "description": "Many terminal server protocols offer authenticated and encrypted communication. However, this is not always sufficient to secure the communication. If the protocol uses outdated and vulnerable mechanisms or if important security functions are disabled due to misconfigurations, the communication between clients and the terminal server can be intercepted. Additionally, vulnerabilities in the protocol implementation within the terminal server or client software may directly expose the server to attacks.",
        "impact": "Information transmitted between the terminal server and clients can be intercepted or altered. This includes authentication details, user input, screen content, clipboard data, and file transfers. This can lead to data breaches, session hijacking, and direct attacks on the terminal server itself, compromising confidentiality, integrity, and availability.",
        "action": "Ensure Secure Communication for Terminal Services",
        "mitigation": "Use strong, encrypted protocols (such as RDP with NLA, SSH, or HTTPS-based solutions) for all terminal service communication. Ensure protocols are configured to use modern, strong ciphers and algorithms. Disable legacy protocols and features (e.g., Telnet, unencrypted RDP). Keep both terminal server and client software up to date to patch implementation vulnerabilities. Consider adding security via VPNs or IP filtering as an extra layer of protection.",
        "check": "Is the communication protocol used for terminal access encrypted by default? Are outdated protocols disabled? Is the communication protected by a VPN? Are both server and client components regularly patched?",
        "asvs": "OWASP ASVS V4.0.3 - 8.1.1 (Verify that all communications to external services, or third-party services, are sent over a trusted and encrypted channel.)",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html",
        "detectionLogic": "Checks for communication links between client-type assets and terminal-server-like assets (e.g., Application Server, Desktop, Mainframe) that use an unencrypted protocol and are not protected by other means like a VPN.",
        "riskAssessment": "The likelihood is high if an unencrypted protocol is used across a network boundary. The impact depends on the sensitivity (CIA rating) of the terminal server and the data it processes. A server handling 'Strictly Confidential' data poses a much higher risk than one handling 'Public' data.",
        "falsePositives": "This risk might be a false positive if the communication is secured by an underlying mechanism not modeled, such as a separate hardware VPN tunnel or network-level IPSec that is not represented by the 'vpn: true' flag on the communication link.",
        "cwe": "319",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "95_sec6.ts",
        "bsiCode": "SYS.1.9",
        "id": "use-of-group-accounts-on-terminal-server",
        "title": "Use of Group Accounts on Terminal Server (based on BSI)",
        "description": "If multiple individuals need to use an application on a terminal server at different times, shared or group accounts are often set up.",
        "impact": "The inability to trace user actions (lack of non-repudiation) can hinder incident response, violate legal and compliance requirements (like GDPR), and obscure malicious or erroneous activities.",
        "action": "Enforce Individual User Account Authentication",
        "mitigation": "Ensure that every user accessing the terminal server authenticates with a unique, individual account.",
        "check": "Are group accounts used for interactive access to the terminal server? Can all actions performed on the server be unambiguously traced back to a specific individual?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein ORP.4 (Identity and Access Management), specifically Requirement ORP.4.A13 (Use of group accounts), which recommends avoiding group accounts where personal authentication is necessary.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2 (BSI ORP.4)",
        "detectionLogic": "This risk is detected by identifying technical assets tagged as a `@Service:TerminalServer`.",
        "riskAssessment": "The likelihood is considered high because the model explicitly shows a lack of individual user identity propagation.",
        "falsePositives": "A false positive can occur if the model is inaccurate, for example, if an `enduser-identity-propagation` mechanism is in place but not correctly documented in the communication link's `authorization` field.",
        "cwe": "288",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Repudiation"
      },
      {
        "file": "95_sec7.ts",
        "bsiCode": "SYS.1.9",
        "id": "overly-restrictive-terminal-server-config",
        "title": "Overly Restrictive Terminal Server Configuration Leading to Insecure Workarounds",
        "description": "A terminal server, or similar multi-user application host, can function as both a server and, for the applications running on it, a client.",
        "impact": "When essential tasks are blocked by overly restrictive policies, users may resort to insecure and unmonitored workarounds.",
        "action": "Balance Terminal Server Security Restrictions with User Experience and Functionality",
        "mitigation": "Review the configuration of terminal servers and similar application hosts to ensure that security restrictions do not impede essential business functions.",
        "check": "Are the access control policies on terminal-server-like assets reviewed for usability? Are there sanctioned and easy-to-use methods for data import/export that meet user needs?",
        "asvs": "Derived from BSI IT-Grundschutz principles for secure system operation. While not a direct ASVS web application requirement, it relates to the broader security principle of proper access control (ASVS V4.0.3 Chapter 4) and secure configuration.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for technical assets that function as multi-user application hosts (e.g., `application-server`, `desktop`) and are used directly by human clients.",
        "riskAssessment": "The likelihood is considered higher when sensitive data is being handled, as the pressure on users to complete their tasks may lead them to take greater risks.",
        "falsePositives": "This risk may be a false positive if the asset's configuration strikes a well-documented and effective balance between security and usability, or if all required user workflows are fully supported by secure, integrated features, obviating the need for workarounds.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "95_sec8.ts",
        "bsiCode": "SYS.1.9",
        "id": "insufficient-testing-of-terminal-server-compatibility",
        "title": "Insufficient Testing of Application Compatibility on Terminal Server / VDI (BSI SYS.3.2.2)",
        "description": "Not all applications can be deployed on any terminal server or virtual desktop infrastructure (VDI).",
        "impact": "Failure to ensure compatibility for hardware-dependent applications on a shared or virtualized platform can lead to a significant or total loss of availability for that application.",
        "action": "Thorough Compatibility Testing Before Deployment",
        "mitigation": "Before deploying an application with special hardware requirements (like GPU acceleration or specific peripherals) onto a terminal server, VDI, or other shared runtime,",
        "check": "Has the application been fully tested on the target terminal server or shared runtime environment?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.2.2 Terminalserver. This risk deals with ensuring the operational fitness of applications in a terminal server environment.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_Archiv/kompendium_15_0/sys/sys_3_2_2_pdf.pdf?__blob=publicationFile (BSI SYS.3.2.2)",
        "detectionLogic": "This risk is identified when a technical asset (the 'application') is modeled to run on a shared runtime (the 'terminal server' or 'VDI')",
        "riskAssessment": "The impact of this risk is directly related to the availability requirement of the application in question. If a 'Mission-Critical' application is unavailable, the impact is 'Very High'.",
        "falsePositives": "This risk can be considered a false positive if comprehensive compatibility testing has already been successfully completed and documented for the specific application on the specific target environment.",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "SYS.2.1": [
      {
        "file": "96_sec1.ts",
        "bsiCode": "SYS.2.1",
        "id": "malware-on-client-systems",
        "title": "Malware Infection on Client Systems (BSI DER.1)",
        "description": "Malware is designed to execute unwanted and malicious functions on IT systems, often operating covertly without the user's knowledge or consent. According to the BSI, clients are particularly vulnerable as they are often the primary entry point for malicious content via web browsing, emails, or removable media. Once a client is infected, malware can exfiltrate data, gain control of the system, and spread to other systems within the internal network.",
        "impact": "A successful malware infection on a client can lead to the compromise of confidentiality (e.g., theft of credentials and sensitive data), integrity (e.g., data manipulation, ransomware encryption), and availability (e.g., system crashes, denial-of-service). The infection can also serve as a beachhead for further attacks into the corporate network, escalating the potential damage significantly.",
        "action": "Implement Multi-Layered Endpoint Protection and User Awareness",
        "mitigation": "Employ a defense-in-depth strategy for clients. This includes centrally managed and up-to-date endpoint protection software (antivirus/EDR), application whitelisting, host-based firewalls, and regular security patching. Restrict user permissions to the minimum necessary. Implement web and email filtering to block malicious content at the gateway. Control the use of removable media. Complement technical measures with a continuous security awareness program for all users.",
        "check": "Are all client systems equipped with managed and updated endpoint security software? Are operating systems and applications regularly patched? Is the principle of least privilege enforced for user accounts? Are there technical controls for web, email, and removable media? Is there an active security awareness program?",
        "asvs": "BSI IT-Grundschutz: DER.1 Bedrohungen durch Schadprogramme, SYS.2.1 Allgemeiner Client",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium_2023/Kompendium_Einzel_PDFs_2023/10_DER_Detektion_und_Reaktion/DER_1_Bedrohungen_durch_Schadprogramme_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is automatically detected for all technical assets identified as client systems (e.g., Browser, Desktop, Mobile App). The risk's likelihood and impact are elevated based on the client's internet connectivity and the sensitivity of the systems it communicates with.",
        "riskAssessment": "The likelihood of infection is considered high for internet-facing clients operated by humans. The impact is determined by the CIA requirements of the client itself, the data it processes, and the criticality of the backend systems it connects to. A client used to administer mission-critical systems poses a very-high impact risk.",
        "falsePositives": "The risk may be overestimated if the model does not capture specific hardening measures or compensating controls like a fully restrictive VDI environment or kiosk mode. Manual verification of the client's security posture is recommended.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "96_sec2.ts",
        "bsiCode": "SYS.2.1",
        "id": "exclusive-local-data-storage",
        "title": "Exclusive Local Data Storage",
        "description": "Despite contrary recommendations, important data is often stored exclusively locally, for example, in local file directories or email archives instead of on a central file server.",
        "impact": "Storing important data exclusively on local systems poses a significant risk to its availability and integrity.",
        "action": "Implement and Enforce Centralized Data Storage and Backup",
        "mitigation": "Establish and enforce a clear policy for storing all important institutional data on central, managed systems (e.g., file servers, databases, enterprise cloud storage).",
        "check": "Is there a policy mandating central storage for important data? Are suitable central storage systems available, known to users, and actively used?",
        "asvs": "Derived from BSI IT-Grundschutz CON.3 (Data Backup Concept) and APP.4.5 (Notebooks).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Data_backup_concept_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies client-type technical assets (e.g., desktops, mobile apps) that store important data locally but lack a modeled communication link to a central datastore (like a database or file server).",
        "riskAssessment": "The likelihood of a hardware failure or other loss event is considered 'Likely' over the lifecycle of a device.",
        "falsePositives": "A risk might be flagged if a backup or synchronization mechanism (e.g., a cloud sync client like OneDrive or Dropbox) is active on the client system but not represented as a communication link in the model.",
        "cwe": "668",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "96_sec3.ts",
        "bsiCode": "SYS.2.1",
        "id": "physical-damage-to-client-devices",
        "title": "Physical Damage to Client Devices (BSI T 0.15, T 0.16)",
        "description": "Unlike central IT systems like servers, users interact directly with client devices. This proximity means users might, intentionally or unintentionally, damage the device.",
        "impact": "If a client device is damaged, lost, or stolen, it cannot be used as intended until it is repaired or replaced, which directly impacts availability.",
        "action": "Implement Physical and Environmental Protection for Client Devices",
        "mitigation": "Use protective cases and screen protectors for mobile devices. Implement robust cable management to reduce tripping hazards.",
        "check": "Are there physical protection measures in place for client devices (e.g., laptop cases, secure workstations)? Is full-disk encryption enforced?",
        "asvs": "Derived from BSI IT-Grundschutz Threats T 0.15 (Failure or disruption of devices or systems) and T 0.16 (Destruction of devices or data media), often discussed in modules like OPS.1.2.2 (Laptops).",
        "cheatSheet": "https://www.bsi.bund.de/DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/IT-Grundschutz/IT-Grundschutz-Kompendium/it-grundschutz-kompendium_node.html",
        "detectionLogic": "This risk is triggered for all in-scope technical assets identified as client-type technologies using the 'isTechnologyClient' helper function.",
        "riskAssessment": "The impact is directly proportional to the Availability requirement of the asset and the work performed by its user.",
        "falsePositives": "This risk might be considered a false positive or have a lower likelihood if the client device is located in a highly controlled environment where user-induced physical damage is extremely improbable (e.g., a kiosk in a locked, protected enclosure).",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "96_sec4.ts",
        "bsiCode": "SYS.2.1",
        "id": "unauthorized-client-access-sys3.1",
        "title": "Unauthorized Client Access (BSI SYS.3.1)",
        "description": "Identification and authentication are intended to prevent unauthorized use of a client. However, IT systems requiring user ID and password authentication can still be used without authorization if an attacker manages to spy on or guess the credentials. If a screen lock is not activated, the client can also be used without authorization during brief absences.",
        "impact": "Unauthorized access to a client system can lead to theft of sensitive data (compromising confidentiality), manipulation of data or system functions (compromising integrity), and misuse of the system for further attacks within the network. This can result in financial loss, reputational damage, and breaches of legal or contractual obligations.",
        "action": "Enforce Strong Client Authentication and Automatic Screen Locking",
        "mitigation": "Enforce strong authentication mechanisms on all client systems, preferably Multi-Factor Authentication (MFA). Implement and enforce a strict password policy for complexity, rotation, and history where passwords are used. Configure all clients to automatically lock the screen after a short period of inactivity. Educate users about the risks of weak credentials, shoulder surfing, and social engineering attacks.",
        "check": "Is MFA required for client login? Is there a password policy in place and is it enforced? Are all client devices configured to auto-lock after a short period of inactivity? Are users trained on credential security?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.1 (Client under Windows), specifically Requirements SYS.3.1.A5 (Authentication at the client) and SYS.3.1.A6 (Screen lock).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_1_Client_under_Windows_Edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This risk applies to all in-scope technical assets identified as human-operated clients (e.g., technology types 'browser', 'desktop', 'mobile-app' and where the 'used_as_client_by_human' flag is set). The likelihood is determined by the authentication strength, which can be specified using the '@ClientAuthentication' tag. In the absence of this tag, a default risk of standard password-based authentication is assumed.",
        "riskAssessment": "The likelihood is HIGH for clients with no authentication or just a simple password. It is MEDIUM for clients with strong passwords but no MFA. It is LOW for clients enforcing MFA or biometric authentication. The impact is determined by the CIA rating of the client asset itself and the sensitivity of the data it processes or stores.",
        "falsePositives": "This rule might generate a false positive if the client authentication method is managed by an external Identity Provider and this is not reflected in the model via tags. The risk should be manually verified against the actual client configuration.",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "96_sec5.ts",
        "bsiCode": "SYS.2.1",
        "id": "unnecessary-software-on-client",
        "title": "Unnecessary Software on Client (BSI-Style Hardening Principle)",
        "description": "When installing an operating system, there is usually the option to install optional software.",
        "impact": "Exploiting a vulnerability in unnecessary and unpatched software can lead to a full compromise of the client system.",
        "action": "Implement Strict Software Installation Policies and Hardening",
        "mitigation": "Enforce a strict policy that only essential, approved software is installed on client systems.",
        "check": "Is there an application whitelisting solution in place on clients? Is there a formal process for approving and installing software?",
        "asvs": "Derived from general system hardening best practices, similar to CIS Benchmarks. It aligns with the principle of minimizing the attack surface.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
        "detectionLogic": "This risk applies to all in-scope technical assets identified as clients (e.g., desktops, mobile apps, developer clients).",
        "riskAssessment": "The likelihood of exploitation is higher for clients with internet access.",
        "falsePositives": "This risk can be a false positive if the organization has strong, enforced hardening policies that are not reflected in the model via tags.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "96_sec6.ts",
        "bsiCode": "SYS.2.1",
        "id": "unauthorized-eavesdropping-via-client-devices",
        "title": "Unauthorized Eavesdropping via Client Device Peripherals",
        "description": "Many client systems, including desktops, mobile devices, and IoT devices like Intelligent Personal Assistants (IPAs), are equipped with microphones and cameras.",
        "impact": "Unauthorized activation of microphones or cameras leads to a direct breach of confidentiality.",
        "action": "Harden Client Endpoints and Enforce Strict Access Control on Peripherals",
        "mitigation": "Implement a robust endpoint security policy for all client devices. This should include OS hardening, using endpoint detection and response (EDR) solutions, and strictly managing application permissions to access hardware like microphones and cameras.",
        "check": "Is there an endpoint security solution in place for all client devices? Are application permissions to use microphones and cameras regularly audited?",
        "asvs": "Derived from BSI IT-Grundschutz; similar concepts in OWASP MASVS (Mobile App Security) V8.1: 'The app does not use the microphone or camera for purposes not obvious to the user.'",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Mobile_App_Security_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any in-scope technical asset classified as a client-type technology (e.g., ClientSystem, MobileApp, IoTDevice) that is tagged as having a microphone or camera.",
        "riskAssessment": "The impact of this risk is directly proportional to the confidentiality of the information in the physical environment where the device is located. A device in a public area has a low impact, while one in a boardroom has a very high impact.",
        "falsePositives": "The risk might be a false positive if the device is located in a non-sensitive environment where no confidential information is ever discussed, or if the peripherals are verifiably physically disconnected.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "96_sec7.ts",
        "bsiCode": "SYS.2.1",
        "id": "misconfiguration-or-improper-use-of-client-system",
        "title": "Misconfiguration or Improper Use of Client System (BSI-Style)",
        "description": "Modern client operating systems are highly complex. Misconfigurations of components can significantly impair security, leading to system malfunctions or compromises.",
        "impact": "If this risk is exploited, an attacker could gain unauthorized access to the client system and any connected resources. This can lead to the compromise of",
        "action": "Harden and Secure Client System Configurations and Promote Secure User Practices",
        "mitigation": "Implement and enforce hardened standard configurations (baselines) for all client systems using configuration management tools like GPO or MDM.",
        "check": "Are there documented, hardened security baselines for all client operating systems in use? Is a centralized configuration management system (like GPO or MDM) in place to enforce these baselines?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein SYS.3.1 (Clients under Windows), SYS.3.2.1 (Clients under Linux), and SYS.3.3 (Clients under macOS). This risk consolidates the general threat of misconfiguration applicable to all client systems.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_3_1_Clients_under_Windows_edition_2023.pdf?__blob=publicationFile (BSI SYS.3.1 as an example)",
        "detectionLogic": "This risk is raised for all in-scope technical assets identified as client systems (e.g., desktops, mobile apps, browsers, etc.).",
        "riskAssessment": "The likelihood is considered high for internet-facing clients and medium for internal-only clients, assuming no specific hardening measures are modeled.",
        "falsePositives": "This risk might be a false positive if the client systems are already managed and hardened by robust, out-of-model processes (e.g., a mature corporate GPO/MDM environment).",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      }
    ],
    "SYS.2.2.3": [
      {
        "file": "97_sec1.ts",
        "bsiCode": "SYS.2.2.3",
        "id": "high-risk-profile-for-windows-systems",
        "title": "High Risk Profile for Windows Systems (BSI-based)",
        "description": "Due to the high prevalence of Windows operating systems and the backward compatibility often present between system generations,",
        "impact": "If this risk materializes, malware or unauthorized access can compromise the confidentiality, integrity, and availability of the system and the data it processes.",
        "action": "Implement Robust Hardening, Patch Management, and Endpoint Protection for Windows Systems",
        "mitigation": "Apply a defense-in-depth strategy for all Windows systems. This includes:",
        "check": "Are all Windows systems covered by a patch management process with defined SLAs? Is there a documented hardening standard for Windows systems that is actively enforced and audited?",
        "asvs": "BSI IT-Grundschutz: SYS.1.2 Windows Server, SYS.1.3 Windows Clients",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_2_Windows_Server_2019_Edition_2021.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for all in-scope technical assets identified as a Windows system via the `@OS:Windows` tag.",
        "riskAssessment": "The likelihood is considered high due to the large attack surface and the constant barrage of attacks targeting Windows vulnerabilities.",
        "falsePositives": "This generalized risk is rarely a complete false positive, as the external threat landscape for Windows is a given.",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "97_sec2.ts",
        "bsiCode": "SYS.2.2.3",
        "id": "uncontrolled-use-of-integrated-cloud-services",
        "title": "Uncontrolled Use of Integrated Cloud Services",
        "description": "Modern client operating systems like Windows often include deeply integrated cloud services (e.g., via a Microsoft Account) for data storage and synchronization.",
        "impact": "The uncontrolled use of integrated cloud services can lead to a breach of confidentiality and non-compliance with data protection regulations (like GDPR).",
        "action": "Restrict or Control Integrated Cloud Services via Central Management",
        "mitigation": "Use central management tools like Group Policy (GPO) or a Mobile Device Management (MDM) solution to disable or strictly control the use of integrated cloud services.",
        "check": "Are there GPO or MDM policies in place to control integrated cloud service usage? Are users prevented from using personal cloud accounts on corporate systems? Is the backup of sensitive information like BitLocker keys to unmanaged cloud accounts disabled?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein CON.6 (Mobile Devices) and CON.3 (Clients under Windows 10/11), which recommend restrictive configuration of cloud services.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/CON_3_Clients_unter_Windows_10_und_11_Edition_2023.html",
        "detectionLogic": "This risk is inherent to many modern client operating systems. It is automatically detected for any 'Client System' or 'Desktop' technical assets that are not explicitly marked as having this risk mitigated.",
        "riskAssessment": "The likelihood is considered high for any unmanaged client system, as these cloud integrations are often default settings.",
        "falsePositives": "A risk might be flagged for a client system where the organization intentionally uses these cloud services under a managed corporate tenant with appropriate security controls.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "97_sec3.ts",
        "bsiCode": "SYS.2.2.3",
        "id": "software-incompatibility-on-os-upgrade",
        "title": "Software Incompatibility on OS Upgrade (based on BSI)",
        "description": "Software, especially older applications that were successfully operated on previous versions of an operating system, may not be compatible with current OS versions.",
        "impact": "If an application is incompatible with an OS upgrade, it can lead to a partial or complete loss of its functionality.",
        "action": "Establish and Execute an Application Compatibility Testing Process",
        "mitigation": "Before deploying major OS updates to production environments, critical applications must be tested for compatibility in a representative staging environment.",
        "check": "Is there a formal process for testing application compatibility before OS upgrades? Is there an up-to-date inventory of critical applications and their supported operating systems?",
        "asvs": "This is a platform-level configuration and lifecycle management issue, not directly covered by OWASP ASVS which focuses on web application security. The closest concept is ensuring a secure and stable operating environment.",
        "cheatSheet": "https://learn.microsoft.com/en-us/windows/deployment/planning/windows-10-deployment-plan",
        "detectionLogic": "This risk is raised for technical assets that are likely to be sensitive to underlying OS changes.",
        "riskAssessment": "The likelihood of this risk materializing is higher for applications explicitly marked as legacy or for older, complex COTS software.",
        "falsePositives": "This risk may be a false positive if the organization has a robust, consistently executed pre-deployment testing process or if the specific application is already confirmed to be compatible by the vendor. The risk serves as a prompt to verify that these operational controls are in place.",
        "cwe": "477",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "97_sec4.ts",
        "bsiCode": "SYS.2.2.3",
        "id": "windows-telemetry-data-leakage",
        "title": "Undesired Windows Telemetry Data Transmission",
        "description": "By default, Windows sends diagnostic data to the manufacturer, Microsoft. Additionally, Microsoft can specifically query information from a client via the integrated telemetry service.",
        "impact": "If sensitive data is exfiltrated via the telemetry service, it constitutes a confidentiality breach. This could lead to the exposure of business secrets, personal data, or other protected information, potentially resulting in legal, financial, or reputational damage.",
        "action": "Configure or Disable Windows Telemetry",
        "mitigation": "As part of the client hardening process, the level of diagnostic data sent to Microsoft should be explicitly configured and restricted.",
        "check": "Are Windows clients hardened to restrict telemetry data collection? Is the diagnostic data level explicitly set to a minimal required level (e.g., 'Security', 'Basic') via Group Policy or MDM? Are telemetry endpoints blocked at the network perimeter?",
        "asvs": "This is a platform/OS-level configuration risk, not directly covered by OWASP ASVS. It relates to secure system configuration and hardening, similar in spirit to BSI IT-Grundschutz's APP.4.4 (Clients).",
        "cheatSheet": "https://learn.microsoft.com/en-us/windows/privacy/manage-connections-from-windows-operating-system-components-to-microsoft-services",
        "detectionLogic": "This rule triggers for in-scope technical assets identified as Windows clients (e.g., technology 'desktop' or 'client-system' with the '@OperatingSystem: Windows' tag).",
        "riskAssessment": "The likelihood of data transmission is 'Frequent' as it is a default, continuous behavior of the operating system.",
        "falsePositives": "This risk can be a false positive if telemetry is controlled by other means not represented in the model (e.g., a network-level proxy blocking all telemetry endpoints), or if the specific Windows edition used (e.g., Enterprise LTSC) has different, more secure defaults.",
        "cwe": "200",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      },
      {
        "file": "97_sec5.ts",
        "bsiCode": "SYS.2.2.3",
        "id": "impaired-forensics-due-to-vsm",
        "title": "Impaired Forensics Due to Virtual Secure Mode (VSM)",
        "description": "The use of Virtual Secure Mode (VSM) restricts or complicates forensic investigations, for example, during security incident response. Processes protected by the Secure Kernel or Isolated User Mode (IUM) become inaccessible. For instance, memory dumps of these processes cannot be analyzed due to cryptographic measures, impeding the ability to investigate security incidents on the asset.",
        "impact": "This severely hinders the ability to conduct effective security incident response and forensic analysis. It can be impossible to determine the root cause of an incident, the extent of a compromise, or the actions taken by an attacker. This can lead to prolonged system downtime, incomplete remediation, and an inability to meet legal or compliance requirements for incident reporting and analysis.",
        "action": "Assess and Document Forensic Implications of VSM",
        "mitigation": "Before enabling VSM or similar hardware-based isolation technologies, perform a risk assessment. The benefits of process isolation must be weighed against the operational cost of impaired forensic capabilities. Ensure that alternative monitoring, logging, and detection mechanisms are in place to compensate for the loss of direct memory access (e.g., enhance application-level logging, network traffic analysis, or EDR solutions aware of VSM). Document the accepted risk and the compensatory controls.",
        "check": "Is VSM or a similar technology in use on the asset? If so, is there a documented risk assessment acknowledging the impact on forensics? Are there enhanced, alternative logging and monitoring controls in place for the protected components?",
        "asvs": "Derived from BSI IT-Grundschutz CON.8 (Incident Management and Response). The inability to perform forensics directly impacts the analysis and handling phase of an incident.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium_2023/bausteine/CON_8_Incident_Management_and_Response_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "Detects technical assets that are explicitly tagged as having Virtual Secure Mode (VSM) enabled. The presence of this technology inherently complicates or blocks standard forensic procedures like memory analysis.",
        "riskAssessment": "The likelihood of forensic impairment is considered 'very-likely' if an incident occurs on a VSM-enabled system, as the impairment is a direct technical consequence. The impact is determined by the criticality (CIA rating) of the asset itself and the data it processes or stores. An inability to investigate a compromise of a mission-critical asset has a very high impact.",
        "falsePositives": "This risk can be considered a false positive if the organization has specific, VSM-aware forensic tools and documented procedures that provide equivalent visibility into protected processes, effectively mitigating the risk.",
        "cwe": "221",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Repudiation"
      }
    ],
    "SYS.2.3": [
      {
        "file": "98_sec1.ts",
        "bsiCode": "SYS.2.3",
        "id": "unauthorized-software-on-unix-systems",
        "title": "Unauthorized Software Installation on Unix-like Systems",
        "description": "On Unix-like IT systems, users might download and compile source code themselves or install pre-compiled packages from unverified third-party sources, bypassing official distribution repositories.",
        "impact": "The installation of untrusted software can introduce malware, leading to a complete compromise of the system's confidentiality, integrity, and availability.",
        "action": "Enforce Strict Software Installation and Sourcing Policies",
        "mitigation": "Restrict software installation privileges to authorized administrators only. Configure package managers to use only trusted, official repositories and verify package signatures.",
        "check": "Are user permissions configured to prevent unauthorized software installation? Are package manager repositories restricted to official, signed sources?",
        "asvs": "V14.2.5: Verify that third-party components are from a trusted source, have been securely transported, and have not been modified.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Software_Component_Verification_Cheat_Sheet.html",
        "detectionLogic": "This risk applies to technical assets identified as Unix-like systems, which are often targets for this type of compromise.",
        "riskAssessment": "The likelihood is high if non-administrative users have shell access and write permissions in their home directories on a multi-user system.",
        "falsePositives": "This risk might be a false positive if the model does not capture strong compensating controls.",
        "cwe": "829",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "98_sec2.ts",
        "bsiCode": "SYS.2.3",
        "id": "misuse-of-scripting-languages-on-unix-like-systems",
        "title": "Misuse of Scripting Languages on Unix-like Systems",
        "description": "On Unix-like operating systems, scripting languages (bash, sh, Python, Perl, Ruby, etc.) are powerful and deeply integrated.",
        "impact": "If an attacker can execute unauthorized scripts, they may compromise confidentiality, integrity, and availability of the entire client and surrounding infrastructure.",
        "action": "Lock Down Script Interpreters and Execution Paths",
        "mitigation": "Apply least privilege end-to-end. Remove or disable interpreters that are not strictly needed.",
        "check": "Are unnecessary interpreters removed? Are SELinux/AppArmor profiles enforcing and allow-listing script execution?",
        "asvs": "OWASP ASVS V14.2.1 (Command Injection) / BSI SYS.2.3 §2.2",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html | https://wiki.archlinux.org/title/Security | https://wiki.debian.org/Hardening | https://wiki.ubuntu.com/Security/Features",
        "detectionLogic": "Raised for in-scope technical assets tagged '@os:unix-like'. Likelihood is increased for internet-exposed assets.",
        "riskAssessment": "Likelihood is higher for internet-facing systems and unmanaged endpoints. Impact derives from the asset criticality and the sensitivity of processed/stored data.",
        "falsePositives": "May be a false positive if strong controls are demonstrably enforced (e.g., SELinux/AppArmor enforcing with minimal policy, 'sudo' with auditing/MFA, 'noexec/nodev/nosuid' on writable mounts,",
        "cwe": "78",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "98_sec3.ts",
        "bsiCode": "SYS.2.3",
        "id": "ld-preload-hijacking",
        "title": "Dynamic Linker Hijacking via LD_PRELOAD (BSI style)",
        "description": "On Unix-like systems, the LD_PRELOAD environment variable can force a user-specified shared library to load before any other library required by an application.",
        "impact": "Successful exploitation allows an attacker to execute arbitrary code with the permissions of the targeted application. This can lead to a complete compromise of the asset, including theft or manipulation of all data it processes (loss of Confidentiality and Integrity), disruption of its function (loss of Availability), and it can be used as a powerful mechanism for privilege escalation and persistence within the system.",
        "action": "Harden the Execution Environment and Use Process Execution Controls",
        "mitigation": "Restrict write permissions on directories where application binaries reside. Use security modules such as SELinux or AppArmor to create strict policies for which processes can execute and what environment variables they can use. Disable LD_PRELOAD system-wide if it is not required for any legitimate purpose (e.g., via /etc/ld.so.preload). Monitor process creation and associated environment variables for suspicious use of LD_PRELOAD. For critical applications, consider using statically linked binaries to avoid reliance on dynamic libraries.",
        "check": "Are file permissions on application binaries and system library paths properly restricted? Are mandatory access control systems (SELinux, AppArmor) in use to confine application behavior? Is process execution being monitored for unauthorized use of environment variables like LD_PRELOAD?",
        "asvs": "This is primarily a host-level configuration and security issue rather than a web application vulnerability as covered by OWASP ASVS. It relates to the principles in V14 Configuration, specifically V14.2.5 (Filesystem Permissions) and V14.4 (Dependency Integrity).",
        "cheatSheet": "https://www.netspi.com/blog/technical/linux-hacking/linux-privilege-escalation-using-ld_preload/",
        "detectionLogic": "This risk is relevant for any process-based technical asset running on a machine type that is susceptible to this attack (i.e., not serverless). The rule identifies assets running on physical, virtual, or containerized machines, as these environments can potentially be manipulated by an attacker with a foothold.",
        "riskAssessment": "The impact is directly proportional to the sensitivity of the asset and the data it handles. Code execution on an asset processing 'Strictly Confidential' data is a critical incident. The likelihood assumes an attacker has already gained initial access to the host system to set the environment variable. Internet-facing assets increase this likelihood as they represent a larger attack surface for gaining that initial foothold.",
        "falsePositives": "The risk might be flagged on an asset where the host operating system has other mitigating controls (e.g., a hardened kernel, strict AppArmor profiles) that are not visible in the threat model. Some specific developer or profiling tools might use LD_PRELOAD for legitimate purposes, which may need to be accepted.",
        "cwe": "506",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "98_sec3_openai.ts",
        "bsiCode": "SYS.2.3",
        "id": "ld-preload-hijacking",
        "title": "Dynamic Linker Hijacking via LD_PRELOAD (BSI style)",
        "description": "On Unix-like systems, the LD_PRELOAD environment variable can force a user-specified shared library to load before any other library required by an application.",
        "impact": "Successful exploitation allows an attacker to execute arbitrary code with the permissions of the targeted application. This can lead to a complete compromise of the asset, including theft or manipulation of all data it processes (loss of Confidentiality and Integrity), disruption of its function (loss of Availability), and it can be used as a powerful mechanism for privilege escalation and persistence within the system.",
        "action": "Harden the Execution Environment and Use Process Execution Controls",
        "mitigation": "Restrict write permissions on directories where application binaries reside. Use security modules such as SELinux or AppArmor to create strict policies for which processes can execute and what environment variables they can use. Disable LD_PRELOAD system-wide if it is not required for any legitimate purpose (e.g., via /etc/ld.so.preload). Monitor process creation and associated environment variables for suspicious use of LD_PRELOAD. For critical applications, consider using statically linked binaries to avoid reliance on dynamic libraries.",
        "check": "Are file permissions on application binaries and system library paths properly restricted? Are mandatory access control systems (SELinux, AppArmor) in use to confine application behavior? Is process execution being monitored for unauthorized use of environment variables like LD_PRELOAD?",
        "asvs": "This is primarily a host-level configuration and security issue rather than a web application vulnerability as covered by OWASP ASVS. It relates to the principles in V14 Configuration, specifically V14.2.5 (Filesystem Permissions) and V14.4 (Dependency Integrity).",
        "cheatSheet": "https://www.netspi.com/blog/technical/linux-hacking/linux-privilege-escalation-using-ld_preload/",
        "detectionLogic": "This risk is relevant for any process-based technical asset running on a machine type that is susceptible to this attack (i.e., not serverless). The rule identifies assets running on physical, virtual, or containerized machines, as these environments can potentially be manipulated by an attacker with a foothold.",
        "riskAssessment": "The impact is directly proportional to the sensitivity of the asset and the data it handles. Code execution on an asset processing 'Strictly Confidential' data is a critical incident. The likelihood assumes an attacker has already gained initial access to the host system to set the environment variable. Internet-facing assets increase this likelihood as they represent a larger attack surface for gaining that initial foothold.",
        "falsePositives": "The risk might be flagged on an asset where the host operating system has other mitigating controls (e.g., a hardened kernel, strict AppArmor profiles) that are not visible in the threat model. Some specific developer or profiling tools might use LD_PRELOAD for legitimate purposes, which may need to be accepted.",
        "cwe": "506",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "98_sec4.ts",
        "bsiCode": "SYS.2.3",
        "id": "conflicting-configurations-on-complex-systems",
        "title": "Conflicting Configurations on Unix-like Clients (BSI-based)",
        "description": "On Unix-like client systems, numerous applications are installed, each with its own configuration files.",
        "impact": "Conflicting configurations can cause unintended behavior, creating security vulnerabilities and operational issues.",
        "action": "Implement centralized configuration management and regular audits",
        "mitigation": "Utilize configuration management and infrastructure-as-code tools (e.g., Ansible, Puppet, Chef, Terraform) to enforce a consistent, conflict-free, and version-controlled configuration state.",
        "check": "Is a centralized configuration management system in use? Is there a documented, secure baseline configuration for the client?",
        "asvs": "Inspired by BSI IT-Grundschutz. Related to OWASP ASVS v4.0.3: 14.1 Configuration.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for technical assets that represent complex systems likely to have multifaceted configurations (e.g., application servers, databases, container platforms).",
        "riskAssessment": "The likelihood is higher for systems with a large number of applications or complex integration patterns (many communication links).",
        "falsePositives": "This risk may be a false positive if the system, despite its complexity, is managed by a robust, fully automated configuration management system designed to prevent or immediately detect such conflicts. Manual verification of operational practices is required.",
        "cwe": "16",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      }
    ],
    "SYS.2.4": [
      {
        "file": "99_sec1.ts",
        "bsiCode": "SYS.2.4",
        "id": "inadequate-nac-planning-net-3-1",
        "title": "Inadequate NAC Planning and Implementation (BSI NET.3.1)",
        "description": "If planning for a Network Access Control (NAC) solution is inadequate, for example due to an incomplete IT asset inventory or insufficient requirements analysis, significant security gaps can arise.",
        "impact": "A poorly implemented NAC solution can lead to Elevation of Privilege, allowing unauthorized access to sensitive network segments and data. It can also cause denial of service for legitimate users and systems.",
        "action": "Implement and validate a comprehensive Network Access Control (NAC) solution",
        "mitigation": "Ensure a complete and up-to-date IT asset inventory is maintained. Perform a thorough requirements analysis for the NAC solution, considering all relevant systems, protocols, and user roles.",
        "check": "Is there a complete inventory of all assets that require network access? Are strong, standardized authentication and authorization methods enforced for all connections that cross trust boundaries?",
        "asvs": "V14.2.3: Network-Layer Access Controls",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_1_Network_Access_Control_Edition_2023.pdf?__blob=publicationFile (BSI NET.3.1)",
        "detectionLogic": "This risk is identified by analyzing communication links that cross network trust boundaries. The risk is triggered when such a connection uses weak or no authentication or authorization, a strong indicator of an inadequate or misconfigured NAC.",
        "riskAssessment": "The likelihood of exploitation is high if authentication is missing entirely on a boundary-crossing link. The impact is determined by the Confidentiality, Integrity, and Availability (CIA) rating of the target asset and the data it processes or stores.",
        "falsePositives": "A risk might be flagged for a link that is protected by an intermediate security component (such as a WAF or IPS) not explicitly modeled in Threagile.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "99_sec2.ts",
        "bsiCode": "SYS.2.4",
        "id": "inadequate-endpoint-orchestration-for-nac",
        "title": "Inadequate Endpoint Orchestration for NAC (BSI NET.3.2)",
        "description": "A lack of—or inadequately implemented—endpoint orchestration tools, security policies, and resources can lead to poor integration of devices into a Network Access Control (NAC) solution.",
        "impact": "If unmanaged or poorly configured endpoints connect to the network, they can bypass security controls. This may lead to unauthorized access to sensitive network segments, the use of weak authentication credentials, and potential data breaches. It also increases the risk of compromised devices gaining a foothold in the internal network, potentially leading to elevation of privilege, information disclosure, and denial of service.",
        "action": "Implement centralized endpoint management and NAC integration policies",
        "mitigation": "Use a centralized orchestration tool (such as UEM or MDM) to manage all endpoints. Define and enforce security policies for different endpoint groups (e.g., corporate, BYOD, IoT).",
        "check": "Is a centralized endpoint orchestration tool (UEM/MDM) in use? Are security policies defined for different endpoint types? Is there a standardized onboarding process for new devices that includes NAC registration? Does the NAC enforce network segmentation based on endpoint identity and compliance status? Is strong authentication required for access to critical resources?",
        "asvs": "Derived from the BSI IT-Grundschutz Baustein NET.3.2 (Network Access Control)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Network_Access_Control_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is triggered for client-type technical assets (e.g., Desktop, MobileApp, IoTDevice) that are not explicitly marked as managed (e.g., via an `@EndpointManaged` tag).",
        "riskAssessment": "The likelihood is considered high if numerous unmanaged client devices can connect to the network. The impact is determined by the sensitivity (CIA ratings) of the assets they can reach. Access to mission-critical systems or strictly confidential data from an unmanaged device constitutes a very high impact.",
        "falsePositives": "The model might not include the endpoint management or orchestration system as a technical asset. An organization may have a robust endpoint management solution in place that is not reflected in the diagram, making this risk a false positive. Verification of operational processes and tools is required.",
        "cwe": "284",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "99_sec3.ts",
        "bsiCode": "SYS.2.4",
        "id": "insecure-wlan-or-nac-authentication",
        "title": "Insecure WLAN or Network Access Control (NAC) Authentication",
        "description": "If secure authentication methods for network access (such as EAP-TLS in an 802.1X environment) are not supported or enforced,",
        "impact": "An attacker could impersonate a legitimate client device and gain an initial foothold on an internal network segment.",
        "action": "Enforce Strong Network Authentication Protocols",
        "mitigation": "For 802.1X-based network access (wired or wireless), enforce strong EAP types such as EAP-TLS, which require both client and server certificates.",
        "check": "Is 802.1X deployed for network access? If so, which EAP types are permitted by the RADIUS server configuration?",
        "asvs": "Derived from BSI IT-Grundschutz Baustein NET.3.2 (WLAN Usage) and NET.1.1 (Network Architecture).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_WLAN_usage_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk triggers for communication links originating from client-type assets (e.g., mobile apps, desktops, IoT devices) that cross a network trust boundary",
        "riskAssessment": "The likelihood of exploitation is high when a weak authentication protocol is used for network access, as tools for such attacks are widely available.",
        "falsePositives": "A model might simply specify 'Credentials' as the authentication method even when a strong, password-based EAP protocol (like EAP-TTLS with a secure inner method)",
        "cwe": "290",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Spoofing"
      },
      {
        "file": "99_sec4.ts",
        "bsiCode": "SYS.2.4",
        "id": "misconfigured-nac-ruleset",
        "title": "Misconfigured NAC Ruleset",
        "description": "Due to human error, inadequate processes, or insufficient staffing that leads to time constraints,",
        "impact": "A misconfigured NAC solution can lead to two primary outcomes. First, it can cause a denial of service, where legitimate endpoints",
        "action": "Implement the four-eyes principle and auditing for NAC configuration changes",
        "mitigation": "All changes to the NAC ruleset (on RADIUS servers, access switches, etc.) must follow a documented change management process,",
        "check": "Is there a documented process for managing changes to NAC configurations? Are all changes subject to peer review? Are NAC configurations and access logs regularly audited?",
        "asvs": "BSI IT-Grundschutz: NET.3.2 RADIUS",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Grundschutz/Kompendium/bausteine/NET/NET_3_2_RADIUS_Edition_2023.html",
        "detectionLogic": "Identifies technical assets that are central components of a Network Access Control system, such as RADIUS servers or enforcing access switches.",
        "riskAssessment": "The likelihood is considered 'Likely' due to the complexity of NAC systems and the high potential for human error in manual configurations.",
        "falsePositives": "This risk is reported for any asset tagged as a core NAC component. It may be considered a false positive if the organization has exceptionally robust,",
        "cwe": "284",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "99_sec5.ts",
        "bsiCode": "SYS.2.4",
        "id": "inadequate-change-validation-process",
        "title": "macOS Clients: Inadequate Change & Configuration Validation (BSI SYS.2.4 + OPS.1.1.5)",
        "description": "macOS client configurations (e.g., SIP, Gatekeeper, XProtect, FileVault, Personal Firewall, iCloud, Wi-Fi/Bluetooth/AirDrop/Continuity settings) require",
        "impact": "Poorly validated changes can lead to data exposure (e.g., iCloud sync of sensitive data), integrity issues (malicious content executed via preview features),",
        "action": "Harden macOS clients and enforce gated change validation with testing/approval before rollout.",
        "mitigation": "Define a formal change/configuration management workflow for macOS and related infrastructure: document every change; require peer/IS review; test in a",
        "check": "Is there a documented macOS baseline (SIP, Gatekeeper, XProtect, FileVault, firewall) and a policy for iCloud usage? Are changes tracked, reviewed, tested, and",
        "asvs": "BSI IT-Grundschutz: SYS.2.4 Clients unter macOS (A1, A2, A4–A12) and OPS.1.1.5 Change Management (esp. A5: testing/acceptance of changes).",
        "cheatSheet": "References: BSI SYS.2.4 (macOS hardening), BSI OPS.1.1.5 (Change Management), and NIST SP 800-179 Rev.1 (Securing Apple macOS).",
        "detectionLogic": "Organizational/process risk surfaced where configuration errors would have high impact. The rule flags in-scope technical assets that are either",
        "riskAssessment": "Likelihood defaults to 'Likely' due to common gaps in change validation. Impact scales with the asset’s CIA: assets with Confidential or Mission-Critical",
        "falsePositives": "If a robust, audited change process exists (e.g., enforced via MDM baselines, peer reviews, dedicated staging, full rollback, and evidence of approvals)",
        "cwe": "668",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "99_sec6.ts",
        "bsiCode": "SYS.2.4",
        "id": "insufficient-network-access-control-bsi-net-3-2",
        "title": "Insufficient Network Access Control (BSI NET.3.2)",
        "description": "If Network Access Control (NAC) is disabled—temporarily or permanently—or not implemented at network boundaries (e.g., switch ports), network access is insufficiently protected.",
        "impact": "Unauthorized network access can compromise the confidentiality, integrity, and availability of information assets.",
        "action": "Implement and enforce strong network access control",
        "mitigation": "Ensure that all network access points—especially those crossing trust boundaries—are protected by a robust NAC solution that authenticates and authorizes every device or user attempting to connect.",
        "check": "Do any communication links in the model cross a network trust boundary without authentication? Are VPNs or IP filtering used as compensating controls?",
        "asvs": "BSI IT-Grundschutz NET.3.2 Network Access Control, especially requirement NET.3.2.A2 (use of a NAC system). Also related to NET.1.1.A5 (controlling access to a LAN).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_2_Network_Access_Control_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is detected by identifying communication links that cross a network trust boundary without any authentication (`authentication: none`).",
        "riskAssessment": "Likelihood is high whenever an unprotected entry point into a sensitive network exists.",
        "falsePositives": "A false positive may occur if a compensating control exists but is not modeled (e.g., a physical stateful firewall between the assets).",
        "cwe": "287",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "99_sec7.ts",
        "bsiCode": "SYS.2.4",
        "id": "nac-component-failure",
        "title": "Failure of Network Access Control (NAC) Components",
        "description": "An inadequately designed or implemented NAC architecture, malfunctioning NAC components, network disruptions, or denial-of-service (DoS) attacks can cause the failure or unavailability of central NAC components. This directly affects the ability of endpoints to communicate and can result in two critical failure modes, depending on how network enforcement points (e.g., switches, wireless access points) are configured.",
        "impact": "If an enforcement point is configured to 'fail-open', failure of the NAC component will grant unrestricted network access to connecting devices, bypassing segmentation controls. This can lead to severe Confidentiality and Integrity violations. If configured to 'fail-closed', failure will deny all network access, causing a denial of service that impacts the Availability of all dependent systems and business processes.",
        "action": "Implement a resilient NAC architecture and define failure modes",
        "mitigation": "Ensure high availability for all central NAC components (e.g., RADIUS servers) through redundancy (e.g., clustered servers). Explicitly define and implement the desired failure mode (fail-open vs. fail-closed) on all NAC enforcement points based on a thorough risk assessment for each network segment. Harden NAC components against DoS attacks. Continuously monitor the health and availability of all NAC components and the underlying network infrastructure.",
        "check": "Are central NAC components designed and deployed in a highly available, redundant configuration? Is the failure mode (fail-open/fail-closed) explicitly configured on all network enforcement devices? Is the health of all NAC components actively monitored with alerting?",
        "asvs": "V14.2.1: Verify that all networked components—including servers, workstations, and network devices—are securely configured.",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/NET_3_1_Switches_and_routers_edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This rule identifies technical assets tagged `@NAC-Component:true` that are non-redundant. It then checks for direct communication links to network devices tagged with `@NAC-Enforcement-Point:fail-open` or `@NAC-Enforcement-Point:fail-closed`. Based on the enforcement point's configuration, it generates a specific risk for either Elevation of Privilege (unrestricted access) or Denial of Service (loss of access).",
        "riskAssessment": "The likelihood is considered high if a critical NAC component is not configured redundantly. The impact is determined by the failure mode. For 'fail-open', impact is based on the highest Confidentiality/Integrity of assets within the compromised network zone. For 'fail-closed', impact is based on the highest Availability requirement of the assets that would lose connectivity.",
        "falsePositives": "This risk may be a false positive if redundancy is achieved through mechanisms not represented in the model (e.g., cloud-native load balancing, DNS failover) or if the tagged component is not actually critical for network access.",
        "cwe": "285 // CWE-285: Improper Authorization (for fail-open). The risk for fail-closed (DoS) is better described by CWE-703.",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "99_sec8.ts",
        "bsiCode": "SYS.2.4",
        "id": "inadequate-protection-of-log-data",
        "title": "Inadequate Protection of Personally Identifiable Log Data",
        "description": "An inadequate administrative concept, poor implementation, excessively long data retention periods, or insufficient coordination with the works council and the data protection officer can lead to inadequate protection of personally identifiable log data. These conditions increase the risk of data misuse.",
        "impact": "If personally identifiable log data is not adequately protected or is stored for too long without a clear policy, it could be misused to create detailed user profiles. This enables tracking of employee activities and behavior over time, leading to significant privacy violations. Such incidents can result in legal and financial penalties (e.g., under the GDPR), reputational damage, and loss of trust from employees and customers.",
        "action": "Implement Data Minimization and Retention Policies for Log Data",
        "mitigation": "Define and enforce strict data-retention policies for all log data, especially where personal information is involved. Ensure that logs are deleted or anonymized automatically after the defined retention period. Access to raw log data must be tightly controlled and restricted to authorized personnel with a legitimate need. Consult the data protection officer and, where applicable, the works council to ensure compliance with legal requirements such as the GDPR. Use the `@RetentionPolicy:Defined` tag on technical assets to indicate that such a policy exists and is enforced for the data stored there.",
        "check": "Are data-retention policies for logs clearly defined and documented? Is there an automated process for deleting or anonymizing old logs? Is access to log management systems properly secured and audited? Has the data protection officer (and, where applicable, the works council) approved the logging and retention strategy?",
        "asvs": "V8.3.4: All sensitive data at rest is encrypted, using a recommended and proven algorithm and a strong encryption key.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html",
        "detectionLogic": "This rule triggers on technical assets likely to store or process log data (e.g., databases, monitoring systems, data lakes) that handle data assets identified as sensitive, personally identifiable logs. A risk is generated if such a technical asset is not explicitly tagged with `@RetentionPolicy:Defined`, indicating a potential lack of required data-lifecycle management.",
        "riskAssessment": "The likelihood is considered 'Likely' if a system stores sensitive logs without a declared retention policy, as this represents a significant governance gap. The impact is determined by the confidentiality level of the stored log data; 'Strictly Confidential' personal data results in a 'High' impact due to the severe privacy and legal consequences of a breach.",
        "falsePositives": "A risk may be flagged even if a retention policy exists but is managed outside the system documented in the threat model. In such cases, update the model by applying the `@RetentionPolicy:Defined` tag to the relevant technical asset to suppress this finding.",
        "cwe": "532",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.InformationDisclosure"
      }
    ],
    "APP.3.3": [
      {
        "file": "9_sec1.ts",
        "bsiCode": "APP.3.3",
        "id": "file-server-availability-failure",
        "title": "Availability Failure of a Fileserver (BSI-based)",
        "description": "If a fileserver fails, the entire information system—including key business processes and institutional tasks—can be affected. Not only users but also applications may depend on data from the fileserver to operate correctly. The BSI warns that such failures can cause serious operational disruptions.",
        "impact": "If the availability of data and services on the fileserver is not ensured, deadlines may be missed and essential business processes interrupted. Without an emergency management plan, restart times can increase further. In many cases, this results in financial losses, and the outage may also affect other institutions.",
        "action": "Implement redundancy, backup and recovery, and disaster recovery plans",
        "mitigation": "Fileservers, especially those storing critical data, should be designed for high availability. This can be achieved through redundant hardware, clustering, or load balancing. A robust backup and recovery strategy must be in place and regularly tested. For mission-critical systems, a comprehensive disaster recovery plan should be established to ensure business continuity. The `redundant` flag on the technical asset should be set to `true` to reflect such a setup.",
        "check": "Is the fileserver asset marked as 'redundant'? Are backup and disaster recovery plans documented? Are Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO) defined and tested?",
        "asvs": "V6.1: Verify all application components have sufficient availability to handle application load, and can gracefully handle failures in integrated systems.",
        "cheatSheet": "https://cheatsheetseries.owasp.org/cheatsheets/Availability_Cheat_Sheet.html",
        "detectionLogic": "This risk is raised for any technical asset of type 'FileServer' that is not marked as `redundant: true` in the model. The impact is determined by the highest availability requirement of the server or the data it stores.",
        "riskAssessment": "The likelihood is considered 'Likely' for any non-redundant fileserver, as it represents a single point of failure. The impact is rated based on the highest `availability` classification of the server or its stored data assets: 'Mission-Critical' leads to 'Very-High' impact, 'Critical' to 'High' impact, 'Important' to 'Medium' impact, and lower classifications to 'Low' impact.",
        "falsePositives": "This risk may be a false positive if redundancy is handled by an underlying platform (e.g., cloud storage backend, SAN with failover) that is not explicitly modeled, but which effectively makes the fileserver component highly available. In such cases, the `redundant: true` flag should be set on the asset.",
        "cwe": "703",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "9_sec2.ts",
        "bsiCode": "APP.3.3",
        "id": "insufficient-fileserver-resources-con1-a15",
        "title": "Insufficient File Server Resources (BSI CON.1.A15)",
        "description": "If the network connection or storage capacity of the file server is insufficient, access times can increase or storage bottlenecks can occur.",
        "impact": "Inadequate resources for a file server can directly impact availability and can lead to integrity issues if applications fail.",
        "action": "Implement Capacity and Performance Management for File Servers",
        "mitigation": "Regularly monitor the file server's storage utilization, CPU, memory, and network throughput.",
        "check": "Are performance and capacity metrics for the file server actively monitored? Is there a documented process for capacity planning?",
        "asvs": "BSI IT-Grundschutz CON.1.A15 (Sufficient dimensioning of the file server)",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_File_server_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for all technical assets of the 'File Server' technology type.",
        "riskAssessment": "The likelihood is determined by factors indicating high load, such as the number of incoming connections and the volume of data stored.",
        "falsePositives": "This risk might be a false positive if the file server, even under high load, is adequately sized, properly monitored, and supported by a well-managed capacity plan.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "9_sec3.ts",
        "bsiCode": "APP.3.3",
        "id": "malware-on-fileserver",
        "title": "Unprotected File Server Spreading Malware",
        "description": "If a file server is insufficiently integrated into the organization's malware protection strategy, malware can be stored on it without detection.",
        "impact": "Widespread malware infection can compromise the Confidentiality, Integrity, and Availability (CIA) of data across numerous systems.",
        "action": "Integrate the File Server into the Malware Protection Strategy",
        "mitigation": "Ensure that the file server is covered by the central malware protection strategy. This includes installing and regularly updating anti-malware software on the file server itself,",
        "check": "Is the file server asset in the threat model tagged with `@Protected:Anti-Malware`? Does this reflect reality, i.e., is the server equipped with an effective, up-to-date anti-malware solution that scans file shares?",
        "asvs": "BSI IT-Grundschutz OPS.1.1.4 Protection against malware",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/OPS_1_1_4_Protection_against_malware_edition_2022.html",
        "detectionLogic": "This risk is raised for any in-scope technical asset of type 'File Server' that is not explicitly tagged as having malware protection (`@Protected:Anti-Malware`).",
        "riskAssessment": "The likelihood is considered higher if the file server is exposed to the internet. The impact is determined by the highest CIA rating of the file server itself or the data it stores.",
        "falsePositives": "A file server might have malware protection in place, but this is not documented in the model using the `@Protected:Anti-Malware` tag.",
        "cwe": "509",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "9_sec4.ts",
        "bsiCode": "APP.3.3",
        "id": "improper-access-control-orp4",
        "title": "Improper Access Control (BSI ORP.4)",
        "description": "If access rights and permissions are not properly designed, assigned, and enforced, unauthorized parties may gain access to data. This could allow them to read, modify, or delete sensitive information, compromising confidentiality, integrity, and availability.",
        "impact": "Failing to enforce proper access control can lead to data breaches, unauthorized manipulation or deletion of data, and elevation-of-privilege attacks. Consequences can include financial loss, reputational damage, operational disruption, and non-compliance with legal or contractual obligations.",
        "action": "Implement and enforce strong access control",
        "mitigation": "Ensure that all communication links, especially those accessing data stores or processing sensitive information, enforce strong authentication and authorization mechanisms (e.g., using tokens, client certificates, or identity propagation rather than 'none'). Access should be granted based on the principle of least privilege ('need-to-know'). Regularly review and audit assigned permissions. Do not use 'none' for authentication or authorization on any link that handles non-public data.",
        "check": "Are there any communication links in the model with `authentication` or `authorization` set to `none`? Do these links transmit or receive data assets? What is the sensitivity of the data and the target asset?",
        "asvs": "BSI IT-Grundschutz ORP.4 Identity and Access Management, particularly ORP.4.A6 (Definition of authorisations) and ORP.4.A7 (Setting up users and authorisations).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/ORP_4_Identity_and_access_management_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "This rule triggers when a communication link has its `authentication` or `authorization` property set to `none`. The risk is raised against the target asset of that link, as it is the component failing to enforce access control, especially if it handles sensitive data or is otherwise critical.",
        "riskAssessment": "The likelihood of exploitation is considered very high when no access controls are present on a communication channel. The impact is calculated based on the highest Confidentiality, Integrity, and Availability ratings of both the data assets transferred over the link and the target asset itself. Higher CIA ratings lead to higher impact.",
        "falsePositives": "This risk might be a false positive if the data being transferred is explicitly intended for public, unauthenticated access and its integrity is not a concern (e.g., a public status page with no user data). It is more likely to be a modeling error where access controls exist but were not documented in the threat model.",
        "cwe": "269",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.ElevationOfPrivilege"
      },
      {
        "file": "9_sec5.ts",
        "bsiCode": "APP.3.3",
        "id": "disorganized-data-storage-con1",
        "title": "Unstructured Data Storage (BSI CON.1)",
        "description": "If a storage structure is not specified, or if employees do not adhere to it,",
        "impact": "Unstructured data storage can compromise the confidentiality, integrity, and availability of information.",
        "action": "Define and Enforce Data Storage Structures and Policies",
        "mitigation": "Establish and document a clear, well-structured, and mandatory directory and file structure for all relevant data stores.",
        "check": "Is there a documented and enforced policy for file and directory structures? Are access permissions regularly reviewed?",
        "asvs": "BSI IT-Grundschutz CON.1.A1: Definition of a Directory Structure",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_1_General_data_and_file_storage_Edition_2023.pdf?__blob=publicationFile",
        "detectionLogic": "This risk is raised for technical assets of type 'datastore' that use technologies prone to unstructured data storage,",
        "riskAssessment": "The likelihood is considered higher for multi-tenant assets or those with a large number of users, as this increases the potential for disorganization.",
        "falsePositives": "This risk is generated based on the type of technology used. A model cannot verify the existence or enforcement of strong",
        "cwe": "552",
        "function": "RiskFunction.Architecture",
        "stride": "STRIDE.Tampering"
      },
      {
        "file": "9_sec6.ts",
        "bsiCode": "APP.3.3",
        "id": "data-loss-on-fileserver",
        "title": "Data Loss on File Server due to Missing Redundancy or Backup",
        "description": "If a file server fails completely or individual components fail, important information can be lost without file synchronization or a functioning backup. The same applies if employees accidentally delete files. If sufficient redundancy (e.g., a suitable Redundant Array of Independent Disks (RAID)) is not employed, further problems can arise. The failure of a single storage device can directly disrupt operations because the files are no longer available.",
        "impact": "A failure without proper redundancy or backup leads to data loss, compromising Integrity (data is lost or incomplete) and Availability (data is not accessible). This can severely disrupt operations, cause permanent loss of valuable information, and result in significant operational and financial damage.",
        "action": "Implement Redundancy and Backup Measures",
        "mitigation": "Ensure the file server asset is configured with hardware redundancy (e.g., a RAID system). This can be modeled by setting the 'redundant' attribute to true on the technical asset. Additionally, implement a robust, regularly tested backup and recovery strategy for all data stored on the server. To reflect this in the model, add the tag 'mitigation:backup' to the file server asset.",
        "check": "Is the 'redundant' flag set to true for the file server asset? Does the asset have a 'mitigation:backup' tag? Are the backup and recovery procedures documented and tested regularly?",
        "asvs": "BSI IT-Grundschutz: APP.3.3 Fileserver (Section 2.6 – loss of data); see also CON.3 Datensicherungskonzept and SYS.1.8 Speicherlösungen",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/SYS_1_3_Linux_and_Unix_servers_edition_2023.pdf?__blob=publicationFile&v=2",
        "detectionLogic": "Triggers for all in-scope technical assets of the 'file-server' technology type that are either not marked as 'redundant' or lack a 'mitigation:backup' tag. The risk impact is determined by the file server asset's availability and integrity ratings.",
        "riskAssessment": "The impact of data loss is driven by the file server's 'availability' and 'integrity' ratings. A server hosting 'mission-critical' data leads to a 'very-high' impact. The likelihood is 'likely' because hardware failures and human errors are common over a server's lifecycle.",
        "falsePositives": "The model may not include a separate, network-based backup solution. If such a solution exists and protects the file server, treat this as a false positive or mark it as mitigated by adding the 'mitigation:backup' tag.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.DenialOfService"
      },
      {
        "file": "9_sec7.ts",
        "bsiCode": "APP.3.3",
        "id": "ransomware-infection-via-lateral-movement",
        "title": "Ransomware Infection via Lateral Movement",
        "description": "Ransomware is malware that encrypts data on infected systems, making it inaccessible, and attackers demand a ransom for decryption keys.",
        "impact": "If ransomware spreads from a less critical asset (e.g., a user workstation) to a central data store, it can encrypt large volumes of shared data.",
        "action": "Implement network segmentation, the principle of least privilege, and robust backup and recovery strategies",
        "mitigation": "To mitigate this risk, apply a defense-in-depth strategy:",
        "check": "Are write permissions to shared data stores strictly limited based on business need? Are client networks segmented from server/storage networks? Are regular, tested, offline/immutable backups in place for all critical data?",
        "asvs": "Aligned with BSI IT-Grundschutz, especially APP.3.3 Fileserver threat scenarios involving malware/ransomware and the need for controls such as CON.3 (Malware Protection), CON.4 (Data Backup), and OPS.1.1.4 (Network Segmentation and Filtering).",
        "cheatSheet": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/Kompendium/bausteine/CON_3_Malware_protection_edition_2023.pdf?__blob=publicationFile (BSI CON.3)",
        "detectionLogic": "This risk is identified when a less protected technical asset (e.g., a client or web application) has a non-read-only communication link to a high-value data store (such as a fileserver). This creates a potential path for ransomware to spread from a common infection point to critical data storage, bypassing protections on the data store itself.",
        "riskAssessment": "The likelihood is driven by the exposure of the initial asset (clients and internet-facing systems are more likely to be compromised). The impact depends on the availability and integrity requirements of the data on the target data store. A successful attack on a data store with mission-critical data has a very high impact.",
        "falsePositives": "A risk might be flagged as a false positive if compensating controls that are not modeled exist, such as an advanced EDR/XDR solution that effectively blocks ransomware's lateral movement behavior, or if write access is restricted in ways not captured by the model.",
        "cwe": "400",
        "function": "RiskFunction.Operations",
        "stride": "STRIDE.Tampering"
      }
    ]
  }
}